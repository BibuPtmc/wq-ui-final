function BB(e,n){for(var o=0;o<n.length;o++){const c=n[o];if(typeof c!="string"&&!Array.isArray(c)){for(const d in c)if(d!=="default"&&!(d in e)){const y=Object.getOwnPropertyDescriptor(c,d);y&&Object.defineProperty(e,d,y.get?y:{enumerable:!0,get:()=>c[d]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))c(d);new MutationObserver(d=>{for(const y of d)if(y.type==="childList")for(const x of y.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&c(x)}).observe(document,{childList:!0,subtree:!0});function o(d){const y={};return d.integrity&&(y.integrity=d.integrity),d.referrerPolicy&&(y.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?y.credentials="include":d.crossOrigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function c(d){if(d.ep)return;d.ep=!0;const y=o(d);fetch(d.href,y)}})();var sce=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function mg(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Kp(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var n=e.default;if(typeof n=="function"){var o=function c(){return this instanceof c?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};o.prototype=n.prototype}else o={};return Object.defineProperty(o,"__esModule",{value:!0}),Object.keys(e).forEach(function(c){var d=Object.getOwnPropertyDescriptor(e,c);Object.defineProperty(o,c,d.get?d:{enumerable:!0,get:function(){return e[c]}})}),o}var Tw={exports:{}},Vy={},Ew={exports:{}},ji={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oA;function VB(){if(oA)return ji;oA=1;var e=Symbol.for("react.element"),n=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),c=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),y=Symbol.for("react.provider"),x=Symbol.for("react.context"),i=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),R=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),N=Symbol.iterator;function U(ze){return ze===null||typeof ze!="object"?null:(ze=N&&ze[N]||ze["@@iterator"],typeof ze=="function"?ze:null)}var K={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},X=Object.assign,Z={};function J(ze,Ye,At){this.props=ze,this.context=Ye,this.refs=Z,this.updater=At||K}J.prototype.isReactComponent={},J.prototype.setState=function(ze,Ye){if(typeof ze!="object"&&typeof ze!="function"&&ze!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ze,Ye,"setState")},J.prototype.forceUpdate=function(ze){this.updater.enqueueForceUpdate(this,ze,"forceUpdate")};function le(){}le.prototype=J.prototype;function de(ze,Ye,At){this.props=ze,this.context=Ye,this.refs=Z,this.updater=At||K}var ue=de.prototype=new le;ue.constructor=de,X(ue,J.prototype),ue.isPureReactComponent=!0;var pe=Array.isArray,he=Object.prototype.hasOwnProperty,xe={current:null},fe={key:!0,ref:!0,__self:!0,__source:!0};function _e(ze,Ye,At){var Ct,We={},st=null,Bt=null;if(Ye!=null)for(Ct in Ye.ref!==void 0&&(Bt=Ye.ref),Ye.key!==void 0&&(st=""+Ye.key),Ye)he.call(Ye,Ct)&&!fe.hasOwnProperty(Ct)&&(We[Ct]=Ye[Ct]);var hn=arguments.length-2;if(hn===1)We.children=At;else if(1<hn){for(var cn=Array(hn),cr=0;cr<hn;cr++)cn[cr]=arguments[cr+2];We.children=cn}if(ze&&ze.defaultProps)for(Ct in hn=ze.defaultProps,hn)We[Ct]===void 0&&(We[Ct]=hn[Ct]);return{$$typeof:e,type:ze,key:st,ref:Bt,props:We,_owner:xe.current}}function Ce(ze,Ye){return{$$typeof:e,type:ze.type,key:Ye,ref:ze.ref,props:ze.props,_owner:ze._owner}}function je(ze){return typeof ze=="object"&&ze!==null&&ze.$$typeof===e}function He(ze){var Ye={"=":"=0",":":"=2"};return"$"+ze.replace(/[=:]/g,function(At){return Ye[At]})}var lt=/\/+/g;function _t(ze,Ye){return typeof ze=="object"&&ze!==null&&ze.key!=null?He(""+ze.key):Ye.toString(36)}function Ue(ze,Ye,At,Ct,We){var st=typeof ze;(st==="undefined"||st==="boolean")&&(ze=null);var Bt=!1;if(ze===null)Bt=!0;else switch(st){case"string":case"number":Bt=!0;break;case"object":switch(ze.$$typeof){case e:case n:Bt=!0}}if(Bt)return Bt=ze,We=We(Bt),ze=Ct===""?"."+_t(Bt,0):Ct,pe(We)?(At="",ze!=null&&(At=ze.replace(lt,"$&/")+"/"),Ue(We,Ye,At,"",function(cr){return cr})):We!=null&&(je(We)&&(We=Ce(We,At+(!We.key||Bt&&Bt.key===We.key?"":(""+We.key).replace(lt,"$&/")+"/")+ze)),Ye.push(We)),1;if(Bt=0,Ct=Ct===""?".":Ct+":",pe(ze))for(var hn=0;hn<ze.length;hn++){st=ze[hn];var cn=Ct+_t(st,hn);Bt+=Ue(st,Ye,At,cn,We)}else if(cn=U(ze),typeof cn=="function")for(ze=cn.call(ze),hn=0;!(st=ze.next()).done;)st=st.value,cn=Ct+_t(st,hn++),Bt+=Ue(st,Ye,At,cn,We);else if(st==="object")throw Ye=String(ze),Error("Objects are not valid as a React child (found: "+(Ye==="[object Object]"?"object with keys {"+Object.keys(ze).join(", ")+"}":Ye)+"). If you meant to render a collection of children, use an array instead.");return Bt}function Ge(ze,Ye,At){if(ze==null)return ze;var Ct=[],We=0;return Ue(ze,Ct,"","",function(st){return Ye.call(At,st,We++)}),Ct}function at(ze){if(ze._status===-1){var Ye=ze._result;Ye=Ye(),Ye.then(function(At){(ze._status===0||ze._status===-1)&&(ze._status=1,ze._result=At)},function(At){(ze._status===0||ze._status===-1)&&(ze._status=2,ze._result=At)}),ze._status===-1&&(ze._status=0,ze._result=Ye)}if(ze._status===1)return ze._result.default;throw ze._result}var yt={current:null},tt={transition:null},Rt={ReactCurrentDispatcher:yt,ReactCurrentBatchConfig:tt,ReactCurrentOwner:xe};function ct(){throw Error("act(...) is not supported in production builds of React.")}return ji.Children={map:Ge,forEach:function(ze,Ye,At){Ge(ze,function(){Ye.apply(this,arguments)},At)},count:function(ze){var Ye=0;return Ge(ze,function(){Ye++}),Ye},toArray:function(ze){return Ge(ze,function(Ye){return Ye})||[]},only:function(ze){if(!je(ze))throw Error("React.Children.only expected to receive a single React element child.");return ze}},ji.Component=J,ji.Fragment=o,ji.Profiler=d,ji.PureComponent=de,ji.StrictMode=c,ji.Suspense=I,ji.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Rt,ji.act=ct,ji.cloneElement=function(ze,Ye,At){if(ze==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+ze+".");var Ct=X({},ze.props),We=ze.key,st=ze.ref,Bt=ze._owner;if(Ye!=null){if(Ye.ref!==void 0&&(st=Ye.ref,Bt=xe.current),Ye.key!==void 0&&(We=""+Ye.key),ze.type&&ze.type.defaultProps)var hn=ze.type.defaultProps;for(cn in Ye)he.call(Ye,cn)&&!fe.hasOwnProperty(cn)&&(Ct[cn]=Ye[cn]===void 0&&hn!==void 0?hn[cn]:Ye[cn])}var cn=arguments.length-2;if(cn===1)Ct.children=At;else if(1<cn){hn=Array(cn);for(var cr=0;cr<cn;cr++)hn[cr]=arguments[cr+2];Ct.children=hn}return{$$typeof:e,type:ze.type,key:We,ref:st,props:Ct,_owner:Bt}},ji.createContext=function(ze){return ze={$$typeof:x,_currentValue:ze,_currentValue2:ze,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},ze.Provider={$$typeof:y,_context:ze},ze.Consumer=ze},ji.createElement=_e,ji.createFactory=function(ze){var Ye=_e.bind(null,ze);return Ye.type=ze,Ye},ji.createRef=function(){return{current:null}},ji.forwardRef=function(ze){return{$$typeof:i,render:ze}},ji.isValidElement=je,ji.lazy=function(ze){return{$$typeof:k,_payload:{_status:-1,_result:ze},_init:at}},ji.memo=function(ze,Ye){return{$$typeof:R,type:ze,compare:Ye===void 0?null:Ye}},ji.startTransition=function(ze){var Ye=tt.transition;tt.transition={};try{ze()}finally{tt.transition=Ye}},ji.unstable_act=ct,ji.useCallback=function(ze,Ye){return yt.current.useCallback(ze,Ye)},ji.useContext=function(ze){return yt.current.useContext(ze)},ji.useDebugValue=function(){},ji.useDeferredValue=function(ze){return yt.current.useDeferredValue(ze)},ji.useEffect=function(ze,Ye){return yt.current.useEffect(ze,Ye)},ji.useId=function(){return yt.current.useId()},ji.useImperativeHandle=function(ze,Ye,At){return yt.current.useImperativeHandle(ze,Ye,At)},ji.useInsertionEffect=function(ze,Ye){return yt.current.useInsertionEffect(ze,Ye)},ji.useLayoutEffect=function(ze,Ye){return yt.current.useLayoutEffect(ze,Ye)},ji.useMemo=function(ze,Ye){return yt.current.useMemo(ze,Ye)},ji.useReducer=function(ze,Ye,At){return yt.current.useReducer(ze,Ye,At)},ji.useRef=function(ze){return yt.current.useRef(ze)},ji.useState=function(ze){return yt.current.useState(ze)},ji.useSyncExternalStore=function(ze,Ye,At){return yt.current.useSyncExternalStore(ze,Ye,At)},ji.useTransition=function(){return yt.current.useTransition()},ji.version="18.3.1",ji}var aA;function jS(){return aA||(aA=1,Ew.exports=VB()),Ew.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lA;function UB(){if(lA)return Vy;lA=1;var e=jS(),n=Symbol.for("react.element"),o=Symbol.for("react.fragment"),c=Object.prototype.hasOwnProperty,d=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,y={key:!0,ref:!0,__self:!0,__source:!0};function x(i,I,R){var k,N={},U=null,K=null;R!==void 0&&(U=""+R),I.key!==void 0&&(U=""+I.key),I.ref!==void 0&&(K=I.ref);for(k in I)c.call(I,k)&&!y.hasOwnProperty(k)&&(N[k]=I[k]);if(i&&i.defaultProps)for(k in I=i.defaultProps,I)N[k]===void 0&&(N[k]=I[k]);return{$$typeof:n,type:i,key:U,ref:K,props:N,_owner:d.current}}return Vy.Fragment=o,Vy.jsx=x,Vy.jsxs=x,Vy}var cA;function $B(){return cA||(cA=1,Tw.exports=UB()),Tw.exports}var T=$B(),V=jS();const qi=mg(V),R0=BB({__proto__:null,default:qi},[V]);var Qx={},Iw={exports:{}},Yl={},Pw={exports:{}},Aw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uA;function HB(){return uA||(uA=1,function(e){function n(tt,Rt){var ct=tt.length;tt.push(Rt);e:for(;0<ct;){var ze=ct-1>>>1,Ye=tt[ze];if(0<d(Ye,Rt))tt[ze]=Rt,tt[ct]=Ye,ct=ze;else break e}}function o(tt){return tt.length===0?null:tt[0]}function c(tt){if(tt.length===0)return null;var Rt=tt[0],ct=tt.pop();if(ct!==Rt){tt[0]=ct;e:for(var ze=0,Ye=tt.length,At=Ye>>>1;ze<At;){var Ct=2*(ze+1)-1,We=tt[Ct],st=Ct+1,Bt=tt[st];if(0>d(We,ct))st<Ye&&0>d(Bt,We)?(tt[ze]=Bt,tt[st]=ct,ze=st):(tt[ze]=We,tt[Ct]=ct,ze=Ct);else if(st<Ye&&0>d(Bt,ct))tt[ze]=Bt,tt[st]=ct,ze=st;else break e}}return Rt}function d(tt,Rt){var ct=tt.sortIndex-Rt.sortIndex;return ct!==0?ct:tt.id-Rt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var y=performance;e.unstable_now=function(){return y.now()}}else{var x=Date,i=x.now();e.unstable_now=function(){return x.now()-i}}var I=[],R=[],k=1,N=null,U=3,K=!1,X=!1,Z=!1,J=typeof setTimeout=="function"?setTimeout:null,le=typeof clearTimeout=="function"?clearTimeout:null,de=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ue(tt){for(var Rt=o(R);Rt!==null;){if(Rt.callback===null)c(R);else if(Rt.startTime<=tt)c(R),Rt.sortIndex=Rt.expirationTime,n(I,Rt);else break;Rt=o(R)}}function pe(tt){if(Z=!1,ue(tt),!X)if(o(I)!==null)X=!0,at(he);else{var Rt=o(R);Rt!==null&&yt(pe,Rt.startTime-tt)}}function he(tt,Rt){X=!1,Z&&(Z=!1,le(_e),_e=-1),K=!0;var ct=U;try{for(ue(Rt),N=o(I);N!==null&&(!(N.expirationTime>Rt)||tt&&!He());){var ze=N.callback;if(typeof ze=="function"){N.callback=null,U=N.priorityLevel;var Ye=ze(N.expirationTime<=Rt);Rt=e.unstable_now(),typeof Ye=="function"?N.callback=Ye:N===o(I)&&c(I),ue(Rt)}else c(I);N=o(I)}if(N!==null)var At=!0;else{var Ct=o(R);Ct!==null&&yt(pe,Ct.startTime-Rt),At=!1}return At}finally{N=null,U=ct,K=!1}}var xe=!1,fe=null,_e=-1,Ce=5,je=-1;function He(){return!(e.unstable_now()-je<Ce)}function lt(){if(fe!==null){var tt=e.unstable_now();je=tt;var Rt=!0;try{Rt=fe(!0,tt)}finally{Rt?_t():(xe=!1,fe=null)}}else xe=!1}var _t;if(typeof de=="function")_t=function(){de(lt)};else if(typeof MessageChannel<"u"){var Ue=new MessageChannel,Ge=Ue.port2;Ue.port1.onmessage=lt,_t=function(){Ge.postMessage(null)}}else _t=function(){J(lt,0)};function at(tt){fe=tt,xe||(xe=!0,_t())}function yt(tt,Rt){_e=J(function(){tt(e.unstable_now())},Rt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(tt){tt.callback=null},e.unstable_continueExecution=function(){X||K||(X=!0,at(he))},e.unstable_forceFrameRate=function(tt){0>tt||125<tt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ce=0<tt?Math.floor(1e3/tt):5},e.unstable_getCurrentPriorityLevel=function(){return U},e.unstable_getFirstCallbackNode=function(){return o(I)},e.unstable_next=function(tt){switch(U){case 1:case 2:case 3:var Rt=3;break;default:Rt=U}var ct=U;U=Rt;try{return tt()}finally{U=ct}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(tt,Rt){switch(tt){case 1:case 2:case 3:case 4:case 5:break;default:tt=3}var ct=U;U=tt;try{return Rt()}finally{U=ct}},e.unstable_scheduleCallback=function(tt,Rt,ct){var ze=e.unstable_now();switch(typeof ct=="object"&&ct!==null?(ct=ct.delay,ct=typeof ct=="number"&&0<ct?ze+ct:ze):ct=ze,tt){case 1:var Ye=-1;break;case 2:Ye=250;break;case 5:Ye=1073741823;break;case 4:Ye=1e4;break;default:Ye=5e3}return Ye=ct+Ye,tt={id:k++,callback:Rt,priorityLevel:tt,startTime:ct,expirationTime:Ye,sortIndex:-1},ct>ze?(tt.sortIndex=ct,n(R,tt),o(I)===null&&tt===o(R)&&(Z?(le(_e),_e=-1):Z=!0,yt(pe,ct-ze))):(tt.sortIndex=Ye,n(I,tt),X||K||(X=!0,at(he))),tt},e.unstable_shouldYield=He,e.unstable_wrapCallback=function(tt){var Rt=U;return function(){var ct=U;U=Rt;try{return tt.apply(this,arguments)}finally{U=ct}}}}(Aw)),Aw}var dA;function GB(){return dA||(dA=1,Pw.exports=HB()),Pw.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hA;function WB(){if(hA)return Yl;hA=1;var e=jS(),n=GB();function o(g){for(var b="https://reactjs.org/docs/error-decoder.html?invariant="+g,M=1;M<arguments.length;M++)b+="&args[]="+encodeURIComponent(arguments[M]);return"Minified React error #"+g+"; visit "+b+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var c=new Set,d={};function y(g,b){x(g,b),x(g+"Capture",b)}function x(g,b){for(d[g]=b,g=0;g<b.length;g++)c.add(b[g])}var i=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),I=Object.prototype.hasOwnProperty,R=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,k={},N={};function U(g){return I.call(N,g)?!0:I.call(k,g)?!1:R.test(g)?N[g]=!0:(k[g]=!0,!1)}function K(g,b,M,B){if(M!==null&&M.type===0)return!1;switch(typeof b){case"function":case"symbol":return!0;case"boolean":return B?!1:M!==null?!M.acceptsBooleans:(g=g.toLowerCase().slice(0,5),g!=="data-"&&g!=="aria-");default:return!1}}function X(g,b,M,B){if(b===null||typeof b>"u"||K(g,b,M,B))return!0;if(B)return!1;if(M!==null)switch(M.type){case 3:return!b;case 4:return b===!1;case 5:return isNaN(b);case 6:return isNaN(b)||1>b}return!1}function Z(g,b,M,B,Y,se,Re){this.acceptsBooleans=b===2||b===3||b===4,this.attributeName=B,this.attributeNamespace=Y,this.mustUseProperty=M,this.propertyName=g,this.type=b,this.sanitizeURL=se,this.removeEmptyString=Re}var J={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(g){J[g]=new Z(g,0,!1,g,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(g){var b=g[0];J[b]=new Z(b,1,!1,g[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(g){J[g]=new Z(g,2,!1,g.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(g){J[g]=new Z(g,2,!1,g,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(g){J[g]=new Z(g,3,!1,g.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(g){J[g]=new Z(g,3,!0,g,null,!1,!1)}),["capture","download"].forEach(function(g){J[g]=new Z(g,4,!1,g,null,!1,!1)}),["cols","rows","size","span"].forEach(function(g){J[g]=new Z(g,6,!1,g,null,!1,!1)}),["rowSpan","start"].forEach(function(g){J[g]=new Z(g,5,!1,g.toLowerCase(),null,!1,!1)});var le=/[\-:]([a-z])/g;function de(g){return g[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(g){var b=g.replace(le,de);J[b]=new Z(b,1,!1,g,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(g){var b=g.replace(le,de);J[b]=new Z(b,1,!1,g,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(g){var b=g.replace(le,de);J[b]=new Z(b,1,!1,g,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(g){J[g]=new Z(g,1,!1,g.toLowerCase(),null,!1,!1)}),J.xlinkHref=new Z("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(g){J[g]=new Z(g,1,!1,g.toLowerCase(),null,!0,!0)});function ue(g,b,M,B){var Y=J.hasOwnProperty(b)?J[b]:null;(Y!==null?Y.type!==0:B||!(2<b.length)||b[0]!=="o"&&b[0]!=="O"||b[1]!=="n"&&b[1]!=="N")&&(X(b,M,Y,B)&&(M=null),B||Y===null?U(b)&&(M===null?g.removeAttribute(b):g.setAttribute(b,""+M)):Y.mustUseProperty?g[Y.propertyName]=M===null?Y.type===3?!1:"":M:(b=Y.attributeName,B=Y.attributeNamespace,M===null?g.removeAttribute(b):(Y=Y.type,M=Y===3||Y===4&&M===!0?"":""+M,B?g.setAttributeNS(B,b,M):g.setAttribute(b,M))))}var pe=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,he=Symbol.for("react.element"),xe=Symbol.for("react.portal"),fe=Symbol.for("react.fragment"),_e=Symbol.for("react.strict_mode"),Ce=Symbol.for("react.profiler"),je=Symbol.for("react.provider"),He=Symbol.for("react.context"),lt=Symbol.for("react.forward_ref"),_t=Symbol.for("react.suspense"),Ue=Symbol.for("react.suspense_list"),Ge=Symbol.for("react.memo"),at=Symbol.for("react.lazy"),yt=Symbol.for("react.offscreen"),tt=Symbol.iterator;function Rt(g){return g===null||typeof g!="object"?null:(g=tt&&g[tt]||g["@@iterator"],typeof g=="function"?g:null)}var ct=Object.assign,ze;function Ye(g){if(ze===void 0)try{throw Error()}catch(M){var b=M.stack.trim().match(/\n( *(at )?)/);ze=b&&b[1]||""}return`
`+ze+g}var At=!1;function Ct(g,b){if(!g||At)return"";At=!0;var M=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(b)if(b=function(){throw Error()},Object.defineProperty(b.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(b,[])}catch(Yt){var B=Yt}Reflect.construct(g,[],b)}else{try{b.call()}catch(Yt){B=Yt}g.call(b.prototype)}else{try{throw Error()}catch(Yt){B=Yt}g()}}catch(Yt){if(Yt&&B&&typeof Yt.stack=="string"){for(var Y=Yt.stack.split(`
`),se=B.stack.split(`
`),Re=Y.length-1,it=se.length-1;1<=Re&&0<=it&&Y[Re]!==se[it];)it--;for(;1<=Re&&0<=it;Re--,it--)if(Y[Re]!==se[it]){if(Re!==1||it!==1)do if(Re--,it--,0>it||Y[Re]!==se[it]){var xt=`
`+Y[Re].replace(" at new "," at ");return g.displayName&&xt.includes("<anonymous>")&&(xt=xt.replace("<anonymous>",g.displayName)),xt}while(1<=Re&&0<=it);break}}}finally{At=!1,Error.prepareStackTrace=M}return(g=g?g.displayName||g.name:"")?Ye(g):""}function We(g){switch(g.tag){case 5:return Ye(g.type);case 16:return Ye("Lazy");case 13:return Ye("Suspense");case 19:return Ye("SuspenseList");case 0:case 2:case 15:return g=Ct(g.type,!1),g;case 11:return g=Ct(g.type.render,!1),g;case 1:return g=Ct(g.type,!0),g;default:return""}}function st(g){if(g==null)return null;if(typeof g=="function")return g.displayName||g.name||null;if(typeof g=="string")return g;switch(g){case fe:return"Fragment";case xe:return"Portal";case Ce:return"Profiler";case _e:return"StrictMode";case _t:return"Suspense";case Ue:return"SuspenseList"}if(typeof g=="object")switch(g.$$typeof){case He:return(g.displayName||"Context")+".Consumer";case je:return(g._context.displayName||"Context")+".Provider";case lt:var b=g.render;return g=g.displayName,g||(g=b.displayName||b.name||"",g=g!==""?"ForwardRef("+g+")":"ForwardRef"),g;case Ge:return b=g.displayName||null,b!==null?b:st(g.type)||"Memo";case at:b=g._payload,g=g._init;try{return st(g(b))}catch{}}return null}function Bt(g){var b=g.type;switch(g.tag){case 24:return"Cache";case 9:return(b.displayName||"Context")+".Consumer";case 10:return(b._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return g=b.render,g=g.displayName||g.name||"",b.displayName||(g!==""?"ForwardRef("+g+")":"ForwardRef");case 7:return"Fragment";case 5:return b;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return st(b);case 8:return b===_e?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof b=="function")return b.displayName||b.name||null;if(typeof b=="string")return b}return null}function hn(g){switch(typeof g){case"boolean":case"number":case"string":case"undefined":return g;case"object":return g;default:return""}}function cn(g){var b=g.type;return(g=g.nodeName)&&g.toLowerCase()==="input"&&(b==="checkbox"||b==="radio")}function cr(g){var b=cn(g)?"checked":"value",M=Object.getOwnPropertyDescriptor(g.constructor.prototype,b),B=""+g[b];if(!g.hasOwnProperty(b)&&typeof M<"u"&&typeof M.get=="function"&&typeof M.set=="function"){var Y=M.get,se=M.set;return Object.defineProperty(g,b,{configurable:!0,get:function(){return Y.call(this)},set:function(Re){B=""+Re,se.call(this,Re)}}),Object.defineProperty(g,b,{enumerable:M.enumerable}),{getValue:function(){return B},setValue:function(Re){B=""+Re},stopTracking:function(){g._valueTracker=null,delete g[b]}}}}function Nn(g){g._valueTracker||(g._valueTracker=cr(g))}function Vn(g){if(!g)return!1;var b=g._valueTracker;if(!b)return!0;var M=b.getValue(),B="";return g&&(B=cn(g)?g.checked?"true":"false":g.value),g=B,g!==M?(b.setValue(g),!0):!1}function An(g){if(g=g||(typeof document<"u"?document:void 0),typeof g>"u")return null;try{return g.activeElement||g.body}catch{return g.body}}function Zt(g,b){var M=b.checked;return ct({},b,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:M??g._wrapperState.initialChecked})}function mn(g,b){var M=b.defaultValue==null?"":b.defaultValue,B=b.checked!=null?b.checked:b.defaultChecked;M=hn(b.value!=null?b.value:M),g._wrapperState={initialChecked:B,initialValue:M,controlled:b.type==="checkbox"||b.type==="radio"?b.checked!=null:b.value!=null}}function kr(g,b){b=b.checked,b!=null&&ue(g,"checked",b,!1)}function Gr(g,b){kr(g,b);var M=hn(b.value),B=b.type;if(M!=null)B==="number"?(M===0&&g.value===""||g.value!=M)&&(g.value=""+M):g.value!==""+M&&(g.value=""+M);else if(B==="submit"||B==="reset"){g.removeAttribute("value");return}b.hasOwnProperty("value")?Xn(g,b.type,M):b.hasOwnProperty("defaultValue")&&Xn(g,b.type,hn(b.defaultValue)),b.checked==null&&b.defaultChecked!=null&&(g.defaultChecked=!!b.defaultChecked)}function Yr(g,b,M){if(b.hasOwnProperty("value")||b.hasOwnProperty("defaultValue")){var B=b.type;if(!(B!=="submit"&&B!=="reset"||b.value!==void 0&&b.value!==null))return;b=""+g._wrapperState.initialValue,M||b===g.value||(g.value=b),g.defaultValue=b}M=g.name,M!==""&&(g.name=""),g.defaultChecked=!!g._wrapperState.initialChecked,M!==""&&(g.name=M)}function Xn(g,b,M){(b!=="number"||An(g.ownerDocument)!==g)&&(M==null?g.defaultValue=""+g._wrapperState.initialValue:g.defaultValue!==""+M&&(g.defaultValue=""+M))}var Lr=Array.isArray;function Or(g,b,M,B){if(g=g.options,b){b={};for(var Y=0;Y<M.length;Y++)b["$"+M[Y]]=!0;for(M=0;M<g.length;M++)Y=b.hasOwnProperty("$"+g[M].value),g[M].selected!==Y&&(g[M].selected=Y),Y&&B&&(g[M].defaultSelected=!0)}else{for(M=""+hn(M),b=null,Y=0;Y<g.length;Y++){if(g[Y].value===M){g[Y].selected=!0,B&&(g[Y].defaultSelected=!0);return}b!==null||g[Y].disabled||(b=g[Y])}b!==null&&(b.selected=!0)}}function is(g,b){if(b.dangerouslySetInnerHTML!=null)throw Error(o(91));return ct({},b,{value:void 0,defaultValue:void 0,children:""+g._wrapperState.initialValue})}function Zi(g,b){var M=b.value;if(M==null){if(M=b.children,b=b.defaultValue,M!=null){if(b!=null)throw Error(o(92));if(Lr(M)){if(1<M.length)throw Error(o(93));M=M[0]}b=M}b==null&&(b=""),M=b}g._wrapperState={initialValue:hn(M)}}function Dr(g,b){var M=hn(b.value),B=hn(b.defaultValue);M!=null&&(M=""+M,M!==g.value&&(g.value=M),b.defaultValue==null&&g.defaultValue!==M&&(g.defaultValue=M)),B!=null&&(g.defaultValue=""+B)}function Bi(g){var b=g.textContent;b===g._wrapperState.initialValue&&b!==""&&b!==null&&(g.value=b)}function Fr(g){switch(g){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Xi(g,b){return g==null||g==="http://www.w3.org/1999/xhtml"?Fr(b):g==="http://www.w3.org/2000/svg"&&b==="foreignObject"?"http://www.w3.org/1999/xhtml":g}var ei,ur=function(g){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(b,M,B,Y){MSApp.execUnsafeLocalFunction(function(){return g(b,M,B,Y)})}:g}(function(g,b){if(g.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in g)g.innerHTML=b;else{for(ei=ei||document.createElement("div"),ei.innerHTML="<svg>"+b.valueOf().toString()+"</svg>",b=ei.firstChild;g.firstChild;)g.removeChild(g.firstChild);for(;b.firstChild;)g.appendChild(b.firstChild)}});function us(g,b){if(b){var M=g.firstChild;if(M&&M===g.lastChild&&M.nodeType===3){M.nodeValue=b;return}}g.textContent=b}var ss={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Sr=["Webkit","ms","Moz","O"];Object.keys(ss).forEach(function(g){Sr.forEach(function(b){b=b+g.charAt(0).toUpperCase()+g.substring(1),ss[b]=ss[g]})});function On(g,b,M){return b==null||typeof b=="boolean"||b===""?"":M||typeof b!="number"||b===0||ss.hasOwnProperty(g)&&ss[g]?(""+b).trim():b+"px"}function Zr(g,b){g=g.style;for(var M in b)if(b.hasOwnProperty(M)){var B=M.indexOf("--")===0,Y=On(M,b[M],B);M==="float"&&(M="cssFloat"),B?g.setProperty(M,Y):g[M]=Y}}var Ki=ct({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ho(g,b){if(b){if(Ki[g]&&(b.children!=null||b.dangerouslySetInnerHTML!=null))throw Error(o(137,g));if(b.dangerouslySetInnerHTML!=null){if(b.children!=null)throw Error(o(60));if(typeof b.dangerouslySetInnerHTML!="object"||!("__html"in b.dangerouslySetInnerHTML))throw Error(o(61))}if(b.style!=null&&typeof b.style!="object")throw Error(o(62))}}function gl(g,b){if(g.indexOf("-")===-1)return typeof b.is=="string";switch(g){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ei=null;function Sa(g){return g=g.target||g.srcElement||window,g.correspondingUseElement&&(g=g.correspondingUseElement),g.nodeType===3?g.parentNode:g}var Nc=null,xo=null,_l=null;function Ph(g){if(g=$u(g)){if(typeof Nc!="function")throw Error(o(280));var b=g.stateNode;b&&(b=Ud(b),Nc(g.stateNode,g.type,b))}}function _d(g){xo?_l?_l.push(g):_l=[g]:xo=g}function Qt(){if(xo){var g=xo,b=_l;if(_l=xo=null,Ph(g),b)for(g=0;g<b.length;g++)Ph(b[g])}}function yl(g,b){return g(b)}function Ah(){}var wt=!1;function ie(g,b,M){if(wt)return g(b,M);wt=!0;try{return yl(g,b,M)}finally{wt=!1,(xo!==null||_l!==null)&&(Ah(),Qt())}}function me(g,b){var M=g.stateNode;if(M===null)return null;var B=Ud(M);if(B===null)return null;M=B[b];e:switch(b){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(B=!B.disabled)||(g=g.type,B=!(g==="button"||g==="input"||g==="select"||g==="textarea")),g=!B;break e;default:g=!1}if(g)return null;if(M&&typeof M!="function")throw Error(o(231,b,typeof M));return M}var Le=!1;if(i)try{var Be={};Object.defineProperty(Be,"passive",{get:function(){Le=!0}}),window.addEventListener("test",Be,Be),window.removeEventListener("test",Be,Be)}catch{Le=!1}function Ve(g,b,M,B,Y,se,Re,it,xt){var Yt=Array.prototype.slice.call(arguments,3);try{b.apply(M,Yt)}catch(Mn){this.onError(Mn)}}var qe=!1,Xe=null,Ke=!1,pt=null,Lt={onError:function(g){qe=!0,Xe=g}};function ft(g,b,M,B,Y,se,Re,it,xt){qe=!1,Xe=null,Ve.apply(Lt,arguments)}function tn(g,b,M,B,Y,se,Re,it,xt){if(ft.apply(this,arguments),qe){if(qe){var Yt=Xe;qe=!1,Xe=null}else throw Error(o(198));Ke||(Ke=!0,pt=Yt)}}function ln(g){var b=g,M=g;if(g.alternate)for(;b.return;)b=b.return;else{g=b;do b=g,(b.flags&4098)!==0&&(M=b.return),g=b.return;while(g)}return b.tag===3?M:null}function xn(g){if(g.tag===13){var b=g.memoizedState;if(b===null&&(g=g.alternate,g!==null&&(b=g.memoizedState)),b!==null)return b.dehydrated}return null}function Zn(g){if(ln(g)!==g)throw Error(o(188))}function Yn(g){var b=g.alternate;if(!b){if(b=ln(g),b===null)throw Error(o(188));return b!==g?null:g}for(var M=g,B=b;;){var Y=M.return;if(Y===null)break;var se=Y.alternate;if(se===null){if(B=Y.return,B!==null){M=B;continue}break}if(Y.child===se.child){for(se=Y.child;se;){if(se===M)return Zn(Y),g;if(se===B)return Zn(Y),b;se=se.sibling}throw Error(o(188))}if(M.return!==B.return)M=Y,B=se;else{for(var Re=!1,it=Y.child;it;){if(it===M){Re=!0,M=Y,B=se;break}if(it===B){Re=!0,B=Y,M=se;break}it=it.sibling}if(!Re){for(it=se.child;it;){if(it===M){Re=!0,M=se,B=Y;break}if(it===B){Re=!0,B=se,M=Y;break}it=it.sibling}if(!Re)throw Error(o(189))}}if(M.alternate!==B)throw Error(o(190))}if(M.tag!==3)throw Error(o(188));return M.stateNode.current===M?g:b}function rr(g){return g=Yn(g),g!==null?pr(g):null}function pr(g){if(g.tag===5||g.tag===6)return g;for(g=g.child;g!==null;){var b=pr(g);if(b!==null)return b;g=g.sibling}return null}var Vi=n.unstable_scheduleCallback,gr=n.unstable_cancelCallback,gi=n.unstable_shouldYield,Hr=n.unstable_requestPaint,vr=n.unstable_now,xi=n.unstable_getCurrentPriorityLevel,Qi=n.unstable_ImmediatePriority,bs=n.unstable_UserBlockingPriority,Es=n.unstable_NormalPriority,eo=n.unstable_LowPriority,vl=n.unstable_IdlePriority,$s=null,ms=null;function Hs(g){if(ms&&typeof ms.onCommitFiberRoot=="function")try{ms.onCommitFiberRoot($s,g,void 0,(g.current.flags&128)===128)}catch{}}var os=Math.clz32?Math.clz32:Rh,xl=Math.log,Eu=Math.LN2;function Rh(g){return g>>>=0,g===0?32:31-(xl(g)/Eu|0)|0}var rc=64,Iu=4194304;function ic(g){switch(g&-g){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return g&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return g}}function bl(g,b){var M=g.pendingLanes;if(M===0)return 0;var B=0,Y=g.suspendedLanes,se=g.pingedLanes,Re=M&268435455;if(Re!==0){var it=Re&~Y;it!==0?B=ic(it):(se&=Re,se!==0&&(B=ic(se)))}else Re=M&~Y,Re!==0?B=ic(Re):se!==0&&(B=ic(se));if(B===0)return 0;if(b!==0&&b!==B&&(b&Y)===0&&(Y=B&-B,se=b&-b,Y>=se||Y===16&&(se&4194240)!==0))return b;if((B&4)!==0&&(B|=M&16),b=g.entangledLanes,b!==0)for(g=g.entanglements,b&=B;0<b;)M=31-os(b),Y=1<<M,B|=g[M],b&=~Y;return B}function Mh(g,b){switch(g){case 1:case 2:case 4:return b+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return b+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function tm(g,b){for(var M=g.suspendedLanes,B=g.pingedLanes,Y=g.expirationTimes,se=g.pendingLanes;0<se;){var Re=31-os(se),it=1<<Re,xt=Y[Re];xt===-1?((it&M)===0||(it&B)!==0)&&(Y[Re]=Mh(it,b)):xt<=b&&(g.expiredLanes|=it),se&=~it}}function sa(g){return g=g.pendingLanes&-1073741825,g!==0?g:g&1073741824?1073741824:0}function Of(){var g=rc;return rc<<=1,(rc&4194240)===0&&(rc=64),g}function Do(g){for(var b=[],M=0;31>M;M++)b.push(g);return b}function Ho(g,b,M){g.pendingLanes|=b,b!==536870912&&(g.suspendedLanes=0,g.pingedLanes=0),g=g.eventTimes,b=31-os(b),g[b]=M}function sc(g,b){var M=g.pendingLanes&~b;g.pendingLanes=b,g.suspendedLanes=0,g.pingedLanes=0,g.expiredLanes&=b,g.mutableReadLanes&=b,g.entangledLanes&=b,b=g.entanglements;var B=g.eventTimes;for(g=g.expirationTimes;0<M;){var Y=31-os(M),se=1<<Y;b[Y]=0,B[Y]=-1,g[Y]=-1,M&=~se}}function oa(g,b){var M=g.entangledLanes|=b;for(g=g.entanglements;M;){var B=31-os(M),Y=1<<B;Y&b|g[B]&b&&(g[B]|=b),M&=~Y}}var wi=0;function aa(g){return g&=-g,1<g?4<g?(g&268435455)!==0?16:536870912:4:1}var yd,Lh,wl,vd,zf,Pu=!1,to=[],Ka=null,Ya=null,la=null,xd=new Map,jc=new Map,Ja=[],Br="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Au(g,b){switch(g){case"focusin":case"focusout":Ka=null;break;case"dragenter":case"dragleave":Ya=null;break;case"mouseover":case"mouseout":la=null;break;case"pointerover":case"pointerout":xd.delete(b.pointerId);break;case"gotpointercapture":case"lostpointercapture":jc.delete(b.pointerId)}}function Sl(g,b,M,B,Y,se){return g===null||g.nativeEvent!==se?(g={blockedOn:b,domEventName:M,eventSystemFlags:B,nativeEvent:se,targetContainers:[Y]},b!==null&&(b=$u(b),b!==null&&Lh(b)),g):(g.eventSystemFlags|=B,b=g.targetContainers,Y!==null&&b.indexOf(Y)===-1&&b.push(Y),g)}function K_(g,b,M,B,Y){switch(b){case"focusin":return Ka=Sl(Ka,g,b,M,B,Y),!0;case"dragenter":return Ya=Sl(Ya,g,b,M,B,Y),!0;case"mouseover":return la=Sl(la,g,b,M,B,Y),!0;case"pointerover":var se=Y.pointerId;return xd.set(se,Sl(xd.get(se)||null,g,b,M,B,Y)),!0;case"gotpointercapture":return se=Y.pointerId,jc.set(se,Sl(jc.get(se)||null,g,b,M,B,Y)),!0}return!1}function nm(g){var b=gc(g.target);if(b!==null){var M=ln(b);if(M!==null){if(b=M.tag,b===13){if(b=xn(M),b!==null){g.blockedOn=b,zf(g.priority,function(){wl(M)});return}}else if(b===3&&M.stateNode.current.memoizedState.isDehydrated){g.blockedOn=M.tag===3?M.stateNode.containerInfo:null;return}}}g.blockedOn=null}function Cl(g){if(g.blockedOn!==null)return!1;for(var b=g.targetContainers;0<b.length;){var M=Tl(g.domEventName,g.eventSystemFlags,b[0],g.nativeEvent);if(M===null){M=g.nativeEvent;var B=new M.constructor(M.type,M);Ei=B,M.target.dispatchEvent(B),Ei=null}else return b=$u(M),b!==null&&Lh(b),g.blockedOn=M,!1;b.shift()}return!0}function oc(g,b,M){Cl(g)&&M.delete(b)}function bd(){Pu=!1,Ka!==null&&Cl(Ka)&&(Ka=null),Ya!==null&&Cl(Ya)&&(Ya=null),la!==null&&Cl(la)&&(la=null),xd.forEach(oc),jc.forEach(oc)}function wd(g,b){g.blockedOn===b&&(g.blockedOn=null,Pu||(Pu=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,bd)))}function Ru(g){function b(Y){return wd(Y,g)}if(0<to.length){wd(to[0],g);for(var M=1;M<to.length;M++){var B=to[M];B.blockedOn===g&&(B.blockedOn=null)}}for(Ka!==null&&wd(Ka,g),Ya!==null&&wd(Ya,g),la!==null&&wd(la,g),xd.forEach(b),jc.forEach(b),M=0;M<Ja.length;M++)B=Ja[M],B.blockedOn===g&&(B.blockedOn=null);for(;0<Ja.length&&(M=Ja[0],M.blockedOn===null);)nm(M),M.blockedOn===null&&Ja.shift()}var Ca=pe.ReactCurrentBatchConfig,Bc=!0;function Sd(g,b,M,B){var Y=wi,se=Ca.transition;Ca.transition=null;try{wi=1,Dh(g,b,M,B)}finally{wi=Y,Ca.transition=se}}function Ff(g,b,M,B){var Y=wi,se=Ca.transition;Ca.transition=null;try{wi=4,Dh(g,b,M,B)}finally{wi=Y,Ca.transition=se}}function Dh(g,b,M,B){if(Bc){var Y=Tl(g,b,M,B);if(Y===null)um(g,b,B,bo,M),Au(g,B);else if(K_(Y,g,b,M,B))B.stopPropagation();else if(Au(g,B),b&4&&-1<Br.indexOf(g)){for(;Y!==null;){var se=$u(Y);if(se!==null&&yd(se),se=Tl(g,b,M,B),se===null&&um(g,b,B,bo,M),se===Y)break;Y=se}Y!==null&&B.stopPropagation()}else um(g,b,B,null,M)}}var bo=null;function Tl(g,b,M,B){if(bo=null,g=Sa(B),g=gc(g),g!==null)if(b=ln(g),b===null)g=null;else if(M=b.tag,M===13){if(g=xn(b),g!==null)return g;g=null}else if(M===3){if(b.stateNode.current.memoizedState.isDehydrated)return b.tag===3?b.stateNode.containerInfo:null;g=null}else b!==g&&(g=null);return bo=g,null}function Nf(g){switch(g){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xi()){case Qi:return 1;case bs:return 4;case Es:case eo:return 16;case vl:return 536870912;default:return 16}default:return 16}}var El=null,Cd=null,Il=null;function Go(){if(Il)return Il;var g,b=Cd,M=b.length,B,Y="value"in El?El.value:El.textContent,se=Y.length;for(g=0;g<M&&b[g]===Y[g];g++);var Re=M-g;for(B=1;B<=Re&&b[M-B]===Y[se-B];B++);return Il=Y.slice(g,1<B?1-B:void 0)}function Td(g){var b=g.keyCode;return"charCode"in g?(g=g.charCode,g===0&&b===13&&(g=13)):g=b,g===10&&(g=13),32<=g||g===13?g:0}function Mu(){return!0}function Ed(){return!1}function xr(g){function b(M,B,Y,se,Re){this._reactName=M,this._targetInst=Y,this.type=B,this.nativeEvent=se,this.target=Re,this.currentTarget=null;for(var it in g)g.hasOwnProperty(it)&&(M=g[it],this[it]=M?M(se):se[it]);return this.isDefaultPrevented=(se.defaultPrevented!=null?se.defaultPrevented:se.returnValue===!1)?Mu:Ed,this.isPropagationStopped=Ed,this}return ct(b.prototype,{preventDefault:function(){this.defaultPrevented=!0;var M=this.nativeEvent;M&&(M.preventDefault?M.preventDefault():typeof M.returnValue!="unknown"&&(M.returnValue=!1),this.isDefaultPrevented=Mu)},stopPropagation:function(){var M=this.nativeEvent;M&&(M.stopPropagation?M.stopPropagation():typeof M.cancelBubble!="unknown"&&(M.cancelBubble=!0),this.isPropagationStopped=Mu)},persist:function(){},isPersistent:Mu}),b}var Lu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(g){return g.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},kn=xr(Lu),Id=ct({},Lu,{view:0,detail:0}),jf=xr(Id),Pd,Du,ko,Pl=ct({},Id,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Uc,button:0,buttons:0,relatedTarget:function(g){return g.relatedTarget===void 0?g.fromElement===g.srcElement?g.toElement:g.fromElement:g.relatedTarget},movementX:function(g){return"movementX"in g?g.movementX:(g!==ko&&(ko&&g.type==="mousemove"?(Pd=g.screenX-ko.screenX,Du=g.screenY-ko.screenY):Du=Pd=0,ko=g),Pd)},movementY:function(g){return"movementY"in g?g.movementY:Du}}),ac=xr(Pl),Pn=ct({},Pl,{dataTransfer:0}),ui=xr(Pn),ti=ct({},Id,{relatedTarget:0}),wo=xr(ti),Vc=ct({},Lu,{animationName:0,elapsedTime:0,pseudoElement:0}),Jr=xr(Vc),ku=ct({},Lu,{clipboardData:function(g){return"clipboardData"in g?g.clipboardData:window.clipboardData}}),kh=xr(ku),Oh=ct({},Lu,{data:0}),So=xr(Oh),Is={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Y_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rm(g){var b=this.nativeEvent;return b.getModifierState?b.getModifierState(g):(g=zh[g])?!!b[g]:!1}function Uc(){return rm}var $c=ct({},Id,{key:function(g){if(g.key){var b=Is[g.key]||g.key;if(b!=="Unidentified")return b}return g.type==="keypress"?(g=Td(g),g===13?"Enter":String.fromCharCode(g)):g.type==="keydown"||g.type==="keyup"?Y_[g.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Uc,charCode:function(g){return g.type==="keypress"?Td(g):0},keyCode:function(g){return g.type==="keydown"||g.type==="keyup"?g.keyCode:0},which:function(g){return g.type==="keypress"?Td(g):g.type==="keydown"||g.type==="keyup"?g.keyCode:0}}),Bf=xr($c),Oo=ct({},Pl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ta=xr(Oo),Wo=ct({},Id,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Uc}),xg=xr(Wo),Ad=ct({},Lu,{propertyName:0,elapsedTime:0,pseudoElement:0}),ks=xr(Ad),zo=ct({},Pl,{deltaX:function(g){return"deltaX"in g?g.deltaX:"wheelDeltaX"in g?-g.wheelDeltaX:0},deltaY:function(g){return"deltaY"in g?g.deltaY:"wheelDeltaY"in g?-g.wheelDeltaY:"wheelDelta"in g?-g.wheelDelta:0},deltaZ:0,deltaMode:0}),or=xr(zo),gn=[9,13,27,32],Ou=i&&"CompositionEvent"in window,zn=null;i&&"documentMode"in document&&(zn=document.documentMode);var zu=i&&"TextEvent"in window&&!zn,Fu=i&&(!Ou||zn&&8<zn&&11>=zn),Bn=" ",im=!1;function Ea(g,b){switch(g){case"keyup":return gn.indexOf(b.keyCode)!==-1;case"keydown":return b.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sm(g){return g=g.detail,typeof g=="object"&&"data"in g?g.data:null}var lc=!1;function Co(g,b){switch(g){case"compositionend":return sm(b);case"keypress":return b.which!==32?null:(im=!0,Bn);case"textInput":return g=b.data,g===Bn&&im?null:g;default:return null}}function Fo(g,b){if(lc)return g==="compositionend"||!Ou&&Ea(g,b)?(g=Go(),Il=Cd=El=null,lc=!1,g):null;switch(g){case"paste":return null;case"keypress":if(!(b.ctrlKey||b.altKey||b.metaKey)||b.ctrlKey&&b.altKey){if(b.char&&1<b.char.length)return b.char;if(b.which)return String.fromCharCode(b.which)}return null;case"compositionend":return Fu&&b.locale!=="ko"?null:b.data;default:return null}}var Rd={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function cc(g){var b=g&&g.nodeName&&g.nodeName.toLowerCase();return b==="input"?!!Rd[g.type]:b==="textarea"}function Hc(g,b,M,B){_d(B),b=Fd(b,"onChange"),0<b.length&&(M=new kn("onChange","change",null,M,B),g.push({event:M,listeners:b}))}var Qa=null,Gs=null;function Fh(g){Tg(g,0)}function Gc(g){var b=Jc(g);if(Vn(b))return g}function J_(g,b){if(g==="change")return b}var Al=!1;if(i){var Nh;if(i){var Ia="oninput"in document;if(!Ia){var Vf=document.createElement("div");Vf.setAttribute("oninput","return;"),Ia=typeof Vf.oninput=="function"}Nh=Ia}else Nh=!1;Al=Nh&&(!document.documentMode||9<document.documentMode)}function uc(){Qa&&(Qa.detachEvent("onpropertychange",bg),Gs=Qa=null)}function bg(g){if(g.propertyName==="value"&&Gc(Gs)){var b=[];Hc(b,Gs,g,Sa(g)),ie(Fh,b)}}function Q_(g,b,M){g==="focusin"?(uc(),Qa=b,Gs=M,Qa.attachEvent("onpropertychange",bg)):g==="focusout"&&uc()}function wg(g){if(g==="selectionchange"||g==="keyup"||g==="keydown")return Gc(Gs)}function Sg(g,b){if(g==="click")return Gc(b)}function ey(g,b){if(g==="input"||g==="change")return Gc(b)}function Uf(g,b){return g===b&&(g!==0||1/g===1/b)||g!==g&&b!==b}var Pa=typeof Object.is=="function"?Object.is:Uf;function Aa(g,b){if(Pa(g,b))return!0;if(typeof g!="object"||g===null||typeof b!="object"||b===null)return!1;var M=Object.keys(g),B=Object.keys(b);if(M.length!==B.length)return!1;for(B=0;B<M.length;B++){var Y=M[B];if(!I.call(b,Y)||!Pa(g[Y],b[Y]))return!1}return!0}function om(g){for(;g&&g.firstChild;)g=g.firstChild;return g}function am(g,b){var M=om(g);g=0;for(var B;M;){if(M.nodeType===3){if(B=g+M.textContent.length,g<=b&&B>=b)return{node:M,offset:b-g};g=B}e:{for(;M;){if(M.nextSibling){M=M.nextSibling;break e}M=M.parentNode}M=void 0}M=om(M)}}function Rl(g,b){return g&&b?g===b?!0:g&&g.nodeType===3?!1:b&&b.nodeType===3?Rl(g,b.parentNode):"contains"in g?g.contains(b):g.compareDocumentPosition?!!(g.compareDocumentPosition(b)&16):!1:!1}function Md(){for(var g=window,b=An();b instanceof g.HTMLIFrameElement;){try{var M=typeof b.contentWindow.location.href=="string"}catch{M=!1}if(M)g=b.contentWindow;else break;b=An(g.document)}return b}function jh(g){var b=g&&g.nodeName&&g.nodeName.toLowerCase();return b&&(b==="input"&&(g.type==="text"||g.type==="search"||g.type==="tel"||g.type==="url"||g.type==="password")||b==="textarea"||g.contentEditable==="true")}function Ra(g){var b=Md(),M=g.focusedElem,B=g.selectionRange;if(b!==M&&M&&M.ownerDocument&&Rl(M.ownerDocument.documentElement,M)){if(B!==null&&jh(M)){if(b=B.start,g=B.end,g===void 0&&(g=b),"selectionStart"in M)M.selectionStart=b,M.selectionEnd=Math.min(g,M.value.length);else if(g=(b=M.ownerDocument||document)&&b.defaultView||window,g.getSelection){g=g.getSelection();var Y=M.textContent.length,se=Math.min(B.start,Y);B=B.end===void 0?se:Math.min(B.end,Y),!g.extend&&se>B&&(Y=B,B=se,se=Y),Y=am(M,se);var Re=am(M,B);Y&&Re&&(g.rangeCount!==1||g.anchorNode!==Y.node||g.anchorOffset!==Y.offset||g.focusNode!==Re.node||g.focusOffset!==Re.offset)&&(b=b.createRange(),b.setStart(Y.node,Y.offset),g.removeAllRanges(),se>B?(g.addRange(b),g.extend(Re.node,Re.offset)):(b.setEnd(Re.node,Re.offset),g.addRange(b)))}}for(b=[],g=M;g=g.parentNode;)g.nodeType===1&&b.push({element:g,left:g.scrollLeft,top:g.scrollTop});for(typeof M.focus=="function"&&M.focus(),M=0;M<b.length;M++)g=b[M],g.element.scrollLeft=g.left,g.element.scrollTop=g.top}}var Ld=i&&"documentMode"in document&&11>=document.documentMode,el=null,Bh=null,Wc=null,qo=!1;function Vh(g,b,M){var B=M.window===M?M.document:M.nodeType===9?M:M.ownerDocument;qo||el==null||el!==An(B)||(B=el,"selectionStart"in B&&jh(B)?B={start:B.selectionStart,end:B.selectionEnd}:(B=(B.ownerDocument&&B.ownerDocument.defaultView||window).getSelection(),B={anchorNode:B.anchorNode,anchorOffset:B.anchorOffset,focusNode:B.focusNode,focusOffset:B.focusOffset}),Wc&&Aa(Wc,B)||(Wc=B,B=Fd(Bh,"onSelect"),0<B.length&&(b=new kn("onSelect","select",null,b,M),g.push({event:b,listeners:B}),b.target=el)))}function en(g,b){var M={};return M[g.toLowerCase()]=b.toLowerCase(),M["Webkit"+g]="webkit"+b,M["Moz"+g]="moz"+b,M}var qc={animationend:en("Animation","AnimationEnd"),animationiteration:en("Animation","AnimationIteration"),animationstart:en("Animation","AnimationStart"),transitionend:en("Transition","TransitionEnd")},Dd={},Uh={};i&&(Uh=document.createElement("div").style,"AnimationEvent"in window||(delete qc.animationend.animation,delete qc.animationiteration.animation,delete qc.animationstart.animation),"TransitionEvent"in window||delete qc.transitionend.transition);function kd(g){if(Dd[g])return Dd[g];if(!qc[g])return g;var b=qc[g],M;for(M in b)if(b.hasOwnProperty(M)&&M in Uh)return Dd[g]=b[M];return g}var Zc=kd("animationend"),ca=kd("animationiteration"),Nu=kd("animationstart"),dc=kd("transitionend"),Od=new Map,Xc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ua(g,b){Od.set(g,b),y(b,[g])}for(var Ar=0;Ar<Xc.length;Ar++){var $h=Xc[Ar],ty=$h.toLowerCase(),Cg=$h[0].toUpperCase()+$h.slice(1);ua(ty,"on"+Cg)}ua(Zc,"onAnimationEnd"),ua(ca,"onAnimationIteration"),ua(Nu,"onAnimationStart"),ua("dblclick","onDoubleClick"),ua("focusin","onFocus"),ua("focusout","onBlur"),ua(dc,"onTransitionEnd"),x("onMouseEnter",["mouseout","mouseover"]),x("onMouseLeave",["mouseout","mouseover"]),x("onPointerEnter",["pointerout","pointerover"]),x("onPointerLeave",["pointerout","pointerover"]),y("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),y("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),y("onBeforeInput",["compositionend","keypress","textInput","paste"]),y("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),y("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),y("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ju="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),lm=new Set("cancel close invalid load scroll toggle".split(" ").concat(ju));function Ui(g,b,M){var B=g.type||"unknown-event";g.currentTarget=M,tn(B,b,void 0,g),g.currentTarget=null}function Tg(g,b){b=(b&4)!==0;for(var M=0;M<g.length;M++){var B=g[M],Y=B.event;B=B.listeners;e:{var se=void 0;if(b)for(var Re=B.length-1;0<=Re;Re--){var it=B[Re],xt=it.instance,Yt=it.currentTarget;if(it=it.listener,xt!==se&&Y.isPropagationStopped())break e;Ui(Y,it,Yt),se=xt}else for(Re=0;Re<B.length;Re++){if(it=B[Re],xt=it.instance,Yt=it.currentTarget,it=it.listener,xt!==se&&Y.isPropagationStopped())break e;Ui(Y,it,Yt),se=xt}}}if(Ke)throw g=pt,Ke=!1,pt=null,g}function ws(g,b){var M=b[qh];M===void 0&&(M=b[qh]=new Set);var B=g+"__bubble";M.has(B)||(Wh(b,g,2,!1),M.add(B))}function cm(g,b,M){var B=0;b&&(B|=4),Wh(M,g,B,b)}var Hh="_reactListening"+Math.random().toString(36).slice(2);function Gh(g){if(!g[Hh]){g[Hh]=!0,c.forEach(function(M){M!=="selectionchange"&&(lm.has(M)||cm(M,!1,g),cm(M,!0,g))});var b=g.nodeType===9?g:g.ownerDocument;b===null||b[Hh]||(b[Hh]=!0,cm("selectionchange",!1,b))}}function Wh(g,b,M,B){switch(Nf(b)){case 1:var Y=Sd;break;case 4:Y=Ff;break;default:Y=Dh}M=Y.bind(null,b,M,g),Y=void 0,!Le||b!=="touchstart"&&b!=="touchmove"&&b!=="wheel"||(Y=!0),B?Y!==void 0?g.addEventListener(b,M,{capture:!0,passive:Y}):g.addEventListener(b,M,!0):Y!==void 0?g.addEventListener(b,M,{passive:Y}):g.addEventListener(b,M,!1)}function um(g,b,M,B,Y){var se=B;if((b&1)===0&&(b&2)===0&&B!==null)e:for(;;){if(B===null)return;var Re=B.tag;if(Re===3||Re===4){var it=B.stateNode.containerInfo;if(it===Y||it.nodeType===8&&it.parentNode===Y)break;if(Re===4)for(Re=B.return;Re!==null;){var xt=Re.tag;if((xt===3||xt===4)&&(xt=Re.stateNode.containerInfo,xt===Y||xt.nodeType===8&&xt.parentNode===Y))return;Re=Re.return}for(;it!==null;){if(Re=gc(it),Re===null)return;if(xt=Re.tag,xt===5||xt===6){B=se=Re;continue e}it=it.parentNode}}B=B.return}ie(function(){var Yt=se,Mn=Sa(M),Dn=[];e:{var In=Od.get(g);if(In!==void 0){var Kn=kn,hr=g;switch(g){case"keypress":if(Td(M)===0)break e;case"keydown":case"keyup":Kn=Bf;break;case"focusin":hr="focus",Kn=wo;break;case"focusout":hr="blur",Kn=wo;break;case"beforeblur":case"afterblur":Kn=wo;break;case"click":if(M.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Kn=ac;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Kn=ui;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Kn=xg;break;case Zc:case ca:case Nu:Kn=Jr;break;case dc:Kn=ks;break;case"scroll":Kn=jf;break;case"wheel":Kn=or;break;case"copy":case"cut":case"paste":Kn=kh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Kn=Ta}var _r=(b&4)!==0,Ys=!_r&&g==="scroll",Ut=_r?In!==null?In+"Capture":null:In;_r=[];for(var Pt=Yt,$t;Pt!==null;){$t=Pt;var Tn=$t.stateNode;if($t.tag===5&&Tn!==null&&($t=Tn,Ut!==null&&(Tn=me(Pt,Ut),Tn!=null&&_r.push(zd(Pt,Tn,$t)))),Ys)break;Pt=Pt.return}0<_r.length&&(In=new Kn(In,hr,null,M,Mn),Dn.push({event:In,listeners:_r}))}}if((b&7)===0){e:{if(In=g==="mouseover"||g==="pointerover",Kn=g==="mouseout"||g==="pointerout",In&&M!==Ei&&(hr=M.relatedTarget||M.fromElement)&&(gc(hr)||hr[mc]))break e;if((Kn||In)&&(In=Mn.window===Mn?Mn:(In=Mn.ownerDocument)?In.defaultView||In.parentWindow:window,Kn?(hr=M.relatedTarget||M.toElement,Kn=Yt,hr=hr?gc(hr):null,hr!==null&&(Ys=ln(hr),hr!==Ys||hr.tag!==5&&hr.tag!==6)&&(hr=null)):(Kn=null,hr=Yt),Kn!==hr)){if(_r=ac,Tn="onMouseLeave",Ut="onMouseEnter",Pt="mouse",(g==="pointerout"||g==="pointerover")&&(_r=Ta,Tn="onPointerLeave",Ut="onPointerEnter",Pt="pointer"),Ys=Kn==null?In:Jc(Kn),$t=hr==null?In:Jc(hr),In=new _r(Tn,Pt+"leave",Kn,M,Mn),In.target=Ys,In.relatedTarget=$t,Tn=null,gc(Mn)===Yt&&(_r=new _r(Ut,Pt+"enter",hr,M,Mn),_r.target=$t,_r.relatedTarget=Ys,Tn=_r),Ys=Tn,Kn&&hr)t:{for(_r=Kn,Ut=hr,Pt=0,$t=_r;$t;$t=hc($t))Pt++;for($t=0,Tn=Ut;Tn;Tn=hc(Tn))$t++;for(;0<Pt-$t;)_r=hc(_r),Pt--;for(;0<$t-Pt;)Ut=hc(Ut),$t--;for(;Pt--;){if(_r===Ut||Ut!==null&&_r===Ut.alternate)break t;_r=hc(_r),Ut=hc(Ut)}_r=null}else _r=null;Kn!==null&&$f(Dn,In,Kn,_r,!1),hr!==null&&Ys!==null&&$f(Dn,Ys,hr,_r,!0)}}e:{if(In=Yt?Jc(Yt):window,Kn=In.nodeName&&In.nodeName.toLowerCase(),Kn==="select"||Kn==="input"&&In.type==="file")var wr=J_;else if(cc(In))if(Al)wr=ey;else{wr=wg;var Rr=Q_}else(Kn=In.nodeName)&&Kn.toLowerCase()==="input"&&(In.type==="checkbox"||In.type==="radio")&&(wr=Sg);if(wr&&(wr=wr(g,Yt))){Hc(Dn,wr,M,Mn);break e}Rr&&Rr(g,In,Yt),g==="focusout"&&(Rr=In._wrapperState)&&Rr.controlled&&In.type==="number"&&Xn(In,"number",In.value)}switch(Rr=Yt?Jc(Yt):window,g){case"focusin":(cc(Rr)||Rr.contentEditable==="true")&&(el=Rr,Bh=Yt,Wc=null);break;case"focusout":Wc=Bh=el=null;break;case"mousedown":qo=!0;break;case"contextmenu":case"mouseup":case"dragend":qo=!1,Vh(Dn,M,Mn);break;case"selectionchange":if(Ld)break;case"keydown":case"keyup":Vh(Dn,M,Mn)}var Ur;if(Ou)e:{switch(g){case"compositionstart":var Qr="onCompositionStart";break e;case"compositionend":Qr="onCompositionEnd";break e;case"compositionupdate":Qr="onCompositionUpdate";break e}Qr=void 0}else lc?Ea(g,M)&&(Qr="onCompositionEnd"):g==="keydown"&&M.keyCode===229&&(Qr="onCompositionStart");Qr&&(Fu&&M.locale!=="ko"&&(lc||Qr!=="onCompositionStart"?Qr==="onCompositionEnd"&&lc&&(Ur=Go()):(El=Mn,Cd="value"in El?El.value:El.textContent,lc=!0)),Rr=Fd(Yt,Qr),0<Rr.length&&(Qr=new So(Qr,g,null,M,Mn),Dn.push({event:Qr,listeners:Rr}),Ur?Qr.data=Ur:(Ur=sm(M),Ur!==null&&(Qr.data=Ur)))),(Ur=zu?Co(g,M):Fo(g,M))&&(Yt=Fd(Yt,"onBeforeInput"),0<Yt.length&&(Mn=new So("onBeforeInput","beforeinput",null,M,Mn),Dn.push({event:Mn,listeners:Yt}),Mn.data=Ur))}Tg(Dn,b)})}function zd(g,b,M){return{instance:g,listener:b,currentTarget:M}}function Fd(g,b){for(var M=b+"Capture",B=[];g!==null;){var Y=g,se=Y.stateNode;Y.tag===5&&se!==null&&(Y=se,se=me(g,M),se!=null&&B.unshift(zd(g,se,Y)),se=me(g,b),se!=null&&B.push(zd(g,se,Y))),g=g.return}return B}function hc(g){if(g===null)return null;do g=g.return;while(g&&g.tag!==5);return g||null}function $f(g,b,M,B,Y){for(var se=b._reactName,Re=[];M!==null&&M!==B;){var it=M,xt=it.alternate,Yt=it.stateNode;if(xt!==null&&xt===B)break;it.tag===5&&Yt!==null&&(it=Yt,Y?(xt=me(M,se),xt!=null&&Re.unshift(zd(M,xt,it))):Y||(xt=me(M,se),xt!=null&&Re.push(zd(M,xt,it)))),M=M.return}Re.length!==0&&g.push({event:b,listeners:Re})}var Bu=/\r\n?/g,dm=/\u0000|\uFFFD/g;function hm(g){return(typeof g=="string"?g:""+g).replace(Bu,`
`).replace(dm,"")}function fc(g,b,M){if(b=hm(b),hm(g)!==b&&M)throw Error(o(425))}function Kc(){}var Nd=null,jd=null;function Yc(g,b){return g==="textarea"||g==="noscript"||typeof b.children=="string"||typeof b.children=="number"||typeof b.dangerouslySetInnerHTML=="object"&&b.dangerouslySetInnerHTML!==null&&b.dangerouslySetInnerHTML.__html!=null}var Bd=typeof setTimeout=="function"?setTimeout:void 0,fm=typeof clearTimeout=="function"?clearTimeout:void 0,pm=typeof Promise=="function"?Promise:void 0,mm=typeof queueMicrotask=="function"?queueMicrotask:typeof pm<"u"?function(g){return pm.resolve(null).then(g).catch(Hf)}:Bd;function Hf(g){setTimeout(function(){throw g})}function Vu(g,b){var M=b,B=0;do{var Y=M.nextSibling;if(g.removeChild(M),Y&&Y.nodeType===8)if(M=Y.data,M==="/$"){if(B===0){g.removeChild(Y),Ru(b);return}B--}else M!=="$"&&M!=="$?"&&M!=="$!"||B++;M=Y}while(M);Ru(b)}function pc(g){for(;g!=null;g=g.nextSibling){var b=g.nodeType;if(b===1||b===3)break;if(b===8){if(b=g.data,b==="$"||b==="$!"||b==="$?")break;if(b==="/$")return null}}return g}function gm(g){g=g.previousSibling;for(var b=0;g;){if(g.nodeType===8){var M=g.data;if(M==="$"||M==="$!"||M==="$?"){if(b===0)return g;b--}else M==="/$"&&b++}g=g.previousSibling}return null}var Uu=Math.random().toString(36).slice(2),Zo="__reactFiber$"+Uu,Vd="__reactProps$"+Uu,mc="__reactContainer$"+Uu,qh="__reactEvents$"+Uu,ny="__reactListeners$"+Uu,Gf="__reactHandles$"+Uu;function gc(g){var b=g[Zo];if(b)return b;for(var M=g.parentNode;M;){if(b=M[mc]||M[Zo]){if(M=b.alternate,b.child!==null||M!==null&&M.child!==null)for(g=gm(g);g!==null;){if(M=g[Zo])return M;g=gm(g)}return b}g=M,M=g.parentNode}return null}function $u(g){return g=g[Zo]||g[mc],!g||g.tag!==5&&g.tag!==6&&g.tag!==13&&g.tag!==3?null:g}function Jc(g){if(g.tag===5||g.tag===6)return g.stateNode;throw Error(o(33))}function Ud(g){return g[Vd]||null}var Zh=[],tl=-1;function da(g){return{current:g}}function es(g){0>tl||(g.current=Zh[tl],Zh[tl]=null,tl--)}function ds(g,b){tl++,Zh[tl]=g.current,g.current=b}var Os={},Ws=da(Os),To=da(!1),Ml=Os;function _c(g,b){var M=g.type.contextTypes;if(!M)return Os;var B=g.stateNode;if(B&&B.__reactInternalMemoizedUnmaskedChildContext===b)return B.__reactInternalMemoizedMaskedChildContext;var Y={},se;for(se in M)Y[se]=b[se];return B&&(g=g.stateNode,g.__reactInternalMemoizedUnmaskedChildContext=b,g.__reactInternalMemoizedMaskedChildContext=Y),Y}function Eo(g){return g=g.childContextTypes,g!=null}function $d(){es(To),es(Ws)}function Xh(g,b,M){if(Ws.current!==Os)throw Error(o(168));ds(Ws,b),ds(To,M)}function Wf(g,b,M){var B=g.stateNode;if(b=b.childContextTypes,typeof B.getChildContext!="function")return M;B=B.getChildContext();for(var Y in B)if(!(Y in b))throw Error(o(108,Bt(g)||"Unknown",Y));return ct({},M,B)}function Hu(g){return g=(g=g.stateNode)&&g.__reactInternalMemoizedMergedChildContext||Os,Ml=Ws.current,ds(Ws,g),ds(To,To.current),!0}function Hd(g,b,M){var B=g.stateNode;if(!B)throw Error(o(169));M?(g=Wf(g,b,Ml),B.__reactInternalMemoizedMergedChildContext=g,es(To),es(Ws),ds(Ws,g)):es(To),ds(To,M)}var ha=null,Kh=!1,yc=!1;function Eg(g){ha===null?ha=[g]:ha.push(g)}function ry(g){Kh=!0,Eg(g)}function vc(){if(!yc&&ha!==null){yc=!0;var g=0,b=wi;try{var M=ha;for(wi=1;g<M.length;g++){var B=M[g];do B=B(!0);while(B!==null)}ha=null,Kh=!1}catch(Y){throw ha!==null&&(ha=ha.slice(g+1)),Vi(Qi,vc),Y}finally{wi=b,yc=!1}}return null}var Gu=[],Gd=0,qf=null,Wd=0,No=[],fa=0,pa=null,Ll=1,Dl="";function xc(g,b){Gu[Gd++]=Wd,Gu[Gd++]=qf,qf=g,Wd=b}function Yh(g,b,M){No[fa++]=Ll,No[fa++]=Dl,No[fa++]=pa,pa=g;var B=Ll;g=Dl;var Y=32-os(B)-1;B&=~(1<<Y),M+=1;var se=32-os(b)+Y;if(30<se){var Re=Y-Y%5;se=(B&(1<<Re)-1).toString(32),B>>=Re,Y-=Re,Ll=1<<32-os(b)+Y|M<<Y|B,Dl=se+g}else Ll=1<<se|M<<Y|B,Dl=g}function kl(g){g.return!==null&&(xc(g,1),Yh(g,1,0))}function Zf(g){for(;g===qf;)qf=Gu[--Gd],Gu[Gd]=null,Wd=Gu[--Gd],Gu[Gd]=null;for(;g===pa;)pa=No[--fa],No[fa]=null,Dl=No[--fa],No[fa]=null,Ll=No[--fa],No[fa]=null}var Ss=null,Xo=null,hs=!1,Ma=null;function Xf(g,b){var M=Bs(5,null,null,0);M.elementType="DELETED",M.stateNode=b,M.return=g,b=g.deletions,b===null?(g.deletions=[M],g.flags|=16):b.push(M)}function Jh(g,b){switch(g.tag){case 5:var M=g.type;return b=b.nodeType!==1||M.toLowerCase()!==b.nodeName.toLowerCase()?null:b,b!==null?(g.stateNode=b,Ss=g,Xo=pc(b.firstChild),!0):!1;case 6:return b=g.pendingProps===""||b.nodeType!==3?null:b,b!==null?(g.stateNode=b,Ss=g,Xo=null,!0):!1;case 13:return b=b.nodeType!==8?null:b,b!==null?(M=pa!==null?{id:Ll,overflow:Dl}:null,g.memoizedState={dehydrated:b,treeContext:M,retryLane:1073741824},M=Bs(18,null,null,0),M.stateNode=b,M.return=g,g.child=M,Ss=g,Xo=null,!0):!1;default:return!1}}function qd(g){return(g.mode&1)!==0&&(g.flags&128)===0}function Kf(g){if(hs){var b=Xo;if(b){var M=b;if(!Jh(g,b)){if(qd(g))throw Error(o(418));b=pc(M.nextSibling);var B=Ss;b&&Jh(g,b)?Xf(B,M):(g.flags=g.flags&-4097|2,hs=!1,Ss=g)}}else{if(qd(g))throw Error(o(418));g.flags=g.flags&-4097|2,hs=!1,Ss=g}}}function Qh(g){for(g=g.return;g!==null&&g.tag!==5&&g.tag!==3&&g.tag!==13;)g=g.return;Ss=g}function Ol(g){if(g!==Ss)return!1;if(!hs)return Qh(g),hs=!0,!1;var b;if((b=g.tag!==3)&&!(b=g.tag!==5)&&(b=g.type,b=b!=="head"&&b!=="body"&&!Yc(g.type,g.memoizedProps)),b&&(b=Xo)){if(qd(g))throw _m(),Error(o(418));for(;b;)Xf(g,b),b=pc(b.nextSibling)}if(Qh(g),g.tag===13){if(g=g.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(o(317));e:{for(g=g.nextSibling,b=0;g;){if(g.nodeType===8){var M=g.data;if(M==="/$"){if(b===0){Xo=pc(g.nextSibling);break e}b--}else M!=="$"&&M!=="$!"&&M!=="$?"||b++}g=g.nextSibling}Xo=null}}else Xo=Ss?pc(g.stateNode.nextSibling):null;return!0}function _m(){for(var g=Xo;g;)g=pc(g.nextSibling)}function Zd(){Xo=Ss=null,hs=!1}function nl(g){Ma===null?Ma=[g]:Ma.push(g)}var iy=pe.ReactCurrentBatchConfig;function Wu(g,b,M){if(g=M.ref,g!==null&&typeof g!="function"&&typeof g!="object"){if(M._owner){if(M=M._owner,M){if(M.tag!==1)throw Error(o(309));var B=M.stateNode}if(!B)throw Error(o(147,g));var Y=B,se=""+g;return b!==null&&b.ref!==null&&typeof b.ref=="function"&&b.ref._stringRef===se?b.ref:(b=function(Re){var it=Y.refs;Re===null?delete it[se]:it[se]=Re},b._stringRef=se,b)}if(typeof g!="string")throw Error(o(284));if(!M._owner)throw Error(o(290,g))}return g}function qu(g,b){throw g=Object.prototype.toString.call(b),Error(o(31,g==="[object Object]"?"object with keys {"+Object.keys(b).join(", ")+"}":g))}function Zu(g){var b=g._init;return b(g._payload)}function Qc(g){function b(Ut,Pt){if(g){var $t=Ut.deletions;$t===null?(Ut.deletions=[Pt],Ut.flags|=16):$t.push(Pt)}}function M(Ut,Pt){if(!g)return null;for(;Pt!==null;)b(Ut,Pt),Pt=Pt.sibling;return null}function B(Ut,Pt){for(Ut=new Map;Pt!==null;)Pt.key!==null?Ut.set(Pt.key,Pt):Ut.set(Pt.index,Pt),Pt=Pt.sibling;return Ut}function Y(Ut,Pt){return Ut=va(Ut,Pt),Ut.index=0,Ut.sibling=null,Ut}function se(Ut,Pt,$t){return Ut.index=$t,g?($t=Ut.alternate,$t!==null?($t=$t.index,$t<Pt?(Ut.flags|=2,Pt):$t):(Ut.flags|=2,Pt)):(Ut.flags|=1048576,Pt)}function Re(Ut){return g&&Ut.alternate===null&&(Ut.flags|=2),Ut}function it(Ut,Pt,$t,Tn){return Pt===null||Pt.tag!==6?(Pt=ah($t,Ut.mode,Tn),Pt.return=Ut,Pt):(Pt=Y(Pt,$t),Pt.return=Ut,Pt)}function xt(Ut,Pt,$t,Tn){var wr=$t.type;return wr===fe?Mn(Ut,Pt,$t.props.children,Tn,$t.key):Pt!==null&&(Pt.elementType===wr||typeof wr=="object"&&wr!==null&&wr.$$typeof===at&&Zu(wr)===Pt.type)?(Tn=Y(Pt,$t.props),Tn.ref=Wu(Ut,Pt,$t),Tn.return=Ut,Tn):(Tn=ql($t.type,$t.key,$t.props,null,Ut.mode,Tn),Tn.ref=Wu(Ut,Pt,$t),Tn.return=Ut,Tn)}function Yt(Ut,Pt,$t,Tn){return Pt===null||Pt.tag!==4||Pt.stateNode.containerInfo!==$t.containerInfo||Pt.stateNode.implementation!==$t.implementation?(Pt=od($t,Ut.mode,Tn),Pt.return=Ut,Pt):(Pt=Y(Pt,$t.children||[]),Pt.return=Ut,Pt)}function Mn(Ut,Pt,$t,Tn,wr){return Pt===null||Pt.tag!==7?(Pt=Zl($t,Ut.mode,Tn,wr),Pt.return=Ut,Pt):(Pt=Y(Pt,$t),Pt.return=Ut,Pt)}function Dn(Ut,Pt,$t){if(typeof Pt=="string"&&Pt!==""||typeof Pt=="number")return Pt=ah(""+Pt,Ut.mode,$t),Pt.return=Ut,Pt;if(typeof Pt=="object"&&Pt!==null){switch(Pt.$$typeof){case he:return $t=ql(Pt.type,Pt.key,Pt.props,null,Ut.mode,$t),$t.ref=Wu(Ut,null,Pt),$t.return=Ut,$t;case xe:return Pt=od(Pt,Ut.mode,$t),Pt.return=Ut,Pt;case at:var Tn=Pt._init;return Dn(Ut,Tn(Pt._payload),$t)}if(Lr(Pt)||Rt(Pt))return Pt=Zl(Pt,Ut.mode,$t,null),Pt.return=Ut,Pt;qu(Ut,Pt)}return null}function In(Ut,Pt,$t,Tn){var wr=Pt!==null?Pt.key:null;if(typeof $t=="string"&&$t!==""||typeof $t=="number")return wr!==null?null:it(Ut,Pt,""+$t,Tn);if(typeof $t=="object"&&$t!==null){switch($t.$$typeof){case he:return $t.key===wr?xt(Ut,Pt,$t,Tn):null;case xe:return $t.key===wr?Yt(Ut,Pt,$t,Tn):null;case at:return wr=$t._init,In(Ut,Pt,wr($t._payload),Tn)}if(Lr($t)||Rt($t))return wr!==null?null:Mn(Ut,Pt,$t,Tn,null);qu(Ut,$t)}return null}function Kn(Ut,Pt,$t,Tn,wr){if(typeof Tn=="string"&&Tn!==""||typeof Tn=="number")return Ut=Ut.get($t)||null,it(Pt,Ut,""+Tn,wr);if(typeof Tn=="object"&&Tn!==null){switch(Tn.$$typeof){case he:return Ut=Ut.get(Tn.key===null?$t:Tn.key)||null,xt(Pt,Ut,Tn,wr);case xe:return Ut=Ut.get(Tn.key===null?$t:Tn.key)||null,Yt(Pt,Ut,Tn,wr);case at:var Rr=Tn._init;return Kn(Ut,Pt,$t,Rr(Tn._payload),wr)}if(Lr(Tn)||Rt(Tn))return Ut=Ut.get($t)||null,Mn(Pt,Ut,Tn,wr,null);qu(Pt,Tn)}return null}function hr(Ut,Pt,$t,Tn){for(var wr=null,Rr=null,Ur=Pt,Qr=Pt=0,Bo=null;Ur!==null&&Qr<$t.length;Qr++){Ur.index>Qr?(Bo=Ur,Ur=null):Bo=Ur.sibling;var ts=In(Ut,Ur,$t[Qr],Tn);if(ts===null){Ur===null&&(Ur=Bo);break}g&&Ur&&ts.alternate===null&&b(Ut,Ur),Pt=se(ts,Pt,Qr),Rr===null?wr=ts:Rr.sibling=ts,Rr=ts,Ur=Bo}if(Qr===$t.length)return M(Ut,Ur),hs&&xc(Ut,Qr),wr;if(Ur===null){for(;Qr<$t.length;Qr++)Ur=Dn(Ut,$t[Qr],Tn),Ur!==null&&(Pt=se(Ur,Pt,Qr),Rr===null?wr=Ur:Rr.sibling=Ur,Rr=Ur);return hs&&xc(Ut,Qr),wr}for(Ur=B(Ut,Ur);Qr<$t.length;Qr++)Bo=Kn(Ur,Ut,Qr,$t[Qr],Tn),Bo!==null&&(g&&Bo.alternate!==null&&Ur.delete(Bo.key===null?Qr:Bo.key),Pt=se(Bo,Pt,Qr),Rr===null?wr=Bo:Rr.sibling=Bo,Rr=Bo);return g&&Ur.forEach(function(Xl){return b(Ut,Xl)}),hs&&xc(Ut,Qr),wr}function _r(Ut,Pt,$t,Tn){var wr=Rt($t);if(typeof wr!="function")throw Error(o(150));if($t=wr.call($t),$t==null)throw Error(o(151));for(var Rr=wr=null,Ur=Pt,Qr=Pt=0,Bo=null,ts=$t.next();Ur!==null&&!ts.done;Qr++,ts=$t.next()){Ur.index>Qr?(Bo=Ur,Ur=null):Bo=Ur.sibling;var Xl=In(Ut,Ur,ts.value,Tn);if(Xl===null){Ur===null&&(Ur=Bo);break}g&&Ur&&Xl.alternate===null&&b(Ut,Ur),Pt=se(Xl,Pt,Qr),Rr===null?wr=Xl:Rr.sibling=Xl,Rr=Xl,Ur=Bo}if(ts.done)return M(Ut,Ur),hs&&xc(Ut,Qr),wr;if(Ur===null){for(;!ts.done;Qr++,ts=$t.next())ts=Dn(Ut,ts.value,Tn),ts!==null&&(Pt=se(ts,Pt,Qr),Rr===null?wr=ts:Rr.sibling=ts,Rr=ts);return hs&&xc(Ut,Qr),wr}for(Ur=B(Ut,Ur);!ts.done;Qr++,ts=$t.next())ts=Kn(Ur,Ut,Qr,ts.value,Tn),ts!==null&&(g&&ts.alternate!==null&&Ur.delete(ts.key===null?Qr:ts.key),Pt=se(ts,Pt,Qr),Rr===null?wr=ts:Rr.sibling=ts,Rr=ts);return g&&Ur.forEach(function(ax){return b(Ut,ax)}),hs&&xc(Ut,Qr),wr}function Ys(Ut,Pt,$t,Tn){if(typeof $t=="object"&&$t!==null&&$t.type===fe&&$t.key===null&&($t=$t.props.children),typeof $t=="object"&&$t!==null){switch($t.$$typeof){case he:e:{for(var wr=$t.key,Rr=Pt;Rr!==null;){if(Rr.key===wr){if(wr=$t.type,wr===fe){if(Rr.tag===7){M(Ut,Rr.sibling),Pt=Y(Rr,$t.props.children),Pt.return=Ut,Ut=Pt;break e}}else if(Rr.elementType===wr||typeof wr=="object"&&wr!==null&&wr.$$typeof===at&&Zu(wr)===Rr.type){M(Ut,Rr.sibling),Pt=Y(Rr,$t.props),Pt.ref=Wu(Ut,Rr,$t),Pt.return=Ut,Ut=Pt;break e}M(Ut,Rr);break}else b(Ut,Rr);Rr=Rr.sibling}$t.type===fe?(Pt=Zl($t.props.children,Ut.mode,Tn,$t.key),Pt.return=Ut,Ut=Pt):(Tn=ql($t.type,$t.key,$t.props,null,Ut.mode,Tn),Tn.ref=Wu(Ut,Pt,$t),Tn.return=Ut,Ut=Tn)}return Re(Ut);case xe:e:{for(Rr=$t.key;Pt!==null;){if(Pt.key===Rr)if(Pt.tag===4&&Pt.stateNode.containerInfo===$t.containerInfo&&Pt.stateNode.implementation===$t.implementation){M(Ut,Pt.sibling),Pt=Y(Pt,$t.children||[]),Pt.return=Ut,Ut=Pt;break e}else{M(Ut,Pt);break}else b(Ut,Pt);Pt=Pt.sibling}Pt=od($t,Ut.mode,Tn),Pt.return=Ut,Ut=Pt}return Re(Ut);case at:return Rr=$t._init,Ys(Ut,Pt,Rr($t._payload),Tn)}if(Lr($t))return hr(Ut,Pt,$t,Tn);if(Rt($t))return _r(Ut,Pt,$t,Tn);qu(Ut,$t)}return typeof $t=="string"&&$t!==""||typeof $t=="number"?($t=""+$t,Pt!==null&&Pt.tag===6?(M(Ut,Pt.sibling),Pt=Y(Pt,$t),Pt.return=Ut,Ut=Pt):(M(Ut,Pt),Pt=ah($t,Ut.mode,Tn),Pt.return=Ut,Ut=Pt),Re(Ut)):M(Ut,Pt)}return Ys}var rl=Qc(!0),Xd=Qc(!1),eu=da(null),Xu=null,tu=null,Kd=null;function ef(){Kd=tu=Xu=null}function nu(g){var b=eu.current;es(eu),g._currentValue=b}function Ku(g,b,M){for(;g!==null;){var B=g.alternate;if((g.childLanes&b)!==b?(g.childLanes|=b,B!==null&&(B.childLanes|=b)):B!==null&&(B.childLanes&b)!==b&&(B.childLanes|=b),g===M)break;g=g.return}}function un(g,b){Xu=g,Kd=tu=null,g=g.dependencies,g!==null&&g.firstContext!==null&&((g.lanes&b)!==0&&(no=!0),g.firstContext=null)}function jo(g){var b=g._currentValue;if(Kd!==g)if(g={context:g,memoizedValue:b,next:null},tu===null){if(Xu===null)throw Error(o(308));tu=g,Xu.dependencies={lanes:0,firstContext:g}}else tu=tu.next=g;return b}var ma=null;function zl(g){ma===null?ma=[g]:ma.push(g)}function bc(g,b,M,B){var Y=b.interleaved;return Y===null?(M.next=M,zl(b)):(M.next=Y.next,Y.next=M),b.interleaved=M,Ln(g,B)}function Ln(g,b){g.lanes|=b;var M=g.alternate;for(M!==null&&(M.lanes|=b),M=g,g=g.return;g!==null;)g.childLanes|=b,M=g.alternate,M!==null&&(M.childLanes|=b),M=g,g=g.return;return M.tag===3?M.stateNode:null}var Fl=!1;function ym(g){g.updateQueue={baseState:g.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function vm(g,b){g=g.updateQueue,b.updateQueue===g&&(b.updateQueue={baseState:g.baseState,firstBaseUpdate:g.firstBaseUpdate,lastBaseUpdate:g.lastBaseUpdate,shared:g.shared,effects:g.effects})}function ga(g,b){return{eventTime:g,lane:b,tag:0,payload:null,callback:null,next:null}}function wc(g,b,M){var B=g.updateQueue;if(B===null)return null;if(B=B.shared,(ne&2)!==0){var Y=B.pending;return Y===null?b.next=b:(b.next=Y.next,Y.next=b),B.pending=b,Ln(g,M)}return Y=B.interleaved,Y===null?(b.next=b,zl(B)):(b.next=Y.next,Y.next=b),B.interleaved=b,Ln(g,M)}function Yf(g,b,M){if(b=b.updateQueue,b!==null&&(b=b.shared,(M&4194240)!==0)){var B=b.lanes;B&=g.pendingLanes,M|=B,b.lanes=M,oa(g,M)}}function xm(g,b){var M=g.updateQueue,B=g.alternate;if(B!==null&&(B=B.updateQueue,M===B)){var Y=null,se=null;if(M=M.firstBaseUpdate,M!==null){do{var Re={eventTime:M.eventTime,lane:M.lane,tag:M.tag,payload:M.payload,callback:M.callback,next:null};se===null?Y=se=Re:se=se.next=Re,M=M.next}while(M!==null);se===null?Y=se=b:se=se.next=b}else Y=se=b;M={baseState:B.baseState,firstBaseUpdate:Y,lastBaseUpdate:se,shared:B.shared,effects:B.effects},g.updateQueue=M;return}g=M.lastBaseUpdate,g===null?M.firstBaseUpdate=b:g.next=b,M.lastBaseUpdate=b}function Jf(g,b,M,B){var Y=g.updateQueue;Fl=!1;var se=Y.firstBaseUpdate,Re=Y.lastBaseUpdate,it=Y.shared.pending;if(it!==null){Y.shared.pending=null;var xt=it,Yt=xt.next;xt.next=null,Re===null?se=Yt:Re.next=Yt,Re=xt;var Mn=g.alternate;Mn!==null&&(Mn=Mn.updateQueue,it=Mn.lastBaseUpdate,it!==Re&&(it===null?Mn.firstBaseUpdate=Yt:it.next=Yt,Mn.lastBaseUpdate=xt))}if(se!==null){var Dn=Y.baseState;Re=0,Mn=Yt=xt=null,it=se;do{var In=it.lane,Kn=it.eventTime;if((B&In)===In){Mn!==null&&(Mn=Mn.next={eventTime:Kn,lane:0,tag:it.tag,payload:it.payload,callback:it.callback,next:null});e:{var hr=g,_r=it;switch(In=b,Kn=M,_r.tag){case 1:if(hr=_r.payload,typeof hr=="function"){Dn=hr.call(Kn,Dn,In);break e}Dn=hr;break e;case 3:hr.flags=hr.flags&-65537|128;case 0:if(hr=_r.payload,In=typeof hr=="function"?hr.call(Kn,Dn,In):hr,In==null)break e;Dn=ct({},Dn,In);break e;case 2:Fl=!0}}it.callback!==null&&it.lane!==0&&(g.flags|=64,In=Y.effects,In===null?Y.effects=[it]:In.push(it))}else Kn={eventTime:Kn,lane:In,tag:it.tag,payload:it.payload,callback:it.callback,next:null},Mn===null?(Yt=Mn=Kn,xt=Dn):Mn=Mn.next=Kn,Re|=In;if(it=it.next,it===null){if(it=Y.shared.pending,it===null)break;In=it,it=In.next,In.next=null,Y.lastBaseUpdate=In,Y.shared.pending=null}}while(!0);if(Mn===null&&(xt=Dn),Y.baseState=xt,Y.firstBaseUpdate=Yt,Y.lastBaseUpdate=Mn,b=Y.shared.interleaved,b!==null){Y=b;do Re|=Y.lane,Y=Y.next;while(Y!==b)}else se===null&&(Y.shared.lanes=0);Oe|=Re,g.lanes=Re,g.memoizedState=Dn}}function Ig(g,b,M){if(g=b.effects,b.effects=null,g!==null)for(b=0;b<g.length;b++){var B=g[b],Y=B.callback;if(Y!==null){if(B.callback=null,B=M,typeof Y!="function")throw Error(o(191,Y));Y.call(B)}}}var Yu={},La=da(Yu),Ju=da(Yu),Qu=da(Yu);function qs(g){if(g===Yu)throw Error(o(174));return g}function Nl(g,b){switch(ds(Qu,b),ds(Ju,g),ds(La,Yu),g=b.nodeType,g){case 9:case 11:b=(b=b.documentElement)?b.namespaceURI:Xi(null,"");break;default:g=g===8?b.parentNode:b,b=g.namespaceURI||null,g=g.tagName,b=Xi(b,g)}es(La),ds(La,b)}function Da(){es(La),es(Ju),es(Qu)}function tf(g){qs(Qu.current);var b=qs(La.current),M=Xi(b,g.type);b!==M&&(ds(Ju,g),ds(La,M))}function Yd(g){Ju.current===g&&(es(La),es(Ju))}var as=da(0);function nf(g){for(var b=g;b!==null;){if(b.tag===13){var M=b.memoizedState;if(M!==null&&(M=M.dehydrated,M===null||M.data==="$?"||M.data==="$!"))return b}else if(b.tag===19&&b.memoizedProps.revealOrder!==void 0){if((b.flags&128)!==0)return b}else if(b.child!==null){b.child.return=b,b=b.child;continue}if(b===g)break;for(;b.sibling===null;){if(b.return===null||b.return===g)return null;b=b.return}b.sibling.return=b.return,b=b.sibling}return null}var ea=[];function ni(){for(var g=0;g<ea.length;g++)ea[g]._workInProgressVersionPrimary=null;ea.length=0}var ru=pe.ReactCurrentDispatcher,jl=pe.ReactCurrentBatchConfig,iu=0,Ps=null,Zs=null,fo=null,Sc=!1,il=!1,Xt=0,fn=0;function zs(){throw Error(o(321))}function $i(g,b){if(b===null)return!1;for(var M=0;M<b.length&&M<g.length;M++)if(!Pa(g[M],b[M]))return!1;return!0}function ut(g,b,M,B,Y,se){if(iu=se,Ps=b,b.memoizedState=null,b.updateQueue=null,b.lanes=0,ru.current=g===null||g.memoizedState===null?rd:rh,g=M(B,Y),il){se=0;do{if(il=!1,Xt=0,25<=se)throw Error(o(301));se+=1,fo=Zs=null,b.updateQueue=null,ru.current=Yo,g=M(B,Y)}while(il)}if(ru.current=nd,b=Zs!==null&&Zs.next!==null,iu=0,fo=Zs=Ps=null,Sc=!1,b)throw Error(o(300));return g}function _a(){var g=Xt!==0;return Xt=0,g}function ya(){var g={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fo===null?Ps.memoizedState=fo=g:fo=fo.next=g,fo}function Ko(){if(Zs===null){var g=Ps.alternate;g=g!==null?g.memoizedState:null}else g=Zs.next;var b=fo===null?Ps.memoizedState:fo.next;if(b!==null)fo=b,Zs=g;else{if(g===null)throw Error(o(310));Zs=g,g={memoizedState:Zs.memoizedState,baseState:Zs.baseState,baseQueue:Zs.baseQueue,queue:Zs.queue,next:null},fo===null?Ps.memoizedState=fo=g:fo=fo.next=g}return fo}function ed(g,b){return typeof b=="function"?b(g):b}function Qf(g){var b=Ko(),M=b.queue;if(M===null)throw Error(o(311));M.lastRenderedReducer=g;var B=Zs,Y=B.baseQueue,se=M.pending;if(se!==null){if(Y!==null){var Re=Y.next;Y.next=se.next,se.next=Re}B.baseQueue=Y=se,M.pending=null}if(Y!==null){se=Y.next,B=B.baseState;var it=Re=null,xt=null,Yt=se;do{var Mn=Yt.lane;if((iu&Mn)===Mn)xt!==null&&(xt=xt.next={lane:0,action:Yt.action,hasEagerState:Yt.hasEagerState,eagerState:Yt.eagerState,next:null}),B=Yt.hasEagerState?Yt.eagerState:g(B,Yt.action);else{var Dn={lane:Mn,action:Yt.action,hasEagerState:Yt.hasEagerState,eagerState:Yt.eagerState,next:null};xt===null?(it=xt=Dn,Re=B):xt=xt.next=Dn,Ps.lanes|=Mn,Oe|=Mn}Yt=Yt.next}while(Yt!==null&&Yt!==se);xt===null?Re=B:xt.next=it,Pa(B,b.memoizedState)||(no=!0),b.memoizedState=B,b.baseState=Re,b.baseQueue=xt,M.lastRenderedState=B}if(g=M.interleaved,g!==null){Y=g;do se=Y.lane,Ps.lanes|=se,Oe|=se,Y=Y.next;while(Y!==g)}else Y===null&&(M.lanes=0);return[b.memoizedState,M.dispatch]}function ep(g){var b=Ko(),M=b.queue;if(M===null)throw Error(o(311));M.lastRenderedReducer=g;var B=M.dispatch,Y=M.pending,se=b.memoizedState;if(Y!==null){M.pending=null;var Re=Y=Y.next;do se=g(se,Re.action),Re=Re.next;while(Re!==Y);Pa(se,b.memoizedState)||(no=!0),b.memoizedState=se,b.baseQueue===null&&(b.baseState=se),M.lastRenderedState=se}return[se,B]}function td(){}function Pg(g,b){var M=Ps,B=Ko(),Y=b(),se=!Pa(B.memoizedState,Y);if(se&&(B.memoizedState=Y,no=!0),B=B.queue,po(rf.bind(null,M,B,g),[g]),B.getSnapshot!==b||se||fo!==null&&fo.memoizedState.tag&1){if(M.flags|=2048,su(9,bm.bind(null,M,B,Y,b),void 0,null),ye===null)throw Error(o(349));(iu&30)!==0||Ag(M,b,Y)}return Y}function Ag(g,b,M){g.flags|=16384,g={getSnapshot:b,value:M},b=Ps.updateQueue,b===null?(b={lastEffect:null,stores:null},Ps.updateQueue=b,b.stores=[g]):(M=b.stores,M===null?b.stores=[g]:M.push(g))}function bm(g,b,M,B){b.value=M,b.getSnapshot=B,tp(b)&&np(g)}function rf(g,b,M){return M(function(){tp(b)&&np(g)})}function tp(g){var b=g.getSnapshot;g=g.value;try{var M=b();return!Pa(g,M)}catch{return!0}}function np(g){var b=Ln(g,1);b!==null&&dn(b,g,1,-1)}function wm(g){var b=ya();return typeof g=="function"&&(g=g()),b.memoizedState=b.baseState=g,g={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ed,lastRenderedState:g},b.queue=g,g=g.dispatch=Sm.bind(null,Ps,g),[b.memoizedState,g]}function su(g,b,M,B){return g={tag:g,create:b,destroy:M,deps:B,next:null},b=Ps.updateQueue,b===null?(b={lastEffect:null,stores:null},Ps.updateQueue=b,b.lastEffect=g.next=g):(M=b.lastEffect,M===null?b.lastEffect=g.next=g:(B=M.next,M.next=g,g.next=B,b.lastEffect=g)),g}function Jd(){return Ko().memoizedState}function Bl(g,b,M,B){var Y=ya();Ps.flags|=g,Y.memoizedState=su(1|b,M,void 0,B===void 0?null:B)}function Qd(g,b,M,B){var Y=Ko();B=B===void 0?null:B;var se=void 0;if(Zs!==null){var Re=Zs.memoizedState;if(se=Re.destroy,B!==null&&$i(B,Re.deps)){Y.memoizedState=su(b,M,se,B);return}}Ps.flags|=g,Y.memoizedState=su(1|b,M,se,B)}function Cc(g,b){return Bl(8390656,8,g,b)}function po(g,b){return Qd(2048,8,g,b)}function Rg(g,b){return Qd(4,2,g,b)}function eh(g,b){return Qd(4,4,g,b)}function Ii(g,b){if(typeof b=="function")return g=g(),b(g),function(){b(null)};if(b!=null)return g=g(),b.current=g,function(){b.current=null}}function Vr(g,b,M){return M=M!=null?M.concat([g]):null,Qd(4,4,Ii.bind(null,b,g),M)}function sf(){}function Vl(g,b){var M=Ko();b=b===void 0?null:b;var B=M.memoizedState;return B!==null&&b!==null&&$i(b,B[1])?B[0]:(M.memoizedState=[g,b],g)}function of(g,b){var M=Ko();b=b===void 0?null:b;var B=M.memoizedState;return B!==null&&b!==null&&$i(b,B[1])?B[0]:(g=g(),M.memoizedState=[g,b],g)}function ou(g,b,M){return(iu&21)===0?(g.baseState&&(g.baseState=!1,no=!0),g.memoizedState=M):(Pa(M,b)||(M=Of(),Ps.lanes|=M,Oe|=M,g.baseState=!0),b)}function th(g,b){var M=wi;wi=M!==0&&4>M?M:4,g(!0);var B=jl.transition;jl.transition={};try{g(!1),b()}finally{wi=M,jl.transition=B}}function af(){return Ko().memoizedState}function nh(g,b,M){var B=vn(g);if(M={lane:B,action:M,hasEagerState:!1,eagerState:null,next:null},rp(g))sl(b,M);else if(M=bc(g,b,M,B),M!==null){var Y=rn();dn(M,g,B,Y),Ul(M,b,B)}}function Sm(g,b,M){var B=vn(g),Y={lane:B,action:M,hasEagerState:!1,eagerState:null,next:null};if(rp(g))sl(b,Y);else{var se=g.alternate;if(g.lanes===0&&(se===null||se.lanes===0)&&(se=b.lastRenderedReducer,se!==null))try{var Re=b.lastRenderedState,it=se(Re,M);if(Y.hasEagerState=!0,Y.eagerState=it,Pa(it,Re)){var xt=b.interleaved;xt===null?(Y.next=Y,zl(b)):(Y.next=xt.next,xt.next=Y),b.interleaved=Y;return}}catch{}finally{}M=bc(g,b,Y,B),M!==null&&(Y=rn(),dn(M,g,B,Y),Ul(M,b,B))}}function rp(g){var b=g.alternate;return g===Ps||b!==null&&b===Ps}function sl(g,b){il=Sc=!0;var M=g.pending;M===null?b.next=b:(b.next=M.next,M.next=b),g.pending=b}function Ul(g,b,M){if((M&4194240)!==0){var B=b.lanes;B&=g.pendingLanes,M|=B,b.lanes=M,oa(g,M)}}var nd={readContext:jo,useCallback:zs,useContext:zs,useEffect:zs,useImperativeHandle:zs,useInsertionEffect:zs,useLayoutEffect:zs,useMemo:zs,useReducer:zs,useRef:zs,useState:zs,useDebugValue:zs,useDeferredValue:zs,useTransition:zs,useMutableSource:zs,useSyncExternalStore:zs,useId:zs,unstable_isNewReconciler:!1},rd={readContext:jo,useCallback:function(g,b){return ya().memoizedState=[g,b===void 0?null:b],g},useContext:jo,useEffect:Cc,useImperativeHandle:function(g,b,M){return M=M!=null?M.concat([g]):null,Bl(4194308,4,Ii.bind(null,b,g),M)},useLayoutEffect:function(g,b){return Bl(4194308,4,g,b)},useInsertionEffect:function(g,b){return Bl(4,2,g,b)},useMemo:function(g,b){var M=ya();return b=b===void 0?null:b,g=g(),M.memoizedState=[g,b],g},useReducer:function(g,b,M){var B=ya();return b=M!==void 0?M(b):b,B.memoizedState=B.baseState=b,g={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:g,lastRenderedState:b},B.queue=g,g=g.dispatch=nh.bind(null,Ps,g),[B.memoizedState,g]},useRef:function(g){var b=ya();return g={current:g},b.memoizedState=g},useState:wm,useDebugValue:sf,useDeferredValue:function(g){return ya().memoizedState=g},useTransition:function(){var g=wm(!1),b=g[0];return g=th.bind(null,g[1]),ya().memoizedState=g,[b,g]},useMutableSource:function(){},useSyncExternalStore:function(g,b,M){var B=Ps,Y=ya();if(hs){if(M===void 0)throw Error(o(407));M=M()}else{if(M=b(),ye===null)throw Error(o(349));(iu&30)!==0||Ag(B,b,M)}Y.memoizedState=M;var se={value:M,getSnapshot:b};return Y.queue=se,Cc(rf.bind(null,B,se,g),[g]),B.flags|=2048,su(9,bm.bind(null,B,se,M,b),void 0,null),M},useId:function(){var g=ya(),b=ye.identifierPrefix;if(hs){var M=Dl,B=Ll;M=(B&~(1<<32-os(B)-1)).toString(32)+M,b=":"+b+"R"+M,M=Xt++,0<M&&(b+="H"+M.toString(32)),b+=":"}else M=fn++,b=":"+b+"r"+M.toString(32)+":";return g.memoizedState=b},unstable_isNewReconciler:!1},rh={readContext:jo,useCallback:Vl,useContext:jo,useEffect:po,useImperativeHandle:Vr,useInsertionEffect:Rg,useLayoutEffect:eh,useMemo:of,useReducer:Qf,useRef:Jd,useState:function(){return Qf(ed)},useDebugValue:sf,useDeferredValue:function(g){var b=Ko();return ou(b,Zs.memoizedState,g)},useTransition:function(){var g=Qf(ed)[0],b=Ko().memoizedState;return[g,b]},useMutableSource:td,useSyncExternalStore:Pg,useId:af,unstable_isNewReconciler:!1},Yo={readContext:jo,useCallback:Vl,useContext:jo,useEffect:po,useImperativeHandle:Vr,useInsertionEffect:Rg,useLayoutEffect:eh,useMemo:of,useReducer:ep,useRef:Jd,useState:function(){return ep(ed)},useDebugValue:sf,useDeferredValue:function(g){var b=Ko();return Zs===null?b.memoizedState=g:ou(b,Zs.memoizedState,g)},useTransition:function(){var g=ep(ed)[0],b=Ko().memoizedState;return[g,b]},useMutableSource:td,useSyncExternalStore:Pg,useId:af,unstable_isNewReconciler:!1};function Xs(g,b){if(g&&g.defaultProps){b=ct({},b),g=g.defaultProps;for(var M in g)b[M]===void 0&&(b[M]=g[M]);return b}return b}function lf(g,b,M,B){b=g.memoizedState,M=M(B,b),M=M==null?b:ct({},b,M),g.memoizedState=M,g.lanes===0&&(g.updateQueue.baseState=M)}var ol={isMounted:function(g){return(g=g._reactInternals)?ln(g)===g:!1},enqueueSetState:function(g,b,M){g=g._reactInternals;var B=rn(),Y=vn(g),se=ga(B,Y);se.payload=b,M!=null&&(se.callback=M),b=wc(g,se,Y),b!==null&&(dn(b,g,Y,B),Yf(b,g,Y))},enqueueReplaceState:function(g,b,M){g=g._reactInternals;var B=rn(),Y=vn(g),se=ga(B,Y);se.tag=1,se.payload=b,M!=null&&(se.callback=M),b=wc(g,se,Y),b!==null&&(dn(b,g,Y,B),Yf(b,g,Y))},enqueueForceUpdate:function(g,b){g=g._reactInternals;var M=rn(),B=vn(g),Y=ga(M,B);Y.tag=2,b!=null&&(Y.callback=b),b=wc(g,Y,B),b!==null&&(dn(b,g,B,M),Yf(b,g,B))}};function ip(g,b,M,B,Y,se,Re){return g=g.stateNode,typeof g.shouldComponentUpdate=="function"?g.shouldComponentUpdate(B,se,Re):b.prototype&&b.prototype.isPureReactComponent?!Aa(M,B)||!Aa(Y,se):!0}function cf(g,b,M){var B=!1,Y=Os,se=b.contextType;return typeof se=="object"&&se!==null?se=jo(se):(Y=Eo(b)?Ml:Ws.current,B=b.contextTypes,se=(B=B!=null)?_c(g,Y):Os),b=new b(M,se),g.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=ol,g.stateNode=b,b._reactInternals=g,B&&(g=g.stateNode,g.__reactInternalMemoizedUnmaskedChildContext=Y,g.__reactInternalMemoizedMaskedChildContext=se),b}function ih(g,b,M,B){g=b.state,typeof b.componentWillReceiveProps=="function"&&b.componentWillReceiveProps(M,B),typeof b.UNSAFE_componentWillReceiveProps=="function"&&b.UNSAFE_componentWillReceiveProps(M,B),b.state!==g&&ol.enqueueReplaceState(b,b.state,null)}function uf(g,b,M,B){var Y=g.stateNode;Y.props=M,Y.state=g.memoizedState,Y.refs={},ym(g);var se=b.contextType;typeof se=="object"&&se!==null?Y.context=jo(se):(se=Eo(b)?Ml:Ws.current,Y.context=_c(g,se)),Y.state=g.memoizedState,se=b.getDerivedStateFromProps,typeof se=="function"&&(lf(g,b,se,M),Y.state=g.memoizedState),typeof b.getDerivedStateFromProps=="function"||typeof Y.getSnapshotBeforeUpdate=="function"||typeof Y.UNSAFE_componentWillMount!="function"&&typeof Y.componentWillMount!="function"||(b=Y.state,typeof Y.componentWillMount=="function"&&Y.componentWillMount(),typeof Y.UNSAFE_componentWillMount=="function"&&Y.UNSAFE_componentWillMount(),b!==Y.state&&ol.enqueueReplaceState(Y,Y.state,null),Jf(g,M,Y,B),Y.state=g.memoizedState),typeof Y.componentDidMount=="function"&&(g.flags|=4194308)}function gs(g,b){try{var M="",B=b;do M+=We(B),B=B.return;while(B);var Y=M}catch(se){Y=`
Error generating stack: `+se.message+`
`+se.stack}return{value:g,source:b,stack:Y,digest:null}}function df(g,b,M){return{value:g,source:null,stack:M??null,digest:b??null}}function hf(g,b){try{console.error(b.value)}catch(M){setTimeout(function(){throw M})}}var au=typeof WeakMap=="function"?WeakMap:Map;function sh(g,b,M){M=ga(-1,M),M.tag=3,M.payload={element:null};var B=b.value;return M.callback=function(){dt||(dt=!0,Je=B),hf(g,b)},M}function sp(g,b,M){M=ga(-1,M),M.tag=3;var B=g.type.getDerivedStateFromError;if(typeof B=="function"){var Y=b.value;M.payload=function(){return B(Y)},M.callback=function(){hf(g,b)}}var se=g.stateNode;return se!==null&&typeof se.componentDidCatch=="function"&&(M.callback=function(){hf(g,b),typeof B!="function"&&(Dt===null?Dt=new Set([this]):Dt.add(this));var Re=b.stack;this.componentDidCatch(b.value,{componentStack:Re!==null?Re:""})}),M}function ff(g,b,M){var B=g.pingCache;if(B===null){B=g.pingCache=new au;var Y=new Set;B.set(b,Y)}else Y=B.get(b),Y===void 0&&(Y=new Set,B.set(b,Y));Y.has(M)||(Y.add(M),g=Ks.bind(null,g,b,M),b.then(g,g))}function lu(g){do{var b;if((b=g.tag===13)&&(b=g.memoizedState,b=b!==null?b.dehydrated!==null:!0),b)return g;g=g.return}while(g!==null);return null}function op(g,b,M,B,Y){return(g.mode&1)===0?(g===b?g.flags|=65536:(g.flags|=128,M.flags|=131072,M.flags&=-52805,M.tag===1&&(M.alternate===null?M.tag=17:(b=ga(-1,1),b.tag=2,wc(M,b,1))),M.lanes|=1),g):(g.flags|=65536,g.lanes=Y,g)}var pf=pe.ReactCurrentOwner,no=!1;function ro(g,b,M,B){b.child=g===null?Xd(b,null,M,B):rl(b,g.child,M,B)}function ap(g,b,M,B,Y){M=M.render;var se=b.ref;return un(b,Y),B=ut(g,b,M,B,se,Y),M=_a(),g!==null&&!no?(b.updateQueue=g.updateQueue,b.flags&=-2053,g.lanes&=~Y,ta(g,b,Y)):(hs&&M&&kl(b),b.flags|=1,ro(g,b,B,Y),b.child)}function mf(g,b,M,B,Y){if(g===null){var se=M.type;return typeof se=="function"&&!Na(se)&&se.defaultProps===void 0&&M.compare===null&&M.defaultProps===void 0?(b.tag=15,b.type=se,Cm(g,b,se,B,Y)):(g=ql(M.type,null,B,b,b.mode,Y),g.ref=b.ref,g.return=b,b.child=g)}if(se=g.child,(g.lanes&Y)===0){var Re=se.memoizedProps;if(M=M.compare,M=M!==null?M:Aa,M(Re,B)&&g.ref===b.ref)return ta(g,b,Y)}return b.flags|=1,g=va(se,B),g.ref=b.ref,g.return=b,b.child=g}function Cm(g,b,M,B,Y){if(g!==null){var se=g.memoizedProps;if(Aa(se,B)&&g.ref===b.ref)if(no=!1,b.pendingProps=B=se,(g.lanes&Y)!==0)(g.flags&131072)!==0&&(no=!0);else return b.lanes=g.lanes,ta(g,b,Y)}return lp(g,b,M,B,Y)}function gf(g,b,M){var B=b.pendingProps,Y=B.children,se=g!==null?g.memoizedState:null;if(B.mode==="hidden")if((b.mode&1)===0)b.memoizedState={baseLanes:0,cachePool:null,transitions:null},ds(De,ke),ke|=M;else{if((M&1073741824)===0)return g=se!==null?se.baseLanes|M:M,b.lanes=b.childLanes=1073741824,b.memoizedState={baseLanes:g,cachePool:null,transitions:null},b.updateQueue=null,ds(De,ke),ke|=g,null;b.memoizedState={baseLanes:0,cachePool:null,transitions:null},B=se!==null?se.baseLanes:M,ds(De,ke),ke|=B}else se!==null?(B=se.baseLanes|M,b.memoizedState=null):B=M,ds(De,ke),ke|=B;return ro(g,b,Y,M),b.child}function Tm(g,b){var M=b.ref;(g===null&&M!==null||g!==null&&g.ref!==M)&&(b.flags|=512,b.flags|=2097152)}function lp(g,b,M,B,Y){var se=Eo(M)?Ml:Ws.current;return se=_c(b,se),un(b,Y),M=ut(g,b,M,B,se,Y),B=_a(),g!==null&&!no?(b.updateQueue=g.updateQueue,b.flags&=-2053,g.lanes&=~Y,ta(g,b,Y)):(hs&&B&&kl(b),b.flags|=1,ro(g,b,M,Y),b.child)}function Em(g,b,M,B,Y){if(Eo(M)){var se=!0;Hu(b)}else se=!1;if(un(b,Y),b.stateNode===null)pp(g,b),cf(b,M,B),uf(b,M,B,Y),B=!0;else if(g===null){var Re=b.stateNode,it=b.memoizedProps;Re.props=it;var xt=Re.context,Yt=M.contextType;typeof Yt=="object"&&Yt!==null?Yt=jo(Yt):(Yt=Eo(M)?Ml:Ws.current,Yt=_c(b,Yt));var Mn=M.getDerivedStateFromProps,Dn=typeof Mn=="function"||typeof Re.getSnapshotBeforeUpdate=="function";Dn||typeof Re.UNSAFE_componentWillReceiveProps!="function"&&typeof Re.componentWillReceiveProps!="function"||(it!==B||xt!==Yt)&&ih(b,Re,B,Yt),Fl=!1;var In=b.memoizedState;Re.state=In,Jf(b,B,Re,Y),xt=b.memoizedState,it!==B||In!==xt||To.current||Fl?(typeof Mn=="function"&&(lf(b,M,Mn,B),xt=b.memoizedState),(it=Fl||ip(b,M,it,B,In,xt,Yt))?(Dn||typeof Re.UNSAFE_componentWillMount!="function"&&typeof Re.componentWillMount!="function"||(typeof Re.componentWillMount=="function"&&Re.componentWillMount(),typeof Re.UNSAFE_componentWillMount=="function"&&Re.UNSAFE_componentWillMount()),typeof Re.componentDidMount=="function"&&(b.flags|=4194308)):(typeof Re.componentDidMount=="function"&&(b.flags|=4194308),b.memoizedProps=B,b.memoizedState=xt),Re.props=B,Re.state=xt,Re.context=Yt,B=it):(typeof Re.componentDidMount=="function"&&(b.flags|=4194308),B=!1)}else{Re=b.stateNode,vm(g,b),it=b.memoizedProps,Yt=b.type===b.elementType?it:Xs(b.type,it),Re.props=Yt,Dn=b.pendingProps,In=Re.context,xt=M.contextType,typeof xt=="object"&&xt!==null?xt=jo(xt):(xt=Eo(M)?Ml:Ws.current,xt=_c(b,xt));var Kn=M.getDerivedStateFromProps;(Mn=typeof Kn=="function"||typeof Re.getSnapshotBeforeUpdate=="function")||typeof Re.UNSAFE_componentWillReceiveProps!="function"&&typeof Re.componentWillReceiveProps!="function"||(it!==Dn||In!==xt)&&ih(b,Re,B,xt),Fl=!1,In=b.memoizedState,Re.state=In,Jf(b,B,Re,Y);var hr=b.memoizedState;it!==Dn||In!==hr||To.current||Fl?(typeof Kn=="function"&&(lf(b,M,Kn,B),hr=b.memoizedState),(Yt=Fl||ip(b,M,Yt,B,In,hr,xt)||!1)?(Mn||typeof Re.UNSAFE_componentWillUpdate!="function"&&typeof Re.componentWillUpdate!="function"||(typeof Re.componentWillUpdate=="function"&&Re.componentWillUpdate(B,hr,xt),typeof Re.UNSAFE_componentWillUpdate=="function"&&Re.UNSAFE_componentWillUpdate(B,hr,xt)),typeof Re.componentDidUpdate=="function"&&(b.flags|=4),typeof Re.getSnapshotBeforeUpdate=="function"&&(b.flags|=1024)):(typeof Re.componentDidUpdate!="function"||it===g.memoizedProps&&In===g.memoizedState||(b.flags|=4),typeof Re.getSnapshotBeforeUpdate!="function"||it===g.memoizedProps&&In===g.memoizedState||(b.flags|=1024),b.memoizedProps=B,b.memoizedState=hr),Re.props=B,Re.state=hr,Re.context=xt,B=Yt):(typeof Re.componentDidUpdate!="function"||it===g.memoizedProps&&In===g.memoizedState||(b.flags|=4),typeof Re.getSnapshotBeforeUpdate!="function"||it===g.memoizedProps&&In===g.memoizedState||(b.flags|=1024),B=!1)}return cp(g,b,M,B,se,Y)}function cp(g,b,M,B,Y,se){Tm(g,b);var Re=(b.flags&128)!==0;if(!B&&!Re)return Y&&Hd(b,M,!1),ta(g,b,se);B=b.stateNode,pf.current=b;var it=Re&&typeof M.getDerivedStateFromError!="function"?null:B.render();return b.flags|=1,g!==null&&Re?(b.child=rl(b,g.child,null,se),b.child=rl(b,null,it,se)):ro(g,b,it,se),b.memoizedState=B.state,Y&&Hd(b,M,!0),b.child}function up(g){var b=g.stateNode;b.pendingContext?Xh(g,b.pendingContext,b.pendingContext!==b.context):b.context&&Xh(g,b.context,!1),Nl(g,b.containerInfo)}function Im(g,b,M,B,Y){return Zd(),nl(Y),b.flags|=256,ro(g,b,M,B),b.child}var dp={dehydrated:null,treeContext:null,retryLane:0};function hp(g){return{baseLanes:g,cachePool:null,transitions:null}}function Pm(g,b,M){var B=b.pendingProps,Y=as.current,se=!1,Re=(b.flags&128)!==0,it;if((it=Re)||(it=g!==null&&g.memoizedState===null?!1:(Y&2)!==0),it?(se=!0,b.flags&=-129):(g===null||g.memoizedState!==null)&&(Y|=1),ds(as,Y&1),g===null)return Kf(b),g=b.memoizedState,g!==null&&(g=g.dehydrated,g!==null)?((b.mode&1)===0?b.lanes=1:g.data==="$!"?b.lanes=8:b.lanes=1073741824,null):(Re=B.children,g=B.fallback,se?(B=b.mode,se=b.child,Re={mode:"hidden",children:Re},(B&1)===0&&se!==null?(se.childLanes=0,se.pendingProps=Re):se=sd(Re,B,0,null),g=Zl(g,B,M,null),se.return=b,g.return=b,se.sibling=g,b.child=se,b.child.memoizedState=hp(M),b.memoizedState=dp,g):fp(b,Re));if(Y=g.memoizedState,Y!==null&&(it=Y.dehydrated,it!==null))return sy(g,b,Re,B,it,Y,M);if(se){se=B.fallback,Re=b.mode,Y=g.child,it=Y.sibling;var xt={mode:"hidden",children:B.children};return(Re&1)===0&&b.child!==Y?(B=b.child,B.childLanes=0,B.pendingProps=xt,b.deletions=null):(B=va(Y,xt),B.subtreeFlags=Y.subtreeFlags&14680064),it!==null?se=va(it,se):(se=Zl(se,Re,M,null),se.flags|=2),se.return=b,B.return=b,B.sibling=se,b.child=B,B=se,se=b.child,Re=g.child.memoizedState,Re=Re===null?hp(M):{baseLanes:Re.baseLanes|M,cachePool:null,transitions:Re.transitions},se.memoizedState=Re,se.childLanes=g.childLanes&~M,b.memoizedState=dp,B}return se=g.child,g=se.sibling,B=va(se,{mode:"visible",children:B.children}),(b.mode&1)===0&&(B.lanes=M),B.return=b,B.sibling=null,g!==null&&(M=b.deletions,M===null?(b.deletions=[g],b.flags|=16):M.push(g)),b.child=B,b.memoizedState=null,B}function fp(g,b){return b=sd({mode:"visible",children:b},g.mode,0,null),b.return=g,g.child=b}function _f(g,b,M,B){return B!==null&&nl(B),rl(b,g.child,null,M),g=fp(b,b.pendingProps.children),g.flags|=2,b.memoizedState=null,g}function sy(g,b,M,B,Y,se,Re){if(M)return b.flags&256?(b.flags&=-257,B=df(Error(o(422))),_f(g,b,Re,B)):b.memoizedState!==null?(b.child=g.child,b.flags|=128,null):(se=B.fallback,Y=b.mode,B=sd({mode:"visible",children:B.children},Y,0,null),se=Zl(se,Y,Re,null),se.flags|=2,B.return=b,se.return=b,B.sibling=se,b.child=B,(b.mode&1)!==0&&rl(b,g.child,null,Re),b.child.memoizedState=hp(Re),b.memoizedState=dp,se);if((b.mode&1)===0)return _f(g,b,Re,null);if(Y.data==="$!"){if(B=Y.nextSibling&&Y.nextSibling.dataset,B)var it=B.dgst;return B=it,se=Error(o(419)),B=df(se,B,void 0),_f(g,b,Re,B)}if(it=(Re&g.childLanes)!==0,no||it){if(B=ye,B!==null){switch(Re&-Re){case 4:Y=2;break;case 16:Y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:Y=32;break;case 536870912:Y=268435456;break;default:Y=0}Y=(Y&(B.suspendedLanes|Re))!==0?0:Y,Y!==0&&Y!==se.retryLane&&(se.retryLane=Y,Ln(g,Y),dn(B,g,Y,-1))}return Gi(),B=df(Error(o(421))),_f(g,b,Re,B)}return Y.data==="$?"?(b.flags|=128,b.child=g.child,b=oo.bind(null,g),Y._reactRetry=b,null):(g=se.treeContext,Xo=pc(Y.nextSibling),Ss=b,hs=!0,Ma=null,g!==null&&(No[fa++]=Ll,No[fa++]=Dl,No[fa++]=pa,Ll=g.id,Dl=g.overflow,pa=b),b=fp(b,B.children),b.flags|=4096,b)}function Mg(g,b,M){g.lanes|=b;var B=g.alternate;B!==null&&(B.lanes|=b),Ku(g.return,b,M)}function ki(g,b,M,B,Y){var se=g.memoizedState;se===null?g.memoizedState={isBackwards:b,rendering:null,renderingStartTime:0,last:B,tail:M,tailMode:Y}:(se.isBackwards=b,se.rendering=null,se.renderingStartTime=0,se.last=B,se.tail=M,se.tailMode=Y)}function Am(g,b,M){var B=b.pendingProps,Y=B.revealOrder,se=B.tail;if(ro(g,b,B.children,M),B=as.current,(B&2)!==0)B=B&1|2,b.flags|=128;else{if(g!==null&&(g.flags&128)!==0)e:for(g=b.child;g!==null;){if(g.tag===13)g.memoizedState!==null&&Mg(g,M,b);else if(g.tag===19)Mg(g,M,b);else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===b)break e;for(;g.sibling===null;){if(g.return===null||g.return===b)break e;g=g.return}g.sibling.return=g.return,g=g.sibling}B&=1}if(ds(as,B),(b.mode&1)===0)b.memoizedState=null;else switch(Y){case"forwards":for(M=b.child,Y=null;M!==null;)g=M.alternate,g!==null&&nf(g)===null&&(Y=M),M=M.sibling;M=Y,M===null?(Y=b.child,b.child=null):(Y=M.sibling,M.sibling=null),ki(b,!1,Y,M,se);break;case"backwards":for(M=null,Y=b.child,b.child=null;Y!==null;){if(g=Y.alternate,g!==null&&nf(g)===null){b.child=Y;break}g=Y.sibling,Y.sibling=M,M=Y,Y=g}ki(b,!0,M,null,se);break;case"together":ki(b,!1,null,null,void 0);break;default:b.memoizedState=null}return b.child}function pp(g,b){(b.mode&1)===0&&g!==null&&(g.alternate=null,b.alternate=null,b.flags|=2)}function ta(g,b,M){if(g!==null&&(b.dependencies=g.dependencies),Oe|=b.lanes,(M&b.childLanes)===0)return null;if(g!==null&&b.child!==g.child)throw Error(o(153));if(b.child!==null){for(g=b.child,M=va(g,g.pendingProps),b.child=M,M.return=b;g.sibling!==null;)g=g.sibling,M=M.sibling=va(g,g.pendingProps),M.return=b;M.sibling=null}return b.child}function oy(g,b,M){switch(b.tag){case 3:up(b),Zd();break;case 5:tf(b);break;case 1:Eo(b.type)&&Hu(b);break;case 4:Nl(b,b.stateNode.containerInfo);break;case 10:var B=b.type._context,Y=b.memoizedProps.value;ds(eu,B._currentValue),B._currentValue=Y;break;case 13:if(B=b.memoizedState,B!==null)return B.dehydrated!==null?(ds(as,as.current&1),b.flags|=128,null):(M&b.child.childLanes)!==0?Pm(g,b,M):(ds(as,as.current&1),g=ta(g,b,M),g!==null?g.sibling:null);ds(as,as.current&1);break;case 19:if(B=(M&b.childLanes)!==0,(g.flags&128)!==0){if(B)return Am(g,b,M);b.flags|=128}if(Y=b.memoizedState,Y!==null&&(Y.rendering=null,Y.tail=null,Y.lastEffect=null),ds(as,as.current),B)break;return null;case 22:case 23:return b.lanes=0,gf(g,b,M)}return ta(g,b,M)}var id,mp,yf,oh;id=function(g,b){for(var M=b.child;M!==null;){if(M.tag===5||M.tag===6)g.appendChild(M.stateNode);else if(M.tag!==4&&M.child!==null){M.child.return=M,M=M.child;continue}if(M===b)break;for(;M.sibling===null;){if(M.return===null||M.return===b)return;M=M.return}M.sibling.return=M.return,M=M.sibling}},mp=function(){},yf=function(g,b,M,B){var Y=g.memoizedProps;if(Y!==B){g=b.stateNode,qs(La.current);var se=null;switch(M){case"input":Y=Zt(g,Y),B=Zt(g,B),se=[];break;case"select":Y=ct({},Y,{value:void 0}),B=ct({},B,{value:void 0}),se=[];break;case"textarea":Y=is(g,Y),B=is(g,B),se=[];break;default:typeof Y.onClick!="function"&&typeof B.onClick=="function"&&(g.onclick=Kc)}ho(M,B);var Re;M=null;for(Yt in Y)if(!B.hasOwnProperty(Yt)&&Y.hasOwnProperty(Yt)&&Y[Yt]!=null)if(Yt==="style"){var it=Y[Yt];for(Re in it)it.hasOwnProperty(Re)&&(M||(M={}),M[Re]="")}else Yt!=="dangerouslySetInnerHTML"&&Yt!=="children"&&Yt!=="suppressContentEditableWarning"&&Yt!=="suppressHydrationWarning"&&Yt!=="autoFocus"&&(d.hasOwnProperty(Yt)?se||(se=[]):(se=se||[]).push(Yt,null));for(Yt in B){var xt=B[Yt];if(it=Y!=null?Y[Yt]:void 0,B.hasOwnProperty(Yt)&&xt!==it&&(xt!=null||it!=null))if(Yt==="style")if(it){for(Re in it)!it.hasOwnProperty(Re)||xt&&xt.hasOwnProperty(Re)||(M||(M={}),M[Re]="");for(Re in xt)xt.hasOwnProperty(Re)&&it[Re]!==xt[Re]&&(M||(M={}),M[Re]=xt[Re])}else M||(se||(se=[]),se.push(Yt,M)),M=xt;else Yt==="dangerouslySetInnerHTML"?(xt=xt?xt.__html:void 0,it=it?it.__html:void 0,xt!=null&&it!==xt&&(se=se||[]).push(Yt,xt)):Yt==="children"?typeof xt!="string"&&typeof xt!="number"||(se=se||[]).push(Yt,""+xt):Yt!=="suppressContentEditableWarning"&&Yt!=="suppressHydrationWarning"&&(d.hasOwnProperty(Yt)?(xt!=null&&Yt==="onScroll"&&ws("scroll",g),se||it===xt||(se=[])):(se=se||[]).push(Yt,xt))}M&&(se=se||[]).push("style",M);var Yt=se;(b.updateQueue=Yt)&&(b.flags|=4)}},oh=function(g,b,M,B){M!==B&&(b.flags|=4)};function na(g,b){if(!hs)switch(g.tailMode){case"hidden":b=g.tail;for(var M=null;b!==null;)b.alternate!==null&&(M=b),b=b.sibling;M===null?g.tail=null:M.sibling=null;break;case"collapsed":M=g.tail;for(var B=null;M!==null;)M.alternate!==null&&(B=M),M=M.sibling;B===null?b||g.tail===null?g.tail=null:g.tail.sibling=null:B.sibling=null}}function io(g){var b=g.alternate!==null&&g.alternate.child===g.child,M=0,B=0;if(b)for(var Y=g.child;Y!==null;)M|=Y.lanes|Y.childLanes,B|=Y.subtreeFlags&14680064,B|=Y.flags&14680064,Y.return=g,Y=Y.sibling;else for(Y=g.child;Y!==null;)M|=Y.lanes|Y.childLanes,B|=Y.subtreeFlags,B|=Y.flags,Y.return=g,Y=Y.sibling;return g.subtreeFlags|=B,g.childLanes=M,b}function _s(g,b,M){var B=b.pendingProps;switch(Zf(b),b.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return io(b),null;case 1:return Eo(b.type)&&$d(),io(b),null;case 3:return B=b.stateNode,Da(),es(To),es(Ws),ni(),B.pendingContext&&(B.context=B.pendingContext,B.pendingContext=null),(g===null||g.child===null)&&(Ol(b)?b.flags|=4:g===null||g.memoizedState.isDehydrated&&(b.flags&256)===0||(b.flags|=1024,Ma!==null&&(ri(Ma),Ma=null))),mp(g,b),io(b),null;case 5:Yd(b);var Y=qs(Qu.current);if(M=b.type,g!==null&&b.stateNode!=null)yf(g,b,M,B,Y),g.ref!==b.ref&&(b.flags|=512,b.flags|=2097152);else{if(!B){if(b.stateNode===null)throw Error(o(166));return io(b),null}if(g=qs(La.current),Ol(b)){B=b.stateNode,M=b.type;var se=b.memoizedProps;switch(B[Zo]=b,B[Vd]=se,g=(b.mode&1)!==0,M){case"dialog":ws("cancel",B),ws("close",B);break;case"iframe":case"object":case"embed":ws("load",B);break;case"video":case"audio":for(Y=0;Y<ju.length;Y++)ws(ju[Y],B);break;case"source":ws("error",B);break;case"img":case"image":case"link":ws("error",B),ws("load",B);break;case"details":ws("toggle",B);break;case"input":mn(B,se),ws("invalid",B);break;case"select":B._wrapperState={wasMultiple:!!se.multiple},ws("invalid",B);break;case"textarea":Zi(B,se),ws("invalid",B)}ho(M,se),Y=null;for(var Re in se)if(se.hasOwnProperty(Re)){var it=se[Re];Re==="children"?typeof it=="string"?B.textContent!==it&&(se.suppressHydrationWarning!==!0&&fc(B.textContent,it,g),Y=["children",it]):typeof it=="number"&&B.textContent!==""+it&&(se.suppressHydrationWarning!==!0&&fc(B.textContent,it,g),Y=["children",""+it]):d.hasOwnProperty(Re)&&it!=null&&Re==="onScroll"&&ws("scroll",B)}switch(M){case"input":Nn(B),Yr(B,se,!0);break;case"textarea":Nn(B),Bi(B);break;case"select":case"option":break;default:typeof se.onClick=="function"&&(B.onclick=Kc)}B=Y,b.updateQueue=B,B!==null&&(b.flags|=4)}else{Re=Y.nodeType===9?Y:Y.ownerDocument,g==="http://www.w3.org/1999/xhtml"&&(g=Fr(M)),g==="http://www.w3.org/1999/xhtml"?M==="script"?(g=Re.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild)):typeof B.is=="string"?g=Re.createElement(M,{is:B.is}):(g=Re.createElement(M),M==="select"&&(Re=g,B.multiple?Re.multiple=!0:B.size&&(Re.size=B.size))):g=Re.createElementNS(g,M),g[Zo]=b,g[Vd]=B,id(g,b,!1,!1),b.stateNode=g;e:{switch(Re=gl(M,B),M){case"dialog":ws("cancel",g),ws("close",g),Y=B;break;case"iframe":case"object":case"embed":ws("load",g),Y=B;break;case"video":case"audio":for(Y=0;Y<ju.length;Y++)ws(ju[Y],g);Y=B;break;case"source":ws("error",g),Y=B;break;case"img":case"image":case"link":ws("error",g),ws("load",g),Y=B;break;case"details":ws("toggle",g),Y=B;break;case"input":mn(g,B),Y=Zt(g,B),ws("invalid",g);break;case"option":Y=B;break;case"select":g._wrapperState={wasMultiple:!!B.multiple},Y=ct({},B,{value:void 0}),ws("invalid",g);break;case"textarea":Zi(g,B),Y=is(g,B),ws("invalid",g);break;default:Y=B}ho(M,Y),it=Y;for(se in it)if(it.hasOwnProperty(se)){var xt=it[se];se==="style"?Zr(g,xt):se==="dangerouslySetInnerHTML"?(xt=xt?xt.__html:void 0,xt!=null&&ur(g,xt)):se==="children"?typeof xt=="string"?(M!=="textarea"||xt!=="")&&us(g,xt):typeof xt=="number"&&us(g,""+xt):se!=="suppressContentEditableWarning"&&se!=="suppressHydrationWarning"&&se!=="autoFocus"&&(d.hasOwnProperty(se)?xt!=null&&se==="onScroll"&&ws("scroll",g):xt!=null&&ue(g,se,xt,Re))}switch(M){case"input":Nn(g),Yr(g,B,!1);break;case"textarea":Nn(g),Bi(g);break;case"option":B.value!=null&&g.setAttribute("value",""+hn(B.value));break;case"select":g.multiple=!!B.multiple,se=B.value,se!=null?Or(g,!!B.multiple,se,!1):B.defaultValue!=null&&Or(g,!!B.multiple,B.defaultValue,!0);break;default:typeof Y.onClick=="function"&&(g.onclick=Kc)}switch(M){case"button":case"input":case"select":case"textarea":B=!!B.autoFocus;break e;case"img":B=!0;break e;default:B=!1}}B&&(b.flags|=4)}b.ref!==null&&(b.flags|=512,b.flags|=2097152)}return io(b),null;case 6:if(g&&b.stateNode!=null)oh(g,b,g.memoizedProps,B);else{if(typeof B!="string"&&b.stateNode===null)throw Error(o(166));if(M=qs(Qu.current),qs(La.current),Ol(b)){if(B=b.stateNode,M=b.memoizedProps,B[Zo]=b,(se=B.nodeValue!==M)&&(g=Ss,g!==null))switch(g.tag){case 3:fc(B.nodeValue,M,(g.mode&1)!==0);break;case 5:g.memoizedProps.suppressHydrationWarning!==!0&&fc(B.nodeValue,M,(g.mode&1)!==0)}se&&(b.flags|=4)}else B=(M.nodeType===9?M:M.ownerDocument).createTextNode(B),B[Zo]=b,b.stateNode=B}return io(b),null;case 13:if(es(as),B=b.memoizedState,g===null||g.memoizedState!==null&&g.memoizedState.dehydrated!==null){if(hs&&Xo!==null&&(b.mode&1)!==0&&(b.flags&128)===0)_m(),Zd(),b.flags|=98560,se=!1;else if(se=Ol(b),B!==null&&B.dehydrated!==null){if(g===null){if(!se)throw Error(o(318));if(se=b.memoizedState,se=se!==null?se.dehydrated:null,!se)throw Error(o(317));se[Zo]=b}else Zd(),(b.flags&128)===0&&(b.memoizedState=null),b.flags|=4;io(b),se=!1}else Ma!==null&&(ri(Ma),Ma=null),se=!0;if(!se)return b.flags&65536?b:null}return(b.flags&128)!==0?(b.lanes=M,b):(B=B!==null,B!==(g!==null&&g.memoizedState!==null)&&B&&(b.child.flags|=8192,(b.mode&1)!==0&&(g===null||(as.current&1)!==0?Me===0&&(Me=3):Gi())),b.updateQueue!==null&&(b.flags|=4),io(b),null);case 4:return Da(),mp(g,b),g===null&&Gh(b.stateNode.containerInfo),io(b),null;case 10:return nu(b.type._context),io(b),null;case 17:return Eo(b.type)&&$d(),io(b),null;case 19:if(es(as),se=b.memoizedState,se===null)return io(b),null;if(B=(b.flags&128)!==0,Re=se.rendering,Re===null)if(B)na(se,!1);else{if(Me!==0||g!==null&&(g.flags&128)!==0)for(g=b.child;g!==null;){if(Re=nf(g),Re!==null){for(b.flags|=128,na(se,!1),B=Re.updateQueue,B!==null&&(b.updateQueue=B,b.flags|=4),b.subtreeFlags=0,B=M,M=b.child;M!==null;)se=M,g=B,se.flags&=14680066,Re=se.alternate,Re===null?(se.childLanes=0,se.lanes=g,se.child=null,se.subtreeFlags=0,se.memoizedProps=null,se.memoizedState=null,se.updateQueue=null,se.dependencies=null,se.stateNode=null):(se.childLanes=Re.childLanes,se.lanes=Re.lanes,se.child=Re.child,se.subtreeFlags=0,se.deletions=null,se.memoizedProps=Re.memoizedProps,se.memoizedState=Re.memoizedState,se.updateQueue=Re.updateQueue,se.type=Re.type,g=Re.dependencies,se.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext}),M=M.sibling;return ds(as,as.current&1|2),b.child}g=g.sibling}se.tail!==null&&vr()>Ht&&(b.flags|=128,B=!0,na(se,!1),b.lanes=4194304)}else{if(!B)if(g=nf(Re),g!==null){if(b.flags|=128,B=!0,M=g.updateQueue,M!==null&&(b.updateQueue=M,b.flags|=4),na(se,!0),se.tail===null&&se.tailMode==="hidden"&&!Re.alternate&&!hs)return io(b),null}else 2*vr()-se.renderingStartTime>Ht&&M!==1073741824&&(b.flags|=128,B=!0,na(se,!1),b.lanes=4194304);se.isBackwards?(Re.sibling=b.child,b.child=Re):(M=se.last,M!==null?M.sibling=Re:b.child=Re,se.last=Re)}return se.tail!==null?(b=se.tail,se.rendering=b,se.tail=b.sibling,se.renderingStartTime=vr(),b.sibling=null,M=as.current,ds(as,B?M&1|2:M&1),b):(io(b),null);case 22:case 23:return Cr(),B=b.memoizedState!==null,g!==null&&g.memoizedState!==null!==B&&(b.flags|=8192),B&&(b.mode&1)!==0?(ke&1073741824)!==0&&(io(b),b.subtreeFlags&6&&(b.flags|=8192)):io(b),null;case 24:return null;case 25:return null}throw Error(o(156,b.tag))}function al(g,b){switch(Zf(b),b.tag){case 1:return Eo(b.type)&&$d(),g=b.flags,g&65536?(b.flags=g&-65537|128,b):null;case 3:return Da(),es(To),es(Ws),ni(),g=b.flags,(g&65536)!==0&&(g&128)===0?(b.flags=g&-65537|128,b):null;case 5:return Yd(b),null;case 13:if(es(as),g=b.memoizedState,g!==null&&g.dehydrated!==null){if(b.alternate===null)throw Error(o(340));Zd()}return g=b.flags,g&65536?(b.flags=g&-65537|128,b):null;case 19:return es(as),null;case 4:return Da(),null;case 10:return nu(b.type._context),null;case 22:case 23:return Cr(),null;case 24:return null;default:return null}}var cu=!1,so=!1,Lg=typeof WeakSet=="function"?WeakSet:Set,er=null;function $l(g,b){var M=g.ref;if(M!==null)if(typeof M=="function")try{M(null)}catch(B){br(g,b,B)}else M.current=null}function gp(g,b,M){try{M()}catch(B){br(g,b,B)}}var _p=!1;function ka(g,b){if(Nd=Bc,g=Md(),jh(g)){if("selectionStart"in g)var M={start:g.selectionStart,end:g.selectionEnd};else e:{M=(M=g.ownerDocument)&&M.defaultView||window;var B=M.getSelection&&M.getSelection();if(B&&B.rangeCount!==0){M=B.anchorNode;var Y=B.anchorOffset,se=B.focusNode;B=B.focusOffset;try{M.nodeType,se.nodeType}catch{M=null;break e}var Re=0,it=-1,xt=-1,Yt=0,Mn=0,Dn=g,In=null;t:for(;;){for(var Kn;Dn!==M||Y!==0&&Dn.nodeType!==3||(it=Re+Y),Dn!==se||B!==0&&Dn.nodeType!==3||(xt=Re+B),Dn.nodeType===3&&(Re+=Dn.nodeValue.length),(Kn=Dn.firstChild)!==null;)In=Dn,Dn=Kn;for(;;){if(Dn===g)break t;if(In===M&&++Yt===Y&&(it=Re),In===se&&++Mn===B&&(xt=Re),(Kn=Dn.nextSibling)!==null)break;Dn=In,In=Dn.parentNode}Dn=Kn}M=it===-1||xt===-1?null:{start:it,end:xt}}else M=null}M=M||{start:0,end:0}}else M=null;for(jd={focusedElem:g,selectionRange:M},Bc=!1,er=b;er!==null;)if(b=er,g=b.child,(b.subtreeFlags&1028)!==0&&g!==null)g.return=b,er=g;else for(;er!==null;){b=er;try{var hr=b.alternate;if((b.flags&1024)!==0)switch(b.tag){case 0:case 11:case 15:break;case 1:if(hr!==null){var _r=hr.memoizedProps,Ys=hr.memoizedState,Ut=b.stateNode,Pt=Ut.getSnapshotBeforeUpdate(b.elementType===b.type?_r:Xs(b.type,_r),Ys);Ut.__reactInternalSnapshotBeforeUpdate=Pt}break;case 3:var $t=b.stateNode.containerInfo;$t.nodeType===1?$t.textContent="":$t.nodeType===9&&$t.documentElement&&$t.removeChild($t.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(Tn){br(b,b.return,Tn)}if(g=b.sibling,g!==null){g.return=b.return,er=g;break}er=b.return}return hr=_p,_p=!1,hr}function Tc(g,b,M){var B=b.updateQueue;if(B=B!==null?B.lastEffect:null,B!==null){var Y=B=B.next;do{if((Y.tag&g)===g){var se=Y.destroy;Y.destroy=void 0,se!==void 0&&gp(b,M,se)}Y=Y.next}while(Y!==B)}}function uu(g,b){if(b=b.updateQueue,b=b!==null?b.lastEffect:null,b!==null){var M=b=b.next;do{if((M.tag&g)===g){var B=M.create;M.destroy=B()}M=M.next}while(M!==b)}}function du(g){var b=g.ref;if(b!==null){var M=g.stateNode;switch(g.tag){case 5:g=M;break;default:g=M}typeof b=="function"?b(g):b.current=g}}function Hl(g){var b=g.alternate;b!==null&&(g.alternate=null,Hl(b)),g.child=null,g.deletions=null,g.sibling=null,g.tag===5&&(b=g.stateNode,b!==null&&(delete b[Zo],delete b[Vd],delete b[qh],delete b[ny],delete b[Gf])),g.stateNode=null,g.return=null,g.dependencies=null,g.memoizedProps=null,g.memoizedState=null,g.pendingProps=null,g.stateNode=null,g.updateQueue=null}function Oa(g){return g.tag===5||g.tag===3||g.tag===4}function za(g){e:for(;;){for(;g.sibling===null;){if(g.return===null||Oa(g.return))return null;g=g.return}for(g.sibling.return=g.return,g=g.sibling;g.tag!==5&&g.tag!==6&&g.tag!==18;){if(g.flags&2||g.child===null||g.tag===4)continue e;g.child.return=g,g=g.child}if(!(g.flags&2))return g.stateNode}}function Gl(g,b,M){var B=g.tag;if(B===5||B===6)g=g.stateNode,b?M.nodeType===8?M.parentNode.insertBefore(g,b):M.insertBefore(g,b):(M.nodeType===8?(b=M.parentNode,b.insertBefore(g,M)):(b=M,b.appendChild(g)),M=M._reactRootContainer,M!=null||b.onclick!==null||(b.onclick=Kc));else if(B!==4&&(g=g.child,g!==null))for(Gl(g,b,M),g=g.sibling;g!==null;)Gl(g,b,M),g=g.sibling}function Ec(g,b,M){var B=g.tag;if(B===5||B===6)g=g.stateNode,b?M.insertBefore(g,b):M.appendChild(g);else if(B!==4&&(g=g.child,g!==null))for(Ec(g,b,M),g=g.sibling;g!==null;)Ec(g,b,M),g=g.sibling}var f=null,r=!1;function l(g,b,M){for(M=M.child;M!==null;)p(g,b,M),M=M.sibling}function p(g,b,M){if(ms&&typeof ms.onCommitFiberUnmount=="function")try{ms.onCommitFiberUnmount($s,M)}catch{}switch(M.tag){case 5:so||$l(M,b);case 6:var B=f,Y=r;f=null,l(g,b,M),f=B,r=Y,f!==null&&(r?(g=f,M=M.stateNode,g.nodeType===8?g.parentNode.removeChild(M):g.removeChild(M)):f.removeChild(M.stateNode));break;case 18:f!==null&&(r?(g=f,M=M.stateNode,g.nodeType===8?Vu(g.parentNode,M):g.nodeType===1&&Vu(g,M),Ru(g)):Vu(f,M.stateNode));break;case 4:B=f,Y=r,f=M.stateNode.containerInfo,r=!0,l(g,b,M),f=B,r=Y;break;case 0:case 11:case 14:case 15:if(!so&&(B=M.updateQueue,B!==null&&(B=B.lastEffect,B!==null))){Y=B=B.next;do{var se=Y,Re=se.destroy;se=se.tag,Re!==void 0&&((se&2)!==0||(se&4)!==0)&&gp(M,b,Re),Y=Y.next}while(Y!==B)}l(g,b,M);break;case 1:if(!so&&($l(M,b),B=M.stateNode,typeof B.componentWillUnmount=="function"))try{B.props=M.memoizedProps,B.state=M.memoizedState,B.componentWillUnmount()}catch(it){br(M,b,it)}l(g,b,M);break;case 21:l(g,b,M);break;case 22:M.mode&1?(so=(B=so)||M.memoizedState!==null,l(g,b,M),so=B):l(g,b,M);break;default:l(g,b,M)}}function v(g){var b=g.updateQueue;if(b!==null){g.updateQueue=null;var M=g.stateNode;M===null&&(M=g.stateNode=new Lg),b.forEach(function(B){var Y=ll.bind(null,g,B);M.has(B)||(M.add(B),B.then(Y,Y))})}}function w(g,b){var M=b.deletions;if(M!==null)for(var B=0;B<M.length;B++){var Y=M[B];try{var se=g,Re=b,it=Re;e:for(;it!==null;){switch(it.tag){case 5:f=it.stateNode,r=!1;break e;case 3:f=it.stateNode.containerInfo,r=!0;break e;case 4:f=it.stateNode.containerInfo,r=!0;break e}it=it.return}if(f===null)throw Error(o(160));p(se,Re,Y),f=null,r=!1;var xt=Y.alternate;xt!==null&&(xt.return=null),Y.return=null}catch(Yt){br(Y,b,Yt)}}if(b.subtreeFlags&12854)for(b=b.child;b!==null;)C(b,g),b=b.sibling}function C(g,b){var M=g.alternate,B=g.flags;switch(g.tag){case 0:case 11:case 14:case 15:if(w(b,g),P(g),B&4){try{Tc(3,g,g.return),uu(3,g)}catch(_r){br(g,g.return,_r)}try{Tc(5,g,g.return)}catch(_r){br(g,g.return,_r)}}break;case 1:w(b,g),P(g),B&512&&M!==null&&$l(M,M.return);break;case 5:if(w(b,g),P(g),B&512&&M!==null&&$l(M,M.return),g.flags&32){var Y=g.stateNode;try{us(Y,"")}catch(_r){br(g,g.return,_r)}}if(B&4&&(Y=g.stateNode,Y!=null)){var se=g.memoizedProps,Re=M!==null?M.memoizedProps:se,it=g.type,xt=g.updateQueue;if(g.updateQueue=null,xt!==null)try{it==="input"&&se.type==="radio"&&se.name!=null&&kr(Y,se),gl(it,Re);var Yt=gl(it,se);for(Re=0;Re<xt.length;Re+=2){var Mn=xt[Re],Dn=xt[Re+1];Mn==="style"?Zr(Y,Dn):Mn==="dangerouslySetInnerHTML"?ur(Y,Dn):Mn==="children"?us(Y,Dn):ue(Y,Mn,Dn,Yt)}switch(it){case"input":Gr(Y,se);break;case"textarea":Dr(Y,se);break;case"select":var In=Y._wrapperState.wasMultiple;Y._wrapperState.wasMultiple=!!se.multiple;var Kn=se.value;Kn!=null?Or(Y,!!se.multiple,Kn,!1):In!==!!se.multiple&&(se.defaultValue!=null?Or(Y,!!se.multiple,se.defaultValue,!0):Or(Y,!!se.multiple,se.multiple?[]:"",!1))}Y[Vd]=se}catch(_r){br(g,g.return,_r)}}break;case 6:if(w(b,g),P(g),B&4){if(g.stateNode===null)throw Error(o(162));Y=g.stateNode,se=g.memoizedProps;try{Y.nodeValue=se}catch(_r){br(g,g.return,_r)}}break;case 3:if(w(b,g),P(g),B&4&&M!==null&&M.memoizedState.isDehydrated)try{Ru(b.containerInfo)}catch(_r){br(g,g.return,_r)}break;case 4:w(b,g),P(g);break;case 13:w(b,g),P(g),Y=g.child,Y.flags&8192&&(se=Y.memoizedState!==null,Y.stateNode.isHidden=se,!se||Y.alternate!==null&&Y.alternate.memoizedState!==null||(It=vr())),B&4&&v(g);break;case 22:if(Mn=M!==null&&M.memoizedState!==null,g.mode&1?(so=(Yt=so)||Mn,w(b,g),so=Yt):w(b,g),P(g),B&8192){if(Yt=g.memoizedState!==null,(g.stateNode.isHidden=Yt)&&!Mn&&(g.mode&1)!==0)for(er=g,Mn=g.child;Mn!==null;){for(Dn=er=Mn;er!==null;){switch(In=er,Kn=In.child,In.tag){case 0:case 11:case 14:case 15:Tc(4,In,In.return);break;case 1:$l(In,In.return);var hr=In.stateNode;if(typeof hr.componentWillUnmount=="function"){B=In,M=In.return;try{b=B,hr.props=b.memoizedProps,hr.state=b.memoizedState,hr.componentWillUnmount()}catch(_r){br(B,M,_r)}}break;case 5:$l(In,In.return);break;case 22:if(In.memoizedState!==null){H(Dn);continue}}Kn!==null?(Kn.return=In,er=Kn):H(Dn)}Mn=Mn.sibling}e:for(Mn=null,Dn=g;;){if(Dn.tag===5){if(Mn===null){Mn=Dn;try{Y=Dn.stateNode,Yt?(se=Y.style,typeof se.setProperty=="function"?se.setProperty("display","none","important"):se.display="none"):(it=Dn.stateNode,xt=Dn.memoizedProps.style,Re=xt!=null&&xt.hasOwnProperty("display")?xt.display:null,it.style.display=On("display",Re))}catch(_r){br(g,g.return,_r)}}}else if(Dn.tag===6){if(Mn===null)try{Dn.stateNode.nodeValue=Yt?"":Dn.memoizedProps}catch(_r){br(g,g.return,_r)}}else if((Dn.tag!==22&&Dn.tag!==23||Dn.memoizedState===null||Dn===g)&&Dn.child!==null){Dn.child.return=Dn,Dn=Dn.child;continue}if(Dn===g)break e;for(;Dn.sibling===null;){if(Dn.return===null||Dn.return===g)break e;Mn===Dn&&(Mn=null),Dn=Dn.return}Mn===Dn&&(Mn=null),Dn.sibling.return=Dn.return,Dn=Dn.sibling}}break;case 19:w(b,g),P(g),B&4&&v(g);break;case 21:break;default:w(b,g),P(g)}}function P(g){var b=g.flags;if(b&2){try{e:{for(var M=g.return;M!==null;){if(Oa(M)){var B=M;break e}M=M.return}throw Error(o(160))}switch(B.tag){case 5:var Y=B.stateNode;B.flags&32&&(us(Y,""),B.flags&=-33);var se=za(g);Ec(g,se,Y);break;case 3:case 4:var Re=B.stateNode.containerInfo,it=za(g);Gl(g,it,Re);break;default:throw Error(o(161))}}catch(xt){br(g,g.return,xt)}g.flags&=-3}b&4096&&(g.flags&=-4097)}function L(g,b,M){er=g,z(g)}function z(g,b,M){for(var B=(g.mode&1)!==0;er!==null;){var Y=er,se=Y.child;if(Y.tag===22&&B){var Re=Y.memoizedState!==null||cu;if(!Re){var it=Y.alternate,xt=it!==null&&it.memoizedState!==null||so;it=cu;var Yt=so;if(cu=Re,(so=xt)&&!Yt)for(er=Y;er!==null;)Re=er,xt=Re.child,Re.tag===22&&Re.memoizedState!==null?$(Y):xt!==null?(xt.return=Re,er=xt):$(Y);for(;se!==null;)er=se,z(se),se=se.sibling;er=Y,cu=it,so=Yt}j(g)}else(Y.subtreeFlags&8772)!==0&&se!==null?(se.return=Y,er=se):j(g)}}function j(g){for(;er!==null;){var b=er;if((b.flags&8772)!==0){var M=b.alternate;try{if((b.flags&8772)!==0)switch(b.tag){case 0:case 11:case 15:so||uu(5,b);break;case 1:var B=b.stateNode;if(b.flags&4&&!so)if(M===null)B.componentDidMount();else{var Y=b.elementType===b.type?M.memoizedProps:Xs(b.type,M.memoizedProps);B.componentDidUpdate(Y,M.memoizedState,B.__reactInternalSnapshotBeforeUpdate)}var se=b.updateQueue;se!==null&&Ig(b,se,B);break;case 3:var Re=b.updateQueue;if(Re!==null){if(M=null,b.child!==null)switch(b.child.tag){case 5:M=b.child.stateNode;break;case 1:M=b.child.stateNode}Ig(b,Re,M)}break;case 5:var it=b.stateNode;if(M===null&&b.flags&4){M=it;var xt=b.memoizedProps;switch(b.type){case"button":case"input":case"select":case"textarea":xt.autoFocus&&M.focus();break;case"img":xt.src&&(M.src=xt.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(b.memoizedState===null){var Yt=b.alternate;if(Yt!==null){var Mn=Yt.memoizedState;if(Mn!==null){var Dn=Mn.dehydrated;Dn!==null&&Ru(Dn)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(o(163))}so||b.flags&512&&du(b)}catch(In){br(b,b.return,In)}}if(b===g){er=null;break}if(M=b.sibling,M!==null){M.return=b.return,er=M;break}er=b.return}}function H(g){for(;er!==null;){var b=er;if(b===g){er=null;break}var M=b.sibling;if(M!==null){M.return=b.return,er=M;break}er=b.return}}function $(g){for(;er!==null;){var b=er;try{switch(b.tag){case 0:case 11:case 15:var M=b.return;try{uu(4,b)}catch(xt){br(b,M,xt)}break;case 1:var B=b.stateNode;if(typeof B.componentDidMount=="function"){var Y=b.return;try{B.componentDidMount()}catch(xt){br(b,Y,xt)}}var se=b.return;try{du(b)}catch(xt){br(b,se,xt)}break;case 5:var Re=b.return;try{du(b)}catch(xt){br(b,Re,xt)}}}catch(xt){br(b,b.return,xt)}if(b===g){er=null;break}var it=b.sibling;if(it!==null){it.return=b.return,er=it;break}er=b.return}}var q=Math.ceil,re=pe.ReactCurrentDispatcher,te=pe.ReactCurrentOwner,oe=pe.ReactCurrentBatchConfig,ne=0,ye=null,Se=null,Te=0,ke=0,De=da(0),Me=0,Pe=null,Oe=0,Ne=0,ht=0,rt=null,Tt=null,It=0,Ht=1/0,Qe=null,dt=!1,Je=null,Dt=null,mt=!1,Ot=null,Mt=0,Nt=0,Vt=null,pn=-1,bn=0;function rn(){return(ne&6)!==0?vr():pn!==-1?pn:pn=vr()}function vn(g){return(g.mode&1)===0?1:(ne&2)!==0&&Te!==0?Te&-Te:iy.transition!==null?(bn===0&&(bn=Of()),bn):(g=wi,g!==0||(g=window.event,g=g===void 0?16:Nf(g.type)),g)}function dn(g,b,M,B){if(50<Nt)throw Nt=0,Vt=null,Error(o(185));Ho(g,M,B),((ne&2)===0||g!==ye)&&(g===ye&&((ne&2)===0&&(Ne|=M),Me===4&&tr(g,Te)),Rn(g,B),M===1&&ne===0&&(b.mode&1)===0&&(Ht=vr()+500,Kh&&vc()))}function Rn(g,b){var M=g.callbackNode;tm(g,b);var B=bl(g,g===ye?Te:0);if(B===0)M!==null&&gr(M),g.callbackNode=null,g.callbackPriority=0;else if(b=B&-B,g.callbackPriority!==b){if(M!=null&&gr(M),b===1)g.tag===0?ry(Hi.bind(null,g)):Eg(Hi.bind(null,g)),mm(function(){(ne&6)===0&&vc()}),M=null;else{switch(aa(B)){case 1:M=Qi;break;case 4:M=bs;break;case 16:M=Es;break;case 536870912:M=vl;break;default:M=Es}M=Jo(M,Hn.bind(null,g))}g.callbackPriority=b,g.callbackNode=M}}function Hn(g,b){if(pn=-1,bn=0,(ne&6)!==0)throw Error(o(327));var M=g.callbackNode;if(hi()&&g.callbackNode!==M)return null;var B=bl(g,g===ye?Te:0);if(B===0)return null;if((B&30)!==0||(B&g.expiredLanes)!==0||b)b=ns(g,B);else{b=B;var Y=ne;ne|=2;var se=ys();(ye!==g||Te!==b)&&(Qe=null,Ht=vr()+500,Tr(g,b));do try{nr();break}catch(it){si(g,it)}while(!0);ef(),re.current=se,ne=Y,Se!==null?b=0:(ye=null,Te=0,b=Me)}if(b!==0){if(b===2&&(Y=sa(g),Y!==0&&(B=Y,b=dr(g,Y))),b===1)throw M=Pe,Tr(g,0),tr(g,B),Rn(g,vr()),M;if(b===6)tr(g,B);else{if(Y=g.current.alternate,(B&30)===0&&!ii(Y)&&(b=ns(g,B),b===2&&(se=sa(g),se!==0&&(B=se,b=dr(g,se))),b===1))throw M=Pe,Tr(g,0),tr(g,B),Rn(g,vr()),M;switch(g.finishedWork=Y,g.finishedLanes=B,b){case 0:case 1:throw Error(o(345));case 2:ai(g,Tt,Qe);break;case 3:if(tr(g,B),(B&130023424)===B&&(b=It+500-vr(),10<b)){if(bl(g,0)!==0)break;if(Y=g.suspendedLanes,(Y&B)!==B){rn(),g.pingedLanes|=g.suspendedLanes&Y;break}g.timeoutHandle=Bd(ai.bind(null,g,Tt,Qe),b);break}ai(g,Tt,Qe);break;case 4:if(tr(g,B),(B&4194240)===B)break;for(b=g.eventTimes,Y=-1;0<B;){var Re=31-os(B);se=1<<Re,Re=b[Re],Re>Y&&(Y=Re),B&=~se}if(B=Y,B=vr()-B,B=(120>B?120:480>B?480:1080>B?1080:1920>B?1920:3e3>B?3e3:4320>B?4320:1960*q(B/1960))-B,10<B){g.timeoutHandle=Bd(ai.bind(null,g,Tt,Qe),B);break}ai(g,Tt,Qe);break;case 5:ai(g,Tt,Qe);break;default:throw Error(o(329))}}}return Rn(g,vr()),g.callbackNode===M?Hn.bind(null,g):null}function dr(g,b){var M=rt;return g.current.memoizedState.isDehydrated&&(Tr(g,b).flags|=256),g=ns(g,b),g!==2&&(b=Tt,Tt=M,b!==null&&ri(b)),g}function ri(g){Tt===null?Tt=g:Tt.push.apply(Tt,g)}function ii(g){for(var b=g;;){if(b.flags&16384){var M=b.updateQueue;if(M!==null&&(M=M.stores,M!==null))for(var B=0;B<M.length;B++){var Y=M[B],se=Y.getSnapshot;Y=Y.value;try{if(!Pa(se(),Y))return!1}catch{return!1}}}if(M=b.child,b.subtreeFlags&16384&&M!==null)M.return=b,b=M;else{if(b===g)break;for(;b.sibling===null;){if(b.return===null||b.return===g)return!0;b=b.return}b.sibling.return=b.return,b=b.sibling}}return!0}function tr(g,b){for(b&=~ht,b&=~Ne,g.suspendedLanes|=b,g.pingedLanes&=~b,g=g.expirationTimes;0<b;){var M=31-os(b),B=1<<M;g[M]=-1,b&=~B}}function Hi(g){if((ne&6)!==0)throw Error(o(327));hi();var b=bl(g,0);if((b&1)===0)return Rn(g,vr()),null;var M=ns(g,b);if(g.tag!==0&&M===2){var B=sa(g);B!==0&&(b=B,M=dr(g,B))}if(M===1)throw M=Pe,Tr(g,0),tr(g,b),Rn(g,vr()),M;if(M===6)throw Error(o(345));return g.finishedWork=g.current.alternate,g.finishedLanes=b,ai(g,Tt,Qe),Rn(g,vr()),null}function Pi(g,b){var M=ne;ne|=1;try{return g(b)}finally{ne=M,ne===0&&(Ht=vr()+500,Kh&&vc())}}function Gn(g){Ot!==null&&Ot.tag===0&&(ne&6)===0&&hi();var b=ne;ne|=1;var M=oe.transition,B=wi;try{if(oe.transition=null,wi=1,g)return g()}finally{wi=B,oe.transition=M,ne=b,(ne&6)===0&&vc()}}function Cr(){ke=De.current,es(De)}function Tr(g,b){g.finishedWork=null,g.finishedLanes=0;var M=g.timeoutHandle;if(M!==-1&&(g.timeoutHandle=-1,fm(M)),Se!==null)for(M=Se.return;M!==null;){var B=M;switch(Zf(B),B.tag){case 1:B=B.type.childContextTypes,B!=null&&$d();break;case 3:Da(),es(To),es(Ws),ni();break;case 5:Yd(B);break;case 4:Da();break;case 13:es(as);break;case 19:es(as);break;case 10:nu(B.type._context);break;case 22:case 23:Cr()}M=M.return}if(ye=g,Se=g=va(g.current,null),Te=ke=b,Me=0,Pe=null,ht=Ne=Oe=0,Tt=rt=null,ma!==null){for(b=0;b<ma.length;b++)if(M=ma[b],B=M.interleaved,B!==null){M.interleaved=null;var Y=B.next,se=M.pending;if(se!==null){var Re=se.next;se.next=Y,B.next=Re}M.pending=B}ma=null}return g}function si(g,b){do{var M=Se;try{if(ef(),ru.current=nd,Sc){for(var B=Ps.memoizedState;B!==null;){var Y=B.queue;Y!==null&&(Y.pending=null),B=B.next}Sc=!1}if(iu=0,fo=Zs=Ps=null,il=!1,Xt=0,te.current=null,M===null||M.return===null){Me=1,Pe=b,Se=null;break}e:{var se=g,Re=M.return,it=M,xt=b;if(b=Te,it.flags|=32768,xt!==null&&typeof xt=="object"&&typeof xt.then=="function"){var Yt=xt,Mn=it,Dn=Mn.tag;if((Mn.mode&1)===0&&(Dn===0||Dn===11||Dn===15)){var In=Mn.alternate;In?(Mn.updateQueue=In.updateQueue,Mn.memoizedState=In.memoizedState,Mn.lanes=In.lanes):(Mn.updateQueue=null,Mn.memoizedState=null)}var Kn=lu(Re);if(Kn!==null){Kn.flags&=-257,op(Kn,Re,it,se,b),Kn.mode&1&&ff(se,Yt,b),b=Kn,xt=Yt;var hr=b.updateQueue;if(hr===null){var _r=new Set;_r.add(xt),b.updateQueue=_r}else hr.add(xt);break e}else{if((b&1)===0){ff(se,Yt,b),Gi();break e}xt=Error(o(426))}}else if(hs&&it.mode&1){var Ys=lu(Re);if(Ys!==null){(Ys.flags&65536)===0&&(Ys.flags|=256),op(Ys,Re,it,se,b),nl(gs(xt,it));break e}}se=xt=gs(xt,it),Me!==4&&(Me=2),rt===null?rt=[se]:rt.push(se),se=Re;do{switch(se.tag){case 3:se.flags|=65536,b&=-b,se.lanes|=b;var Ut=sh(se,xt,b);xm(se,Ut);break e;case 1:it=xt;var Pt=se.type,$t=se.stateNode;if((se.flags&128)===0&&(typeof Pt.getDerivedStateFromError=="function"||$t!==null&&typeof $t.componentDidCatch=="function"&&(Dt===null||!Dt.has($t)))){se.flags|=65536,b&=-b,se.lanes|=b;var Tn=sp(se,it,b);xm(se,Tn);break e}}se=se.return}while(se!==null)}zr(M)}catch(wr){b=wr,Se===M&&M!==null&&(Se=M=M.return);continue}break}while(!0)}function ys(){var g=re.current;return re.current=nd,g===null?nd:g}function Gi(){(Me===0||Me===3||Me===2)&&(Me=4),ye===null||(Oe&268435455)===0&&(Ne&268435455)===0||tr(ye,Te)}function ns(g,b){var M=ne;ne|=2;var B=ys();(ye!==g||Te!==b)&&(Qe=null,Tr(g,b));do try{Oi();break}catch(Y){si(g,Y)}while(!0);if(ef(),ne=M,re.current=B,Se!==null)throw Error(o(261));return ye=null,Te=0,Me}function Oi(){for(;Se!==null;)Si(Se)}function nr(){for(;Se!==null&&!gi();)Si(Se)}function Si(g){var b=Wl(g.alternate,g,ke);g.memoizedProps=g.pendingProps,b===null?zr(g):Se=b,te.current=null}function zr(g){var b=g;do{var M=b.alternate;if(g=b.return,(b.flags&32768)===0){if(M=_s(M,b,ke),M!==null){Se=M;return}}else{if(M=al(M,b),M!==null){M.flags&=32767,Se=M;return}if(g!==null)g.flags|=32768,g.subtreeFlags=0,g.deletions=null;else{Me=6,Se=null;return}}if(b=b.sibling,b!==null){Se=b;return}Se=b=g}while(b!==null);Me===0&&(Me=5)}function ai(g,b,M){var B=wi,Y=oe.transition;try{oe.transition=null,wi=1,Xr(g,b,M,B)}finally{oe.transition=Y,wi=B}return null}function Xr(g,b,M,B){do hi();while(Ot!==null);if((ne&6)!==0)throw Error(o(327));M=g.finishedWork;var Y=g.finishedLanes;if(M===null)return null;if(g.finishedWork=null,g.finishedLanes=0,M===g.current)throw Error(o(177));g.callbackNode=null,g.callbackPriority=0;var se=M.lanes|M.childLanes;if(sc(g,se),g===ye&&(Se=ye=null,Te=0),(M.subtreeFlags&2064)===0&&(M.flags&2064)===0||mt||(mt=!0,Jo(Es,function(){return hi(),null})),se=(M.flags&15990)!==0,(M.subtreeFlags&15990)!==0||se){se=oe.transition,oe.transition=null;var Re=wi;wi=1;var it=ne;ne|=4,te.current=null,ka(g,M),C(M,g),Ra(jd),Bc=!!Nd,jd=Nd=null,g.current=M,L(M),Hr(),ne=it,wi=Re,oe.transition=se}else g.current=M;if(mt&&(mt=!1,Ot=g,Mt=Y),se=g.pendingLanes,se===0&&(Dt=null),Hs(M.stateNode),Rn(g,vr()),b!==null)for(B=g.onRecoverableError,M=0;M<b.length;M++)Y=b[M],B(Y.value,{componentStack:Y.stack,digest:Y.digest});if(dt)throw dt=!1,g=Je,Je=null,g;return(Mt&1)!==0&&g.tag!==0&&hi(),se=g.pendingLanes,(se&1)!==0?g===Vt?Nt++:(Nt=0,Vt=g):Nt=0,vc(),null}function hi(){if(Ot!==null){var g=aa(Mt),b=oe.transition,M=wi;try{if(oe.transition=null,wi=16>g?16:g,Ot===null)var B=!1;else{if(g=Ot,Ot=null,Mt=0,(ne&6)!==0)throw Error(o(331));var Y=ne;for(ne|=4,er=g.current;er!==null;){var se=er,Re=se.child;if((er.flags&16)!==0){var it=se.deletions;if(it!==null){for(var xt=0;xt<it.length;xt++){var Yt=it[xt];for(er=Yt;er!==null;){var Mn=er;switch(Mn.tag){case 0:case 11:case 15:Tc(8,Mn,se)}var Dn=Mn.child;if(Dn!==null)Dn.return=Mn,er=Dn;else for(;er!==null;){Mn=er;var In=Mn.sibling,Kn=Mn.return;if(Hl(Mn),Mn===Yt){er=null;break}if(In!==null){In.return=Kn,er=In;break}er=Kn}}}var hr=se.alternate;if(hr!==null){var _r=hr.child;if(_r!==null){hr.child=null;do{var Ys=_r.sibling;_r.sibling=null,_r=Ys}while(_r!==null)}}er=se}}if((se.subtreeFlags&2064)!==0&&Re!==null)Re.return=se,er=Re;else e:for(;er!==null;){if(se=er,(se.flags&2048)!==0)switch(se.tag){case 0:case 11:case 15:Tc(9,se,se.return)}var Ut=se.sibling;if(Ut!==null){Ut.return=se.return,er=Ut;break e}er=se.return}}var Pt=g.current;for(er=Pt;er!==null;){Re=er;var $t=Re.child;if((Re.subtreeFlags&2064)!==0&&$t!==null)$t.return=Re,er=$t;else e:for(Re=Pt;er!==null;){if(it=er,(it.flags&2048)!==0)try{switch(it.tag){case 0:case 11:case 15:uu(9,it)}}catch(wr){br(it,it.return,wr)}if(it===Re){er=null;break e}var Tn=it.sibling;if(Tn!==null){Tn.return=it.return,er=Tn;break e}er=it.return}}if(ne=Y,vc(),ms&&typeof ms.onPostCommitFiberRoot=="function")try{ms.onPostCommitFiberRoot($s,g)}catch{}B=!0}return B}finally{wi=M,oe.transition=b}}return!1}function Fs(g,b,M){b=gs(M,b),b=sh(g,b,1),g=wc(g,b,1),b=rn(),g!==null&&(Ho(g,1,b),Rn(g,b))}function br(g,b,M){if(g.tag===3)Fs(g,g,M);else for(;b!==null;){if(b.tag===3){Fs(b,g,M);break}else if(b.tag===1){var B=b.stateNode;if(typeof b.type.getDerivedStateFromError=="function"||typeof B.componentDidCatch=="function"&&(Dt===null||!Dt.has(B))){g=gs(M,g),g=sp(b,g,1),b=wc(b,g,1),g=rn(),b!==null&&(Ho(b,1,g),Rn(b,g));break}}b=b.return}}function Ks(g,b,M){var B=g.pingCache;B!==null&&B.delete(b),b=rn(),g.pingedLanes|=g.suspendedLanes&M,ye===g&&(Te&M)===M&&(Me===4||Me===3&&(Te&130023424)===Te&&500>vr()-It?Tr(g,0):ht|=M),Rn(g,b)}function ls(g,b){b===0&&((g.mode&1)===0?b=1:(b=Iu,Iu<<=1,(Iu&130023424)===0&&(Iu=4194304)));var M=rn();g=Ln(g,b),g!==null&&(Ho(g,b,M),Rn(g,M))}function oo(g){var b=g.memoizedState,M=0;b!==null&&(M=b.retryLane),ls(g,M)}function ll(g,b){var M=0;switch(g.tag){case 13:var B=g.stateNode,Y=g.memoizedState;Y!==null&&(M=Y.retryLane);break;case 19:B=g.stateNode;break;default:throw Error(o(314))}B!==null&&B.delete(b),ls(g,M)}var Wl;Wl=function(g,b,M){if(g!==null)if(g.memoizedProps!==b.pendingProps||To.current)no=!0;else{if((g.lanes&M)===0&&(b.flags&128)===0)return no=!1,oy(g,b,M);no=(g.flags&131072)!==0}else no=!1,hs&&(b.flags&1048576)!==0&&Yh(b,Wd,b.index);switch(b.lanes=0,b.tag){case 2:var B=b.type;pp(g,b),g=b.pendingProps;var Y=_c(b,Ws.current);un(b,M),Y=ut(null,b,B,g,Y,M);var se=_a();return b.flags|=1,typeof Y=="object"&&Y!==null&&typeof Y.render=="function"&&Y.$$typeof===void 0?(b.tag=1,b.memoizedState=null,b.updateQueue=null,Eo(B)?(se=!0,Hu(b)):se=!1,b.memoizedState=Y.state!==null&&Y.state!==void 0?Y.state:null,ym(b),Y.updater=ol,b.stateNode=Y,Y._reactInternals=b,uf(b,B,g,M),b=cp(null,b,B,!0,se,M)):(b.tag=0,hs&&se&&kl(b),ro(null,b,Y,M),b=b.child),b;case 16:B=b.elementType;e:{switch(pp(g,b),g=b.pendingProps,Y=B._init,B=Y(B._payload),b.type=B,Y=b.tag=cl(B),g=Xs(B,g),Y){case 0:b=lp(null,b,B,g,M);break e;case 1:b=Em(null,b,B,g,M);break e;case 11:b=ap(null,b,B,g,M);break e;case 14:b=mf(null,b,B,Xs(B.type,g),M);break e}throw Error(o(306,B,""))}return b;case 0:return B=b.type,Y=b.pendingProps,Y=b.elementType===B?Y:Xs(B,Y),lp(g,b,B,Y,M);case 1:return B=b.type,Y=b.pendingProps,Y=b.elementType===B?Y:Xs(B,Y),Em(g,b,B,Y,M);case 3:e:{if(up(b),g===null)throw Error(o(387));B=b.pendingProps,se=b.memoizedState,Y=se.element,vm(g,b),Jf(b,B,null,M);var Re=b.memoizedState;if(B=Re.element,se.isDehydrated)if(se={element:B,isDehydrated:!1,cache:Re.cache,pendingSuspenseBoundaries:Re.pendingSuspenseBoundaries,transitions:Re.transitions},b.updateQueue.baseState=se,b.memoizedState=se,b.flags&256){Y=gs(Error(o(423)),b),b=Im(g,b,B,M,Y);break e}else if(B!==Y){Y=gs(Error(o(424)),b),b=Im(g,b,B,M,Y);break e}else for(Xo=pc(b.stateNode.containerInfo.firstChild),Ss=b,hs=!0,Ma=null,M=Xd(b,null,B,M),b.child=M;M;)M.flags=M.flags&-3|4096,M=M.sibling;else{if(Zd(),B===Y){b=ta(g,b,M);break e}ro(g,b,B,M)}b=b.child}return b;case 5:return tf(b),g===null&&Kf(b),B=b.type,Y=b.pendingProps,se=g!==null?g.memoizedProps:null,Re=Y.children,Yc(B,Y)?Re=null:se!==null&&Yc(B,se)&&(b.flags|=32),Tm(g,b),ro(g,b,Re,M),b.child;case 6:return g===null&&Kf(b),null;case 13:return Pm(g,b,M);case 4:return Nl(b,b.stateNode.containerInfo),B=b.pendingProps,g===null?b.child=rl(b,null,B,M):ro(g,b,B,M),b.child;case 11:return B=b.type,Y=b.pendingProps,Y=b.elementType===B?Y:Xs(B,Y),ap(g,b,B,Y,M);case 7:return ro(g,b,b.pendingProps,M),b.child;case 8:return ro(g,b,b.pendingProps.children,M),b.child;case 12:return ro(g,b,b.pendingProps.children,M),b.child;case 10:e:{if(B=b.type._context,Y=b.pendingProps,se=b.memoizedProps,Re=Y.value,ds(eu,B._currentValue),B._currentValue=Re,se!==null)if(Pa(se.value,Re)){if(se.children===Y.children&&!To.current){b=ta(g,b,M);break e}}else for(se=b.child,se!==null&&(se.return=b);se!==null;){var it=se.dependencies;if(it!==null){Re=se.child;for(var xt=it.firstContext;xt!==null;){if(xt.context===B){if(se.tag===1){xt=ga(-1,M&-M),xt.tag=2;var Yt=se.updateQueue;if(Yt!==null){Yt=Yt.shared;var Mn=Yt.pending;Mn===null?xt.next=xt:(xt.next=Mn.next,Mn.next=xt),Yt.pending=xt}}se.lanes|=M,xt=se.alternate,xt!==null&&(xt.lanes|=M),Ku(se.return,M,b),it.lanes|=M;break}xt=xt.next}}else if(se.tag===10)Re=se.type===b.type?null:se.child;else if(se.tag===18){if(Re=se.return,Re===null)throw Error(o(341));Re.lanes|=M,it=Re.alternate,it!==null&&(it.lanes|=M),Ku(Re,M,b),Re=se.sibling}else Re=se.child;if(Re!==null)Re.return=se;else for(Re=se;Re!==null;){if(Re===b){Re=null;break}if(se=Re.sibling,se!==null){se.return=Re.return,Re=se;break}Re=Re.return}se=Re}ro(g,b,Y.children,M),b=b.child}return b;case 9:return Y=b.type,B=b.pendingProps.children,un(b,M),Y=jo(Y),B=B(Y),b.flags|=1,ro(g,b,B,M),b.child;case 14:return B=b.type,Y=Xs(B,b.pendingProps),Y=Xs(B.type,Y),mf(g,b,B,Y,M);case 15:return Cm(g,b,b.type,b.pendingProps,M);case 17:return B=b.type,Y=b.pendingProps,Y=b.elementType===B?Y:Xs(B,Y),pp(g,b),b.tag=1,Eo(B)?(g=!0,Hu(b)):g=!1,un(b,M),cf(b,B,Y),uf(b,B,Y,M),cp(null,b,B,!0,g,M);case 19:return Am(g,b,M);case 22:return gf(g,b,M)}throw Error(o(156,b.tag))};function Jo(g,b){return Vi(g,b)}function Fa(g,b,M,B){this.tag=g,this.key=M,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=b,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=B,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bs(g,b,M,B){return new Fa(g,b,M,B)}function Na(g){return g=g.prototype,!(!g||!g.isReactComponent)}function cl(g){if(typeof g=="function")return Na(g)?1:0;if(g!=null){if(g=g.$$typeof,g===lt)return 11;if(g===Ge)return 14}return 2}function va(g,b){var M=g.alternate;return M===null?(M=Bs(g.tag,b,g.key,g.mode),M.elementType=g.elementType,M.type=g.type,M.stateNode=g.stateNode,M.alternate=g,g.alternate=M):(M.pendingProps=b,M.type=g.type,M.flags=0,M.subtreeFlags=0,M.deletions=null),M.flags=g.flags&14680064,M.childLanes=g.childLanes,M.lanes=g.lanes,M.child=g.child,M.memoizedProps=g.memoizedProps,M.memoizedState=g.memoizedState,M.updateQueue=g.updateQueue,b=g.dependencies,M.dependencies=b===null?null:{lanes:b.lanes,firstContext:b.firstContext},M.sibling=g.sibling,M.index=g.index,M.ref=g.ref,M}function ql(g,b,M,B,Y,se){var Re=2;if(B=g,typeof g=="function")Na(g)&&(Re=1);else if(typeof g=="string")Re=5;else e:switch(g){case fe:return Zl(M.children,Y,se,b);case _e:Re=8,Y|=8;break;case Ce:return g=Bs(12,M,b,Y|2),g.elementType=Ce,g.lanes=se,g;case _t:return g=Bs(13,M,b,Y),g.elementType=_t,g.lanes=se,g;case Ue:return g=Bs(19,M,b,Y),g.elementType=Ue,g.lanes=se,g;case yt:return sd(M,Y,se,b);default:if(typeof g=="object"&&g!==null)switch(g.$$typeof){case je:Re=10;break e;case He:Re=9;break e;case lt:Re=11;break e;case Ge:Re=14;break e;case at:Re=16,B=null;break e}throw Error(o(130,g==null?g:typeof g,""))}return b=Bs(Re,M,b,Y),b.elementType=g,b.type=B,b.lanes=se,b}function Zl(g,b,M,B){return g=Bs(7,g,B,b),g.lanes=M,g}function sd(g,b,M,B){return g=Bs(22,g,B,b),g.elementType=yt,g.lanes=M,g.stateNode={isHidden:!1},g}function ah(g,b,M){return g=Bs(6,g,null,b),g.lanes=M,g}function od(g,b,M){return b=Bs(4,g.children!==null?g.children:[],g.key,b),b.lanes=M,b.stateNode={containerInfo:g.containerInfo,pendingChildren:null,implementation:g.implementation},b}function Ai(g,b,M,B,Y){this.tag=b,this.containerInfo=g,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Do(0),this.expirationTimes=Do(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Do(0),this.identifierPrefix=B,this.onRecoverableError=Y,this.mutableSourceEagerHydrationData=null}function hu(g,b,M,B,Y,se,Re,it,xt){return g=new Ai(g,b,M,it,xt),b===1?(b=1,se===!0&&(b|=8)):b=0,se=Bs(3,null,null,b),g.current=se,se.stateNode=g,se.memoizedState={element:B,isDehydrated:M,cache:null,transitions:null,pendingSuspenseBoundaries:null},ym(se),g}function Rm(g,b,M){var B=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:xe,key:B==null?null:""+B,children:g,containerInfo:b,implementation:M}}function ay(g){if(!g)return Os;g=g._reactInternals;e:{if(ln(g)!==g||g.tag!==1)throw Error(o(170));var b=g;do{switch(b.tag){case 3:b=b.stateNode.context;break e;case 1:if(Eo(b.type)){b=b.stateNode.__reactInternalMemoizedMergedChildContext;break e}}b=b.return}while(b!==null);throw Error(o(171))}if(g.tag===1){var M=g.type;if(Eo(M))return Wf(g,M,b)}return b}function ix(g,b,M,B,Y,se,Re,it,xt){return g=hu(M,B,!0,g,Y,se,Re,it,xt),g.context=ay(null),M=g.current,B=rn(),Y=vn(M),se=ga(B,Y),se.callback=b??null,wc(M,se,Y),g.current.lanes=Y,Ho(g,Y,B),Rn(g,B),g}function yp(g,b,M,B){var Y=b.current,se=rn(),Re=vn(Y);return M=ay(M),b.context===null?b.context=M:b.pendingContext=M,b=ga(se,Re),b.payload={element:g},B=B===void 0?null:B,B!==null&&(b.callback=B),g=wc(Y,b,Re),g!==null&&(dn(g,Y,Re,se),Yf(g,Y,Re)),Re}function ul(g){if(g=g.current,!g.child)return null;switch(g.child.tag){case 5:return g.child.stateNode;default:return g.child.stateNode}}function fu(g,b){if(g=g.memoizedState,g!==null&&g.dehydrated!==null){var M=g.retryLane;g.retryLane=M!==0&&M<b?M:b}}function Dg(g,b){fu(g,b),(g=g.alternate)&&fu(g,b)}function sx(){return null}var Mm=typeof reportError=="function"?reportError:function(g){console.error(g)};function Lm(g){this._internalRoot=g}lh.prototype.render=Lm.prototype.render=function(g){var b=this._internalRoot;if(b===null)throw Error(o(409));yp(g,b,null,null)},lh.prototype.unmount=Lm.prototype.unmount=function(){var g=this._internalRoot;if(g!==null){this._internalRoot=null;var b=g.containerInfo;Gn(function(){yp(null,g,null,null)}),b[mc]=null}};function lh(g){this._internalRoot=g}lh.prototype.unstable_scheduleHydration=function(g){if(g){var b=vd();g={blockedOn:null,target:g,priority:b};for(var M=0;M<Ja.length&&b!==0&&b<Ja[M].priority;M++);Ja.splice(M,0,g),M===0&&nm(g)}};function vp(g){return!(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)}function Dm(g){return!(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11&&(g.nodeType!==8||g.nodeValue!==" react-mount-point-unstable "))}function km(){}function ly(g,b,M,B,Y){if(Y){if(typeof B=="function"){var se=B;B=function(){var Yt=ul(Re);se.call(Yt)}}var Re=ix(b,B,g,0,null,!1,!1,"",km);return g._reactRootContainer=Re,g[mc]=Re.current,Gh(g.nodeType===8?g.parentNode:g),Gn(),Re}for(;Y=g.lastChild;)g.removeChild(Y);if(typeof B=="function"){var it=B;B=function(){var Yt=ul(xt);it.call(Yt)}}var xt=hu(g,0,!1,null,null,!1,!1,"",km);return g._reactRootContainer=xt,g[mc]=xt.current,Gh(g.nodeType===8?g.parentNode:g),Gn(function(){yp(b,xt,M,B)}),xt}function xp(g,b,M,B,Y){var se=M._reactRootContainer;if(se){var Re=se;if(typeof Y=="function"){var it=Y;Y=function(){var xt=ul(Re);it.call(xt)}}yp(b,Re,g,Y)}else Re=ly(M,b,g,Y,B);return ul(Re)}yd=function(g){switch(g.tag){case 3:var b=g.stateNode;if(b.current.memoizedState.isDehydrated){var M=ic(b.pendingLanes);M!==0&&(oa(b,M|1),Rn(b,vr()),(ne&6)===0&&(Ht=vr()+500,vc()))}break;case 13:Gn(function(){var B=Ln(g,1);if(B!==null){var Y=rn();dn(B,g,1,Y)}}),Dg(g,1)}},Lh=function(g){if(g.tag===13){var b=Ln(g,134217728);if(b!==null){var M=rn();dn(b,g,134217728,M)}Dg(g,134217728)}},wl=function(g){if(g.tag===13){var b=vn(g),M=Ln(g,b);if(M!==null){var B=rn();dn(M,g,b,B)}Dg(g,b)}},vd=function(){return wi},zf=function(g,b){var M=wi;try{return wi=g,b()}finally{wi=M}},Nc=function(g,b,M){switch(b){case"input":if(Gr(g,M),b=M.name,M.type==="radio"&&b!=null){for(M=g;M.parentNode;)M=M.parentNode;for(M=M.querySelectorAll("input[name="+JSON.stringify(""+b)+'][type="radio"]'),b=0;b<M.length;b++){var B=M[b];if(B!==g&&B.form===g.form){var Y=Ud(B);if(!Y)throw Error(o(90));Vn(B),Gr(B,Y)}}}break;case"textarea":Dr(g,M);break;case"select":b=M.value,b!=null&&Or(g,!!M.multiple,b,!1)}},yl=Pi,Ah=Gn;var ox={usingClientEntryPoint:!1,Events:[$u,Jc,Ud,_d,Qt,Pi]},bp={findFiberByHostInstance:gc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ch={bundleType:bp.bundleType,version:bp.version,rendererPackageName:bp.rendererPackageName,rendererConfig:bp.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:pe.ReactCurrentDispatcher,findHostInstanceByFiber:function(g){return g=rr(g),g===null?null:g.stateNode},findFiberByHostInstance:bp.findFiberByHostInstance||sx,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Om=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Om.isDisabled&&Om.supportsFiber)try{$s=Om.inject(ch),ms=Om}catch{}}return Yl.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ox,Yl.createPortal=function(g,b){var M=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!vp(b))throw Error(o(200));return Rm(g,b,null,M)},Yl.createRoot=function(g,b){if(!vp(g))throw Error(o(299));var M=!1,B="",Y=Mm;return b!=null&&(b.unstable_strictMode===!0&&(M=!0),b.identifierPrefix!==void 0&&(B=b.identifierPrefix),b.onRecoverableError!==void 0&&(Y=b.onRecoverableError)),b=hu(g,1,!1,null,null,M,!1,B,Y),g[mc]=b.current,Gh(g.nodeType===8?g.parentNode:g),new Lm(b)},Yl.findDOMNode=function(g){if(g==null)return null;if(g.nodeType===1)return g;var b=g._reactInternals;if(b===void 0)throw typeof g.render=="function"?Error(o(188)):(g=Object.keys(g).join(","),Error(o(268,g)));return g=rr(b),g=g===null?null:g.stateNode,g},Yl.flushSync=function(g){return Gn(g)},Yl.hydrate=function(g,b,M){if(!Dm(b))throw Error(o(200));return xp(null,g,b,!0,M)},Yl.hydrateRoot=function(g,b,M){if(!vp(g))throw Error(o(405));var B=M!=null&&M.hydratedSources||null,Y=!1,se="",Re=Mm;if(M!=null&&(M.unstable_strictMode===!0&&(Y=!0),M.identifierPrefix!==void 0&&(se=M.identifierPrefix),M.onRecoverableError!==void 0&&(Re=M.onRecoverableError)),b=ix(b,null,g,1,M??null,Y,!1,se,Re),g[mc]=b.current,Gh(g),B)for(g=0;g<B.length;g++)M=B[g],Y=M._getVersion,Y=Y(M._source),b.mutableSourceEagerHydrationData==null?b.mutableSourceEagerHydrationData=[M,Y]:b.mutableSourceEagerHydrationData.push(M,Y);return new lh(b)},Yl.render=function(g,b,M){if(!Dm(b))throw Error(o(200));return xp(null,g,b,!1,M)},Yl.unmountComponentAtNode=function(g){if(!Dm(g))throw Error(o(40));return g._reactRootContainer?(Gn(function(){xp(null,null,g,!1,function(){g._reactRootContainer=null,g[mc]=null})}),!0):!1},Yl.unstable_batchedUpdates=Pi,Yl.unstable_renderSubtreeIntoContainer=function(g,b,M,B){if(!Dm(M))throw Error(o(200));if(g==null||g._reactInternals===void 0)throw Error(o(38));return xp(g,b,M,!1,B)},Yl.version="18.3.1-next-f1338f8080-20240426",Yl}var fA;function tD(){if(fA)return Iw.exports;fA=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}return e(),Iw.exports=WB(),Iw.exports}var pA;function qB(){if(pA)return Qx;pA=1;var e=tD();return Qx.createRoot=e.createRoot,Qx.hydrateRoot=e.hydrateRoot,Qx}var ZB=qB(),BS=tD();const l_=mg(BS);/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function yv(){return yv=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(e[c]=o[c])}return e},yv.apply(this,arguments)}var Np;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Np||(Np={}));const mA="popstate";function XB(e){e===void 0&&(e={});function n(c,d){let{pathname:y,search:x,hash:i}=c.location;return M2("",{pathname:y,search:x,hash:i},d.state&&d.state.usr||null,d.state&&d.state.key||"default")}function o(c,d){return typeof d=="string"?d:M0(d)}return YB(n,o,null,e)}function Ao(e,n){if(e===!1||e===null||typeof e>"u")throw new Error(n)}function nD(e,n){if(!e){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function KB(){return Math.random().toString(36).substr(2,8)}function gA(e,n){return{usr:e.state,key:e.key,idx:n}}function M2(e,n,o,c){return o===void 0&&(o=null),yv({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof n=="string"?M_(n):n,{state:o,key:n&&n.key||c||KB()})}function M0(e){let{pathname:n="/",search:o="",hash:c=""}=e;return o&&o!=="?"&&(n+=o.charAt(0)==="?"?o:"?"+o),c&&c!=="#"&&(n+=c.charAt(0)==="#"?c:"#"+c),n}function M_(e){let n={};if(e){let o=e.indexOf("#");o>=0&&(n.hash=e.substr(o),e=e.substr(0,o));let c=e.indexOf("?");c>=0&&(n.search=e.substr(c),e=e.substr(0,c)),e&&(n.pathname=e)}return n}function YB(e,n,o,c){c===void 0&&(c={});let{window:d=document.defaultView,v5Compat:y=!1}=c,x=d.history,i=Np.Pop,I=null,R=k();R==null&&(R=0,x.replaceState(yv({},x.state,{idx:R}),""));function k(){return(x.state||{idx:null}).idx}function N(){i=Np.Pop;let J=k(),le=J==null?null:J-R;R=J,I&&I({action:i,location:Z.location,delta:le})}function U(J,le){i=Np.Push;let de=M2(Z.location,J,le);R=k()+1;let ue=gA(de,R),pe=Z.createHref(de);try{x.pushState(ue,"",pe)}catch(he){if(he instanceof DOMException&&he.name==="DataCloneError")throw he;d.location.assign(pe)}y&&I&&I({action:i,location:Z.location,delta:1})}function K(J,le){i=Np.Replace;let de=M2(Z.location,J,le);R=k();let ue=gA(de,R),pe=Z.createHref(de);x.replaceState(ue,"",pe),y&&I&&I({action:i,location:Z.location,delta:0})}function X(J){let le=d.location.origin!=="null"?d.location.origin:d.location.href,de=typeof J=="string"?J:M0(J);return de=de.replace(/ $/,"%20"),Ao(le,"No window.location.(origin|href) available to create URL for href: "+de),new URL(de,le)}let Z={get action(){return i},get location(){return e(d,x)},listen(J){if(I)throw new Error("A history only accepts one active listener");return d.addEventListener(mA,N),I=J,()=>{d.removeEventListener(mA,N),I=null}},createHref(J){return n(d,J)},createURL:X,encodeLocation(J){let le=X(J);return{pathname:le.pathname,search:le.search,hash:le.hash}},push:U,replace:K,go(J){return x.go(J)}};return Z}var _A;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(_A||(_A={}));function JB(e,n,o){return o===void 0&&(o="/"),QB(e,n,o)}function QB(e,n,o,c){let d=typeof n=="string"?M_(n):n,y=VS(d.pathname||"/",o);if(y==null)return null;let x=rD(e);e6(x);let i=null;for(let I=0;i==null&&I<x.length;++I){let R=h6(y);i=c6(x[I],R)}return i}function rD(e,n,o,c){n===void 0&&(n=[]),o===void 0&&(o=[]),c===void 0&&(c="");let d=(y,x,i)=>{let I={relativePath:i===void 0?y.path||"":i,caseSensitive:y.caseSensitive===!0,childrenIndex:x,route:y};I.relativePath.startsWith("/")&&(Ao(I.relativePath.startsWith(c),'Absolute route path "'+I.relativePath+'" nested under path '+('"'+c+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),I.relativePath=I.relativePath.slice(c.length));let R=Bp([c,I.relativePath]),k=o.concat(I);y.children&&y.children.length>0&&(Ao(y.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+R+'".')),rD(y.children,n,k,R)),!(y.path==null&&!y.index)&&n.push({path:R,score:a6(R,y.index),routesMeta:k})};return e.forEach((y,x)=>{var i;if(y.path===""||!((i=y.path)!=null&&i.includes("?")))d(y,x);else for(let I of iD(y.path))d(y,x,I)}),n}function iD(e){let n=e.split("/");if(n.length===0)return[];let[o,...c]=n,d=o.endsWith("?"),y=o.replace(/\?$/,"");if(c.length===0)return d?[y,""]:[y];let x=iD(c.join("/")),i=[];return i.push(...x.map(I=>I===""?y:[y,I].join("/"))),d&&i.push(...x),i.map(I=>e.startsWith("/")&&I===""?"/":I)}function e6(e){e.sort((n,o)=>n.score!==o.score?o.score-n.score:l6(n.routesMeta.map(c=>c.childrenIndex),o.routesMeta.map(c=>c.childrenIndex)))}const t6=/^:[\w-]+$/,n6=3,r6=2,i6=1,s6=10,o6=-2,yA=e=>e==="*";function a6(e,n){let o=e.split("/"),c=o.length;return o.some(yA)&&(c+=o6),n&&(c+=r6),o.filter(d=>!yA(d)).reduce((d,y)=>d+(t6.test(y)?n6:y===""?i6:s6),c)}function l6(e,n){return e.length===n.length&&e.slice(0,-1).every((c,d)=>c===n[d])?e[e.length-1]-n[n.length-1]:0}function c6(e,n,o){let{routesMeta:c}=e,d={},y="/",x=[];for(let i=0;i<c.length;++i){let I=c[i],R=i===c.length-1,k=y==="/"?n:n.slice(y.length)||"/",N=u6({path:I.relativePath,caseSensitive:I.caseSensitive,end:R},k),U=I.route;if(!N)return null;Object.assign(d,N.params),x.push({params:d,pathname:Bp([y,N.pathname]),pathnameBase:g6(Bp([y,N.pathnameBase])),route:U}),N.pathnameBase!=="/"&&(y=Bp([y,N.pathnameBase]))}return x}function u6(e,n){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[o,c]=d6(e.path,e.caseSensitive,e.end),d=n.match(o);if(!d)return null;let y=d[0],x=y.replace(/(.)\/+$/,"$1"),i=d.slice(1);return{params:c.reduce((R,k,N)=>{let{paramName:U,isOptional:K}=k;if(U==="*"){let Z=i[N]||"";x=y.slice(0,y.length-Z.length).replace(/(.)\/+$/,"$1")}const X=i[N];return K&&!X?R[U]=void 0:R[U]=(X||"").replace(/%2F/g,"/"),R},{}),pathname:y,pathnameBase:x,pattern:e}}function d6(e,n,o){n===void 0&&(n=!1),o===void 0&&(o=!0),nD(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let c=[],d="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(x,i,I)=>(c.push({paramName:i,isOptional:I!=null}),I?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(c.push({paramName:"*"}),d+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):o?d+="\\/*$":e!==""&&e!=="/"&&(d+="(?:(?=\\/|$))"),[new RegExp(d,n?void 0:"i"),c]}function h6(e){try{return e.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return nD(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+n+").")),e}}function VS(e,n){if(n==="/")return e;if(!e.toLowerCase().startsWith(n.toLowerCase()))return null;let o=n.endsWith("/")?n.length-1:n.length,c=e.charAt(o);return c&&c!=="/"?null:e.slice(o)||"/"}function f6(e,n){n===void 0&&(n="/");let{pathname:o,search:c="",hash:d=""}=typeof e=="string"?M_(e):e;return{pathname:o?o.startsWith("/")?o:p6(o,n):n,search:_6(c),hash:y6(d)}}function p6(e,n){let o=n.replace(/\/+$/,"").split("/");return e.split("/").forEach(d=>{d===".."?o.length>1&&o.pop():d!=="."&&o.push(d)}),o.length>1?o.join("/"):"/"}function Rw(e,n,o,c){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+n+"` field ["+JSON.stringify(c)+"].  Please separate it out to the ")+("`to."+o+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function m6(e){return e.filter((n,o)=>o===0||n.route.path&&n.route.path.length>0)}function US(e,n){let o=m6(e);return n?o.map((c,d)=>d===o.length-1?c.pathname:c.pathnameBase):o.map(c=>c.pathnameBase)}function $S(e,n,o,c){c===void 0&&(c=!1);let d;typeof e=="string"?d=M_(e):(d=yv({},e),Ao(!d.pathname||!d.pathname.includes("?"),Rw("?","pathname","search",d)),Ao(!d.pathname||!d.pathname.includes("#"),Rw("#","pathname","hash",d)),Ao(!d.search||!d.search.includes("#"),Rw("#","search","hash",d)));let y=e===""||d.pathname==="",x=y?"/":d.pathname,i;if(x==null)i=o;else{let N=n.length-1;if(!c&&x.startsWith("..")){let U=x.split("/");for(;U[0]==="..";)U.shift(),N-=1;d.pathname=U.join("/")}i=N>=0?n[N]:"/"}let I=f6(d,i),R=x&&x!=="/"&&x.endsWith("/"),k=(y||x===".")&&o.endsWith("/");return!I.pathname.endsWith("/")&&(R||k)&&(I.pathname+="/"),I}const Bp=e=>e.join("/").replace(/\/\/+/g,"/"),g6=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),_6=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,y6=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function v6(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const sD=["post","put","patch","delete"];new Set(sD);const x6=["get",...sD];new Set(x6);/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function vv(){return vv=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(e[c]=o[c])}return e},vv.apply(this,arguments)}const HS=V.createContext(null),b6=V.createContext(null),Yp=V.createContext(null),g1=V.createContext(null),Jp=V.createContext({outlet:null,matches:[],isDataRoute:!1}),oD=V.createContext(null);function w6(e,n){let{relative:o}=n===void 0?{}:n;L_()||Ao(!1);let{basename:c,navigator:d}=V.useContext(Yp),{hash:y,pathname:x,search:i}=lD(e,{relative:o}),I=x;return c!=="/"&&(I=x==="/"?c:Bp([c,x])),d.createHref({pathname:I,search:i,hash:y})}function L_(){return V.useContext(g1)!=null}function gg(){return L_()||Ao(!1),V.useContext(g1).location}function aD(e){V.useContext(Yp).static||V.useLayoutEffect(e)}function Cu(){let{isDataRoute:e}=V.useContext(Jp);return e?O6():S6()}function S6(){L_()||Ao(!1);let e=V.useContext(HS),{basename:n,future:o,navigator:c}=V.useContext(Yp),{matches:d}=V.useContext(Jp),{pathname:y}=gg(),x=JSON.stringify(US(d,o.v7_relativeSplatPath)),i=V.useRef(!1);return aD(()=>{i.current=!0}),V.useCallback(function(R,k){if(k===void 0&&(k={}),!i.current)return;if(typeof R=="number"){c.go(R);return}let N=$S(R,JSON.parse(x),y,k.relative==="path");e==null&&n!=="/"&&(N.pathname=N.pathname==="/"?n:Bp([n,N.pathname])),(k.replace?c.replace:c.push)(N,k.state,k)},[n,c,x,y,e])}function lD(e,n){let{relative:o}=n===void 0?{}:n,{future:c}=V.useContext(Yp),{matches:d}=V.useContext(Jp),{pathname:y}=gg(),x=JSON.stringify(US(d,c.v7_relativeSplatPath));return V.useMemo(()=>$S(e,JSON.parse(x),y,o==="path"),[e,x,y,o])}function C6(e,n){return T6(e,n)}function T6(e,n,o,c){L_()||Ao(!1);let{navigator:d,static:y}=V.useContext(Yp),{matches:x}=V.useContext(Jp),i=x[x.length-1],I=i?i.params:{};i&&i.pathname;let R=i?i.pathnameBase:"/";i&&i.route;let k=gg(),N;if(n){var U;let le=typeof n=="string"?M_(n):n;R==="/"||(U=le.pathname)!=null&&U.startsWith(R)||Ao(!1),N=le}else N=k;let K=N.pathname||"/",X=K;if(R!=="/"){let le=R.replace(/^\//,"").split("/");X="/"+K.replace(/^\//,"").split("/").slice(le.length).join("/")}let Z=JB(e,{pathname:X}),J=R6(Z&&Z.map(le=>Object.assign({},le,{params:Object.assign({},I,le.params),pathname:Bp([R,d.encodeLocation?d.encodeLocation(le.pathname).pathname:le.pathname]),pathnameBase:le.pathnameBase==="/"?R:Bp([R,d.encodeLocation?d.encodeLocation(le.pathnameBase).pathname:le.pathnameBase])})),x,o,c);return n&&J?V.createElement(g1.Provider,{value:{location:vv({pathname:"/",search:"",hash:"",state:null,key:"default"},N),navigationType:Np.Pop}},J):J}function E6(){let e=k6(),n=v6(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),o=e instanceof Error?e.stack:null,d={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return V.createElement(V.Fragment,null,V.createElement("h2",null,"Unexpected Application Error!"),V.createElement("h3",{style:{fontStyle:"italic"}},n),o?V.createElement("pre",{style:d},o):null,null)}const I6=V.createElement(E6,null);class P6 extends V.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,o){return o.location!==n.location||o.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:o.error,location:o.location,revalidation:n.revalidation||o.revalidation}}componentDidCatch(n,o){console.error("React Router caught the following error during render",n,o)}render(){return this.state.error!==void 0?V.createElement(Jp.Provider,{value:this.props.routeContext},V.createElement(oD.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function A6(e){let{routeContext:n,match:o,children:c}=e,d=V.useContext(HS);return d&&d.static&&d.staticContext&&(o.route.errorElement||o.route.ErrorBoundary)&&(d.staticContext._deepestRenderedBoundaryId=o.route.id),V.createElement(Jp.Provider,{value:n},c)}function R6(e,n,o,c){var d;if(n===void 0&&(n=[]),o===void 0&&(o=null),c===void 0&&(c=null),e==null){var y;if(!o)return null;if(o.errors)e=o.matches;else if((y=c)!=null&&y.v7_partialHydration&&n.length===0&&!o.initialized&&o.matches.length>0)e=o.matches;else return null}let x=e,i=(d=o)==null?void 0:d.errors;if(i!=null){let k=x.findIndex(N=>N.route.id&&(i==null?void 0:i[N.route.id])!==void 0);k>=0||Ao(!1),x=x.slice(0,Math.min(x.length,k+1))}let I=!1,R=-1;if(o&&c&&c.v7_partialHydration)for(let k=0;k<x.length;k++){let N=x[k];if((N.route.HydrateFallback||N.route.hydrateFallbackElement)&&(R=k),N.route.id){let{loaderData:U,errors:K}=o,X=N.route.loader&&U[N.route.id]===void 0&&(!K||K[N.route.id]===void 0);if(N.route.lazy||X){I=!0,R>=0?x=x.slice(0,R+1):x=[x[0]];break}}}return x.reduceRight((k,N,U)=>{let K,X=!1,Z=null,J=null;o&&(K=i&&N.route.id?i[N.route.id]:void 0,Z=N.route.errorElement||I6,I&&(R<0&&U===0?(z6("route-fallback"),X=!0,J=null):R===U&&(X=!0,J=N.route.hydrateFallbackElement||null)));let le=n.concat(x.slice(0,U+1)),de=()=>{let ue;return K?ue=Z:X?ue=J:N.route.Component?ue=V.createElement(N.route.Component,null):N.route.element?ue=N.route.element:ue=k,V.createElement(A6,{match:N,routeContext:{outlet:k,matches:le,isDataRoute:o!=null},children:ue})};return o&&(N.route.ErrorBoundary||N.route.errorElement||U===0)?V.createElement(P6,{location:o.location,revalidation:o.revalidation,component:Z,error:K,children:de(),routeContext:{outlet:null,matches:le,isDataRoute:!0}}):de()},null)}var cD=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(cD||{}),uD=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(uD||{});function M6(e){let n=V.useContext(HS);return n||Ao(!1),n}function L6(e){let n=V.useContext(b6);return n||Ao(!1),n}function D6(e){let n=V.useContext(Jp);return n||Ao(!1),n}function dD(e){let n=D6(),o=n.matches[n.matches.length-1];return o.route.id||Ao(!1),o.route.id}function k6(){var e;let n=V.useContext(oD),o=L6(),c=dD();return n!==void 0?n:(e=o.errors)==null?void 0:e[c]}function O6(){let{router:e}=M6(cD.UseNavigateStable),n=dD(uD.UseNavigateStable),o=V.useRef(!1);return aD(()=>{o.current=!0}),V.useCallback(function(d,y){y===void 0&&(y={}),o.current&&(typeof d=="number"?e.navigate(d):e.navigate(d,vv({fromRouteId:n},y)))},[e,n])}const vA={};function z6(e,n,o){vA[e]||(vA[e]=!0)}function F6(e,n){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function N6(e){let{to:n,replace:o,state:c,relative:d}=e;L_()||Ao(!1);let{future:y,static:x}=V.useContext(Yp),{matches:i}=V.useContext(Jp),{pathname:I}=gg(),R=Cu(),k=$S(n,US(i,y.v7_relativeSplatPath),I,d==="path"),N=JSON.stringify(k);return V.useEffect(()=>R(JSON.parse(N),{replace:o,state:c,relative:d}),[R,N,d,o,c]),null}function Pc(e){Ao(!1)}function j6(e){let{basename:n="/",children:o=null,location:c,navigationType:d=Np.Pop,navigator:y,static:x=!1,future:i}=e;L_()&&Ao(!1);let I=n.replace(/^\/*/,"/"),R=V.useMemo(()=>({basename:I,navigator:y,static:x,future:vv({v7_relativeSplatPath:!1},i)}),[I,i,y,x]);typeof c=="string"&&(c=M_(c));let{pathname:k="/",search:N="",hash:U="",state:K=null,key:X="default"}=c,Z=V.useMemo(()=>{let J=VS(k,I);return J==null?null:{location:{pathname:J,search:N,hash:U,state:K,key:X},navigationType:d}},[I,k,N,U,K,X,d]);return Z==null?null:V.createElement(Yp.Provider,{value:R},V.createElement(g1.Provider,{children:o,value:Z}))}function B6(e){let{children:n,location:o}=e;return C6(L2(n),o)}new Promise(()=>{});function L2(e,n){n===void 0&&(n=[]);let o=[];return V.Children.forEach(e,(c,d)=>{if(!V.isValidElement(c))return;let y=[...n,d];if(c.type===V.Fragment){o.push.apply(o,L2(c.props.children,y));return}c.type!==Pc&&Ao(!1),!c.props.index||!c.props.children||Ao(!1);let x={id:c.props.id||y.join("-"),caseSensitive:c.props.caseSensitive,element:c.props.element,Component:c.props.Component,index:c.props.index,path:c.props.path,loader:c.props.loader,action:c.props.action,errorElement:c.props.errorElement,ErrorBoundary:c.props.ErrorBoundary,hasErrorBoundary:c.props.ErrorBoundary!=null||c.props.errorElement!=null,shouldRevalidate:c.props.shouldRevalidate,handle:c.props.handle,lazy:c.props.lazy};c.props.children&&(x.children=L2(c.props.children,y)),o.push(x)}),o}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function D2(){return D2=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(e[c]=o[c])}return e},D2.apply(this,arguments)}function V6(e,n){if(e==null)return{};var o={},c=Object.keys(e),d,y;for(y=0;y<c.length;y++)d=c[y],!(n.indexOf(d)>=0)&&(o[d]=e[d]);return o}function U6(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function $6(e,n){return e.button===0&&(!n||n==="_self")&&!U6(e)}function k2(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((n,o)=>{let c=e[o];return n.concat(Array.isArray(c)?c.map(d=>[o,d]):[[o,c]])},[]))}function H6(e,n){let o=k2(e);return n&&n.forEach((c,d)=>{o.has(d)||n.getAll(d).forEach(y=>{o.append(d,y)})}),o}const G6=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],W6="6";try{window.__reactRouterVersion=W6}catch{}const q6="startTransition",xA=R0[q6];function Z6(e){let{basename:n,children:o,future:c,window:d}=e,y=V.useRef();y.current==null&&(y.current=XB({window:d,v5Compat:!0}));let x=y.current,[i,I]=V.useState({action:x.action,location:x.location}),{v7_startTransition:R}=c||{},k=V.useCallback(N=>{R&&xA?xA(()=>I(N)):I(N)},[I,R]);return V.useLayoutEffect(()=>x.listen(k),[x,k]),V.useEffect(()=>F6(c),[c]),V.createElement(j6,{basename:n,children:o,location:i.location,navigationType:i.action,navigator:x,future:c})}const X6=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",K6=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,co=V.forwardRef(function(n,o){let{onClick:c,relative:d,reloadDocument:y,replace:x,state:i,target:I,to:R,preventScrollReset:k,viewTransition:N}=n,U=V6(n,G6),{basename:K}=V.useContext(Yp),X,Z=!1;if(typeof R=="string"&&K6.test(R)&&(X=R,X6))try{let ue=new URL(window.location.href),pe=R.startsWith("//")?new URL(ue.protocol+R):new URL(R),he=VS(pe.pathname,K);pe.origin===ue.origin&&he!=null?R=he+pe.search+pe.hash:Z=!0}catch{}let J=w6(R,{relative:d}),le=Y6(R,{replace:x,state:i,target:I,preventScrollReset:k,relative:d,viewTransition:N});function de(ue){c&&c(ue),ue.defaultPrevented||le(ue)}return V.createElement("a",D2({},U,{href:X||J,onClick:Z||y?c:de,ref:o,target:I}))});var bA;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(bA||(bA={}));var wA;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(wA||(wA={}));function Y6(e,n){let{target:o,replace:c,state:d,preventScrollReset:y,relative:x,viewTransition:i}=n===void 0?{}:n,I=Cu(),R=gg(),k=lD(e,{relative:x});return V.useCallback(N=>{if($6(N,o)){N.preventDefault();let U=c!==void 0?c:M0(R)===M0(k);I(e,{replace:U,state:d,preventScrollReset:y,relative:x,viewTransition:i})}},[R,I,k,c,d,o,e,y,x,i])}function hD(e){let n=V.useRef(k2(e)),o=V.useRef(!1),c=gg(),d=V.useMemo(()=>H6(c.search,o.current?null:n.current),[c.search]),y=Cu(),x=V.useCallback((i,I)=>{const R=k2(typeof i=="function"?i(d):i);o.current=!0,y("?"+R,I)},[y,d]);return[d,x]}var Mw={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var SA;function J6(){return SA||(SA=1,function(e){(function(){var n={}.hasOwnProperty;function o(){for(var y="",x=0;x<arguments.length;x++){var i=arguments[x];i&&(y=d(y,c(i)))}return y}function c(y){if(typeof y=="string"||typeof y=="number")return y;if(typeof y!="object")return"";if(Array.isArray(y))return o.apply(null,y);if(y.toString!==Object.prototype.toString&&!y.toString.toString().includes("[native code]"))return y.toString();var x="";for(var i in y)n.call(y,i)&&y[i]&&(x=d(x,i));return x}function d(y,x){return x?y?y+" "+x:y+x:y}e.exports?(o.default=o,e.exports=o):window.classNames=o})()}(Mw)),Mw.exports}var Q6=J6();const qn=mg(Q6);function nt(){return nt=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var c in o)({}).hasOwnProperty.call(o,c)&&(e[c]=o[c])}return e},nt.apply(null,arguments)}function jr(e,n){if(e==null)return{};var o={};for(var c in e)if({}.hasOwnProperty.call(e,c)){if(n.indexOf(c)!==-1)continue;o[c]=e[c]}return o}function CA(e){return"default"+e.charAt(0).toUpperCase()+e.substr(1)}function eV(e){var n=tV(e,"string");return typeof n=="symbol"?n:String(n)}function tV(e,n){if(typeof e!="object"||e===null)return e;var o=e[Symbol.toPrimitive];if(o!==void 0){var c=o.call(e,n);if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function nV(e,n,o){var c=V.useRef(e!==void 0),d=V.useState(n),y=d[0],x=d[1],i=e!==void 0,I=c.current;return c.current=i,!i&&I&&y!==n&&x(n),[i?e:y,V.useCallback(function(R){for(var k=arguments.length,N=new Array(k>1?k-1:0),U=1;U<k;U++)N[U-1]=arguments[U];o&&o.apply(void 0,[R].concat(N)),x(R)},[o])]}function D_(e,n){return Object.keys(n).reduce(function(o,c){var d,y=o,x=y[CA(c)],i=y[c],I=jr(y,[CA(c),c].map(eV)),R=n[c],k=nV(i,x,e[R]),N=k[0],U=k[1];return nt({},I,(d={},d[c]=N,d[R]=U,d))},e)}function L0(e,n){return L0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,c){return o.__proto__=c,o},L0(e,n)}function fD(e,n){e.prototype=Object.create(n.prototype),e.prototype.constructor=e,L0(e,n)}const rV=["xxl","xl","lg","md","sm","xs"],iV="xs",Ov=V.createContext({prefixes:{},breakpoints:rV,minBreakpoint:iV}),{Consumer:oce,Provider:ace}=Ov;function sr(e,n){const{prefixes:o}=V.useContext(Ov);return e||o[n]||n}function pD(){const{breakpoints:e}=V.useContext(Ov);return e}function mD(){const{minBreakpoint:e}=V.useContext(Ov);return e}function GS(){const{dir:e}=V.useContext(Ov);return e==="rtl"}function zv(e){return e&&e.ownerDocument||document}function sV(e){var n=zv(e);return n&&n.defaultView||window}function oV(e,n){return sV(e).getComputedStyle(e,n)}var aV=/([A-Z])/g;function lV(e){return e.replace(aV,"-$1").toLowerCase()}var cV=/^ms-/;function e0(e){return lV(e).replace(cV,"-ms-")}var uV=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function dV(e){return!!(e&&uV.test(e))}function Sf(e,n){var o="",c="";if(typeof n=="string")return e.style.getPropertyValue(e0(n))||oV(e).getPropertyValue(e0(n));Object.keys(n).forEach(function(d){var y=n[d];!y&&y!==0?e.style.removeProperty(e0(d)):dV(d)?c+=d+"("+y+") ":o+=e0(d)+": "+y+";"}),c&&(o+="transform: "+c+";"),e.style.cssText+=";"+o}var Lw={exports:{}},Dw,TA;function hV(){if(TA)return Dw;TA=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Dw=e,Dw}var kw,EA;function fV(){if(EA)return kw;EA=1;var e=hV();function n(){}function o(){}return o.resetWarningCache=n,kw=function(){function c(x,i,I,R,k,N){if(N!==e){var U=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw U.name="Invariant Violation",U}}c.isRequired=c;function d(){return c}var y={array:c,bigint:c,bool:c,func:c,number:c,object:c,string:c,symbol:c,any:c,arrayOf:d,element:c,elementType:c,instanceOf:d,node:c,objectOf:d,oneOf:d,oneOfType:d,shape:d,exact:d,checkPropTypes:o,resetWarningCache:n};return y.PropTypes=y,y},kw}var IA;function pV(){return IA||(IA=1,Lw.exports=fV()()),Lw.exports}var mV=pV();const $a=mg(mV),PA={disabled:!1},D0=qi.createContext(null);var gV=function(n){return n.scrollTop},ev="unmounted",Op="exited",yu="entering",bf="entered",__="exiting",fd=function(e){fD(n,e);function n(c,d){var y;y=e.call(this,c,d)||this;var x=d,i=x&&!x.isMounting?c.enter:c.appear,I;return y.appearStatus=null,c.in?i?(I=Op,y.appearStatus=yu):I=bf:c.unmountOnExit||c.mountOnEnter?I=ev:I=Op,y.state={status:I},y.nextCallback=null,y}n.getDerivedStateFromProps=function(d,y){var x=d.in;return x&&y.status===ev?{status:Op}:null};var o=n.prototype;return o.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},o.componentDidUpdate=function(d){var y=null;if(d!==this.props){var x=this.state.status;this.props.in?x!==yu&&x!==bf&&(y=yu):(x===yu||x===bf)&&(y=__)}this.updateStatus(!1,y)},o.componentWillUnmount=function(){this.cancelNextCallback()},o.getTimeouts=function(){var d=this.props.timeout,y,x,i;return y=x=i=d,d!=null&&typeof d!="number"&&(y=d.exit,x=d.enter,i=d.appear!==void 0?d.appear:x),{exit:y,enter:x,appear:i}},o.updateStatus=function(d,y){if(d===void 0&&(d=!1),y!==null)if(this.cancelNextCallback(),y===yu){if(this.props.unmountOnExit||this.props.mountOnEnter){var x=this.props.nodeRef?this.props.nodeRef.current:l_.findDOMNode(this);x&&gV(x)}this.performEnter(d)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Op&&this.setState({status:ev})},o.performEnter=function(d){var y=this,x=this.props.enter,i=this.context?this.context.isMounting:d,I=this.props.nodeRef?[i]:[l_.findDOMNode(this),i],R=I[0],k=I[1],N=this.getTimeouts(),U=i?N.appear:N.enter;if(!d&&!x||PA.disabled){this.safeSetState({status:bf},function(){y.props.onEntered(R)});return}this.props.onEnter(R,k),this.safeSetState({status:yu},function(){y.props.onEntering(R,k),y.onTransitionEnd(U,function(){y.safeSetState({status:bf},function(){y.props.onEntered(R,k)})})})},o.performExit=function(){var d=this,y=this.props.exit,x=this.getTimeouts(),i=this.props.nodeRef?void 0:l_.findDOMNode(this);if(!y||PA.disabled){this.safeSetState({status:Op},function(){d.props.onExited(i)});return}this.props.onExit(i),this.safeSetState({status:__},function(){d.props.onExiting(i),d.onTransitionEnd(x.exit,function(){d.safeSetState({status:Op},function(){d.props.onExited(i)})})})},o.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},o.safeSetState=function(d,y){y=this.setNextCallback(y),this.setState(d,y)},o.setNextCallback=function(d){var y=this,x=!0;return this.nextCallback=function(i){x&&(x=!1,y.nextCallback=null,d(i))},this.nextCallback.cancel=function(){x=!1},this.nextCallback},o.onTransitionEnd=function(d,y){this.setNextCallback(y);var x=this.props.nodeRef?this.props.nodeRef.current:l_.findDOMNode(this),i=d==null&&!this.props.addEndListener;if(!x||i){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var I=this.props.nodeRef?[this.nextCallback]:[x,this.nextCallback],R=I[0],k=I[1];this.props.addEndListener(R,k)}d!=null&&setTimeout(this.nextCallback,d)},o.render=function(){var d=this.state.status;if(d===ev)return null;var y=this.props,x=y.children;y.in,y.mountOnEnter,y.unmountOnExit,y.appear,y.enter,y.exit,y.timeout,y.addEndListener,y.onEnter,y.onEntering,y.onEntered,y.onExit,y.onExiting,y.onExited,y.nodeRef;var i=jr(y,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return qi.createElement(D0.Provider,{value:null},typeof x=="function"?x(d,i):qi.cloneElement(qi.Children.only(x),i))},n}(qi.Component);fd.contextType=D0;fd.propTypes={};function qg(){}fd.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:qg,onEntering:qg,onEntered:qg,onExit:qg,onExiting:qg,onExited:qg};fd.UNMOUNTED=ev;fd.EXITED=Op;fd.ENTERING=yu;fd.ENTERED=bf;fd.EXITING=__;function _V(e){return e.code==="Escape"||e.keyCode===27}function yV(){const e=V.version.split(".");return{major:+e[0],minor:+e[1],patch:+e[2]}}function k_(e){if(!e||typeof e=="function")return null;const{major:n}=yV();return n>=19?e.props.ref:e.ref}const O_=!!(typeof window<"u"&&window.document&&window.document.createElement);var O2=!1,z2=!1;try{var Ow={get passive(){return O2=!0},get once(){return z2=O2=!0}};O_&&(window.addEventListener("test",Ow,Ow),window.removeEventListener("test",Ow,!0))}catch{}function WS(e,n,o,c){if(c&&typeof c!="boolean"&&!z2){var d=c.once,y=c.capture,x=o;!z2&&d&&(x=o.__once||function i(I){this.removeEventListener(n,i,y),o.call(this,I)},o.__once=x),e.addEventListener(n,x,O2?c:y)}e.addEventListener(n,o,c)}function F2(e,n,o,c){var d=c&&typeof c!="boolean"?c.capture:c;e.removeEventListener(n,o,d),o.__once&&e.removeEventListener(n,o.__once,d)}function jp(e,n,o,c){return WS(e,n,o,c),function(){F2(e,n,o,c)}}function vV(e,n,o,c){if(c===void 0&&(c=!0),e){var d=document.createEvent("HTMLEvents");d.initEvent(n,o,c),e.dispatchEvent(d)}}function xV(e){var n=Sf(e,"transitionDuration")||"",o=n.indexOf("ms")===-1?1e3:1;return parseFloat(n)*o}function bV(e,n,o){o===void 0&&(o=5);var c=!1,d=setTimeout(function(){c||vV(e,"transitionend",!0)},n+o),y=jp(e,"transitionend",function(){c=!0},{once:!0});return function(){clearTimeout(d),y()}}function gD(e,n,o,c){o==null&&(o=xV(e)||0);var d=bV(e,o,c),y=jp(e,"transitionend",n);return function(){d(),y()}}function AA(e,n){const o=Sf(e,n)||"",c=o.indexOf("ms")===-1?1e3:1;return parseFloat(o)*c}function _1(e,n){const o=AA(e,"transitionDuration"),c=AA(e,"transitionDelay"),d=gD(e,y=>{y.target===e&&(d(),n(y))},o+c)}function Uy(...e){return e.filter(n=>n!=null).reduce((n,o)=>{if(typeof o!="function")throw new Error("Invalid Argument Type, must only provide functions, undefined, or null.");return n===null?o:function(...d){n.apply(this,d),o.apply(this,d)}},null)}function qS(e){e.offsetHeight}const RA=e=>!e||typeof e=="function"?e:n=>{e.current=n};function wV(e,n){const o=RA(e),c=RA(n);return d=>{o&&o(d),c&&c(d)}}function y1(e,n){return V.useMemo(()=>wV(e,n),[e,n])}function SV(e){return e&&"setState"in e?l_.findDOMNode(e):e??null}const v1=qi.forwardRef(({onEnter:e,onEntering:n,onEntered:o,onExit:c,onExiting:d,onExited:y,addEndListener:x,children:i,childRef:I,...R},k)=>{const N=V.useRef(null),U=y1(N,I),K=xe=>{U(SV(xe))},X=xe=>fe=>{xe&&N.current&&xe(N.current,fe)},Z=V.useCallback(X(e),[e]),J=V.useCallback(X(n),[n]),le=V.useCallback(X(o),[o]),de=V.useCallback(X(c),[c]),ue=V.useCallback(X(d),[d]),pe=V.useCallback(X(y),[y]),he=V.useCallback(X(x),[x]);return T.jsx(fd,{ref:k,...R,onEnter:Z,onEntered:le,onEntering:J,onExit:de,onExited:pe,onExiting:ue,addEndListener:he,nodeRef:N,children:typeof i=="function"?(xe,fe)=>i(xe,{...fe,ref:K}):qi.cloneElement(i,{ref:K})})}),CV={height:["marginTop","marginBottom"],width:["marginLeft","marginRight"]};function TV(e,n){const o=`offset${e[0].toUpperCase()}${e.slice(1)}`,c=n[o],d=CV[e];return c+parseInt(Sf(n,d[0]),10)+parseInt(Sf(n,d[1]),10)}const EV={[Op]:"collapse",[__]:"collapsing",[yu]:"collapsing",[bf]:"collapse show"},IV=qi.forwardRef(({onEnter:e,onEntering:n,onEntered:o,onExit:c,onExiting:d,className:y,children:x,dimension:i="height",in:I=!1,timeout:R=300,mountOnEnter:k=!1,unmountOnExit:N=!1,appear:U=!1,getDimensionValue:K=TV,...X},Z)=>{const J=typeof i=="function"?i():i,le=V.useMemo(()=>Uy(xe=>{xe.style[J]="0"},e),[J,e]),de=V.useMemo(()=>Uy(xe=>{const fe=`scroll${J[0].toUpperCase()}${J.slice(1)}`;xe.style[J]=`${xe[fe]}px`},n),[J,n]),ue=V.useMemo(()=>Uy(xe=>{xe.style[J]=null},o),[J,o]),pe=V.useMemo(()=>Uy(xe=>{xe.style[J]=`${K(J,xe)}px`,qS(xe)},c),[c,K,J]),he=V.useMemo(()=>Uy(xe=>{xe.style[J]=null},d),[J,d]);return T.jsx(v1,{ref:Z,addEndListener:_1,...X,"aria-expanded":X.role?I:null,onEnter:le,onEntering:de,onEntered:ue,onExit:pe,onExiting:he,childRef:k_(x),in:I,timeout:R,mountOnEnter:k,unmountOnExit:N,appear:U,children:(xe,fe)=>qi.cloneElement(x,{...fe,className:qn(y,x.props.className,EV[xe],J==="width"&&"collapse-horizontal")})})});function _D(e){const n=V.useRef(e);return V.useEffect(()=>{n.current=e},[e]),n}function bu(e){const n=_D(e);return V.useCallback(function(...o){return n.current&&n.current(...o)},[n])}const Fv=e=>V.forwardRef((n,o)=>T.jsx("div",{...n,ref:o,className:qn(n.className,e)})),yD=Fv("h4");yD.displayName="DivStyledAsH4";const vD=V.forwardRef(({className:e,bsPrefix:n,as:o=yD,...c},d)=>(n=sr(n,"alert-heading"),T.jsx(o,{ref:d,className:qn(e,n),...c})));vD.displayName="AlertHeading";function PV(){return V.useState(null)}function AV(e){const n=V.useRef(e);return V.useEffect(()=>{n.current=e},[e]),n}function Ha(e){const n=AV(e);return V.useCallback(function(...o){return n.current&&n.current(...o)},[n])}function RV(e,n,o,c=!1){const d=Ha(o);V.useEffect(()=>{const y=typeof e=="function"?e():e;return y.addEventListener(n,d,c),()=>y.removeEventListener(n,d,c)},[e])}function xD(){const e=V.useRef(!0),n=V.useRef(()=>e.current);return V.useEffect(()=>(e.current=!0,()=>{e.current=!1}),[]),n.current}function bD(e){const n=V.useRef(null);return V.useEffect(()=>{n.current=e}),n.current}const MV=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",LV=typeof document<"u",MA=LV||MV?V.useLayoutEffect:V.useEffect,DV=["as","disabled"];function kV(e,n){if(e==null)return{};var o={};for(var c in e)if({}.hasOwnProperty.call(e,c)){if(n.indexOf(c)>=0)continue;o[c]=e[c]}return o}function OV(e){return!e||e.trim()==="#"}function ZS({tagName:e,disabled:n,href:o,target:c,rel:d,role:y,onClick:x,tabIndex:i=0,type:I}){e||(o!=null||c!=null||d!=null?e="a":e="button");const R={tagName:e};if(e==="button")return[{type:I||"button",disabled:n},R];const k=U=>{if((n||e==="a"&&OV(o))&&U.preventDefault(),n){U.stopPropagation();return}x==null||x(U)},N=U=>{U.key===" "&&(U.preventDefault(),k(U))};return e==="a"&&(o||(o="#"),n&&(o=void 0)),[{role:y??"button",disabled:void 0,tabIndex:n?void 0:i,href:o,target:e==="a"?c:void 0,"aria-disabled":n||void 0,rel:e==="a"?d:void 0,onClick:k,onKeyDown:N},R]}const XS=V.forwardRef((e,n)=>{let{as:o,disabled:c}=e,d=kV(e,DV);const[y,{tagName:x}]=ZS(Object.assign({tagName:o,disabled:c},d));return T.jsx(x,Object.assign({},d,y,{ref:n}))});XS.displayName="Button";const zV=["onKeyDown"];function FV(e,n){if(e==null)return{};var o={};for(var c in e)if({}.hasOwnProperty.call(e,c)){if(n.indexOf(c)>=0)continue;o[c]=e[c]}return o}function NV(e){return!e||e.trim()==="#"}const y_=V.forwardRef((e,n)=>{let{onKeyDown:o}=e,c=FV(e,zV);const[d]=ZS(Object.assign({tagName:"a"},c)),y=Ha(x=>{d.onKeyDown(x),o==null||o(x)});return NV(c.href)||c.role==="button"?T.jsx("a",Object.assign({ref:n},c,d,{onKeyDown:y})):T.jsx("a",Object.assign({ref:n},c,{onKeyDown:o}))});y_.displayName="Anchor";const wD=V.forwardRef(({className:e,bsPrefix:n,as:o=y_,...c},d)=>(n=sr(n,"alert-link"),T.jsx(o,{ref:d,className:qn(e,n),...c})));wD.displayName="AlertLink";const jV={[yu]:"show",[bf]:"show"},If=V.forwardRef(({className:e,children:n,transitionClasses:o={},onEnter:c,...d},y)=>{const x={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1,...d},i=V.useCallback((I,R)=>{qS(I),c==null||c(I,R)},[c]);return T.jsx(v1,{ref:y,addEndListener:_1,...x,onEnter:i,childRef:k_(n),children:(I,R)=>V.cloneElement(n,{...R,className:qn("fade",e,n.props.className,jV[I],o[I])})})});If.displayName="Fade";const BV={"aria-label":$a.string,onClick:$a.func,variant:$a.oneOf(["white"])},Nv=V.forwardRef(({className:e,variant:n,"aria-label":o="Close",...c},d)=>T.jsx("button",{ref:d,type:"button",className:qn("btn-close",n&&`btn-close-${n}`,e),"aria-label":o,...c}));Nv.displayName="CloseButton";Nv.propTypes=BV;const SD=V.forwardRef((e,n)=>{const{bsPrefix:o,show:c=!0,closeLabel:d="Close alert",closeVariant:y,className:x,children:i,variant:I="primary",onClose:R,dismissible:k,transition:N=If,...U}=D_(e,{show:"onClose"}),K=sr(o,"alert"),X=bu(le=>{R&&R(!1,le)}),Z=N===!0?If:N,J=T.jsxs("div",{role:"alert",...Z?void 0:U,ref:n,className:qn(x,K,I&&`${K}-${I}`,k&&`${K}-dismissible`),children:[k&&T.jsx(Nv,{onClick:X,"aria-label":d,variant:y}),i]});return Z?T.jsx(Z,{unmountOnExit:!0,...U,ref:void 0,in:c,children:J}):c?J:null});SD.displayName="Alert";const mi=Object.assign(SD,{Link:wD,Heading:vD}),ia=V.forwardRef(({bsPrefix:e,bg:n="primary",pill:o=!1,text:c,className:d,as:y="span",...x},i)=>{const I=sr(e,"badge");return T.jsx(y,{ref:i,...x,className:qn(d,I,o&&"rounded-pill",c&&`text-${c}`,n&&`bg-${n}`)})});ia.displayName="Badge";const Qn=V.forwardRef(({as:e,bsPrefix:n,variant:o="primary",size:c,active:d=!1,disabled:y=!1,className:x,...i},I)=>{const R=sr(n,"btn"),[k,{tagName:N}]=ZS({tagName:e,disabled:y,...i}),U=N;return T.jsx(U,{...k,...i,ref:I,disabled:y,className:qn(x,R,d&&"active",o&&`${R}-${o}`,c&&`${R}-${c}`,i.href&&y&&"disabled")})});Qn.displayName="Button";const KS=V.forwardRef(({className:e,bsPrefix:n,as:o="div",...c},d)=>(n=sr(n,"card-body"),T.jsx(o,{ref:d,className:qn(e,n),...c})));KS.displayName="CardBody";const CD=V.forwardRef(({className:e,bsPrefix:n,as:o="div",...c},d)=>(n=sr(n,"card-footer"),T.jsx(o,{ref:d,className:qn(e,n),...c})));CD.displayName="CardFooter";const YS=V.createContext(null);YS.displayName="CardHeaderContext";const TD=V.forwardRef(({bsPrefix:e,className:n,as:o="div",...c},d)=>{const y=sr(e,"card-header"),x=V.useMemo(()=>({cardHeaderBsPrefix:y}),[y]);return T.jsx(YS.Provider,{value:x,children:T.jsx(o,{ref:d,...c,className:qn(n,y)})})});TD.displayName="CardHeader";const ED=V.forwardRef(({bsPrefix:e,className:n,variant:o,as:c="img",...d},y)=>{const x=sr(e,"card-img");return T.jsx(c,{ref:y,className:qn(o?`${x}-${o}`:x,n),...d})});ED.displayName="CardImg";const ID=V.forwardRef(({className:e,bsPrefix:n,as:o="div",...c},d)=>(n=sr(n,"card-img-overlay"),T.jsx(o,{ref:d,className:qn(e,n),...c})));ID.displayName="CardImgOverlay";const PD=V.forwardRef(({className:e,bsPrefix:n,as:o="a",...c},d)=>(n=sr(n,"card-link"),T.jsx(o,{ref:d,className:qn(e,n),...c})));PD.displayName="CardLink";const VV=Fv("h6"),AD=V.forwardRef(({className:e,bsPrefix:n,as:o=VV,...c},d)=>(n=sr(n,"card-subtitle"),T.jsx(o,{ref:d,className:qn(e,n),...c})));AD.displayName="CardSubtitle";const RD=V.forwardRef(({className:e,bsPrefix:n,as:o="p",...c},d)=>(n=sr(n,"card-text"),T.jsx(o,{ref:d,className:qn(e,n),...c})));RD.displayName="CardText";const UV=Fv("h5"),MD=V.forwardRef(({className:e,bsPrefix:n,as:o=UV,...c},d)=>(n=sr(n,"card-title"),T.jsx(o,{ref:d,className:qn(e,n),...c})));MD.displayName="CardTitle";const LD=V.forwardRef(({bsPrefix:e,className:n,bg:o,text:c,border:d,body:y=!1,children:x,as:i="div",...I},R)=>{const k=sr(e,"card");return T.jsx(i,{ref:R,...I,className:qn(n,k,o&&`bg-${o}`,c&&`text-${c}`,d&&`border-${d}`),children:y?T.jsx(KS,{children:x}):x})});LD.displayName="Card";const yn=Object.assign(LD,{Img:ED,Title:MD,Subtitle:AD,Body:KS,Link:PD,Text:RD,Header:TD,Footer:CD,ImgOverlay:ID});function $V(e,n){const o=V.useRef(!0);V.useEffect(()=>{if(o.current){o.current=!1;return}return e()},n)}function HV(){const e=V.useRef(!0),n=V.useRef(()=>e.current);return V.useEffect(()=>(e.current=!0,()=>{e.current=!1}),[]),n.current}function GV(e){const n=V.useRef(e);return n.current=e,n}function DD(e){const n=GV(e);V.useEffect(()=>()=>n.current(),[])}const N2=2**31-1;function kD(e,n,o){const c=o-Date.now();e.current=c<=N2?setTimeout(n,c):setTimeout(()=>kD(e,n,o),N2)}function OD(){const e=HV(),n=V.useRef();return DD(()=>clearTimeout(n.current)),V.useMemo(()=>{const o=()=>clearTimeout(n.current);function c(d,y=0){e()&&(o(),y<=N2?n.current=setTimeout(d,y):kD(n,d,Date.now()+y))}return{set:c,clear:o,handleRef:n}},[])}const zD=V.forwardRef(({className:e,bsPrefix:n,as:o="div",...c},d)=>(n=sr(n,"carousel-caption"),T.jsx(o,{ref:d,className:qn(e,n),...c})));zD.displayName="CarouselCaption";const FD=V.forwardRef(({as:e="div",bsPrefix:n,className:o,...c},d)=>{const y=qn(o,sr(n,"carousel-item"));return T.jsx(e,{ref:d,...c,className:y})});FD.displayName="CarouselItem";function LA(e,n){let o=0;return V.Children.map(e,c=>V.isValidElement(c)?n(c,o++):c)}function WV(e,n){let o=0;V.Children.forEach(e,c=>{V.isValidElement(c)&&n(c,o++)})}function qV(e,n){return V.Children.toArray(e).some(o=>V.isValidElement(o)&&o.type===n)}const ZV=40;function XV(e){if(!e||!e.style||!e.parentNode||!e.parentNode.style)return!1;const n=getComputedStyle(e);return n.display!=="none"&&n.visibility!=="hidden"&&getComputedStyle(e.parentNode).display!=="none"}const ND=V.forwardRef(({defaultActiveIndex:e=0,...n},o)=>{const{as:c="div",bsPrefix:d,slide:y=!0,fade:x=!1,controls:i=!0,indicators:I=!0,indicatorLabels:R=[],activeIndex:k,onSelect:N,onSlide:U,onSlid:K,interval:X=5e3,keyboard:Z=!0,onKeyDown:J,pause:le="hover",onMouseOver:de,onMouseOut:ue,wrap:pe=!0,touch:he=!0,onTouchStart:xe,onTouchMove:fe,onTouchEnd:_e,prevIcon:Ce=T.jsx("span",{"aria-hidden":"true",className:"carousel-control-prev-icon"}),prevLabel:je="Previous",nextIcon:He=T.jsx("span",{"aria-hidden":"true",className:"carousel-control-next-icon"}),nextLabel:lt="Next",variant:_t,className:Ue,children:Ge,...at}=D_({defaultActiveIndex:e,...n},{activeIndex:"onSelect"}),yt=sr(d,"carousel"),tt=GS(),Rt=V.useRef(null),[ct,ze]=V.useState("next"),[Ye,At]=V.useState(!1),[Ct,We]=V.useState(!1),[st,Bt]=V.useState(k||0);V.useEffect(()=>{!Ct&&k!==st&&(Rt.current?ze(Rt.current):ze((k||0)>st?"next":"prev"),y&&We(!0),Bt(k||0))},[k,Ct,st,y]),V.useEffect(()=>{Rt.current&&(Rt.current=null)});let hn=0,cn;WV(Ge,(Sr,On)=>{++hn,On===k&&(cn=Sr.props.interval)});const cr=_D(cn),Nn=V.useCallback(Sr=>{if(Ct)return;let On=st-1;if(On<0){if(!pe)return;On=hn-1}Rt.current="prev",N==null||N(On,Sr)},[Ct,st,N,pe,hn]),Vn=bu(Sr=>{if(Ct)return;let On=st+1;if(On>=hn){if(!pe)return;On=0}Rt.current="next",N==null||N(On,Sr)}),An=V.useRef();V.useImperativeHandle(o,()=>({element:An.current,prev:Nn,next:Vn}));const Zt=bu(()=>{!document.hidden&&XV(An.current)&&(tt?Nn():Vn())}),mn=ct==="next"?"start":"end";$V(()=>{y||(U==null||U(st,mn),K==null||K(st,mn))},[st]);const kr=`${yt}-item-${ct}`,Gr=`${yt}-item-${mn}`,Yr=V.useCallback(Sr=>{qS(Sr),U==null||U(st,mn)},[U,st,mn]),Xn=V.useCallback(()=>{We(!1),K==null||K(st,mn)},[K,st,mn]),Lr=V.useCallback(Sr=>{if(Z&&!/input|textarea/i.test(Sr.target.tagName))switch(Sr.key){case"ArrowLeft":Sr.preventDefault(),tt?Vn(Sr):Nn(Sr);return;case"ArrowRight":Sr.preventDefault(),tt?Nn(Sr):Vn(Sr);return}J==null||J(Sr)},[Z,J,Nn,Vn,tt]),Or=V.useCallback(Sr=>{le==="hover"&&At(!0),de==null||de(Sr)},[le,de]),is=V.useCallback(Sr=>{At(!1),ue==null||ue(Sr)},[ue]),Zi=V.useRef(0),Dr=V.useRef(0),Bi=OD(),Fr=V.useCallback(Sr=>{Zi.current=Sr.touches[0].clientX,Dr.current=0,le==="hover"&&At(!0),xe==null||xe(Sr)},[le,xe]),Xi=V.useCallback(Sr=>{Sr.touches&&Sr.touches.length>1?Dr.current=0:Dr.current=Sr.touches[0].clientX-Zi.current,fe==null||fe(Sr)},[fe]),ei=V.useCallback(Sr=>{if(he){const On=Dr.current;Math.abs(On)>ZV&&(On>0?Nn(Sr):Vn(Sr))}le==="hover"&&Bi.set(()=>{At(!1)},X||void 0),_e==null||_e(Sr)},[he,le,Nn,Vn,Bi,X,_e]),ur=X!=null&&!Ye&&!Ct,us=V.useRef();V.useEffect(()=>{var Sr,On;if(!ur)return;const Zr=tt?Nn:Vn;return us.current=window.setInterval(document.visibilityState?Zt:Zr,(Sr=(On=cr.current)!=null?On:X)!=null?Sr:void 0),()=>{us.current!==null&&clearInterval(us.current)}},[ur,Nn,Vn,cr,X,Zt,tt]);const ss=V.useMemo(()=>I&&Array.from({length:hn},(Sr,On)=>Zr=>{N==null||N(On,Zr)}),[I,hn,N]);return T.jsxs(c,{ref:An,...at,onKeyDown:Lr,onMouseOver:Or,onMouseOut:is,onTouchStart:Fr,onTouchMove:Xi,onTouchEnd:ei,className:qn(Ue,yt,y&&"slide",x&&`${yt}-fade`,_t&&`${yt}-${_t}`),children:[I&&T.jsx("div",{className:`${yt}-indicators`,children:LA(Ge,(Sr,On)=>T.jsx("button",{type:"button","data-bs-target":"","aria-label":R!=null&&R.length?R[On]:`Slide ${On+1}`,className:On===st?"active":void 0,onClick:ss?ss[On]:void 0,"aria-current":On===st},On))}),T.jsx("div",{className:`${yt}-inner`,children:LA(Ge,(Sr,On)=>{const Zr=On===st;return y?T.jsx(v1,{in:Zr,onEnter:Zr?Yr:void 0,onEntered:Zr?Xn:void 0,addEndListener:_1,children:(Ki,ho)=>V.cloneElement(Sr,{...ho,className:qn(Sr.props.className,Zr&&Ki!=="entered"&&kr,(Ki==="entered"||Ki==="exiting")&&"active",(Ki==="entering"||Ki==="exiting")&&Gr)})}):V.cloneElement(Sr,{className:qn(Sr.props.className,Zr&&"active")})})}),i&&T.jsxs(T.Fragment,{children:[(pe||k!==0)&&T.jsxs(y_,{className:`${yt}-control-prev`,onClick:Nn,children:[Ce,je&&T.jsx("span",{className:"visually-hidden",children:je})]}),(pe||k!==hn-1)&&T.jsxs(y_,{className:`${yt}-control-next`,onClick:Vn,children:[He,lt&&T.jsx("span",{className:"visually-hidden",children:lt})]})]})]})});ND.displayName="Carousel";const ph=Object.assign(ND,{Caption:zD,Item:FD});function KV({as:e,bsPrefix:n,className:o,...c}){n=sr(n,"col");const d=pD(),y=mD(),x=[],i=[];return d.forEach(I=>{const R=c[I];delete c[I];let k,N,U;typeof R=="object"&&R!=null?{span:k,offset:N,order:U}=R:k=R;const K=I!==y?`-${I}`:"";k&&x.push(k===!0?`${n}${K}`:`${n}${K}-${k}`),U!=null&&i.push(`order${K}-${U}`),N!=null&&i.push(`offset${K}-${N}`)}),[{...c,className:qn(o,...x,...i)},{as:e,bsPrefix:n,spans:x}]}const Un=V.forwardRef((e,n)=>{const[{className:o,...c},{as:d="div",bsPrefix:y,spans:x}]=KV(e);return T.jsx(d,{...c,ref:n,className:qn(o,!x.length&&y)})});Un.displayName="Col";const Ro=V.forwardRef(({bsPrefix:e,fluid:n=!1,as:o="div",className:c,...d},y)=>{const x=sr(e,"container"),i=typeof n=="string"?`-${n}`:"-fluid";return T.jsx(o,{ref:y,...d,className:qn(c,n?`${x}${i}`:x)})});Ro.displayName="Container";var YV=Function.prototype.bind.call(Function.prototype.call,[].slice);function xf(e,n){return YV(e.querySelectorAll(n))}function jD(e,n,o){const c=V.useRef(e!==void 0),[d,y]=V.useState(n),x=e!==void 0,i=c.current;return c.current=x,!x&&i&&d!==n&&y(n),[x?e:d,V.useCallback((...I)=>{const[R,...k]=I;let N=o==null?void 0:o(R,...k);return y(R),N},[o])]}function BD(){const[,e]=V.useReducer(n=>n+1,0);return e}const x1=V.createContext(null);var DA=Object.prototype.hasOwnProperty;function kA(e,n,o){for(o of e.keys())if(sv(o,n))return o}function sv(e,n){var o,c,d;if(e===n)return!0;if(e&&n&&(o=e.constructor)===n.constructor){if(o===Date)return e.getTime()===n.getTime();if(o===RegExp)return e.toString()===n.toString();if(o===Array){if((c=e.length)===n.length)for(;c--&&sv(e[c],n[c]););return c===-1}if(o===Set){if(e.size!==n.size)return!1;for(c of e)if(d=c,d&&typeof d=="object"&&(d=kA(n,d),!d)||!n.has(d))return!1;return!0}if(o===Map){if(e.size!==n.size)return!1;for(c of e)if(d=c[0],d&&typeof d=="object"&&(d=kA(n,d),!d)||!sv(c[1],n.get(d)))return!1;return!0}if(o===ArrayBuffer)e=new Uint8Array(e),n=new Uint8Array(n);else if(o===DataView){if((c=e.byteLength)===n.byteLength)for(;c--&&e.getInt8(c)===n.getInt8(c););return c===-1}if(ArrayBuffer.isView(e)){if((c=e.byteLength)===n.byteLength)for(;c--&&e[c]===n[c];);return c===-1}if(!o||typeof e=="object"){c=0;for(o in e)if(DA.call(e,o)&&++c&&!DA.call(n,o)||!(o in n)||!sv(e[o],n[o]))return!1;return Object.keys(n).length===c}}return e!==e&&n!==n}function JV(e){const n=xD();return[e[0],V.useCallback(o=>{if(n())return e[1](o)},[n,e[1]])]}var Jl="top",wu="bottom",Su="right",Ql="left",JS="auto",jv=[Jl,wu,Su,Ql],v_="start",xv="end",QV="clippingParents",VD="viewport",$y="popper",e8="reference",OA=jv.reduce(function(e,n){return e.concat([n+"-"+v_,n+"-"+xv])},[]),UD=[].concat(jv,[JS]).reduce(function(e,n){return e.concat([n,n+"-"+v_,n+"-"+xv])},[]),t8="beforeRead",n8="read",r8="afterRead",i8="beforeMain",s8="main",o8="afterMain",a8="beforeWrite",l8="write",c8="afterWrite",u8=[t8,n8,r8,i8,s8,o8,a8,l8,c8];function bh(e){return e.split("-")[0]}function Oc(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var n=e.ownerDocument;return n&&n.defaultView||window}return e}function ag(e){var n=Oc(e).Element;return e instanceof n||e instanceof Element}function wh(e){var n=Oc(e).HTMLElement;return e instanceof n||e instanceof HTMLElement}function QS(e){if(typeof ShadowRoot>"u")return!1;var n=Oc(e).ShadowRoot;return e instanceof n||e instanceof ShadowRoot}var rg=Math.max,k0=Math.min,x_=Math.round;function j2(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(n){return n.brand+"/"+n.version}).join(" "):navigator.userAgent}function $D(){return!/^((?!chrome|android).)*safari/i.test(j2())}function b_(e,n,o){n===void 0&&(n=!1),o===void 0&&(o=!1);var c=e.getBoundingClientRect(),d=1,y=1;n&&wh(e)&&(d=e.offsetWidth>0&&x_(c.width)/e.offsetWidth||1,y=e.offsetHeight>0&&x_(c.height)/e.offsetHeight||1);var x=ag(e)?Oc(e):window,i=x.visualViewport,I=!$D()&&o,R=(c.left+(I&&i?i.offsetLeft:0))/d,k=(c.top+(I&&i?i.offsetTop:0))/y,N=c.width/d,U=c.height/y;return{width:N,height:U,top:k,right:R+N,bottom:k+U,left:R,x:R,y:k}}function eC(e){var n=b_(e),o=e.offsetWidth,c=e.offsetHeight;return Math.abs(n.width-o)<=1&&(o=n.width),Math.abs(n.height-c)<=1&&(c=n.height),{x:e.offsetLeft,y:e.offsetTop,width:o,height:c}}function HD(e,n){var o=n.getRootNode&&n.getRootNode();if(e.contains(n))return!0;if(o&&QS(o)){var c=n;do{if(c&&e.isSameNode(c))return!0;c=c.parentNode||c.host}while(c)}return!1}function $p(e){return e?(e.nodeName||"").toLowerCase():null}function Pf(e){return Oc(e).getComputedStyle(e)}function d8(e){return["table","td","th"].indexOf($p(e))>=0}function Qp(e){return((ag(e)?e.ownerDocument:e.document)||window.document).documentElement}function b1(e){return $p(e)==="html"?e:e.assignedSlot||e.parentNode||(QS(e)?e.host:null)||Qp(e)}function zA(e){return!wh(e)||Pf(e).position==="fixed"?null:e.offsetParent}function h8(e){var n=/firefox/i.test(j2()),o=/Trident/i.test(j2());if(o&&wh(e)){var c=Pf(e);if(c.position==="fixed")return null}var d=b1(e);for(QS(d)&&(d=d.host);wh(d)&&["html","body"].indexOf($p(d))<0;){var y=Pf(d);if(y.transform!=="none"||y.perspective!=="none"||y.contain==="paint"||["transform","perspective"].indexOf(y.willChange)!==-1||n&&y.willChange==="filter"||n&&y.filter&&y.filter!=="none")return d;d=d.parentNode}return null}function Bv(e){for(var n=Oc(e),o=zA(e);o&&d8(o)&&Pf(o).position==="static";)o=zA(o);return o&&($p(o)==="html"||$p(o)==="body"&&Pf(o).position==="static")?n:o||h8(e)||n}function tC(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function ov(e,n,o){return rg(e,k0(n,o))}function f8(e,n,o){var c=ov(e,n,o);return c>o?o:c}function GD(){return{top:0,right:0,bottom:0,left:0}}function WD(e){return Object.assign({},GD(),e)}function qD(e,n){return n.reduce(function(o,c){return o[c]=e,o},{})}var p8=function(n,o){return n=typeof n=="function"?n(Object.assign({},o.rects,{placement:o.placement})):n,WD(typeof n!="number"?n:qD(n,jv))};function m8(e){var n,o=e.state,c=e.name,d=e.options,y=o.elements.arrow,x=o.modifiersData.popperOffsets,i=bh(o.placement),I=tC(i),R=[Ql,Su].indexOf(i)>=0,k=R?"height":"width";if(!(!y||!x)){var N=p8(d.padding,o),U=eC(y),K=I==="y"?Jl:Ql,X=I==="y"?wu:Su,Z=o.rects.reference[k]+o.rects.reference[I]-x[I]-o.rects.popper[k],J=x[I]-o.rects.reference[I],le=Bv(y),de=le?I==="y"?le.clientHeight||0:le.clientWidth||0:0,ue=Z/2-J/2,pe=N[K],he=de-U[k]-N[X],xe=de/2-U[k]/2+ue,fe=ov(pe,xe,he),_e=I;o.modifiersData[c]=(n={},n[_e]=fe,n.centerOffset=fe-xe,n)}}function g8(e){var n=e.state,o=e.options,c=o.element,d=c===void 0?"[data-popper-arrow]":c;d!=null&&(typeof d=="string"&&(d=n.elements.popper.querySelector(d),!d)||HD(n.elements.popper,d)&&(n.elements.arrow=d))}const _8={name:"arrow",enabled:!0,phase:"main",fn:m8,effect:g8,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function w_(e){return e.split("-")[1]}var y8={top:"auto",right:"auto",bottom:"auto",left:"auto"};function v8(e,n){var o=e.x,c=e.y,d=n.devicePixelRatio||1;return{x:x_(o*d)/d||0,y:x_(c*d)/d||0}}function FA(e){var n,o=e.popper,c=e.popperRect,d=e.placement,y=e.variation,x=e.offsets,i=e.position,I=e.gpuAcceleration,R=e.adaptive,k=e.roundOffsets,N=e.isFixed,U=x.x,K=U===void 0?0:U,X=x.y,Z=X===void 0?0:X,J=typeof k=="function"?k({x:K,y:Z}):{x:K,y:Z};K=J.x,Z=J.y;var le=x.hasOwnProperty("x"),de=x.hasOwnProperty("y"),ue=Ql,pe=Jl,he=window;if(R){var xe=Bv(o),fe="clientHeight",_e="clientWidth";if(xe===Oc(o)&&(xe=Qp(o),Pf(xe).position!=="static"&&i==="absolute"&&(fe="scrollHeight",_e="scrollWidth")),xe=xe,d===Jl||(d===Ql||d===Su)&&y===xv){pe=wu;var Ce=N&&xe===he&&he.visualViewport?he.visualViewport.height:xe[fe];Z-=Ce-c.height,Z*=I?1:-1}if(d===Ql||(d===Jl||d===wu)&&y===xv){ue=Su;var je=N&&xe===he&&he.visualViewport?he.visualViewport.width:xe[_e];K-=je-c.width,K*=I?1:-1}}var He=Object.assign({position:i},R&&y8),lt=k===!0?v8({x:K,y:Z},Oc(o)):{x:K,y:Z};if(K=lt.x,Z=lt.y,I){var _t;return Object.assign({},He,(_t={},_t[pe]=de?"0":"",_t[ue]=le?"0":"",_t.transform=(he.devicePixelRatio||1)<=1?"translate("+K+"px, "+Z+"px)":"translate3d("+K+"px, "+Z+"px, 0)",_t))}return Object.assign({},He,(n={},n[pe]=de?Z+"px":"",n[ue]=le?K+"px":"",n.transform="",n))}function x8(e){var n=e.state,o=e.options,c=o.gpuAcceleration,d=c===void 0?!0:c,y=o.adaptive,x=y===void 0?!0:y,i=o.roundOffsets,I=i===void 0?!0:i,R={placement:bh(n.placement),variation:w_(n.placement),popper:n.elements.popper,popperRect:n.rects.popper,gpuAcceleration:d,isFixed:n.options.strategy==="fixed"};n.modifiersData.popperOffsets!=null&&(n.styles.popper=Object.assign({},n.styles.popper,FA(Object.assign({},R,{offsets:n.modifiersData.popperOffsets,position:n.options.strategy,adaptive:x,roundOffsets:I})))),n.modifiersData.arrow!=null&&(n.styles.arrow=Object.assign({},n.styles.arrow,FA(Object.assign({},R,{offsets:n.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:I})))),n.attributes.popper=Object.assign({},n.attributes.popper,{"data-popper-placement":n.placement})}const b8={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:x8,data:{}};var t0={passive:!0};function w8(e){var n=e.state,o=e.instance,c=e.options,d=c.scroll,y=d===void 0?!0:d,x=c.resize,i=x===void 0?!0:x,I=Oc(n.elements.popper),R=[].concat(n.scrollParents.reference,n.scrollParents.popper);return y&&R.forEach(function(k){k.addEventListener("scroll",o.update,t0)}),i&&I.addEventListener("resize",o.update,t0),function(){y&&R.forEach(function(k){k.removeEventListener("scroll",o.update,t0)}),i&&I.removeEventListener("resize",o.update,t0)}}const S8={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:w8,data:{}};var C8={left:"right",right:"left",bottom:"top",top:"bottom"};function _0(e){return e.replace(/left|right|bottom|top/g,function(n){return C8[n]})}var T8={start:"end",end:"start"};function NA(e){return e.replace(/start|end/g,function(n){return T8[n]})}function nC(e){var n=Oc(e),o=n.pageXOffset,c=n.pageYOffset;return{scrollLeft:o,scrollTop:c}}function rC(e){return b_(Qp(e)).left+nC(e).scrollLeft}function E8(e,n){var o=Oc(e),c=Qp(e),d=o.visualViewport,y=c.clientWidth,x=c.clientHeight,i=0,I=0;if(d){y=d.width,x=d.height;var R=$D();(R||!R&&n==="fixed")&&(i=d.offsetLeft,I=d.offsetTop)}return{width:y,height:x,x:i+rC(e),y:I}}function I8(e){var n,o=Qp(e),c=nC(e),d=(n=e.ownerDocument)==null?void 0:n.body,y=rg(o.scrollWidth,o.clientWidth,d?d.scrollWidth:0,d?d.clientWidth:0),x=rg(o.scrollHeight,o.clientHeight,d?d.scrollHeight:0,d?d.clientHeight:0),i=-c.scrollLeft+rC(e),I=-c.scrollTop;return Pf(d||o).direction==="rtl"&&(i+=rg(o.clientWidth,d?d.clientWidth:0)-y),{width:y,height:x,x:i,y:I}}function iC(e){var n=Pf(e),o=n.overflow,c=n.overflowX,d=n.overflowY;return/auto|scroll|overlay|hidden/.test(o+d+c)}function ZD(e){return["html","body","#document"].indexOf($p(e))>=0?e.ownerDocument.body:wh(e)&&iC(e)?e:ZD(b1(e))}function av(e,n){var o;n===void 0&&(n=[]);var c=ZD(e),d=c===((o=e.ownerDocument)==null?void 0:o.body),y=Oc(c),x=d?[y].concat(y.visualViewport||[],iC(c)?c:[]):c,i=n.concat(x);return d?i:i.concat(av(b1(x)))}function B2(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function P8(e,n){var o=b_(e,!1,n==="fixed");return o.top=o.top+e.clientTop,o.left=o.left+e.clientLeft,o.bottom=o.top+e.clientHeight,o.right=o.left+e.clientWidth,o.width=e.clientWidth,o.height=e.clientHeight,o.x=o.left,o.y=o.top,o}function jA(e,n,o){return n===VD?B2(E8(e,o)):ag(n)?P8(n,o):B2(I8(Qp(e)))}function A8(e){var n=av(b1(e)),o=["absolute","fixed"].indexOf(Pf(e).position)>=0,c=o&&wh(e)?Bv(e):e;return ag(c)?n.filter(function(d){return ag(d)&&HD(d,c)&&$p(d)!=="body"}):[]}function R8(e,n,o,c){var d=n==="clippingParents"?A8(e):[].concat(n),y=[].concat(d,[o]),x=y[0],i=y.reduce(function(I,R){var k=jA(e,R,c);return I.top=rg(k.top,I.top),I.right=k0(k.right,I.right),I.bottom=k0(k.bottom,I.bottom),I.left=rg(k.left,I.left),I},jA(e,x,c));return i.width=i.right-i.left,i.height=i.bottom-i.top,i.x=i.left,i.y=i.top,i}function XD(e){var n=e.reference,o=e.element,c=e.placement,d=c?bh(c):null,y=c?w_(c):null,x=n.x+n.width/2-o.width/2,i=n.y+n.height/2-o.height/2,I;switch(d){case Jl:I={x,y:n.y-o.height};break;case wu:I={x,y:n.y+n.height};break;case Su:I={x:n.x+n.width,y:i};break;case Ql:I={x:n.x-o.width,y:i};break;default:I={x:n.x,y:n.y}}var R=d?tC(d):null;if(R!=null){var k=R==="y"?"height":"width";switch(y){case v_:I[R]=I[R]-(n[k]/2-o[k]/2);break;case xv:I[R]=I[R]+(n[k]/2-o[k]/2);break}}return I}function bv(e,n){n===void 0&&(n={});var o=n,c=o.placement,d=c===void 0?e.placement:c,y=o.strategy,x=y===void 0?e.strategy:y,i=o.boundary,I=i===void 0?QV:i,R=o.rootBoundary,k=R===void 0?VD:R,N=o.elementContext,U=N===void 0?$y:N,K=o.altBoundary,X=K===void 0?!1:K,Z=o.padding,J=Z===void 0?0:Z,le=WD(typeof J!="number"?J:qD(J,jv)),de=U===$y?e8:$y,ue=e.rects.popper,pe=e.elements[X?de:U],he=R8(ag(pe)?pe:pe.contextElement||Qp(e.elements.popper),I,k,x),xe=b_(e.elements.reference),fe=XD({reference:xe,element:ue,placement:d}),_e=B2(Object.assign({},ue,fe)),Ce=U===$y?_e:xe,je={top:he.top-Ce.top+le.top,bottom:Ce.bottom-he.bottom+le.bottom,left:he.left-Ce.left+le.left,right:Ce.right-he.right+le.right},He=e.modifiersData.offset;if(U===$y&&He){var lt=He[d];Object.keys(je).forEach(function(_t){var Ue=[Su,wu].indexOf(_t)>=0?1:-1,Ge=[Jl,wu].indexOf(_t)>=0?"y":"x";je[_t]+=lt[Ge]*Ue})}return je}function M8(e,n){n===void 0&&(n={});var o=n,c=o.placement,d=o.boundary,y=o.rootBoundary,x=o.padding,i=o.flipVariations,I=o.allowedAutoPlacements,R=I===void 0?UD:I,k=w_(c),N=k?i?OA:OA.filter(function(X){return w_(X)===k}):jv,U=N.filter(function(X){return R.indexOf(X)>=0});U.length===0&&(U=N);var K=U.reduce(function(X,Z){return X[Z]=bv(e,{placement:Z,boundary:d,rootBoundary:y,padding:x})[bh(Z)],X},{});return Object.keys(K).sort(function(X,Z){return K[X]-K[Z]})}function L8(e){if(bh(e)===JS)return[];var n=_0(e);return[NA(e),n,NA(n)]}function D8(e){var n=e.state,o=e.options,c=e.name;if(!n.modifiersData[c]._skip){for(var d=o.mainAxis,y=d===void 0?!0:d,x=o.altAxis,i=x===void 0?!0:x,I=o.fallbackPlacements,R=o.padding,k=o.boundary,N=o.rootBoundary,U=o.altBoundary,K=o.flipVariations,X=K===void 0?!0:K,Z=o.allowedAutoPlacements,J=n.options.placement,le=bh(J),de=le===J,ue=I||(de||!X?[_0(J)]:L8(J)),pe=[J].concat(ue).reduce(function(Ct,We){return Ct.concat(bh(We)===JS?M8(n,{placement:We,boundary:k,rootBoundary:N,padding:R,flipVariations:X,allowedAutoPlacements:Z}):We)},[]),he=n.rects.reference,xe=n.rects.popper,fe=new Map,_e=!0,Ce=pe[0],je=0;je<pe.length;je++){var He=pe[je],lt=bh(He),_t=w_(He)===v_,Ue=[Jl,wu].indexOf(lt)>=0,Ge=Ue?"width":"height",at=bv(n,{placement:He,boundary:k,rootBoundary:N,altBoundary:U,padding:R}),yt=Ue?_t?Su:Ql:_t?wu:Jl;he[Ge]>xe[Ge]&&(yt=_0(yt));var tt=_0(yt),Rt=[];if(y&&Rt.push(at[lt]<=0),i&&Rt.push(at[yt]<=0,at[tt]<=0),Rt.every(function(Ct){return Ct})){Ce=He,_e=!1;break}fe.set(He,Rt)}if(_e)for(var ct=X?3:1,ze=function(We){var st=pe.find(function(Bt){var hn=fe.get(Bt);if(hn)return hn.slice(0,We).every(function(cn){return cn})});if(st)return Ce=st,"break"},Ye=ct;Ye>0;Ye--){var At=ze(Ye);if(At==="break")break}n.placement!==Ce&&(n.modifiersData[c]._skip=!0,n.placement=Ce,n.reset=!0)}}const k8={name:"flip",enabled:!0,phase:"main",fn:D8,requiresIfExists:["offset"],data:{_skip:!1}};function BA(e,n,o){return o===void 0&&(o={x:0,y:0}),{top:e.top-n.height-o.y,right:e.right-n.width+o.x,bottom:e.bottom-n.height+o.y,left:e.left-n.width-o.x}}function VA(e){return[Jl,Su,wu,Ql].some(function(n){return e[n]>=0})}function O8(e){var n=e.state,o=e.name,c=n.rects.reference,d=n.rects.popper,y=n.modifiersData.preventOverflow,x=bv(n,{elementContext:"reference"}),i=bv(n,{altBoundary:!0}),I=BA(x,c),R=BA(i,d,y),k=VA(I),N=VA(R);n.modifiersData[o]={referenceClippingOffsets:I,popperEscapeOffsets:R,isReferenceHidden:k,hasPopperEscaped:N},n.attributes.popper=Object.assign({},n.attributes.popper,{"data-popper-reference-hidden":k,"data-popper-escaped":N})}const z8={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:O8};function F8(e,n,o){var c=bh(e),d=[Ql,Jl].indexOf(c)>=0?-1:1,y=typeof o=="function"?o(Object.assign({},n,{placement:e})):o,x=y[0],i=y[1];return x=x||0,i=(i||0)*d,[Ql,Su].indexOf(c)>=0?{x:i,y:x}:{x,y:i}}function N8(e){var n=e.state,o=e.options,c=e.name,d=o.offset,y=d===void 0?[0,0]:d,x=UD.reduce(function(k,N){return k[N]=F8(N,n.rects,y),k},{}),i=x[n.placement],I=i.x,R=i.y;n.modifiersData.popperOffsets!=null&&(n.modifiersData.popperOffsets.x+=I,n.modifiersData.popperOffsets.y+=R),n.modifiersData[c]=x}const j8={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:N8};function B8(e){var n=e.state,o=e.name;n.modifiersData[o]=XD({reference:n.rects.reference,element:n.rects.popper,placement:n.placement})}const V8={name:"popperOffsets",enabled:!0,phase:"read",fn:B8,data:{}};function U8(e){return e==="x"?"y":"x"}function $8(e){var n=e.state,o=e.options,c=e.name,d=o.mainAxis,y=d===void 0?!0:d,x=o.altAxis,i=x===void 0?!1:x,I=o.boundary,R=o.rootBoundary,k=o.altBoundary,N=o.padding,U=o.tether,K=U===void 0?!0:U,X=o.tetherOffset,Z=X===void 0?0:X,J=bv(n,{boundary:I,rootBoundary:R,padding:N,altBoundary:k}),le=bh(n.placement),de=w_(n.placement),ue=!de,pe=tC(le),he=U8(pe),xe=n.modifiersData.popperOffsets,fe=n.rects.reference,_e=n.rects.popper,Ce=typeof Z=="function"?Z(Object.assign({},n.rects,{placement:n.placement})):Z,je=typeof Ce=="number"?{mainAxis:Ce,altAxis:Ce}:Object.assign({mainAxis:0,altAxis:0},Ce),He=n.modifiersData.offset?n.modifiersData.offset[n.placement]:null,lt={x:0,y:0};if(xe){if(y){var _t,Ue=pe==="y"?Jl:Ql,Ge=pe==="y"?wu:Su,at=pe==="y"?"height":"width",yt=xe[pe],tt=yt+J[Ue],Rt=yt-J[Ge],ct=K?-_e[at]/2:0,ze=de===v_?fe[at]:_e[at],Ye=de===v_?-_e[at]:-fe[at],At=n.elements.arrow,Ct=K&&At?eC(At):{width:0,height:0},We=n.modifiersData["arrow#persistent"]?n.modifiersData["arrow#persistent"].padding:GD(),st=We[Ue],Bt=We[Ge],hn=ov(0,fe[at],Ct[at]),cn=ue?fe[at]/2-ct-hn-st-je.mainAxis:ze-hn-st-je.mainAxis,cr=ue?-fe[at]/2+ct+hn+Bt+je.mainAxis:Ye+hn+Bt+je.mainAxis,Nn=n.elements.arrow&&Bv(n.elements.arrow),Vn=Nn?pe==="y"?Nn.clientTop||0:Nn.clientLeft||0:0,An=(_t=He==null?void 0:He[pe])!=null?_t:0,Zt=yt+cn-An-Vn,mn=yt+cr-An,kr=ov(K?k0(tt,Zt):tt,yt,K?rg(Rt,mn):Rt);xe[pe]=kr,lt[pe]=kr-yt}if(i){var Gr,Yr=pe==="x"?Jl:Ql,Xn=pe==="x"?wu:Su,Lr=xe[he],Or=he==="y"?"height":"width",is=Lr+J[Yr],Zi=Lr-J[Xn],Dr=[Jl,Ql].indexOf(le)!==-1,Bi=(Gr=He==null?void 0:He[he])!=null?Gr:0,Fr=Dr?is:Lr-fe[Or]-_e[Or]-Bi+je.altAxis,Xi=Dr?Lr+fe[Or]+_e[Or]-Bi-je.altAxis:Zi,ei=K&&Dr?f8(Fr,Lr,Xi):ov(K?Fr:is,Lr,K?Xi:Zi);xe[he]=ei,lt[he]=ei-Lr}n.modifiersData[c]=lt}}const H8={name:"preventOverflow",enabled:!0,phase:"main",fn:$8,requiresIfExists:["offset"]};function G8(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function W8(e){return e===Oc(e)||!wh(e)?nC(e):G8(e)}function q8(e){var n=e.getBoundingClientRect(),o=x_(n.width)/e.offsetWidth||1,c=x_(n.height)/e.offsetHeight||1;return o!==1||c!==1}function Z8(e,n,o){o===void 0&&(o=!1);var c=wh(n),d=wh(n)&&q8(n),y=Qp(n),x=b_(e,d,o),i={scrollLeft:0,scrollTop:0},I={x:0,y:0};return(c||!c&&!o)&&(($p(n)!=="body"||iC(y))&&(i=W8(n)),wh(n)?(I=b_(n,!0),I.x+=n.clientLeft,I.y+=n.clientTop):y&&(I.x=rC(y))),{x:x.left+i.scrollLeft-I.x,y:x.top+i.scrollTop-I.y,width:x.width,height:x.height}}function X8(e){var n=new Map,o=new Set,c=[];e.forEach(function(y){n.set(y.name,y)});function d(y){o.add(y.name);var x=[].concat(y.requires||[],y.requiresIfExists||[]);x.forEach(function(i){if(!o.has(i)){var I=n.get(i);I&&d(I)}}),c.push(y)}return e.forEach(function(y){o.has(y.name)||d(y)}),c}function K8(e){var n=X8(e);return u8.reduce(function(o,c){return o.concat(n.filter(function(d){return d.phase===c}))},[])}function Y8(e){var n;return function(){return n||(n=new Promise(function(o){Promise.resolve().then(function(){n=void 0,o(e())})})),n}}function J8(e){var n=e.reduce(function(o,c){var d=o[c.name];return o[c.name]=d?Object.assign({},d,c,{options:Object.assign({},d.options,c.options),data:Object.assign({},d.data,c.data)}):c,o},{});return Object.keys(n).map(function(o){return n[o]})}var UA={placement:"bottom",modifiers:[],strategy:"absolute"};function $A(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return!n.some(function(c){return!(c&&typeof c.getBoundingClientRect=="function")})}function Q8(e){e===void 0&&(e={});var n=e,o=n.defaultModifiers,c=o===void 0?[]:o,d=n.defaultOptions,y=d===void 0?UA:d;return function(i,I,R){R===void 0&&(R=y);var k={placement:"bottom",orderedModifiers:[],options:Object.assign({},UA,y),modifiersData:{},elements:{reference:i,popper:I},attributes:{},styles:{}},N=[],U=!1,K={state:k,setOptions:function(le){var de=typeof le=="function"?le(k.options):le;Z(),k.options=Object.assign({},y,k.options,de),k.scrollParents={reference:ag(i)?av(i):i.contextElement?av(i.contextElement):[],popper:av(I)};var ue=K8(J8([].concat(c,k.options.modifiers)));return k.orderedModifiers=ue.filter(function(pe){return pe.enabled}),X(),K.update()},forceUpdate:function(){if(!U){var le=k.elements,de=le.reference,ue=le.popper;if($A(de,ue)){k.rects={reference:Z8(de,Bv(ue),k.options.strategy==="fixed"),popper:eC(ue)},k.reset=!1,k.placement=k.options.placement,k.orderedModifiers.forEach(function(je){return k.modifiersData[je.name]=Object.assign({},je.data)});for(var pe=0;pe<k.orderedModifiers.length;pe++){if(k.reset===!0){k.reset=!1,pe=-1;continue}var he=k.orderedModifiers[pe],xe=he.fn,fe=he.options,_e=fe===void 0?{}:fe,Ce=he.name;typeof xe=="function"&&(k=xe({state:k,options:_e,name:Ce,instance:K})||k)}}}},update:Y8(function(){return new Promise(function(J){K.forceUpdate(),J(k)})}),destroy:function(){Z(),U=!0}};if(!$A(i,I))return K;K.setOptions(R).then(function(J){!U&&R.onFirstUpdate&&R.onFirstUpdate(J)});function X(){k.orderedModifiers.forEach(function(J){var le=J.name,de=J.options,ue=de===void 0?{}:de,pe=J.effect;if(typeof pe=="function"){var he=pe({state:k,name:le,instance:K,options:ue}),xe=function(){};N.push(he||xe)}})}function Z(){N.forEach(function(J){return J()}),N=[]}return K}}const eU=Q8({defaultModifiers:[z8,V8,b8,S8,j8,k8,H8,_8]}),tU=["enabled","placement","strategy","modifiers"];function nU(e,n){if(e==null)return{};var o={};for(var c in e)if({}.hasOwnProperty.call(e,c)){if(n.indexOf(c)>=0)continue;o[c]=e[c]}return o}const rU={name:"applyStyles",enabled:!1,phase:"afterWrite",fn:()=>{}},iU={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:({state:e})=>()=>{const{reference:n,popper:o}=e.elements;if("removeAttribute"in n){const c=(n.getAttribute("aria-describedby")||"").split(",").filter(d=>d.trim()!==o.id);c.length?n.setAttribute("aria-describedby",c.join(",")):n.removeAttribute("aria-describedby")}},fn:({state:e})=>{var n;const{popper:o,reference:c}=e.elements,d=(n=o.getAttribute("role"))==null?void 0:n.toLowerCase();if(o.id&&d==="tooltip"&&"setAttribute"in c){const y=c.getAttribute("aria-describedby");if(y&&y.split(",").indexOf(o.id)!==-1)return;c.setAttribute("aria-describedby",y?`${y},${o.id}`:o.id)}}},sU=[];function oU(e,n,o={}){let{enabled:c=!0,placement:d="bottom",strategy:y="absolute",modifiers:x=sU}=o,i=nU(o,tU);const I=V.useRef(x),R=V.useRef(),k=V.useCallback(()=>{var J;(J=R.current)==null||J.update()},[]),N=V.useCallback(()=>{var J;(J=R.current)==null||J.forceUpdate()},[]),[U,K]=JV(V.useState({placement:d,update:k,forceUpdate:N,attributes:{},styles:{popper:{},arrow:{}}})),X=V.useMemo(()=>({name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:({state:J})=>{const le={},de={};Object.keys(J.elements).forEach(ue=>{le[ue]=J.styles[ue],de[ue]=J.attributes[ue]}),K({state:J,styles:le,attributes:de,update:k,forceUpdate:N,placement:J.placement})}}),[k,N,K]),Z=V.useMemo(()=>(sv(I.current,x)||(I.current=x),I.current),[x]);return V.useEffect(()=>{!R.current||!c||R.current.setOptions({placement:d,strategy:y,modifiers:[...Z,X,rU]})},[y,d,X,c,Z]),V.useEffect(()=>{if(!(!c||e==null||n==null))return R.current=eU(e,n,Object.assign({},i,{placement:d,strategy:y,modifiers:[...Z,iU,X]})),()=>{R.current!=null&&(R.current.destroy(),R.current=void 0,K(J=>Object.assign({},J,{attributes:{},styles:{popper:{}}})))}},[c,e,n]),U}function O0(e,n){if(e.contains)return e.contains(n);if(e.compareDocumentPosition)return e===n||!!(e.compareDocumentPosition(n)&16)}var zw,HA;function aU(){if(HA)return zw;HA=1;var e=function(){};return zw=e,zw}var lU=aU();const cU=mg(lU),GA=()=>{};function uU(e){return e.button===0}function dU(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}const Fw=e=>e&&("current"in e?e.current:e),WA={click:"mousedown",mouseup:"mousedown",pointerup:"pointerdown"};function hU(e,n=GA,{disabled:o,clickTrigger:c="click"}={}){const d=V.useRef(!1),y=V.useRef(!1),x=V.useCallback(R=>{const k=Fw(e);cU(!!k,"ClickOutside captured a close event but does not have a ref to compare it to. useClickOutside(), should be passed a ref that resolves to a DOM node"),d.current=!k||dU(R)||!uU(R)||!!O0(k,R.target)||y.current,y.current=!1},[e]),i=Ha(R=>{const k=Fw(e);k&&O0(k,R.target)?y.current=!0:y.current=!1}),I=Ha(R=>{d.current||n(R)});V.useEffect(()=>{var R,k;if(o||e==null)return;const N=zv(Fw(e)),U=N.defaultView||window;let K=(R=U.event)!=null?R:(k=U.parent)==null?void 0:k.event,X=null;WA[c]&&(X=jp(N,WA[c],i,!0));const Z=jp(N,c,x,!0),J=jp(N,c,de=>{if(de===K){K=void 0;return}I(de)});let le=[];return"ontouchstart"in N.documentElement&&(le=[].slice.call(N.body.children).map(de=>jp(de,"mousemove",GA))),()=>{X==null||X(),Z(),J(),le.forEach(de=>de())}},[e,o,c,x,i,I])}function fU(e){const n={};return Array.isArray(e)?(e==null||e.forEach(o=>{n[o.name]=o}),n):e||n}function pU(e={}){return Array.isArray(e)?e:Object.keys(e).map(n=>(e[n].name=n,e[n]))}function mU({enabled:e,enableEvents:n,placement:o,flip:c,offset:d,fixed:y,containerPadding:x,arrowElement:i,popperConfig:I={}}){var R,k,N,U,K;const X=fU(I.modifiers);return Object.assign({},I,{placement:o,enabled:e,strategy:y?"fixed":I.strategy,modifiers:pU(Object.assign({},X,{eventListeners:{enabled:n,options:(R=X.eventListeners)==null?void 0:R.options},preventOverflow:Object.assign({},X.preventOverflow,{options:x?Object.assign({padding:x},(k=X.preventOverflow)==null?void 0:k.options):(N=X.preventOverflow)==null?void 0:N.options}),offset:{options:Object.assign({offset:d},(U=X.offset)==null?void 0:U.options)},arrow:Object.assign({},X.arrow,{enabled:!!i,options:Object.assign({},(K=X.arrow)==null?void 0:K.options,{element:i})}),flip:Object.assign({enabled:!!c},X.flip)}))})}const gU=["children","usePopper"];function _U(e,n){if(e==null)return{};var o={};for(var c in e)if({}.hasOwnProperty.call(e,c)){if(n.indexOf(c)>=0)continue;o[c]=e[c]}return o}const yU=()=>{};function KD(e={}){const n=V.useContext(x1),[o,c]=PV(),d=V.useRef(!1),{flip:y,offset:x,rootCloseEvent:i,fixed:I=!1,placement:R,popperConfig:k={},enableEventListeners:N=!0,usePopper:U=!!n}=e,K=(n==null?void 0:n.show)==null?!!e.show:n.show;K&&!d.current&&(d.current=!0);const X=xe=>{n==null||n.toggle(!1,xe)},{placement:Z,setMenu:J,menuElement:le,toggleElement:de}=n||{},ue=oU(de,le,mU({placement:R||Z||"bottom-start",enabled:U,enableEvents:N??K,offset:x,flip:y,fixed:I,arrowElement:o,popperConfig:k})),pe=Object.assign({ref:J||yU,"aria-labelledby":de==null?void 0:de.id},ue.attributes.popper,{style:ue.styles.popper}),he={show:K,placement:Z,hasShown:d.current,toggle:n==null?void 0:n.toggle,popper:U?ue:null,arrowProps:U?Object.assign({ref:c},ue.attributes.arrow,{style:ue.styles.arrow}):{}};return hU(le,X,{clickTrigger:i,disabled:!K}),[pe,he]}function YD(e){let{children:n,usePopper:o=!0}=e,c=_U(e,gU);const[d,y]=KD(Object.assign({},c,{usePopper:o}));return T.jsx(T.Fragment,{children:n(d,y)})}YD.displayName="DropdownMenu";const JD={prefix:String(Math.round(Math.random()*1e10)),current:0},QD=qi.createContext(JD),vU=qi.createContext(!1);let Nw=new WeakMap;function xU(e=!1){let n=V.useContext(QD),o=V.useRef(null);if(o.current===null&&!e){var c,d;let y=(d=qi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED)===null||d===void 0||(c=d.ReactCurrentOwner)===null||c===void 0?void 0:c.current;if(y){let x=Nw.get(y);x==null?Nw.set(y,{id:n.current,state:y.memoizedState}):y.memoizedState!==x.state&&(n.current=x.id,Nw.delete(y))}o.current=++n.current}return o.current}function bU(e){let n=V.useContext(QD),o=xU(!!e),c=`react-aria${n.prefix}`;return e||`${c}-${o}`}function wU(e){let n=qi.useId(),[o]=V.useState(EU()),c=o?"react-aria":`react-aria${JD.prefix}`;return e||`${c}-${n}`}const ek=typeof qi.useId=="function"?wU:bU;function SU(){return!1}function CU(){return!0}function TU(e){return()=>{}}function EU(){return typeof qi.useSyncExternalStore=="function"?qi.useSyncExternalStore(TU,SU,CU):V.useContext(vU)}const tk=e=>{var n;return((n=e.getAttribute("role"))==null?void 0:n.toLowerCase())==="menu"},qA=()=>{};function nk(){const e=ek(),{show:n=!1,toggle:o=qA,setToggle:c,menuElement:d}=V.useContext(x1)||{},y=V.useCallback(i=>{o(!n,i)},[n,o]),x={id:e,ref:c||qA,onClick:y,"aria-expanded":!!n};return d&&tk(d)&&(x["aria-haspopup"]=!0),[x,{show:n,toggle:o}]}function rk({children:e}){const[n,o]=nk();return T.jsx(T.Fragment,{children:e(n,o)})}rk.displayName="DropdownToggle";const Eh=V.createContext(null),Hp=(e,n=null)=>e!=null?String(e):n||null,w1=V.createContext(null);w1.displayName="NavContext";const IU="data-rr-ui-",PU="rrUi";function z_(e){return`${IU}${e}`}function AU(e){return`${PU}${e}`}const RU=["eventKey","disabled","onClick","active","as"];function MU(e,n){if(e==null)return{};var o={};for(var c in e)if({}.hasOwnProperty.call(e,c)){if(n.indexOf(c)>=0)continue;o[c]=e[c]}return o}function ik({key:e,href:n,active:o,disabled:c,onClick:d}){const y=V.useContext(Eh),x=V.useContext(w1),{activeKey:i}=x||{},I=Hp(e,n),R=o==null&&e!=null?Hp(i)===I:o;return[{onClick:Ha(N=>{c||(d==null||d(N),y&&!N.isPropagationStopped()&&y(I,N))}),"aria-disabled":c||void 0,"aria-selected":R,[z_("dropdown-item")]:""},{isActive:R}]}const sk=V.forwardRef((e,n)=>{let{eventKey:o,disabled:c,onClick:d,active:y,as:x=XS}=e,i=MU(e,RU);const[I]=ik({key:o,href:i.href,disabled:c,onClick:d,active:y});return T.jsx(x,Object.assign({},i,{ref:n},I))});sk.displayName="DropdownItem";const ok=V.createContext(O_?window:void 0);ok.Provider;function S1(){return V.useContext(ok)}function ZA(){const e=BD(),n=V.useRef(null),o=V.useCallback(c=>{n.current=c,e()},[e]);return[n,o]}function Vv({defaultShow:e,show:n,onSelect:o,onToggle:c,itemSelector:d=`* [${z_("dropdown-item")}]`,focusFirstItemOnShow:y,placement:x="bottom-start",children:i}){const I=S1(),[R,k]=jD(n,e,c),[N,U]=ZA(),K=N.current,[X,Z]=ZA(),J=X.current,le=bD(R),de=V.useRef(null),ue=V.useRef(!1),pe=V.useContext(Eh),he=V.useCallback((He,lt,_t=lt==null?void 0:lt.type)=>{k(He,{originalEvent:lt,source:_t})},[k]),xe=Ha((He,lt)=>{o==null||o(He,lt),he(!1,lt,"select"),lt.isPropagationStopped()||pe==null||pe(He,lt)}),fe=V.useMemo(()=>({toggle:he,placement:x,show:R,menuElement:K,toggleElement:J,setMenu:U,setToggle:Z}),[he,x,R,K,J,U,Z]);K&&le&&!R&&(ue.current=K.contains(K.ownerDocument.activeElement));const _e=Ha(()=>{J&&J.focus&&J.focus()}),Ce=Ha(()=>{const He=de.current;let lt=y;if(lt==null&&(lt=N.current&&tk(N.current)?"keyboard":!1),lt===!1||lt==="keyboard"&&!/^key.+$/.test(He))return;const _t=xf(N.current,d)[0];_t&&_t.focus&&_t.focus()});V.useEffect(()=>{R?Ce():ue.current&&(ue.current=!1,_e())},[R,ue,_e,Ce]),V.useEffect(()=>{de.current=null});const je=(He,lt)=>{if(!N.current)return null;const _t=xf(N.current,d);let Ue=_t.indexOf(He)+lt;return Ue=Math.max(0,Math.min(Ue,_t.length)),_t[Ue]};return RV(V.useCallback(()=>I.document,[I]),"keydown",He=>{var lt,_t;const{key:Ue}=He,Ge=He.target,at=(lt=N.current)==null?void 0:lt.contains(Ge),yt=(_t=X.current)==null?void 0:_t.contains(Ge);if(/input|textarea/i.test(Ge.tagName)&&(Ue===" "||Ue!=="Escape"&&at||Ue==="Escape"&&Ge.type==="search")||!at&&!yt||Ue==="Tab"&&(!N.current||!R))return;de.current=He.type;const Rt={originalEvent:He,source:He.type};switch(Ue){case"ArrowUp":{const ct=je(Ge,-1);ct&&ct.focus&&ct.focus(),He.preventDefault();return}case"ArrowDown":if(He.preventDefault(),!R)k(!0,Rt);else{const ct=je(Ge,1);ct&&ct.focus&&ct.focus()}return;case"Tab":WS(Ge.ownerDocument,"keyup",ct=>{var ze;(ct.key==="Tab"&&!ct.target||!((ze=N.current)!=null&&ze.contains(ct.target)))&&k(!1,Rt)},{once:!0});break;case"Escape":Ue==="Escape"&&(He.preventDefault(),He.stopPropagation()),k(!1,Rt);break}}),T.jsx(Eh.Provider,{value:xe,children:T.jsx(x1.Provider,{value:fe,children:i})})}Vv.displayName="Dropdown";Vv.Menu=YD;Vv.Toggle=rk;Vv.Item=sk;const sC=V.createContext({});sC.displayName="DropdownContext";const ak=V.forwardRef(({className:e,bsPrefix:n,as:o="hr",role:c="separator",...d},y)=>(n=sr(n,"dropdown-divider"),T.jsx(o,{ref:y,className:qn(e,n),role:c,...d})));ak.displayName="DropdownDivider";const lk=V.forwardRef(({className:e,bsPrefix:n,as:o="div",role:c="heading",...d},y)=>(n=sr(n,"dropdown-header"),T.jsx(o,{ref:y,className:qn(e,n),role:c,...d})));lk.displayName="DropdownHeader";const ck=V.forwardRef(({bsPrefix:e,className:n,eventKey:o,disabled:c=!1,onClick:d,active:y,as:x=y_,...i},I)=>{const R=sr(e,"dropdown-item"),[k,N]=ik({key:o,href:i.href,disabled:c,onClick:d,active:y});return T.jsx(x,{...i,...k,ref:I,className:qn(n,R,N.isActive&&"active",c&&"disabled")})});ck.displayName="DropdownItem";const uk=V.forwardRef(({className:e,bsPrefix:n,as:o="span",...c},d)=>(n=sr(n,"dropdown-item-text"),T.jsx(o,{ref:d,className:qn(e,n),...c})));uk.displayName="DropdownItemText";const LU=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",DU=typeof document<"u",dk=DU||LU?V.useLayoutEffect:V.useEffect,C1=V.createContext(null);C1.displayName="InputGroupContext";const _g=V.createContext(null);_g.displayName="NavbarContext";function hk(e,n){return e}function fk(e,n,o){const c=o?"top-end":"top-start",d=o?"top-start":"top-end",y=o?"bottom-end":"bottom-start",x=o?"bottom-start":"bottom-end",i=o?"right-start":"left-start",I=o?"right-end":"left-end",R=o?"left-start":"right-start",k=o?"left-end":"right-end";let N=e?x:y;return n==="up"?N=e?d:c:n==="end"?N=e?k:R:n==="start"?N=e?I:i:n==="down-centered"?N="bottom":n==="up-centered"&&(N="top"),N}const pk=V.forwardRef(({bsPrefix:e,className:n,align:o,rootCloseEvent:c,flip:d=!0,show:y,renderOnMount:x,as:i="div",popperConfig:I,variant:R,...k},N)=>{let U=!1;const K=V.useContext(_g),X=sr(e,"dropdown-menu"),{align:Z,drop:J,isRTL:le}=V.useContext(sC);o=o||Z;const de=V.useContext(C1),ue=[];if(o)if(typeof o=="object"){const He=Object.keys(o);if(He.length){const lt=He[0],_t=o[lt];U=_t==="start",ue.push(`${X}-${lt}-${_t}`)}}else o==="end"&&(U=!0);const pe=fk(U,J,le),[he,{hasShown:xe,popper:fe,show:_e,toggle:Ce}]=KD({flip:d,rootCloseEvent:c,show:y,usePopper:!K&&ue.length===0,offset:[0,2],popperConfig:I,placement:pe});if(he.ref=y1(hk(N),he.ref),dk(()=>{_e&&(fe==null||fe.update())},[_e]),!xe&&!x&&!de)return null;typeof i!="string"&&(he.show=_e,he.close=()=>Ce==null?void 0:Ce(!1),he.align=o);let je=k.style;return fe!=null&&fe.placement&&(je={...k.style,...he.style},k["x-placement"]=fe.placement),T.jsx(i,{...k,...he,style:je,...(ue.length||K)&&{"data-bs-popper":"static"},className:qn(n,X,_e&&"show",U&&`${X}-end`,R&&`${X}-${R}`,...ue)})});pk.displayName="DropdownMenu";const mk=V.forwardRef(({bsPrefix:e,split:n,className:o,childBsPrefix:c,as:d=Qn,...y},x)=>{const i=sr(e,"dropdown-toggle"),I=V.useContext(x1);c!==void 0&&(y.bsPrefix=c);const[R]=nk();return R.ref=y1(R.ref,hk(x)),T.jsx(d,{className:qn(o,i,n&&`${i}-split`,(I==null?void 0:I.show)&&"show"),...R,...y})});mk.displayName="DropdownToggle";const gk=V.forwardRef((e,n)=>{const{bsPrefix:o,drop:c="down",show:d,className:y,align:x="start",onSelect:i,onToggle:I,focusFirstItemOnShow:R,as:k="div",navbar:N,autoClose:U=!0,...K}=D_(e,{show:"onToggle"}),X=V.useContext(C1),Z=sr(o,"dropdown"),J=GS(),le=fe=>U===!1?fe==="click":U==="inside"?fe!=="rootClose":U==="outside"?fe!=="select":!0,de=bu((fe,_e)=>{var Ce;!((Ce=_e.originalEvent)==null||(Ce=Ce.target)==null)&&Ce.classList.contains("dropdown-toggle")&&_e.source==="mousedown"||(_e.originalEvent.currentTarget===document&&(_e.source!=="keydown"||_e.originalEvent.key==="Escape")&&(_e.source="rootClose"),le(_e.source)&&(I==null||I(fe,_e)))}),pe=fk(x==="end",c,J),he=V.useMemo(()=>({align:x,drop:c,isRTL:J}),[x,c,J]),xe={down:Z,"down-centered":`${Z}-center`,up:"dropup","up-centered":"dropup-center dropup",end:"dropend",start:"dropstart"};return T.jsx(sC.Provider,{value:he,children:T.jsx(Vv,{placement:pe,show:d,onSelect:i,onToggle:de,focusFirstItemOnShow:R,itemSelector:`.${Z}-item:not(.disabled):not(:disabled)`,children:X?K.children:T.jsx(k,{...K,ref:n,className:qn(y,d&&"show",xe[c])})})})});gk.displayName="Dropdown";const wf=Object.assign(gk,{Toggle:mk,Menu:pk,Item:ck,ItemText:uk,Divider:ak,Header:lk}),kU={type:$a.string,tooltip:$a.bool,as:$a.elementType},T1=V.forwardRef(({as:e="div",className:n,type:o="valid",tooltip:c=!1,...d},y)=>T.jsx(e,{...d,ref:y,className:qn(n,`${o}-${c?"tooltip":"feedback"}`)}));T1.displayName="Feedback";T1.propTypes=kU;const Af=V.createContext({}),Uv=V.forwardRef(({id:e,bsPrefix:n,className:o,type:c="checkbox",isValid:d=!1,isInvalid:y=!1,as:x="input",...i},I)=>{const{controlId:R}=V.useContext(Af);return n=sr(n,"form-check-input"),T.jsx(x,{...i,ref:I,type:c,id:e||R,className:qn(o,n,d&&"is-valid",y&&"is-invalid")})});Uv.displayName="FormCheckInput";const z0=V.forwardRef(({bsPrefix:e,className:n,htmlFor:o,...c},d)=>{const{controlId:y}=V.useContext(Af);return e=sr(e,"form-check-label"),T.jsx("label",{...c,ref:d,htmlFor:o||y,className:qn(n,e)})});z0.displayName="FormCheckLabel";const _k=V.forwardRef(({id:e,bsPrefix:n,bsSwitchPrefix:o,inline:c=!1,reverse:d=!1,disabled:y=!1,isValid:x=!1,isInvalid:i=!1,feedbackTooltip:I=!1,feedback:R,feedbackType:k,className:N,style:U,title:K="",type:X="checkbox",label:Z,children:J,as:le="input",...de},ue)=>{n=sr(n,"form-check"),o=sr(o,"form-switch");const{controlId:pe}=V.useContext(Af),he=V.useMemo(()=>({controlId:e||pe}),[pe,e]),xe=!J&&Z!=null&&Z!==!1||qV(J,z0),fe=T.jsx(Uv,{...de,type:X==="switch"?"checkbox":X,ref:ue,isValid:x,isInvalid:i,disabled:y,as:le});return T.jsx(Af.Provider,{value:he,children:T.jsx("div",{style:U,className:qn(N,xe&&n,c&&`${n}-inline`,d&&`${n}-reverse`,X==="switch"&&o),children:J||T.jsxs(T.Fragment,{children:[fe,xe&&T.jsx(z0,{title:K,children:Z}),R&&T.jsx(T1,{type:k,tooltip:I,children:R})]})})})});_k.displayName="FormCheck";const F0=Object.assign(_k,{Input:Uv,Label:z0}),yk=V.forwardRef(({bsPrefix:e,type:n,size:o,htmlSize:c,id:d,className:y,isValid:x=!1,isInvalid:i=!1,plaintext:I,readOnly:R,as:k="input",...N},U)=>{const{controlId:K}=V.useContext(Af);return e=sr(e,"form-control"),T.jsx(k,{...N,type:n,size:c,ref:U,readOnly:R,id:d||K,className:qn(y,I?`${e}-plaintext`:e,o&&`${e}-${o}`,n==="color"&&`${e}-color`,x&&"is-valid",i&&"is-invalid")})});yk.displayName="FormControl";const OU=Object.assign(yk,{Feedback:T1}),vk=V.forwardRef(({className:e,bsPrefix:n,as:o="div",...c},d)=>(n=sr(n,"form-floating"),T.jsx(o,{ref:d,className:qn(e,n),...c})));vk.displayName="FormFloating";const oC=V.forwardRef(({controlId:e,as:n="div",...o},c)=>{const d=V.useMemo(()=>({controlId:e}),[e]);return T.jsx(Af.Provider,{value:d,children:T.jsx(n,{...o,ref:c})})});oC.displayName="FormGroup";const xk=V.forwardRef(({as:e="label",bsPrefix:n,column:o=!1,visuallyHidden:c=!1,className:d,htmlFor:y,...x},i)=>{const{controlId:I}=V.useContext(Af);n=sr(n,"form-label");let R="col-form-label";typeof o=="string"&&(R=`${R} ${R}-${o}`);const k=qn(d,n,c&&"visually-hidden",o&&R);return y=y||I,o?T.jsx(Un,{ref:i,as:"label",className:k,htmlFor:y,...x}):T.jsx(e,{ref:i,className:k,htmlFor:y,...x})});xk.displayName="FormLabel";const bk=V.forwardRef(({bsPrefix:e,className:n,id:o,...c},d)=>{const{controlId:y}=V.useContext(Af);return e=sr(e,"form-range"),T.jsx("input",{...c,type:"range",ref:d,className:qn(n,e),id:o||y})});bk.displayName="FormRange";const wk=V.forwardRef(({bsPrefix:e,size:n,htmlSize:o,className:c,isValid:d=!1,isInvalid:y=!1,id:x,...i},I)=>{const{controlId:R}=V.useContext(Af);return e=sr(e,"form-select"),T.jsx("select",{...i,size:o,ref:I,className:qn(c,e,n&&`${e}-${n}`,d&&"is-valid",y&&"is-invalid"),id:x||R})});wk.displayName="FormSelect";const Sk=V.forwardRef(({bsPrefix:e,className:n,as:o="small",muted:c,...d},y)=>(e=sr(e,"form-text"),T.jsx(o,{...d,ref:y,className:qn(n,e,c&&"text-muted")})));Sk.displayName="FormText";const Ck=V.forwardRef((e,n)=>T.jsx(F0,{...e,ref:n,type:"switch"}));Ck.displayName="Switch";const zU=Object.assign(Ck,{Input:F0.Input,Label:F0.Label}),Tk=V.forwardRef(({bsPrefix:e,className:n,children:o,controlId:c,label:d,...y},x)=>(e=sr(e,"form-floating"),T.jsxs(oC,{ref:x,className:qn(n,e),controlId:c,...y,children:[o,T.jsx("label",{htmlFor:c,children:d})]})));Tk.displayName="FloatingLabel";const FU={_ref:$a.any,validated:$a.bool,as:$a.elementType},aC=V.forwardRef(({className:e,validated:n,as:o="form",...c},d)=>T.jsx(o,{...c,ref:d,className:qn(e,n&&"was-validated")}));aC.displayName="Form";aC.propTypes=FU;const ot=Object.assign(aC,{Group:oC,Control:OU,Floating:vk,Check:F0,Switch:zU,Label:xk,Text:Sk,Range:bk,Select:wk,FloatingLabel:Tk}),E1=V.forwardRef(({className:e,bsPrefix:n,as:o="span",...c},d)=>(n=sr(n,"input-group-text"),T.jsx(o,{ref:d,className:qn(e,n),...c})));E1.displayName="InputGroupText";const NU=e=>T.jsx(E1,{children:T.jsx(Uv,{type:"checkbox",...e})}),jU=e=>T.jsx(E1,{children:T.jsx(Uv,{type:"radio",...e})}),Ek=V.forwardRef(({bsPrefix:e,size:n,hasValidation:o,className:c,as:d="div",...y},x)=>{e=sr(e,"input-group");const i=V.useMemo(()=>({}),[]);return T.jsx(C1.Provider,{value:i,children:T.jsx(d,{ref:x,...y,className:qn(c,e,n&&`${e}-${n}`,o&&"has-validation")})})});Ek.displayName="InputGroup";const V2=Object.assign(Ek,{Text:E1,Radio:jU,Checkbox:NU}),XA=e=>!e||typeof e=="function"?e:n=>{e.current=n};function BU(e,n){const o=XA(e),c=XA(n);return d=>{o&&o(d),c&&c(d)}}function I1(e,n){return V.useMemo(()=>BU(e,n),[e,n])}const F_=V.createContext(null),VU=["as","active","eventKey"];function UU(e,n){if(e==null)return{};var o={};for(var c in e)if({}.hasOwnProperty.call(e,c)){if(n.indexOf(c)>=0)continue;o[c]=e[c]}return o}function lC({key:e,onClick:n,active:o,id:c,role:d,disabled:y}){const x=V.useContext(Eh),i=V.useContext(w1),I=V.useContext(F_);let R=o;const k={role:d};if(i){!d&&i.role==="tablist"&&(k.role="tab");const N=i.getControllerId(e??null),U=i.getControlledId(e??null);k[z_("event-key")]=e,k.id=N||c,R=o==null&&e!=null?i.activeKey===e:o,(R||!(I!=null&&I.unmountOnExit)&&!(I!=null&&I.mountOnEnter))&&(k["aria-controls"]=U)}return k.role==="tab"&&(k["aria-selected"]=R,R||(k.tabIndex=-1),y&&(k.tabIndex=-1,k["aria-disabled"]=!0)),k.onClick=Ha(N=>{y||(n==null||n(N),e!=null&&x&&!N.isPropagationStopped()&&x(e,N))}),[k,{isActive:R}]}const Ik=V.forwardRef((e,n)=>{let{as:o=XS,active:c,eventKey:d}=e,y=UU(e,VU);const[x,i]=lC(Object.assign({key:Hp(d,y.href),active:c},y));return x[z_("active")]=i.isActive,T.jsx(o,Object.assign({},y,x,{ref:n}))});Ik.displayName="NavItem";const $U=["as","onSelect","activeKey","role","onKeyDown"];function HU(e,n){if(e==null)return{};var o={};for(var c in e)if({}.hasOwnProperty.call(e,c)){if(n.indexOf(c)>=0)continue;o[c]=e[c]}return o}const KA=()=>{},YA=z_("event-key"),Pk=V.forwardRef((e,n)=>{let{as:o="div",onSelect:c,activeKey:d,role:y,onKeyDown:x}=e,i=HU(e,$U);const I=BD(),R=V.useRef(!1),k=V.useContext(Eh),N=V.useContext(F_);let U,K;N&&(y=y||"tablist",d=N.activeKey,U=N.getControlledId,K=N.getControllerId);const X=V.useRef(null),Z=ue=>{const pe=X.current;if(!pe)return null;const he=xf(pe,`[${YA}]:not([aria-disabled=true])`),xe=pe.querySelector("[aria-selected=true]");if(!xe||xe!==document.activeElement)return null;const fe=he.indexOf(xe);if(fe===-1)return null;let _e=fe+ue;return _e>=he.length&&(_e=0),_e<0&&(_e=he.length-1),he[_e]},J=(ue,pe)=>{ue!=null&&(c==null||c(ue,pe),k==null||k(ue,pe))},le=ue=>{if(x==null||x(ue),!N)return;let pe;switch(ue.key){case"ArrowLeft":case"ArrowUp":pe=Z(-1);break;case"ArrowRight":case"ArrowDown":pe=Z(1);break;default:return}pe&&(ue.preventDefault(),J(pe.dataset[AU("EventKey")]||null,ue),R.current=!0,I())};V.useEffect(()=>{if(X.current&&R.current){const ue=X.current.querySelector(`[${YA}][aria-selected=true]`);ue==null||ue.focus()}R.current=!1});const de=I1(n,X);return T.jsx(Eh.Provider,{value:J,children:T.jsx(w1.Provider,{value:{role:y,activeKey:Hp(d),getControlledId:U||KA,getControllerId:K||KA},children:T.jsx(o,Object.assign({},i,{onKeyDown:le,ref:de,role:y}))})})});Pk.displayName="Nav";const Ak=Object.assign(Pk,{Item:Ik}),Rk=V.forwardRef(({bsPrefix:e,active:n,disabled:o,eventKey:c,className:d,variant:y,action:x,as:i,...I},R)=>{e=sr(e,"list-group-item");const[k,N]=lC({key:Hp(c,I.href),active:n,...I}),U=bu(X=>{if(o){X.preventDefault(),X.stopPropagation();return}k.onClick(X)});o&&I.tabIndex===void 0&&(I.tabIndex=-1,I["aria-disabled"]=!0);const K=i||(x?I.href?"a":"button":"div");return T.jsx(K,{ref:R,...I,...k,onClick:U,className:qn(d,e,N.isActive&&"active",o&&"disabled",y&&`${e}-${y}`,x&&`${e}-action`)})});Rk.displayName="ListGroupItem";const Mk=V.forwardRef((e,n)=>{const{className:o,bsPrefix:c,variant:d,horizontal:y,numbered:x,as:i="div",...I}=D_(e,{activeKey:"onSelect"}),R=sr(c,"list-group");let k;return y&&(k=y===!0?"horizontal":`horizontal-${y}`),T.jsx(Ak,{ref:n,...I,as:i,className:qn(o,R,d&&`${R}-${d}`,k&&`${R}-${k}`,x&&`${R}-numbered`)})});Mk.displayName="ListGroup";const hd=Object.assign(Mk,{Item:Rk});var n0;function JA(e){if((!n0&&n0!==0||e)&&O_){var n=document.createElement("div");n.style.position="absolute",n.style.top="-9999px",n.style.width="50px",n.style.height="50px",n.style.overflow="scroll",document.body.appendChild(n),n0=n.offsetWidth-n.clientWidth,document.body.removeChild(n)}return n0}function GU(){return V.useState(null)}function jw(e){e===void 0&&(e=zv());try{var n=e.activeElement;return!n||!n.nodeName?null:n}catch{return e.body}}function WU(e){const n=V.useRef(e);return n.current=e,n}function qU(e){const n=WU(e);V.useEffect(()=>()=>n.current(),[])}function ZU(e=document){const n=e.defaultView;return Math.abs(n.innerWidth-e.documentElement.clientWidth)}const QA=z_("modal-open");let cC=class{constructor({ownerDocument:n,handleContainerOverflow:o=!0,isRTL:c=!1}={}){this.handleContainerOverflow=o,this.isRTL=c,this.modals=[],this.ownerDocument=n}getScrollbarWidth(){return ZU(this.ownerDocument)}getElement(){return(this.ownerDocument||document).body}setModalAttributes(n){}removeModalAttributes(n){}setContainerStyle(n){const o={overflow:"hidden"},c=this.isRTL?"paddingLeft":"paddingRight",d=this.getElement();n.style={overflow:d.style.overflow,[c]:d.style[c]},n.scrollBarWidth&&(o[c]=`${parseInt(Sf(d,c)||"0",10)+n.scrollBarWidth}px`),d.setAttribute(QA,""),Sf(d,o)}reset(){[...this.modals].forEach(n=>this.remove(n))}removeContainerStyle(n){const o=this.getElement();o.removeAttribute(QA),Object.assign(o.style,n.style)}add(n){let o=this.modals.indexOf(n);return o!==-1||(o=this.modals.length,this.modals.push(n),this.setModalAttributes(n),o!==0)||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state)),o}remove(n){const o=this.modals.indexOf(n);o!==-1&&(this.modals.splice(o,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(n))}isTopModal(n){return!!this.modals.length&&this.modals[this.modals.length-1]===n}};const Bw=(e,n)=>O_?e==null?(n||zv()).body:(typeof e=="function"&&(e=e()),e&&"current"in e&&(e=e.current),e&&("nodeType"in e||e.getBoundingClientRect)?e:null):null;function XU(e,n){const o=S1(),[c,d]=V.useState(()=>Bw(e,o==null?void 0:o.document));if(!c){const y=Bw(e);y&&d(y)}return V.useEffect(()=>{},[n,c]),V.useEffect(()=>{const y=Bw(e);y!==c&&d(y)},[e,c]),c}function uC({children:e,in:n,onExited:o,mountOnEnter:c,unmountOnExit:d}){const y=V.useRef(null),x=V.useRef(n),i=Ha(o);V.useEffect(()=>{n?x.current=!0:i(y.current)},[n,i]);const I=I1(y,k_(e)),R=V.cloneElement(e,{ref:I});return n?R:d||!x.current&&c?null:R}const KU=["onEnter","onEntering","onEntered","onExit","onExiting","onExited","addEndListener","children"];function YU(e,n){if(e==null)return{};var o={};for(var c in e)if({}.hasOwnProperty.call(e,c)){if(n.indexOf(c)>=0)continue;o[c]=e[c]}return o}function JU(e){let{onEnter:n,onEntering:o,onEntered:c,onExit:d,onExiting:y,onExited:x,addEndListener:i,children:I}=e,R=YU(e,KU);const k=V.useRef(null),N=I1(k,k_(I)),U=pe=>he=>{pe&&k.current&&pe(k.current,he)},K=V.useCallback(U(n),[n]),X=V.useCallback(U(o),[o]),Z=V.useCallback(U(c),[c]),J=V.useCallback(U(d),[d]),le=V.useCallback(U(y),[y]),de=V.useCallback(U(x),[x]),ue=V.useCallback(U(i),[i]);return Object.assign({},R,{nodeRef:k},n&&{onEnter:K},o&&{onEntering:X},c&&{onEntered:Z},d&&{onExit:J},y&&{onExiting:le},x&&{onExited:de},i&&{addEndListener:ue},{children:typeof I=="function"?(pe,he)=>I(pe,Object.assign({},he,{ref:N})):V.cloneElement(I,{ref:N})})}const QU=["component"];function e$(e,n){if(e==null)return{};var o={};for(var c in e)if({}.hasOwnProperty.call(e,c)){if(n.indexOf(c)>=0)continue;o[c]=e[c]}return o}const t$=V.forwardRef((e,n)=>{let{component:o}=e,c=e$(e,QU);const d=JU(c);return T.jsx(o,Object.assign({ref:n},d))});function n$({in:e,onTransition:n}){const o=V.useRef(null),c=V.useRef(!0),d=Ha(n);return MA(()=>{if(!o.current)return;let y=!1;return d({in:e,element:o.current,initial:c.current,isStale:()=>y}),()=>{y=!0}},[e,d]),MA(()=>(c.current=!1,()=>{c.current=!0}),[]),o}function r$({children:e,in:n,onExited:o,onEntered:c,transition:d}){const[y,x]=V.useState(!n);n&&y&&x(!1);const i=n$({in:!!n,onTransition:R=>{const k=()=>{R.isStale()||(R.in?c==null||c(R.element,R.initial):(x(!0),o==null||o(R.element)))};Promise.resolve(d(R)).then(k,N=>{throw R.in||x(!0),N})}}),I=I1(i,k_(e));return y&&!n?null:V.cloneElement(e,{ref:I})}function eR(e,n,o){return e?T.jsx(t$,Object.assign({},o,{component:e})):n?T.jsx(r$,Object.assign({},o,{transition:n})):T.jsx(uC,Object.assign({},o))}const i$=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","runTransition","backdropTransition","runBackdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];function s$(e,n){if(e==null)return{};var o={};for(var c in e)if({}.hasOwnProperty.call(e,c)){if(n.indexOf(c)>=0)continue;o[c]=e[c]}return o}let Vw;function o$(e){return Vw||(Vw=new cC({ownerDocument:e==null?void 0:e.document})),Vw}function a$(e){const n=S1(),o=e||o$(n),c=V.useRef({dialog:null,backdrop:null});return Object.assign(c.current,{add:()=>o.add(c.current),remove:()=>o.remove(c.current),isTopModal:()=>o.isTopModal(c.current),setDialogRef:V.useCallback(d=>{c.current.dialog=d},[]),setBackdropRef:V.useCallback(d=>{c.current.backdrop=d},[])})}const Lk=V.forwardRef((e,n)=>{let{show:o=!1,role:c="dialog",className:d,style:y,children:x,backdrop:i=!0,keyboard:I=!0,onBackdropClick:R,onEscapeKeyDown:k,transition:N,runTransition:U,backdropTransition:K,runBackdropTransition:X,autoFocus:Z=!0,enforceFocus:J=!0,restoreFocus:le=!0,restoreFocusOptions:de,renderDialog:ue,renderBackdrop:pe=mn=>T.jsx("div",Object.assign({},mn)),manager:he,container:xe,onShow:fe,onHide:_e=()=>{},onExit:Ce,onExited:je,onExiting:He,onEnter:lt,onEntering:_t,onEntered:Ue}=e,Ge=s$(e,i$);const at=S1(),yt=XU(xe),tt=a$(he),Rt=xD(),ct=bD(o),[ze,Ye]=V.useState(!o),At=V.useRef(null);V.useImperativeHandle(n,()=>tt,[tt]),O_&&!ct&&o&&(At.current=jw(at==null?void 0:at.document)),o&&ze&&Ye(!1);const Ct=Ha(()=>{if(tt.add(),cr.current=jp(document,"keydown",hn),cn.current=jp(document,"focus",()=>setTimeout(st),!0),fe&&fe(),Z){var mn,kr;const Gr=jw((mn=(kr=tt.dialog)==null?void 0:kr.ownerDocument)!=null?mn:at==null?void 0:at.document);tt.dialog&&Gr&&!O0(tt.dialog,Gr)&&(At.current=Gr,tt.dialog.focus())}}),We=Ha(()=>{if(tt.remove(),cr.current==null||cr.current(),cn.current==null||cn.current(),le){var mn;(mn=At.current)==null||mn.focus==null||mn.focus(de),At.current=null}});V.useEffect(()=>{!o||!yt||Ct()},[o,yt,Ct]),V.useEffect(()=>{ze&&We()},[ze,We]),qU(()=>{We()});const st=Ha(()=>{if(!J||!Rt()||!tt.isTopModal())return;const mn=jw(at==null?void 0:at.document);tt.dialog&&mn&&!O0(tt.dialog,mn)&&tt.dialog.focus()}),Bt=Ha(mn=>{mn.target===mn.currentTarget&&(R==null||R(mn),i===!0&&_e())}),hn=Ha(mn=>{I&&_V(mn)&&tt.isTopModal()&&(k==null||k(mn),mn.defaultPrevented||_e())}),cn=V.useRef(),cr=V.useRef(),Nn=(...mn)=>{Ye(!0),je==null||je(...mn)};if(!yt)return null;const Vn=Object.assign({role:c,ref:tt.setDialogRef,"aria-modal":c==="dialog"?!0:void 0},Ge,{style:y,className:d,tabIndex:-1});let An=ue?ue(Vn):T.jsx("div",Object.assign({},Vn,{children:V.cloneElement(x,{role:"document"})}));An=eR(N,U,{unmountOnExit:!0,mountOnEnter:!0,appear:!0,in:!!o,onExit:Ce,onExiting:He,onExited:Nn,onEnter:lt,onEntering:_t,onEntered:Ue,children:An});let Zt=null;return i&&(Zt=pe({ref:tt.setBackdropRef,onClick:Bt}),Zt=eR(K,X,{in:!!o,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:Zt})),T.jsx(T.Fragment,{children:l_.createPortal(T.jsxs(T.Fragment,{children:[Zt,An]}),yt)})});Lk.displayName="Modal";const Dk=Object.assign(Lk,{Manager:cC});function l$(e,n){return e.classList?e.classList.contains(n):(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+n+" ")!==-1}function c$(e,n){e.classList?e.classList.add(n):l$(e,n)||(typeof e.className=="string"?e.className=e.className+" "+n:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+n))}function tR(e,n){return e.replace(new RegExp("(^|\\s)"+n+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function u$(e,n){e.classList?e.classList.remove(n):typeof e.className=="string"?e.className=tR(e.className,n):e.setAttribute("class",tR(e.className&&e.className.baseVal||"",n))}const Zg={FIXED_CONTENT:".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",STICKY_CONTENT:".sticky-top",NAVBAR_TOGGLER:".navbar-toggler"};class kk extends cC{adjustAndStore(n,o,c){const d=o.style[n];o.dataset[n]=d,Sf(o,{[n]:`${parseFloat(Sf(o,n))+c}px`})}restore(n,o){const c=o.dataset[n];c!==void 0&&(delete o.dataset[n],Sf(o,{[n]:c}))}setContainerStyle(n){super.setContainerStyle(n);const o=this.getElement();if(c$(o,"modal-open"),!n.scrollBarWidth)return;const c=this.isRTL?"paddingLeft":"paddingRight",d=this.isRTL?"marginLeft":"marginRight";xf(o,Zg.FIXED_CONTENT).forEach(y=>this.adjustAndStore(c,y,n.scrollBarWidth)),xf(o,Zg.STICKY_CONTENT).forEach(y=>this.adjustAndStore(d,y,-n.scrollBarWidth)),xf(o,Zg.NAVBAR_TOGGLER).forEach(y=>this.adjustAndStore(d,y,n.scrollBarWidth))}removeContainerStyle(n){super.removeContainerStyle(n);const o=this.getElement();u$(o,"modal-open");const c=this.isRTL?"paddingLeft":"paddingRight",d=this.isRTL?"marginLeft":"marginRight";xf(o,Zg.FIXED_CONTENT).forEach(y=>this.restore(c,y)),xf(o,Zg.STICKY_CONTENT).forEach(y=>this.restore(d,y)),xf(o,Zg.NAVBAR_TOGGLER).forEach(y=>this.restore(d,y))}}let Uw;function Ok(e){return Uw||(Uw=new kk(e)),Uw}const zk=V.forwardRef(({className:e,bsPrefix:n,as:o="div",...c},d)=>(n=sr(n,"modal-body"),T.jsx(o,{ref:d,className:qn(e,n),...c})));zk.displayName="ModalBody";const dC=V.createContext({onHide(){}}),hC=V.forwardRef(({bsPrefix:e,className:n,contentClassName:o,centered:c,size:d,fullscreen:y,children:x,scrollable:i,...I},R)=>{e=sr(e,"modal");const k=`${e}-dialog`,N=typeof y=="string"?`${e}-fullscreen-${y}`:`${e}-fullscreen`;return T.jsx("div",{...I,ref:R,className:qn(k,n,d&&`${e}-${d}`,c&&`${k}-centered`,i&&`${k}-scrollable`,y&&N),children:T.jsx("div",{className:qn(`${e}-content`,o),children:x})})});hC.displayName="ModalDialog";const Fk=V.forwardRef(({className:e,bsPrefix:n,as:o="div",...c},d)=>(n=sr(n,"modal-footer"),T.jsx(o,{ref:d,className:qn(e,n),...c})));Fk.displayName="ModalFooter";const Nk=V.forwardRef(({closeLabel:e="Close",closeVariant:n,closeButton:o=!1,onHide:c,children:d,...y},x)=>{const i=V.useContext(dC),I=bu(()=>{i==null||i.onHide(),c==null||c()});return T.jsxs("div",{ref:x,...y,children:[d,o&&T.jsx(Nv,{"aria-label":e,variant:n,onClick:I})]})}),jk=V.forwardRef(({bsPrefix:e,className:n,closeLabel:o="Close",closeButton:c=!1,...d},y)=>(e=sr(e,"modal-header"),T.jsx(Nk,{ref:y,...d,className:qn(n,e),closeLabel:o,closeButton:c})));jk.displayName="ModalHeader";const d$=Fv("h4"),Bk=V.forwardRef(({className:e,bsPrefix:n,as:o=d$,...c},d)=>(n=sr(n,"modal-title"),T.jsx(o,{ref:d,className:qn(e,n),...c})));Bk.displayName="ModalTitle";function h$(e){return T.jsx(If,{...e,timeout:null})}function f$(e){return T.jsx(If,{...e,timeout:null})}const Vk=V.forwardRef(({bsPrefix:e,className:n,style:o,dialogClassName:c,contentClassName:d,children:y,dialogAs:x=hC,"data-bs-theme":i,"aria-labelledby":I,"aria-describedby":R,"aria-label":k,show:N=!1,animation:U=!0,backdrop:K=!0,keyboard:X=!0,onEscapeKeyDown:Z,onShow:J,onHide:le,container:de,autoFocus:ue=!0,enforceFocus:pe=!0,restoreFocus:he=!0,restoreFocusOptions:xe,onEntered:fe,onExit:_e,onExiting:Ce,onEnter:je,onEntering:He,onExited:lt,backdropClassName:_t,manager:Ue,...Ge},at)=>{const[yt,tt]=V.useState({}),[Rt,ct]=V.useState(!1),ze=V.useRef(!1),Ye=V.useRef(!1),At=V.useRef(null),[Ct,We]=GU(),st=y1(at,We),Bt=bu(le),hn=GS();e=sr(e,"modal");const cn=V.useMemo(()=>({onHide:Bt}),[Bt]);function cr(){return Ue||Ok({isRTL:hn})}function Nn(Fr){if(!O_)return;const Xi=cr().getScrollbarWidth()>0,ei=Fr.scrollHeight>zv(Fr).documentElement.clientHeight;tt({paddingRight:Xi&&!ei?JA():void 0,paddingLeft:!Xi&&ei?JA():void 0})}const Vn=bu(()=>{Ct&&Nn(Ct.dialog)});DD(()=>{F2(window,"resize",Vn),At.current==null||At.current()});const An=()=>{ze.current=!0},Zt=Fr=>{ze.current&&Ct&&Fr.target===Ct.dialog&&(Ye.current=!0),ze.current=!1},mn=()=>{ct(!0),At.current=gD(Ct.dialog,()=>{ct(!1)})},kr=Fr=>{Fr.target===Fr.currentTarget&&mn()},Gr=Fr=>{if(K==="static"){kr(Fr);return}if(Ye.current||Fr.target!==Fr.currentTarget){Ye.current=!1;return}le==null||le()},Yr=Fr=>{X?Z==null||Z(Fr):(Fr.preventDefault(),K==="static"&&mn())},Xn=(Fr,Xi)=>{Fr&&Nn(Fr),je==null||je(Fr,Xi)},Lr=Fr=>{At.current==null||At.current(),_e==null||_e(Fr)},Or=(Fr,Xi)=>{He==null||He(Fr,Xi),WS(window,"resize",Vn)},is=Fr=>{Fr&&(Fr.style.display=""),lt==null||lt(Fr),F2(window,"resize",Vn)},Zi=V.useCallback(Fr=>T.jsx("div",{...Fr,className:qn(`${e}-backdrop`,_t,!U&&"show")}),[U,_t,e]),Dr={...o,...yt};Dr.display="block";const Bi=Fr=>T.jsx("div",{role:"dialog",...Fr,style:Dr,className:qn(n,e,Rt&&`${e}-static`,!U&&"show"),onClick:K?Gr:void 0,onMouseUp:Zt,"data-bs-theme":i,"aria-label":k,"aria-labelledby":I,"aria-describedby":R,children:T.jsx(x,{...Ge,onMouseDown:An,className:c,contentClassName:d,children:y})});return T.jsx(dC.Provider,{value:cn,children:T.jsx(Dk,{show:N,ref:st,backdrop:K,container:de,keyboard:!0,autoFocus:ue,enforceFocus:pe,restoreFocus:he,restoreFocusOptions:xe,onEscapeKeyDown:Yr,onShow:J,onHide:le,onEnter:Xn,onEntering:Or,onEntered:fe,onExit:Lr,onExiting:Ce,onExited:is,manager:cr(),transition:U?h$:void 0,backdropTransition:U?f$:void 0,renderBackdrop:Zi,renderDialog:Bi})})});Vk.displayName="Modal";const Wi=Object.assign(Vk,{Body:zk,Header:jk,Title:Bk,Footer:Fk,Dialog:hC,TRANSITION_DURATION:300,BACKDROP_TRANSITION_DURATION:150}),Uk=V.forwardRef(({className:e,bsPrefix:n,as:o="div",...c},d)=>(n=sr(n,"nav-item"),T.jsx(o,{ref:d,className:qn(e,n),...c})));Uk.displayName="NavItem";const $k=V.forwardRef(({bsPrefix:e,className:n,as:o=y_,active:c,eventKey:d,disabled:y=!1,...x},i)=>{e=sr(e,"nav-link");const[I,R]=lC({key:Hp(d,x.href),active:c,disabled:y,...x});return T.jsx(o,{...x,...I,ref:i,disabled:y,className:qn(n,e,y&&"disabled",R.isActive&&"active")})});$k.displayName="NavLink";const Hk=V.forwardRef((e,n)=>{const{as:o="div",bsPrefix:c,variant:d,fill:y=!1,justify:x=!1,navbar:i,navbarScroll:I,className:R,activeKey:k,...N}=D_(e,{activeKey:"onSelect"}),U=sr(c,"nav");let K,X,Z=!1;const J=V.useContext(_g),le=V.useContext(YS);return J?(K=J.bsPrefix,Z=i??!0):le&&({cardHeaderBsPrefix:X}=le),T.jsx(Ak,{as:o,ref:n,activeKey:k,className:qn(R,{[U]:!Z,[`${K}-nav`]:Z,[`${K}-nav-scroll`]:Z&&I,[`${X}-${d}`]:!!X,[`${U}-${d}`]:!!d,[`${U}-fill`]:y,[`${U}-justified`]:x}),...N})});Hk.displayName="Nav";const Ap=Object.assign(Hk,{Item:Uk,Link:$k}),Gk=V.forwardRef(({bsPrefix:e,className:n,as:o,...c},d)=>{e=sr(e,"navbar-brand");const y=o||(c.href?"a":"span");return T.jsx(y,{...c,ref:d,className:qn(n,e)})});Gk.displayName="NavbarBrand";const Wk=V.forwardRef(({children:e,bsPrefix:n,...o},c)=>{n=sr(n,"navbar-collapse");const d=V.useContext(_g);return T.jsx(IV,{in:!!(d&&d.expanded),...o,children:T.jsx("div",{ref:c,className:n,children:e})})});Wk.displayName="NavbarCollapse";const qk=V.forwardRef(({bsPrefix:e,className:n,children:o,label:c="Toggle navigation",as:d="button",onClick:y,...x},i)=>{e=sr(e,"navbar-toggler");const{onToggle:I,expanded:R}=V.useContext(_g)||{},k=bu(N=>{y&&y(N),I&&I()});return d==="button"&&(x.type="button"),T.jsx(d,{...x,ref:i,onClick:k,"aria-label":c,className:qn(n,e,!R&&"collapsed"),children:o||T.jsx("span",{className:`${e}-icon`})})});qk.displayName="NavbarToggle";const U2=new WeakMap,nR=(e,n)=>{if(!e||!n)return;const o=U2.get(n)||new Map;U2.set(n,o);let c=o.get(e);return c||(c=n.matchMedia(e),c.refCount=0,o.set(c.media,c)),c};function p$(e,n=typeof window>"u"?void 0:window){const o=nR(e,n),[c,d]=V.useState(()=>o?o.matches:!1);return dk(()=>{let y=nR(e,n);if(!y)return d(!1);let x=U2.get(n);const i=()=>{d(y.matches)};return y.refCount++,y.addListener(i),i(),()=>{y.removeListener(i),y.refCount--,y.refCount<=0&&(x==null||x.delete(y.media)),y=void 0}},[e]),c}function m$(e){const n=Object.keys(e);function o(i,I){return i===I?I:i?`${i} and ${I}`:I}function c(i){return n[Math.min(n.indexOf(i)+1,n.length-1)]}function d(i){const I=c(i);let R=e[I];return typeof R=="number"?R=`${R-.2}px`:R=`calc(${R} - 0.2px)`,`(max-width: ${R})`}function y(i){let I=e[i];return typeof I=="number"&&(I=`${I}px`),`(min-width: ${I})`}function x(i,I,R){let k;typeof i=="object"?(k=i,R=I,I=!0):(I=I||!0,k={[i]:I});let N=V.useMemo(()=>Object.entries(k).reduce((U,[K,X])=>((X==="up"||X===!0)&&(U=o(U,y(K))),(X==="down"||X===!0)&&(U=o(U,d(K))),U),""),[JSON.stringify(k)]);return p$(N,R)}return x}const g$=m$({xs:0,sm:576,md:768,lg:992,xl:1200,xxl:1400}),Zk=V.forwardRef(({className:e,bsPrefix:n,as:o="div",...c},d)=>(n=sr(n,"offcanvas-body"),T.jsx(o,{ref:d,className:qn(e,n),...c})));Zk.displayName="OffcanvasBody";const _$={[yu]:"show",[bf]:"show"},Xk=V.forwardRef(({bsPrefix:e,className:n,children:o,in:c=!1,mountOnEnter:d=!1,unmountOnExit:y=!1,appear:x=!1,...i},I)=>(e=sr(e,"offcanvas"),T.jsx(v1,{ref:I,addEndListener:_1,in:c,mountOnEnter:d,unmountOnExit:y,appear:x,...i,childRef:k_(o),children:(R,k)=>V.cloneElement(o,{...k,className:qn(n,o.props.className,(R===yu||R===__)&&`${e}-toggling`,_$[R])})})));Xk.displayName="OffcanvasToggling";const Kk=V.forwardRef(({bsPrefix:e,className:n,closeLabel:o="Close",closeButton:c=!1,...d},y)=>(e=sr(e,"offcanvas-header"),T.jsx(Nk,{ref:y,...d,className:qn(n,e),closeLabel:o,closeButton:c})));Kk.displayName="OffcanvasHeader";const y$=Fv("h5"),Yk=V.forwardRef(({className:e,bsPrefix:n,as:o=y$,...c},d)=>(n=sr(n,"offcanvas-title"),T.jsx(o,{ref:d,className:qn(e,n),...c})));Yk.displayName="OffcanvasTitle";function v$(e){return T.jsx(Xk,{...e})}function x$(e){return T.jsx(If,{...e})}const Jk=V.forwardRef(({bsPrefix:e,className:n,children:o,"aria-labelledby":c,placement:d="start",responsive:y,show:x=!1,backdrop:i=!0,keyboard:I=!0,scroll:R=!1,onEscapeKeyDown:k,onShow:N,onHide:U,container:K,autoFocus:X=!0,enforceFocus:Z=!0,restoreFocus:J=!0,restoreFocusOptions:le,onEntered:de,onExit:ue,onExiting:pe,onEnter:he,onEntering:xe,onExited:fe,backdropClassName:_e,manager:Ce,renderStaticNode:je=!1,...He},lt)=>{const _t=V.useRef();e=sr(e,"offcanvas");const[Ue,Ge]=V.useState(!1),at=bu(U),yt=g$(y||"xs","up");V.useEffect(()=>{Ge(y?x&&!yt:x)},[x,y,yt]);const tt=V.useMemo(()=>({onHide:at}),[at]);function Rt(){return Ce||(R?(_t.current||(_t.current=new kk({handleContainerOverflow:!1})),_t.current):Ok())}const ct=(Ct,...We)=>{Ct&&(Ct.style.visibility="visible"),he==null||he(Ct,...We)},ze=(Ct,...We)=>{Ct&&(Ct.style.visibility=""),fe==null||fe(...We)},Ye=V.useCallback(Ct=>T.jsx("div",{...Ct,className:qn(`${e}-backdrop`,_e)}),[_e,e]),At=Ct=>T.jsx("div",{...Ct,...He,className:qn(n,y?`${e}-${y}`:e,`${e}-${d}`),"aria-labelledby":c,children:o});return T.jsxs(T.Fragment,{children:[!Ue&&(y||je)&&At({}),T.jsx(dC.Provider,{value:tt,children:T.jsx(Dk,{show:Ue,ref:lt,backdrop:i,container:K,keyboard:I,autoFocus:X,enforceFocus:Z&&!R,restoreFocus:J,restoreFocusOptions:le,onEscapeKeyDown:k,onShow:N,onHide:at,onEnter:ct,onEntering:xe,onEntered:de,onExit:ue,onExiting:pe,onExited:ze,manager:Rt(),transition:v$,backdropTransition:x$,renderBackdrop:Ye,renderDialog:At})})]})});Jk.displayName="Offcanvas";const b$=Object.assign(Jk,{Body:Zk,Header:Kk,Title:Yk}),Qk=V.forwardRef(({onHide:e,...n},o)=>{const c=V.useContext(_g),d=bu(()=>{c==null||c.onToggle==null||c.onToggle(),e==null||e()});return T.jsx(b$,{ref:o,show:!!(c!=null&&c.expanded),...n,renderStaticNode:!0,onHide:d})});Qk.displayName="NavbarOffcanvas";const eO=V.forwardRef(({className:e,bsPrefix:n,as:o="span",...c},d)=>(n=sr(n,"navbar-text"),T.jsx(o,{ref:d,className:qn(e,n),...c})));eO.displayName="NavbarText";const tO=V.forwardRef((e,n)=>{const{bsPrefix:o,expand:c=!0,variant:d="light",bg:y,fixed:x,sticky:i,className:I,as:R="nav",expanded:k,onToggle:N,onSelect:U,collapseOnSelect:K=!1,...X}=D_(e,{expanded:"onToggle"}),Z=sr(o,"navbar"),J=V.useCallback((...ue)=>{U==null||U(...ue),K&&k&&(N==null||N(!1))},[U,K,k,N]);X.role===void 0&&R!=="nav"&&(X.role="navigation");let le=`${Z}-expand`;typeof c=="string"&&(le=`${le}-${c}`);const de=V.useMemo(()=>({onToggle:()=>N==null?void 0:N(!k),bsPrefix:Z,expanded:!!k,expand:c}),[Z,k,c,N]);return T.jsx(_g.Provider,{value:de,children:T.jsx(Eh.Provider,{value:J,children:T.jsx(R,{ref:n,...X,className:qn(I,Z,c&&le,d&&`${Z}-${d}`,y&&`bg-${y}`,i&&`sticky-${i}`,x&&`fixed-${x}`)})})})});tO.displayName="Navbar";const r0=Object.assign(tO,{Brand:Gk,Collapse:Wk,Offcanvas:Qk,Text:eO,Toggle:qk}),vi=V.forwardRef(({bsPrefix:e,className:n,as:o="div",...c},d)=>{const y=sr(e,"row"),x=pD(),i=mD(),I=`${y}-cols`,R=[];return x.forEach(k=>{const N=c[k];delete c[k];let U;N!=null&&typeof N=="object"?{cols:U}=N:U=N;const K=k!==i?`-${k}`:"";U!=null&&R.push(`${I}${K}-${U}`)}),T.jsx(o,{ref:d,...c,className:qn(n,y,...R)})});vi.displayName="Row";const xu=V.forwardRef(({bsPrefix:e,variant:n,animation:o="border",size:c,as:d="div",className:y,...x},i)=>{e=sr(e,"spinner");const I=`${e}-${o}`;return T.jsx(d,{ref:i,...x,className:qn(y,I,c&&`${I}-${c}`,n&&`text-${n}`)})});xu.displayName="Spinner";const w$=["active","eventKey","mountOnEnter","transition","unmountOnExit","role","onEnter","onEntering","onEntered","onExit","onExiting","onExited"],S$=["activeKey","getControlledId","getControllerId"],C$=["as"];function $2(e,n){if(e==null)return{};var o={};for(var c in e)if({}.hasOwnProperty.call(e,c)){if(n.indexOf(c)>=0)continue;o[c]=e[c]}return o}function nO(e){let{active:n,eventKey:o,mountOnEnter:c,transition:d,unmountOnExit:y,role:x="tabpanel",onEnter:i,onEntering:I,onEntered:R,onExit:k,onExiting:N,onExited:U}=e,K=$2(e,w$);const X=V.useContext(F_);if(!X)return[Object.assign({},K,{role:x}),{eventKey:o,isActive:n,mountOnEnter:c,transition:d,unmountOnExit:y,onEnter:i,onEntering:I,onEntered:R,onExit:k,onExiting:N,onExited:U}];const{activeKey:Z,getControlledId:J,getControllerId:le}=X,de=$2(X,S$),ue=Hp(o);return[Object.assign({},K,{role:x,id:J(o),"aria-labelledby":le(o)}),{eventKey:o,isActive:n==null&&ue!=null?Hp(Z)===ue:n,transition:d||de.transition,mountOnEnter:c??de.mountOnEnter,unmountOnExit:y??de.unmountOnExit,onEnter:i,onEntering:I,onEntered:R,onExit:k,onExiting:N,onExited:U}]}const rO=V.forwardRef((e,n)=>{let{as:o="div"}=e,c=$2(e,C$);const[d,{isActive:y,onEnter:x,onEntering:i,onEntered:I,onExit:R,onExiting:k,onExited:N,mountOnEnter:U,unmountOnExit:K,transition:X=uC}]=nO(c);return T.jsx(F_.Provider,{value:null,children:T.jsx(Eh.Provider,{value:null,children:T.jsx(X,{in:y,onEnter:x,onEntering:i,onEntered:I,onExit:R,onExiting:k,onExited:N,mountOnEnter:U,unmountOnExit:K,children:T.jsx(o,Object.assign({},d,{ref:n,hidden:!y,"aria-hidden":!y}))})})})});rO.displayName="TabPanel";const iO=e=>{const{id:n,generateChildId:o,onSelect:c,activeKey:d,defaultActiveKey:y,transition:x,mountOnEnter:i,unmountOnExit:I,children:R}=e,[k,N]=jD(d,y,c),U=ek(n),K=V.useMemo(()=>o||((Z,J)=>U?`${U}-${J}-${Z}`:null),[U,o]),X=V.useMemo(()=>({onSelect:N,activeKey:k,transition:x,mountOnEnter:i||!1,unmountOnExit:I||!1,getControlledId:Z=>K(Z,"tabpane"),getControllerId:Z=>K(Z,"tab")}),[N,k,x,i,I,K]);return T.jsx(F_.Provider,{value:X,children:T.jsx(Eh.Provider,{value:N||null,children:R})})};iO.Panel=rO;function sO(e){return typeof e=="boolean"?e?If:uC:e}const oO=({transition:e,...n})=>T.jsx(iO,{...n,transition:sO(e)});oO.displayName="TabContainer";const aO=V.forwardRef(({className:e,bsPrefix:n,as:o="div",...c},d)=>(n=sr(n,"tab-content"),T.jsx(o,{ref:d,className:qn(e,n),...c})));aO.displayName="TabContent";const lO=V.forwardRef(({bsPrefix:e,transition:n,...o},c)=>{const[{className:d,as:y="div",...x},{isActive:i,onEnter:I,onEntering:R,onEntered:k,onExit:N,onExiting:U,onExited:K,mountOnEnter:X,unmountOnExit:Z,transition:J=If}]=nO({...o,transition:sO(n)}),le=sr(e,"tab-pane");return T.jsx(F_.Provider,{value:null,children:T.jsx(Eh.Provider,{value:null,children:T.jsx(J,{in:i,onEnter:I,onEntering:R,onEntered:k,onExit:N,onExiting:U,onExited:K,mountOnEnter:X,unmountOnExit:Z,children:T.jsx(y,{...x,ref:c,className:qn(d,le,i&&"active")})})})})});lO.displayName="TabPane";const T$={eventKey:$a.oneOfType([$a.string,$a.number]),title:$a.node.isRequired,disabled:$a.bool,tabClassName:$a.string,tabAttrs:$a.object},cO=()=>{throw new Error("ReactBootstrap: The `Tab` component is not meant to be rendered! It's an abstract component that is only valid as a direct Child of the `Tabs` Component. For custom tabs components use TabPane and TabsContainer directly")};cO.propTypes=T$;const Rp=Object.assign(cO,{Container:oO,Content:aO,Pane:lO}),E$={[yu]:"showing",[__]:"showing show"},uO=V.forwardRef((e,n)=>T.jsx(If,{...e,ref:n,transitionClasses:E$}));uO.displayName="ToastFade";const dO=V.createContext({onClose(){}}),hO=V.forwardRef(({bsPrefix:e,closeLabel:n="Close",closeVariant:o,closeButton:c=!0,className:d,children:y,...x},i)=>{e=sr(e,"toast-header");const I=V.useContext(dO),R=bu(k=>{I==null||I.onClose==null||I.onClose(k)});return T.jsxs("div",{ref:i,...x,className:qn(e,d),children:[y,c&&T.jsx(Nv,{"aria-label":n,variant:o,onClick:R,"data-dismiss":"toast"})]})});hO.displayName="ToastHeader";const fO=V.forwardRef(({className:e,bsPrefix:n,as:o="div",...c},d)=>(n=sr(n,"toast-body"),T.jsx(o,{ref:d,className:qn(e,n),...c})));fO.displayName="ToastBody";const pO=V.forwardRef(({bsPrefix:e,className:n,transition:o=uO,show:c=!0,animation:d=!0,delay:y=5e3,autohide:x=!1,onClose:i,onEntered:I,onExit:R,onExiting:k,onEnter:N,onEntering:U,onExited:K,bg:X,...Z},J)=>{e=sr(e,"toast");const le=V.useRef(y),de=V.useRef(i);V.useEffect(()=>{le.current=y,de.current=i},[y,i]);const ue=OD(),pe=!!(x&&c),he=V.useCallback(()=>{pe&&(de.current==null||de.current())},[pe]);V.useEffect(()=>{ue.set(he,le.current)},[ue,he]);const xe=V.useMemo(()=>({onClose:i}),[i]),fe=!!(o&&d),_e=T.jsx("div",{...Z,ref:J,className:qn(e,n,X&&`bg-${X}`,!fe&&(c?"show":"hide")),role:"alert","aria-live":"assertive","aria-atomic":"true"});return T.jsx(dO.Provider,{value:xe,children:fe&&o?T.jsx(o,{in:c,onEnter:N,onEntering:U,onEntered:I,onExit:R,onExiting:k,onExited:K,unmountOnExit:!0,children:_e}):_e})});pO.displayName="Toast";const rR=Object.assign(pO,{Body:fO,Header:hO}),I$={"top-start":"top-0 start-0","top-center":"top-0 start-50 translate-middle-x","top-end":"top-0 end-0","middle-start":"top-50 start-0 translate-middle-y","middle-center":"top-50 start-50 translate-middle","middle-end":"top-50 end-0 translate-middle-y","bottom-start":"bottom-0 start-0","bottom-center":"bottom-0 start-50 translate-middle-x","bottom-end":"bottom-0 end-0"},mO=V.forwardRef(({bsPrefix:e,position:n,containerPosition:o,className:c,as:d="div",...y},x)=>(e=sr(e,"toast-container"),T.jsx(d,{ref:x,...y,className:qn(e,n&&I$[n],o&&`position-${o}`,c)})));mO.displayName="ToastContainer";const P$="/assets/log-DcYn2odj.webp";function gO(e,n){return function(){return e.apply(n,arguments)}}const{toString:A$}=Object.prototype,{getPrototypeOf:fC}=Object,{iterator:P1,toStringTag:_O}=Symbol,A1=(e=>n=>{const o=A$.call(n);return e[o]||(e[o]=o.slice(8,-1).toLowerCase())})(Object.create(null)),pd=e=>(e=e.toLowerCase(),n=>A1(n)===e),R1=e=>n=>typeof n===e,{isArray:N_}=Array,wv=R1("undefined");function R$(e){return e!==null&&!wv(e)&&e.constructor!==null&&!wv(e.constructor)&&ec(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const yO=pd("ArrayBuffer");function M$(e){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(e):n=e&&e.buffer&&yO(e.buffer),n}const L$=R1("string"),ec=R1("function"),vO=R1("number"),M1=e=>e!==null&&typeof e=="object",D$=e=>e===!0||e===!1,y0=e=>{if(A1(e)!=="object")return!1;const n=fC(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(_O in e)&&!(P1 in e)},k$=pd("Date"),O$=pd("File"),z$=pd("Blob"),F$=pd("FileList"),N$=e=>M1(e)&&ec(e.pipe),j$=e=>{let n;return e&&(typeof FormData=="function"&&e instanceof FormData||ec(e.append)&&((n=A1(e))==="formdata"||n==="object"&&ec(e.toString)&&e.toString()==="[object FormData]"))},B$=pd("URLSearchParams"),[V$,U$,$$,H$]=["ReadableStream","Request","Response","Headers"].map(pd),G$=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function $v(e,n,{allOwnKeys:o=!1}={}){if(e===null||typeof e>"u")return;let c,d;if(typeof e!="object"&&(e=[e]),N_(e))for(c=0,d=e.length;c<d;c++)n.call(null,e[c],c,e);else{const y=o?Object.getOwnPropertyNames(e):Object.keys(e),x=y.length;let i;for(c=0;c<x;c++)i=y[c],n.call(null,e[i],i,e)}}function xO(e,n){n=n.toLowerCase();const o=Object.keys(e);let c=o.length,d;for(;c-- >0;)if(d=o[c],n===d.toLowerCase())return d;return null}const Qm=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,bO=e=>!wv(e)&&e!==Qm;function H2(){const{caseless:e}=bO(this)&&this||{},n={},o=(c,d)=>{const y=e&&xO(n,d)||d;y0(n[y])&&y0(c)?n[y]=H2(n[y],c):y0(c)?n[y]=H2({},c):N_(c)?n[y]=c.slice():n[y]=c};for(let c=0,d=arguments.length;c<d;c++)arguments[c]&&$v(arguments[c],o);return n}const W$=(e,n,o,{allOwnKeys:c}={})=>($v(n,(d,y)=>{o&&ec(d)?e[y]=gO(d,o):e[y]=d},{allOwnKeys:c}),e),q$=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Z$=(e,n,o,c)=>{e.prototype=Object.create(n.prototype,c),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:n.prototype}),o&&Object.assign(e.prototype,o)},X$=(e,n,o,c)=>{let d,y,x;const i={};if(n=n||{},e==null)return n;do{for(d=Object.getOwnPropertyNames(e),y=d.length;y-- >0;)x=d[y],(!c||c(x,e,n))&&!i[x]&&(n[x]=e[x],i[x]=!0);e=o!==!1&&fC(e)}while(e&&(!o||o(e,n))&&e!==Object.prototype);return n},K$=(e,n,o)=>{e=String(e),(o===void 0||o>e.length)&&(o=e.length),o-=n.length;const c=e.indexOf(n,o);return c!==-1&&c===o},Y$=e=>{if(!e)return null;if(N_(e))return e;let n=e.length;if(!vO(n))return null;const o=new Array(n);for(;n-- >0;)o[n]=e[n];return o},J$=(e=>n=>e&&n instanceof e)(typeof Uint8Array<"u"&&fC(Uint8Array)),Q$=(e,n)=>{const c=(e&&e[P1]).call(e);let d;for(;(d=c.next())&&!d.done;){const y=d.value;n.call(e,y[0],y[1])}},e9=(e,n)=>{let o;const c=[];for(;(o=e.exec(n))!==null;)c.push(o);return c},t9=pd("HTMLFormElement"),n9=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(o,c,d){return c.toUpperCase()+d}),iR=(({hasOwnProperty:e})=>(n,o)=>e.call(n,o))(Object.prototype),r9=pd("RegExp"),wO=(e,n)=>{const o=Object.getOwnPropertyDescriptors(e),c={};$v(o,(d,y)=>{let x;(x=n(d,y,e))!==!1&&(c[y]=x||d)}),Object.defineProperties(e,c)},i9=e=>{wO(e,(n,o)=>{if(ec(e)&&["arguments","caller","callee"].indexOf(o)!==-1)return!1;const c=e[o];if(ec(c)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+o+"'")})}})},s9=(e,n)=>{const o={},c=d=>{d.forEach(y=>{o[y]=!0})};return N_(e)?c(e):c(String(e).split(n)),o},o9=()=>{},a9=(e,n)=>e!=null&&Number.isFinite(e=+e)?e:n;function l9(e){return!!(e&&ec(e.append)&&e[_O]==="FormData"&&e[P1])}const c9=e=>{const n=new Array(10),o=(c,d)=>{if(M1(c)){if(n.indexOf(c)>=0)return;if(!("toJSON"in c)){n[d]=c;const y=N_(c)?[]:{};return $v(c,(x,i)=>{const I=o(x,d+1);!wv(I)&&(y[i]=I)}),n[d]=void 0,y}}return c};return o(e,0)},u9=pd("AsyncFunction"),d9=e=>e&&(M1(e)||ec(e))&&ec(e.then)&&ec(e.catch),SO=((e,n)=>e?setImmediate:n?((o,c)=>(Qm.addEventListener("message",({source:d,data:y})=>{d===Qm&&y===o&&c.length&&c.shift()()},!1),d=>{c.push(d),Qm.postMessage(o,"*")}))(`axios@${Math.random()}`,[]):o=>setTimeout(o))(typeof setImmediate=="function",ec(Qm.postMessage)),h9=typeof queueMicrotask<"u"?queueMicrotask.bind(Qm):typeof process<"u"&&process.nextTick||SO,f9=e=>e!=null&&ec(e[P1]),nn={isArray:N_,isArrayBuffer:yO,isBuffer:R$,isFormData:j$,isArrayBufferView:M$,isString:L$,isNumber:vO,isBoolean:D$,isObject:M1,isPlainObject:y0,isReadableStream:V$,isRequest:U$,isResponse:$$,isHeaders:H$,isUndefined:wv,isDate:k$,isFile:O$,isBlob:z$,isRegExp:r9,isFunction:ec,isStream:N$,isURLSearchParams:B$,isTypedArray:J$,isFileList:F$,forEach:$v,merge:H2,extend:W$,trim:G$,stripBOM:q$,inherits:Z$,toFlatObject:X$,kindOf:A1,kindOfTest:pd,endsWith:K$,toArray:Y$,forEachEntry:Q$,matchAll:e9,isHTMLForm:t9,hasOwnProperty:iR,hasOwnProp:iR,reduceDescriptors:wO,freezeMethods:i9,toObjectSet:s9,toCamelCase:n9,noop:o9,toFiniteNumber:a9,findKey:xO,global:Qm,isContextDefined:bO,isSpecCompliantForm:l9,toJSONObject:c9,isAsyncFn:u9,isThenable:d9,setImmediate:SO,asap:h9,isIterable:f9};function bi(e,n,o,c,d){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",n&&(this.code=n),o&&(this.config=o),c&&(this.request=c),d&&(this.response=d,this.status=d.status?d.status:null)}nn.inherits(bi,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:nn.toJSONObject(this.config),code:this.code,status:this.status}}});const CO=bi.prototype,TO={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{TO[e]={value:e}});Object.defineProperties(bi,TO);Object.defineProperty(CO,"isAxiosError",{value:!0});bi.from=(e,n,o,c,d,y)=>{const x=Object.create(CO);return nn.toFlatObject(e,x,function(I){return I!==Error.prototype},i=>i!=="isAxiosError"),bi.call(x,e.message,n,o,c,d),x.cause=e,x.name=e.name,y&&Object.assign(x,y),x};const p9=null;function G2(e){return nn.isPlainObject(e)||nn.isArray(e)}function EO(e){return nn.endsWith(e,"[]")?e.slice(0,-2):e}function sR(e,n,o){return e?e.concat(n).map(function(d,y){return d=EO(d),!o&&y?"["+d+"]":d}).join(o?".":""):n}function m9(e){return nn.isArray(e)&&!e.some(G2)}const g9=nn.toFlatObject(nn,{},null,function(n){return/^is[A-Z]/.test(n)});function L1(e,n,o){if(!nn.isObject(e))throw new TypeError("target must be an object");n=n||new FormData,o=nn.toFlatObject(o,{metaTokens:!0,dots:!1,indexes:!1},!1,function(Z,J){return!nn.isUndefined(J[Z])});const c=o.metaTokens,d=o.visitor||k,y=o.dots,x=o.indexes,I=(o.Blob||typeof Blob<"u"&&Blob)&&nn.isSpecCompliantForm(n);if(!nn.isFunction(d))throw new TypeError("visitor must be a function");function R(X){if(X===null)return"";if(nn.isDate(X))return X.toISOString();if(!I&&nn.isBlob(X))throw new bi("Blob is not supported. Use a Buffer instead.");return nn.isArrayBuffer(X)||nn.isTypedArray(X)?I&&typeof Blob=="function"?new Blob([X]):Buffer.from(X):X}function k(X,Z,J){let le=X;if(X&&!J&&typeof X=="object"){if(nn.endsWith(Z,"{}"))Z=c?Z:Z.slice(0,-2),X=JSON.stringify(X);else if(nn.isArray(X)&&m9(X)||(nn.isFileList(X)||nn.endsWith(Z,"[]"))&&(le=nn.toArray(X)))return Z=EO(Z),le.forEach(function(ue,pe){!(nn.isUndefined(ue)||ue===null)&&n.append(x===!0?sR([Z],pe,y):x===null?Z:Z+"[]",R(ue))}),!1}return G2(X)?!0:(n.append(sR(J,Z,y),R(X)),!1)}const N=[],U=Object.assign(g9,{defaultVisitor:k,convertValue:R,isVisitable:G2});function K(X,Z){if(!nn.isUndefined(X)){if(N.indexOf(X)!==-1)throw Error("Circular reference detected in "+Z.join("."));N.push(X),nn.forEach(X,function(le,de){(!(nn.isUndefined(le)||le===null)&&d.call(n,le,nn.isString(de)?de.trim():de,Z,U))===!0&&K(le,Z?Z.concat(de):[de])}),N.pop()}}if(!nn.isObject(e))throw new TypeError("data must be an object");return K(e),n}function oR(e){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(c){return n[c]})}function pC(e,n){this._pairs=[],e&&L1(e,this,n)}const IO=pC.prototype;IO.append=function(n,o){this._pairs.push([n,o])};IO.toString=function(n){const o=n?function(c){return n.call(this,c,oR)}:oR;return this._pairs.map(function(d){return o(d[0])+"="+o(d[1])},"").join("&")};function _9(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function PO(e,n,o){if(!n)return e;const c=o&&o.encode||_9;nn.isFunction(o)&&(o={serialize:o});const d=o&&o.serialize;let y;if(d?y=d(n,o):y=nn.isURLSearchParams(n)?n.toString():new pC(n,o).toString(c),y){const x=e.indexOf("#");x!==-1&&(e=e.slice(0,x)),e+=(e.indexOf("?")===-1?"?":"&")+y}return e}class aR{constructor(){this.handlers=[]}use(n,o,c){return this.handlers.push({fulfilled:n,rejected:o,synchronous:c?c.synchronous:!1,runWhen:c?c.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){nn.forEach(this.handlers,function(c){c!==null&&n(c)})}}const AO={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},y9=typeof URLSearchParams<"u"?URLSearchParams:pC,v9=typeof FormData<"u"?FormData:null,x9=typeof Blob<"u"?Blob:null,b9={isBrowser:!0,classes:{URLSearchParams:y9,FormData:v9,Blob:x9},protocols:["http","https","file","blob","url","data"]},mC=typeof window<"u"&&typeof document<"u",W2=typeof navigator=="object"&&navigator||void 0,w9=mC&&(!W2||["ReactNative","NativeScript","NS"].indexOf(W2.product)<0),S9=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",C9=mC&&window.location.href||"http://localhost",T9=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:mC,hasStandardBrowserEnv:w9,hasStandardBrowserWebWorkerEnv:S9,navigator:W2,origin:C9},Symbol.toStringTag,{value:"Module"})),Ga={...T9,...b9};function E9(e,n){return L1(e,new Ga.classes.URLSearchParams,Object.assign({visitor:function(o,c,d,y){return Ga.isNode&&nn.isBuffer(o)?(this.append(c,o.toString("base64")),!1):y.defaultVisitor.apply(this,arguments)}},n))}function I9(e){return nn.matchAll(/\w+|\[(\w*)]/g,e).map(n=>n[0]==="[]"?"":n[1]||n[0])}function P9(e){const n={},o=Object.keys(e);let c;const d=o.length;let y;for(c=0;c<d;c++)y=o[c],n[y]=e[y];return n}function RO(e){function n(o,c,d,y){let x=o[y++];if(x==="__proto__")return!0;const i=Number.isFinite(+x),I=y>=o.length;return x=!x&&nn.isArray(d)?d.length:x,I?(nn.hasOwnProp(d,x)?d[x]=[d[x],c]:d[x]=c,!i):((!d[x]||!nn.isObject(d[x]))&&(d[x]=[]),n(o,c,d[x],y)&&nn.isArray(d[x])&&(d[x]=P9(d[x])),!i)}if(nn.isFormData(e)&&nn.isFunction(e.entries)){const o={};return nn.forEachEntry(e,(c,d)=>{n(I9(c),d,o,0)}),o}return null}function A9(e,n,o){if(nn.isString(e))try{return(n||JSON.parse)(e),nn.trim(e)}catch(c){if(c.name!=="SyntaxError")throw c}return(o||JSON.stringify)(e)}const Hv={transitional:AO,adapter:["xhr","http","fetch"],transformRequest:[function(n,o){const c=o.getContentType()||"",d=c.indexOf("application/json")>-1,y=nn.isObject(n);if(y&&nn.isHTMLForm(n)&&(n=new FormData(n)),nn.isFormData(n))return d?JSON.stringify(RO(n)):n;if(nn.isArrayBuffer(n)||nn.isBuffer(n)||nn.isStream(n)||nn.isFile(n)||nn.isBlob(n)||nn.isReadableStream(n))return n;if(nn.isArrayBufferView(n))return n.buffer;if(nn.isURLSearchParams(n))return o.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let i;if(y){if(c.indexOf("application/x-www-form-urlencoded")>-1)return E9(n,this.formSerializer).toString();if((i=nn.isFileList(n))||c.indexOf("multipart/form-data")>-1){const I=this.env&&this.env.FormData;return L1(i?{"files[]":n}:n,I&&new I,this.formSerializer)}}return y||d?(o.setContentType("application/json",!1),A9(n)):n}],transformResponse:[function(n){const o=this.transitional||Hv.transitional,c=o&&o.forcedJSONParsing,d=this.responseType==="json";if(nn.isResponse(n)||nn.isReadableStream(n))return n;if(n&&nn.isString(n)&&(c&&!this.responseType||d)){const x=!(o&&o.silentJSONParsing)&&d;try{return JSON.parse(n)}catch(i){if(x)throw i.name==="SyntaxError"?bi.from(i,bi.ERR_BAD_RESPONSE,this,null,this.response):i}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ga.classes.FormData,Blob:Ga.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};nn.forEach(["delete","get","head","post","put","patch"],e=>{Hv.headers[e]={}});const R9=nn.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),M9=e=>{const n={};let o,c,d;return e&&e.split(`
`).forEach(function(x){d=x.indexOf(":"),o=x.substring(0,d).trim().toLowerCase(),c=x.substring(d+1).trim(),!(!o||n[o]&&R9[o])&&(o==="set-cookie"?n[o]?n[o].push(c):n[o]=[c]:n[o]=n[o]?n[o]+", "+c:c)}),n},lR=Symbol("internals");function Hy(e){return e&&String(e).trim().toLowerCase()}function v0(e){return e===!1||e==null?e:nn.isArray(e)?e.map(v0):String(e)}function L9(e){const n=Object.create(null),o=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let c;for(;c=o.exec(e);)n[c[1]]=c[2];return n}const D9=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function $w(e,n,o,c,d){if(nn.isFunction(c))return c.call(this,n,o);if(d&&(n=o),!!nn.isString(n)){if(nn.isString(c))return n.indexOf(c)!==-1;if(nn.isRegExp(c))return c.test(n)}}function k9(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,o,c)=>o.toUpperCase()+c)}function O9(e,n){const o=nn.toCamelCase(" "+n);["get","set","has"].forEach(c=>{Object.defineProperty(e,c+o,{value:function(d,y,x){return this[c].call(this,n,d,y,x)},configurable:!0})})}let tc=class{constructor(n){n&&this.set(n)}set(n,o,c){const d=this;function y(i,I,R){const k=Hy(I);if(!k)throw new Error("header name must be a non-empty string");const N=nn.findKey(d,k);(!N||d[N]===void 0||R===!0||R===void 0&&d[N]!==!1)&&(d[N||I]=v0(i))}const x=(i,I)=>nn.forEach(i,(R,k)=>y(R,k,I));if(nn.isPlainObject(n)||n instanceof this.constructor)x(n,o);else if(nn.isString(n)&&(n=n.trim())&&!D9(n))x(M9(n),o);else if(nn.isObject(n)&&nn.isIterable(n)){let i={},I,R;for(const k of n){if(!nn.isArray(k))throw TypeError("Object iterator must return a key-value pair");i[R=k[0]]=(I=i[R])?nn.isArray(I)?[...I,k[1]]:[I,k[1]]:k[1]}x(i,o)}else n!=null&&y(o,n,c);return this}get(n,o){if(n=Hy(n),n){const c=nn.findKey(this,n);if(c){const d=this[c];if(!o)return d;if(o===!0)return L9(d);if(nn.isFunction(o))return o.call(this,d,c);if(nn.isRegExp(o))return o.exec(d);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,o){if(n=Hy(n),n){const c=nn.findKey(this,n);return!!(c&&this[c]!==void 0&&(!o||$w(this,this[c],c,o)))}return!1}delete(n,o){const c=this;let d=!1;function y(x){if(x=Hy(x),x){const i=nn.findKey(c,x);i&&(!o||$w(c,c[i],i,o))&&(delete c[i],d=!0)}}return nn.isArray(n)?n.forEach(y):y(n),d}clear(n){const o=Object.keys(this);let c=o.length,d=!1;for(;c--;){const y=o[c];(!n||$w(this,this[y],y,n,!0))&&(delete this[y],d=!0)}return d}normalize(n){const o=this,c={};return nn.forEach(this,(d,y)=>{const x=nn.findKey(c,y);if(x){o[x]=v0(d),delete o[y];return}const i=n?k9(y):String(y).trim();i!==y&&delete o[y],o[i]=v0(d),c[i]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const o=Object.create(null);return nn.forEach(this,(c,d)=>{c!=null&&c!==!1&&(o[d]=n&&nn.isArray(c)?c.join(", "):c)}),o}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,o])=>n+": "+o).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...o){const c=new this(n);return o.forEach(d=>c.set(d)),c}static accessor(n){const c=(this[lR]=this[lR]={accessors:{}}).accessors,d=this.prototype;function y(x){const i=Hy(x);c[i]||(O9(d,x),c[i]=!0)}return nn.isArray(n)?n.forEach(y):y(n),this}};tc.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);nn.reduceDescriptors(tc.prototype,({value:e},n)=>{let o=n[0].toUpperCase()+n.slice(1);return{get:()=>e,set(c){this[o]=c}}});nn.freezeMethods(tc);function Hw(e,n){const o=this||Hv,c=n||o,d=tc.from(c.headers);let y=c.data;return nn.forEach(e,function(i){y=i.call(o,y,d.normalize(),n?n.status:void 0)}),d.normalize(),y}function MO(e){return!!(e&&e.__CANCEL__)}function j_(e,n,o){bi.call(this,e??"canceled",bi.ERR_CANCELED,n,o),this.name="CanceledError"}nn.inherits(j_,bi,{__CANCEL__:!0});function LO(e,n,o){const c=o.config.validateStatus;!o.status||!c||c(o.status)?e(o):n(new bi("Request failed with status code "+o.status,[bi.ERR_BAD_REQUEST,bi.ERR_BAD_RESPONSE][Math.floor(o.status/100)-4],o.config,o.request,o))}function z9(e){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return n&&n[1]||""}function F9(e,n){e=e||10;const o=new Array(e),c=new Array(e);let d=0,y=0,x;return n=n!==void 0?n:1e3,function(I){const R=Date.now(),k=c[y];x||(x=R),o[d]=I,c[d]=R;let N=y,U=0;for(;N!==d;)U+=o[N++],N=N%e;if(d=(d+1)%e,d===y&&(y=(y+1)%e),R-x<n)return;const K=k&&R-k;return K?Math.round(U*1e3/K):void 0}}function N9(e,n){let o=0,c=1e3/n,d,y;const x=(R,k=Date.now())=>{o=k,d=null,y&&(clearTimeout(y),y=null),e.apply(null,R)};return[(...R)=>{const k=Date.now(),N=k-o;N>=c?x(R,k):(d=R,y||(y=setTimeout(()=>{y=null,x(d)},c-N)))},()=>d&&x(d)]}const N0=(e,n,o=3)=>{let c=0;const d=F9(50,250);return N9(y=>{const x=y.loaded,i=y.lengthComputable?y.total:void 0,I=x-c,R=d(I),k=x<=i;c=x;const N={loaded:x,total:i,progress:i?x/i:void 0,bytes:I,rate:R||void 0,estimated:R&&i&&k?(i-x)/R:void 0,event:y,lengthComputable:i!=null,[n?"download":"upload"]:!0};e(N)},o)},cR=(e,n)=>{const o=e!=null;return[c=>n[0]({lengthComputable:o,total:e,loaded:c}),n[1]]},uR=e=>(...n)=>nn.asap(()=>e(...n)),j9=Ga.hasStandardBrowserEnv?((e,n)=>o=>(o=new URL(o,Ga.origin),e.protocol===o.protocol&&e.host===o.host&&(n||e.port===o.port)))(new URL(Ga.origin),Ga.navigator&&/(msie|trident)/i.test(Ga.navigator.userAgent)):()=>!0,B9=Ga.hasStandardBrowserEnv?{write(e,n,o,c,d,y){const x=[e+"="+encodeURIComponent(n)];nn.isNumber(o)&&x.push("expires="+new Date(o).toGMTString()),nn.isString(c)&&x.push("path="+c),nn.isString(d)&&x.push("domain="+d),y===!0&&x.push("secure"),document.cookie=x.join("; ")},read(e){const n=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function V9(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function U9(e,n){return n?e.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):e}function DO(e,n,o){let c=!V9(n);return e&&(c||o==!1)?U9(e,n):n}const dR=e=>e instanceof tc?{...e}:e;function lg(e,n){n=n||{};const o={};function c(R,k,N,U){return nn.isPlainObject(R)&&nn.isPlainObject(k)?nn.merge.call({caseless:U},R,k):nn.isPlainObject(k)?nn.merge({},k):nn.isArray(k)?k.slice():k}function d(R,k,N,U){if(nn.isUndefined(k)){if(!nn.isUndefined(R))return c(void 0,R,N,U)}else return c(R,k,N,U)}function y(R,k){if(!nn.isUndefined(k))return c(void 0,k)}function x(R,k){if(nn.isUndefined(k)){if(!nn.isUndefined(R))return c(void 0,R)}else return c(void 0,k)}function i(R,k,N){if(N in n)return c(R,k);if(N in e)return c(void 0,R)}const I={url:y,method:y,data:y,baseURL:x,transformRequest:x,transformResponse:x,paramsSerializer:x,timeout:x,timeoutMessage:x,withCredentials:x,withXSRFToken:x,adapter:x,responseType:x,xsrfCookieName:x,xsrfHeaderName:x,onUploadProgress:x,onDownloadProgress:x,decompress:x,maxContentLength:x,maxBodyLength:x,beforeRedirect:x,transport:x,httpAgent:x,httpsAgent:x,cancelToken:x,socketPath:x,responseEncoding:x,validateStatus:i,headers:(R,k,N)=>d(dR(R),dR(k),N,!0)};return nn.forEach(Object.keys(Object.assign({},e,n)),function(k){const N=I[k]||d,U=N(e[k],n[k],k);nn.isUndefined(U)&&N!==i||(o[k]=U)}),o}const kO=e=>{const n=lg({},e);let{data:o,withXSRFToken:c,xsrfHeaderName:d,xsrfCookieName:y,headers:x,auth:i}=n;n.headers=x=tc.from(x),n.url=PO(DO(n.baseURL,n.url,n.allowAbsoluteUrls),e.params,e.paramsSerializer),i&&x.set("Authorization","Basic "+btoa((i.username||"")+":"+(i.password?unescape(encodeURIComponent(i.password)):"")));let I;if(nn.isFormData(o)){if(Ga.hasStandardBrowserEnv||Ga.hasStandardBrowserWebWorkerEnv)x.setContentType(void 0);else if((I=x.getContentType())!==!1){const[R,...k]=I?I.split(";").map(N=>N.trim()).filter(Boolean):[];x.setContentType([R||"multipart/form-data",...k].join("; "))}}if(Ga.hasStandardBrowserEnv&&(c&&nn.isFunction(c)&&(c=c(n)),c||c!==!1&&j9(n.url))){const R=d&&y&&B9.read(y);R&&x.set(d,R)}return n},$9=typeof XMLHttpRequest<"u",H9=$9&&function(e){return new Promise(function(o,c){const d=kO(e);let y=d.data;const x=tc.from(d.headers).normalize();let{responseType:i,onUploadProgress:I,onDownloadProgress:R}=d,k,N,U,K,X;function Z(){K&&K(),X&&X(),d.cancelToken&&d.cancelToken.unsubscribe(k),d.signal&&d.signal.removeEventListener("abort",k)}let J=new XMLHttpRequest;J.open(d.method.toUpperCase(),d.url,!0),J.timeout=d.timeout;function le(){if(!J)return;const ue=tc.from("getAllResponseHeaders"in J&&J.getAllResponseHeaders()),he={data:!i||i==="text"||i==="json"?J.responseText:J.response,status:J.status,statusText:J.statusText,headers:ue,config:e,request:J};LO(function(fe){o(fe),Z()},function(fe){c(fe),Z()},he),J=null}"onloadend"in J?J.onloadend=le:J.onreadystatechange=function(){!J||J.readyState!==4||J.status===0&&!(J.responseURL&&J.responseURL.indexOf("file:")===0)||setTimeout(le)},J.onabort=function(){J&&(c(new bi("Request aborted",bi.ECONNABORTED,e,J)),J=null)},J.onerror=function(){c(new bi("Network Error",bi.ERR_NETWORK,e,J)),J=null},J.ontimeout=function(){let pe=d.timeout?"timeout of "+d.timeout+"ms exceeded":"timeout exceeded";const he=d.transitional||AO;d.timeoutErrorMessage&&(pe=d.timeoutErrorMessage),c(new bi(pe,he.clarifyTimeoutError?bi.ETIMEDOUT:bi.ECONNABORTED,e,J)),J=null},y===void 0&&x.setContentType(null),"setRequestHeader"in J&&nn.forEach(x.toJSON(),function(pe,he){J.setRequestHeader(he,pe)}),nn.isUndefined(d.withCredentials)||(J.withCredentials=!!d.withCredentials),i&&i!=="json"&&(J.responseType=d.responseType),R&&([U,X]=N0(R,!0),J.addEventListener("progress",U)),I&&J.upload&&([N,K]=N0(I),J.upload.addEventListener("progress",N),J.upload.addEventListener("loadend",K)),(d.cancelToken||d.signal)&&(k=ue=>{J&&(c(!ue||ue.type?new j_(null,e,J):ue),J.abort(),J=null)},d.cancelToken&&d.cancelToken.subscribe(k),d.signal&&(d.signal.aborted?k():d.signal.addEventListener("abort",k)));const de=z9(d.url);if(de&&Ga.protocols.indexOf(de)===-1){c(new bi("Unsupported protocol "+de+":",bi.ERR_BAD_REQUEST,e));return}J.send(y||null)})},G9=(e,n)=>{const{length:o}=e=e?e.filter(Boolean):[];if(n||o){let c=new AbortController,d;const y=function(R){if(!d){d=!0,i();const k=R instanceof Error?R:this.reason;c.abort(k instanceof bi?k:new j_(k instanceof Error?k.message:k))}};let x=n&&setTimeout(()=>{x=null,y(new bi(`timeout ${n} of ms exceeded`,bi.ETIMEDOUT))},n);const i=()=>{e&&(x&&clearTimeout(x),x=null,e.forEach(R=>{R.unsubscribe?R.unsubscribe(y):R.removeEventListener("abort",y)}),e=null)};e.forEach(R=>R.addEventListener("abort",y));const{signal:I}=c;return I.unsubscribe=()=>nn.asap(i),I}},W9=function*(e,n){let o=e.byteLength;if(o<n){yield e;return}let c=0,d;for(;c<o;)d=c+n,yield e.slice(c,d),c=d},q9=async function*(e,n){for await(const o of Z9(e))yield*W9(o,n)},Z9=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const n=e.getReader();try{for(;;){const{done:o,value:c}=await n.read();if(o)break;yield c}}finally{await n.cancel()}},hR=(e,n,o,c)=>{const d=q9(e,n);let y=0,x,i=I=>{x||(x=!0,c&&c(I))};return new ReadableStream({async pull(I){try{const{done:R,value:k}=await d.next();if(R){i(),I.close();return}let N=k.byteLength;if(o){let U=y+=N;o(U)}I.enqueue(new Uint8Array(k))}catch(R){throw i(R),R}},cancel(I){return i(I),d.return()}},{highWaterMark:2})},D1=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",OO=D1&&typeof ReadableStream=="function",X9=D1&&(typeof TextEncoder=="function"?(e=>n=>e.encode(n))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),zO=(e,...n)=>{try{return!!e(...n)}catch{return!1}},K9=OO&&zO(()=>{let e=!1;const n=new Request(Ga.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!n}),fR=64*1024,q2=OO&&zO(()=>nn.isReadableStream(new Response("").body)),j0={stream:q2&&(e=>e.body)};D1&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(n=>{!j0[n]&&(j0[n]=nn.isFunction(e[n])?o=>o[n]():(o,c)=>{throw new bi(`Response type '${n}' is not supported`,bi.ERR_NOT_SUPPORT,c)})})})(new Response);const Y9=async e=>{if(e==null)return 0;if(nn.isBlob(e))return e.size;if(nn.isSpecCompliantForm(e))return(await new Request(Ga.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(nn.isArrayBufferView(e)||nn.isArrayBuffer(e))return e.byteLength;if(nn.isURLSearchParams(e)&&(e=e+""),nn.isString(e))return(await X9(e)).byteLength},J9=async(e,n)=>{const o=nn.toFiniteNumber(e.getContentLength());return o??Y9(n)},Q9=D1&&(async e=>{let{url:n,method:o,data:c,signal:d,cancelToken:y,timeout:x,onDownloadProgress:i,onUploadProgress:I,responseType:R,headers:k,withCredentials:N="same-origin",fetchOptions:U}=kO(e);R=R?(R+"").toLowerCase():"text";let K=G9([d,y&&y.toAbortSignal()],x),X;const Z=K&&K.unsubscribe&&(()=>{K.unsubscribe()});let J;try{if(I&&K9&&o!=="get"&&o!=="head"&&(J=await J9(k,c))!==0){let he=new Request(n,{method:"POST",body:c,duplex:"half"}),xe;if(nn.isFormData(c)&&(xe=he.headers.get("content-type"))&&k.setContentType(xe),he.body){const[fe,_e]=cR(J,N0(uR(I)));c=hR(he.body,fR,fe,_e)}}nn.isString(N)||(N=N?"include":"omit");const le="credentials"in Request.prototype;X=new Request(n,{...U,signal:K,method:o.toUpperCase(),headers:k.normalize().toJSON(),body:c,duplex:"half",credentials:le?N:void 0});let de=await fetch(X);const ue=q2&&(R==="stream"||R==="response");if(q2&&(i||ue&&Z)){const he={};["status","statusText","headers"].forEach(Ce=>{he[Ce]=de[Ce]});const xe=nn.toFiniteNumber(de.headers.get("content-length")),[fe,_e]=i&&cR(xe,N0(uR(i),!0))||[];de=new Response(hR(de.body,fR,fe,()=>{_e&&_e(),Z&&Z()}),he)}R=R||"text";let pe=await j0[nn.findKey(j0,R)||"text"](de,e);return!ue&&Z&&Z(),await new Promise((he,xe)=>{LO(he,xe,{data:pe,headers:tc.from(de.headers),status:de.status,statusText:de.statusText,config:e,request:X})})}catch(le){throw Z&&Z(),le&&le.name==="TypeError"&&/Load failed|fetch/i.test(le.message)?Object.assign(new bi("Network Error",bi.ERR_NETWORK,e,X),{cause:le.cause||le}):bi.from(le,le&&le.code,e,X)}}),Z2={http:p9,xhr:H9,fetch:Q9};nn.forEach(Z2,(e,n)=>{if(e){try{Object.defineProperty(e,"name",{value:n})}catch{}Object.defineProperty(e,"adapterName",{value:n})}});const pR=e=>`- ${e}`,e7=e=>nn.isFunction(e)||e===null||e===!1,FO={getAdapter:e=>{e=nn.isArray(e)?e:[e];const{length:n}=e;let o,c;const d={};for(let y=0;y<n;y++){o=e[y];let x;if(c=o,!e7(o)&&(c=Z2[(x=String(o)).toLowerCase()],c===void 0))throw new bi(`Unknown adapter '${x}'`);if(c)break;d[x||"#"+y]=c}if(!c){const y=Object.entries(d).map(([i,I])=>`adapter ${i} `+(I===!1?"is not supported by the environment":"is not available in the build"));let x=n?y.length>1?`since :
`+y.map(pR).join(`
`):" "+pR(y[0]):"as no adapter specified";throw new bi("There is no suitable adapter to dispatch the request "+x,"ERR_NOT_SUPPORT")}return c},adapters:Z2};function Gw(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new j_(null,e)}function mR(e){return Gw(e),e.headers=tc.from(e.headers),e.data=Hw.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),FO.getAdapter(e.adapter||Hv.adapter)(e).then(function(c){return Gw(e),c.data=Hw.call(e,e.transformResponse,c),c.headers=tc.from(c.headers),c},function(c){return MO(c)||(Gw(e),c&&c.response&&(c.response.data=Hw.call(e,e.transformResponse,c.response),c.response.headers=tc.from(c.response.headers))),Promise.reject(c)})}const NO="1.9.0",k1={};["object","boolean","number","function","string","symbol"].forEach((e,n)=>{k1[e]=function(c){return typeof c===e||"a"+(n<1?"n ":" ")+e}});const gR={};k1.transitional=function(n,o,c){function d(y,x){return"[Axios v"+NO+"] Transitional option '"+y+"'"+x+(c?". "+c:"")}return(y,x,i)=>{if(n===!1)throw new bi(d(x," has been removed"+(o?" in "+o:"")),bi.ERR_DEPRECATED);return o&&!gR[x]&&(gR[x]=!0,console.warn(d(x," has been deprecated since v"+o+" and will be removed in the near future"))),n?n(y,x,i):!0}};k1.spelling=function(n){return(o,c)=>(console.warn(`${c} is likely a misspelling of ${n}`),!0)};function t7(e,n,o){if(typeof e!="object")throw new bi("options must be an object",bi.ERR_BAD_OPTION_VALUE);const c=Object.keys(e);let d=c.length;for(;d-- >0;){const y=c[d],x=n[y];if(x){const i=e[y],I=i===void 0||x(i,y,e);if(I!==!0)throw new bi("option "+y+" must be "+I,bi.ERR_BAD_OPTION_VALUE);continue}if(o!==!0)throw new bi("Unknown option "+y,bi.ERR_BAD_OPTION)}}const x0={assertOptions:t7,validators:k1},fh=x0.validators;let ig=class{constructor(n){this.defaults=n||{},this.interceptors={request:new aR,response:new aR}}async request(n,o){try{return await this._request(n,o)}catch(c){if(c instanceof Error){let d={};Error.captureStackTrace?Error.captureStackTrace(d):d=new Error;const y=d.stack?d.stack.replace(/^.+\n/,""):"";try{c.stack?y&&!String(c.stack).endsWith(y.replace(/^.+\n.+\n/,""))&&(c.stack+=`
`+y):c.stack=y}catch{}}throw c}}_request(n,o){typeof n=="string"?(o=o||{},o.url=n):o=n||{},o=lg(this.defaults,o);const{transitional:c,paramsSerializer:d,headers:y}=o;c!==void 0&&x0.assertOptions(c,{silentJSONParsing:fh.transitional(fh.boolean),forcedJSONParsing:fh.transitional(fh.boolean),clarifyTimeoutError:fh.transitional(fh.boolean)},!1),d!=null&&(nn.isFunction(d)?o.paramsSerializer={serialize:d}:x0.assertOptions(d,{encode:fh.function,serialize:fh.function},!0)),o.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?o.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:o.allowAbsoluteUrls=!0),x0.assertOptions(o,{baseUrl:fh.spelling("baseURL"),withXsrfToken:fh.spelling("withXSRFToken")},!0),o.method=(o.method||this.defaults.method||"get").toLowerCase();let x=y&&nn.merge(y.common,y[o.method]);y&&nn.forEach(["delete","get","head","post","put","patch","common"],X=>{delete y[X]}),o.headers=tc.concat(x,y);const i=[];let I=!0;this.interceptors.request.forEach(function(Z){typeof Z.runWhen=="function"&&Z.runWhen(o)===!1||(I=I&&Z.synchronous,i.unshift(Z.fulfilled,Z.rejected))});const R=[];this.interceptors.response.forEach(function(Z){R.push(Z.fulfilled,Z.rejected)});let k,N=0,U;if(!I){const X=[mR.bind(this),void 0];for(X.unshift.apply(X,i),X.push.apply(X,R),U=X.length,k=Promise.resolve(o);N<U;)k=k.then(X[N++],X[N++]);return k}U=i.length;let K=o;for(N=0;N<U;){const X=i[N++],Z=i[N++];try{K=X(K)}catch(J){Z.call(this,J);break}}try{k=mR.call(this,K)}catch(X){return Promise.reject(X)}for(N=0,U=R.length;N<U;)k=k.then(R[N++],R[N++]);return k}getUri(n){n=lg(this.defaults,n);const o=DO(n.baseURL,n.url,n.allowAbsoluteUrls);return PO(o,n.params,n.paramsSerializer)}};nn.forEach(["delete","get","head","options"],function(n){ig.prototype[n]=function(o,c){return this.request(lg(c||{},{method:n,url:o,data:(c||{}).data}))}});nn.forEach(["post","put","patch"],function(n){function o(c){return function(y,x,i){return this.request(lg(i||{},{method:n,headers:c?{"Content-Type":"multipart/form-data"}:{},url:y,data:x}))}}ig.prototype[n]=o(),ig.prototype[n+"Form"]=o(!0)});let n7=class jO{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let o;this.promise=new Promise(function(y){o=y});const c=this;this.promise.then(d=>{if(!c._listeners)return;let y=c._listeners.length;for(;y-- >0;)c._listeners[y](d);c._listeners=null}),this.promise.then=d=>{let y;const x=new Promise(i=>{c.subscribe(i),y=i}).then(d);return x.cancel=function(){c.unsubscribe(y)},x},n(function(y,x,i){c.reason||(c.reason=new j_(y,x,i),o(c.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const o=this._listeners.indexOf(n);o!==-1&&this._listeners.splice(o,1)}toAbortSignal(){const n=new AbortController,o=c=>{n.abort(c)};return this.subscribe(o),n.signal.unsubscribe=()=>this.unsubscribe(o),n.signal}static source(){let n;return{token:new jO(function(d){n=d}),cancel:n}}};function r7(e){return function(o){return e.apply(null,o)}}function i7(e){return nn.isObject(e)&&e.isAxiosError===!0}const X2={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(X2).forEach(([e,n])=>{X2[n]=e});function BO(e){const n=new ig(e),o=gO(ig.prototype.request,n);return nn.extend(o,ig.prototype,n,{allOwnKeys:!0}),nn.extend(o,n,null,{allOwnKeys:!0}),o.create=function(d){return BO(lg(e,d))},o}const Mo=BO(Hv);Mo.Axios=ig;Mo.CanceledError=j_;Mo.CancelToken=n7;Mo.isCancel=MO;Mo.VERSION=NO;Mo.toFormData=L1;Mo.AxiosError=bi;Mo.Cancel=Mo.CanceledError;Mo.all=function(n){return Promise.all(n)};Mo.spread=r7;Mo.isAxiosError=i7;Mo.mergeConfig=lg;Mo.AxiosHeaders=tc;Mo.formToJSON=e=>RO(nn.isHTMLForm(e)?new FormData(e):e);Mo.getAdapter=FO.getAdapter;Mo.HttpStatusCode=X2;Mo.default=Mo;const{Axios:dce,AxiosError:hce,CanceledError:fce,isCancel:pce,CancelToken:mce,VERSION:gce,all:_ce,Cancel:yce,isAxiosError:vce,spread:xce,toFormData:bce,AxiosHeaders:wce,HttpStatusCode:Sce,formToJSON:Cce,getAdapter:Tce,mergeConfig:Ece}=Mo,VO=V.createContext(),s7=({children:e,onLogout:n})=>{const o=V.useMemo(()=>{const I=Mo.create({baseURL:"http://localhost:8080/"});return I.interceptors.request.use(R=>{const k=sessionStorage.getItem("token");return k&&(R.headers.Authorization=`Bearer ${k}`),R}),I.interceptors.response.use(R=>R.data,R=>(R.response?(console.error("Server error:",R.response.status,R.response.data),R.response.status===401&&(typeof n=="function"&&n(),setTimeout(()=>{const k=sessionStorage.getItem("token");k?console.warn("%cDconnexion attendue, mais le token existe encore :","color: orange; font-weight: bold;",k):console.info("%cVous tes dconnect(e). Le token est maintenant vide.","color: green; font-weight: bold;")},100))):R.request?console.error("No response received:",R.request):console.error("Request setup error:",R.message),Promise.reject(R))),I},[n]),c=V.useCallback(async(I,R={})=>o.get(I,R),[o]),d=V.useCallback(async(I,R,k={})=>o.post(I,R,k),[o]),y=V.useCallback(async(I,R,k={})=>o.put(I,R,k),[o]),x=V.useCallback(async(I,R={})=>o.delete(I,R),[o]),i=V.useMemo(()=>({axiosInstance:o,get:c,post:d,put:y,delete:x}),[o,x,c,d,y]);return T.jsx(VO.Provider,{value:i,children:e})},o7=()=>{const e=V.useContext(VO);if(!e)throw new Error("useAxiosContext must be used within an AxiosProvider");return e};function ml(){const{axiosInstance:e}=o7();return e}const UO=V.createContext(),a7=({children:e})=>{const[n,o]=V.useState(null),c=V.useCallback((y,x="info",i=4e3)=>{o({message:y,type:x}),i>0&&setTimeout(()=>o(null),i)},[]),d=V.useCallback(()=>o(null),[]);return T.jsx(UO.Provider,{value:{notification:n,showNotification:c,clearNotification:d},children:e})},gC=()=>V.useContext(UO),l7=({message:e="Chargement..."})=>T.jsxs("div",{className:"d-flex flex-column align-items-center justify-content-center p-4",children:[T.jsx(xu,{animation:"border",role:"status",variant:"primary",children:T.jsx("span",{className:"visually-hidden",children:e})}),T.jsx("p",{className:"mt-2",children:e})]}),$O=V.createContext(),c7=({children:e,onLogoutRef:n})=>{const{showNotification:o}=gC(),c=ml(),[d,y]=V.useState(!!sessionStorage.getItem("token")),[x,i]=V.useState(!0),[I,R]=V.useState(null),k=V.useRef(!1),N=V.useCallback(Z=>{R(Z),Z?sessionStorage.setItem("userData",JSON.stringify(Z)):sessionStorage.removeItem("userData")},[]),U=V.useCallback(async()=>{if(k.current&&I)return;if(!d){i(!1);return}const Z=sessionStorage.getItem("userData");if(Z)try{const J=JSON.parse(Z);R(J),i(!1),k.current=!0;return}catch(J){console.error("Erreur lors de la rcupration des donnes utilisateur du sessionStorage:",J)}try{const J=await c.get("users/me");N(J)}catch(J){console.error("Error fetching user data:",J),d||N(null)}finally{i(!1),k.current=!0}},[N,I,d,c]);V.useEffect(()=>{k.current||U()},[U]);const K=Cu(),X=V.useCallback((Z={})=>{y(!1),N(null),sessionStorage.removeItem("token"),k.current=!1,K("/login",{replace:!0}),Z.sessionExpired?o("Votre session a expir, veuillez vous reconnecter.","error"):o("Vous avez t dconnect.","info")},[N,K,o]);return V.useEffect(()=>{n&&(n.current=X)},[X,n]),x?T.jsx(l7,{message:"Chargement de l'authentification..."}):T.jsx($O.Provider,{value:{isLoggedIn:d,setIsLoggedIn:y,userData:I,setUserData:N,fetchUserData:U,logout:X},children:e})},Ih=()=>{const e=V.useContext($O);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e};var HO={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},_R=qi.createContext&&qi.createContext(HO),u7=["attr","size","title"];function d7(e,n){if(e==null)return{};var o=h7(e,n),c,d;if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(d=0;d<y.length;d++)c=y[d],!(n.indexOf(c)>=0)&&Object.prototype.propertyIsEnumerable.call(e,c)&&(o[c]=e[c])}return o}function h7(e,n){if(e==null)return{};var o={};for(var c in e)if(Object.prototype.hasOwnProperty.call(e,c)){if(n.indexOf(c)>=0)continue;o[c]=e[c]}return o}function B0(){return B0=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(e[c]=o[c])}return e},B0.apply(this,arguments)}function yR(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);n&&(c=c.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),o.push.apply(o,c)}return o}function V0(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{};n%2?yR(Object(o),!0).forEach(function(c){f7(e,c,o[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):yR(Object(o)).forEach(function(c){Object.defineProperty(e,c,Object.getOwnPropertyDescriptor(o,c))})}return e}function f7(e,n,o){return n=p7(n),n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function p7(e){var n=m7(e,"string");return typeof n=="symbol"?n:n+""}function m7(e,n){if(typeof e!="object"||!e)return e;var o=e[Symbol.toPrimitive];if(o!==void 0){var c=o.call(e,n);if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function GO(e){return e&&e.map((n,o)=>qi.createElement(n.tag,V0({key:o},n.attr),GO(n.child)))}function Di(e){return n=>qi.createElement(g7,B0({attr:V0({},e.attr)},n),GO(e.child))}function g7(e){var n=o=>{var{attr:c,size:d,title:y}=e,x=d7(e,u7),i=d||o.size||"1em",I;return o.className&&(I=o.className),e.className&&(I=(I?I+" ":"")+e.className),qi.createElement("svg",B0({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},o.attr,c,x,{className:I,style:V0(V0({color:e.color||o.color},o.style),e.style),height:i,width:i,xmlns:"http://www.w3.org/2000/svg"}),y&&qi.createElement("title",null,y),e.children)};return _R!==void 0?qi.createElement(_R.Consumer,null,o=>n(o)):n(HO)}function _7(e){return Di({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M279.14 288l14.22-92.66h-88.91v-60.13c0-25.35 12.42-50.06 52.24-50.06h40.42V6.26S260.43 0 225.36 0c-73.22 0-121.08 44.38-121.08 124.72v70.62H22.89V288h81.39v224h100.17V288z"},child:[]}]})(e)}function y7(e){return Di({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"},child:[]}]})(e)}function v7(e){return Di({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"},child:[]}]})(e)}function x7(e){return Di({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"},child:[]}]})(e)}function K2(e){return Di({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"},child:[]}]})(e)}function WO(e){return Di({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M448 384c-28.02 0-31.26-32-74.5-32-43.43 0-46.825 32-74.75 32-27.695 0-31.454-32-74.75-32-42.842 0-47.218 32-74.5 32-28.148 0-31.202-32-74.75-32-43.547 0-46.653 32-74.75 32v-80c0-26.5 21.5-48 48-48h16V112h64v144h64V112h64v144h64V112h64v144h16c26.5 0 48 21.5 48 48v80zm0 128H0v-96c43.356 0 46.767-32 74.75-32 27.951 0 31.253 32 74.75 32 42.843 0 47.217-32 74.5-32 28.148 0 31.201 32 74.75 32 43.357 0 46.767-32 74.75-32 27.488 0 31.252 32 74.5 32v96zM96 96c-17.75 0-32-14.25-32-32 0-31 32-23 32-64 12 0 32 29.5 32 56s-14.25 40-32 40zm128 0c-17.75 0-32-14.25-32-32 0-31 32-23 32-64 12 0 32 29.5 32 56s-14.25 40-32 40zm128 0c-17.75 0-32-14.25-32-32 0-31 32-23 32-64 12 0 32 29.5 32 56s-14.25 40-32 40z"},child:[]}]})(e)}function vR(e){return Di({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M0 464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V192H0v272zm320-196c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM192 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM64 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zM400 64h-48V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H160V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H48C21.5 64 0 85.5 0 112v48h448v-48c0-26.5-21.5-48-48-48z"},child:[]}]})(e)}function b7(e){return Di({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M12 192h424c6.6 0 12 5.4 12 12v260c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V204c0-6.6 5.4-12 12-12zm436-44v-36c0-26.5-21.5-48-48-48h-48V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H160V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H48C21.5 64 0 85.5 0 112v36c0 6.6 5.4 12 12 12h424c6.6 0 12-5.4 12-12z"},child:[]}]})(e)}function xR(e){return Di({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M512 144v288c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V144c0-26.5 21.5-48 48-48h88l12.3-32.9c7-18.7 24.9-31.1 44.9-31.1h125.5c20 0 37.9 12.4 44.9 31.1L376 96h88c26.5 0 48 21.5 48 48zM376 288c0-66.2-53.8-120-120-120s-120 53.8-120 120 53.8 120 120 120 120-53.8 120-120zm-32 0c0 48.5-39.5 88-88 88s-88-39.5-88-88 39.5-88 88-88 88 39.5 88 88z"},child:[]}]})(e)}function Ww(e){return Di({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M290.59 192c-20.18 0-106.82 1.98-162.59 85.95V192c0-52.94-43.06-96-96-96-17.67 0-32 14.33-32 32s14.33 32 32 32c17.64 0 32 14.36 32 32v256c0 35.3 28.7 64 64 64h176c8.84 0 16-7.16 16-16v-16c0-17.67-14.33-32-32-32h-32l128-96v144c0 8.84 7.16 16 16 16h32c8.84 0 16-7.16 16-16V289.86c-10.29 2.67-20.89 4.54-32 4.54-61.81 0-113.52-44.05-125.41-102.4zM448 96h-64l-64-64v134.4c0 53.02 42.98 96 96 96s96-42.98 96-96V32l-64 64zm-72 80c-8.84 0-16-7.16-16-16s7.16-16 16-16 16 7.16 16 16-7.16 16-16 16zm80 0c-8.84 0-16-7.16-16-16s7.16-16 16-16 16 7.16 16 16-7.16 16-16 16z"},child:[]}]})(e)}function w7(e){return Di({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"},child:[]}]})(e)}function S7(e){return Di({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"},child:[]}]})(e)}function C7(e){return Di({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"},child:[]}]})(e)}function T7(e){return Di({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 32C114.6 32 0 125.1 0 240c0 49.6 21.4 95 57 130.7C44.5 421.1 2.7 466 2.2 466.5c-2.2 2.3-2.8 5.7-1.5 8.7S4.8 480 8 480c66.3 0 116-31.8 140.6-51.4 32.7 12.3 69 19.4 107.4 19.4 141.4 0 256-93.1 256-208S397.4 32 256 32z"},child:[]}]})(e)}function E7(e){return Di({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M416 192c0-88.4-93.1-160-208-160S0 103.6 0 192c0 34.3 14.1 65.9 38 92-13.4 30.2-35.5 54.2-35.8 54.5-2.2 2.3-2.8 5.7-1.5 8.7S4.8 352 8 352c36.6 0 66.9-12.3 88.7-25 32.2 15.7 70.3 25 111.3 25 114.9 0 208-71.6 208-160zm122 220c23.9-26 38-57.7 38-92 0-66.9-53.5-124.2-129.3-148.1.9 6.6 1.3 13.3 1.3 20.1 0 105.9-107.7 192-240 192-10.8 0-21.3-.8-31.7-1.9C207.8 439.6 281.8 480 368 480c41 0 79.1-9.2 111.3-25 21.8 12.7 52.1 25 88.7 25 3.2 0 6.1-1.9 7.3-4.8 1.3-2.9.7-6.3-1.5-8.7-.3-.3-22.4-24.2-35.8-54.5z"},child:[]}]})(e)}function I7(e){return Di({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"},child:[]}]})(e)}function cg(e){return Di({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"},child:[]}]})(e)}function qO(e){return Di({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},child:[]}]})(e)}function Vp(e){return Di({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M320 400c-75.85 0-137.25-58.71-142.9-133.11L72.2 185.82c-13.79 17.3-26.48 35.59-36.72 55.59a32.35 32.35 0 0 0 0 29.19C89.71 376.41 197.07 448 320 448c26.91 0 52.87-4 77.89-10.46L346 397.39a144.13 144.13 0 0 1-26 2.61zm313.82 58.1l-110.55-85.44a331.25 331.25 0 0 0 81.25-102.07 32.35 32.35 0 0 0 0-29.19C550.29 135.59 442.93 64 320 64a308.15 308.15 0 0 0-147.32 37.7L45.46 3.37A16 16 0 0 0 23 6.18L3.37 31.45A16 16 0 0 0 6.18 53.9l588.36 454.73a16 16 0 0 0 22.46-2.81l19.64-25.27a16 16 0 0 0-2.82-22.45zm-183.72-142l-39.3-30.38A94.75 94.75 0 0 0 416 256a94.76 94.76 0 0 0-121.31-92.21A47.65 47.65 0 0 1 304 192a46.64 46.64 0 0 1-1.54 10l-73.61-56.89A142.31 142.31 0 0 1 320 112a143.92 143.92 0 0 1 144 144c0 21.63-5.29 41.79-13.9 60.11z"},child:[]}]})(e)}function Up(e){return Di({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"},child:[]}]})(e)}function P7(e){return Di({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.976 0H24.028C2.71 0-8.047 25.866 7.058 40.971L192 225.941V432c0 7.831 3.821 15.17 10.237 19.662l80 55.98C298.02 518.69 320 507.493 320 487.98V225.941l184.947-184.97C520.021 25.896 509.338 0 487.976 0z"},child:[]}]})(e)}function lv(e){return Di({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z"},child:[]}]})(e)}function ZO(e){return Di({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"},child:[]}]})(e)}function Y2(e){return Di({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"},child:[]}]})(e)}function XO(e){return Di({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"},child:[]}]})(e)}function S_(e){return Di({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M400 224h-24v-72C376 68.2 307.8 0 224 0S72 68.2 72 152v72H48c-26.5 0-48 21.5-48 48v192c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V272c0-26.5-21.5-48-48-48zm-104 0H152v-72c0-39.7 32.3-72 72-72s72 32.3 72 72v72z"},child:[]}]})(e)}function zc(e){return Di({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M172.268 501.67C26.97 291.031 0 269.413 0 192 0 85.961 85.961 0 192 0s192 85.961 192 192c0 77.413-26.97 99.031-172.268 309.67-9.535 13.774-29.93 13.773-39.464 0zM192 272c44.183 0 80-35.817 80-80s-35.817-80-80-80-80 35.817-80 80 35.817 80 80 80z"},child:[]}]})(e)}function hl(e){return Di({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 224c-79.41 0-192 122.76-192 200.25 0 34.9 26.81 55.75 71.74 55.75 48.84 0 81.09-25.08 120.26-25.08 39.51 0 71.85 25.08 120.26 25.08 44.93 0 71.74-20.85 71.74-55.75C448 346.76 335.41 224 256 224zm-147.28-12.61c-10.4-34.65-42.44-57.09-71.56-50.13-29.12 6.96-44.29 40.69-33.89 75.34 10.4 34.65 42.44 57.09 71.56 50.13 29.12-6.96 44.29-40.69 33.89-75.34zm84.72-20.78c30.94-8.14 46.42-49.94 34.58-93.36s-46.52-72.01-77.46-63.87-46.42 49.94-34.58 93.36c11.84 43.42 46.53 72.02 77.46 63.87zm281.39-29.34c-29.12-6.96-61.15 15.48-71.56 50.13-10.4 34.65 4.77 68.38 33.89 75.34 29.12 6.96 61.15-15.48 71.56-50.13 10.4-34.65-4.77-68.38-33.89-75.34zm-156.27 29.34c30.94 8.14 65.62-20.45 77.46-63.87 11.84-43.42-3.64-85.21-34.58-93.36s-65.62 20.45-77.46 63.87c-11.84 43.42 3.64 85.22 34.58 93.36z"},child:[]}]})(e)}function A7(e){return Di({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M109.25 173.25c24.99-24.99 24.99-65.52 0-90.51-24.99-24.99-65.52-24.99-90.51 0-24.99 24.99-24.99 65.52 0 90.51 25 25 65.52 25 90.51 0zm256 165.49c-24.99-24.99-65.52-24.99-90.51 0-24.99 24.99-24.99 65.52 0 90.51 24.99 24.99 65.52 24.99 90.51 0 25-24.99 25-65.51 0-90.51zm-1.94-231.43l-22.62-22.62c-12.5-12.5-32.76-12.5-45.25 0L20.69 359.44c-12.5 12.5-12.5 32.76 0 45.25l22.62 22.62c12.5 12.5 32.76 12.5 45.25 0l274.75-274.75c12.5-12.49 12.5-32.75 0-45.25z"},child:[]}]})(e)}function O1(e){return Di({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M493.4 24.6l-104-24c-11.3-2.6-22.9 3.3-27.5 13.9l-48 112c-4.2 9.8-1.4 21.3 6.9 28l60.6 49.6c-36 76.7-98.9 140.5-177.2 177.2l-49.6-60.6c-6.8-8.3-18.2-11.1-28-6.9l-112 48C3.9 366.5-2 378.1.6 389.4l24 104C27.1 504.2 36.7 512 48 512c256.1 0 464-207.5 464-464 0-11.2-7.7-20.9-18.6-23.4z"},child:[]}]})(e)}function _C(e){return Di({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(e)}function R7(e){return Di({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497 273L329 441c-15 15-41 4.5-41-17v-96H152c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136V88c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436v-40c0-6.6-5.4-12-12-12H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h84c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12H96c-53 0-96 43-96 96v192c0 53 43 96 96 96h84c6.6 0 12-5.4 12-12z"},child:[]}]})(e)}function M7(e){return Di({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 0 1 0 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"},child:[]}]})(e)}function U0(e){return Di({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(e)}function KO(e){return Di({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(e)}function L7(e){return Di({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M624 208h-64v-64c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v64h-64c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h64v64c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16v-64h64c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zm-400 48c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(e)}function Gp(e){return Di({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(e)}function YO(e){return Di({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M564 0h-79c-10.7 0-16 12.9-8.5 20.5l16.9 16.9-48.7 48.7C422.5 72.1 396.2 64 368 64c-33.7 0-64.6 11.6-89.2 30.9 14 16.7 25 36 32.1 57.1 14.5-14.8 34.7-24 57.1-24 44.1 0 80 35.9 80 80s-35.9 80-80 80c-22.3 0-42.6-9.2-57.1-24-7.1 21.1-18 40.4-32.1 57.1 24.5 19.4 55.5 30.9 89.2 30.9 79.5 0 144-64.5 144-144 0-28.2-8.1-54.5-22.1-76.7l48.7-48.7 16.9 16.9c2.4 2.4 5.4 3.5 8.4 3.5 6.2 0 12.1-4.8 12.1-12V12c0-6.6-5.4-12-12-12zM144 64C64.5 64 0 128.5 0 208c0 68.5 47.9 125.9 112 140.4V400H76c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h36v36c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12v-36h36c6.6 0 12-5.4 12-12v-40c0-6.6-5.4-12-12-12h-36v-51.6c64.1-14.6 112-71.9 112-140.4 0-79.5-64.5-144-144-144zm0 224c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(e)}const JO=V.createContext({});function D7(e){const n=V.useRef(null);return n.current===null&&(n.current=e()),n.current}const yC=V.createContext(null),QO=V.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function k7(e=!0){const n=V.useContext(yC);if(n===null)return[!0,null];const{isPresent:o,onExitComplete:c,register:d}=n,y=V.useId();V.useEffect(()=>{e&&d(y)},[e]);const x=V.useCallback(()=>e&&c&&c(y),[y,c,e]);return!o&&c?[!1,x]:[!0]}const vC=typeof window<"u",O7=vC?V.useLayoutEffect:V.useEffect,Mc=e=>e;let ez=Mc;function xC(e){let n;return()=>(n===void 0&&(n=e()),n)}const C_=(e,n,o)=>{const c=n-e;return c===0?1:(o-e)/c},Cf=e=>e*1e3,Tf=e=>e/1e3,z7={useManualTiming:!1};function F7(e){let n=new Set,o=new Set,c=!1,d=!1;const y=new WeakSet;let x={delta:0,timestamp:0,isProcessing:!1};function i(R){y.has(R)&&(I.schedule(R),e()),R(x)}const I={schedule:(R,k=!1,N=!1)=>{const K=N&&c?n:o;return k&&y.add(R),K.has(R)||K.add(R),R},cancel:R=>{o.delete(R),y.delete(R)},process:R=>{if(x=R,c){d=!0;return}c=!0,[n,o]=[o,n],n.forEach(i),n.clear(),c=!1,d&&(d=!1,I.process(R))}};return I}const i0=["read","resolveKeyframes","update","preRender","render","postRender"],N7=40;function tz(e,n){let o=!1,c=!0;const d={delta:0,timestamp:0,isProcessing:!1},y=()=>o=!0,x=i0.reduce((le,de)=>(le[de]=F7(y),le),{}),{read:i,resolveKeyframes:I,update:R,preRender:k,render:N,postRender:U}=x,K=()=>{const le=performance.now();o=!1,d.delta=c?1e3/60:Math.max(Math.min(le-d.timestamp,N7),1),d.timestamp=le,d.isProcessing=!0,i.process(d),I.process(d),R.process(d),k.process(d),N.process(d),U.process(d),d.isProcessing=!1,o&&n&&(c=!1,e(K))},X=()=>{o=!0,c=!0,d.isProcessing||e(K)};return{schedule:i0.reduce((le,de)=>{const ue=x[de];return le[de]=(pe,he=!1,xe=!1)=>(o||X(),ue.schedule(pe,he,xe)),le},{}),cancel:le=>{for(let de=0;de<i0.length;de++)x[i0[de]].cancel(le)},state:d,steps:x}}const{schedule:Us,cancel:Wp,state:xa,steps:qw}=tz(typeof requestAnimationFrame<"u"?requestAnimationFrame:Mc,!0),nz=V.createContext({strict:!1}),bR={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},T_={};for(const e in bR)T_[e]={isEnabled:n=>bR[e].some(o=>!!n[o])};function j7(e){for(const n in e)T_[n]={...T_[n],...e[n]}}const B7=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function $0(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||B7.has(e)}let rz=e=>!$0(e);function V7(e){e&&(rz=n=>n.startsWith("on")?!$0(n):e(n))}try{V7(require("@emotion/is-prop-valid").default)}catch{}function U7(e,n,o){const c={};for(const d in e)d==="values"&&typeof e.values=="object"||(rz(d)||o===!0&&$0(d)||!n&&!$0(d)||e.draggable&&d.startsWith("onDrag"))&&(c[d]=e[d]);return c}function $7(e){if(typeof Proxy>"u")return e;const n=new Map,o=(...c)=>e(...c);return new Proxy(o,{get:(c,d)=>d==="create"?e:(n.has(d)||n.set(d,e(d)),n.get(d))})}const z1=V.createContext({});function Sv(e){return typeof e=="string"||Array.isArray(e)}function F1(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const bC=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],wC=["initial",...bC];function N1(e){return F1(e.animate)||wC.some(n=>Sv(e[n]))}function iz(e){return!!(N1(e)||e.variants)}function H7(e,n){if(N1(e)){const{initial:o,animate:c}=e;return{initial:o===!1||Sv(o)?o:void 0,animate:Sv(c)?c:void 0}}return e.inherit!==!1?n:{}}function G7(e){const{initial:n,animate:o}=H7(e,V.useContext(z1));return V.useMemo(()=>({initial:n,animate:o}),[wR(n),wR(o)])}function wR(e){return Array.isArray(e)?e.join(" "):e}const W7=Symbol.for("motionComponentSymbol");function c_(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function q7(e,n,o){return V.useCallback(c=>{c&&e.onMount&&e.onMount(c),n&&(c?n.mount(c):n.unmount()),o&&(typeof o=="function"?o(c):c_(o)&&(o.current=c))},[n])}const SC=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Z7="framerAppearId",sz="data-"+SC(Z7),{schedule:CC}=tz(queueMicrotask,!1),oz=V.createContext({});function X7(e,n,o,c,d){var y,x;const{visualElement:i}=V.useContext(z1),I=V.useContext(nz),R=V.useContext(yC),k=V.useContext(QO).reducedMotion,N=V.useRef(null);c=c||I.renderer,!N.current&&c&&(N.current=c(e,{visualState:n,parent:i,props:o,presenceContext:R,blockInitialAnimation:R?R.initial===!1:!1,reducedMotionConfig:k}));const U=N.current,K=V.useContext(oz);U&&!U.projection&&d&&(U.type==="html"||U.type==="svg")&&K7(N.current,o,d,K);const X=V.useRef(!1);V.useInsertionEffect(()=>{U&&X.current&&U.update(o,R)});const Z=o[sz],J=V.useRef(!!Z&&!(!((y=window.MotionHandoffIsComplete)===null||y===void 0)&&y.call(window,Z))&&((x=window.MotionHasOptimisedAnimation)===null||x===void 0?void 0:x.call(window,Z)));return O7(()=>{U&&(X.current=!0,window.MotionIsMounted=!0,U.updateFeatures(),CC.render(U.render),J.current&&U.animationState&&U.animationState.animateChanges())}),V.useEffect(()=>{U&&(!J.current&&U.animationState&&U.animationState.animateChanges(),J.current&&(queueMicrotask(()=>{var le;(le=window.MotionHandoffMarkAsComplete)===null||le===void 0||le.call(window,Z)}),J.current=!1))}),U}function K7(e,n,o,c){const{layoutId:d,layout:y,drag:x,dragConstraints:i,layoutScroll:I,layoutRoot:R}=n;e.projection=new o(e.latestValues,n["data-framer-portal-id"]?void 0:az(e.parent)),e.projection.setOptions({layoutId:d,layout:y,alwaysMeasureLayout:!!x||i&&c_(i),visualElement:e,animationType:typeof y=="string"?y:"both",initialPromotionConfig:c,layoutScroll:I,layoutRoot:R})}function az(e){if(e)return e.options.allowProjection!==!1?e.projection:az(e.parent)}function Y7({preloadedFeatures:e,createVisualElement:n,useRender:o,useVisualState:c,Component:d}){var y,x;e&&j7(e);function i(R,k){let N;const U={...V.useContext(QO),...R,layoutId:J7(R)},{isStatic:K}=U,X=G7(R),Z=c(R,K);if(!K&&vC){Q7();const J=eH(U);N=J.MeasureLayout,X.visualElement=X7(d,Z,U,n,J.ProjectionNode)}return T.jsxs(z1.Provider,{value:X,children:[N&&X.visualElement?T.jsx(N,{visualElement:X.visualElement,...U}):null,o(d,R,q7(Z,X.visualElement,k),Z,K,X.visualElement)]})}i.displayName=`motion.${typeof d=="string"?d:`create(${(x=(y=d.displayName)!==null&&y!==void 0?y:d.name)!==null&&x!==void 0?x:""})`}`;const I=V.forwardRef(i);return I[W7]=d,I}function J7({layoutId:e}){const n=V.useContext(JO).id;return n&&e!==void 0?n+"-"+e:e}function Q7(e,n){V.useContext(nz).strict}function eH(e){const{drag:n,layout:o}=T_;if(!n&&!o)return{};const c={...n,...o};return{MeasureLayout:n!=null&&n.isEnabled(e)||o!=null&&o.isEnabled(e)?c.MeasureLayout:void 0,ProjectionNode:c.ProjectionNode}}const tH=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function TC(e){return typeof e!="string"||e.includes("-")?!1:!!(tH.indexOf(e)>-1||/[A-Z]/u.test(e))}function SR(e){const n=[{},{}];return e==null||e.values.forEach((o,c)=>{n[0][c]=o.get(),n[1][c]=o.getVelocity()}),n}function EC(e,n,o,c){if(typeof n=="function"){const[d,y]=SR(c);n=n(o!==void 0?o:e.custom,d,y)}if(typeof n=="string"&&(n=e.variants&&e.variants[n]),typeof n=="function"){const[d,y]=SR(c);n=n(o!==void 0?o:e.custom,d,y)}return n}const J2=e=>Array.isArray(e),nH=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),rH=e=>J2(e)?e[e.length-1]||0:e,qa=e=>!!(e&&e.getVelocity);function b0(e){const n=qa(e)?e.get():e;return nH(n)?n.toValue():n}function iH({scrapeMotionValuesFromProps:e,createRenderState:n,onUpdate:o},c,d,y){const x={latestValues:sH(c,d,y,e),renderState:n()};return o&&(x.onMount=i=>o({props:c,current:i,...x}),x.onUpdate=i=>o(i)),x}const lz=e=>(n,o)=>{const c=V.useContext(z1),d=V.useContext(yC),y=()=>iH(e,n,c,d);return o?y():D7(y)};function sH(e,n,o,c){const d={},y=c(e,{});for(const U in y)d[U]=b0(y[U]);let{initial:x,animate:i}=e;const I=N1(e),R=iz(e);n&&R&&!I&&e.inherit!==!1&&(x===void 0&&(x=n.initial),i===void 0&&(i=n.animate));let k=o?o.initial===!1:!1;k=k||x===!1;const N=k?i:x;if(N&&typeof N!="boolean"&&!F1(N)){const U=Array.isArray(N)?N:[N];for(let K=0;K<U.length;K++){const X=EC(e,U[K]);if(X){const{transitionEnd:Z,transition:J,...le}=X;for(const de in le){let ue=le[de];if(Array.isArray(ue)){const pe=k?ue.length-1:0;ue=ue[pe]}ue!==null&&(d[de]=ue)}for(const de in Z)d[de]=Z[de]}}}return d}const B_=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],yg=new Set(B_),cz=e=>n=>typeof n=="string"&&n.startsWith(e),uz=cz("--"),oH=cz("var(--"),IC=e=>oH(e)?aH.test(e.split("/*")[0].trim()):!1,aH=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,dz=(e,n)=>n&&typeof e=="number"?n.transform(e):e,Rf=(e,n,o)=>o>n?n:o<e?e:o,V_={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Cv={...V_,transform:e=>Rf(0,1,e)},s0={...V_,default:1},Gv=e=>({test:n=>typeof n=="string"&&n.endsWith(e)&&n.split(" ").length===1,parse:parseFloat,transform:n=>`${n}${e}`}),kp=Gv("deg"),Sh=Gv("%"),Kr=Gv("px"),lH=Gv("vh"),cH=Gv("vw"),CR={...Sh,parse:e=>Sh.parse(e)/100,transform:e=>Sh.transform(e*100)},uH={borderWidth:Kr,borderTopWidth:Kr,borderRightWidth:Kr,borderBottomWidth:Kr,borderLeftWidth:Kr,borderRadius:Kr,radius:Kr,borderTopLeftRadius:Kr,borderTopRightRadius:Kr,borderBottomRightRadius:Kr,borderBottomLeftRadius:Kr,width:Kr,maxWidth:Kr,height:Kr,maxHeight:Kr,top:Kr,right:Kr,bottom:Kr,left:Kr,padding:Kr,paddingTop:Kr,paddingRight:Kr,paddingBottom:Kr,paddingLeft:Kr,margin:Kr,marginTop:Kr,marginRight:Kr,marginBottom:Kr,marginLeft:Kr,backgroundPositionX:Kr,backgroundPositionY:Kr},dH={rotate:kp,rotateX:kp,rotateY:kp,rotateZ:kp,scale:s0,scaleX:s0,scaleY:s0,scaleZ:s0,skew:kp,skewX:kp,skewY:kp,distance:Kr,translateX:Kr,translateY:Kr,translateZ:Kr,x:Kr,y:Kr,z:Kr,perspective:Kr,transformPerspective:Kr,opacity:Cv,originX:CR,originY:CR,originZ:Kr},TR={...V_,transform:Math.round},PC={...uH,...dH,zIndex:TR,size:Kr,fillOpacity:Cv,strokeOpacity:Cv,numOctaves:TR},hH={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},fH=B_.length;function pH(e,n,o){let c="",d=!0;for(let y=0;y<fH;y++){const x=B_[y],i=e[x];if(i===void 0)continue;let I=!0;if(typeof i=="number"?I=i===(x.startsWith("scale")?1:0):I=parseFloat(i)===0,!I||o){const R=dz(i,PC[x]);if(!I){d=!1;const k=hH[x]||x;c+=`${k}(${R}) `}o&&(n[x]=R)}}return c=c.trim(),o?c=o(n,d?"":c):d&&(c="none"),c}function AC(e,n,o){const{style:c,vars:d,transformOrigin:y}=e;let x=!1,i=!1;for(const I in n){const R=n[I];if(yg.has(I)){x=!0;continue}else if(uz(I)){d[I]=R;continue}else{const k=dz(R,PC[I]);I.startsWith("origin")?(i=!0,y[I]=k):c[I]=k}}if(n.transform||(x||o?c.transform=pH(n,e.transform,o):c.transform&&(c.transform="none")),i){const{originX:I="50%",originY:R="50%",originZ:k=0}=y;c.transformOrigin=`${I} ${R} ${k}`}}const mH={offset:"stroke-dashoffset",array:"stroke-dasharray"},gH={offset:"strokeDashoffset",array:"strokeDasharray"};function _H(e,n,o=1,c=0,d=!0){e.pathLength=1;const y=d?mH:gH;e[y.offset]=Kr.transform(-c);const x=Kr.transform(n),i=Kr.transform(o);e[y.array]=`${x} ${i}`}function ER(e,n,o){return typeof e=="string"?e:Kr.transform(n+o*e)}function yH(e,n,o){const c=ER(n,e.x,e.width),d=ER(o,e.y,e.height);return`${c} ${d}`}function RC(e,{attrX:n,attrY:o,attrScale:c,originX:d,originY:y,pathLength:x,pathSpacing:i=1,pathOffset:I=0,...R},k,N){if(AC(e,R,N),k){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:U,style:K,dimensions:X}=e;U.transform&&(X&&(K.transform=U.transform),delete U.transform),X&&(d!==void 0||y!==void 0||K.transform)&&(K.transformOrigin=yH(X,d!==void 0?d:.5,y!==void 0?y:.5)),n!==void 0&&(U.x=n),o!==void 0&&(U.y=o),c!==void 0&&(U.scale=c),x!==void 0&&_H(U,x,i,I,!1)}const MC=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),hz=()=>({...MC(),attrs:{}}),LC=e=>typeof e=="string"&&e.toLowerCase()==="svg";function fz(e,{style:n,vars:o},c,d){Object.assign(e.style,n,d&&d.getProjectionStyles(c));for(const y in o)e.style.setProperty(y,o[y])}const pz=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function mz(e,n,o,c){fz(e,n,void 0,c);for(const d in n.attrs)e.setAttribute(pz.has(d)?d:SC(d),n.attrs[d])}const H0={};function vH(e){Object.assign(H0,e)}function gz(e,{layout:n,layoutId:o}){return yg.has(e)||e.startsWith("origin")||(n||o!==void 0)&&(!!H0[e]||e==="opacity")}function DC(e,n,o){var c;const{style:d}=e,y={};for(const x in d)(qa(d[x])||n.style&&qa(n.style[x])||gz(x,e)||((c=o==null?void 0:o.getValue(x))===null||c===void 0?void 0:c.liveStyle)!==void 0)&&(y[x]=d[x]);return y}function _z(e,n,o){const c=DC(e,n,o);for(const d in e)if(qa(e[d])||qa(n[d])){const y=B_.indexOf(d)!==-1?"attr"+d.charAt(0).toUpperCase()+d.substring(1):d;c[y]=e[d]}return c}function xH(e,n){try{n.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{n.dimensions={x:0,y:0,width:0,height:0}}}const IR=["x","y","width","height","cx","cy","r"],bH={useVisualState:lz({scrapeMotionValuesFromProps:_z,createRenderState:hz,onUpdate:({props:e,prevProps:n,current:o,renderState:c,latestValues:d})=>{if(!o)return;let y=!!e.drag;if(!y){for(const i in d)if(yg.has(i)){y=!0;break}}if(!y)return;let x=!n;if(n)for(let i=0;i<IR.length;i++){const I=IR[i];e[I]!==n[I]&&(x=!0)}x&&Us.read(()=>{xH(o,c),Us.render(()=>{RC(c,d,LC(o.tagName),e.transformTemplate),mz(o,c)})})}})},wH={useVisualState:lz({scrapeMotionValuesFromProps:DC,createRenderState:MC})};function yz(e,n,o){for(const c in n)!qa(n[c])&&!gz(c,o)&&(e[c]=n[c])}function SH({transformTemplate:e},n){return V.useMemo(()=>{const o=MC();return AC(o,n,e),Object.assign({},o.vars,o.style)},[n])}function CH(e,n){const o=e.style||{},c={};return yz(c,o,e),Object.assign(c,SH(e,n)),c}function TH(e,n){const o={},c=CH(e,n);return e.drag&&e.dragListener!==!1&&(o.draggable=!1,c.userSelect=c.WebkitUserSelect=c.WebkitTouchCallout="none",c.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(o.tabIndex=0),o.style=c,o}function EH(e,n,o,c){const d=V.useMemo(()=>{const y=hz();return RC(y,n,LC(c),e.transformTemplate),{...y.attrs,style:{...y.style}}},[n]);if(e.style){const y={};yz(y,e.style,e),d.style={...y,...d.style}}return d}function IH(e=!1){return(o,c,d,{latestValues:y},x)=>{const I=(TC(o)?EH:TH)(c,y,x,o),R=U7(c,typeof o=="string",e),k=o!==V.Fragment?{...R,...I,ref:d}:{},{children:N}=c,U=V.useMemo(()=>qa(N)?N.get():N,[N]);return V.createElement(o,{...k,children:U})}}function PH(e,n){return function(c,{forwardMotionProps:d}={forwardMotionProps:!1}){const x={...TC(c)?bH:wH,preloadedFeatures:e,useRender:IH(d),createVisualElement:n,Component:c};return Y7(x)}}function vz(e,n){if(!Array.isArray(n))return!1;const o=n.length;if(o!==e.length)return!1;for(let c=0;c<o;c++)if(n[c]!==e[c])return!1;return!0}function j1(e,n,o){const c=e.getProps();return EC(c,n,o!==void 0?o:c.custom,e)}const AH=xC(()=>window.ScrollTimeline!==void 0);class RH{constructor(n){this.stop=()=>this.runAll("stop"),this.animations=n.filter(Boolean)}get finished(){return Promise.all(this.animations.map(n=>"finished"in n?n.finished:n))}getAll(n){return this.animations[0][n]}setAll(n,o){for(let c=0;c<this.animations.length;c++)this.animations[c][n]=o}attachTimeline(n,o){const c=this.animations.map(d=>{if(AH()&&d.attachTimeline)return d.attachTimeline(n);if(typeof o=="function")return o(d)});return()=>{c.forEach((d,y)=>{d&&d(),this.animations[y].stop()})}}get time(){return this.getAll("time")}set time(n){this.setAll("time",n)}get speed(){return this.getAll("speed")}set speed(n){this.setAll("speed",n)}get startTime(){return this.getAll("startTime")}get duration(){let n=0;for(let o=0;o<this.animations.length;o++)n=Math.max(n,this.animations[o].duration);return n}runAll(n){this.animations.forEach(o=>o[n]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class MH extends RH{then(n,o){return Promise.all(this.animations).then(n).catch(o)}}function kC(e,n){return e?e[n]||e.default||e:void 0}const Q2=2e4;function xz(e){let n=0;const o=50;let c=e.next(n);for(;!c.done&&n<Q2;)n+=o,c=e.next(n);return n>=Q2?1/0:n}function OC(e){return typeof e=="function"}function PR(e,n){e.timeline=n,e.onfinish=null}const zC=e=>Array.isArray(e)&&typeof e[0]=="number",LH={linearEasing:void 0};function DH(e,n){const o=xC(e);return()=>{var c;return(c=LH[n])!==null&&c!==void 0?c:o()}}const G0=DH(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),bz=(e,n,o=10)=>{let c="";const d=Math.max(Math.round(n/o),2);for(let y=0;y<d;y++)c+=e(C_(0,d-1,y))+", ";return`linear(${c.substring(0,c.length-2)})`};function wz(e){return!!(typeof e=="function"&&G0()||!e||typeof e=="string"&&(e in eS||G0())||zC(e)||Array.isArray(e)&&e.every(wz))}const tv=([e,n,o,c])=>`cubic-bezier(${e}, ${n}, ${o}, ${c})`,eS={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:tv([0,.65,.55,1]),circOut:tv([.55,0,1,.45]),backIn:tv([.31,.01,.66,-.59]),backOut:tv([.33,1.53,.69,.99])};function Sz(e,n){if(e)return typeof e=="function"&&G0()?bz(e,n):zC(e)?tv(e):Array.isArray(e)?e.map(o=>Sz(o,n)||eS.easeOut):eS[e]}const dd={x:!1,y:!1};function Cz(){return dd.x||dd.y}function kH(e,n,o){var c;if(e instanceof Element)return[e];if(typeof e=="string"){let d=document;const y=(c=void 0)!==null&&c!==void 0?c:d.querySelectorAll(e);return y?Array.from(y):[]}return Array.from(e)}function Tz(e,n){const o=kH(e),c=new AbortController,d={passive:!0,...n,signal:c.signal};return[o,d,()=>c.abort()]}function AR(e){return n=>{n.pointerType==="touch"||Cz()||e(n)}}function OH(e,n,o={}){const[c,d,y]=Tz(e,o),x=AR(i=>{const{target:I}=i,R=n(i);if(typeof R!="function"||!I)return;const k=AR(N=>{R(N),I.removeEventListener("pointerleave",k)});I.addEventListener("pointerleave",k,d)});return c.forEach(i=>{i.addEventListener("pointerenter",x,d)}),y}const Ez=(e,n)=>n?e===n?!0:Ez(e,n.parentElement):!1,FC=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,zH=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function FH(e){return zH.has(e.tagName)||e.tabIndex!==-1}const nv=new WeakSet;function RR(e){return n=>{n.key==="Enter"&&e(n)}}function Zw(e,n){e.dispatchEvent(new PointerEvent("pointer"+n,{isPrimary:!0,bubbles:!0}))}const NH=(e,n)=>{const o=e.currentTarget;if(!o)return;const c=RR(()=>{if(nv.has(o))return;Zw(o,"down");const d=RR(()=>{Zw(o,"up")}),y=()=>Zw(o,"cancel");o.addEventListener("keyup",d,n),o.addEventListener("blur",y,n)});o.addEventListener("keydown",c,n),o.addEventListener("blur",()=>o.removeEventListener("keydown",c),n)};function MR(e){return FC(e)&&!Cz()}function jH(e,n,o={}){const[c,d,y]=Tz(e,o),x=i=>{const I=i.currentTarget;if(!MR(i)||nv.has(I))return;nv.add(I);const R=n(i),k=(K,X)=>{window.removeEventListener("pointerup",N),window.removeEventListener("pointercancel",U),!(!MR(K)||!nv.has(I))&&(nv.delete(I),typeof R=="function"&&R(K,{success:X}))},N=K=>{k(K,o.useGlobalTarget||Ez(I,K.target))},U=K=>{k(K,!1)};window.addEventListener("pointerup",N,d),window.addEventListener("pointercancel",U,d)};return c.forEach(i=>{!FH(i)&&i.getAttribute("tabindex")===null&&(i.tabIndex=0),(o.useGlobalTarget?window:i).addEventListener("pointerdown",x,d),i.addEventListener("focus",R=>NH(R,d),d)}),y}function BH(e){return e==="x"||e==="y"?dd[e]?null:(dd[e]=!0,()=>{dd[e]=!1}):dd.x||dd.y?null:(dd.x=dd.y=!0,()=>{dd.x=dd.y=!1})}const Iz=new Set(["width","height","top","left","right","bottom",...B_]);let w0;function VH(){w0=void 0}const Ch={now:()=>(w0===void 0&&Ch.set(xa.isProcessing||z7.useManualTiming?xa.timestamp:performance.now()),w0),set:e=>{w0=e,queueMicrotask(VH)}};function NC(e,n){e.indexOf(n)===-1&&e.push(n)}function jC(e,n){const o=e.indexOf(n);o>-1&&e.splice(o,1)}class BC{constructor(){this.subscriptions=[]}add(n){return NC(this.subscriptions,n),()=>jC(this.subscriptions,n)}notify(n,o,c){const d=this.subscriptions.length;if(d)if(d===1)this.subscriptions[0](n,o,c);else for(let y=0;y<d;y++){const x=this.subscriptions[y];x&&x(n,o,c)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function Pz(e,n){return n?e*(1e3/n):0}const LR=30,UH=e=>!isNaN(parseFloat(e));class $H{constructor(n,o={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(c,d=!0)=>{const y=Ch.now();this.updatedAt!==y&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(c),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),d&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(n),this.owner=o.owner}setCurrent(n){this.current=n,this.updatedAt=Ch.now(),this.canTrackVelocity===null&&n!==void 0&&(this.canTrackVelocity=UH(this.current))}setPrevFrameValue(n=this.current){this.prevFrameValue=n,this.prevUpdatedAt=this.updatedAt}onChange(n){return this.on("change",n)}on(n,o){this.events[n]||(this.events[n]=new BC);const c=this.events[n].add(o);return n==="change"?()=>{c(),Us.read(()=>{this.events.change.getSize()||this.stop()})}:c}clearListeners(){for(const n in this.events)this.events[n].clear()}attach(n,o){this.passiveEffect=n,this.stopPassiveEffect=o}set(n,o=!0){!o||!this.passiveEffect?this.updateAndNotify(n,o):this.passiveEffect(n,this.updateAndNotify)}setWithVelocity(n,o,c){this.set(o),this.prev=void 0,this.prevFrameValue=n,this.prevUpdatedAt=this.updatedAt-c}jump(n,o=!0){this.updateAndNotify(n),this.prev=n,this.prevUpdatedAt=this.prevFrameValue=void 0,o&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const n=Ch.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||n-this.updatedAt>LR)return 0;const o=Math.min(this.updatedAt-this.prevUpdatedAt,LR);return Pz(parseFloat(this.current)-parseFloat(this.prevFrameValue),o)}start(n){return this.stop(),new Promise(o=>{this.hasAnimated=!0,this.animation=n(o),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Tv(e,n){return new $H(e,n)}function HH(e,n,o){e.hasValue(n)?e.getValue(n).set(o):e.addValue(n,Tv(o))}function GH(e,n){const o=j1(e,n);let{transitionEnd:c={},transition:d={},...y}=o||{};y={...y,...c};for(const x in y){const i=rH(y[x]);HH(e,x,i)}}function WH(e){return!!(qa(e)&&e.add)}function tS(e,n){const o=e.getValue("willChange");if(WH(o))return o.add(n)}function Az(e){return e.props[sz]}const Rz=(e,n,o)=>(((1-3*o+3*n)*e+(3*o-6*n))*e+3*n)*e,qH=1e-7,ZH=12;function XH(e,n,o,c,d){let y,x,i=0;do x=n+(o-n)/2,y=Rz(x,c,d)-e,y>0?o=x:n=x;while(Math.abs(y)>qH&&++i<ZH);return x}function Wv(e,n,o,c){if(e===n&&o===c)return Mc;const d=y=>XH(y,0,1,e,o);return y=>y===0||y===1?y:Rz(d(y),n,c)}const Mz=e=>n=>n<=.5?e(2*n)/2:(2-e(2*(1-n)))/2,Lz=e=>n=>1-e(1-n),Dz=Wv(.33,1.53,.69,.99),VC=Lz(Dz),kz=Mz(VC),Oz=e=>(e*=2)<1?.5*VC(e):.5*(2-Math.pow(2,-10*(e-1))),UC=e=>1-Math.sin(Math.acos(e)),zz=Lz(UC),Fz=Mz(UC),Nz=e=>/^0[^.\s]+$/u.test(e);function KH(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||Nz(e):!0}const cv=e=>Math.round(e*1e5)/1e5,$C=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function YH(e){return e==null}const JH=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,HC=(e,n)=>o=>!!(typeof o=="string"&&JH.test(o)&&o.startsWith(e)||n&&!YH(o)&&Object.prototype.hasOwnProperty.call(o,n)),jz=(e,n,o)=>c=>{if(typeof c!="string")return c;const[d,y,x,i]=c.match($C);return{[e]:parseFloat(d),[n]:parseFloat(y),[o]:parseFloat(x),alpha:i!==void 0?parseFloat(i):1}},QH=e=>Rf(0,255,e),Xw={...V_,transform:e=>Math.round(QH(e))},eg={test:HC("rgb","red"),parse:jz("red","green","blue"),transform:({red:e,green:n,blue:o,alpha:c=1})=>"rgba("+Xw.transform(e)+", "+Xw.transform(n)+", "+Xw.transform(o)+", "+cv(Cv.transform(c))+")"};function eG(e){let n="",o="",c="",d="";return e.length>5?(n=e.substring(1,3),o=e.substring(3,5),c=e.substring(5,7),d=e.substring(7,9)):(n=e.substring(1,2),o=e.substring(2,3),c=e.substring(3,4),d=e.substring(4,5),n+=n,o+=o,c+=c,d+=d),{red:parseInt(n,16),green:parseInt(o,16),blue:parseInt(c,16),alpha:d?parseInt(d,16)/255:1}}const nS={test:HC("#"),parse:eG,transform:eg.transform},u_={test:HC("hsl","hue"),parse:jz("hue","saturation","lightness"),transform:({hue:e,saturation:n,lightness:o,alpha:c=1})=>"hsla("+Math.round(e)+", "+Sh.transform(cv(n))+", "+Sh.transform(cv(o))+", "+cv(Cv.transform(c))+")"},Ua={test:e=>eg.test(e)||nS.test(e)||u_.test(e),parse:e=>eg.test(e)?eg.parse(e):u_.test(e)?u_.parse(e):nS.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?eg.transform(e):u_.transform(e)},tG=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function nG(e){var n,o;return isNaN(e)&&typeof e=="string"&&(((n=e.match($C))===null||n===void 0?void 0:n.length)||0)+(((o=e.match(tG))===null||o===void 0?void 0:o.length)||0)>0}const Bz="number",Vz="color",rG="var",iG="var(",DR="${}",sG=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Ev(e){const n=e.toString(),o=[],c={color:[],number:[],var:[]},d=[];let y=0;const i=n.replace(sG,I=>(Ua.test(I)?(c.color.push(y),d.push(Vz),o.push(Ua.parse(I))):I.startsWith(iG)?(c.var.push(y),d.push(rG),o.push(I)):(c.number.push(y),d.push(Bz),o.push(parseFloat(I))),++y,DR)).split(DR);return{values:o,split:i,indexes:c,types:d}}function Uz(e){return Ev(e).values}function $z(e){const{split:n,types:o}=Ev(e),c=n.length;return d=>{let y="";for(let x=0;x<c;x++)if(y+=n[x],d[x]!==void 0){const i=o[x];i===Bz?y+=cv(d[x]):i===Vz?y+=Ua.transform(d[x]):y+=d[x]}return y}}const oG=e=>typeof e=="number"?0:e;function aG(e){const n=Uz(e);return $z(e)(n.map(oG))}const qp={test:nG,parse:Uz,createTransformer:$z,getAnimatableNone:aG},lG=new Set(["brightness","contrast","saturate","opacity"]);function cG(e){const[n,o]=e.slice(0,-1).split("(");if(n==="drop-shadow")return e;const[c]=o.match($C)||[];if(!c)return e;const d=o.replace(c,"");let y=lG.has(n)?1:0;return c!==o&&(y*=100),n+"("+y+d+")"}const uG=/\b([a-z-]*)\(.*?\)/gu,rS={...qp,getAnimatableNone:e=>{const n=e.match(uG);return n?n.map(cG).join(" "):e}},dG={...PC,color:Ua,backgroundColor:Ua,outlineColor:Ua,fill:Ua,stroke:Ua,borderColor:Ua,borderTopColor:Ua,borderRightColor:Ua,borderBottomColor:Ua,borderLeftColor:Ua,filter:rS,WebkitFilter:rS},GC=e=>dG[e];function Hz(e,n){let o=GC(e);return o!==rS&&(o=qp),o.getAnimatableNone?o.getAnimatableNone(n):void 0}const hG=new Set(["auto","none","0"]);function fG(e,n,o){let c=0,d;for(;c<e.length&&!d;){const y=e[c];typeof y=="string"&&!hG.has(y)&&Ev(y).values.length&&(d=e[c]),c++}if(d&&o)for(const y of n)e[y]=Hz(o,d)}const kR=e=>e===V_||e===Kr,OR=(e,n)=>parseFloat(e.split(", ")[n]),zR=(e,n)=>(o,{transform:c})=>{if(c==="none"||!c)return 0;const d=c.match(/^matrix3d\((.+)\)$/u);if(d)return OR(d[1],n);{const y=c.match(/^matrix\((.+)\)$/u);return y?OR(y[1],e):0}},pG=new Set(["x","y","z"]),mG=B_.filter(e=>!pG.has(e));function gG(e){const n=[];return mG.forEach(o=>{const c=e.getValue(o);c!==void 0&&(n.push([o,c.get()]),c.set(o.startsWith("scale")?1:0))}),n}const E_={width:({x:e},{paddingLeft:n="0",paddingRight:o="0"})=>e.max-e.min-parseFloat(n)-parseFloat(o),height:({y:e},{paddingTop:n="0",paddingBottom:o="0"})=>e.max-e.min-parseFloat(n)-parseFloat(o),top:(e,{top:n})=>parseFloat(n),left:(e,{left:n})=>parseFloat(n),bottom:({y:e},{top:n})=>parseFloat(n)+(e.max-e.min),right:({x:e},{left:n})=>parseFloat(n)+(e.max-e.min),x:zR(4,13),y:zR(5,14)};E_.translateX=E_.x;E_.translateY=E_.y;const sg=new Set;let iS=!1,sS=!1;function Gz(){if(sS){const e=Array.from(sg).filter(c=>c.needsMeasurement),n=new Set(e.map(c=>c.element)),o=new Map;n.forEach(c=>{const d=gG(c);d.length&&(o.set(c,d),c.render())}),e.forEach(c=>c.measureInitialState()),n.forEach(c=>{c.render();const d=o.get(c);d&&d.forEach(([y,x])=>{var i;(i=c.getValue(y))===null||i===void 0||i.set(x)})}),e.forEach(c=>c.measureEndState()),e.forEach(c=>{c.suspendedScrollY!==void 0&&window.scrollTo(0,c.suspendedScrollY)})}sS=!1,iS=!1,sg.forEach(e=>e.complete()),sg.clear()}function Wz(){sg.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(sS=!0)})}function _G(){Wz(),Gz()}class WC{constructor(n,o,c,d,y,x=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...n],this.onComplete=o,this.name=c,this.motionValue=d,this.element=y,this.isAsync=x}scheduleResolve(){this.isScheduled=!0,this.isAsync?(sg.add(this),iS||(iS=!0,Us.read(Wz),Us.resolveKeyframes(Gz))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:n,name:o,element:c,motionValue:d}=this;for(let y=0;y<n.length;y++)if(n[y]===null)if(y===0){const x=d==null?void 0:d.get(),i=n[n.length-1];if(x!==void 0)n[0]=x;else if(c&&o){const I=c.readValue(o,i);I!=null&&(n[0]=I)}n[0]===void 0&&(n[0]=i),d&&x===void 0&&d.set(n[0])}else n[y]=n[y-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),sg.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,sg.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const qz=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),yG=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function vG(e){const n=yG.exec(e);if(!n)return[,];const[,o,c,d]=n;return[`--${o??c}`,d]}function Zz(e,n,o=1){const[c,d]=vG(e);if(!c)return;const y=window.getComputedStyle(n).getPropertyValue(c);if(y){const x=y.trim();return qz(x)?parseFloat(x):x}return IC(d)?Zz(d,n,o+1):d}const Xz=e=>n=>n.test(e),xG={test:e=>e==="auto",parse:e=>e},Kz=[V_,Kr,Sh,kp,cH,lH,xG],FR=e=>Kz.find(Xz(e));class Yz extends WC{constructor(n,o,c,d,y){super(n,o,c,d,y,!0)}readKeyframes(){const{unresolvedKeyframes:n,element:o,name:c}=this;if(!o||!o.current)return;super.readKeyframes();for(let I=0;I<n.length;I++){let R=n[I];if(typeof R=="string"&&(R=R.trim(),IC(R))){const k=Zz(R,o.current);k!==void 0&&(n[I]=k),I===n.length-1&&(this.finalKeyframe=R)}}if(this.resolveNoneKeyframes(),!Iz.has(c)||n.length!==2)return;const[d,y]=n,x=FR(d),i=FR(y);if(x!==i)if(kR(x)&&kR(i))for(let I=0;I<n.length;I++){const R=n[I];typeof R=="string"&&(n[I]=parseFloat(R))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:n,name:o}=this,c=[];for(let d=0;d<n.length;d++)KH(n[d])&&c.push(d);c.length&&fG(n,c,o)}measureInitialState(){const{element:n,unresolvedKeyframes:o,name:c}=this;if(!n||!n.current)return;c==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=E_[c](n.measureViewportBox(),window.getComputedStyle(n.current)),o[0]=this.measuredOrigin;const d=o[o.length-1];d!==void 0&&n.getValue(c,d).jump(d,!1)}measureEndState(){var n;const{element:o,name:c,unresolvedKeyframes:d}=this;if(!o||!o.current)return;const y=o.getValue(c);y&&y.jump(this.measuredOrigin,!1);const x=d.length-1,i=d[x];d[x]=E_[c](o.measureViewportBox(),window.getComputedStyle(o.current)),i!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=i),!((n=this.removedTransforms)===null||n===void 0)&&n.length&&this.removedTransforms.forEach(([I,R])=>{o.getValue(I).set(R)}),this.resolveNoneKeyframes()}}const NR=(e,n)=>n==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(qp.test(e)||e==="0")&&!e.startsWith("url("));function bG(e){const n=e[0];if(e.length===1)return!0;for(let o=0;o<e.length;o++)if(e[o]!==n)return!0}function wG(e,n,o,c){const d=e[0];if(d===null)return!1;if(n==="display"||n==="visibility")return!0;const y=e[e.length-1],x=NR(d,n),i=NR(y,n);return!x||!i?!1:bG(e)||(o==="spring"||OC(o))&&c}const SG=e=>e!==null;function B1(e,{repeat:n,repeatType:o="loop"},c){const d=e.filter(SG),y=n&&o!=="loop"&&n%2===1?0:d.length-1;return!y||c===void 0?d[y]:c}const CG=40;class Jz{constructor({autoplay:n=!0,delay:o=0,type:c="keyframes",repeat:d=0,repeatDelay:y=0,repeatType:x="loop",...i}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Ch.now(),this.options={autoplay:n,delay:o,type:c,repeat:d,repeatDelay:y,repeatType:x,...i},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>CG?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&_G(),this._resolved}onKeyframesResolved(n,o){this.resolvedAt=Ch.now(),this.hasAttemptedResolve=!0;const{name:c,type:d,velocity:y,delay:x,onComplete:i,onUpdate:I,isGenerator:R}=this.options;if(!R&&!wG(n,c,d,y))if(x)this.options.duration=0;else{I&&I(B1(n,this.options,o)),i&&i(),this.resolveFinishedPromise();return}const k=this.initPlayback(n,o);k!==!1&&(this._resolved={keyframes:n,finalKeyframe:o,...k},this.onPostResolved())}onPostResolved(){}then(n,o){return this.currentFinishedPromise.then(n,o)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(n=>{this.resolveFinishedPromise=n})}}const uo=(e,n,o)=>e+(n-e)*o;function Kw(e,n,o){return o<0&&(o+=1),o>1&&(o-=1),o<1/6?e+(n-e)*6*o:o<1/2?n:o<2/3?e+(n-e)*(2/3-o)*6:e}function TG({hue:e,saturation:n,lightness:o,alpha:c}){e/=360,n/=100,o/=100;let d=0,y=0,x=0;if(!n)d=y=x=o;else{const i=o<.5?o*(1+n):o+n-o*n,I=2*o-i;d=Kw(I,i,e+1/3),y=Kw(I,i,e),x=Kw(I,i,e-1/3)}return{red:Math.round(d*255),green:Math.round(y*255),blue:Math.round(x*255),alpha:c}}function W0(e,n){return o=>o>0?n:e}const Yw=(e,n,o)=>{const c=e*e,d=o*(n*n-c)+c;return d<0?0:Math.sqrt(d)},EG=[nS,eg,u_],IG=e=>EG.find(n=>n.test(e));function jR(e){const n=IG(e);if(!n)return!1;let o=n.parse(e);return n===u_&&(o=TG(o)),o}const BR=(e,n)=>{const o=jR(e),c=jR(n);if(!o||!c)return W0(e,n);const d={...o};return y=>(d.red=Yw(o.red,c.red,y),d.green=Yw(o.green,c.green,y),d.blue=Yw(o.blue,c.blue,y),d.alpha=uo(o.alpha,c.alpha,y),eg.transform(d))},PG=(e,n)=>o=>n(e(o)),qv=(...e)=>e.reduce(PG),oS=new Set(["none","hidden"]);function AG(e,n){return oS.has(e)?o=>o<=0?e:n:o=>o>=1?n:e}function RG(e,n){return o=>uo(e,n,o)}function qC(e){return typeof e=="number"?RG:typeof e=="string"?IC(e)?W0:Ua.test(e)?BR:DG:Array.isArray(e)?Qz:typeof e=="object"?Ua.test(e)?BR:MG:W0}function Qz(e,n){const o=[...e],c=o.length,d=e.map((y,x)=>qC(y)(y,n[x]));return y=>{for(let x=0;x<c;x++)o[x]=d[x](y);return o}}function MG(e,n){const o={...e,...n},c={};for(const d in o)e[d]!==void 0&&n[d]!==void 0&&(c[d]=qC(e[d])(e[d],n[d]));return d=>{for(const y in c)o[y]=c[y](d);return o}}function LG(e,n){var o;const c=[],d={color:0,var:0,number:0};for(let y=0;y<n.values.length;y++){const x=n.types[y],i=e.indexes[x][d[x]],I=(o=e.values[i])!==null&&o!==void 0?o:0;c[y]=I,d[x]++}return c}const DG=(e,n)=>{const o=qp.createTransformer(n),c=Ev(e),d=Ev(n);return c.indexes.var.length===d.indexes.var.length&&c.indexes.color.length===d.indexes.color.length&&c.indexes.number.length>=d.indexes.number.length?oS.has(e)&&!d.values.length||oS.has(n)&&!c.values.length?AG(e,n):qv(Qz(LG(c,d),d.values),o):W0(e,n)};function e4(e,n,o){return typeof e=="number"&&typeof n=="number"&&typeof o=="number"?uo(e,n,o):qC(e)(e,n)}const kG=5;function t4(e,n,o){const c=Math.max(n-kG,0);return Pz(o-e(c),n-c)}const yo={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},VR=.001;function OG({duration:e=yo.duration,bounce:n=yo.bounce,velocity:o=yo.velocity,mass:c=yo.mass}){let d,y,x=1-n;x=Rf(yo.minDamping,yo.maxDamping,x),e=Rf(yo.minDuration,yo.maxDuration,Tf(e)),x<1?(d=R=>{const k=R*x,N=k*e,U=k-o,K=aS(R,x),X=Math.exp(-N);return VR-U/K*X},y=R=>{const N=R*x*e,U=N*o+o,K=Math.pow(x,2)*Math.pow(R,2)*e,X=Math.exp(-N),Z=aS(Math.pow(R,2),x);return(-d(R)+VR>0?-1:1)*((U-K)*X)/Z}):(d=R=>{const k=Math.exp(-R*e),N=(R-o)*e+1;return-.001+k*N},y=R=>{const k=Math.exp(-R*e),N=(o-R)*(e*e);return k*N});const i=5/e,I=FG(d,y,i);if(e=Cf(e),isNaN(I))return{stiffness:yo.stiffness,damping:yo.damping,duration:e};{const R=Math.pow(I,2)*c;return{stiffness:R,damping:x*2*Math.sqrt(c*R),duration:e}}}const zG=12;function FG(e,n,o){let c=o;for(let d=1;d<zG;d++)c=c-e(c)/n(c);return c}function aS(e,n){return e*Math.sqrt(1-n*n)}const NG=["duration","bounce"],jG=["stiffness","damping","mass"];function UR(e,n){return n.some(o=>e[o]!==void 0)}function BG(e){let n={velocity:yo.velocity,stiffness:yo.stiffness,damping:yo.damping,mass:yo.mass,isResolvedFromDuration:!1,...e};if(!UR(e,jG)&&UR(e,NG))if(e.visualDuration){const o=e.visualDuration,c=2*Math.PI/(o*1.2),d=c*c,y=2*Rf(.05,1,1-(e.bounce||0))*Math.sqrt(d);n={...n,mass:yo.mass,stiffness:d,damping:y}}else{const o=OG(e);n={...n,...o,mass:yo.mass},n.isResolvedFromDuration=!0}return n}function n4(e=yo.visualDuration,n=yo.bounce){const o=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:n}:e;let{restSpeed:c,restDelta:d}=o;const y=o.keyframes[0],x=o.keyframes[o.keyframes.length-1],i={done:!1,value:y},{stiffness:I,damping:R,mass:k,duration:N,velocity:U,isResolvedFromDuration:K}=BG({...o,velocity:-Tf(o.velocity||0)}),X=U||0,Z=R/(2*Math.sqrt(I*k)),J=x-y,le=Tf(Math.sqrt(I/k)),de=Math.abs(J)<5;c||(c=de?yo.restSpeed.granular:yo.restSpeed.default),d||(d=de?yo.restDelta.granular:yo.restDelta.default);let ue;if(Z<1){const he=aS(le,Z);ue=xe=>{const fe=Math.exp(-Z*le*xe);return x-fe*((X+Z*le*J)/he*Math.sin(he*xe)+J*Math.cos(he*xe))}}else if(Z===1)ue=he=>x-Math.exp(-le*he)*(J+(X+le*J)*he);else{const he=le*Math.sqrt(Z*Z-1);ue=xe=>{const fe=Math.exp(-Z*le*xe),_e=Math.min(he*xe,300);return x-fe*((X+Z*le*J)*Math.sinh(_e)+he*J*Math.cosh(_e))/he}}const pe={calculatedDuration:K&&N||null,next:he=>{const xe=ue(he);if(K)i.done=he>=N;else{let fe=0;Z<1&&(fe=he===0?Cf(X):t4(ue,he,xe));const _e=Math.abs(fe)<=c,Ce=Math.abs(x-xe)<=d;i.done=_e&&Ce}return i.value=i.done?x:xe,i},toString:()=>{const he=Math.min(xz(pe),Q2),xe=bz(fe=>pe.next(he*fe).value,he,30);return he+"ms "+xe}};return pe}function $R({keyframes:e,velocity:n=0,power:o=.8,timeConstant:c=325,bounceDamping:d=10,bounceStiffness:y=500,modifyTarget:x,min:i,max:I,restDelta:R=.5,restSpeed:k}){const N=e[0],U={done:!1,value:N},K=_e=>i!==void 0&&_e<i||I!==void 0&&_e>I,X=_e=>i===void 0?I:I===void 0||Math.abs(i-_e)<Math.abs(I-_e)?i:I;let Z=o*n;const J=N+Z,le=x===void 0?J:x(J);le!==J&&(Z=le-N);const de=_e=>-Z*Math.exp(-_e/c),ue=_e=>le+de(_e),pe=_e=>{const Ce=de(_e),je=ue(_e);U.done=Math.abs(Ce)<=R,U.value=U.done?le:je};let he,xe;const fe=_e=>{K(U.value)&&(he=_e,xe=n4({keyframes:[U.value,X(U.value)],velocity:t4(ue,_e,U.value),damping:d,stiffness:y,restDelta:R,restSpeed:k}))};return fe(0),{calculatedDuration:null,next:_e=>{let Ce=!1;return!xe&&he===void 0&&(Ce=!0,pe(_e),fe(_e)),he!==void 0&&_e>=he?xe.next(_e-he):(!Ce&&pe(_e),U)}}}const VG=Wv(.42,0,1,1),UG=Wv(0,0,.58,1),r4=Wv(.42,0,.58,1),$G=e=>Array.isArray(e)&&typeof e[0]!="number",HG={linear:Mc,easeIn:VG,easeInOut:r4,easeOut:UG,circIn:UC,circInOut:Fz,circOut:zz,backIn:VC,backInOut:kz,backOut:Dz,anticipate:Oz},HR=e=>{if(zC(e)){ez(e.length===4);const[n,o,c,d]=e;return Wv(n,o,c,d)}else if(typeof e=="string")return HG[e];return e};function GG(e,n,o){const c=[],d=o||e4,y=e.length-1;for(let x=0;x<y;x++){let i=d(e[x],e[x+1]);if(n){const I=Array.isArray(n)?n[x]||Mc:n;i=qv(I,i)}c.push(i)}return c}function WG(e,n,{clamp:o=!0,ease:c,mixer:d}={}){const y=e.length;if(ez(y===n.length),y===1)return()=>n[0];if(y===2&&n[0]===n[1])return()=>n[1];const x=e[0]===e[1];e[0]>e[y-1]&&(e=[...e].reverse(),n=[...n].reverse());const i=GG(n,c,d),I=i.length,R=k=>{if(x&&k<e[0])return n[0];let N=0;if(I>1)for(;N<e.length-2&&!(k<e[N+1]);N++);const U=C_(e[N],e[N+1],k);return i[N](U)};return o?k=>R(Rf(e[0],e[y-1],k)):R}function qG(e,n){const o=e[e.length-1];for(let c=1;c<=n;c++){const d=C_(0,n,c);e.push(uo(o,1,d))}}function ZG(e){const n=[0];return qG(n,e.length-1),n}function XG(e,n){return e.map(o=>o*n)}function KG(e,n){return e.map(()=>n||r4).splice(0,e.length-1)}function q0({duration:e=300,keyframes:n,times:o,ease:c="easeInOut"}){const d=$G(c)?c.map(HR):HR(c),y={done:!1,value:n[0]},x=XG(o&&o.length===n.length?o:ZG(n),e),i=WG(x,n,{ease:Array.isArray(d)?d:KG(n,d)});return{calculatedDuration:e,next:I=>(y.value=i(I),y.done=I>=e,y)}}const YG=e=>{const n=({timestamp:o})=>e(o);return{start:()=>Us.update(n,!0),stop:()=>Wp(n),now:()=>xa.isProcessing?xa.timestamp:Ch.now()}},JG={decay:$R,inertia:$R,tween:q0,keyframes:q0,spring:n4},QG=e=>e/100;class ZC extends Jz{constructor(n){super(n),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:I}=this.options;I&&I()};const{name:o,motionValue:c,element:d,keyframes:y}=this.options,x=(d==null?void 0:d.KeyframeResolver)||WC,i=(I,R)=>this.onKeyframesResolved(I,R);this.resolver=new x(y,i,o,c,d),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(n){const{type:o="keyframes",repeat:c=0,repeatDelay:d=0,repeatType:y,velocity:x=0}=this.options,i=OC(o)?o:JG[o]||q0;let I,R;i!==q0&&typeof n[0]!="number"&&(I=qv(QG,e4(n[0],n[1])),n=[0,100]);const k=i({...this.options,keyframes:n});y==="mirror"&&(R=i({...this.options,keyframes:[...n].reverse(),velocity:-x})),k.calculatedDuration===null&&(k.calculatedDuration=xz(k));const{calculatedDuration:N}=k,U=N+d,K=U*(c+1)-d;return{generator:k,mirroredGenerator:R,mapPercentToKeyframes:I,calculatedDuration:N,resolvedDuration:U,totalDuration:K}}onPostResolved(){const{autoplay:n=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!n?this.pause():this.state=this.pendingPlayState}tick(n,o=!1){const{resolved:c}=this;if(!c){const{keyframes:_e}=this.options;return{done:!0,value:_e[_e.length-1]}}const{finalKeyframe:d,generator:y,mirroredGenerator:x,mapPercentToKeyframes:i,keyframes:I,calculatedDuration:R,totalDuration:k,resolvedDuration:N}=c;if(this.startTime===null)return y.next(0);const{delay:U,repeat:K,repeatType:X,repeatDelay:Z,onUpdate:J}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,n):this.speed<0&&(this.startTime=Math.min(n-k/this.speed,this.startTime)),o?this.currentTime=n:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(n-this.startTime)*this.speed;const le=this.currentTime-U*(this.speed>=0?1:-1),de=this.speed>=0?le<0:le>k;this.currentTime=Math.max(le,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=k);let ue=this.currentTime,pe=y;if(K){const _e=Math.min(this.currentTime,k)/N;let Ce=Math.floor(_e),je=_e%1;!je&&_e>=1&&(je=1),je===1&&Ce--,Ce=Math.min(Ce,K+1),!!(Ce%2)&&(X==="reverse"?(je=1-je,Z&&(je-=Z/N)):X==="mirror"&&(pe=x)),ue=Rf(0,1,je)*N}const he=de?{done:!1,value:I[0]}:pe.next(ue);i&&(he.value=i(he.value));let{done:xe}=he;!de&&R!==null&&(xe=this.speed>=0?this.currentTime>=k:this.currentTime<=0);const fe=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&xe);return fe&&d!==void 0&&(he.value=B1(I,this.options,d)),J&&J(he.value),fe&&this.finish(),he}get duration(){const{resolved:n}=this;return n?Tf(n.calculatedDuration):0}get time(){return Tf(this.currentTime)}set time(n){n=Cf(n),this.currentTime=n,this.holdTime!==null||this.speed===0?this.holdTime=n:this.driver&&(this.startTime=this.driver.now()-n/this.speed)}get speed(){return this.playbackSpeed}set speed(n){const o=this.playbackSpeed!==n;this.playbackSpeed=n,o&&(this.time=Tf(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:n=YG,onPlay:o,startTime:c}=this.options;this.driver||(this.driver=n(y=>this.tick(y))),o&&o();const d=this.driver.now();this.holdTime!==null?this.startTime=d-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=d):this.startTime=c??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var n;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(n=this.currentTime)!==null&&n!==void 0?n:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:n}=this.options;n&&n()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(n){return this.startTime=0,this.tick(n,!0)}}const eW=new Set(["opacity","clipPath","filter","transform"]);function tW(e,n,o,{delay:c=0,duration:d=300,repeat:y=0,repeatType:x="loop",ease:i="easeInOut",times:I}={}){const R={[n]:o};I&&(R.offset=I);const k=Sz(i,d);return Array.isArray(k)&&(R.easing=k),e.animate(R,{delay:c,duration:d,easing:Array.isArray(k)?"linear":k,fill:"both",iterations:y+1,direction:x==="reverse"?"alternate":"normal"})}const nW=xC(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Z0=10,rW=2e4;function iW(e){return OC(e.type)||e.type==="spring"||!wz(e.ease)}function sW(e,n){const o=new ZC({...n,keyframes:e,repeat:0,delay:0,isGenerator:!0});let c={done:!1,value:e[0]};const d=[];let y=0;for(;!c.done&&y<rW;)c=o.sample(y),d.push(c.value),y+=Z0;return{times:void 0,keyframes:d,duration:y-Z0,ease:"linear"}}const i4={anticipate:Oz,backInOut:kz,circInOut:Fz};function oW(e){return e in i4}class GR extends Jz{constructor(n){super(n);const{name:o,motionValue:c,element:d,keyframes:y}=this.options;this.resolver=new Yz(y,(x,i)=>this.onKeyframesResolved(x,i),o,c,d),this.resolver.scheduleResolve()}initPlayback(n,o){let{duration:c=300,times:d,ease:y,type:x,motionValue:i,name:I,startTime:R}=this.options;if(!i.owner||!i.owner.current)return!1;if(typeof y=="string"&&G0()&&oW(y)&&(y=i4[y]),iW(this.options)){const{onComplete:N,onUpdate:U,motionValue:K,element:X,...Z}=this.options,J=sW(n,Z);n=J.keyframes,n.length===1&&(n[1]=n[0]),c=J.duration,d=J.times,y=J.ease,x="keyframes"}const k=tW(i.owner.current,I,n,{...this.options,duration:c,times:d,ease:y});return k.startTime=R??this.calcStartTime(),this.pendingTimeline?(PR(k,this.pendingTimeline),this.pendingTimeline=void 0):k.onfinish=()=>{const{onComplete:N}=this.options;i.set(B1(n,this.options,o)),N&&N(),this.cancel(),this.resolveFinishedPromise()},{animation:k,duration:c,times:d,type:x,ease:y,keyframes:n}}get duration(){const{resolved:n}=this;if(!n)return 0;const{duration:o}=n;return Tf(o)}get time(){const{resolved:n}=this;if(!n)return 0;const{animation:o}=n;return Tf(o.currentTime||0)}set time(n){const{resolved:o}=this;if(!o)return;const{animation:c}=o;c.currentTime=Cf(n)}get speed(){const{resolved:n}=this;if(!n)return 1;const{animation:o}=n;return o.playbackRate}set speed(n){const{resolved:o}=this;if(!o)return;const{animation:c}=o;c.playbackRate=n}get state(){const{resolved:n}=this;if(!n)return"idle";const{animation:o}=n;return o.playState}get startTime(){const{resolved:n}=this;if(!n)return null;const{animation:o}=n;return o.startTime}attachTimeline(n){if(!this._resolved)this.pendingTimeline=n;else{const{resolved:o}=this;if(!o)return Mc;const{animation:c}=o;PR(c,n)}return Mc}play(){if(this.isStopped)return;const{resolved:n}=this;if(!n)return;const{animation:o}=n;o.playState==="finished"&&this.updateFinishedPromise(),o.play()}pause(){const{resolved:n}=this;if(!n)return;const{animation:o}=n;o.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:n}=this;if(!n)return;const{animation:o,keyframes:c,duration:d,type:y,ease:x,times:i}=n;if(o.playState==="idle"||o.playState==="finished")return;if(this.time){const{motionValue:R,onUpdate:k,onComplete:N,element:U,...K}=this.options,X=new ZC({...K,keyframes:c,duration:d,type:y,ease:x,times:i,isGenerator:!0}),Z=Cf(this.time);R.setWithVelocity(X.sample(Z-Z0).value,X.sample(Z).value,Z0)}const{onStop:I}=this.options;I&&I(),this.cancel()}complete(){const{resolved:n}=this;n&&n.animation.finish()}cancel(){const{resolved:n}=this;n&&n.animation.cancel()}static supports(n){const{motionValue:o,name:c,repeatDelay:d,repeatType:y,damping:x,type:i}=n;if(!o||!o.owner||!(o.owner.current instanceof HTMLElement))return!1;const{onUpdate:I,transformTemplate:R}=o.owner.getProps();return nW()&&c&&eW.has(c)&&!I&&!R&&!d&&y!=="mirror"&&x!==0&&i!=="inertia"}}const aW={type:"spring",stiffness:500,damping:25,restSpeed:10},lW=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),cW={type:"keyframes",duration:.8},uW={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},dW=(e,{keyframes:n})=>n.length>2?cW:yg.has(e)?e.startsWith("scale")?lW(n[1]):aW:uW;function hW({when:e,delay:n,delayChildren:o,staggerChildren:c,staggerDirection:d,repeat:y,repeatType:x,repeatDelay:i,from:I,elapsed:R,...k}){return!!Object.keys(k).length}const XC=(e,n,o,c={},d,y)=>x=>{const i=kC(c,e)||{},I=i.delay||c.delay||0;let{elapsed:R=0}=c;R=R-Cf(I);let k={keyframes:Array.isArray(o)?o:[null,o],ease:"easeOut",velocity:n.getVelocity(),...i,delay:-R,onUpdate:U=>{n.set(U),i.onUpdate&&i.onUpdate(U)},onComplete:()=>{x(),i.onComplete&&i.onComplete()},name:e,motionValue:n,element:y?void 0:d};hW(i)||(k={...k,...dW(e,k)}),k.duration&&(k.duration=Cf(k.duration)),k.repeatDelay&&(k.repeatDelay=Cf(k.repeatDelay)),k.from!==void 0&&(k.keyframes[0]=k.from);let N=!1;if((k.type===!1||k.duration===0&&!k.repeatDelay)&&(k.duration=0,k.delay===0&&(N=!0)),N&&!y&&n.get()!==void 0){const U=B1(k.keyframes,i);if(U!==void 0)return Us.update(()=>{k.onUpdate(U),k.onComplete()}),new MH([])}return!y&&GR.supports(k)?new GR(k):new ZC(k)};function fW({protectedKeys:e,needsAnimating:n},o){const c=e.hasOwnProperty(o)&&n[o]!==!0;return n[o]=!1,c}function s4(e,n,{delay:o=0,transitionOverride:c,type:d}={}){var y;let{transition:x=e.getDefaultTransition(),transitionEnd:i,...I}=n;c&&(x=c);const R=[],k=d&&e.animationState&&e.animationState.getState()[d];for(const N in I){const U=e.getValue(N,(y=e.latestValues[N])!==null&&y!==void 0?y:null),K=I[N];if(K===void 0||k&&fW(k,N))continue;const X={delay:o,...kC(x||{},N)};let Z=!1;if(window.MotionHandoffAnimation){const le=Az(e);if(le){const de=window.MotionHandoffAnimation(le,N,Us);de!==null&&(X.startTime=de,Z=!0)}}tS(e,N),U.start(XC(N,U,K,e.shouldReduceMotion&&Iz.has(N)?{type:!1}:X,e,Z));const J=U.animation;J&&R.push(J)}return i&&Promise.all(R).then(()=>{Us.update(()=>{i&&GH(e,i)})}),R}function lS(e,n,o={}){var c;const d=j1(e,n,o.type==="exit"?(c=e.presenceContext)===null||c===void 0?void 0:c.custom:void 0);let{transition:y=e.getDefaultTransition()||{}}=d||{};o.transitionOverride&&(y=o.transitionOverride);const x=d?()=>Promise.all(s4(e,d,o)):()=>Promise.resolve(),i=e.variantChildren&&e.variantChildren.size?(R=0)=>{const{delayChildren:k=0,staggerChildren:N,staggerDirection:U}=y;return pW(e,n,k+R,N,U,o)}:()=>Promise.resolve(),{when:I}=y;if(I){const[R,k]=I==="beforeChildren"?[x,i]:[i,x];return R().then(()=>k())}else return Promise.all([x(),i(o.delay)])}function pW(e,n,o=0,c=0,d=1,y){const x=[],i=(e.variantChildren.size-1)*c,I=d===1?(R=0)=>R*c:(R=0)=>i-R*c;return Array.from(e.variantChildren).sort(mW).forEach((R,k)=>{R.notify("AnimationStart",n),x.push(lS(R,n,{...y,delay:o+I(k)}).then(()=>R.notify("AnimationComplete",n)))}),Promise.all(x)}function mW(e,n){return e.sortNodePosition(n)}function gW(e,n,o={}){e.notify("AnimationStart",n);let c;if(Array.isArray(n)){const d=n.map(y=>lS(e,y,o));c=Promise.all(d)}else if(typeof n=="string")c=lS(e,n,o);else{const d=typeof n=="function"?j1(e,n,o.custom):n;c=Promise.all(s4(e,d,o))}return c.then(()=>{e.notify("AnimationComplete",n)})}const _W=wC.length;function o4(e){if(!e)return;if(!e.isControllingVariants){const o=e.parent?o4(e.parent)||{}:{};return e.props.initial!==void 0&&(o.initial=e.props.initial),o}const n={};for(let o=0;o<_W;o++){const c=wC[o],d=e.props[c];(Sv(d)||d===!1)&&(n[c]=d)}return n}const yW=[...bC].reverse(),vW=bC.length;function xW(e){return n=>Promise.all(n.map(({animation:o,options:c})=>gW(e,o,c)))}function bW(e){let n=xW(e),o=WR(),c=!0;const d=I=>(R,k)=>{var N;const U=j1(e,k,I==="exit"?(N=e.presenceContext)===null||N===void 0?void 0:N.custom:void 0);if(U){const{transition:K,transitionEnd:X,...Z}=U;R={...R,...Z,...X}}return R};function y(I){n=I(e)}function x(I){const{props:R}=e,k=o4(e.parent)||{},N=[],U=new Set;let K={},X=1/0;for(let J=0;J<vW;J++){const le=yW[J],de=o[le],ue=R[le]!==void 0?R[le]:k[le],pe=Sv(ue),he=le===I?de.isActive:null;he===!1&&(X=J);let xe=ue===k[le]&&ue!==R[le]&&pe;if(xe&&c&&e.manuallyAnimateOnMount&&(xe=!1),de.protectedKeys={...K},!de.isActive&&he===null||!ue&&!de.prevProp||F1(ue)||typeof ue=="boolean")continue;const fe=wW(de.prevProp,ue);let _e=fe||le===I&&de.isActive&&!xe&&pe||J>X&&pe,Ce=!1;const je=Array.isArray(ue)?ue:[ue];let He=je.reduce(d(le),{});he===!1&&(He={});const{prevResolvedValues:lt={}}=de,_t={...lt,...He},Ue=yt=>{_e=!0,U.has(yt)&&(Ce=!0,U.delete(yt)),de.needsAnimating[yt]=!0;const tt=e.getValue(yt);tt&&(tt.liveStyle=!1)};for(const yt in _t){const tt=He[yt],Rt=lt[yt];if(K.hasOwnProperty(yt))continue;let ct=!1;J2(tt)&&J2(Rt)?ct=!vz(tt,Rt):ct=tt!==Rt,ct?tt!=null?Ue(yt):U.add(yt):tt!==void 0&&U.has(yt)?Ue(yt):de.protectedKeys[yt]=!0}de.prevProp=ue,de.prevResolvedValues=He,de.isActive&&(K={...K,...He}),c&&e.blockInitialAnimation&&(_e=!1),_e&&(!(xe&&fe)||Ce)&&N.push(...je.map(yt=>({animation:yt,options:{type:le}})))}if(U.size){const J={};U.forEach(le=>{const de=e.getBaseTarget(le),ue=e.getValue(le);ue&&(ue.liveStyle=!0),J[le]=de??null}),N.push({animation:J})}let Z=!!N.length;return c&&(R.initial===!1||R.initial===R.animate)&&!e.manuallyAnimateOnMount&&(Z=!1),c=!1,Z?n(N):Promise.resolve()}function i(I,R){var k;if(o[I].isActive===R)return Promise.resolve();(k=e.variantChildren)===null||k===void 0||k.forEach(U=>{var K;return(K=U.animationState)===null||K===void 0?void 0:K.setActive(I,R)}),o[I].isActive=R;const N=x(I);for(const U in o)o[U].protectedKeys={};return N}return{animateChanges:x,setActive:i,setAnimateFunction:y,getState:()=>o,reset:()=>{o=WR(),c=!0}}}function wW(e,n){return typeof n=="string"?n!==e:Array.isArray(n)?!vz(n,e):!1}function qm(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function WR(){return{animate:qm(!0),whileInView:qm(),whileHover:qm(),whileTap:qm(),whileDrag:qm(),whileFocus:qm(),exit:qm()}}class em{constructor(n){this.isMounted=!1,this.node=n}update(){}}class SW extends em{constructor(n){super(n),n.animationState||(n.animationState=bW(n))}updateAnimationControlsSubscription(){const{animate:n}=this.node.getProps();F1(n)&&(this.unmountControls=n.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:n}=this.node.getProps(),{animate:o}=this.node.prevProps||{};n!==o&&this.updateAnimationControlsSubscription()}unmount(){var n;this.node.animationState.reset(),(n=this.unmountControls)===null||n===void 0||n.call(this)}}let CW=0;class TW extends em{constructor(){super(...arguments),this.id=CW++}update(){if(!this.node.presenceContext)return;const{isPresent:n,onExitComplete:o}=this.node.presenceContext,{isPresent:c}=this.node.prevPresenceContext||{};if(!this.node.animationState||n===c)return;const d=this.node.animationState.setActive("exit",!n);o&&!n&&d.then(()=>o(this.id))}mount(){const{register:n}=this.node.presenceContext||{};n&&(this.unmount=n(this.id))}unmount(){}}const EW={animation:{Feature:SW},exit:{Feature:TW}};function Iv(e,n,o,c={passive:!0}){return e.addEventListener(n,o,c),()=>e.removeEventListener(n,o)}function Zv(e){return{point:{x:e.pageX,y:e.pageY}}}const IW=e=>n=>FC(n)&&e(n,Zv(n));function uv(e,n,o,c){return Iv(e,n,IW(o),c)}const qR=(e,n)=>Math.abs(e-n);function PW(e,n){const o=qR(e.x,n.x),c=qR(e.y,n.y);return Math.sqrt(o**2+c**2)}class a4{constructor(n,o,{transformPagePoint:c,contextWindow:d,dragSnapToOrigin:y=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const N=Qw(this.lastMoveEventInfo,this.history),U=this.startEvent!==null,K=PW(N.offset,{x:0,y:0})>=3;if(!U&&!K)return;const{point:X}=N,{timestamp:Z}=xa;this.history.push({...X,timestamp:Z});const{onStart:J,onMove:le}=this.handlers;U||(J&&J(this.lastMoveEvent,N),this.startEvent=this.lastMoveEvent),le&&le(this.lastMoveEvent,N)},this.handlePointerMove=(N,U)=>{this.lastMoveEvent=N,this.lastMoveEventInfo=Jw(U,this.transformPagePoint),Us.update(this.updatePoint,!0)},this.handlePointerUp=(N,U)=>{this.end();const{onEnd:K,onSessionEnd:X,resumeAnimation:Z}=this.handlers;if(this.dragSnapToOrigin&&Z&&Z(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const J=Qw(N.type==="pointercancel"?this.lastMoveEventInfo:Jw(U,this.transformPagePoint),this.history);this.startEvent&&K&&K(N,J),X&&X(N,J)},!FC(n))return;this.dragSnapToOrigin=y,this.handlers=o,this.transformPagePoint=c,this.contextWindow=d||window;const x=Zv(n),i=Jw(x,this.transformPagePoint),{point:I}=i,{timestamp:R}=xa;this.history=[{...I,timestamp:R}];const{onSessionStart:k}=o;k&&k(n,Qw(i,this.history)),this.removeListeners=qv(uv(this.contextWindow,"pointermove",this.handlePointerMove),uv(this.contextWindow,"pointerup",this.handlePointerUp),uv(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(n){this.handlers=n}end(){this.removeListeners&&this.removeListeners(),Wp(this.updatePoint)}}function Jw(e,n){return n?{point:n(e.point)}:e}function ZR(e,n){return{x:e.x-n.x,y:e.y-n.y}}function Qw({point:e},n){return{point:e,delta:ZR(e,l4(n)),offset:ZR(e,AW(n)),velocity:RW(n,.1)}}function AW(e){return e[0]}function l4(e){return e[e.length-1]}function RW(e,n){if(e.length<2)return{x:0,y:0};let o=e.length-1,c=null;const d=l4(e);for(;o>=0&&(c=e[o],!(d.timestamp-c.timestamp>Cf(n)));)o--;if(!c)return{x:0,y:0};const y=Tf(d.timestamp-c.timestamp);if(y===0)return{x:0,y:0};const x={x:(d.x-c.x)/y,y:(d.y-c.y)/y};return x.x===1/0&&(x.x=0),x.y===1/0&&(x.y=0),x}const c4=1e-4,MW=1-c4,LW=1+c4,u4=.01,DW=0-u4,kW=0+u4;function Fc(e){return e.max-e.min}function OW(e,n,o){return Math.abs(e-n)<=o}function XR(e,n,o,c=.5){e.origin=c,e.originPoint=uo(n.min,n.max,e.origin),e.scale=Fc(o)/Fc(n),e.translate=uo(o.min,o.max,e.origin)-e.originPoint,(e.scale>=MW&&e.scale<=LW||isNaN(e.scale))&&(e.scale=1),(e.translate>=DW&&e.translate<=kW||isNaN(e.translate))&&(e.translate=0)}function dv(e,n,o,c){XR(e.x,n.x,o.x,c?c.originX:void 0),XR(e.y,n.y,o.y,c?c.originY:void 0)}function KR(e,n,o){e.min=o.min+n.min,e.max=e.min+Fc(n)}function zW(e,n,o){KR(e.x,n.x,o.x),KR(e.y,n.y,o.y)}function YR(e,n,o){e.min=n.min-o.min,e.max=e.min+Fc(n)}function hv(e,n,o){YR(e.x,n.x,o.x),YR(e.y,n.y,o.y)}function FW(e,{min:n,max:o},c){return n!==void 0&&e<n?e=c?uo(n,e,c.min):Math.max(e,n):o!==void 0&&e>o&&(e=c?uo(o,e,c.max):Math.min(e,o)),e}function JR(e,n,o){return{min:n!==void 0?e.min+n:void 0,max:o!==void 0?e.max+o-(e.max-e.min):void 0}}function NW(e,{top:n,left:o,bottom:c,right:d}){return{x:JR(e.x,o,d),y:JR(e.y,n,c)}}function QR(e,n){let o=n.min-e.min,c=n.max-e.max;return n.max-n.min<e.max-e.min&&([o,c]=[c,o]),{min:o,max:c}}function jW(e,n){return{x:QR(e.x,n.x),y:QR(e.y,n.y)}}function BW(e,n){let o=.5;const c=Fc(e),d=Fc(n);return d>c?o=C_(n.min,n.max-c,e.min):c>d&&(o=C_(e.min,e.max-d,n.min)),Rf(0,1,o)}function VW(e,n){const o={};return n.min!==void 0&&(o.min=n.min-e.min),n.max!==void 0&&(o.max=n.max-e.min),o}const cS=.35;function UW(e=cS){return e===!1?e=0:e===!0&&(e=cS),{x:eM(e,"left","right"),y:eM(e,"top","bottom")}}function eM(e,n,o){return{min:tM(e,n),max:tM(e,o)}}function tM(e,n){return typeof e=="number"?e:e[n]||0}const nM=()=>({translate:0,scale:1,origin:0,originPoint:0}),d_=()=>({x:nM(),y:nM()}),rM=()=>({min:0,max:0}),Po=()=>({x:rM(),y:rM()});function gu(e){return[e("x"),e("y")]}function d4({top:e,left:n,right:o,bottom:c}){return{x:{min:n,max:o},y:{min:e,max:c}}}function $W({x:e,y:n}){return{top:n.min,right:e.max,bottom:n.max,left:e.min}}function HW(e,n){if(!n)return e;const o=n({x:e.left,y:e.top}),c=n({x:e.right,y:e.bottom});return{top:o.y,left:o.x,bottom:c.y,right:c.x}}function e2(e){return e===void 0||e===1}function uS({scale:e,scaleX:n,scaleY:o}){return!e2(e)||!e2(n)||!e2(o)}function Km(e){return uS(e)||h4(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function h4(e){return iM(e.x)||iM(e.y)}function iM(e){return e&&e!=="0%"}function X0(e,n,o){const c=e-o,d=n*c;return o+d}function sM(e,n,o,c,d){return d!==void 0&&(e=X0(e,d,c)),X0(e,o,c)+n}function dS(e,n=0,o=1,c,d){e.min=sM(e.min,n,o,c,d),e.max=sM(e.max,n,o,c,d)}function f4(e,{x:n,y:o}){dS(e.x,n.translate,n.scale,n.originPoint),dS(e.y,o.translate,o.scale,o.originPoint)}const oM=.999999999999,aM=1.0000000000001;function GW(e,n,o,c=!1){const d=o.length;if(!d)return;n.x=n.y=1;let y,x;for(let i=0;i<d;i++){y=o[i],x=y.projectionDelta;const{visualElement:I}=y.options;I&&I.props.style&&I.props.style.display==="contents"||(c&&y.options.layoutScroll&&y.scroll&&y!==y.root&&f_(e,{x:-y.scroll.offset.x,y:-y.scroll.offset.y}),x&&(n.x*=x.x.scale,n.y*=x.y.scale,f4(e,x)),c&&Km(y.latestValues)&&f_(e,y.latestValues))}n.x<aM&&n.x>oM&&(n.x=1),n.y<aM&&n.y>oM&&(n.y=1)}function h_(e,n){e.min=e.min+n,e.max=e.max+n}function lM(e,n,o,c,d=.5){const y=uo(e.min,e.max,d);dS(e,n,o,y,c)}function f_(e,n){lM(e.x,n.x,n.scaleX,n.scale,n.originX),lM(e.y,n.y,n.scaleY,n.scale,n.originY)}function p4(e,n){return d4(HW(e.getBoundingClientRect(),n))}function WW(e,n,o){const c=p4(e,o),{scroll:d}=n;return d&&(h_(c.x,d.offset.x),h_(c.y,d.offset.y)),c}const m4=({current:e})=>e?e.ownerDocument.defaultView:null,qW=new WeakMap;class ZW{constructor(n){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Po(),this.visualElement=n}start(n,{snapToCursor:o=!1}={}){const{presenceContext:c}=this.visualElement;if(c&&c.isPresent===!1)return;const d=k=>{const{dragSnapToOrigin:N}=this.getProps();N?this.pauseAnimation():this.stopAnimation(),o&&this.snapToCursor(Zv(k).point)},y=(k,N)=>{const{drag:U,dragPropagation:K,onDragStart:X}=this.getProps();if(U&&!K&&(this.openDragLock&&this.openDragLock(),this.openDragLock=BH(U),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),gu(J=>{let le=this.getAxisMotionValue(J).get()||0;if(Sh.test(le)){const{projection:de}=this.visualElement;if(de&&de.layout){const ue=de.layout.layoutBox[J];ue&&(le=Fc(ue)*(parseFloat(le)/100))}}this.originPoint[J]=le}),X&&Us.postRender(()=>X(k,N)),tS(this.visualElement,"transform");const{animationState:Z}=this.visualElement;Z&&Z.setActive("whileDrag",!0)},x=(k,N)=>{const{dragPropagation:U,dragDirectionLock:K,onDirectionLock:X,onDrag:Z}=this.getProps();if(!U&&!this.openDragLock)return;const{offset:J}=N;if(K&&this.currentDirection===null){this.currentDirection=XW(J),this.currentDirection!==null&&X&&X(this.currentDirection);return}this.updateAxis("x",N.point,J),this.updateAxis("y",N.point,J),this.visualElement.render(),Z&&Z(k,N)},i=(k,N)=>this.stop(k,N),I=()=>gu(k=>{var N;return this.getAnimationState(k)==="paused"&&((N=this.getAxisMotionValue(k).animation)===null||N===void 0?void 0:N.play())}),{dragSnapToOrigin:R}=this.getProps();this.panSession=new a4(n,{onSessionStart:d,onStart:y,onMove:x,onSessionEnd:i,resumeAnimation:I},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:R,contextWindow:m4(this.visualElement)})}stop(n,o){const c=this.isDragging;if(this.cancel(),!c)return;const{velocity:d}=o;this.startAnimation(d);const{onDragEnd:y}=this.getProps();y&&Us.postRender(()=>y(n,o))}cancel(){this.isDragging=!1;const{projection:n,animationState:o}=this.visualElement;n&&(n.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:c}=this.getProps();!c&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),o&&o.setActive("whileDrag",!1)}updateAxis(n,o,c){const{drag:d}=this.getProps();if(!c||!o0(n,d,this.currentDirection))return;const y=this.getAxisMotionValue(n);let x=this.originPoint[n]+c[n];this.constraints&&this.constraints[n]&&(x=FW(x,this.constraints[n],this.elastic[n])),y.set(x)}resolveConstraints(){var n;const{dragConstraints:o,dragElastic:c}=this.getProps(),d=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(n=this.visualElement.projection)===null||n===void 0?void 0:n.layout,y=this.constraints;o&&c_(o)?this.constraints||(this.constraints=this.resolveRefConstraints()):o&&d?this.constraints=NW(d.layoutBox,o):this.constraints=!1,this.elastic=UW(c),y!==this.constraints&&d&&this.constraints&&!this.hasMutatedConstraints&&gu(x=>{this.constraints!==!1&&this.getAxisMotionValue(x)&&(this.constraints[x]=VW(d.layoutBox[x],this.constraints[x]))})}resolveRefConstraints(){const{dragConstraints:n,onMeasureDragConstraints:o}=this.getProps();if(!n||!c_(n))return!1;const c=n.current,{projection:d}=this.visualElement;if(!d||!d.layout)return!1;const y=WW(c,d.root,this.visualElement.getTransformPagePoint());let x=jW(d.layout.layoutBox,y);if(o){const i=o($W(x));this.hasMutatedConstraints=!!i,i&&(x=d4(i))}return x}startAnimation(n){const{drag:o,dragMomentum:c,dragElastic:d,dragTransition:y,dragSnapToOrigin:x,onDragTransitionEnd:i}=this.getProps(),I=this.constraints||{},R=gu(k=>{if(!o0(k,o,this.currentDirection))return;let N=I&&I[k]||{};x&&(N={min:0,max:0});const U=d?200:1e6,K=d?40:1e7,X={type:"inertia",velocity:c?n[k]:0,bounceStiffness:U,bounceDamping:K,timeConstant:750,restDelta:1,restSpeed:10,...y,...N};return this.startAxisValueAnimation(k,X)});return Promise.all(R).then(i)}startAxisValueAnimation(n,o){const c=this.getAxisMotionValue(n);return tS(this.visualElement,n),c.start(XC(n,c,0,o,this.visualElement,!1))}stopAnimation(){gu(n=>this.getAxisMotionValue(n).stop())}pauseAnimation(){gu(n=>{var o;return(o=this.getAxisMotionValue(n).animation)===null||o===void 0?void 0:o.pause()})}getAnimationState(n){var o;return(o=this.getAxisMotionValue(n).animation)===null||o===void 0?void 0:o.state}getAxisMotionValue(n){const o=`_drag${n.toUpperCase()}`,c=this.visualElement.getProps(),d=c[o];return d||this.visualElement.getValue(n,(c.initial?c.initial[n]:void 0)||0)}snapToCursor(n){gu(o=>{const{drag:c}=this.getProps();if(!o0(o,c,this.currentDirection))return;const{projection:d}=this.visualElement,y=this.getAxisMotionValue(o);if(d&&d.layout){const{min:x,max:i}=d.layout.layoutBox[o];y.set(n[o]-uo(x,i,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:n,dragConstraints:o}=this.getProps(),{projection:c}=this.visualElement;if(!c_(o)||!c||!this.constraints)return;this.stopAnimation();const d={x:0,y:0};gu(x=>{const i=this.getAxisMotionValue(x);if(i&&this.constraints!==!1){const I=i.get();d[x]=BW({min:I,max:I},this.constraints[x])}});const{transformTemplate:y}=this.visualElement.getProps();this.visualElement.current.style.transform=y?y({},""):"none",c.root&&c.root.updateScroll(),c.updateLayout(),this.resolveConstraints(),gu(x=>{if(!o0(x,n,null))return;const i=this.getAxisMotionValue(x),{min:I,max:R}=this.constraints[x];i.set(uo(I,R,d[x]))})}addListeners(){if(!this.visualElement.current)return;qW.set(this.visualElement,this);const n=this.visualElement.current,o=uv(n,"pointerdown",I=>{const{drag:R,dragListener:k=!0}=this.getProps();R&&k&&this.start(I)}),c=()=>{const{dragConstraints:I}=this.getProps();c_(I)&&I.current&&(this.constraints=this.resolveRefConstraints())},{projection:d}=this.visualElement,y=d.addEventListener("measure",c);d&&!d.layout&&(d.root&&d.root.updateScroll(),d.updateLayout()),Us.read(c);const x=Iv(window,"resize",()=>this.scalePositionWithinConstraints()),i=d.addEventListener("didUpdate",({delta:I,hasLayoutChanged:R})=>{this.isDragging&&R&&(gu(k=>{const N=this.getAxisMotionValue(k);N&&(this.originPoint[k]+=I[k].translate,N.set(N.get()+I[k].translate))}),this.visualElement.render())});return()=>{x(),o(),y(),i&&i()}}getProps(){const n=this.visualElement.getProps(),{drag:o=!1,dragDirectionLock:c=!1,dragPropagation:d=!1,dragConstraints:y=!1,dragElastic:x=cS,dragMomentum:i=!0}=n;return{...n,drag:o,dragDirectionLock:c,dragPropagation:d,dragConstraints:y,dragElastic:x,dragMomentum:i}}}function o0(e,n,o){return(n===!0||n===e)&&(o===null||o===e)}function XW(e,n=10){let o=null;return Math.abs(e.y)>n?o="y":Math.abs(e.x)>n&&(o="x"),o}class KW extends em{constructor(n){super(n),this.removeGroupControls=Mc,this.removeListeners=Mc,this.controls=new ZW(n)}mount(){const{dragControls:n}=this.node.getProps();n&&(this.removeGroupControls=n.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Mc}unmount(){this.removeGroupControls(),this.removeListeners()}}const cM=e=>(n,o)=>{e&&Us.postRender(()=>e(n,o))};class YW extends em{constructor(){super(...arguments),this.removePointerDownListener=Mc}onPointerDown(n){this.session=new a4(n,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:m4(this.node)})}createPanHandlers(){const{onPanSessionStart:n,onPanStart:o,onPan:c,onPanEnd:d}=this.node.getProps();return{onSessionStart:cM(n),onStart:cM(o),onMove:c,onEnd:(y,x)=>{delete this.session,d&&Us.postRender(()=>d(y,x))}}}mount(){this.removePointerDownListener=uv(this.node.current,"pointerdown",n=>this.onPointerDown(n))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const S0={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function uM(e,n){return n.max===n.min?0:e/(n.max-n.min)*100}const Gy={correct:(e,n)=>{if(!n.target)return e;if(typeof e=="string")if(Kr.test(e))e=parseFloat(e);else return e;const o=uM(e,n.target.x),c=uM(e,n.target.y);return`${o}% ${c}%`}},JW={correct:(e,{treeScale:n,projectionDelta:o})=>{const c=e,d=qp.parse(e);if(d.length>5)return c;const y=qp.createTransformer(e),x=typeof d[0]!="number"?1:0,i=o.x.scale*n.x,I=o.y.scale*n.y;d[0+x]/=i,d[1+x]/=I;const R=uo(i,I,.5);return typeof d[2+x]=="number"&&(d[2+x]/=R),typeof d[3+x]=="number"&&(d[3+x]/=R),y(d)}};class QW extends V.Component{componentDidMount(){const{visualElement:n,layoutGroup:o,switchLayoutGroup:c,layoutId:d}=this.props,{projection:y}=n;vH(eq),y&&(o.group&&o.group.add(y),c&&c.register&&d&&c.register(y),y.root.didUpdate(),y.addEventListener("animationComplete",()=>{this.safeToRemove()}),y.setOptions({...y.options,onExitComplete:()=>this.safeToRemove()})),S0.hasEverUpdated=!0}getSnapshotBeforeUpdate(n){const{layoutDependency:o,visualElement:c,drag:d,isPresent:y}=this.props,x=c.projection;return x&&(x.isPresent=y,d||n.layoutDependency!==o||o===void 0?x.willUpdate():this.safeToRemove(),n.isPresent!==y&&(y?x.promote():x.relegate()||Us.postRender(()=>{const i=x.getStack();(!i||!i.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:n}=this.props.visualElement;n&&(n.root.didUpdate(),CC.postRender(()=>{!n.currentAnimation&&n.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:n,layoutGroup:o,switchLayoutGroup:c}=this.props,{projection:d}=n;d&&(d.scheduleCheckAfterUnmount(),o&&o.group&&o.group.remove(d),c&&c.deregister&&c.deregister(d))}safeToRemove(){const{safeToRemove:n}=this.props;n&&n()}render(){return null}}function g4(e){const[n,o]=k7(),c=V.useContext(JO);return T.jsx(QW,{...e,layoutGroup:c,switchLayoutGroup:V.useContext(oz),isPresent:n,safeToRemove:o})}const eq={borderRadius:{...Gy,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Gy,borderTopRightRadius:Gy,borderBottomLeftRadius:Gy,borderBottomRightRadius:Gy,boxShadow:JW};function tq(e,n,o){const c=qa(e)?e:Tv(e);return c.start(XC("",c,n,o)),c.animation}function nq(e){return e instanceof SVGElement&&e.tagName!=="svg"}const rq=(e,n)=>e.depth-n.depth;class iq{constructor(){this.children=[],this.isDirty=!1}add(n){NC(this.children,n),this.isDirty=!0}remove(n){jC(this.children,n),this.isDirty=!0}forEach(n){this.isDirty&&this.children.sort(rq),this.isDirty=!1,this.children.forEach(n)}}function sq(e,n){const o=Ch.now(),c=({timestamp:d})=>{const y=d-o;y>=n&&(Wp(c),e(y-n))};return Us.read(c,!0),()=>Wp(c)}const _4=["TopLeft","TopRight","BottomLeft","BottomRight"],oq=_4.length,dM=e=>typeof e=="string"?parseFloat(e):e,hM=e=>typeof e=="number"||Kr.test(e);function aq(e,n,o,c,d,y){d?(e.opacity=uo(0,o.opacity!==void 0?o.opacity:1,lq(c)),e.opacityExit=uo(n.opacity!==void 0?n.opacity:1,0,cq(c))):y&&(e.opacity=uo(n.opacity!==void 0?n.opacity:1,o.opacity!==void 0?o.opacity:1,c));for(let x=0;x<oq;x++){const i=`border${_4[x]}Radius`;let I=fM(n,i),R=fM(o,i);if(I===void 0&&R===void 0)continue;I||(I=0),R||(R=0),I===0||R===0||hM(I)===hM(R)?(e[i]=Math.max(uo(dM(I),dM(R),c),0),(Sh.test(R)||Sh.test(I))&&(e[i]+="%")):e[i]=R}(n.rotate||o.rotate)&&(e.rotate=uo(n.rotate||0,o.rotate||0,c))}function fM(e,n){return e[n]!==void 0?e[n]:e.borderRadius}const lq=y4(0,.5,zz),cq=y4(.5,.95,Mc);function y4(e,n,o){return c=>c<e?0:c>n?1:o(C_(e,n,c))}function pM(e,n){e.min=n.min,e.max=n.max}function mu(e,n){pM(e.x,n.x),pM(e.y,n.y)}function mM(e,n){e.translate=n.translate,e.scale=n.scale,e.originPoint=n.originPoint,e.origin=n.origin}function gM(e,n,o,c,d){return e-=n,e=X0(e,1/o,c),d!==void 0&&(e=X0(e,1/d,c)),e}function uq(e,n=0,o=1,c=.5,d,y=e,x=e){if(Sh.test(n)&&(n=parseFloat(n),n=uo(x.min,x.max,n/100)-x.min),typeof n!="number")return;let i=uo(y.min,y.max,c);e===y&&(i-=n),e.min=gM(e.min,n,o,i,d),e.max=gM(e.max,n,o,i,d)}function _M(e,n,[o,c,d],y,x){uq(e,n[o],n[c],n[d],n.scale,y,x)}const dq=["x","scaleX","originX"],hq=["y","scaleY","originY"];function yM(e,n,o,c){_M(e.x,n,dq,o?o.x:void 0,c?c.x:void 0),_M(e.y,n,hq,o?o.y:void 0,c?c.y:void 0)}function vM(e){return e.translate===0&&e.scale===1}function v4(e){return vM(e.x)&&vM(e.y)}function xM(e,n){return e.min===n.min&&e.max===n.max}function fq(e,n){return xM(e.x,n.x)&&xM(e.y,n.y)}function bM(e,n){return Math.round(e.min)===Math.round(n.min)&&Math.round(e.max)===Math.round(n.max)}function x4(e,n){return bM(e.x,n.x)&&bM(e.y,n.y)}function wM(e){return Fc(e.x)/Fc(e.y)}function SM(e,n){return e.translate===n.translate&&e.scale===n.scale&&e.originPoint===n.originPoint}class pq{constructor(){this.members=[]}add(n){NC(this.members,n),n.scheduleRender()}remove(n){if(jC(this.members,n),n===this.prevLead&&(this.prevLead=void 0),n===this.lead){const o=this.members[this.members.length-1];o&&this.promote(o)}}relegate(n){const o=this.members.findIndex(d=>n===d);if(o===0)return!1;let c;for(let d=o;d>=0;d--){const y=this.members[d];if(y.isPresent!==!1){c=y;break}}return c?(this.promote(c),!0):!1}promote(n,o){const c=this.lead;if(n!==c&&(this.prevLead=c,this.lead=n,n.show(),c)){c.instance&&c.scheduleRender(),n.scheduleRender(),n.resumeFrom=c,o&&(n.resumeFrom.preserveOpacity=!0),c.snapshot&&(n.snapshot=c.snapshot,n.snapshot.latestValues=c.animationValues||c.latestValues),n.root&&n.root.isUpdating&&(n.isLayoutDirty=!0);const{crossfade:d}=n.options;d===!1&&c.hide()}}exitAnimationComplete(){this.members.forEach(n=>{const{options:o,resumingFrom:c}=n;o.onExitComplete&&o.onExitComplete(),c&&c.options.onExitComplete&&c.options.onExitComplete()})}scheduleRender(){this.members.forEach(n=>{n.instance&&n.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function mq(e,n,o){let c="";const d=e.x.translate/n.x,y=e.y.translate/n.y,x=(o==null?void 0:o.z)||0;if((d||y||x)&&(c=`translate3d(${d}px, ${y}px, ${x}px) `),(n.x!==1||n.y!==1)&&(c+=`scale(${1/n.x}, ${1/n.y}) `),o){const{transformPerspective:R,rotate:k,rotateX:N,rotateY:U,skewX:K,skewY:X}=o;R&&(c=`perspective(${R}px) ${c}`),k&&(c+=`rotate(${k}deg) `),N&&(c+=`rotateX(${N}deg) `),U&&(c+=`rotateY(${U}deg) `),K&&(c+=`skewX(${K}deg) `),X&&(c+=`skewY(${X}deg) `)}const i=e.x.scale*n.x,I=e.y.scale*n.y;return(i!==1||I!==1)&&(c+=`scale(${i}, ${I})`),c||"none"}const Ym={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},rv=typeof window<"u"&&window.MotionDebug!==void 0,t2=["","X","Y","Z"],gq={visibility:"hidden"},CM=1e3;let _q=0;function n2(e,n,o,c){const{latestValues:d}=n;d[e]&&(o[e]=d[e],n.setStaticValue(e,0),c&&(c[e]=0))}function b4(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:n}=e.options;if(!n)return;const o=Az(n);if(window.MotionHasOptimisedAnimation(o,"transform")){const{layout:d,layoutId:y}=e.options;window.MotionCancelOptimisedAnimation(o,"transform",Us,!(d||y))}const{parent:c}=e;c&&!c.hasCheckedOptimisedAppear&&b4(c)}function w4({attachResizeListener:e,defaultParent:n,measureScroll:o,checkIsScrollRoot:c,resetTransform:d}){return class{constructor(x={},i=n==null?void 0:n()){this.id=_q++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,rv&&(Ym.totalNodes=Ym.resolvedTargetDeltas=Ym.recalculatedProjection=0),this.nodes.forEach(xq),this.nodes.forEach(Tq),this.nodes.forEach(Eq),this.nodes.forEach(bq),rv&&window.MotionDebug.record(Ym)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=x,this.root=i?i.root||i:this,this.path=i?[...i.path,i]:[],this.parent=i,this.depth=i?i.depth+1:0;for(let I=0;I<this.path.length;I++)this.path[I].shouldResetTransform=!0;this.root===this&&(this.nodes=new iq)}addEventListener(x,i){return this.eventHandlers.has(x)||this.eventHandlers.set(x,new BC),this.eventHandlers.get(x).add(i)}notifyListeners(x,...i){const I=this.eventHandlers.get(x);I&&I.notify(...i)}hasListeners(x){return this.eventHandlers.has(x)}mount(x,i=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=nq(x),this.instance=x;const{layoutId:I,layout:R,visualElement:k}=this.options;if(k&&!k.current&&k.mount(x),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),i&&(R||I)&&(this.isLayoutDirty=!0),e){let N;const U=()=>this.root.updateBlockedByResize=!1;e(x,()=>{this.root.updateBlockedByResize=!0,N&&N(),N=sq(U,250),S0.hasAnimatedSinceResize&&(S0.hasAnimatedSinceResize=!1,this.nodes.forEach(EM))})}I&&this.root.registerSharedNode(I,this),this.options.animate!==!1&&k&&(I||R)&&this.addEventListener("didUpdate",({delta:N,hasLayoutChanged:U,hasRelativeTargetChanged:K,layout:X})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const Z=this.options.transition||k.getDefaultTransition()||Mq,{onLayoutAnimationStart:J,onLayoutAnimationComplete:le}=k.getProps(),de=!this.targetLayout||!x4(this.targetLayout,X)||K,ue=!U&&K;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||ue||U&&(de||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(N,ue);const pe={...kC(Z,"layout"),onPlay:J,onComplete:le};(k.shouldReduceMotion||this.options.layoutRoot)&&(pe.delay=0,pe.type=!1),this.startAnimation(pe)}else U||EM(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=X})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const x=this.getStack();x&&x.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Wp(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Iq),this.animationId++)}getTransformTemplate(){const{visualElement:x}=this.options;return x&&x.getProps().transformTemplate}willUpdate(x=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&b4(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let k=0;k<this.path.length;k++){const N=this.path[k];N.shouldResetTransform=!0,N.updateScroll("snapshot"),N.options.layoutRoot&&N.willUpdate(!1)}const{layoutId:i,layout:I}=this.options;if(i===void 0&&!I)return;const R=this.getTransformTemplate();this.prevTransformTemplateValue=R?R(this.latestValues,""):void 0,this.updateSnapshot(),x&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(TM);return}this.isUpdating||this.nodes.forEach(Sq),this.isUpdating=!1,this.nodes.forEach(Cq),this.nodes.forEach(yq),this.nodes.forEach(vq),this.clearAllSnapshots();const i=Ch.now();xa.delta=Rf(0,1e3/60,i-xa.timestamp),xa.timestamp=i,xa.isProcessing=!0,qw.update.process(xa),qw.preRender.process(xa),qw.render.process(xa),xa.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,CC.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(wq),this.sharedNodes.forEach(Pq)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Us.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Us.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let I=0;I<this.path.length;I++)this.path[I].updateScroll();const x=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Po(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:i}=this.options;i&&i.notify("LayoutMeasure",this.layout.layoutBox,x?x.layoutBox:void 0)}updateScroll(x="measure"){let i=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===x&&(i=!1),i){const I=c(this.instance);this.scroll={animationId:this.root.animationId,phase:x,isRoot:I,offset:o(this.instance),wasRoot:this.scroll?this.scroll.isRoot:I}}}resetTransform(){if(!d)return;const x=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,i=this.projectionDelta&&!v4(this.projectionDelta),I=this.getTransformTemplate(),R=I?I(this.latestValues,""):void 0,k=R!==this.prevTransformTemplateValue;x&&(i||Km(this.latestValues)||k)&&(d(this.instance,R),this.shouldResetTransform=!1,this.scheduleRender())}measure(x=!0){const i=this.measurePageBox();let I=this.removeElementScroll(i);return x&&(I=this.removeTransform(I)),Lq(I),{animationId:this.root.animationId,measuredBox:i,layoutBox:I,latestValues:{},source:this.id}}measurePageBox(){var x;const{visualElement:i}=this.options;if(!i)return Po();const I=i.measureViewportBox();if(!(((x=this.scroll)===null||x===void 0?void 0:x.wasRoot)||this.path.some(Dq))){const{scroll:k}=this.root;k&&(h_(I.x,k.offset.x),h_(I.y,k.offset.y))}return I}removeElementScroll(x){var i;const I=Po();if(mu(I,x),!((i=this.scroll)===null||i===void 0)&&i.wasRoot)return I;for(let R=0;R<this.path.length;R++){const k=this.path[R],{scroll:N,options:U}=k;k!==this.root&&N&&U.layoutScroll&&(N.wasRoot&&mu(I,x),h_(I.x,N.offset.x),h_(I.y,N.offset.y))}return I}applyTransform(x,i=!1){const I=Po();mu(I,x);for(let R=0;R<this.path.length;R++){const k=this.path[R];!i&&k.options.layoutScroll&&k.scroll&&k!==k.root&&f_(I,{x:-k.scroll.offset.x,y:-k.scroll.offset.y}),Km(k.latestValues)&&f_(I,k.latestValues)}return Km(this.latestValues)&&f_(I,this.latestValues),I}removeTransform(x){const i=Po();mu(i,x);for(let I=0;I<this.path.length;I++){const R=this.path[I];if(!R.instance||!Km(R.latestValues))continue;uS(R.latestValues)&&R.updateSnapshot();const k=Po(),N=R.measurePageBox();mu(k,N),yM(i,R.latestValues,R.snapshot?R.snapshot.layoutBox:void 0,k)}return Km(this.latestValues)&&yM(i,this.latestValues),i}setTargetDelta(x){this.targetDelta=x,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(x){this.options={...this.options,...x,crossfade:x.crossfade!==void 0?x.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==xa.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(x=!1){var i;const I=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=I.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=I.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=I.isSharedProjectionDirty);const R=!!this.resumingFrom||this!==I;if(!(x||R&&this.isSharedProjectionDirty||this.isProjectionDirty||!((i=this.parent)===null||i===void 0)&&i.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:N,layoutId:U}=this.options;if(!(!this.layout||!(N||U))){if(this.resolvedRelativeTargetAt=xa.timestamp,!this.targetDelta&&!this.relativeTarget){const K=this.getClosestProjectingParent();K&&K.layout&&this.animationProgress!==1?(this.relativeParent=K,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Po(),this.relativeTargetOrigin=Po(),hv(this.relativeTargetOrigin,this.layout.layoutBox,K.layout.layoutBox),mu(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Po(),this.targetWithTransforms=Po()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),zW(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):mu(this.target,this.layout.layoutBox),f4(this.target,this.targetDelta)):mu(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const K=this.getClosestProjectingParent();K&&!!K.resumingFrom==!!this.resumingFrom&&!K.options.layoutScroll&&K.target&&this.animationProgress!==1?(this.relativeParent=K,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Po(),this.relativeTargetOrigin=Po(),hv(this.relativeTargetOrigin,this.target,K.target),mu(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}rv&&Ym.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||uS(this.parent.latestValues)||h4(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var x;const i=this.getLead(),I=!!this.resumingFrom||this!==i;let R=!0;if((this.isProjectionDirty||!((x=this.parent)===null||x===void 0)&&x.isProjectionDirty)&&(R=!1),I&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(R=!1),this.resolvedRelativeTargetAt===xa.timestamp&&(R=!1),R)return;const{layout:k,layoutId:N}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(k||N))return;mu(this.layoutCorrected,this.layout.layoutBox);const U=this.treeScale.x,K=this.treeScale.y;GW(this.layoutCorrected,this.treeScale,this.path,I),i.layout&&!i.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(i.target=i.layout.layoutBox,i.targetWithTransforms=Po());const{target:X}=i;if(!X){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(mM(this.prevProjectionDelta.x,this.projectionDelta.x),mM(this.prevProjectionDelta.y,this.projectionDelta.y)),dv(this.projectionDelta,this.layoutCorrected,X,this.latestValues),(this.treeScale.x!==U||this.treeScale.y!==K||!SM(this.projectionDelta.x,this.prevProjectionDelta.x)||!SM(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",X)),rv&&Ym.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(x=!0){var i;if((i=this.options.visualElement)===null||i===void 0||i.scheduleRender(),x){const I=this.getStack();I&&I.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=d_(),this.projectionDelta=d_(),this.projectionDeltaWithTransform=d_()}setAnimationOrigin(x,i=!1){const I=this.snapshot,R=I?I.latestValues:{},k={...this.latestValues},N=d_();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!i;const U=Po(),K=I?I.source:void 0,X=this.layout?this.layout.source:void 0,Z=K!==X,J=this.getStack(),le=!J||J.members.length<=1,de=!!(Z&&!le&&this.options.crossfade===!0&&!this.path.some(Rq));this.animationProgress=0;let ue;this.mixTargetDelta=pe=>{const he=pe/1e3;IM(N.x,x.x,he),IM(N.y,x.y,he),this.setTargetDelta(N),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(hv(U,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Aq(this.relativeTarget,this.relativeTargetOrigin,U,he),ue&&fq(this.relativeTarget,ue)&&(this.isProjectionDirty=!1),ue||(ue=Po()),mu(ue,this.relativeTarget)),Z&&(this.animationValues=k,aq(k,R,this.latestValues,he,de,le)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=he},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(x){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Wp(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Us.update(()=>{S0.hasAnimatedSinceResize=!0,this.currentAnimation=tq(0,CM,{...x,onUpdate:i=>{this.mixTargetDelta(i),x.onUpdate&&x.onUpdate(i)},onComplete:()=>{x.onComplete&&x.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const x=this.getStack();x&&x.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(CM),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const x=this.getLead();let{targetWithTransforms:i,target:I,layout:R,latestValues:k}=x;if(!(!i||!I||!R)){if(this!==x&&this.layout&&R&&S4(this.options.animationType,this.layout.layoutBox,R.layoutBox)){I=this.target||Po();const N=Fc(this.layout.layoutBox.x);I.x.min=x.target.x.min,I.x.max=I.x.min+N;const U=Fc(this.layout.layoutBox.y);I.y.min=x.target.y.min,I.y.max=I.y.min+U}mu(i,I),f_(i,k),dv(this.projectionDeltaWithTransform,this.layoutCorrected,i,k)}}registerSharedNode(x,i){this.sharedNodes.has(x)||this.sharedNodes.set(x,new pq),this.sharedNodes.get(x).add(i);const R=i.options.initialPromotionConfig;i.promote({transition:R?R.transition:void 0,preserveFollowOpacity:R&&R.shouldPreserveFollowOpacity?R.shouldPreserveFollowOpacity(i):void 0})}isLead(){const x=this.getStack();return x?x.lead===this:!0}getLead(){var x;const{layoutId:i}=this.options;return i?((x=this.getStack())===null||x===void 0?void 0:x.lead)||this:this}getPrevLead(){var x;const{layoutId:i}=this.options;return i?(x=this.getStack())===null||x===void 0?void 0:x.prevLead:void 0}getStack(){const{layoutId:x}=this.options;if(x)return this.root.sharedNodes.get(x)}promote({needsReset:x,transition:i,preserveFollowOpacity:I}={}){const R=this.getStack();R&&R.promote(this,I),x&&(this.projectionDelta=void 0,this.needsReset=!0),i&&this.setOptions({transition:i})}relegate(){const x=this.getStack();return x?x.relegate(this):!1}resetSkewAndRotation(){const{visualElement:x}=this.options;if(!x)return;let i=!1;const{latestValues:I}=x;if((I.z||I.rotate||I.rotateX||I.rotateY||I.rotateZ||I.skewX||I.skewY)&&(i=!0),!i)return;const R={};I.z&&n2("z",x,R,this.animationValues);for(let k=0;k<t2.length;k++)n2(`rotate${t2[k]}`,x,R,this.animationValues),n2(`skew${t2[k]}`,x,R,this.animationValues);x.render();for(const k in R)x.setStaticValue(k,R[k]),this.animationValues&&(this.animationValues[k]=R[k]);x.scheduleRender()}getProjectionStyles(x){var i,I;if(!this.instance||this.isSVG)return;if(!this.isVisible)return gq;const R={visibility:""},k=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,R.opacity="",R.pointerEvents=b0(x==null?void 0:x.pointerEvents)||"",R.transform=k?k(this.latestValues,""):"none",R;const N=this.getLead();if(!this.projectionDelta||!this.layout||!N.target){const Z={};return this.options.layoutId&&(Z.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,Z.pointerEvents=b0(x==null?void 0:x.pointerEvents)||""),this.hasProjected&&!Km(this.latestValues)&&(Z.transform=k?k({},""):"none",this.hasProjected=!1),Z}const U=N.animationValues||N.latestValues;this.applyTransformsToTarget(),R.transform=mq(this.projectionDeltaWithTransform,this.treeScale,U),k&&(R.transform=k(U,R.transform));const{x:K,y:X}=this.projectionDelta;R.transformOrigin=`${K.origin*100}% ${X.origin*100}% 0`,N.animationValues?R.opacity=N===this?(I=(i=U.opacity)!==null&&i!==void 0?i:this.latestValues.opacity)!==null&&I!==void 0?I:1:this.preserveOpacity?this.latestValues.opacity:U.opacityExit:R.opacity=N===this?U.opacity!==void 0?U.opacity:"":U.opacityExit!==void 0?U.opacityExit:0;for(const Z in H0){if(U[Z]===void 0)continue;const{correct:J,applyTo:le}=H0[Z],de=R.transform==="none"?U[Z]:J(U[Z],N);if(le){const ue=le.length;for(let pe=0;pe<ue;pe++)R[le[pe]]=de}else R[Z]=de}return this.options.layoutId&&(R.pointerEvents=N===this?b0(x==null?void 0:x.pointerEvents)||"":"none"),R}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(x=>{var i;return(i=x.currentAnimation)===null||i===void 0?void 0:i.stop()}),this.root.nodes.forEach(TM),this.root.sharedNodes.clear()}}}function yq(e){e.updateLayout()}function vq(e){var n;const o=((n=e.resumeFrom)===null||n===void 0?void 0:n.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&o&&e.hasListeners("didUpdate")){const{layoutBox:c,measuredBox:d}=e.layout,{animationType:y}=e.options,x=o.source!==e.layout.source;y==="size"?gu(N=>{const U=x?o.measuredBox[N]:o.layoutBox[N],K=Fc(U);U.min=c[N].min,U.max=U.min+K}):S4(y,o.layoutBox,c)&&gu(N=>{const U=x?o.measuredBox[N]:o.layoutBox[N],K=Fc(c[N]);U.max=U.min+K,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[N].max=e.relativeTarget[N].min+K)});const i=d_();dv(i,c,o.layoutBox);const I=d_();x?dv(I,e.applyTransform(d,!0),o.measuredBox):dv(I,c,o.layoutBox);const R=!v4(i);let k=!1;if(!e.resumeFrom){const N=e.getClosestProjectingParent();if(N&&!N.resumeFrom){const{snapshot:U,layout:K}=N;if(U&&K){const X=Po();hv(X,o.layoutBox,U.layoutBox);const Z=Po();hv(Z,c,K.layoutBox),x4(X,Z)||(k=!0),N.options.layoutRoot&&(e.relativeTarget=Z,e.relativeTargetOrigin=X,e.relativeParent=N)}}}e.notifyListeners("didUpdate",{layout:c,snapshot:o,delta:I,layoutDelta:i,hasLayoutChanged:R,hasRelativeTargetChanged:k})}else if(e.isLead()){const{onExitComplete:c}=e.options;c&&c()}e.options.transition=void 0}function xq(e){rv&&Ym.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function bq(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function wq(e){e.clearSnapshot()}function TM(e){e.clearMeasurements()}function Sq(e){e.isLayoutDirty=!1}function Cq(e){const{visualElement:n}=e.options;n&&n.getProps().onBeforeLayoutMeasure&&n.notify("BeforeLayoutMeasure"),e.resetTransform()}function EM(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Tq(e){e.resolveTargetDelta()}function Eq(e){e.calcProjection()}function Iq(e){e.resetSkewAndRotation()}function Pq(e){e.removeLeadSnapshot()}function IM(e,n,o){e.translate=uo(n.translate,0,o),e.scale=uo(n.scale,1,o),e.origin=n.origin,e.originPoint=n.originPoint}function PM(e,n,o,c){e.min=uo(n.min,o.min,c),e.max=uo(n.max,o.max,c)}function Aq(e,n,o,c){PM(e.x,n.x,o.x,c),PM(e.y,n.y,o.y,c)}function Rq(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const Mq={duration:.45,ease:[.4,0,.1,1]},AM=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),RM=AM("applewebkit/")&&!AM("chrome/")?Math.round:Mc;function MM(e){e.min=RM(e.min),e.max=RM(e.max)}function Lq(e){MM(e.x),MM(e.y)}function S4(e,n,o){return e==="position"||e==="preserve-aspect"&&!OW(wM(n),wM(o),.2)}function Dq(e){var n;return e!==e.root&&((n=e.scroll)===null||n===void 0?void 0:n.wasRoot)}const kq=w4({attachResizeListener:(e,n)=>Iv(e,"resize",n),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),r2={current:void 0},C4=w4({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!r2.current){const e=new kq({});e.mount(window),e.setOptions({layoutScroll:!0}),r2.current=e}return r2.current},resetTransform:(e,n)=>{e.style.transform=n!==void 0?n:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),Oq={pan:{Feature:YW},drag:{Feature:KW,ProjectionNode:C4,MeasureLayout:g4}};function LM(e,n,o){const{props:c}=e;e.animationState&&c.whileHover&&e.animationState.setActive("whileHover",o==="Start");const d="onHover"+o,y=c[d];y&&Us.postRender(()=>y(n,Zv(n)))}class zq extends em{mount(){const{current:n}=this.node;n&&(this.unmount=OH(n,o=>(LM(this.node,o,"Start"),c=>LM(this.node,c,"End"))))}unmount(){}}class Fq extends em{constructor(){super(...arguments),this.isActive=!1}onFocus(){let n=!1;try{n=this.node.current.matches(":focus-visible")}catch{n=!0}!n||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=qv(Iv(this.node.current,"focus",()=>this.onFocus()),Iv(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function DM(e,n,o){const{props:c}=e;e.animationState&&c.whileTap&&e.animationState.setActive("whileTap",o==="Start");const d="onTap"+(o==="End"?"":o),y=c[d];y&&Us.postRender(()=>y(n,Zv(n)))}class Nq extends em{mount(){const{current:n}=this.node;n&&(this.unmount=jH(n,o=>(DM(this.node,o,"Start"),(c,{success:d})=>DM(this.node,c,d?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const hS=new WeakMap,i2=new WeakMap,jq=e=>{const n=hS.get(e.target);n&&n(e)},Bq=e=>{e.forEach(jq)};function Vq({root:e,...n}){const o=e||document;i2.has(o)||i2.set(o,{});const c=i2.get(o),d=JSON.stringify(n);return c[d]||(c[d]=new IntersectionObserver(Bq,{root:e,...n})),c[d]}function Uq(e,n,o){const c=Vq(n);return hS.set(e,o),c.observe(e),()=>{hS.delete(e),c.unobserve(e)}}const $q={some:0,all:1};class Hq extends em{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:n={}}=this.node.getProps(),{root:o,margin:c,amount:d="some",once:y}=n,x={root:o?o.current:void 0,rootMargin:c,threshold:typeof d=="number"?d:$q[d]},i=I=>{const{isIntersecting:R}=I;if(this.isInView===R||(this.isInView=R,y&&!R&&this.hasEnteredView))return;R&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",R);const{onViewportEnter:k,onViewportLeave:N}=this.node.getProps(),U=R?k:N;U&&U(I)};return Uq(this.node.current,x,i)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:n,prevProps:o}=this.node;["amount","margin","root"].some(Gq(n,o))&&this.startObserver()}unmount(){}}function Gq({viewport:e={}},{viewport:n={}}={}){return o=>e[o]!==n[o]}const Wq={inView:{Feature:Hq},tap:{Feature:Nq},focus:{Feature:Fq},hover:{Feature:zq}},qq={layout:{ProjectionNode:C4,MeasureLayout:g4}},fS={current:null},T4={current:!1};function Zq(){if(T4.current=!0,!!vC)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),n=()=>fS.current=e.matches;e.addListener(n),n()}else fS.current=!1}const Xq=[...Kz,Ua,qp],Kq=e=>Xq.find(Xz(e)),kM=new WeakMap;function Yq(e,n,o){for(const c in n){const d=n[c],y=o[c];if(qa(d))e.addValue(c,d);else if(qa(y))e.addValue(c,Tv(d,{owner:e}));else if(y!==d)if(e.hasValue(c)){const x=e.getValue(c);x.liveStyle===!0?x.jump(d):x.hasAnimated||x.set(d)}else{const x=e.getStaticValue(c);e.addValue(c,Tv(x!==void 0?x:d,{owner:e}))}}for(const c in o)n[c]===void 0&&e.removeValue(c);return n}const OM=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Jq{scrapeMotionValuesFromProps(n,o,c){return{}}constructor({parent:n,props:o,presenceContext:c,reducedMotionConfig:d,blockInitialAnimation:y,visualState:x},i={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=WC,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const K=Ch.now();this.renderScheduledAt<K&&(this.renderScheduledAt=K,Us.render(this.render,!1,!0))};const{latestValues:I,renderState:R,onUpdate:k}=x;this.onUpdate=k,this.latestValues=I,this.baseTarget={...I},this.initialValues=o.initial?{...I}:{},this.renderState=R,this.parent=n,this.props=o,this.presenceContext=c,this.depth=n?n.depth+1:0,this.reducedMotionConfig=d,this.options=i,this.blockInitialAnimation=!!y,this.isControllingVariants=N1(o),this.isVariantNode=iz(o),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(n&&n.current);const{willChange:N,...U}=this.scrapeMotionValuesFromProps(o,{},this);for(const K in U){const X=U[K];I[K]!==void 0&&qa(X)&&X.set(I[K],!1)}}mount(n){this.current=n,kM.set(n,this),this.projection&&!this.projection.instance&&this.projection.mount(n),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((o,c)=>this.bindToMotionValue(c,o)),T4.current||Zq(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:fS.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){kM.delete(this.current),this.projection&&this.projection.unmount(),Wp(this.notifyUpdate),Wp(this.render),this.valueSubscriptions.forEach(n=>n()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const n in this.events)this.events[n].clear();for(const n in this.features){const o=this.features[n];o&&(o.unmount(),o.isMounted=!1)}this.current=null}bindToMotionValue(n,o){this.valueSubscriptions.has(n)&&this.valueSubscriptions.get(n)();const c=yg.has(n),d=o.on("change",i=>{this.latestValues[n]=i,this.props.onUpdate&&Us.preRender(this.notifyUpdate),c&&this.projection&&(this.projection.isTransformDirty=!0)}),y=o.on("renderRequest",this.scheduleRender);let x;window.MotionCheckAppearSync&&(x=window.MotionCheckAppearSync(this,n,o)),this.valueSubscriptions.set(n,()=>{d(),y(),x&&x(),o.owner&&o.stop()})}sortNodePosition(n){return!this.current||!this.sortInstanceNodePosition||this.type!==n.type?0:this.sortInstanceNodePosition(this.current,n.current)}updateFeatures(){let n="animation";for(n in T_){const o=T_[n];if(!o)continue;const{isEnabled:c,Feature:d}=o;if(!this.features[n]&&d&&c(this.props)&&(this.features[n]=new d(this)),this.features[n]){const y=this.features[n];y.isMounted?y.update():(y.mount(),y.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Po()}getStaticValue(n){return this.latestValues[n]}setStaticValue(n,o){this.latestValues[n]=o}update(n,o){(n.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=n,this.prevPresenceContext=this.presenceContext,this.presenceContext=o;for(let c=0;c<OM.length;c++){const d=OM[c];this.propEventSubscriptions[d]&&(this.propEventSubscriptions[d](),delete this.propEventSubscriptions[d]);const y="on"+d,x=n[y];x&&(this.propEventSubscriptions[d]=this.on(d,x))}this.prevMotionValues=Yq(this,this.scrapeMotionValuesFromProps(n,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(n){return this.props.variants?this.props.variants[n]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(n){const o=this.getClosestVariantNode();if(o)return o.variantChildren&&o.variantChildren.add(n),()=>o.variantChildren.delete(n)}addValue(n,o){const c=this.values.get(n);o!==c&&(c&&this.removeValue(n),this.bindToMotionValue(n,o),this.values.set(n,o),this.latestValues[n]=o.get())}removeValue(n){this.values.delete(n);const o=this.valueSubscriptions.get(n);o&&(o(),this.valueSubscriptions.delete(n)),delete this.latestValues[n],this.removeValueFromRenderState(n,this.renderState)}hasValue(n){return this.values.has(n)}getValue(n,o){if(this.props.values&&this.props.values[n])return this.props.values[n];let c=this.values.get(n);return c===void 0&&o!==void 0&&(c=Tv(o===null?void 0:o,{owner:this}),this.addValue(n,c)),c}readValue(n,o){var c;let d=this.latestValues[n]!==void 0||!this.current?this.latestValues[n]:(c=this.getBaseTargetFromProps(this.props,n))!==null&&c!==void 0?c:this.readValueFromInstance(this.current,n,this.options);return d!=null&&(typeof d=="string"&&(qz(d)||Nz(d))?d=parseFloat(d):!Kq(d)&&qp.test(o)&&(d=Hz(n,o)),this.setBaseTarget(n,qa(d)?d.get():d)),qa(d)?d.get():d}setBaseTarget(n,o){this.baseTarget[n]=o}getBaseTarget(n){var o;const{initial:c}=this.props;let d;if(typeof c=="string"||typeof c=="object"){const x=EC(this.props,c,(o=this.presenceContext)===null||o===void 0?void 0:o.custom);x&&(d=x[n])}if(c&&d!==void 0)return d;const y=this.getBaseTargetFromProps(this.props,n);return y!==void 0&&!qa(y)?y:this.initialValues[n]!==void 0&&d===void 0?void 0:this.baseTarget[n]}on(n,o){return this.events[n]||(this.events[n]=new BC),this.events[n].add(o)}notify(n,...o){this.events[n]&&this.events[n].notify(...o)}}class E4 extends Jq{constructor(){super(...arguments),this.KeyframeResolver=Yz}sortInstanceNodePosition(n,o){return n.compareDocumentPosition(o)&2?1:-1}getBaseTargetFromProps(n,o){return n.style?n.style[o]:void 0}removeValueFromRenderState(n,{vars:o,style:c}){delete o[n],delete c[n]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:n}=this.props;qa(n)&&(this.childSubscription=n.on("change",o=>{this.current&&(this.current.textContent=`${o}`)}))}}function Qq(e){return window.getComputedStyle(e)}class eZ extends E4{constructor(){super(...arguments),this.type="html",this.renderInstance=fz}readValueFromInstance(n,o){if(yg.has(o)){const c=GC(o);return c&&c.default||0}else{const c=Qq(n),d=(uz(o)?c.getPropertyValue(o):c[o])||0;return typeof d=="string"?d.trim():d}}measureInstanceViewportBox(n,{transformPagePoint:o}){return p4(n,o)}build(n,o,c){AC(n,o,c.transformTemplate)}scrapeMotionValuesFromProps(n,o,c){return DC(n,o,c)}}class tZ extends E4{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Po}getBaseTargetFromProps(n,o){return n[o]}readValueFromInstance(n,o){if(yg.has(o)){const c=GC(o);return c&&c.default||0}return o=pz.has(o)?o:SC(o),n.getAttribute(o)}scrapeMotionValuesFromProps(n,o,c){return _z(n,o,c)}build(n,o,c){RC(n,o,this.isSVGTag,c.transformTemplate)}renderInstance(n,o,c,d){mz(n,o,c,d)}mount(n){this.isSVGTag=LC(n.tagName),super.mount(n)}}const nZ=(e,n)=>TC(e)?new tZ(n):new eZ(n,{allowProjection:e!==V.Fragment}),rZ=PH({...EW,...Wq,...Oq,...qq},nZ),Za=$7(rZ),I4=V.createContext(),KC=()=>{const e=V.useContext(I4);if(!e)throw new Error("useCartContext must be used within a CartProvider");return e},iZ=({children:e})=>{const n="pk_test_51QdZtOKlSPpwAw12qu2014zhUSSOlMHXuhIQEyumWRgxZRAH2zKn5o5agU6UIeZG6SLGRHST6Pf8jylB7RNOvPTK00yJi088Bk";V.useEffect(()=>{},[n]);const[o,c]=V.useState(()=>{const k=localStorage.getItem("cart");return k?JSON.parse(k):[]});V.useEffect(()=>{localStorage.setItem("cart",JSON.stringify(o))},[o]);const R={cartItems:o,addToCart:k=>{k.id&&c(N=>N.find(K=>K.product.id===k.id)?N.map(K=>K.product.id===k.id?{...K,quantity:K.quantity+1}:K):[...N,{product:k,quantity:1}])},removeFromCart:k=>{c(N=>N.filter(U=>U.product.id!==k))},updateQuantity:(k,N)=>{N<1||c(U=>U.map(K=>K.product.id===k?{...K,quantity:N}:K))},getTotal:()=>o.reduce((k,N)=>k+N.product.price*N.quantity,0),clearCart:()=>{c([]),localStorage.removeItem("cart")},stripePublicKey:n};return T.jsx(I4.Provider,{value:R,children:e})};var P4="https://js.stripe.com/v3",sZ=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/;var oZ=function(){for(var n=document.querySelectorAll('script[src^="'.concat(P4,'"]')),o=0;o<n.length;o++){var c=n[o];if(sZ.test(c.src))return c}return null},aZ=function(n){var o="",c=document.createElement("script");c.src="".concat(P4).concat(o);var d=document.head||document.body;if(!d)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return d.appendChild(c),c},lZ=function(n,o){!n||!n._registerWrapper||n._registerWrapper({name:"stripe-js",version:"1.54.2",startTime:o})},a0=null,cZ=function(n){return a0!==null||(a0=new Promise(function(o,c){if(typeof window>"u"||typeof document>"u"){o(null);return}if(window.Stripe){o(window.Stripe);return}try{var d=oZ();d&&n||d||(d=aZ(n)),d.addEventListener("load",function(){window.Stripe?o(window.Stripe):c(new Error("Stripe.js not available"))}),d.addEventListener("error",function(){c(new Error("Failed to load Stripe.js"))})}catch(y){c(y);return}})),a0},uZ=function(n,o,c){if(n===null)return null;var d=n.apply(void 0,o);return lZ(d,c),d},A4=Promise.resolve().then(function(){return cZ(null)}),R4=!1;A4.catch(function(e){R4||console.warn(e)});var dZ=function(){for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];R4=!0;var d=Date.now();return A4.then(function(y){return uZ(y,o,d)})};function hZ(e){return Di({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .49.598l-1 5a.5.5 0 0 1-.465.401l-9.397.472L4.415 11H13a.5.5 0 0 1 0 1H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5M3.102 4l.84 4.479 9.144-.459L13.89 4zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4m7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4m-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2m7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2"},child:[]}]})(e)}const fZ=(e,n,o,c)=>{var y,x,i,I;const d=[o,{code:n,...c||{}}];if((x=(y=e==null?void 0:e.services)==null?void 0:y.logger)!=null&&x.forward)return e.services.logger.forward(d,"warn","react-i18next::",!0);og(d[0])&&(d[0]=`react-i18next:: ${d[0]}`),(I=(i=e==null?void 0:e.services)==null?void 0:i.logger)!=null&&I.warn?e.services.logger.warn(...d):console!=null&&console.warn&&console.warn(...d)},zM={},pS=(e,n,o,c)=>{og(o)&&zM[o]||(og(o)&&(zM[o]=new Date),fZ(e,n,o,c))},M4=(e,n)=>()=>{if(e.isInitialized)n();else{const o=()=>{setTimeout(()=>{e.off("initialized",o)},0),n()};e.on("initialized",o)}},mS=(e,n,o)=>{e.loadNamespaces(n,M4(e,o))},FM=(e,n,o,c)=>{if(og(o)&&(o=[o]),e.options.preload&&e.options.preload.indexOf(n)>-1)return mS(e,o,c);o.forEach(d=>{e.options.ns.indexOf(d)<0&&e.options.ns.push(d)}),e.loadLanguages(n,M4(e,c))},pZ=(e,n,o={})=>!n.languages||!n.languages.length?(pS(n,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:n.languages}),!0):n.hasLoadedNamespace(e,{lng:o.lng,precheck:(c,d)=>{var y;if(((y=o.bindI18n)==null?void 0:y.indexOf("languageChanging"))>-1&&c.services.backendConnector.backend&&c.isLanguageChangingTo&&!d(c.isLanguageChangingTo,e))return!1}}),og=e=>typeof e=="string",mZ=e=>typeof e=="object"&&e!==null,gZ=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,_Z={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},yZ=e=>_Z[e],vZ=e=>e.replace(gZ,yZ);let gS={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:vZ};const xZ=(e={})=>{gS={...gS,...e}},bZ=()=>gS;let L4;const wZ=e=>{L4=e},SZ=()=>L4,CZ={type:"3rdParty",init(e){xZ(e.options.react),wZ(e)}},TZ=V.createContext();class EZ{constructor(){this.usedNamespaces={}}addUsedNamespaces(n){n.forEach(o=>{this.usedNamespaces[o]||(this.usedNamespaces[o]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const IZ=(e,n)=>{const o=V.useRef();return V.useEffect(()=>{o.current=e},[e,n]),o.current},D4=(e,n,o,c)=>e.getFixedT(n,o,c),PZ=(e,n,o,c)=>V.useCallback(D4(e,n,o,c),[e,n,o,c]),Rs=(e,n={})=>{var pe,he,xe,fe;const{i18n:o}=n,{i18n:c,defaultNS:d}=V.useContext(TZ)||{},y=o||c||SZ();if(y&&!y.reportNamespaces&&(y.reportNamespaces=new EZ),!y){pS(y,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const _e=(je,He)=>og(He)?He:mZ(He)&&og(He.defaultValue)?He.defaultValue:Array.isArray(je)?je[je.length-1]:je,Ce=[_e,{},!1];return Ce.t=_e,Ce.i18n={},Ce.ready=!1,Ce}(pe=y.options.react)!=null&&pe.wait&&pS(y,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const x={...bZ(),...y.options.react,...n},{useSuspense:i,keyPrefix:I}=x;let R=d||((he=y.options)==null?void 0:he.defaultNS);R=og(R)?[R]:R||["translation"],(fe=(xe=y.reportNamespaces).addUsedNamespaces)==null||fe.call(xe,R);const k=(y.isInitialized||y.initializedStoreOnce)&&R.every(_e=>pZ(_e,y,x)),N=PZ(y,n.lng||null,x.nsMode==="fallback"?R:R[0],I),U=()=>N,K=()=>D4(y,n.lng||null,x.nsMode==="fallback"?R:R[0],I),[X,Z]=V.useState(U);let J=R.join();n.lng&&(J=`${n.lng}${J}`);const le=IZ(J),de=V.useRef(!0);V.useEffect(()=>{const{bindI18n:_e,bindI18nStore:Ce}=x;de.current=!0,!k&&!i&&(n.lng?FM(y,n.lng,R,()=>{de.current&&Z(K)}):mS(y,R,()=>{de.current&&Z(K)})),k&&le&&le!==J&&de.current&&Z(K);const je=()=>{de.current&&Z(K)};return _e&&(y==null||y.on(_e,je)),Ce&&(y==null||y.store.on(Ce,je)),()=>{de.current=!1,y&&(_e==null||_e.split(" ").forEach(He=>y.off(He,je))),Ce&&y&&Ce.split(" ").forEach(He=>y.store.off(He,je))}},[y,J]),V.useEffect(()=>{de.current&&k&&Z(U)},[y,I,k]);const ue=[X,y,k];if(ue.t=X,ue.i18n=y,ue.ready=k,k||!k&&!i)return ue;throw new Promise(_e=>{n.lng?FM(y,n.lng,R,()=>_e()):mS(y,R,()=>_e())})},AZ=()=>{const{t:e}=Rs(),{cartItems:n,removeFromCart:o,updateQuantity:c,getTotal:d,clearCart:y,stripePublicKey:x}=KC(),[i,I]=V.useState(!1),[R,k]=V.useState(!1),[N,U]=V.useState(null),{isLoggedIn:K,token:X}=Ih(),Z=Cu(),J=ml(),le=n.reduce((pe,he)=>pe+he.quantity,0),de=V.useMemo(()=>{try{return x?dZ(x):(console.error("La cl publique Stripe n'est pas dfinie"),null)}catch(pe){return console.error("Erreur d'initialisation de Stripe:",pe),null}},[x]);if(!K)return null;const ue=async()=>{if(!K){Z("/login");return}k(!0),U(null);try{const pe=await de;if(!pe)throw new Error("La configuration de Stripe n'est pas complte. Veuillez ressayer plus tard.");console.log("Cart items before sending:",n);const he=n.map(Ce=>({productId:Ce.product.id,quantity:Ce.quantity,price:Ce.product.price}));console.log("Formatted order items:",he);const xe=await J.post("/ecommerce/orders",{items:he});console.log("Order created:",xe);const fe=await J.post(`/ecommerce/create-checkout-session?orderId=${xe.id}`);if(console.log("Stripe session:",fe),!fe||!fe.sessionId)throw new Error("Impossible de crer la session de paiement");const{error:_e}=await pe.redirectToCheckout({sessionId:fe.sessionId});if(_e)throw console.error("Stripe redirect error:",_e),new Error(_e.message||"Erreur lors de la redirection vers la page de paiement")}catch(pe){console.error("Erreur lors du paiement:",pe);let he="Une erreur est survenue lors du paiement. ";pe.response?he+=pe.response.data.message||"Erreur de rponse du serveur.":pe.request?he+="Impossible de se connecter au serveur de paiement.":he+="Erreur de configuration de la requte.",U(he)}finally{k(!1)}};return T.jsxs(T.Fragment,{children:[T.jsx(Za.div,{whileHover:{scale:1.05},whileTap:{scale:.95},style:{display:"inline-block"},children:T.jsxs(Qn,{variant:"outline-primary",className:"rounded-pill position-relative",onClick:()=>I(!0),children:[T.jsx(hZ,{size:20}),le>0&&T.jsx(ia,{bg:"danger",className:"position-absolute top-0 start-100 translate-middle rounded-pill",children:le})]})}),T.jsxs(Wi,{show:i,onHide:()=>I(!1),size:"lg",centered:!0,children:[T.jsx(Wi.Header,{closeButton:!0,children:T.jsx(Wi.Title,{children:e("cart.title","Votre Panier")})}),T.jsxs(Wi.Body,{children:[n.length===0?T.jsxs("div",{className:"text-center py-4",children:[T.jsx("span",{style:{fontSize:"2.5rem",color:"#ccc"},children:""}),T.jsx("p",{className:"mt-3",children:e("cart.empty","Votre panier est vide")}),T.jsx(Qn,{variant:"outline-primary",onClick:()=>{I(!1),Z("/gps-collars")},children:e("cart.backToShop","Retourner  la boutique")})]}):T.jsx(hd,{children:n.map(pe=>T.jsx(hd.Item,{className:"py-3",children:T.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[T.jsxs("div",{children:[T.jsx("h6",{className:"mb-1",children:pe.product.name}),T.jsxs("p",{className:"mb-0 text-primary",children:[pe.product.price.toFixed(2)," "]})]}),T.jsxs("div",{className:"d-flex align-items-center gap-3",children:[T.jsx(ot.Control,{type:"number",min:"1",value:pe.quantity,onChange:he=>c(pe.product.id,parseInt(he.target.value)),style:{width:"70px"},className:"text-center"}),T.jsx(Qn,{variant:"outline-danger",size:"sm",onClick:()=>o(pe.product.id),children:""})]})]})},pe.product.id))}),n.length>0&&T.jsx("div",{className:"mt-4 text-end",children:T.jsxs("h5",{children:[e("cart.total","Total"),": ",d().toFixed(2)," "]})}),N&&T.jsxs("div",{className:"alert alert-danger mt-3",children:[e("cart.error","Erreur"),": ",N]})]}),T.jsxs(Wi.Footer,{children:[T.jsx(Qn,{variant:"secondary",onClick:()=>I(!1),children:e("cart.close","Fermer")}),n.length>0&&T.jsx(Qn,{variant:"primary",onClick:ue,disabled:R,children:R?e("cart.loading","Chargement..."):e("cart.pay","Payer")})]})]})]})};function K0(){return K0=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(e[c]=o[c])}return e},K0.apply(this,arguments)}function RZ(e,n){if(e==null)return{};var o={},c=Object.keys(e),d,y;for(y=0;y<c.length;y++)d=c[y],!(n.indexOf(d)>=0)&&(o[d]=e[d]);return o}var MZ=["cdnSuffix","cdnUrl","countryCode","style","svg"],LZ="https://cdn.jsdelivr.net/gh/lipis/flag-icons/flags/4x3/",DZ="svg",kZ=127397,NM=function(n){var o=n.cdnSuffix,c=o===void 0?DZ:o,d=n.cdnUrl,y=d===void 0?LZ:d,x=n.countryCode,i=n.style,I=n.svg,R=I===void 0?!1:I,k=RZ(n,MZ);if(typeof x!="string")return null;if(R){var N=""+y+x.toLowerCase()+"."+c;return V.createElement("img",Object.assign({},k,{src:N,style:K0({display:"inline-block",width:"1em",height:"1em",verticalAlign:"middle"},i)}))}var U=x.toUpperCase().replace(/./g,function(K){return String.fromCodePoint(K.charCodeAt(0)+kZ)});return V.createElement("span",Object.assign({role:"img"},k,{style:K0({display:"inline-block",fontSize:"1em",lineHeight:"1em",verticalAlign:"middle"},i)}),U)};const k4=V.createContext(),OZ=()=>V.useContext(k4),zZ=({children:e})=>{const{i18n:n}=Rs(),[o,c]=V.useState(n.language),d=V.useMemo(()=>[{code:"fr",name:"Franais",flag:""},{code:"en",name:"English",flag:""},{code:"nl",name:"Nederlands",flag:""}],[]),y=i=>{n.changeLanguage(i),localStorage.setItem("language",i),c(i)};V.useEffect(()=>{const i=localStorage.getItem("language");if(i)n.changeLanguage(i),c(i);else{const I=navigator.language.split("-")[0];d.find(k=>k.code===I)?(n.changeLanguage(I),c(I),localStorage.setItem("language",I)):(n.changeLanguage("fr"),c("fr"),localStorage.setItem("language","fr"))}},[n,d]);const x={currentLanguage:o,languages:d,changeLanguage:y};return T.jsx(k4.Provider,{value:x,children:e})},jM=()=>{const{currentLanguage:e,languages:n,changeLanguage:o}=OZ(),[c,d]=V.useState(!1),[y,x]=V.useState(""),i=n.find(k=>k.code===e)||n[0],I={fr:"FR",en:"GB",nl:"NL"},R=k=>{const N=n.find(U=>U.code===k);o(k),x(`${N.name} slectionn(e)`),d(!0)};return T.jsxs(T.Fragment,{children:[T.jsxs(wf,{align:"end",children:[T.jsx(wf.Toggle,{variant:"link",id:"dropdown-language",style:{color:"#666",fontSize:"0.95rem",fontWeight:"500",padding:"0.5rem 1rem",textDecoration:"none",background:"none",border:"none",display:"flex",alignItems:"center",gap:"0.5rem"},children:T.jsxs(Za.div,{whileHover:{scale:1.1},whileTap:{scale:.9},style:{display:"inline-flex",alignItems:"center"},children:[T.jsx(NM,{countryCode:I[i.code],svg:!0,style:{width:"1.3em",height:"1.3em",marginRight:6,borderRadius:"3px",boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},"aria-label":i.name}),T.jsx("span",{style:{marginLeft:2},children:i.name})]})}),T.jsx(wf.Menu,{children:n.map(k=>T.jsxs(wf.Item,{onClick:()=>R(k.code),active:e===k.code,style:{display:"flex",alignItems:"center",gap:8},children:[T.jsx(NM,{countryCode:I[k.code],svg:!0,style:{width:"1.2em",height:"1.2em",borderRadius:"2px",boxShadow:"0 1px 2px rgba(0,0,0,0.08)"},"aria-label":k.name}),T.jsx("span",{children:k.name})]},k.code))})]}),T.jsx(mO,{position:"top-end",className:"p-3",style:{zIndex:9999},children:T.jsx(rR,{show:c,onClose:()=>d(!1),delay:1200,autohide:!0,bg:"info",children:T.jsx(rR.Body,{style:{color:"#fff",fontWeight:500},children:y})})})]})},FZ=()=>{const{isLoggedIn:e,userData:n,logout:o}=Ih();Cu();const c=gg(),[d,y]=V.useState(!1),{t:x}=Rs();V.useEffect(()=>{const U=()=>{const K=window.scrollY>10;K!==d&&y(K)};return window.addEventListener("scroll",U),()=>{window.removeEventListener("scroll",U)}},[d]);const i=()=>{window.confirm(x("auth.logoutConfirm","tes-vous sr de vouloir vous dconnecter ?"))&&o()},I={backgroundColor:d?"rgba(255, 255, 255, 0.95)":"rgba(255, 255, 255, 0.8)",backdropFilter:"blur(10px)",transition:"all 0.3s ease-in-out",boxShadow:d?"0 2px 10px rgba(0,0,0,0.1)":"none"},R={position:"relative",color:"#666",fontSize:"0.95rem",fontWeight:"500",padding:"0.5rem 1rem",transition:"color 0.3s ease"},k={...R,color:"#007bff"},N={hover:{scale:1.05,transition:{duration:.2}},tap:{scale:.95}};return T.jsx(r0,{expand:"lg",fixed:"top",style:I,children:T.jsxs(Ro,{children:[T.jsx(r0.Brand,{as:co,to:"/",children:T.jsx(Za.img,{src:P$,width:"70",className:"d-inline-block align-top",alt:"Logo",whileHover:{scale:1.1},whileTap:{scale:.9}})}),T.jsx(r0.Toggle,{"aria-controls":"basic-navbar-nav"}),T.jsxs(r0.Collapse,{id:"basic-navbar-nav",children:[T.jsxs(Ap,{className:"mx-auto",children:[T.jsxs(Ap.Link,{as:co,to:"/",style:c.pathname==="/"?k:R,children:[T.jsx(ZO,{className:"me-1"})," ",x("navbar.home","Accueil")]}),T.jsxs(Ap.Link,{as:co,to:"/contact",style:c.pathname==="/contact"?k:R,children:[T.jsx(cg,{className:"me-1"})," ",x("navbar.contact","Contact")]}),T.jsxs(Ap.Link,{as:co,to:"/registerCat",style:c.pathname==="/registerCat"?k:R,children:[T.jsx(qO,{className:"me-1"})," ",x("navbar.report","Signaler")]}),T.jsxs(Ap.Link,{as:co,to:"/lostCats",style:c.pathname==="/lostCats"?k:R,children:[T.jsx(_C,{className:"me-1"})," ",x("navbar.lost","Perdu")]}),T.jsxs(Ap.Link,{as:co,to:"/foundCats",style:c.pathname==="/foundCats"?k:R,children:[T.jsx(hl,{className:"me-1"})," ",x("navbar.found","Trouv")]}),T.jsxs(Ap.Link,{as:co,to:"/gps-collars",style:c.pathname==="/gps-collars"?k:R,children:[T.jsx(M7,{className:"me-1"})," ",x("navbar.gpsCollars","Colliers GPS")]})]}),T.jsx(Ap,{children:e?T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"me-3",children:T.jsx(AZ,{})}),T.jsx(jM,{className:"me-2"}),T.jsxs(wf,{align:"end",children:[T.jsxs(wf.Toggle,{variant:"link",id:"dropdown-basic",style:R,children:[T.jsx(Gp,{className:"me-1"})," ",n?`${x("navbar.hello","Bonjour")} ${n.firstName}`:x("navbar.hello","Bonjour")]}),T.jsxs(wf.Menu,{children:[T.jsxs(wf.Item,{as:co,to:"/profile",children:[T.jsx(Gp,{className:"me-2"})," ",x("navbar.profile","Profil")]}),T.jsxs(wf.Item,{onClick:i,children:[T.jsx(R7,{className:"me-2"})," ",x("navbar.logout","Dconnexion")]})]})]})]}):T.jsxs("div",{className:"d-flex gap-2 align-items-center",children:[T.jsx(jM,{className:"me-2"}),T.jsx(Za.div,{variants:N,whileHover:"hover",whileTap:"tap",children:T.jsx(Qn,{as:co,to:"/login",variant:"outline-primary",className:"rounded-pill px-4",children:x("navbar.login","Connexion")})}),T.jsx(Za.div,{variants:N,whileHover:"hover",whileTap:"tap",children:T.jsx(Qn,{as:co,to:"/register",variant:"primary",className:"rounded-pill px-4",children:x("navbar.register","Inscription")})})]})})]})]})})},NZ=()=>{const{t:e,i18n:n}=Rs(),o=new Date().getFullYear(),c=[{icon:T.jsx(_7,{}),url:"https://facebook.com",label:"Facebook"},{icon:T.jsx(x7,{}),url:"https://twitter.com",label:"Twitter"},{icon:T.jsx(y7,{}),url:"https://instagram.com",label:"Instagram"},{icon:T.jsx(v7,{}),url:"https://linkedin.com",label:"LinkedIn"}],d={backgroundColor:"#fff",borderTop:"1px solid var(--secondary-color)",marginTop:"2rem"},y={width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",backgroundColor:"var(--primary-color)",color:"#fff",fontSize:"1rem",transition:"all 0.3s ease"},x={fontSize:"1.1rem",fontWeight:"600",marginBottom:"1.5rem",color:"var(--primary-color)",position:"relative",paddingBottom:"0.5rem"},i={color:"var(--dark-text)",textDecoration:"none",transition:"color 0.3s ease",display:"block",marginBottom:"0.5rem"};return T.jsx("footer",{style:d,children:T.jsxs(Ro,{children:[T.jsxs(vi,{className:"py-4",children:[T.jsxs(Un,{lg:4,md:6,className:"mb-4 mb-lg-0",children:[T.jsx("h5",{style:x,children:e("footer.brand","Whisker Quest")}),T.jsx("p",{className:"mb-4",style:{color:"var(--dark-text)"},children:e("footer.tagline","Votre compagnon de confiance pour retrouver les chats perdus.")}),T.jsx("div",{className:"d-flex gap-2",children:c.map((I,R)=>T.jsx(Za.a,{href:I.url,target:"_blank",rel:"noopener noreferrer",style:y,whileHover:{scale:1.1,backgroundColor:"var(--secondary-color)"},"aria-label":I.label,children:I.icon},R))})]}),T.jsxs(Un,{lg:4,md:6,className:"mb-4 mb-lg-0",children:[T.jsx("h5",{style:x,children:e("footer.about","Navigation")}),T.jsxs("nav",{children:[T.jsxs(co,{to:"/",style:i,children:[T.jsx(ZO,{className:"me-2"}),e("navbar.home","Accueil")]}),T.jsxs(co,{to:"/lostCats",style:i,children:[T.jsx(hl,{className:"me-2"}),e("navbar.lost","Chats Perdus")]}),T.jsxs(co,{to:"/foundCats",style:i,children:[T.jsx(hl,{className:"me-2"}),e("navbar.found","Chats Trouvs")]}),T.jsxs(co,{to:"/contact",style:i,children:[T.jsx(cg,{className:"me-2"}),e("footer.contact","Contact")]})]})]}),T.jsxs(Un,{lg:4,md:12,children:[T.jsx("h5",{style:x,children:e("footer.contact","Contact")}),T.jsxs("div",{style:{color:"var(--dark-text)"},children:[T.jsxs("p",{className:"d-flex align-items-center mb-2",children:[T.jsx(zc,{className:"me-2"}),e("footer.address","Braine L'Alleud, 1420, BE")]}),T.jsx("p",{className:"mb-2",children:T.jsxs("a",{href:"mailto:info@whiskerquest.be",style:i,className:"d-flex align-items-center",children:[T.jsx(cg,{className:"me-2"}),"info@whiskerquest.be"]})}),T.jsx("p",{className:"mb-2",children:T.jsxs("a",{href:"tel:+32493963375",style:i,className:"d-flex align-items-center",children:[T.jsx(O1,{className:"me-2"}),"+32 493 96 33 75"]})})]})]})]}),T.jsx(vi,{children:T.jsx(Un,{className:"text-center py-3",style:{borderTop:"1px solid var(--secondary-color)"},children:T.jsxs("p",{className:"mb-0",children:[e("footer.copyright",{year:o,defaultValue:`${o} Whisker Quest - Dvelopp avec`})," ",T.jsx("span",{style:{color:"#dc3545"},children:""})," MOTQUIN Anas - ",e("footer.followUs","Suivez-nous")]})})})]})})},YC={borderColor:"#f26052",color:"rgba(0, 0, 0, 0.65)"};var C0={exports:{}},jZ=C0.exports,BM;function BZ(){return BM||(BM=1,function(e,n){(function(o,c){e.exports=c()})(jZ,function(){var o,c,d;function y(i,I){if(!o)o=I;else if(!c)c=I;else{var R="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+o+")(sharedChunk); ("+c+")(sharedChunk); self.onerror = null;",k={};o(k),d=I(k),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(d.workerUrl=window.URL.createObjectURL(new Blob([R],{type:"text/javascript"})))}}y(["exports"],function(i){var I=1e-6,R=typeof Float32Array<"u"?Float32Array:Array;function k(a,t){var s=t[0],u=t[1],h=t[2],m=t[3],_=s*m-h*u;return _?(a[0]=m*(_=1/_),a[1]=-u*_,a[2]=-h*_,a[3]=s*_,a):null}function N(){var a=new R(9);return R!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function U(a,t){var s=t[0],u=t[1],h=t[2],m=t[3],_=t[4],S=t[5],E=t[6],A=t[7],D=t[8];return a[0]=_*D-S*A,a[1]=h*A-u*D,a[2]=u*S-h*_,a[3]=S*E-m*D,a[4]=s*D-h*E,a[5]=h*m-s*S,a[6]=m*A-_*E,a[7]=u*E-s*A,a[8]=s*_-u*m,a}function K(a,t,s){var u=t[0],h=t[1],m=t[2],_=t[3],S=t[4],E=t[5],A=t[6],D=t[7],O=t[8],F=s[0],G=s[1],W=s[2],Q=s[3],ae=s[4],ce=s[5],we=s[6],ve=s[7],ee=s[8];return a[0]=F*u+G*_+W*A,a[1]=F*h+G*S+W*D,a[2]=F*m+G*E+W*O,a[3]=Q*u+ae*_+ce*A,a[4]=Q*h+ae*S+ce*D,a[5]=Q*m+ae*E+ce*O,a[6]=we*u+ve*_+ee*A,a[7]=we*h+ve*S+ee*D,a[8]=we*m+ve*E+ee*O,a}function X(){var a=new R(16);return R!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a}function Z(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function J(a,t){var s=t[0],u=t[1],h=t[2],m=t[3],_=t[4],S=t[5],E=t[6],A=t[7],D=t[8],O=t[9],F=t[10],G=t[11],W=t[12],Q=t[13],ae=t[14],ce=t[15],we=s*S-u*_,ve=s*E-h*_,ee=s*A-m*_,ge=u*E-h*S,be=u*A-m*S,Ie=h*A-m*E,Fe=D*Q-O*W,$e=D*ae-F*W,Ze=D*ce-G*W,et=O*ae-F*Q,St=O*ce-G*Q,jt=F*ce-G*ae,kt=we*jt-ve*St+ee*et+ge*Ze-be*$e+Ie*Fe;return kt?(a[0]=(S*jt-E*St+A*et)*(kt=1/kt),a[1]=(h*St-u*jt-m*et)*kt,a[2]=(Q*Ie-ae*be+ce*ge)*kt,a[3]=(F*be-O*Ie-G*ge)*kt,a[4]=(E*Ze-_*jt-A*$e)*kt,a[5]=(s*jt-h*Ze+m*$e)*kt,a[6]=(ae*ee-W*Ie-ce*ve)*kt,a[7]=(D*Ie-F*ee+G*ve)*kt,a[8]=(_*St-S*Ze+A*Fe)*kt,a[9]=(u*Ze-s*St-m*Fe)*kt,a[10]=(W*be-Q*ee+ce*we)*kt,a[11]=(O*ee-D*be-G*we)*kt,a[12]=(S*$e-_*et-E*Fe)*kt,a[13]=(s*et-u*$e+h*Fe)*kt,a[14]=(Q*ve-W*ge-ae*we)*kt,a[15]=(D*ge-O*ve+F*we)*kt,a):null}function le(a,t,s){var u=t[0],h=t[1],m=t[2],_=t[3],S=t[4],E=t[5],A=t[6],D=t[7],O=t[8],F=t[9],G=t[10],W=t[11],Q=t[12],ae=t[13],ce=t[14],we=t[15],ve=s[0],ee=s[1],ge=s[2],be=s[3];return a[0]=ve*u+ee*S+ge*O+be*Q,a[1]=ve*h+ee*E+ge*F+be*ae,a[2]=ve*m+ee*A+ge*G+be*ce,a[3]=ve*_+ee*D+ge*W+be*we,a[4]=(ve=s[4])*u+(ee=s[5])*S+(ge=s[6])*O+(be=s[7])*Q,a[5]=ve*h+ee*E+ge*F+be*ae,a[6]=ve*m+ee*A+ge*G+be*ce,a[7]=ve*_+ee*D+ge*W+be*we,a[8]=(ve=s[8])*u+(ee=s[9])*S+(ge=s[10])*O+(be=s[11])*Q,a[9]=ve*h+ee*E+ge*F+be*ae,a[10]=ve*m+ee*A+ge*G+be*ce,a[11]=ve*_+ee*D+ge*W+be*we,a[12]=(ve=s[12])*u+(ee=s[13])*S+(ge=s[14])*O+(be=s[15])*Q,a[13]=ve*h+ee*E+ge*F+be*ae,a[14]=ve*m+ee*A+ge*G+be*ce,a[15]=ve*_+ee*D+ge*W+be*we,a}function de(a,t,s){var u,h,m,_,S,E,A,D,O,F,G,W,Q=s[0],ae=s[1],ce=s[2];return t===a?(a[12]=t[0]*Q+t[4]*ae+t[8]*ce+t[12],a[13]=t[1]*Q+t[5]*ae+t[9]*ce+t[13],a[14]=t[2]*Q+t[6]*ae+t[10]*ce+t[14],a[15]=t[3]*Q+t[7]*ae+t[11]*ce+t[15]):(h=t[1],m=t[2],_=t[3],S=t[4],E=t[5],A=t[6],D=t[7],O=t[8],F=t[9],G=t[10],W=t[11],a[0]=u=t[0],a[1]=h,a[2]=m,a[3]=_,a[4]=S,a[5]=E,a[6]=A,a[7]=D,a[8]=O,a[9]=F,a[10]=G,a[11]=W,a[12]=u*Q+S*ae+O*ce+t[12],a[13]=h*Q+E*ae+F*ce+t[13],a[14]=m*Q+A*ae+G*ce+t[14],a[15]=_*Q+D*ae+W*ce+t[15]),a}function ue(a,t,s){var u=s[0],h=s[1],m=s[2];return a[0]=t[0]*u,a[1]=t[1]*u,a[2]=t[2]*u,a[3]=t[3]*u,a[4]=t[4]*h,a[5]=t[5]*h,a[6]=t[6]*h,a[7]=t[7]*h,a[8]=t[8]*m,a[9]=t[9]*m,a[10]=t[10]*m,a[11]=t[11]*m,a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15],a}function pe(a,t,s){var u=Math.sin(s),h=Math.cos(s),m=t[4],_=t[5],S=t[6],E=t[7],A=t[8],D=t[9],O=t[10],F=t[11];return t!==a&&(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a[4]=m*h+A*u,a[5]=_*h+D*u,a[6]=S*h+O*u,a[7]=E*h+F*u,a[8]=A*h-m*u,a[9]=D*h-_*u,a[10]=O*h-S*u,a[11]=F*h-E*u,a}function he(a,t,s){var u=Math.sin(s),h=Math.cos(s),m=t[0],_=t[1],S=t[2],E=t[3],A=t[8],D=t[9],O=t[10],F=t[11];return t!==a&&(a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a[0]=m*h-A*u,a[1]=_*h-D*u,a[2]=S*h-O*u,a[3]=E*h-F*u,a[8]=m*u+A*h,a[9]=_*u+D*h,a[10]=S*u+O*h,a[11]=E*u+F*h,a}function xe(a,t,s){var u=Math.sin(s),h=Math.cos(s),m=t[0],_=t[1],S=t[2],E=t[3],A=t[4],D=t[5],O=t[6],F=t[7];return t!==a&&(a[8]=t[8],a[9]=t[9],a[10]=t[10],a[11]=t[11],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a[0]=m*h+A*u,a[1]=_*h+D*u,a[2]=S*h+O*u,a[3]=E*h+F*u,a[4]=A*h-m*u,a[5]=D*h-_*u,a[6]=O*h-S*u,a[7]=F*h-E*u,a}function fe(a,t){return a[0]=t[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=t[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=t[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function _e(a,t,s){var u,h,m,_=s[0],S=s[1],E=s[2],A=Math.hypot(_,S,E);return A<I?null:(_*=A=1/A,S*=A,E*=A,u=Math.sin(t),h=Math.cos(t),a[0]=_*_*(m=1-h)+h,a[1]=S*_*m+E*u,a[2]=E*_*m-S*u,a[3]=0,a[4]=_*S*m-E*u,a[5]=S*S*m+h,a[6]=E*S*m+_*u,a[7]=0,a[8]=_*E*m+S*u,a[9]=S*E*m-_*u,a[10]=E*E*m+h,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a)}function Ce(a,t){var s=t[0],u=t[1],h=t[2],m=t[3],_=s+s,S=u+u,E=h+h,A=s*_,D=u*_,O=u*S,F=h*_,G=h*S,W=h*E,Q=m*_,ae=m*S,ce=m*E;return a[0]=1-O-W,a[1]=D+ce,a[2]=F-ae,a[3]=0,a[4]=D-ce,a[5]=1-A-W,a[6]=G+Q,a[7]=0,a[8]=F+ae,a[9]=G-Q,a[10]=1-A-O,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}Math.hypot||(Math.hypot=function(){for(var a=0,t=arguments.length;t--;)a+=arguments[t]*arguments[t];return Math.sqrt(a)});var je=le;function He(){var a=new R(3);return R!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function lt(a){var t=new R(3);return t[0]=a[0],t[1]=a[1],t[2]=a[2],t}function _t(a){return Math.hypot(a[0],a[1],a[2])}function Ue(a,t,s){var u=new R(3);return u[0]=a,u[1]=t,u[2]=s,u}function Ge(a,t,s){return a[0]=t[0]+s[0],a[1]=t[1]+s[1],a[2]=t[2]+s[2],a}function at(a,t,s){return a[0]=t[0]-s[0],a[1]=t[1]-s[1],a[2]=t[2]-s[2],a}function yt(a,t,s){return a[0]=t[0]*s[0],a[1]=t[1]*s[1],a[2]=t[2]*s[2],a}function tt(a,t,s){return a[0]=Math.min(t[0],s[0]),a[1]=Math.min(t[1],s[1]),a[2]=Math.min(t[2],s[2]),a}function Rt(a,t,s){return a[0]=Math.max(t[0],s[0]),a[1]=Math.max(t[1],s[1]),a[2]=Math.max(t[2],s[2]),a}function ct(a,t,s){return a[0]=t[0]*s,a[1]=t[1]*s,a[2]=t[2]*s,a}function ze(a,t,s,u){return a[0]=t[0]+s[0]*u,a[1]=t[1]+s[1]*u,a[2]=t[2]+s[2]*u,a}function Ye(a,t){var s=t[0]-a[0],u=t[1]-a[1],h=t[2]-a[2];return s*s+u*u+h*h}function At(a){var t=a[0],s=a[1],u=a[2];return t*t+s*s+u*u}function Ct(a,t){return a[0]=-t[0],a[1]=-t[1],a[2]=-t[2],a}function We(a,t){var s=t[0],u=t[1],h=t[2],m=s*s+u*u+h*h;return m>0&&(m=1/Math.sqrt(m)),a[0]=t[0]*m,a[1]=t[1]*m,a[2]=t[2]*m,a}function st(a,t){return a[0]*t[0]+a[1]*t[1]+a[2]*t[2]}function Bt(a,t,s){var u=t[0],h=t[1],m=t[2],_=s[0],S=s[1],E=s[2];return a[0]=h*E-m*S,a[1]=m*_-u*E,a[2]=u*S-h*_,a}function hn(a,t,s,u){var h=t[0],m=t[1],_=t[2];return a[0]=h+u*(s[0]-h),a[1]=m+u*(s[1]-m),a[2]=_+u*(s[2]-_),a}function cn(a,t,s){var u=t[0],h=t[1],m=t[2],_=s[3]*u+s[7]*h+s[11]*m+s[15];return a[0]=(s[0]*u+s[4]*h+s[8]*m+s[12])/(_=_||1),a[1]=(s[1]*u+s[5]*h+s[9]*m+s[13])/_,a[2]=(s[2]*u+s[6]*h+s[10]*m+s[14])/_,a}function cr(a,t,s){var u=t[0],h=t[1],m=t[2];return a[0]=u*s[0]+h*s[3]+m*s[6],a[1]=u*s[1]+h*s[4]+m*s[7],a[2]=u*s[2]+h*s[5]+m*s[8],a}function Nn(a,t,s){var u=s[0],h=s[1],m=s[2],_=t[0],S=t[1],E=t[2],A=h*E-m*S,D=m*_-u*E,O=u*S-h*_,F=h*O-m*D,G=m*A-u*O,W=u*D-h*A,Q=2*s[3];return D*=Q,O*=Q,G*=2,W*=2,a[0]=_+(A*=Q)+(F*=2),a[1]=S+D+G,a[2]=E+O+W,a}function Vn(a,t){return a[0]===t[0]&&a[1]===t[1]&&a[2]===t[2]}var An=at,Zt=yt,mn=_t;function kr(){var a=new R(4);return R!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0,a[3]=0),a}function Gr(a,t,s){return a[0]=t[0]*s,a[1]=t[1]*s,a[2]=t[2]*s,a[3]=t[3]*s,a}function Yr(a,t){var s=t[0],u=t[1],h=t[2],m=t[3],_=s*s+u*u+h*h+m*m;return _>0&&(_=1/Math.sqrt(_)),a[0]=s*_,a[1]=u*_,a[2]=h*_,a[3]=m*_,a}function Xn(a,t,s){var u=t[0],h=t[1],m=t[2],_=t[3];return a[0]=s[0]*u+s[4]*h+s[8]*m+s[12]*_,a[1]=s[1]*u+s[5]*h+s[9]*m+s[13]*_,a[2]=s[2]*u+s[6]*h+s[10]*m+s[14]*_,a[3]=s[3]*u+s[7]*h+s[11]*m+s[15]*_,a}function Lr(){var a=new R(4);return R!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function Or(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a}function is(a,t,s){s*=.5;var u=t[0],h=t[1],m=t[2],_=t[3],S=Math.sin(s),E=Math.cos(s);return a[0]=u*E+_*S,a[1]=h*E+m*S,a[2]=m*E-h*S,a[3]=_*E-u*S,a}function Zi(a,t,s){s*=.5;var u=t[0],h=t[1],m=t[2],_=t[3],S=Math.sin(s),E=Math.cos(s);return a[0]=u*E-m*S,a[1]=h*E+_*S,a[2]=m*E+u*S,a[3]=_*E-h*S,a}He(),kr();var Dr,Bi,Fr,Xi,ei,ur=Yr,us=(Dr=He(),Bi=Ue(1,0,0),Fr=Ue(0,1,0),function(a,t,s){var u=st(t,s);return u<-.999999?(Bt(Dr,Bi,t),mn(Dr)<1e-6&&Bt(Dr,Fr,t),We(Dr,Dr),function(h,m,_){_*=.5;var S=Math.sin(_);h[0]=S*m[0],h[1]=S*m[1],h[2]=S*m[2],h[3]=Math.cos(_)}(a,Dr,Math.PI),a):u>.999999?(a[0]=0,a[1]=0,a[2]=0,a[3]=1,a):(Bt(Dr,t,s),a[0]=Dr[0],a[1]=Dr[1],a[2]=Dr[2],a[3]=1+u,ur(a,a))});function ss(){var a=new R(2);return R!=Float32Array&&(a[0]=0,a[1]=0),a}function Sr(a,t){var s=new R(2);return s[0]=a,s[1]=t,s}function On(a,t,s){return a[0]=t[0]+s[0],a[1]=t[1]+s[1],a}function Zr(a,t,s){return a[0]=t[0]-s[0],a[1]=t[1]-s[1],a}function Ki(a,t,s){return a[0]=t[0]*s,a[1]=t[1]*s,a}function ho(a){return Math.hypot(a[0],a[1])}function gl(a,t){var s=t[0],u=t[1],h=s*s+u*u;return h>0&&(h=1/Math.sqrt(h)),a[0]=t[0]*h,a[1]=t[1]*h,a}function Ei(a,t){return a[0]*t[0]+a[1]*t[1]}function Sa(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}Lr(),Lr(),N(),ss();var Nc,xo,_l=function(){if(ei)return Xi;function a(t,s,u,h){this.cx=3*t,this.bx=3*(u-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(h-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=s,this.p2x=u,this.p2y=h}return ei=1,Xi=a,a.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,s){if(s===void 0&&(s=1e-6),t<0)return 0;if(t>1)return 1;for(var u=t,h=0;h<8;h++){var m=this.sampleCurveX(u)-t;if(Math.abs(m)<s)return u;var _=this.sampleCurveDerivativeX(u);if(Math.abs(_)<1e-6)break;u-=m/_}var S=0,E=1;for(u=t,h=0;h<20&&(m=this.sampleCurveX(u),!(Math.abs(m-t)<s));h++)t>m?S=u:E=u,u=.5*(E-S)+S;return u},solve:function(t,s){return this.sampleCurveY(this.solveCurveX(t,s))}},Xi}(),Ph=Sa(_l);function _d(){if(xo)return Nc;function a(t,s){this.x=t,this.y=s}return xo=1,Nc=a,a.prototype={clone:function(){return new a(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,s){return this.clone()._rotateAround(t,s)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var s=t.x-this.x,u=t.y-this.y;return s*s+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,s){return Math.atan2(this.x*s-this.y*t,this.x*t+this.y*s)},_matMult:function(t){var s=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=s,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var s=Math.cos(t),u=Math.sin(t),h=u*this.x+s*this.y;return this.x=s*this.x-u*this.y,this.y=h,this},_rotateAround:function(t,s){var u=Math.cos(t),h=Math.sin(t),m=s.y+h*(this.x-s.x)+u*(this.y-s.y);return this.x=s.x+u*(this.x-s.x)-h*(this.y-s.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},a.convert=function(t){return t instanceof a?t:Array.isArray(t)?new a(t[0],t[1]):t},Nc}var Qt=Sa(_d());function yl(a,t){if(Array.isArray(a)){if(!Array.isArray(t)||a.length!==t.length)return!1;for(let s=0;s<a.length;s++)if(!yl(a[s],t[s]))return!1;return!0}if(typeof a=="object"&&a!==null&&t!==null){if(typeof t!="object"||Object.keys(a).length!==Object.keys(t).length)return!1;for(const s in a)if(!yl(a[s],t[s]))return!1;return!0}return a===t}const Ah=Math.PI/180,wt=180/Math.PI;function ie(a){return a*Ah}function me(a){return a*wt}const Le=[[0,0],[1,0],[1,1],[0,1]];function Be(a){if(a<=0)return 0;if(a>=1)return 1;const t=a*a,s=t*a;return 4*(a<.5?s:3*(a-t)+s-.75)}function Ve(a,t,s,u){const h=new Ph(a,t,s,u);return function(m){return h.solve(m)}}const qe=Ve(.25,.1,.25,1);function Xe(a,t,s){return Math.min(s,Math.max(t,a))}function Ke(a,t,s){return(s=Xe((s-a)/(t-a),0,1))*s*(3-2*s)}function pt(a,t,s){const u=s-t,h=((a-t)%u+u)%u+t;return h===t?s:h}function Lt(a,t,s){if(!a.length)return s(null,[]);let u=a.length;const h=new Array(a.length);let m=null;a.forEach((_,S)=>{t(_,(E,A)=>{E&&(m=E),h[S]=A,--u==0&&s(m,h)})})}function ft(a,...t){for(const s of t)for(const u in s)a[u]=s[u];return a}let tn=1;function ln(){return tn++}function xn(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))}function Zn(a,t){a.forEach(s=>{t[s]&&(t[s]=t[s].bind(t))})}function Yn(a,t,s){const u={};for(const h in a)u[h]=t.call(this,a[h],h,a);return u}function rr(a,t,s){const u={};for(const h in a)t.call(this,a[h],h,a)&&(u[h]=a[h]);return u}function pr(a){return Array.isArray(a)?a.map(pr):typeof a=="object"&&a?Yn(a,pr):a}const Vi={};function gr(a){Vi[a]||(typeof console<"u"&&console.warn(a),Vi[a]=!0)}function gi(a,t,s){return(s.y-a.y)*(t.x-a.x)>(t.y-a.y)*(s.x-a.x)}function Hr(a){let t=0;for(let s,u,h=0,m=a.length,_=m-1;h<m;_=h++)s=a[h],u=a[_],t+=(u.x-s.x)*(s.y+u.y);return t}function vr([a,t,s]){const u=ie(t+90),h=ie(s);return{x:a*Math.cos(u)*Math.sin(h),y:a*Math.sin(u)*Math.sin(h),z:a*Math.cos(h),azimuthal:t,polar:s}}function xi(a){return(typeof self<"u"||a!==void 0)&&typeof WorkerGlobalScope<"u"&&(a!==void 0?a:self)instanceof WorkerGlobalScope}function Qi(a){const t={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,u,h,m)=>{const _=h||m;return t[u]=!_||_.toLowerCase(),""}),t["max-age"]){const s=parseInt(t["max-age"],10);isNaN(s)?delete t["max-age"]:t["max-age"]=s}return t}let bs=null;function Es(a,t){return[a[4*t],a[4*t+1],a[4*t+2],a[4*t+3]]}function eo(a,t,s,u){for(;t<s;){const h=t+s>>1;a[h]<u?t=h+1:s=h}return t}function vl(a,t,s,u){for(;t<s;){const h=t+s>>1;a[h]<=u?t=h+1:s=h}return t}function $s(a){return a>0?1/(1.001-a):1+a}function ms(a){return a>0?1-1/(1.001-a):-a}function Hs(a,t,s){return(a-t.min)*(s.max-s.min)/(t.max-t.min)+s.min}const os={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!os.API_URL)return null;try{const a=new URL(os.API_URL);return a.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":a.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function xl(a){return os.API_URL_REGEX.test(a)}function Eu(a){return os.API_SPRITE_REGEX.test(a)}let Rh,rc,Iu,ic,bl,Mh;function tm(){return Rh==null&&(Rh=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Rh}const sa={now:()=>ic!==void 0?ic:performance.now(),setNow(a){ic=a},restoreNow(){ic=void 0},frame(a){const t=requestAnimationFrame(a);return{cancel:()=>cancelAnimationFrame(t)}},getImageData(a,t=0){const{width:s,height:u}=a;bl||(bl=document.createElement("canvas"));const h=bl.getContext("2d",{willReadFrequently:!0});if(!h)throw new Error("failed to create canvas 2d context");return(s>bl.width||u>bl.height)&&(bl.width=s,bl.height=u),h.clearRect(-t,-t,s+2*t,u+2*t),h.drawImage(a,0,0,s,u),h.getImageData(-t,-t,s+2*t,u+2*t)},resolveURL:a=>(rc||(rc=document.createElement("a")),rc.href=a,rc.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Iu==null&&(Iu=window.matchMedia("(prefers-reduced-motion: reduce)")),Iu.matches)},hasCanvasFingerprintNoise(){if(Mh!==void 0)return Mh;if(!tm())return Mh=!1,!1;const a=new OffscreenCanvas(85,1),t=a.getContext("2d",{willReadFrequently:!0});let s=0;for(let h=0;h<a.width;++h)t.fillStyle=`rgba(${s++},${s++},${s++}, 255)`,t.fillRect(h,0,1,1);const u=t.getImageData(0,0,a.width,a.height);s=0;for(let h=0;h<u.data.length;++h)if(h%4!=3&&s++!==u.data[h])return Mh=!0,!0;return Mh=!1,!1}};function Of(a,t){const s=a.indexOf("?");if(s<0)return`${a}?${new URLSearchParams(t).toString()}`;const u=new URLSearchParams(a.slice(s));for(const h in t)u.set(h,t[h]);return`${a.slice(0,s)}?${u.toString()}`}function Do(a,t={persistentParams:[]}){const s=a.indexOf("?");if(s<0)return a;const u=new URLSearchParams,h=new URLSearchParams(a.slice(s));for(const _ of t.persistentParams){const S=h.get(_);S&&u.set(_,S)}const m=u.toString();return`${a.slice(0,s)}${m.length>0?`?${m}`:""}`}const Ho="mapbox-tiles";let sc=500,oa=50;const wi=["language","worldview","jobid"];let aa,yd;function Lh(){try{return caches}catch{}}function wl(){const a=Lh();a&&aa==null&&(aa=a.open(Ho))}let vd=1/0;const zf={supported:!1,testSupport:function(a){!Ka&&to&&(Ya?xd(a):Pu=a)}};let Pu,to,Ka=!1,Ya=!1;const la=typeof self<"u"?self:{};function xd(a){const t=a.createTexture();a.bindTexture(a.TEXTURE_2D,t);try{if(a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,to),a.isContextLost())return;zf.supported=!0}catch{}a.deleteTexture(t),Ka=!0}la.document&&(to=la.document.createElement("img"),to.onload=function(){Pu&&xd(Pu),Pu=null,Ya=!0},to.onerror=function(){Ka=!0,Pu=null},to.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const jc={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(jc);class Ja extends Error{constructor(t,s,u){s===401&&xl(u)&&(t+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(t),this.status=s,this.url=u}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Br=xi()?()=>self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,Au=function(a,t){if(!(/^file:/.test(s=a.url)||/^file:/.test(Br())&&!/^\w+:/.test(s))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(u,h){const m=new AbortController,_=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,referrer:Br(),referrerPolicy:u.referrerPolicy,signal:m.signal});let S=!1,E=!1;const A=(D=_.url).indexOf("sku=")>0&&xl(D);var D;u.type==="json"&&_.headers.set("Accept","application/json");const O=(G,W,Q)=>{if(E)return;if(G&&G.message!=="SecurityError"&&gr(G.toString()),W&&Q)return F(W);const ae=Date.now();fetch(_).then(ce=>{if(ce.ok){const we=A?ce.clone():null;return F(ce,we,ae)}return h(new Ja(ce.statusText,ce.status,u.url))}).catch(ce=>{ce.name!=="AbortError"&&h(new Error(`${ce.message} ${u.url}`))})},F=(G,W,Q)=>{(u.type==="arrayBuffer"?G.arrayBuffer():u.type==="json"?G.json():G.text()).then(ae=>{E||(W&&Q&&function(ce,we,ve){if(wl(),aa==null)return;const ee=Qi(we.headers.get("Cache-Control")||"");if(ee["no-store"])return;const ge={status:we.status,statusText:we.statusText,headers:new Headers};we.headers.forEach((Fe,$e)=>ge.headers.set($e,Fe)),ee["max-age"]&&ge.headers.set("Expires",new Date(ve+1e3*ee["max-age"]).toUTCString());const be=ge.headers.get("Expires");if(!be||new Date(be).getTime()-ve<42e4)return;let Ie=Do(ce.url,{persistentParams:wi});if(we.status===206){const Fe=ce.headers.get("Range");if(!Fe)return;ge.status=200,Ie=Of(Ie,{range:Fe})}(function(Fe,$e){if(yd===void 0)try{new Response(new ReadableStream),yd=!0}catch{yd=!1}yd?$e(Fe.body):Fe.blob().then($e).catch(Ze=>gr(Ze.message))})(we,Fe=>{const $e=new Response((Ze=we.status)!==200&&Ze!==404&&[101,103,204,205,304].includes(Ze)?null:Fe,ge);var Ze;wl(),aa!=null&&aa.then(et=>et.put(Ie,$e)).catch(et=>gr(et.message))})}(_,W,Q),S=!0,h(null,ae,G.headers.get("Cache-Control"),G.headers.get("Expires")))}).catch(ae=>{E||h(new Error(ae.message))})};return A?function(G,W){if(wl(),aa==null)return W(null);aa.then(Q=>{let ae=Do(G.url,{persistentParams:wi});const ce=G.headers.get("Range");ce&&(ae=Of(ae,{range:ce})),Q.match(ae).then(we=>{const ve=function(ee){if(!ee)return!1;const ge=new Date(ee.headers.get("Expires")||0),be=Qi(ee.headers.get("Cache-Control")||"");return Number(ge)>Date.now()&&!be["no-cache"]}(we);Q.delete(ae).catch(W),ve&&Q.put(ae,we.clone()).catch(W),W(null,we,ve)}).catch(W)}).catch(W)}(_,O):O(null,null),{cancel:()=>{E=!0,S||m.abort()}}}(a,t);if(xi(self)&&self.worker.actor)return self.worker.actor.send("getResource",a,t,void 0,!0)}var s;return function(u,h){const m=new XMLHttpRequest;m.open(u.method||"GET",u.url,!0),u.type==="arrayBuffer"&&(m.responseType="arraybuffer");for(const _ in u.headers)m.setRequestHeader(_,u.headers[_]);return u.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=u.credentials==="include",m.onerror=()=>{h(new Error(m.statusText))},m.onload=()=>{if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){let _=m.response;if(u.type==="json")try{_=JSON.parse(m.response)}catch(S){return h(S)}h(null,_,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else h(new Ja(m.statusText,m.status,u.url))},m.send(u.body),{cancel:()=>m.abort()}}(a,t)},Sl=function(a,t){return Au(ft(a,{type:"arrayBuffer"}),t)};function K_(a){const t=document.createElement("a");return t.href=a,t.protocol===location.protocol&&t.host===location.host}const nm="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Cl,oc;Cl=[],oc=0;const bd=function(a,t){if(zf.supported&&(a.headers||(a.headers={}),a.headers.accept="image/webp,*/*"),oc>=os.MAX_PARALLEL_IMAGE_REQUESTS){const m={requestParameters:a,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return Cl.push(m),m}oc++;let s=!1;const u=()=>{if(!s)for(s=!0,oc--;Cl.length&&oc<os.MAX_PARALLEL_IMAGE_REQUESTS;){const m=Cl.shift(),{requestParameters:_,callback:S,cancelled:E}=m;E||(m.cancel=bd(_,S).cancel)}},h=Sl(a,(m,_,S,E)=>{u(),m?t(m):_&&(self.createImageBitmap?function(A,D){const O=new Blob([new Uint8Array(A)],{type:"image/png"});createImageBitmap(O).then(F=>{D(null,F)}).catch(F=>{D(new Error(`Could not load image because of ${F.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(_,(A,D)=>t(A,D,S,E)):function(A,D){const O=new Image;O.onload=()=>{D(null,O),URL.revokeObjectURL(O.src),O.onload=null,requestAnimationFrame(()=>{O.src=nm})},O.onerror=()=>D(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const F=new Blob([new Uint8Array(A)],{type:"image/png"});O.src=A.byteLength?URL.createObjectURL(F):nm}(_,(A,D)=>t(A,D,S,E)))});return{cancel:()=>{h.cancel(),u()}}};var wd,Ru,Ca,Bc={exports:{}},Sd={exports:{}},Ff={exports:{}},Dh=function(){if(Ca)return Bc.exports;Ca=1;var a=(wd||(wd=1,Sd.exports=function(s,u){var h,m,_,S,E,A,D,O;for(m=s.length-(h=3&s.length),_=u,E=3432918353,A=461845907,O=0;O<m;)D=255&s.charCodeAt(O)|(255&s.charCodeAt(++O))<<8|(255&s.charCodeAt(++O))<<16|(255&s.charCodeAt(++O))<<24,++O,_=27492+(65535&(S=5*(65535&(_=(_^=D=(65535&(D=(D=(65535&D)*E+(((D>>>16)*E&65535)<<16)&4294967295)<<15|D>>>17))*A+(((D>>>16)*A&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(S>>>16)&65535)<<16);switch(D=0,h){case 3:D^=(255&s.charCodeAt(O+2))<<16;case 2:D^=(255&s.charCodeAt(O+1))<<8;case 1:_^=D=(65535&(D=(D=(65535&(D^=255&s.charCodeAt(O)))*E+(((D>>>16)*E&65535)<<16)&4294967295)<<15|D>>>17))*A+(((D>>>16)*A&65535)<<16)&4294967295}return _^=s.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0}),Sd.exports),t=(Ru||(Ru=1,Ff.exports=function(s,u){for(var h,m=s.length,_=u^m,S=0;m>=4;)h=1540483477*(65535&(h=255&s.charCodeAt(S)|(255&s.charCodeAt(++S))<<8|(255&s.charCodeAt(++S))<<16|(255&s.charCodeAt(++S))<<24))+((1540483477*(h>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),m-=4,++S;switch(m){case 3:_^=(255&s.charCodeAt(S+2))<<16;case 2:_^=(255&s.charCodeAt(S+1))<<8;case 1:_=1540483477*(65535&(_^=255&s.charCodeAt(S)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0}),Ff.exports);return Bc.exports=a,Bc.exports.murmur3=a,Bc.exports.murmur2=t,Bc.exports}(),bo=Sa(Dh);class Tl{constructor(t,...s){ft(this,s[0]||{}),this.type=t}}class Nf extends Tl{constructor(t,s={}){super("error",ft({error:t},s))}}function El(a,t,s){s[a]&&s[a].indexOf(t)!==-1||(s[a]=s[a]||[],s[a].push(t))}function Cd(a,t,s){if(s&&s[a]){const u=s[a].indexOf(t);u!==-1&&s[a].splice(u,1)}}class Il{on(t,s){return this._listeners=this._listeners||{},El(t,s,this._listeners),this}off(t,s){return Cd(t,s,this._listeners),Cd(t,s,this._oneTimeListeners),this}once(t,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},El(t,s,this._oneTimeListeners),this):new Promise(u=>{this.once(t,u)})}fire(t,s){const u=typeof t=="string"?new Tl(t,s):t,h=u.type;if(this.listens(h)){u.target=this;const m=this._listeners&&this._listeners[h]?this._listeners[h].slice():[];for(const E of m)E.call(this,u);const _=this._oneTimeListeners&&this._oneTimeListeners[h]?this._oneTimeListeners[h].slice():[];for(const E of _)Cd(h,E,this._oneTimeListeners),E.call(this,u);const S=this._eventedParent;S&&(ft(u,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),S.fire(u))}else u instanceof Nf&&console.error(u.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,s){return this._eventedParent=t,this._eventedParentData=s,this}}class Go{constructor(t){typeof t=="string"?this.name=t:(this.name=t.name,this.iconsetId=t.iconsetId)}static from(t){return new Go(t)}static toString(t){return t.iconsetId?`${t.name}${t.iconsetId}`:t.name}static parse(t){const[s,u]=t.split("");return new Go({name:s,iconsetId:u})}static isEqual(t,s){return t.name===s.name&&t.iconsetId===s.iconsetId}toString(){return Go.toString(this)}serialize(){return{name:this.name,iconsetId:this.iconsetId}}}var Td,Mu={},Ed=function(){if(Td)return Mu;Td=1;var a={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function t(m){return(m=Math.round(m))<0?0:m>255?255:m}function s(m){return t(m[m.length-1]==="%"?parseFloat(m)/100*255:parseInt(m))}function u(m){return(_=m[m.length-1]==="%"?parseFloat(m)/100:parseFloat(m))<0?0:_>1?1:_;var _}function h(m,_,S){return S<0?S+=1:S>1&&(S-=1),6*S<1?m+(_-m)*S*6:2*S<1?_:3*S<2?m+(_-m)*(2/3-S)*6:m}try{Mu.parseCSSColor=function(m){var _,S=m.replace(/ /g,"").toLowerCase();if(S in a)return a[S].slice();if(S[0]==="#")return S.length===4?(_=parseInt(S.substr(1),16))>=0&&_<=4095?[(3840&_)>>4|(3840&_)>>8,240&_|(240&_)>>4,15&_|(15&_)<<4,1]:null:S.length===7&&(_=parseInt(S.substr(1),16))>=0&&_<=16777215?[(16711680&_)>>16,(65280&_)>>8,255&_,1]:null;var E=S.indexOf("("),A=S.indexOf(")");if(E!==-1&&A+1===S.length){var D=S.substr(0,E),O=S.substr(E+1,A-(E+1)).split(","),F=1;switch(D){case"rgba":if(O.length!==4)return null;F=u(O.pop());case"rgb":return O.length!==3?null:[s(O[0]),s(O[1]),s(O[2]),F];case"hsla":if(O.length!==4)return null;F=u(O.pop());case"hsl":if(O.length!==3)return null;var G=(parseFloat(O[0])%360+360)%360/360,W=u(O[1]),Q=u(O[2]),ae=Q<=.5?Q*(W+1):Q+W-Q*W,ce=2*Q-ae;return[t(255*h(ce,ae,G+1/3)),t(255*h(ce,ae,G)),t(255*h(ce,ae,G-1/3)),F];default:return null}}return null}}catch{}return Mu}();class xr{constructor(t,s,u,h=1){this.r=t,this.g=s,this.b=u,this.a=h}static parse(t){if(!t)return;if(t instanceof xr)return t;if(typeof t!="string")return;const s=Ed.parseCSSColor(t);return s?new xr(s[0]/255*s[3],s[1]/255*s[3],s[2]/255*s[3],s[3]):void 0}toStringPremultipliedAlpha(){const[t,s,u,h]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(t)},${Math.round(s)},${Math.round(u)},${h})`}toString(){const[t,s,u,h]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*t)},${Math.round(255*s)},${Math.round(255*u)},${h})`}toRenderColor(t){const{r:s,g:u,b:h,a:m}=this;return new Lu(t,s,u,h,m)}clone(){return new xr(this.r,this.g,this.b,this.a)}}class Lu{constructor(t,s,u,h,m){if(t){const _=t.image.height,S=_*_;s=m===0?0:s/m*(_-1),u=m===0?0:u/m*(_-1),h=m===0?0:h/m*(_-1);const E=Math.floor(s),A=Math.floor(u),D=Math.floor(h),O=Math.ceil(s),F=Math.ceil(u),G=Math.ceil(h),W=s-E,Q=u-A,ae=h-D,ce=t.image.data,we=4*(E+A*S+D*_),ve=4*(E+A*S+G*_),ee=4*(E+F*S+D*_),ge=4*(E+F*S+G*_),be=4*(O+A*S+D*_),Ie=4*(O+A*S+G*_),Fe=4*(O+F*S+D*_),$e=4*(O+F*S+G*_);if(we<0||$e>=ce.length)throw new Error("out of range");this.r=kn(kn(kn(ce[we],ce[ve],ae),kn(ce[ee],ce[ge],ae),Q),kn(kn(ce[be],ce[Ie],ae),kn(ce[Fe],ce[$e],ae),Q),W)/255*m,this.g=kn(kn(kn(ce[we+1],ce[ve+1],ae),kn(ce[ee+1],ce[ge+1],ae),Q),kn(kn(ce[be+1],ce[Ie+1],ae),kn(ce[Fe+1],ce[$e+1],ae),Q),W)/255*m,this.b=kn(kn(kn(ce[we+2],ce[ve+2],ae),kn(ce[ee+2],ce[ge+2],ae),Q),kn(kn(ce[be+2],ce[Ie+2],ae),kn(ce[Fe+2],ce[$e+2],ae),Q),W)/255*m,this.a=m}else this.r=s,this.g=u,this.b=h,this.a=m}toArray(){const{r:t,g:s,b:u,a:h}=this;return h===0?[0,0,0,0]:[255*t/h,255*s/h,255*u/h,h]}toHslaArray(){if(this.a===0)return[0,0,0,0];const{r:t,g:s,b:u,a:h}=this,m=Math.min(Math.max(t/h,0),1),_=Math.min(Math.max(s/h,0),1),S=Math.min(Math.max(u/h,0),1),E=Math.min(m,_,S),A=Math.max(m,_,S),D=(E+A)/2;if(E===A)return[0,0,100*D,h];const O=A-E,F=D>.5?O/(2-A-E):O/(A+E);let G=0;return A===m?G=(_-S)/O+(_<S?6:0):A===_?G=(S-m)/O+2:A===S&&(G=(m-_)/O+4),G*=60,[Math.min(Math.max(G,0),360),Math.min(Math.max(100*F,0),100),Math.min(Math.max(100*D,0),100),h]}toArray01(){const{r:t,g:s,b:u,a:h}=this;return h===0?[0,0,0,0]:[t/h,s/h,u/h,h]}toArray01Scaled(t){const{r:s,g:u,b:h,a:m}=this;return m===0?[0,0,0]:[s/m*t,u/m*t,h/m*t]}toArray01PremultipliedAlpha(){const{r:t,g:s,b:u,a:h}=this;return[t,s,u,h]}toArray01Linear(){const{r:t,g:s,b:u,a:h}=this;return h===0?[0,0,0,0]:[Math.pow(t/h,2.2),Math.pow(s/h,2.2),Math.pow(u/h,2.2),h]}}function kn(a,t,s){return a*(1-s)+t*s}function Id(a,t,s){return a.map((u,h)=>kn(u,t[h],s))}function jf(a){return a*a*a*a*a}xr.black=new xr(0,0,0,1),xr.white=new xr(1,1,1,1),xr.transparent=new xr(0,0,0,0),xr.red=new xr(1,0,0,1),xr.blue=new xr(0,0,1,1);var Pd=Object.freeze({__proto__:null,array:Id,color:function(a,t,s){return new xr(kn(a.r,t.r,s),kn(a.g,t.g,s),kn(a.b,t.b,s),kn(a.a,t.a,s))},easeIn:jf,number:kn});function Du(a,...t){for(const s of t)for(const u in s)a[u]=s[u];return a}class ko extends Error{constructor(t,s){super(s),this.message=s,this.key=t}}class Pl{constructor(t,s=[]){this.parent=t,this.bindings={};for(const[u,h]of s)this.bindings[u]=h}concat(t){return new Pl(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const ac={kind:"null"},Pn={kind:"number"},ui={kind:"string"},ti={kind:"boolean"},wo={kind:"color"},Vc={kind:"object"},Jr={kind:"value"},ku={kind:"collator"},kh={kind:"formatted"},Oh={kind:"resolvedImage"};function So(a,t){return{kind:"array",itemType:a,N:t}}function Is(a){if(a.kind==="array"){const t=Is(a.itemType);return typeof a.N=="number"?`array<${t}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${t}>`}return a.kind}const Y_=[ac,Pn,ui,ti,wo,kh,Vc,So(Jr),Oh];function zh(a,t){if(t.kind==="error")return null;if(a.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!zh(a.itemType,t.itemType))&&(typeof a.N!="number"||a.N===t.N))return null}else{if(a.kind===t.kind)return null;if(a.kind==="value"){for(const s of Y_)if(!zh(s,t))return null}}return`Expected ${Is(a)} but found ${Is(t)} instead.`}function rm(a,t){return t.some(s=>s.kind===a.kind)}function Uc(a,t){return t.some(s=>s==="null"?a===null:s==="array"?Array.isArray(a):s==="object"?a&&!Array.isArray(a)&&typeof a=="object":s===typeof a)}class $c{constructor(t,s,u){this.sensitivity=t?s?"variant":"case":s?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,s){return this.collator.compare(t,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Bf{constructor(t,s,u,h,m){this.text=t.normalize?t.normalize():t,this.image=s,this.scale=u,this.fontStack=h,this.textColor=m}}class Oo{constructor(t){this.sections=t}static fromString(t){return new Oo([new Bf(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||!!t.image&&t.image.hasPrimary())}static factory(t){return t instanceof Oo?t:Oo.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const s of this.sections){if(s.image){const h=s.image.getPrimary().id.toString();t.push(["image",h]);continue}t.push(s.text);const u={};s.fontStack&&(u["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(u["font-scale"]=s.scale),s.textColor&&(u["text-color"]=["rgba"].concat(s.textColor.toRenderColor(null).toArray())),t.push(u)}return t}}class Ta{constructor(t,s={}){if(this.id=Go.from(t),this.options=Object.assign({},s),s.transform){const{a:u,b:h,c:m,d:_,e:S,f:E}=s.transform;this.options.transform=new DOMMatrix([u,h,m,_,S,E])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}toString(){const{a:t,b:s,c:u,d:h,e:m,f:_}=this.options.transform;return JSON.stringify({name:this.id.name,iconsetId:this.id.iconsetId,params:this.options.params,transform:{a:t,b:s,c:u,d:h,e:m,f:_}})}static parse(t){let s,u,h,m;try{({name:s,iconsetId:u,params:h,transform:m}=JSON.parse(t)||{})}catch{return null}if(!s)return null;const{a:_,b:S,c:E,d:A,e:D,f:O}=m||{};return new Ta({name:s,iconsetId:u},{params:h,transform:new DOMMatrix([_,S,E,A,D,O])})}scaleSelf(t,s){return this.options.transform.scaleSelf(t,s),this}}class Wo{constructor(t,s,u,h,m=!1){this.primaryId=Go.from(t),this.primaryOptions=s,u&&(this.secondaryId=Go.from(u)),this.secondaryOptions=h,this.available=m}toString(){return this.primaryId&&this.secondaryId?`[${this.primaryId.name},${this.secondaryId.name}]`:this.primaryId.name}hasPrimary(){return!!this.primaryId}getPrimary(){return new Ta(this.primaryId,this.primaryOptions)}hasSecondary(){return!!this.secondaryId}getSecondary(){return this.secondaryId?new Ta(this.secondaryId,this.secondaryOptions):null}static from(t){return typeof t=="string"?Wo.build({name:t}):t}static build(t,s,u,h){return!t||typeof t=="object"&&!("name"in t)?null:new Wo(t,u,s,h)}}function xg(a,t,s,u){return typeof a=="number"&&a>=0&&a<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof s=="number"&&s>=0&&s<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[a,t,s,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[a,t,s,u]:[a,t,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ad(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof xr||a instanceof $c||a instanceof Oo||a instanceof Wo)return!0;if(Array.isArray(a)){for(const t of a)if(!Ad(t))return!1;return!0}if(typeof a=="object"){for(const t in a)if(!Ad(a[t]))return!1;return!0}return!1}function ks(a){if(a===null)return ac;if(typeof a=="string")return ui;if(typeof a=="boolean")return ti;if(typeof a=="number")return Pn;if(a instanceof xr)return wo;if(a instanceof $c)return ku;if(a instanceof Oo)return kh;if(a instanceof Wo)return Oh;if(Array.isArray(a)){const t=a.length;let s;for(const u of a){const h=ks(u);if(s){if(s===h)continue;s=Jr;break}s=h}return So(s||Jr,t)}return Vc}function zo(a){const t=typeof a;return a===null?"":t==="string"||t==="number"||t==="boolean"?String(a):a instanceof xr?a.toStringPremultipliedAlpha():a instanceof Oo||a instanceof Wo?a.toString():JSON.stringify(a)}class or{constructor(t,s){this.type=t,this.value=s}static parse(t,s){if(t.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Ad(t[1]))return s.error("invalid value");const u=t[1];let h=ks(u);const m=s.expectedType;return h.kind!=="array"||h.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(h=m),new or(h,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof xr?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof Oo?this.value.serialize():this.value}}class gn{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const Ou={string:ui,number:Pn,boolean:ti,object:Vc};class zn{constructor(t,s){this.type=t,this.args=s}static parse(t,s){if(t.length<2)return s.error("Expected at least one argument.");let u,h=1;const m=t[0];if(m==="array"){let S,E;if(t.length>2){const A=t[1];if(typeof A!="string"||!(A in Ou)||A==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);S=Ou[A],h++}else S=Jr;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return s.error('The length argument to "array" must be a positive integer literal',2);E=t[2],h++}u=So(S,E)}else u=Ou[m];const _=[];for(;h<t.length;h++){const S=s.parse(t[h],h,Jr);if(!S)return null;_.push(S)}return new zn(u,_)}evaluate(t){for(let s=0;s<this.args.length;s++){const u=this.args[s].evaluate(t);if(!zh(this.type,ks(u)))return u;if(s===this.args.length-1)throw new gn(`The expression ${JSON.stringify(this.args[s].serialize())} evaluated to ${Is(ks(u))} but was expected to be of type ${Is(this.type)}.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,s=[t.kind];if(t.kind==="array"){const u=t.itemType;if(u.kind==="string"||u.kind==="number"||u.kind==="boolean"){s.push(u.kind);const h=t.N;(typeof h=="number"||this.args.length>1)&&s.push(h)}}return s.concat(this.args.map(u=>u.serialize()))}}class zu{constructor(t){this.type=kh,this.sections=t}static parse(t,s){if(t.length<2)return s.error("Expected at least one argument.");const u=t[1];if(!Array.isArray(u)&&typeof u=="object")return s.error("First argument must be an image or text section.");const h=[];let m=!1;for(let _=1;_<=t.length-1;++_){const S=t[_];if(m&&typeof S=="object"&&!Array.isArray(S)){m=!1;let E=null;if(S["font-scale"]&&(E=s.parseObjectValue(S["font-scale"],_,"font-scale",Pn),!E))return null;let A=null;if(S["text-font"]&&(A=s.parseObjectValue(S["text-font"],_,"text-font",So(ui)),!A))return null;let D=null;if(S["text-color"]&&(D=s.parseObjectValue(S["text-color"],_,"text-color",wo),!D))return null;const O=h[h.length-1];O.scale=E,O.font=A,O.textColor=D}else{const E=s.parse(t[_],_,Jr);if(!E)return null;const A=E.type.kind;if(A!=="string"&&A!=="value"&&A!=="null"&&A!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,h.push({content:E,scale:null,font:null,textColor:null})}}return new zu(h)}evaluate(t){return new Oo(this.sections.map(s=>{const u=s.content.evaluate(t);return ks(u)===Oh?new Bf("",u,null,null,null):new Bf(zo(u),null,s.scale?s.scale.evaluate(t):null,s.font?s.font.evaluate(t).join(","):null,s.textColor?s.textColor.evaluate(t):null)}))}eachChild(t){for(const s of this.sections)t(s.content),s.scale&&t(s.scale),s.font&&t(s.font),s.textColor&&t(s.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const s of this.sections){t.push(s.content.serialize());const u={};s.scale&&(u["font-scale"]=s.scale.serialize()),s.font&&(u["text-font"]=s.font.serialize()),s.textColor&&(u["text-color"]=s.textColor.serialize()),t.push(u)}return t}}class Fu{constructor(t,s,u,h){this._imageWarnHistory={},this.type=Oh,this.namePrimary=t,this.nameSecondary=s,u&&(this.paramsPrimary=u.params,this.iconsetIdPrimary=u.iconset?u.iconset.id:void 0),h&&(this.paramsSecondary=h.params,this.iconsetIdSecondary=h.iconset?h.iconset.id:void 0)}static parse(t,s){if(t.length<2)return s.error("Expected two or more arguments.");let u=1;const h=[];function m(){if(u<t.length){const S=s.parse(t[u],u++,ui);return S?(h.push({image:S,options:{}}),!0):(s.error(h.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function _(){if(u<t.length){const E=t[u];if((S=E)===null||typeof S!="object"||Array.isArray(S))return!0;const A=E.params,D=E.iconset,O=s.concat(u);if(!A&&!D)return u++,!0;if(A){if(typeof A!="object"||A.constructor!==Object)return O.error('Image options "params" should be an object'),!1;const F={},G=O.concat(void 0,"params");for(const W in A){if(!W)return G.error("Image parameter name should be non-empty"),!1;const Q=G.concat(void 0,W).parse(A[W],void 0,wo,void 0,{typeAnnotation:"coerce"});if(!Q)return!1;F[W]=Q}h[h.length-1].options.params=F}if(D){if(typeof D!="object"||D.constructor!==Object)return O.error('Image options "iconset" should be an object'),!1;if(!D.id)return O.error('Image options "iconset" should have an "id" property'),!1;h[h.length-1].options.iconset=D}return u++,!0}var S;return!0}for(let S=0;S<2;S++)if(!m()||!_())return;return new Fu(h[0].image,h[1]?h[1].image:void 0,h[0].options,h[1]?h[1].options:void 0)}evaluateParams(t,s){const u={};if(s){for(const h in s)if(s[h])try{u[h]=s[h].evaluate(t)}catch{continue}if(Object.keys(u).length!==0)return{params:u}}}evaluate(t){const s={name:this.namePrimary.evaluate(t),iconsetId:this.iconsetIdPrimary},u=this.nameSecondary?{name:this.nameSecondary.evaluate(t),iconsetId:this.iconsetIdSecondary}:void 0,h=Wo.build(s,u,this.paramsPrimary?this.evaluateParams(t,this.paramsPrimary):void 0,this.paramsSecondary?this.evaluateParams(t,this.paramsSecondary):void 0);if(h&&t.availableImages){const m=h.getPrimary().id;if(h.available=t.availableImages.some(_=>Go.isEqual(_,m)),h.available){const _=h.getSecondary()?h.getSecondary().id:null;_&&(h.available=t.availableImages.some(S=>Go.isEqual(S,_)))}}return h}eachChild(t){if(t(this.namePrimary),this.paramsPrimary)for(const s in this.paramsPrimary)this.paramsPrimary[s]&&t(this.paramsPrimary[s]);if(this.nameSecondary&&(t(this.nameSecondary),this.paramsSecondary))for(const s in this.paramsSecondary)this.paramsSecondary[s]&&t(this.paramsSecondary[s])}outputDefined(){return!1}serializeOptions(t,s){const u={};if(s&&(u.iconset={id:s}),t){u.params={};for(const h in t)t[h]&&(u.params[h]=t[h].serialize())}return Object.keys(u).length>0?u:void 0}serialize(){const t=["image",this.namePrimary.serialize()];if(this.paramsPrimary||this.iconsetIdPrimary){const s=this.serializeOptions(this.paramsPrimary,this.iconsetIdPrimary);s&&t.push(s)}if(this.nameSecondary&&(t.push(this.nameSecondary.serialize()),this.paramsSecondary||this.iconsetIdSecondary)){const s=this.serializeOptions(this.paramsSecondary,this.iconsetIdSecondary);s&&t.push(s)}return t}}function Bn(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}const im={"to-boolean":ti,"to-color":wo,"to-number":Pn,"to-string":ui};class Ea{constructor(t,s){this.type=t,this.args=s}static parse(t,s){if(t.length<2)return s.error("Expected at least one argument.");const u=t[0],h=[];let m=ac;if(u==="to-array"){if(!Array.isArray(t[1]))return null;const _=t[1].length;if(s.expectedType){if(s.expectedType.kind!=="array")return s.error(`Expected ${s.expectedType.kind} but found array.`);m=So(s.expectedType.itemType,_)}else{if(!(_>0&&Ad(t[1][0])))return null;m=So(ks(t[1][0]),_)}for(let S=0;S<_;S++){const E=t[1][S];let A;if(Bn(E)==="array")A=s.parse(E,void 0,m.itemType);else{const D=Bn(E);if(D!==m.itemType.kind)return s.error(`Expected ${m.itemType.kind} but found ${D}.`);A=s.registry.literal.parse(["literal",E===void 0?null:E],s)}if(!A)return null;h.push(A)}}else{if((u==="to-boolean"||u==="to-string")&&t.length!==2)return s.error("Expected one argument.");m=im[u];for(let _=1;_<t.length;_++){const S=s.parse(t[_],_,Jr);if(!S)return null;h.push(S)}}return new Ea(m,h)}evaluate(t){if(this.type.kind==="boolean")return!!this.args[0].evaluate(t);if(this.type.kind==="color"){let s,u;for(const h of this.args){if(s=h.evaluate(t),u=null,s instanceof xr)return s;if(typeof s=="string"){const m=t.parseColor(s);if(m)return m}else if(Array.isArray(s)&&(u=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:xg(s[0],s[1],s[2],s[3]),!u))return new xr(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new gn(u||`Could not parse color from value '${typeof s=="string"?s:String(JSON.stringify(s))}'`)}if(this.type.kind==="number"){let s=null;for(const u of this.args){if(s=u.evaluate(t),s===null)return 0;const h=Number(s);if(!isNaN(h))return h}throw new gn(`Could not convert ${JSON.stringify(s)} to number.`)}return this.type.kind==="formatted"?Oo.fromString(zo(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?Wo.build(zo(this.args[0].evaluate(t))):this.type.kind==="array"?this.args.map(s=>s.evaluate(t)):zo(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if(this.type.kind==="formatted")return new zu([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Fu(this.args[0]).serialize();const t=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(s=>{t.push(s.serialize())}),t}}const sm=["Unknown","Point","LineString","Polygon"];class lc{constructor(t,s){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=t,this.options=s}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?sm[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(t){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const t=this.featureDistanceData.center,s=this.featureDistanceData.scale,{x:u,y:h}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(u*s-t[0])+this.featureDistanceData.bearing[1]*(h*s-t[1])}return 0}parseColor(t){let s=this._parseColorCache[t];return s||(s=this._parseColorCache[t]=xr.parse(t)),s}getConfig(t){return this.options?this.options.get(t):null}}class Co{constructor(t,s,u,h,m){this.name=t,this.type=s,this._evaluate=u,this.args=h,this._overloadIndex=m}evaluate(t){if(!this._evaluate){const s=Co.definitions[this.name];this._evaluate=Array.isArray(s)?s[2]:s.overloads[this._overloadIndex][1]}return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,s){const u=t[0],h=Co.definitions[u];if(!h)return s.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(h)?h[0]:h.type,_=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,S=[];let E=null,A=-1;for(const[D,O]of _){if(Array.isArray(D)&&D.length!==t.length-1)continue;S.push(D),A++,E=new pm(s.registry,s.path,null,s.scope,void 0,s._scope,s.options);const F=[];let G=!1;for(let W=1;W<t.length;W++){const Q=t[W],ae=Array.isArray(D)?D[W-1]:D.type,ce=E.parse(Q,1+F.length,ae);if(!ce){G=!0;break}F.push(ce)}if(!G)if(Array.isArray(D)&&D.length!==F.length)E.error(`Expected ${D.length} arguments, but found ${F.length} instead.`);else{for(let W=0;W<F.length;W++){const Q=Array.isArray(D)?D[W]:D.type,ae=F[W];E.concat(W+1).checkSubtype(Q,ae.type)}if(E.errors.length===0)return new Co(u,m,O,F,A)}}if(S.length===1)s.errors.push(...E.errors);else{const D=(S.length?S:_.map(([F])=>F)).map(Fo).join(" | "),O=[];for(let F=1;F<t.length;F++){const G=s.parse(t[F],1+O.length);if(!G)return null;O.push(Is(G.type))}s.error(`Expected arguments of type ${D}, but found (${O.join(", ")}) instead.`)}return null}static register(t,s){Co.definitions=s;for(const u in s)t[u]=Co}}function Fo(a){return Array.isArray(a)?`(${a.map(Is).join(", ")})`:`(${Is(a.type)}...)`}class Rd{constructor(t,s,u){this.type=ku,this.locale=u,this.caseSensitive=t,this.diacriticSensitive=s}static parse(t,s){if(t.length!==2)return s.error("Expected one argument.");const u=t[1];if(typeof u!="object"||Array.isArray(u))return s.error("Collator options argument must be an object.");const h=u["case-sensitive"]===void 0?s.parse(!1,1,ti):s.parseObjectValue(u["case-sensitive"],1,"case-sensitive",ti);if(!h)return null;const m=u["diacritic-sensitive"]===void 0?s.parse(!1,1,ti):s.parseObjectValue(u["diacritic-sensitive"],1,"diacritic-sensitive",ti);if(!m)return null;let _=null;return u.locale&&(_=s.parseObjectValue(u.locale,1,"locale",ui),!_)?null:new Rd(h,m,_)}evaluate(t){return new $c(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}function cc(a,t,s=0,u=a.length-1,h=Qa){for(;u>s;){if(u-s>600){const E=u-s+1,A=t-s+1,D=Math.log(E),O=.5*Math.exp(2*D/3),F=.5*Math.sqrt(D*O*(E-O)/E)*(A-E/2<0?-1:1);cc(a,t,Math.max(s,Math.floor(t-A*O/E+F)),Math.min(u,Math.floor(t+(E-A)*O/E+F)),h)}const m=a[t];let _=s,S=u;for(Hc(a,s,t),h(a[u],m)>0&&Hc(a,s,u);_<S;){for(Hc(a,_,S),_++,S--;h(a[_],m)<0;)_++;for(;h(a[S],m)>0;)S--}h(a[s],m)===0?Hc(a,s,S):(S++,Hc(a,S,u)),S<=t&&(s=S+1),t<=S&&(u=S-1)}}function Hc(a,t,s){const u=a[t];a[t]=a[s],a[s]=u}function Qa(a,t){return a<t?-1:a>t?1:0}function Gs(a){let t=0;for(let s,u,h=0,m=a.length,_=m-1;h<m;_=h++)s=a[h],u=a[_],t+=(u.x-s.x)*(s.y+u.y);return t}function Fh(a,t){a[0]=Math.min(a[0],t[0]),a[1]=Math.min(a[1],t[1]),a[2]=Math.max(a[2],t[0]),a[3]=Math.max(a[3],t[1])}function Gc(a,t){return!(a[0]<=t[0]||a[2]>=t[2]||a[1]<=t[1]||a[3]>=t[3])}function J_(a,t,s){const u=a[0]-t[0],h=a[1]-t[1],m=a[0]-s[0],_=a[1]-s[1];return u*_-m*h==0&&u*m<=0&&h*_<=0}function Al(a,t,s=!1){let u=!1;for(let S=0,E=t.length;S<E;S++){const A=t[S];for(let D=0,O=A.length,F=O-1;D<O;F=D++){const G=A[F],W=A[D];if(J_(a,G,W))return s;(m=G)[1]>(h=a)[1]!=(_=W)[1]>h[1]&&h[0]<(_[0]-m[0])*(h[1]-m[1])/(_[1]-m[1])+m[0]&&(u=!u)}}var h,m,_;return u}function Nh(a,t,s,u){const h=u[0]-s[0],m=u[1]-s[1],_=(a[0]-s[0])*m-h*(a[1]-s[1]),S=(t[0]-s[0])*m-h*(t[1]-s[1]);return _>0&&S<0||_<0&&S>0}function Ia(a,t,s,u){return(h=[u[0]-s[0],u[1]-s[1]])[0]*(m=[t[0]-a[0],t[1]-a[1]])[1]-h[1]*m[0]!=0&&!(!Nh(a,t,s,u)||!Nh(s,u,a,t));var h,m}function Vf(a){const t=new Qt(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),s=new Qt(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const u of a[0])t.x>u.x&&(t.x=u.x),t.y>u.y&&(t.y=u.y),s.x<u.x&&(s.x=u.x),s.y<u.y&&(s.y=u.y);return{min:t,max:s}}const uc=8192;function bg(a,t){const s=(180+a[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,h=Math.pow(2,t.z);return[Math.round(s*h*uc),Math.round(u*h*uc)]}function Q_(a,t){for(let s=0;s<t.length;s++)if(Al(a,t[s]))return!0;return!1}function wg(a,t,s){for(const u of s)for(let h=0,m=u.length,_=m-1;h<m;_=h++)if(Ia(a,t,u[_],u[h]))return!0;return!1}function Sg(a,t){for(let s=0;s<a.length;++s)if(!Al(a[s],t))return!1;for(let s=0;s<a.length-1;++s)if(wg(a[s],a[s+1],t))return!1;return!0}function ey(a,t){for(let s=0;s<t.length;s++)if(Sg(a,t[s]))return!0;return!1}function Uf(a,t,s){const u=[];for(let h=0;h<a.length;h++){const m=[];for(let _=0;_<a[h].length;_++){const S=bg(a[h][_],s);Fh(t,S),m.push(S)}u.push(m)}return u}function Pa(a,t,s){const u=[];for(let h=0;h<a.length;h++){const m=Uf(a[h],t,s);u.push(m)}return u}function Aa(a,t,s,u){if(a[0]<s[0]||a[0]>s[2]){const h=.5*u;let m=a[0]-s[0]>h?-u:s[0]-a[0]>h?u:0;m===0&&(m=a[0]-s[2]>h?-u:s[2]-a[0]>h?u:0),a[0]+=m}Fh(t,a)}function om(a,t,s,u){const h=Math.pow(2,u.z)*uc,m=[u.x*uc,u.y*uc],_=[];if(!a)return _;for(const S of a)for(const E of S){const A=[E.x+m[0],E.y+m[1]];Aa(A,t,s,h),_.push(A)}return _}function am(a,t,s,u){const h=Math.pow(2,u.z)*uc,m=[u.x*uc,u.y*uc],_=[];if(!a)return _;for(const E of a){const A=[];for(const D of E){const O=[D.x+m[0],D.y+m[1]];Fh(t,O),A.push(O)}_.push(A)}if(t[2]-t[0]<=h/2){(S=t)[0]=S[1]=1/0,S[2]=S[3]=-1/0;for(const E of _)for(const A of E)Aa(A,t,s,h)}var S;return _}class Rl{constructor(t,s){this.type=ti,this.geojson=t,this.geometries=s}static parse(t,s){if(t.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Ad(t[1])){const u=t[1];if(u.type==="FeatureCollection")for(let h=0;h<u.features.length;++h){const m=u.features[h].geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Rl(u,u.features[h].geometry)}else if(u.type==="Feature"){const h=u.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new Rl(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new Rl(u,u)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(s,u){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],_=s.canonicalID();if(!_)return!1;if(u.type==="Polygon"){const S=Uf(u.coordinates,m,_),E=om(s.geometry(),h,m,_);if(!Gc(h,m))return!1;for(const A of E)if(!Al(A,S))return!1}if(u.type==="MultiPolygon"){const S=Pa(u.coordinates,m,_),E=om(s.geometry(),h,m,_);if(!Gc(h,m))return!1;for(const A of E)if(!Q_(A,S))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(s,u){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],_=s.canonicalID();if(!_)return!1;if(u.type==="Polygon"){const S=Uf(u.coordinates,m,_),E=am(s.geometry(),h,m,_);if(!Gc(h,m))return!1;for(const A of E)if(!Sg(A,S))return!1}if(u.type==="MultiPolygon"){const S=Pa(u.coordinates,m,_),E=am(s.geometry(),h,m,_);if(!Gc(h,m))return!1;for(const A of E)if(!ey(A,S))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const Md={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},jh=1/298.257223563,Ra=jh*(2-jh),Ld=Math.PI/180;class el{static fromTile(t,s,u){const h=Math.PI*(1-2*(t+.5)/Math.pow(2,s)),m=Math.atan(.5*(Math.exp(h)-Math.exp(-h)))/Ld;return new el(m,u)}static get units(){return Md}constructor(t,s){if(t===void 0)throw new Error("No latitude given.");if(s&&!Md[s])throw new Error(`Unknown unit ${s}. Use one of: ${Object.keys(Md).join(", ")}`);const u=6378.137*Ld*(s?Md[s]:1),h=Math.cos(t*Ld),m=1/(1-Ra*(1-h*h)),_=Math.sqrt(m);this.kx=u*_*h,this.ky=u*_*m*(1-Ra)}distance(t,s){const u=qo(t[0]-s[0])*this.kx,h=(t[1]-s[1])*this.ky;return Math.sqrt(u*u+h*h)}bearing(t,s){const u=qo(s[0]-t[0])*this.kx;return Math.atan2(u,(s[1]-t[1])*this.ky)/Ld}destination(t,s,u){const h=u*Ld;return this.offset(t,Math.sin(h)*s,Math.cos(h)*s)}offset(t,s,u){return[t[0]+s/this.kx,t[1]+u/this.ky]}lineDistance(t){let s=0;for(let u=0;u<t.length-1;u++)s+=this.distance(t[u],t[u+1]);return s}area(t){let s=0;for(let u=0;u<t.length;u++){const h=t[u];for(let m=0,_=h.length,S=_-1;m<_;S=m++)s+=qo(h[m][0]-h[S][0])*(h[m][1]+h[S][1])*(u?-1:1)}return Math.abs(s)/2*this.kx*this.ky}along(t,s){let u=0;if(s<=0)return t[0];for(let h=0;h<t.length-1;h++){const m=t[h],_=t[h+1],S=this.distance(m,_);if(u+=S,u>s)return Wc(m,_,(s-(u-S))/S)}return t[t.length-1]}pointToSegmentDistance(t,s,u){let[h,m]=s,_=qo(u[0]-h)*this.kx,S=(u[1]-m)*this.ky;if(_!==0||S!==0){const E=(qo(t[0]-h)*this.kx*_+(t[1]-m)*this.ky*S)/(_*_+S*S);E>1?(h=u[0],m=u[1]):E>0&&(h+=_/this.kx*E,m+=S/this.ky*E)}return _=qo(t[0]-h)*this.kx,S=(t[1]-m)*this.ky,Math.sqrt(_*_+S*S)}pointOnLine(t,s){let u=1/0,h=t[0][0],m=t[0][1],_=0,S=0;for(let E=0;E<t.length-1;E++){let A=t[E][0],D=t[E][1],O=qo(t[E+1][0]-A)*this.kx,F=(t[E+1][1]-D)*this.ky,G=0;O===0&&F===0||(G=(qo(s[0]-A)*this.kx*O+(s[1]-D)*this.ky*F)/(O*O+F*F),G>1?(A=t[E+1][0],D=t[E+1][1]):G>0&&(A+=O/this.kx*G,D+=F/this.ky*G)),O=qo(s[0]-A)*this.kx,F=(s[1]-D)*this.ky;const W=O*O+F*F;W<u&&(u=W,h=A,m=D,_=E,S=G)}return{point:[h,m],index:_,t:Math.max(0,Math.min(1,S))}}lineSlice(t,s,u){let h=this.pointOnLine(u,t),m=this.pointOnLine(u,s);if(h.index>m.index||h.index===m.index&&h.t>m.t){const A=h;h=m,m=A}const _=[h.point],S=h.index+1,E=m.index;!Bh(u[S],_[0])&&S<=E&&_.push(u[S]);for(let A=S+1;A<=E;A++)_.push(u[A]);return Bh(u[E],m.point)||_.push(m.point),_}lineSliceAlong(t,s,u){let h=0;const m=[];for(let _=0;_<u.length-1;_++){const S=u[_],E=u[_+1],A=this.distance(S,E);if(h+=A,h>t&&m.length===0&&m.push(Wc(S,E,(t-(h-A))/A)),h>=s)return m.push(Wc(S,E,(s-(h-A))/A)),m;h>t&&m.push(E)}return m}bufferPoint(t,s){const u=s/this.ky,h=s/this.kx;return[t[0]-h,t[1]-u,t[0]+h,t[1]+u]}bufferBBox(t,s){const u=s/this.ky,h=s/this.kx;return[t[0]-h,t[1]-u,t[2]+h,t[3]+u]}insideBBox(t,s){return qo(t[0]-s[0])>=0&&qo(t[0]-s[2])<=0&&t[1]>=s[1]&&t[1]<=s[3]}}function Bh(a,t){return a[0]===t[0]&&a[1]===t[1]}function Wc(a,t,s){const u=qo(t[0]-a[0]);return[a[0]+u*s,a[1]+(t[1]-a[1])*s]}function qo(a){for(;a<-180;)a+=360;for(;a>180;)a-=360;return a}class Vh{constructor(t=[],s=(u,h)=>u<h?-1:u>h?1:0){if(this.data=t,this.length=this.data.length,this.compare=s,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],s=this.data.pop();return--this.length>0&&(this.data[0]=s,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:s,compare:u}=this,h=s[t];for(;t>0;){const m=t-1>>1,_=s[m];if(u(h,_)>=0)break;s[t]=_,t=m}s[t]=h}_down(t){const{data:s,compare:u}=this,h=this.length>>1,m=s[t];for(;t<h;){let _=1+(t<<1);const S=_+1;if(S<this.length&&u(s[S],s[_])<0&&(_=S),u(s[_],m)>=0)break;s[t]=s[_],t=_}s[t]=m}}var en=8192;function qc(a,t){return t.dist-a.dist}const Dd=100,Uh=50;function kd(a){const t=[1/0,1/0,-1/0,-1/0];if(t.length!==a.length)return!1;for(let s=0;s<t.length;s++)if(t[s]!==a[s])return!1;return!0}function Zc(a){return a[1]-a[0]+1}function ca(a,t){const s=a[1]>=a[0]&&a[1]<t;return s||console.warn("Distance Expression: Index is out of range"),s}function Nu(a,t){if(a[0]>a[1])return[null,null];const s=Zc(a);if(t){if(s===2)return[a,null];const u=Math.floor(s/2);return[[a[0],a[0]+u],[a[0]+u,a[1]]]}{if(s===1)return[a,null];const u=Math.floor(s/2)-1;return[[a[0],a[0]+u],[a[0]+u+1,a[1]]]}}function dc(a,t){const s=[1/0,1/0,-1/0,-1/0];if(!ca(t,a.length))return s;for(let u=t[0];u<=t[1];++u)Fh(s,a[u]);return s}function Od(a){const t=[1/0,1/0,-1/0,-1/0];for(let s=0;s<a.length;++s)for(let u=0;u<a[s].length;++u)Fh(t,a[s][u]);return t}function Xc(a,t,s){if(kd(a)||kd(t))return NaN;let u=0,h=0;return a[2]<t[0]&&(u=t[0]-a[2]),a[0]>t[2]&&(u=a[0]-t[2]),a[1]>t[3]&&(h=a[1]-t[3]),a[3]<t[1]&&(h=t[1]-a[3]),s.distance([0,0],[u,h])}function ua(a){return 360*a-180}function Ar(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function $h(a,t){const s=Math.pow(2,t.z),u=(a.y/en+t.y)/s;return[ua((a.x/en+t.x)/s),Ar(u)]}function ty(a,t){const s=[];for(let u=0;u<a.length;++u)s.push($h(a[u],t));return s}function Cg(a,t,s){const u=s.pointOnLine(t,a).point;return s.distance(a,u)}function ju(a,t,s,u,h){const m=s.slice(u[0],u[1]+1);let _=1/0;for(let S=t[0];S<=t[1];++S)if((_=Math.min(_,Cg(a[S],m,h)))===0)return 0;return _}function lm(a,t,s,u,h){const m=Math.min(h.pointToSegmentDistance(a,s,u),h.pointToSegmentDistance(t,s,u)),_=Math.min(h.pointToSegmentDistance(s,a,t),h.pointToSegmentDistance(u,a,t));return Math.min(m,_)}function Ui(a,t,s,u,h){if(!ca(t,a.length)||!ca(u,s.length))return NaN;let m=1/0;for(let _=t[0];_<t[1];++_)for(let S=u[0];S<u[1];++S){if(Ia(a[_],a[_+1],s[S],s[S+1]))return 0;m=Math.min(m,lm(a[_],a[_+1],s[S],s[S+1],h))}return m}function Tg(a,t,s,u,h){if(!ca(t,a.length)||!ca(u,s.length))return NaN;let m=1/0;for(let _=t[0];_<=t[1];++_)for(let S=u[0];S<=u[1];++S)if((m=Math.min(m,h.distance(a[_],s[S])))===0)return m;return m}function ws(a,t,s){if(Al(a,t,!0))return 0;let u=1/0;for(const h of t){const m=h.length;if(m<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(h[0]!==h[m-1]&&(u=Math.min(u,s.pointToSegmentDistance(a,h[m-1],h[0])))===0||(u=Math.min(u,Cg(a,h,s)))===0)return u}return u}function cm(a,t,s,u){if(!ca(t,a.length))return NaN;for(let m=t[0];m<=t[1];++m)if(Al(a[m],s,!0))return 0;let h=1/0;for(let m=t[0];m<t[1];++m)for(const _ of s)for(let S=0,E=_.length,A=E-1;S<E;A=S++){if(Ia(a[m],a[m+1],_[A],_[S]))return 0;h=Math.min(h,lm(a[m],a[m+1],_[A],_[S],u))}return h}function Hh(a,t){for(const s of a)for(let u=0;u<=s.length-1;++u)if(Al(s[u],t,!0))return!0;return!1}function Gh(a,t,s,u=1/0){const h=Od(a),m=Od(t);if(u!==1/0&&Xc(h,m,s)>=u)return u;if(Gc(h,m)){if(Hh(a,t))return 0}else if(Hh(t,a))return 0;let _=u;for(const S of a)for(let E=0,A=S.length,D=A-1;E<A;D=E++)for(const O of t)for(let F=0,G=O.length,W=G-1;F<G;W=F++){if(Ia(S[D],S[E],O[W],O[F]))return 0;_=Math.min(_,lm(S[D],S[E],O[W],O[F],s))}return _}function Wh(a,t,s,u,h,m,_){if(m===null||_===null)return;const S=Xc(dc(u,m),dc(h,_),s);S<t&&a.push({dist:S,range1:m,range2:_})}function um(a,t,s,u,h=1/0){let m=Math.min(u.distance(a[0],s[0][0]),h);if(m===0)return m;const _=new Vh([{dist:0,range1:[0,a.length-1],range2:[0,0]}],qc),S=t?Uh:Dd,E=Od(s);for(;_.length;){const A=_.pop();if(A.dist>=m)continue;const D=A.range1;if(Zc(D)<=S){if(!ca(D,a.length))return NaN;if(t){const O=cm(a,D,s,u);if((m=Math.min(m,O))===0)return m}else for(let O=D[0];O<=D[1];++O){const F=ws(a[O],s,u);if((m=Math.min(m,F))===0)return m}}else{const O=Nu(D,t);if(O[0]!==null){const F=Xc(dc(a,O[0]),E,u);F<m&&_.push({dist:F,range1:O[0],range2:[0,0]})}if(O[1]!==null){const F=Xc(dc(a,O[1]),E,u);F<m&&_.push({dist:F,range1:O[1],range2:[0,0]})}}}return m}function zd(a,t,s,u,h,m=1/0){let _=Math.min(m,h.distance(a[0],s[0]));if(_===0)return _;const S=new Vh([{dist:0,range1:[0,a.length-1],range2:[0,s.length-1]}],qc),E=t?Uh:Dd,A=u?Uh:Dd;for(;S.length;){const D=S.pop();if(D.dist>=_)continue;const O=D.range1,F=D.range2;if(Zc(O)<=E&&Zc(F)<=A){if(!ca(O,a.length)||!ca(F,s.length))return NaN;if(t&&u?_=Math.min(_,Ui(a,O,s,F,h)):t||u?t&&!u?_=Math.min(_,ju(s,F,a,O,h)):!t&&u&&(_=Math.min(_,ju(a,O,s,F,h))):_=Math.min(_,Tg(a,O,s,F,h)),_===0)return _}else{const G=Nu(O,t),W=Nu(F,u);Wh(S,_,h,a,s,G[0],W[0]),Wh(S,_,h,a,s,G[0],W[1]),Wh(S,_,h,a,s,G[1],W[0]),Wh(S,_,h,a,s,G[1],W[1])}}return _}function Fd(a,t,s,u,h=1/0){let m=h;const _=dc(a,[0,a.length-1]);for(const S of s)if(!(m!==1/0&&Xc(_,dc(S,[0,S.length-1]),u)>=m)&&(m=Math.min(m,zd(a,t,S,!0,u,m)),m===0))return m;return m}function hc(a,t,s,u,h=1/0){let m=h;const _=dc(a,[0,a.length-1]);for(const S of s){if(m!==1/0&&Xc(_,Od(S),u)>=m)continue;const E=um(a,t,S,u,m);if(isNaN(E))return E;if((m=Math.min(m,E))===0)return m}return m}function $f(a){return a==="Point"||a==="MultiPoint"||a==="LineString"||a==="MultiLineString"||a==="Polygon"||a==="MultiPolygon"}class Bu{constructor(t,s){this.type=Pn,this.geojson=t,this.geometries=s}static parse(t,s){if(t.length!==2)return s.error(`'distance' expression requires either one argument, but found ' ${t.length-1} instead.`);if(Ad(t[1])){const u=t[1];if(u.type==="FeatureCollection"){for(let h=0;h<u.features.length;++h)if($f(u.features[h].geometry.type))return new Bu(u,u.features[h].geometry)}else if(u.type==="Feature"){if($f(u.geometry.type))return new Bu(u,u.geometry)}else if($f(u.type))return new Bu(u,u)}return s.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(t){const s=t.geometry(),u=t.canonicalID();if(s!=null&&u!=null){if(t.geometryType()==="Point")return function(h,m,_){const S=[];for(const A of h)for(const D of A)S.push($h(D,m));const E=new el(S[0][1],"meters");return _.type==="Point"||_.type==="MultiPoint"||_.type==="LineString"?zd(S,!1,_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",E):_.type==="MultiLineString"?Fd(S,!1,_.coordinates,E):_.type==="Polygon"||_.type==="MultiPolygon"?hc(S,!1,_.type==="Polygon"?[_.coordinates]:_.coordinates,E):null}(s,u,this.geometries);if(t.geometryType()==="LineString")return function(h,m,_){const S=[];for(const A of h){const D=[];for(const O of A)D.push($h(O,m));S.push(D)}const E=new el(S[0][0][1],"meters");if(_.type==="Point"||_.type==="MultiPoint"||_.type==="LineString")return Fd(_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",S,E);if(_.type==="MultiLineString"){let A=1/0;for(let D=0;D<_.coordinates.length;D++){const O=Fd(_.coordinates[D],!0,S,E,A);if(isNaN(O))return O;if((A=Math.min(A,O))===0)return A}return A}if(_.type==="Polygon"||_.type==="MultiPolygon"){let A=1/0;for(let D=0;D<S.length;D++){const O=hc(S[D],!0,_.type==="Polygon"?[_.coordinates]:_.coordinates,E,A);if(isNaN(O))return O;if((A=Math.min(A,O))===0)return A}return A}return null}(s,u,this.geometries);if(t.geometryType()==="Polygon")return function(h,m,_){const S=[];for(const A of function(D,O){const F=D.length;if(F<=1)return[D];const G=[];let W,Q;for(let ae=0;ae<F;ae++){const ce=Gs(D[ae]);ce!==0&&(D[ae].area=Math.abs(ce),Q===void 0&&(Q=ce<0),Q===ce<0?(W&&G.push(W),W=[D[ae]]):W.push(D[ae]))}return W&&G.push(W),G}(h)){const D=[];for(let O=0;O<A.length;++O)D.push(ty(A[O],m));S.push(D)}const E=new el(S[0][0][0][1],"meters");if(_.type==="Point"||_.type==="MultiPoint"||_.type==="LineString")return hc(_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",S,E);if(_.type==="MultiLineString"){let A=1/0;for(let D=0;D<_.coordinates.length;D++){const O=hc(_.coordinates[D],!0,S,E,A);if(isNaN(O))return O;if((A=Math.min(A,O))===0)return A}return A}return _.type==="Polygon"||_.type==="MultiPolygon"?function(A,D,O){let F=1/0;for(const G of A)for(const W of D){const Q=Gh(G,W,O,F);if(isNaN(Q))return Q;if((F=Math.min(F,Q))===0)return F}return F}(_.type==="Polygon"?[_.coordinates]:_.coordinates,S,E):null}(s,u,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function dm(a,t){switch(a){case"string":return zo(t);case"number":return+t;case"boolean":return!!t;case"color":return xr.parse(t);case"formatted":return Oo.fromString(zo(t));case"resolvedImage":return Wo.build(zo(t))}return t}function hm(a,t,s,u){return u!==void 0&&(a=u*Math.round(a/u)),t!==void 0&&a<t&&(a=t),s!==void 0&&a>s&&(a=s),a}class fc{constructor(t,s,u){this.type=t,this.key=s,this.scope=u}static parse(t,s){let u=s.expectedType;if(u==null&&(u=Jr),t.length<2||t.length>3)return s.error("Invalid number of arguments for 'config' expression.");const h=s.parse(t[1],1);if(!(h instanceof or))return s.error("Key name of 'config' expression must be a string literal.");if(t.length>=3){const m=s.parse(t[2],2);return m instanceof or?new fc(u,zo(h.value),zo(m.value)):s.error("Scope of 'config' expression must be a string literal.")}return new fc(u,zo(h.value))}evaluate(t){const s=[this.key,this.scope,t.scope].filter(Boolean).join(""),u=t.getConfig(s);if(!u)return null;const{type:h,value:m,values:_,minValue:S,maxValue:E,stepValue:A}=u,D=u.default.evaluate(t);let O=D;if(m){const F=t.scope;t.scope=(F||"").split("").slice(1).join(""),O=m.evaluate(t),t.scope=F}return h&&(O=dm(h,O)),O===void 0||S===void 0&&E===void 0&&A===void 0||(typeof O=="number"?O=hm(O,S,E,A):Array.isArray(O)&&(O=O.map(F=>typeof F=="number"?hm(F,S,E,A):F))),m!==void 0&&O!==void 0&&_&&!_.includes(O)&&(O=D,h&&(O=dm(h,O))),(h&&h!==this.type||O!==void 0&&ks(O)!==this.type)&&(O=dm(this.type.kind,O)),O}eachChild(){}outputDefined(){return!1}serialize(){const t=["config",this.key];return this.scope&&t.concat(this.key),t}}function Kc(a){if(a instanceof Co&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof Rl||a instanceof Bu)return!1;let t=!0;return a.eachChild(s=>{t&&!Kc(s)&&(t=!1)}),t}function Nd(a){if(a instanceof Co&&a.name==="feature-state")return!1;let t=!0;return a.eachChild(s=>{t&&!Nd(s)&&(t=!1)}),t}function jd(a){if(a instanceof fc)return new Set([a.key]);let t=new Set;return a.eachChild(s=>{t=new Set([...t,...jd(s)])}),t}function Yc(a,t){if(a instanceof Co&&t.indexOf(a.name)>=0)return!1;let s=!0;return a.eachChild(u=>{s&&!Yc(u,t)&&(s=!1)}),s}class Bd{constructor(t,s){this.type=s.type,this.name=t,this.boundExpression=s}static parse(t,s){if(t.length!==2||typeof t[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const u=t[1];return s.scope.has(u)?new Bd(u,s.scope.get(u)):s.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class fm{constructor(t,s=[],u,h=new Pl,m=[],_,S){this.registry=t,this.path=s,this.key=s.map(E=>typeof E=="string"?`['${E}']`:`[${E}]`).join(""),this.scope=h,this.errors=m,this.expectedType=u,this._scope=_,this.options=S}parse(t,s,u,h,m={}){return s||u?this.concat(s,null,u,h)._parse(t,m):this._parse(t,m)}parseObjectValue(t,s,u,h,m,_={}){return this.concat(s,u,h,m)._parse(t,_)}_parse(t,s){function u(h,m,_){return _==="assert"?new zn(m,[h]):_==="coerce"?new Ea(m,[h]):h}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=typeof t[0]=="string"?this.registry[t[0]]:void 0;if(h){let m=h.parse(t,this);if(!m)return null;if(this.expectedType){const _=this.expectedType,S=m.type;if(_.kind!=="string"&&_.kind!=="number"&&_.kind!=="boolean"&&_.kind!=="object"&&_.kind!=="array"||S.kind!=="value")if(_.kind!=="color"&&_.kind!=="formatted"&&_.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string"){if(this.checkSubtype(_,S))return null}else m=u(m,_,s.typeAnnotation||"coerce");else m=u(m,_,s.typeAnnotation||"assert")}if(!(m instanceof or)&&m.type.kind!=="resolvedImage"&&mm(m)){const _=new lc(this._scope,this.options);try{m=new or(m.type,m.evaluate(_))}catch(S){return this.error(S.message),null}}return m}return Ea.parse(["to-array",t],this)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,s,u,h){let m=typeof t=="number"?this.path.concat(t):this.path;m=typeof s=="string"?m.concat(s):m;const _=h?this.scope.concat(h):this.scope;return new fm(this.registry,m,u||null,_,this.errors,this._scope,this.options)}error(t,...s){const u=`${this.key}${s.map(h=>`[${h}]`).join("")}`;this.errors.push(new ko(u,t))}checkSubtype(t,s){const u=zh(t,s);return u&&this.error(u),u}}var pm=fm;function mm(a){if(a instanceof Bd)return mm(a.boundExpression);if(a instanceof Co&&a.name==="error"||a instanceof Rd||a instanceof Rl||a instanceof Bu||a instanceof fc)return!1;const t=a instanceof Ea||a instanceof zn;let s=!0;return a.eachChild(u=>{s=t?s&&mm(u):s&&u instanceof or}),!!s&&Kc(a)&&Yc(a,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function Hf(a,t){const s=a.length-1;let u,h,m=0,_=s,S=0;for(;m<=_;)if(S=Math.floor((m+_)/2),u=a[S],h=a[S+1],u<=t){if(S===s||t<h)return S;m=S+1}else{if(!(u>t))throw new gn("Input is not a number.");_=S-1}return 0}class Vu{constructor(t,s,u){this.type=t,this.input=s,this.labels=[],this.outputs=[];for(const[h,m]of u)this.labels.push(h),this.outputs.push(m)}static parse(t,s){if(t.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return s.error("Expected an even number of arguments.");const u=s.parse(t[1],1,Pn);if(!u)return null;const h=[];let m=null;s.expectedType&&s.expectedType.kind!=="value"&&(m=s.expectedType);for(let _=1;_<t.length;_+=2){const S=_===1?-1/0:t[_],E=t[_+1],A=_,D=_+1;if(typeof S!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',A);if(h.length&&h[h.length-1][0]>=S)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',A);const O=s.parse(E,D,m);if(!O)return null;m=m||O.type,h.push([S,O])}return new Vu(m,u,h)}evaluate(t){const s=this.labels,u=this.outputs;if(s.length===1)return u[0].evaluate(t);const h=this.input.evaluate(t);if(h<=s[0])return u[0].evaluate(t);const m=s.length;return h>=s[m-1]?u[m-1].evaluate(t):u[Hf(s,h)].evaluate(t)}eachChild(t){t(this.input);for(const s of this.outputs)t(s)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let s=0;s<this.labels.length;s++)s>0&&t.push(this.labels[s]),t.push(this.outputs[s].serialize());return t}}const pc=.95047,gm=1.08883,Uu=4/29,Zo=6/29,Vd=3*Zo*Zo,mc=Zo*Zo*Zo,qh=Math.PI/180,ny=180/Math.PI;function Gf(a){return a>mc?Math.pow(a,1/3):a/Vd+Uu}function gc(a){return a>Zo?a*a*a:Vd*(a-Uu)}function $u(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function Jc(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function Ud(a){const t=Jc(a.r),s=Jc(a.g),u=Jc(a.b),h=Gf((.4124564*t+.3575761*s+.1804375*u)/pc),m=Gf((.2126729*t+.7151522*s+.072175*u)/1);return{l:116*m-16,a:500*(h-m),b:200*(m-Gf((.0193339*t+.119192*s+.9503041*u)/gm)),alpha:a.a}}function Zh(a){let t=(a.l+16)/116,s=isNaN(a.a)?t:t+a.a/500,u=isNaN(a.b)?t:t-a.b/200;return t=1*gc(t),s=pc*gc(s),u=gm*gc(u),new xr($u(3.2404542*s-1.5371385*t-.4985314*u),$u(-.969266*s+1.8760108*t+.041556*u),$u(.0556434*s-.2040259*t+1.0572252*u),a.alpha)}function tl(a,t,s){const u=t-a;return a+s*(u>180||u<-180?u-360*Math.round(u/360):u)}const da={forward:Ud,reverse:Zh,interpolate:function(a,t,s){return{l:kn(a.l,t.l,s),a:kn(a.a,t.a,s),b:kn(a.b,t.b,s),alpha:kn(a.alpha,t.alpha,s)}}},es={forward:function(a){const{l:t,a:s,b:u}=Ud(a),h=Math.atan2(u,s)*ny;return{h:h<0?h+360:h,c:Math.sqrt(s*s+u*u),l:t,alpha:a.a}},reverse:function(a){const t=a.h*qh,s=a.c;return Zh({l:a.l,a:Math.cos(t)*s,b:Math.sin(t)*s,alpha:a.alpha})},interpolate:function(a,t,s){return{h:tl(a.h,t.h,s),c:kn(a.c,t.c,s),l:kn(a.l,t.l,s),alpha:kn(a.alpha,t.alpha,s)}}};var ds=Object.freeze({__proto__:null,hcl:es,lab:da});class Os{constructor(t,s,u,h,m){this.type=t,this.operator=s,this.interpolation=u,this.input=h,this.labels=[],this.outputs=[];for(const[_,S]of m)this.labels.push(_),this.outputs.push(S)}static interpolationFactor(t,s,u,h){let m=0;if(t.name==="exponential")m=Ws(s,t.base,u,h);else if(t.name==="linear")m=Ws(s,1,u,h);else if(t.name==="cubic-bezier"){const _=t.controlPoints;m=new Ph(_[0],_[1],_[2],_[3]).solve(Ws(s,1,u,h))}return m}static parse(t,s){let[u,h,m,..._]=t;if(!Array.isArray(h)||h.length===0)return s.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const A=h[1];if(typeof A!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:A}}else{if(h[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const A=h.slice(1);if(A.length!==4||A.some(D=>typeof D!="number"||D<0||D>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:A}}}if(t.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length-1>3&&(t.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(m=s.parse(m,2,Pn),!m)return null;const S=[];let E=null;u==="interpolate-hcl"||u==="interpolate-lab"?E=wo:s.expectedType&&s.expectedType.kind!=="value"&&(E=s.expectedType);for(let A=0;A<_.length;A+=2){const D=_[A],O=_[A+1],F=A+3,G=A+4;if(typeof D!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',F);if(S.length&&S[S.length-1][0]>=D)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',F);const W=s.parse(O,G,E);if(!W)return null;E=E||W.type,S.push([D,W])}return E.kind==="number"||E.kind==="color"||E.kind==="array"&&E.itemType.kind==="number"&&typeof E.N=="number"?new Os(E,u,h,m,S):s.error(`Type ${Is(E)} is not interpolatable.`)}evaluate(t){const s=this.labels,u=this.outputs;if(s.length===1)return u[0].evaluate(t);const h=this.input.evaluate(t);if(h<=s[0])return u[0].evaluate(t);const m=s.length;if(h>=s[m-1])return u[m-1].evaluate(t);const _=Hf(s,h),S=Os.interpolationFactor(this.interpolation,h,s[_],s[_+1]),E=u[_].evaluate(t),A=u[_+1].evaluate(t);return this.operator==="interpolate"?Pd[this.type.kind.toLowerCase()](E,A,S):this.operator==="interpolate-hcl"?es.reverse(es.interpolate(es.forward(E),es.forward(A),S)):da.reverse(da.interpolate(da.forward(E),da.forward(A),S))}eachChild(t){t(this.input);for(const s of this.outputs)t(s)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier",...this.interpolation.controlPoints];const s=[this.operator,t,this.input.serialize()];for(let u=0;u<this.labels.length;u++)s.push(this.labels[u],this.outputs[u].serialize());return s}}function Ws(a,t,s,u){const h=u-s,m=a-s;return h===0?0:t===1?m/h:(Math.pow(t,m)-1)/(Math.pow(t,h)-1)}class To{constructor(t,s){this.type=t,this.args=s}static parse(t,s){if(t.length<2)return s.error("Expectected at least one argument.");let u=null;const h=s.expectedType;h&&h.kind!=="value"&&(u=h);const m=[];for(const S of t.slice(1)){const E=s.parse(S,1+m.length,u,void 0,{typeAnnotation:"omit"});if(!E)return null;u=u||E.type,m.push(E)}const _=h&&m.some(S=>zh(h,S.type));return new To(_?Jr:u,m)}evaluate(t){let s,u=null,h=0;for(const m of this.args){if(h++,u=m.evaluate(t),u&&u instanceof Wo&&!u.available&&(s||(s=u),u=null,h===this.args.length))return s;if(u!==null)break}return u}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(s=>{t.push(s.serialize())}),t}}class Ml{constructor(t,s){this.type=s.type,this.bindings=[].concat(t),this.result=s}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const s of this.bindings)t(s[1]);t(this.result)}static parse(t,s){if(t.length<4)return s.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const u=[];for(let m=1;m<t.length-1;m+=2){const _=t[m];if(typeof _!="string")return s.error(`Expected string, but found ${typeof _} instead.`,m);if(/[^a-zA-Z0-9_]/.test(_))return s.error("Variable names must contain only alphanumeric characters or '_'.",m);const S=s.parse(t[m+1],m+1);if(!S)return null;u.push([_,S])}const h=s.parse(t[t.length-1],t.length-1,s.expectedType,u);return h?new Ml(u,h):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[s,u]of this.bindings)t.push(s,u.serialize());return t.push(this.result.serialize()),t}}class _c{constructor(t,s,u){this.type=t,this.index=s,this.input=u}static parse(t,s){if(t.length!==3)return s.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const u=s.parse(t[1],1,Pn),h=s.parse(t[2],2,So(s.expectedType||Jr));return u&&h?new _c(h.type.itemType,u,h):null}evaluate(t){const s=this.index.evaluate(t),u=this.input.evaluate(t);if(s<0)throw new gn(`Array index out of bounds: ${s} < 0.`);if(s>=u.length)throw new gn(`Array index out of bounds: ${s} > ${u.length-1}.`);if(s!==Math.floor(s))throw new gn(`Array index must be an integer, but found ${s} instead. Use at-interpolated to retrieve interpolated result with a fractional index.`);return u[s]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Eo{constructor(t,s,u){this.type=t,this.index=s,this.input=u}static parse(t,s){if(t.length!==3)return s.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const u=s.parse(t[1],1,Pn),h=s.parse(t[2],2,So(s.expectedType||Jr));return u&&h?new Eo(h.type.itemType,u,h):null}evaluate(t){const s=this.index.evaluate(t),u=this.input.evaluate(t);if(s<0)throw new gn(`Array index out of bounds: ${s} < 0.`);if(s>u.length-1)throw new gn(`Array index out of bounds: ${s} > ${u.length-1}.`);if(s===Math.floor(s))return u[s];const h=Math.floor(s),m=Math.ceil(s),_=u[h],S=u[m];if(typeof _!="number"||typeof S!="number")throw new gn(`Cannot interpolate between non-number values at index ${s}.`);const E=s-h;return _*(1-E)+S*E}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at-interpolated",this.index.serialize(),this.input.serialize()]}}class $d{constructor(t,s){this.type=ti,this.needle=t,this.haystack=s}static parse(t,s){if(t.length!==3)return s.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const u=s.parse(t[1],1,Jr),h=s.parse(t[2],2,Jr);return u&&h?rm(u.type,[ti,ui,Pn,ac,Jr])?new $d(u,h):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Is(u.type)} instead`):null}evaluate(t){const s=this.needle.evaluate(t),u=this.haystack.evaluate(t);if(u==null)return!1;if(!Uc(s,["boolean","string","number","null"]))throw new gn(`Expected first argument to be of type boolean, string, number or null, but found ${Is(ks(s))} instead.`);if(!Uc(u,["string","array"]))throw new gn(`Expected second argument to be of type array or string, but found ${Is(ks(u))} instead.`);return u.indexOf(s)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Xh{constructor(t,s,u){this.type=Pn,this.needle=t,this.haystack=s,this.fromIndex=u}static parse(t,s){if(t.length<=2||t.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const u=s.parse(t[1],1,Jr),h=s.parse(t[2],2,Jr);if(!u||!h)return null;if(!rm(u.type,[ti,ui,Pn,ac,Jr]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Is(u.type)} instead`);if(t.length===4){const m=s.parse(t[3],3,Pn);return m?new Xh(u,h,m):null}return new Xh(u,h)}evaluate(t){const s=this.needle.evaluate(t),u=this.haystack.evaluate(t);if(!Uc(s,["boolean","string","number","null"]))throw new gn(`Expected first argument to be of type boolean, string, number or null, but found ${Is(ks(s))} instead.`);if(!Uc(u,["string","array"]))throw new gn(`Expected second argument to be of type array or string, but found ${Is(ks(u))} instead.`);if(this.fromIndex){const h=this.fromIndex.evaluate(t);return u.indexOf(s,h)}return u.indexOf(s)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Wf{constructor(t,s,u,h,m,_){this.inputType=t,this.type=s,this.input=u,this.cases=h,this.outputs=m,this.otherwise=_}static parse(t,s){if(t.length<5)return s.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return s.error("Expected an even number of arguments.");let u,h;s.expectedType&&s.expectedType.kind!=="value"&&(h=s.expectedType);const m={},_=[];for(let A=2;A<t.length-1;A+=2){let D=t[A];const O=t[A+1];Array.isArray(D)||(D=[D]);const F=s.concat(A);if(D.length===0)return F.error("Expected at least one branch label.");for(const W of D){if(typeof W!="number"&&typeof W!="string")return F.error("Branch labels must be numbers or strings.");if(typeof W=="number"&&Math.abs(W)>Number.MAX_SAFE_INTEGER)return F.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof W=="number"&&Math.floor(W)!==W)return F.error("Numeric branch labels must be integer values.");if(u){if(F.checkSubtype(u,ks(W)))return null}else u=ks(W);if(m[String(W)]!==void 0)return F.error("Branch labels must be unique.");m[String(W)]=_.length}const G=s.parse(O,A,h);if(!G)return null;h=h||G.type,_.push(G)}const S=s.parse(t[1],1,Jr);if(!S)return null;const E=s.parse(t[t.length-1],t.length-1,h);return E?S.type.kind!=="value"&&s.concat(1).checkSubtype(u,S.type)?null:new Wf(u,h,S,m,_,E):null}evaluate(t){const s=this.input.evaluate(t);return(ks(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],s=Object.keys(this.cases).sort(),u=[],h={};for(const _ of s){const S=h[this.cases[_]];S===void 0?(h[this.cases[_]]=u.length,u.push([this.cases[_],[_]])):u[S][1].push(_)}const m=_=>this.inputType.kind==="number"?Number(_):_;for(const[_,S]of u)t.push(S.length===1?m(S[0]):S.map(m)),t.push(this.outputs[_].serialize());return t.push(this.otherwise.serialize()),t}}class Hu{constructor(t,s,u){this.type=t,this.branches=s,this.otherwise=u}static parse(t,s){if(t.length<4)return s.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return s.error("Expected an odd number of arguments.");let u;s.expectedType&&s.expectedType.kind!=="value"&&(u=s.expectedType);const h=[];for(let _=1;_<t.length-1;_+=2){const S=s.parse(t[_],_,ti);if(!S)return null;const E=s.parse(t[_+1],_+1,u);if(!E)return null;h.push([S,E]),u=u||E.type}const m=s.parse(t[t.length-1],t.length-1,u);return m?new Hu(u,h,m):null}evaluate(t){for(const[s,u]of this.branches)if(s.evaluate(t))return u.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[s,u]of this.branches)t(s),t(u);t(this.otherwise)}outputDefined(){return this.branches.every(([t,s])=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(s=>{t.push(s.serialize())}),t}}class Hd{constructor(t,s,u,h){this.type=t,this.input=s,this.beginIndex=u,this.endIndex=h}static parse(t,s){if(t.length<=2||t.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const u=s.parse(t[1],1,Jr),h=s.parse(t[2],2,Pn);if(!u||!h)return null;if(!rm(u.type,[So(Jr),ui,Jr]))return s.error(`Expected first argument to be of type array or string, but found ${Is(u.type)} instead`);if(t.length===4){const m=s.parse(t[3],3,Pn);return m?new Hd(u.type,u,h,m):null}return new Hd(u.type,u,h)}evaluate(t){const s=this.input.evaluate(t),u=this.beginIndex.evaluate(t);if(!Uc(s,["string","array"]))throw new gn(`Expected first argument to be of type array or string, but found ${Is(ks(s))} instead.`);if(this.endIndex){const h=this.endIndex.evaluate(t);return s.slice(u,h)}return s.slice(u)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function ha(a,t){return a==="=="||a==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Kh(a,t,s,u){return u.compare(t,s)===0}function yc(a,t,s){const u=a!=="=="&&a!=="!=";return class O4{constructor(m,_,S){this.type=ti,this.lhs=m,this.rhs=_,this.collator=S,this.hasUntypedArgument=m.type.kind==="value"||_.type.kind==="value"}static parse(m,_){if(m.length!==3&&m.length!==4)return _.error("Expected two or three arguments.");const S=m[0];let E=_.parse(m[1],1,Jr);if(!E)return null;if(!ha(S,E.type))return _.concat(1).error(`"${S}" comparisons are not supported for type '${Is(E.type)}'.`);let A=_.parse(m[2],2,Jr);if(!A)return null;if(!ha(S,A.type))return _.concat(2).error(`"${S}" comparisons are not supported for type '${Is(A.type)}'.`);if(E.type.kind!==A.type.kind&&E.type.kind!=="value"&&A.type.kind!=="value")return _.error(`Cannot compare types '${Is(E.type)}' and '${Is(A.type)}'.`);u&&(E.type.kind==="value"&&A.type.kind!=="value"?E=new zn(A.type,[E]):E.type.kind!=="value"&&A.type.kind==="value"&&(A=new zn(E.type,[A])));let D=null;if(m.length===4){if(E.type.kind!=="string"&&A.type.kind!=="string"&&E.type.kind!=="value"&&A.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(D=_.parse(m[3],3,ku),!D)return null}return new O4(E,A,D)}evaluate(m){const _=this.lhs.evaluate(m),S=this.rhs.evaluate(m);if(u&&this.hasUntypedArgument){const E=ks(_),A=ks(S);if(E.kind!==A.kind||E.kind!=="string"&&E.kind!=="number")throw new gn(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${E.kind}, ${A.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const E=ks(_),A=ks(S);if(E.kind!=="string"||A.kind!=="string")return t(m,_,S)}return this.collator?s(m,_,S,this.collator.evaluate(m)):t(m,_,S)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}serialize(){const m=[a];return this.eachChild(_=>{m.push(_.serialize())}),m}}}const Eg=yc("==",function(a,t,s){return t===s},Kh),ry=yc("!=",function(a,t,s){return t!==s},function(a,t,s,u){return!Kh(0,t,s,u)}),vc=yc("<",function(a,t,s){return t<s},function(a,t,s,u){return u.compare(t,s)<0}),Gu=yc(">",function(a,t,s){return t>s},function(a,t,s,u){return u.compare(t,s)>0}),Gd=yc("<=",function(a,t,s){return t<=s},function(a,t,s,u){return u.compare(t,s)<=0}),qf=yc(">=",function(a,t,s){return t>=s},function(a,t,s,u){return u.compare(t,s)>=0});class Wd{constructor(t,s,u,h,m,_){this.type=ui,this.number=t,this.locale=s,this.currency=u,this.unit=h,this.minFractionDigits=m,this.maxFractionDigits=_}static parse(t,s){if(t.length!==3)return s.error("Expected two arguments.");const u=s.parse(t[1],1,Pn);if(!u)return null;const h=t[2];if(typeof h!="object"||Array.isArray(h))return s.error("NumberFormat options argument must be an object.");let m=null;if(h.locale&&(m=s.parseObjectValue(h.locale,2,"locale",ui),!m))return null;let _=null;if(h.currency&&(_=s.parseObjectValue(h.currency,2,"currency",ui),!_))return null;let S=null;if(h.unit&&(S=s.parseObjectValue(h.unit,2,"unit",ui),!S))return null;let E=null;if(h["min-fraction-digits"]&&(E=s.parseObjectValue(h["min-fraction-digits"],2,"min-fraction-digits",Pn),!E))return null;let A=null;return h["max-fraction-digits"]&&(A=s.parseObjectValue(h["max-fraction-digits"],2,"max-fraction-digits",Pn),!A)?null:new Wd(u,m,_,S,E,A)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class No{constructor(t){this.type=Pn,this.input=t}static parse(t,s){if(t.length!==2)return s.error(`Expected 1 argument, but found ${t.length-1} instead.`);const u=s.parse(t[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${Is(u.type)} instead.`):new No(u):null}evaluate(t){const s=this.input.evaluate(t);if(typeof s=="string"||Array.isArray(s))return s.length;throw new gn(`Expected value to be of type string or array, but found ${Is(ks(s))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(s=>{t.push(s.serialize())}),t}}function fa(a){return function(){a=1831565813+(a|=0)|0;let t=Math.imul(a^a>>>15,1|a);return t=t+Math.imul(t^t>>>7,61|t)^t,((t^t>>>14)>>>0)/4294967296}}const pa={"==":Eg,"!=":ry,">":Gu,"<":vc,">=":qf,"<=":Gd,array:zn,at:_c,"at-interpolated":Eo,boolean:zn,case:Hu,coalesce:To,collator:Rd,format:zu,image:Fu,in:$d,"index-of":Xh,interpolate:Os,"interpolate-hcl":Os,"interpolate-lab":Os,length:No,let:Ml,literal:or,match:Wf,number:zn,"number-format":Wd,object:zn,slice:Hd,step:Vu,string:zn,"to-boolean":Ea,"to-color":Ea,"to-number":Ea,"to-string":Ea,var:Bd,within:Rl,distance:Bu,config:fc};function Ll(a,[t,s,u,h]){t=t.evaluate(a),s=s.evaluate(a),u=u.evaluate(a);const m=h?h.evaluate(a):1,_=xg(t,s,u,m);if(_)throw new gn(_);return new xr(t/255*m,s/255*m,u/255*m,m)}function Dl(a,[t,s,u,h]){t=t.evaluate(a),s=s.evaluate(a),u=u.evaluate(a);const m=h?h.evaluate(a):1,_=function(A,D,O,F){return typeof A=="number"&&A>=0&&A<=360?typeof D=="number"&&D>=0&&D<=100&&typeof O=="number"&&O>=0&&O<=100?F===void 0||typeof F=="number"&&F>=0&&F<=1?null:`Invalid hsla value [${[A,D,O,F].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof F=="number"?[A,D,O,F]:[A,D,O]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof F=="number"?[A,D,O,F]:[A,D,O]).join(", ")}]: 'h' must be between 0 and 360.`}(t,s,u,m);if(_)throw new gn(_);const S=`hsla(${t}, ${s}%, ${u}%, ${m})`,E=xr.parse(S);if(!E)throw new gn(`Failed to parse HSLA color: ${S}`);return E}function xc(a,t){return a in t}function Yh(a,t){const s=t[a];return s===void 0?null:s}function kl(a){return{type:a}}function Zf(a){return{result:"success",value:a}}function Ss(a){return{result:"error",value:a}}function Xo(a,t){return!!a&&!!a.parameters&&a.parameters.indexOf(t)>-1}function hs(a){return a["property-type"]==="data-driven"}function Ma(a){return Xo(a.expression,"measure-light")}function Xf(a){return Xo(a.expression,"zoom")}function Jh(a){return!!a.expression&&a.expression.interpolated}function qd(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function Kf(a){return a}function Qh(a,t){const s=t.type==="color",u=a.stops&&typeof a.stops[0][0]=="object",h=u||!(u||a.property!==void 0),m=a.type||(Jh(t)?"exponential":"interval");if(s&&((a=Du({},a)).stops&&(a.stops=a.stops.map(A=>[A[0],xr.parse(A[1])])),a.default=xr.parse(a.default?a.default:t.default)),a.colorSpace&&a.colorSpace!=="rgb"&&!ds[a.colorSpace])throw new Error(`Unknown color space: ${a.colorSpace}`);let _,S,E;if(m==="exponential")_=nl;else if(m==="interval")_=Zd;else if(m==="categorical"){_=_m,S=Object.create(null);for(const A of a.stops)S[A[0]]=A[1];E=typeof a.stops[0][0]}else{if(m!=="identity")throw new Error(`Unknown function type "${m}"`);_=iy}if(u){const A={},D=[];for(let G=0;G<a.stops.length;G++){const W=a.stops[G],Q=W[0].zoom;A[Q]===void 0&&(A[Q]={zoom:Q,type:a.type,property:a.property,default:a.default,stops:[]},D.push(Q)),A[Q].stops.push([W[0].value,W[1]])}const O=[];for(const G of D)O.push([A[G].zoom,Qh(A[G],t)]);const F={name:"linear"};return{kind:"composite",interpolationType:F,interpolationFactor:Os.interpolationFactor.bind(void 0,F),zoomStops:O.map(G=>G[0]),evaluate:({zoom:G},W)=>nl({stops:O,base:a.base},t,G).evaluate(G,W)}}if(h){const A=m==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:A,interpolationFactor:Os.interpolationFactor.bind(void 0,A),zoomStops:a.stops.map(D=>D[0]),evaluate:({zoom:D})=>_(a,t,D,S,E)}}return{kind:"source",evaluate(A,D){const O=D&&D.properties?D.properties[a.property]:void 0;return O===void 0?Ol(a.default,t.default):_(a,t,O,S,E)}}}function Ol(a,t,s){return a!==void 0?a:t!==void 0?t:s!==void 0?s:void 0}function _m(a,t,s,u,h){return Ol(typeof s===h?u[s]:void 0,a.default,t.default)}function Zd(a,t,s){if(Bn(s)!=="number")return Ol(a.default,t.default);const u=a.stops.length;if(u===1||s<=a.stops[0][0])return a.stops[0][1];if(s>=a.stops[u-1][0])return a.stops[u-1][1];const h=Hf(a.stops.map(m=>m[0]),s);return a.stops[h][1]}function nl(a,t,s){const u=a.base!==void 0?a.base:1;if(Bn(s)!=="number")return Ol(a.default,t.default);const h=a.stops.length;if(h===1||s<=a.stops[0][0])return a.stops[0][1];if(s>=a.stops[h-1][0])return a.stops[h-1][1];const m=Hf(a.stops.map(D=>D[0]),s),_=function(D,O,F,G){const W=G-F,Q=D-F;return W===0?0:O===1?Q/W:(Math.pow(O,Q)-1)/(Math.pow(O,W)-1)}(s,u,a.stops[m][0],a.stops[m+1][0]),S=a.stops[m][1],E=a.stops[m+1][1];let A=Pd[t.type]||Kf;if(a.colorSpace&&a.colorSpace!=="rgb"){const D=ds[a.colorSpace];A=(O,F)=>D.reverse(D.interpolate(D.forward(O),D.forward(F),_))}return typeof S.evaluate=="function"?{evaluate(...D){const O=S.evaluate.apply(void 0,D),F=E.evaluate.apply(void 0,D);if(O!==void 0&&F!==void 0)return A(O,F,_)}}:A(S,E,_)}function iy(a,t,s){return t.type==="color"?s=xr.parse(s):t.type==="formatted"?s=Oo.fromString(s.toString()):t.type==="resolvedImage"?s=Wo.build(s.toString()):Bn(s)===t.type||t.type==="enum"&&t.values[s]||(s=void 0),Ol(s,a.default,t.default)}Co.register(pa,{error:[{kind:"error"},[ui],(a,[t])=>{throw new gn(t.evaluate(a))}],typeof:[ui,[Jr],(a,[t])=>Is(ks(t.evaluate(a)))],"to-rgba":[So(Pn,4),[wo],(a,[t])=>t.evaluate(a).toRenderColor(null).toArray()],"to-hsla":[So(Pn,4),[wo],(a,[t])=>t.evaluate(a).toRenderColor(null).toHslaArray()],rgb:[wo,[Pn,Pn,Pn],Ll],rgba:[wo,[Pn,Pn,Pn,Pn],Ll],hsl:[wo,[Pn,Pn,Pn],Dl],hsla:[wo,[Pn,Pn,Pn,Pn],Dl],has:{type:ti,overloads:[[[ui],(a,[t])=>xc(t.evaluate(a),a.properties())],[[ui,Vc],(a,[t,s])=>xc(t.evaluate(a),s.evaluate(a))]]},get:{type:Jr,overloads:[[[ui],(a,[t])=>Yh(t.evaluate(a),a.properties())],[[ui,Vc],(a,[t,s])=>Yh(t.evaluate(a),s.evaluate(a))]]},"feature-state":[Jr,[ui],(a,[t])=>Yh(t.evaluate(a),a.featureState||{})],properties:[Vc,[],a=>a.properties()],"geometry-type":[ui,[],a=>a.geometryType()],id:[Jr,[],a=>a.id()],zoom:[Pn,[],a=>a.globals.zoom],pitch:[Pn,[],a=>a.globals.pitch||0],"distance-from-center":[Pn,[],a=>a.distanceFromCenter()],"measure-light":[Pn,[ui],(a,[t])=>a.measureLight(t.evaluate(a))],"heatmap-density":[Pn,[],a=>a.globals.heatmapDensity||0],"line-progress":[Pn,[],a=>a.globals.lineProgress||0],"raster-value":[Pn,[],a=>a.globals.rasterValue||0],"raster-particle-speed":[Pn,[],a=>a.globals.rasterParticleSpeed||0],"sky-radial-progress":[Pn,[],a=>a.globals.skyRadialProgress||0],accumulated:[Jr,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[Pn,kl(Pn),(a,t)=>{let s=0;for(const u of t)s+=u.evaluate(a);return s}],"*":[Pn,kl(Pn),(a,t)=>{let s=1;for(const u of t)s*=u.evaluate(a);return s}],"-":{type:Pn,overloads:[[[Pn,Pn],(a,[t,s])=>t.evaluate(a)-s.evaluate(a)],[[Pn],(a,[t])=>-t.evaluate(a)]]},"/":[Pn,[Pn,Pn],(a,[t,s])=>t.evaluate(a)/s.evaluate(a)],"%":[Pn,[Pn,Pn],(a,[t,s])=>t.evaluate(a)%s.evaluate(a)],ln2:[Pn,[],()=>Math.LN2],pi:[Pn,[],()=>Math.PI],e:[Pn,[],()=>Math.E],"^":[Pn,[Pn,Pn],(a,[t,s])=>Math.pow(t.evaluate(a),s.evaluate(a))],sqrt:[Pn,[Pn],(a,[t])=>Math.sqrt(t.evaluate(a))],log10:[Pn,[Pn],(a,[t])=>Math.log(t.evaluate(a))/Math.LN10],ln:[Pn,[Pn],(a,[t])=>Math.log(t.evaluate(a))],log2:[Pn,[Pn],(a,[t])=>Math.log(t.evaluate(a))/Math.LN2],sin:[Pn,[Pn],(a,[t])=>Math.sin(t.evaluate(a))],cos:[Pn,[Pn],(a,[t])=>Math.cos(t.evaluate(a))],tan:[Pn,[Pn],(a,[t])=>Math.tan(t.evaluate(a))],asin:[Pn,[Pn],(a,[t])=>Math.asin(t.evaluate(a))],acos:[Pn,[Pn],(a,[t])=>Math.acos(t.evaluate(a))],atan:[Pn,[Pn],(a,[t])=>Math.atan(t.evaluate(a))],min:[Pn,kl(Pn),(a,t)=>Math.min(...t.map(s=>s.evaluate(a)))],max:[Pn,kl(Pn),(a,t)=>Math.max(...t.map(s=>s.evaluate(a)))],abs:[Pn,[Pn],(a,[t])=>Math.abs(t.evaluate(a))],round:[Pn,[Pn],(a,[t])=>{const s=t.evaluate(a);return s<0?-Math.round(-s):Math.round(s)}],floor:[Pn,[Pn],(a,[t])=>Math.floor(t.evaluate(a))],ceil:[Pn,[Pn],(a,[t])=>Math.ceil(t.evaluate(a))],"filter-==":[ti,[ui,Jr],(a,[t,s])=>a.properties()[t.value]===s.value],"filter-id-==":[ti,[Jr],(a,[t])=>a.id()===t.value],"filter-type-==":[ti,[ui],(a,[t])=>a.geometryType()===t.value],"filter-<":[ti,[ui,Jr],(a,[t,s])=>{const u=a.properties()[t.value],h=s.value;return typeof u==typeof h&&u<h}],"filter-id-<":[ti,[Jr],(a,[t])=>{const s=a.id(),u=t.value;return typeof s==typeof u&&s<u}],"filter->":[ti,[ui,Jr],(a,[t,s])=>{const u=a.properties()[t.value],h=s.value;return typeof u==typeof h&&u>h}],"filter-id->":[ti,[Jr],(a,[t])=>{const s=a.id(),u=t.value;return typeof s==typeof u&&s>u}],"filter-<=":[ti,[ui,Jr],(a,[t,s])=>{const u=a.properties()[t.value],h=s.value;return typeof u==typeof h&&u<=h}],"filter-id-<=":[ti,[Jr],(a,[t])=>{const s=a.id(),u=t.value;return typeof s==typeof u&&s<=u}],"filter->=":[ti,[ui,Jr],(a,[t,s])=>{const u=a.properties()[t.value],h=s.value;return typeof u==typeof h&&u>=h}],"filter-id->=":[ti,[Jr],(a,[t])=>{const s=a.id(),u=t.value;return typeof s==typeof u&&s>=u}],"filter-has":[ti,[Jr],(a,[t])=>t.value in a.properties()],"filter-has-id":[ti,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[ti,[So(ui)],(a,[t])=>t.value.indexOf(a.geometryType())>=0],"filter-id-in":[ti,[So(Jr)],(a,[t])=>t.value.indexOf(a.id())>=0],"filter-in-small":[ti,[ui,So(Jr)],(a,[t,s])=>s.value.indexOf(a.properties()[t.value])>=0],"filter-in-large":[ti,[ui,So(Jr)],(a,[t,s])=>function(u,h,m,_){for(;m<=_;){const S=m+_>>1;if(h[S]===u)return!0;h[S]>u?_=S-1:m=S+1}return!1}(a.properties()[t.value],s.value,0,s.value.length-1)],all:{type:ti,overloads:[[[ti,ti],(a,[t,s])=>t.evaluate(a)&&s.evaluate(a)],[kl(ti),(a,t)=>{for(const s of t)if(!s.evaluate(a))return!1;return!0}]]},any:{type:ti,overloads:[[[ti,ti],(a,[t,s])=>t.evaluate(a)||s.evaluate(a)],[kl(ti),(a,t)=>{for(const s of t)if(s.evaluate(a))return!0;return!1}]]},"!":[ti,[ti],(a,[t])=>!t.evaluate(a)],"is-supported-script":[ti,[ui],(a,[t])=>{const s=a.globals&&a.globals.isSupportedScript;return!s||s(t.evaluate(a))}],upcase:[ui,[ui],(a,[t])=>t.evaluate(a).toUpperCase()],downcase:[ui,[ui],(a,[t])=>t.evaluate(a).toLowerCase()],concat:[ui,kl(Jr),(a,t)=>t.map(s=>zo(s.evaluate(a))).join("")],"resolved-locale":[ui,[ku],(a,[t])=>t.evaluate(a).resolvedLocale()],random:[Pn,[Pn,Pn,Jr],(a,t)=>{const[s,u,h]=t.map(_=>_.evaluate(a));if(s>u||s===u)return s;let m;if(typeof h=="string")m=function(_){let S=0;if(_.length===0)return S;for(let E=0;E<_.length;E++)S=(S<<5)-S+_.charCodeAt(E),S|=0;return S}(h);else{if(typeof h!="number")throw new gn(`Invalid seed input: ${h}`);m=h}return s+fa(m)()*(u-s)}]});class Wu{constructor(t,s,u,h){this.expression=t,this._warningHistory={},this._evaluator=new lc(u,h),this._defaultValue=s?function(m){return m.type==="color"&&(qd(m.default)||Array.isArray(m.default))?new xr(0,0,0,0):m.type==="color"?xr.parse(m.default)||null:m.default===void 0?null:m.default}(s):null,this._enumValues=s&&s.type==="enum"?s.values:null,this.configDependencies=jd(t)}evaluateWithoutErrorHandling(t,s,u,h,m,_,S,E){return this._evaluator.globals=t,this._evaluator.feature=s,this._evaluator.featureState=u,this._evaluator.canonical=h||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=_,this._evaluator.featureTileCoord=S||null,this._evaluator.featureDistanceData=E||null,this.expression.evaluate(this._evaluator)}evaluate(t,s,u,h,m,_,S,E){this._evaluator.globals=t,this._evaluator.feature=s||null,this._evaluator.featureState=u||null,this._evaluator.canonical=h||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=_||null,this._evaluator.featureTileCoord=S||null,this._evaluator.featureDistanceData=E||null;try{const A=this.expression.evaluate(this._evaluator);if(A==null||typeof A=="number"&&A!=A)return this._defaultValue;if(this._enumValues&&!(A in this._enumValues))throw new gn(`Expected value to be one of ${Object.keys(this._enumValues).map(D=>JSON.stringify(D)).join(", ")}, but found ${JSON.stringify(A)} instead.`);return A}catch(A){return this._warningHistory[A.message]||(this._warningHistory[A.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${A.message}`)),this._defaultValue}}}function qu(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in pa}function Zu(a,t,s,u){const h=new pm(pa,[],t?function(_){const S={color:wo,string:ui,number:Pn,enum:ui,boolean:ti,formatted:kh,resolvedImage:Oh};return _.type==="array"?So(S[_.value]||Jr,_.length):S[_.type]}(t):void 0,void 0,void 0,s,u),m=h.parse(a,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return m?Zf(new Wu(m,t,s,u)):Ss(h.errors)}class Qc{constructor(t,s,u,h){this.kind=t,this._styleExpression=s,this.isLightConstant=u,this.isLineProgressConstant=h,this.isStateDependent=t!=="constant"&&!Nd(s.expression),this.configDependencies=jd(s.expression)}evaluateWithoutErrorHandling(t,s,u,h,m,_){return this._styleExpression.evaluateWithoutErrorHandling(t,s,u,h,m,_)}evaluate(t,s,u,h,m,_){return this._styleExpression.evaluate(t,s,u,h,m,_)}}class rl{constructor(t,s,u,h,m,_){this.kind=t,this.zoomStops=u,this._styleExpression=s,this.isStateDependent=t!=="camera"&&!Nd(s.expression),this.isLightConstant=m,this.isLineProgressConstant=_,this.configDependencies=jd(s.expression),this.interpolationType=h}evaluateWithoutErrorHandling(t,s,u,h,m,_){return this._styleExpression.evaluateWithoutErrorHandling(t,s,u,h,m,_)}evaluate(t,s,u,h,m,_){return this._styleExpression.evaluate(t,s,u,h,m,_)}interpolationFactor(t,s,u){return this.interpolationType?Os.interpolationFactor(this.interpolationType,t,s,u):0}}function Xd(a,t,s,u){if((a=Zu(a,t,s,u)).result==="error")return a;const h=a.value.expression,m=Kc(h);if(!m&&!hs(t))return Ss([new ko("","data expressions not supported")]);const _=Yc(h,["zoom","pitch","distance-from-center"]);if(!_&&!Xf(t))return Ss([new ko("","zoom expressions not supported")]);const S=Yc(h,["measure-light"]);if(!S&&!Ma(t))return Ss([new ko("","measure-light expression not supported")]);const E=Yc(h,["line-progress"]);if(!E&&!function(O){return Xo(O.expression,"line-progress")}(t))return Ss([new ko("","line-progress expression not supported")]);const A=t.expression&&t.expression.relaxZoomRestriction,D=Xu(h);return D||_||A?D instanceof ko?Ss([D]):D instanceof Os&&!Jh(t)?Ss([new ko("",'"interpolate" expressions cannot be used with this property')]):Zf(D?new rl(m&&E?"camera":"composite",a.value,D.labels,D instanceof Os?D.interpolation:void 0,S,E):new Qc(m&&E?"constant":"source",a.value,S,E)):Ss([new ko("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class eu{constructor(t,s){this._parameters=t,this._specification=s,Du(this,Qh(this._parameters,this._specification))}static deserialize(t){return new eu(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Xu(a){let t=null;if(a instanceof Ml)t=Xu(a.result);else if(a instanceof To){for(const s of a.args)if(t=Xu(s),t)break}else(a instanceof Vu||a instanceof Os)&&a.input instanceof Co&&a.input.name==="zoom"&&(t=a);return t instanceof ko||a.eachChild(s=>{const u=Xu(s);u instanceof ko?t=u:t&&u&&t!==u&&(t=new ko("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}var tu,Kd,ef=function(){if(Kd)return tu;Kd=1,tu=t;var a=3;function t(s,u,h){var m=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;var _=new Int32Array(this.arrayBuffer);s=_[0],this.d=(u=_[1])+2*(h=_[2]);for(var S=0;S<this.d*this.d;S++){var E=_[a+S],A=_[a+S+1];m.push(E===A?null:_.subarray(E,A))}var D=_[a+m.length+1];this.keys=_.subarray(_[a+m.length],D),this.bboxes=_.subarray(D),this.insert=this._insertReadonly}else{this.d=u+2*h;for(var O=0;O<this.d*this.d;O++)m.push([]);this.keys=[],this.bboxes=[]}this.n=u,this.extent=s,this.padding=h,this.scale=u/s,this.uid=0;var F=h/u*s;this.min=-F,this.max=s+F}return t.prototype.insert=function(s,u,h,m,_){this._forEachCell(u,h,m,_,this._insertCell,this.uid++),this.keys.push(s),this.bboxes.push(u),this.bboxes.push(h),this.bboxes.push(m),this.bboxes.push(_)},t.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},t.prototype._insertCell=function(s,u,h,m,_,S){this.cells[_].push(S)},t.prototype.query=function(s,u,h,m,_){var S=this.min,E=this.max;if(s<=S&&u<=S&&E<=h&&E<=m&&!_)return Array.prototype.slice.call(this.keys);var A=[];return this._forEachCell(s,u,h,m,this._queryCell,A,{},_),A},t.prototype._queryCell=function(s,u,h,m,_,S,E,A){var D=this.cells[_];if(D!==null)for(var O=this.keys,F=this.bboxes,G=0;G<D.length;G++){var W=D[G];if(E[W]===void 0){var Q=4*W;(A?A(F[Q+0],F[Q+1],F[Q+2],F[Q+3]):s<=F[Q+2]&&u<=F[Q+3]&&h>=F[Q+0]&&m>=F[Q+1])?(E[W]=!0,S.push(O[W])):E[W]=!1}}},t.prototype._forEachCell=function(s,u,h,m,_,S,E,A){for(var D=this._convertToCellCoord(s),O=this._convertToCellCoord(u),F=this._convertToCellCoord(h),G=this._convertToCellCoord(m),W=D;W<=F;W++)for(var Q=O;Q<=G;Q++){var ae=this.d*Q+W;if((!A||A(this._convertFromCellCoord(W),this._convertFromCellCoord(Q),this._convertFromCellCoord(W+1),this._convertFromCellCoord(Q+1)))&&_.call(this,s,u,h,m,ae,S,E,A))return}},t.prototype._convertFromCellCoord=function(s){return(s-this.padding)/this.scale},t.prototype._convertToCellCoord=function(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))},t.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var s=this.cells,u=a+this.cells.length+1+1,h=0,m=0;m<this.cells.length;m++)h+=this.cells[m].length;var _=new Int32Array(u+h+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;for(var S=u,E=0;E<s.length;E++){var A=s[E];_[a+E]=S,_.set(A,S),S+=A.length}return _[a+s.length]=S,_.set(this.keys,S),_[a+s.length+1]=S+=this.keys.length,_.set(this.bboxes,S),S+=this.bboxes.length,_.buffer},tu}(),nu=Sa(ef);const Ku={};function un(a,t,s={}){Object.defineProperty(a,"_classRegistryKey",{value:t,writable:!1}),Ku[t]={klass:a,omit:s.omit||[]}}un(Object,"Object"),nu.serialize=function(a,t){const s=a.toArrayBuffer();return t&&t.add(s),{buffer:s}},nu.deserialize=function(a){return new nu(a.buffer)},Object.defineProperty(nu,"name",{value:"Grid"}),un(nu,"Grid"),typeof DOMMatrix<"u"&&un(DOMMatrix,"DOMMatrix"),un(xr,"Color"),un(Error,"Error"),un(Oo,"Formatted"),un(Bf,"FormattedSection"),un(Ja,"AJAXError"),un(Wo,"ResolvedImage"),un(eu,"StylePropertyFunction"),un(Wu,"StyleExpression",{omit:["_evaluator"]}),un(Go,"ImageId"),un(Ta,"ImageVariant"),un(rl,"ZoomDependentExpression"),un(Qc,"ZoomConstantExpression"),un(Co,"CompoundExpression",{omit:["_evaluate"]});for(const a in pa)Ku[pa[a]._classRegistryKey]||un(pa[a],`Expression${a}`);function jo(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function ma(a){return self.ImageBitmap&&a instanceof ImageBitmap}function zl(a,t){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp)return a;if(jo(a)||ma(a))return t&&t.add(a),a;if(ArrayBuffer.isView(a))return t&&t.add(a.buffer),a;if(a instanceof ImageData)return t&&t.add(a.data.buffer),a;if(Array.isArray(a)){const s=[];for(const u of a)s.push(zl(u,t));return s}if(a instanceof Map){const s={$name:"Map",entries:[]};for(const[u,h]of a.entries())s.entries.push(zl(u),zl(h,t));return s}if(a instanceof Set){const s={$name:"Set"};let u=0;for(const h of a.values())s[++u]=zl(h);return s}if(a instanceof DOMMatrix){const s={$name:"DOMMatrix"},u=["is2D","m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44","a","b","c","d","e","f"];for(const h of u)s[h]=a[h];return s}if(typeof a=="bigint")return{$name:"BigInt",value:a.toString()};if(typeof a=="object"){const s=a.constructor,u=s._classRegistryKey;if(!u)throw new Error(`Can't serialize object of unregistered class "${s.name}".`);const h=s.serialize?s.serialize(a,t):{};if(!s.serialize){for(const m in a)a.hasOwnProperty(m)&&(Ku[u].omit.indexOf(m)>=0||(h[m]=zl(a[m],t)));a instanceof Error&&(h.message=a.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return u!=="Object"&&(h.$name=u),h}throw new Error("can't serialize object of type "+typeof a)}function bc(a){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||jo(a)||ma(a)||ArrayBuffer.isView(a)||a instanceof ImageData)return a;if(Array.isArray(a))return a.map(bc);if(typeof a=="object"){const t=a.$name||"Object";if(t==="Map"){const h=a.entries||[],m=new Map;for(let _=0;_<h.length;_+=2)m.set(bc(h[_]),bc(h[_+1]));return m}if(t==="Set"){const h=new Set;for(const m of Object.keys(a))m!=="$name"&&h.add(bc(a[m]));return h}if(t==="DOMMatrix"){let h;return h=a.is2D?[a.a,a.b,a.c,a.d,a.e,a.f]:[a.m11,a.m12,a.m13,a.m14,a.m21,a.m22,a.m23,a.m24,a.m31,a.m32,a.m33,a.m34,a.m41,a.m42,a.m43,a.m44],new DOMMatrix(h)}if(t==="BigInt")return BigInt(a.value);const{klass:s}=Ku[t];if(!s)throw new Error(`Can't deserialize unregistered class "${t}".`);if(s.deserialize)return s.deserialize(a);const u=Object.create(s.prototype);for(const h of Object.keys(a))h!=="$name"&&(u[h]=bc(a[h]));return u}throw new Error("can't deserialize object of type "+typeof a)}const Ln={"Latin-1 Supplement":a=>a>=128&&a<=255,Arabic:a=>a>=1536&&a<=1791,"Arabic Supplement":a=>a>=1872&&a<=1919,"Arabic Extended-A":a=>a>=2208&&a<=2303,"Hangul Jamo":a=>a>=4352&&a<=4607,"Unified Canadian Aboriginal Syllabics":a=>a>=5120&&a<=5759,Khmer:a=>a>=6016&&a<=6143,"Unified Canadian Aboriginal Syllabics Extended":a=>a>=6320&&a<=6399,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"CJK Radicals Supplement":a=>a>=11904&&a<=12031,"Kangxi Radicals":a=>a>=12032&&a<=12255,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Hiragana:a=>a>=12352&&a<=12447,Katakana:a=>a>=12448&&a<=12543,Bopomofo:a=>a>=12544&&a<=12591,"Hangul Compatibility Jamo":a=>a>=12592&&a<=12687,Kanbun:a=>a>=12688&&a<=12703,"Bopomofo Extended":a=>a>=12704&&a<=12735,"CJK Strokes":a=>a>=12736&&a<=12783,"Katakana Phonetic Extensions":a=>a>=12784&&a<=12799,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"CJK Unified Ideographs Extension A":a=>a>=13312&&a<=19903,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"CJK Unified Ideographs":a=>a>=19968&&a<=40959,"Yi Syllables":a=>a>=40960&&a<=42127,"Yi Radicals":a=>a>=42128&&a<=42191,"Hangul Jamo Extended-A":a=>a>=43360&&a<=43391,"Hangul Syllables":a=>a>=44032&&a<=55215,"Hangul Jamo Extended-B":a=>a>=55216&&a<=55295,"Private Use Area":a=>a>=57344&&a<=63743,"CJK Compatibility Ideographs":a=>a>=63744&&a<=64255,"Arabic Presentation Forms-A":a=>a>=64336&&a<=65023,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Arabic Presentation Forms-B":a=>a>=65136&&a<=65279,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519,Osage:a=>a>=66736&&a<=66815,"CJK Unified Ideographs Extension B":a=>a>=131072&&a<=173791};function Fl(a){for(const t of a)if(ga(t.charCodeAt(0)))return!0;return!1}function ym(a){for(const t of a)if(!vm(t.charCodeAt(0)))return!1;return!0}function vm(a){return!(Ln.Arabic(a)||Ln["Arabic Supplement"](a)||Ln["Arabic Extended-A"](a)||Ln["Arabic Presentation Forms-A"](a)||Ln["Arabic Presentation Forms-B"](a))}function ga(a){return!(a!==746&&a!==747&&(a<4352||!(Ln["Bopomofo Extended"](a)||Ln.Bopomofo(a)||Ln["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||Ln["CJK Compatibility Ideographs"](a)||Ln["CJK Compatibility"](a)||Ln["CJK Radicals Supplement"](a)||Ln["CJK Strokes"](a)||!(!Ln["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||Ln["CJK Unified Ideographs Extension A"](a)||Ln["CJK Unified Ideographs"](a)||Ln["Enclosed CJK Letters and Months"](a)||Ln["Hangul Compatibility Jamo"](a)||Ln["Hangul Jamo Extended-A"](a)||Ln["Hangul Jamo Extended-B"](a)||Ln["Hangul Jamo"](a)||Ln["Hangul Syllables"](a)||Ln.Hiragana(a)||Ln["Ideographic Description Characters"](a)||Ln.Kanbun(a)||Ln["Kangxi Radicals"](a)||Ln["Katakana Phonetic Extensions"](a)||Ln.Katakana(a)&&a!==12540||!(!Ln["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!Ln["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||Ln["Unified Canadian Aboriginal Syllabics"](a)||Ln["Unified Canadian Aboriginal Syllabics Extended"](a)||Ln["Vertical Forms"](a)||Ln["Yijing Hexagram Symbols"](a)||Ln["Yi Syllables"](a)||Ln["Yi Radicals"](a))))}function wc(a){return!(ga(a)||function(t){return!!(Ln["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Ln["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Ln["Letterlike Symbols"](t)||Ln["Number Forms"](t)||Ln["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Ln["Control Pictures"](t)&&t!==9251||Ln["Optical Character Recognition"](t)||Ln["Enclosed Alphanumerics"](t)||Ln["Geometric Shapes"](t)||Ln["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Ln["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Ln["CJK Symbols and Punctuation"](t)||Ln.Katakana(t)||Ln["Private Use Area"](t)||Ln["CJK Compatibility Forms"](t)||Ln["Small Form Variants"](t)||Ln["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(a))}function Yf(a){return Ln.Arabic(a)||Ln["Arabic Supplement"](a)||Ln["Arabic Extended-A"](a)||Ln["Arabic Presentation Forms-A"](a)||Ln["Arabic Presentation Forms-B"](a)}function xm(a){return a>=1424&&a<=2303||Ln["Arabic Presentation Forms-A"](a)||Ln["Arabic Presentation Forms-B"](a)}function Jf(a,t){return!(!t&&xm(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||Ln.Khmer(a))}function Ig(a){for(const t of a)if(xm(t.charCodeAt(0)))return!0;return!1}const Yu="deferred",La="loading",Ju="loaded";let Qu=null,qs="unavailable",Nl=null;const Da=function(a){a&&typeof a=="string"&&a.indexOf("NetworkError")>-1&&(qs="error"),Qu&&Qu(a)};function tf(){Yd.fire(new Tl("pluginStateChange",{pluginStatus:qs,pluginURL:Nl}))}const Yd=new Il,as=function(){return qs},nf=function(){if(qs!==Yu||!Nl)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");qs=La,tf(),Nl&&Sl({url:Nl},a=>{a?Da(a):(qs=Ju,tf())})},ea={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>qs===Ju||ea.applyArabicShaping!=null,isLoading:()=>qs===La,setState(a){qs=a.pluginStatus,Nl=a.pluginURL},isParsed:()=>ea.applyArabicShaping!=null&&ea.processBidirectionalText!=null&&ea.processStyledBidirectionalText!=null,getPluginURL:()=>Nl};class ni{constructor(t,s){this.zoom=t,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.transition=s.transition,this.pitch=s.pitch,this.brightness=s.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(t){return function(s,u){for(const h of s)if(!Jf(h.charCodeAt(0),u))return!1;return!0}(t,ea.isLoaded())}}class ru{constructor(t,s,u,h){this.property=t,this.value=s,this.expression=function(m,_,S,E){if(qd(m))return new eu(m,_);if(qu(m)||Array.isArray(m)&&m.length>0){const A=Xd(m,_,S,E);if(A.result==="error")throw new Error(A.value.map(D=>`${D.key}: ${D.message}`).join(", "));return A.value}{let A=m;return typeof m=="string"&&_.type==="color"&&(A=xr.parse(m)),{kind:"constant",configDependencies:new Set,evaluate:()=>A}}}(s===void 0?t.specification.default:s,t.specification,u,h)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,s,u){return this.property.possiblyEvaluate(this,t,s,u)}}class jl{constructor(t,s,u){this.property=t,this.value=new ru(t,void 0,s,u)}transitioned(t,s){return new Ps(this.property,this.value,s,ft({},t.transition,this.transition),t.now)}untransitioned(){return new Ps(this.property,this.value,null,{},0)}}class iu{constructor(t,s,u){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues),this._scope=s,this._options=u,this.configDependencies=new Set}getValue(t){return pr(this._values[t].value.value)}setValue(t,s){this._values.hasOwnProperty(t)||(this._values[t]=new jl(this._values[t].property,this._scope,this._options)),this._values[t].value=new ru(this._values[t].property,s===null?void 0:pr(s),this._scope,this._options),this._values[t].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[t].value.expression.configDependencies]))}setTransitionOrValue(t,s){s&&(this._options=s);const u=this._properties.properties;if(t)for(const h in t){const m=t[h];if(h.endsWith("-transition")){const _=h.slice(0,-11);u[_]&&this.setTransition(_,m)}else u.hasOwnProperty(h)&&this.setValue(h,m)}}getTransition(t){return pr(this._values[t].transition)}setTransition(t,s){this._values.hasOwnProperty(t)||(this._values[t]=new jl(this._values[t].property)),this._values[t].transition=pr(s)||void 0}serialize(){const t={};for(const s of Object.keys(this._values)){const u=this.getValue(s);u!==void 0&&(t[s]=u);const h=this.getTransition(s);h!==void 0&&(t[`${s}-transition`]=h)}return t}transitioned(t,s){const u=new Zs(this._properties);for(const h of Object.keys(this._values))u._values[h]=this._values[h].transitioned(t,s._values[h]);return u}untransitioned(){const t=new Zs(this._properties);for(const s of Object.keys(this._values))t._values[s]=this._values[s].untransitioned();return t}}class Ps{constructor(t,s,u,h,m){const _=h.delay||0,S=h.duration||0;m=m||0,this.property=t,this.value=s,this.begin=m+_,this.end=this.begin+S,t.specification.transition&&(h.delay||h.duration)&&(this.prior=u)}possiblyEvaluate(t,s,u){const h=t.now||0,m=this.value.possiblyEvaluate(t,s,u),_=this.prior;if(_){if(h>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(h<this.begin)return _.possiblyEvaluate(t,s,u);{const S=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(t,s,u),m,Be(S))}}return m}}class Zs{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,s,u){const h=new il(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(t,s,u);return h}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class fo{constructor(t,s,u){this._properties=t,this._values=Object.create(t.defaultPropertyValues),this._scope=s,this._options=u,this.configDependencies=new Set}getValue(t){return pr(this._values[t].value)}setValue(t,s){this._values[t]=new ru(this._values[t].property,s===null?void 0:pr(s),this._scope,this._options),this._values[t].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[t].expression.configDependencies]))}serialize(){const t={};for(const s of Object.keys(this._values)){const u=this.getValue(s);u!==void 0&&(t[s]=u)}return t}possiblyEvaluate(t,s,u){const h=new il(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(t,s,u);return h}}class Sc{constructor(t,s,u){this.property=t,this.value=s,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,s,u,h){return this.property.evaluate(this.value,this.parameters,t,s,u,h)}}class il{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Xt{constructor(t){this.specification=t}possiblyEvaluate(t,s){return t.expression.evaluate(s)}interpolate(t,s,u){const h=Pd[this.specification.type];return h?h(t,s,u):t}}class fn{constructor(t,s){this.specification=t,this.overrides=s}possiblyEvaluate(t,s,u,h){return new Sc(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(s,null,{},u,h)}:t.expression,s)}interpolate(t,s,u){if(t.value.kind!=="constant"||s.value.kind!=="constant")return t;if(t.value.value===void 0||s.value.value===void 0)return new Sc(this,{kind:"constant",value:void 0},t.parameters);const h=Pd[this.specification.type];return h?new Sc(this,{kind:"constant",value:h(t.value.value,s.value.value,u)},t.parameters):t}evaluate(t,s,u,h,m,_){return t.kind==="constant"?t.value:t.evaluate(s,u,h,m,_)}}class zs{constructor(t){this.specification=t}possiblyEvaluate(t,s,u,h){return!!t.expression.evaluate(s,null,{},u,h)}interpolate(){return!1}}class $i{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const s=new ni(0,{});for(const u in t){const h=t[u];h.specification.overridable&&this.overridableProperties.push(u);const m=this.defaultPropertyValues[u]=new ru(h,void 0),_=this.defaultTransitionablePropertyValues[u]=new jl(h);this.defaultTransitioningPropertyValues[u]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=m.possiblyEvaluate(s)}}}un(fn,"DataDrivenProperty"),un(Xt,"DataConstantProperty"),un(zs,"ColorRampProperty");var ut=JSON.parse('{"$version":8,"$root":{"version":{"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow"},"rain":{"type":"rain"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor"},"imports":{"type":"array","value":"import"},"iconsets":{"type":"iconsets"},"schema":{"type":"schema"},"sources":{"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"type":"featuresets"}},"featuresets":{"*":{"type":"featureset"}},"featureset":{"metadata":{"type":"*"},"selectors":{"type":"array","value":"selector"}},"selector":{"layer":{"type":"string"},"properties":{"type":"selectorProperty"},"featureNamespace":{"type":"string"},"_uniqueFeatureID":{"type":"boolean"}},"selectorProperty":{"*":{"type":"*"}},"model":{"type":"string"},"import":{"id":{"type":"string"},"url":{"type":"string"},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","expression":{}},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string"},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false},"shadow-quality":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]}},"shadow-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"iconsets":{"*":{"type":"iconset"}},"iconset":["iconset_sprite","iconset_source"],"iconset_sprite":{"type":{"type":"enum","values":{"sprite":1}},"url":{"type":"string"}},"iconset_source":{"type":{"type":"enum","values":{"source":1}},"source":{"type":"string"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"type":"enum","values":{"video":1}},"urls":{"type":"array","value":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"type":"enum","values":{"image":1}},"url":{"type":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string"},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"building":{},"raster":{},"raster-particle":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{},"clip":{}}},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_building","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{}},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","expression":{}},"fill-construct-bridge-guard-rail":{"type":"boolean","default":"true","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-extrusion-edge-radius":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}}},"layout_building":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"building-roof-shape":{"type":"enum","values":{"flat":1,"hipped":1,"gabled":1,"parapet":1,"mansard":1,"skillion":1,"pyramidal":1},"default":"flat","expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"},"building-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","expression":{}},"line-cross-slope":{"type":"number","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","expression":{"parameters":["zoom"]}}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]}},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]}},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]}},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","expression":{"parameters":["zoom"]}},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]}},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]}},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_building":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*"}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","default":0.4,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","default":0.71,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","default":0.57,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","default":0.7,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective"}},"colorTheme":{"data":{"type":"string","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","expression":{}},"buildingFeaturesetId":{"type":"string","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator"},"center":{"type":"array","length":2,"value":"number","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string"},"exaggeration":{"type":"number","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_building","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"transition":true},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-bridge-guard-rail-color":{"type":"color","default":"rgba(241, 236, 225, 255)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"},"fill-tunnel-structure-color":{"type":"color","default":"rgba(241, 236, 225, 255)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"transition":true},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"flat"},"fill-extrusion-base-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"terrain"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"type":"color","default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true}},"paint_building":{"building-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-ambient-occlusion-wall-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-cast-shadows":{"type":"boolean","default":true},"building-color":{"type":"color","default":"rgba(193, 154, 127, 1)","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"property-type":"data-driven"},"building-emissive-strength":{"type":"number","default":0,"minimum":0,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"transition":true},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]}},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1]},"line-trim-fade-range":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-trim-color":{"type":"color","default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-border-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]}},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-image-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{}},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]}},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]}},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"raster-array-band":{"type":"string"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string"},"raster-particle-count":{"type":"number","default":512,"minimum":1},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]}},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]}},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]}},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]}},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]}},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]}},"sky-atmosphere-halo-color":{"type":"color","default":"white"},"sky-atmosphere-color":{"type":"color","default":"white"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d"},"model-cast-shadows":{"type":"boolean","default":true},"model-receive-shadows":{"type":"boolean","default":true},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"model-front-cutoff":{"type":"array","value":"number","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"promoteId":{"*":{"type":"*"}}}');function _a(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function ya(a){if(Array.isArray(a))return a.map(ya);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const t={};for(const s in a)t[s]=ya(a[s]);return t}return _a(a)}function Ko(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const t of a.slice(1))if(!Ko(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}function ed(a,t="",s=null,u="fill"){if(a==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Ko(a)||(a=rf(a));const h=a;let m=!0;try{m=function(D){if(!td(D))return D;let O=ya(D);return ep(O),O=Qf(O),O}(h)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(h,null,2)}
        `)}let _=null,S=null;if(u!=="background"&&u!=="sky"&&u!=="slot"){S=ut[`filter_${u}`];const D=Zu(m,S,t,s);if(D.result==="error")throw new Error(D.value.map(O=>`${O.key}: ${O.message}`).join(", "));_=(O,F,G)=>D.value.evaluate(O,F,{},G)}let E=null,A=null;if(m!==h){const D=Zu(h,S,t,s);if(D.result==="error")throw new Error(D.value.map(O=>`${O.key}: ${O.message}`).join(", "));E=(O,F,G,W,Q)=>D.value.evaluate(O,F,{},G,void 0,void 0,W,Q),A=!Kc(D.value.expression)}return{filter:_,dynamicFilter:E||void 0,needGeometry:bm(m),needFeature:!!A}}function Qf(a){if(!Array.isArray(a))return a;const t=function(s){if(Pg.has(s[0])){for(let u=1;u<s.length;u++)if(td(s[u]))return!0}return s}(a);return t===!0?t:t.map(s=>Qf(s))}function ep(a){let t=!1;const s=[];if(a[0]==="case"){for(let u=1;u<a.length-1;u+=2)t=t||td(a[u]),s.push(a[u+1]);s.push(a[a.length-1])}else if(a[0]==="match"){t=t||td(a[1]);for(let u=2;u<a.length-1;u+=2)s.push(a[u+1]);s.push(a[a.length-1])}else if(a[0]==="step"){t=t||td(a[1]);for(let u=1;u<a.length-1;u+=2)s.push(a[u+1])}t&&(a.length=0,a.push("any",...s));for(let u=1;u<a.length;u++)ep(a[u])}function td(a){if(!Array.isArray(a))return!1;if((t=a[0])==="pitch"||t==="distance-from-center")return!0;var t;for(let s=1;s<a.length;s++)if(td(a[s]))return!0;return!1}const Pg=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Ag(a,t){return a<t?-1:a>t?1:0}function bm(a){if(!Array.isArray(a))return!1;if(a[0]==="within"||a[0]==="distance")return!0;for(let t=1;t<a.length;t++)if(bm(a[t]))return!0;return!1}function rf(a){if(!a)return!0;const t=a[0];return a.length<=1?t!=="any":t==="=="?tp(a[1],a[2],"=="):t==="!="?su(tp(a[1],a[2],"==")):t==="<"||t===">"||t==="<="||t===">="?tp(a[1],a[2],t):t==="any"?(s=a.slice(1),["any"].concat(s.map(rf))):t==="all"?["all"].concat(a.slice(1).map(rf)):t==="none"?["all"].concat(a.slice(1).map(rf).map(su)):t==="in"?np(a[1],a.slice(2)):t==="!in"?su(np(a[1],a.slice(2))):t==="has"?wm(a[1]):t!=="!has"||su(wm(a[1]));var s}function tp(a,t,s){switch(a){case"$type":return[`filter-type-${s}`,t];case"$id":return[`filter-id-${s}`,t];default:return[`filter-${s}`,a,t]}}function np(a,t){if(t.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(s=>typeof s!=typeof t[0])?["filter-in-large",a,["literal",t.sort(Ag)]]:["filter-in-small",a,["literal",t]]}}function wm(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function su(a){return["!",a]}const Jd="";function Bl(a,t){return t?`${a}${Jd}${t}`:a}const Qd="-transition",Cc=new Set(["fill","line","background","hillshade","raster"]);class po extends Il{constructor(t,s,u,h,m){if(super(),this.id=t.id,this.fqid=Bl(this.id,u),this.type=t.type,this.scope=u,this.lut=h,this.options=m,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,t.type!=="custom"){if(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type&&t.type!=="background"&&t.type!=="sky"&&t.type!=="slot"){this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter;const _=Zu(this.filter,ut[`filter_${t.type}`]);_.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,..._.value.configDependencies]))}if(t.slot&&(this.slot=t.slot),s.layout&&(this._unevaluatedLayout=new fo(s.layout,this.scope,m),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),s.paint){this._transitionablePaint=new iu(s.paint,this.scope,m);for(const _ in t.paint)this.setPaintProperty(_,t.paint[_]);for(const _ in t.layout)this.setLayoutProperty(_,t.layout[_]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new il(s.paint)}}}onAdd(t){}onRemove(t){}isDraped(t){return!this.is3D(!0)&&Cc.has(this.type)}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,s){if(this.type==="custom"&&t==="visibility")return void(this.visibility=s);const u=this._unevaluatedLayout;u._properties.properties[t]&&(u.setValue(t,s),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),t==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(t){return t.endsWith(Qd)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,s){const u=this._transitionablePaint,h=u._properties.properties;if(t.endsWith(Qd)){const O=t.slice(0,-11);return h[O]&&u.setTransition(O,s||void 0),!1}if(!h[t])return!1;const m=u._values[t],_=m.value.isDataDriven(),S=m.value;u.setValue(t,s),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),this._handleSpecialPaintPropertyUpdate(t);const E=u._values[t].value,A=E.isDataDriven(),D=t.endsWith("pattern")||t==="line-dasharray";return A||_||D||this._handleOverridablePaintPropertyUpdate(t,S,E)}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getDefaultProgramParams(t,s,u){return null}_handleOverridablePaintPropertyUpdate(t,s,u){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,s){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,s)}serialize(){return rr({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(t,s)=>!(t===void 0||s==="layout"&&!Object.keys(t).length||s==="paint"&&!Object.keys(t).length))}is3D(t){return!1}hasElevation(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const t in this.paint._values){const s=this.paint.get(t);if(s instanceof Sc&&hs(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}compileFilter(t){this._filterCompiled||(this._featureFilter=ed(this.filter,this.scope,t),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(t){this._stats&&(t.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(t){}queryIntersectsFeature(t,s,u,h,m,_,S,E,A){}}const Rg={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class eh{constructor(t,s){this._structArray=t,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ii{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,s){return t._trim(),s&&(t.isTransferred=!0,s.add(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const s=Object.create(this.prototype);return s.arrayBuffer=t.arrayBuffer,s.length=t.length,s.capacity=t.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...t){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...t){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Vr(a,t=1){let s=0,u=0;return{members:a.map(h=>{const m=Rg[h.type].BYTES_PER_ELEMENT,_=s=sf(s,Math.max(t,m)),S=h.components||1;return u=Math.max(u,m),s+=m*S,{name:h.name,type:h.type,components:S,offset:_}}),size:sf(s,Math.max(u,t)),alignment:t}}function sf(a,t){return Math.ceil(a/t)*t}class Vl extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s){const u=this.length;return this.resize(u+1),this.emplace(u,t,s)}emplace(t,s,u){const h=2*t;return this.int16[h+0]=s,this.int16[h+1]=u,t}}Vl.prototype.bytesPerElement=4,un(Vl,"StructArrayLayout2i4");class of extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,u){const h=this.length;return this.resize(h+1),this.emplace(h,t,s,u)}emplace(t,s,u,h){const m=3*t;return this.int16[m+0]=s,this.int16[m+1]=u,this.int16[m+2]=h,t}}of.prototype.bytesPerElement=6,un(of,"StructArrayLayout3i6");class ou extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,u,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,s,u,h)}emplace(t,s,u,h,m){const _=4*t;return this.int16[_+0]=s,this.int16[_+1]=u,this.int16[_+2]=h,this.int16[_+3]=m,t}}ou.prototype.bytesPerElement=8,un(ou,"StructArrayLayout4i8");class th extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const s=this.length;return this.resize(s+1),this.emplace(s,t)}emplace(t,s){return this.float32[1*t+0]=s,t}}th.prototype.bytesPerElement=4,un(th,"StructArrayLayout1f4");class af extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,u){const h=this.length;return this.resize(h+1),this.emplace(h,t,s,u)}emplace(t,s,u,h){const m=4*t,_=2*t;return this.int16[m+0]=s,this.int16[m+1]=u,this.float32[_+1]=h,t}}af.prototype.bytesPerElement=8,un(af,"StructArrayLayout2i1f8");class nh extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,u){const h=this.length;return this.resize(h+1),this.emplace(h,t,s,u)}emplace(t,s,u,h){const m=4*t;return this.int16[m+0]=s,this.int16[m+1]=u,this.int16[m+2]=h,t}}nh.prototype.bytesPerElement=8,un(nh,"StructArrayLayout3i8");class Sm extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,u,h,m){const _=this.length;return this.resize(_+1),this.emplace(_,t,s,u,h,m)}emplace(t,s,u,h,m,_){const S=5*t;return this.int16[S+0]=s,this.int16[S+1]=u,this.int16[S+2]=h,this.int16[S+3]=m,this.int16[S+4]=_,t}}Sm.prototype.bytesPerElement=10,un(Sm,"StructArrayLayout5i10");class rp extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,u,h,m,_,S){const E=this.length;return this.resize(E+1),this.emplace(E,t,s,u,h,m,_,S)}emplace(t,s,u,h,m,_,S,E){const A=6*t,D=12*t,O=3*t;return this.int16[A+0]=s,this.int16[A+1]=u,this.uint8[D+4]=h,this.uint8[D+5]=m,this.uint8[D+6]=_,this.uint8[D+7]=S,this.float32[O+2]=E,t}}rp.prototype.bytesPerElement=12,un(rp,"StructArrayLayout2i4ub1f12");class sl extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,u){const h=this.length;return this.resize(h+1),this.emplace(h,t,s,u)}emplace(t,s,u,h){const m=3*t;return this.float32[m+0]=s,this.float32[m+1]=u,this.float32[m+2]=h,t}}sl.prototype.bytesPerElement=12,un(sl,"StructArrayLayout3f12");class Ul extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,u,h,m){const _=this.length;return this.resize(_+1),this.emplace(_,t,s,u,h,m)}emplace(t,s,u,h,m,_){const S=6*t,E=3*t;return this.uint16[S+0]=s,this.uint16[S+1]=u,this.uint16[S+2]=h,this.uint16[S+3]=m,this.float32[E+2]=_,t}}Ul.prototype.bytesPerElement=12,un(Ul,"StructArrayLayout4ui1f12");class nd extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s,u,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,s,u,h)}emplace(t,s,u,h,m){const _=4*t;return this.uint16[_+0]=s,this.uint16[_+1]=u,this.uint16[_+2]=h,this.uint16[_+3]=m,t}}nd.prototype.bytesPerElement=8,un(nd,"StructArrayLayout4ui8");class rd extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,u,h,m,_){const S=this.length;return this.resize(S+1),this.emplace(S,t,s,u,h,m,_)}emplace(t,s,u,h,m,_,S){const E=6*t;return this.int16[E+0]=s,this.int16[E+1]=u,this.int16[E+2]=h,this.int16[E+3]=m,this.int16[E+4]=_,this.int16[E+5]=S,t}}rd.prototype.bytesPerElement=12,un(rd,"StructArrayLayout6i12");class rh extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s,u,h,m,_,S,E,A,D,O,F){const G=this.length;return this.resize(G+1),this.emplace(G,t,s,u,h,m,_,S,E,A,D,O,F)}emplace(t,s,u,h,m,_,S,E,A,D,O,F,G){const W=12*t;return this.int16[W+0]=s,this.int16[W+1]=u,this.int16[W+2]=h,this.int16[W+3]=m,this.uint16[W+4]=_,this.uint16[W+5]=S,this.uint16[W+6]=E,this.uint16[W+7]=A,this.int16[W+8]=D,this.int16[W+9]=O,this.int16[W+10]=F,this.int16[W+11]=G,t}}rh.prototype.bytesPerElement=24,un(rh,"StructArrayLayout4i4ui4i24");class Yo extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,u,h,m,_){const S=this.length;return this.resize(S+1),this.emplace(S,t,s,u,h,m,_)}emplace(t,s,u,h,m,_,S){const E=10*t,A=5*t;return this.int16[E+0]=s,this.int16[E+1]=u,this.int16[E+2]=h,this.float32[A+2]=m,this.float32[A+3]=_,this.float32[A+4]=S,t}}Yo.prototype.bytesPerElement=20,un(Yo,"StructArrayLayout3i3f20");class Xs extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,u,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,s,u,h)}emplace(t,s,u,h,m){const _=4*t;return this.float32[_+0]=s,this.float32[_+1]=u,this.float32[_+2]=h,this.float32[_+3]=m,t}}Xs.prototype.bytesPerElement=16,un(Xs,"StructArrayLayout4f16");class lf extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const s=this.length;return this.resize(s+1),this.emplace(s,t)}emplace(t,s){return this.uint32[1*t+0]=s,t}}lf.prototype.bytesPerElement=4,un(lf,"StructArrayLayout1ul4");class ol extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s){const u=this.length;return this.resize(u+1),this.emplace(u,t,s)}emplace(t,s,u){const h=2*t;return this.uint16[h+0]=s,this.uint16[h+1]=u,t}}ol.prototype.bytesPerElement=4,un(ol,"StructArrayLayout2ui4");class ip extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s,u,h,m,_,S,E,A,D,O,F,G){const W=this.length;return this.resize(W+1),this.emplace(W,t,s,u,h,m,_,S,E,A,D,O,F,G)}emplace(t,s,u,h,m,_,S,E,A,D,O,F,G,W){const Q=20*t,ae=10*t;return this.int16[Q+0]=s,this.int16[Q+1]=u,this.int16[Q+2]=h,this.int16[Q+3]=m,this.int16[Q+4]=_,this.float32[ae+3]=S,this.float32[ae+4]=E,this.float32[ae+5]=A,this.float32[ae+6]=D,this.int16[Q+14]=O,this.uint32[ae+8]=F,this.uint16[Q+18]=G,this.uint16[Q+19]=W,t}}ip.prototype.bytesPerElement=40,un(ip,"StructArrayLayout5i4f1i1ul2ui40");class cf extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,u,h,m,_,S){const E=this.length;return this.resize(E+1),this.emplace(E,t,s,u,h,m,_,S)}emplace(t,s,u,h,m,_,S,E){const A=8*t;return this.int16[A+0]=s,this.int16[A+1]=u,this.int16[A+2]=h,this.int16[A+4]=m,this.int16[A+5]=_,this.int16[A+6]=S,this.int16[A+7]=E,t}}cf.prototype.bytesPerElement=16,un(cf,"StructArrayLayout3i2i2i16");class ih extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,u,h,m){const _=this.length;return this.resize(_+1),this.emplace(_,t,s,u,h,m)}emplace(t,s,u,h,m,_){const S=4*t,E=8*t;return this.float32[S+0]=s,this.float32[S+1]=u,this.float32[S+2]=h,this.int16[E+6]=m,this.int16[E+7]=_,t}}ih.prototype.bytesPerElement=16,un(ih,"StructArrayLayout2f1f2i16");class uf extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,u,h,m,_){const S=this.length;return this.resize(S+1),this.emplace(S,t,s,u,h,m,_)}emplace(t,s,u,h,m,_,S){const E=20*t,A=5*t;return this.uint8[E+0]=s,this.uint8[E+1]=u,this.float32[A+1]=h,this.float32[A+2]=m,this.float32[A+3]=_,this.float32[A+4]=S,t}}uf.prototype.bytesPerElement=20,un(uf,"StructArrayLayout2ub4f20");class gs extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s,u){const h=this.length;return this.resize(h+1),this.emplace(h,t,s,u)}emplace(t,s,u,h){const m=3*t;return this.uint16[m+0]=s,this.uint16[m+1]=u,this.uint16[m+2]=h,t}}gs.prototype.bytesPerElement=6,un(gs,"StructArrayLayout3ui6");class df extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,s,u,h,m,_,S,E,A,D,O,F,G,W,Q,ae,ce,we,ve,ee,ge){const be=this.length;return this.resize(be+1),this.emplace(be,t,s,u,h,m,_,S,E,A,D,O,F,G,W,Q,ae,ce,we,ve,ee,ge)}emplace(t,s,u,h,m,_,S,E,A,D,O,F,G,W,Q,ae,ce,we,ve,ee,ge,be){const Ie=30*t,Fe=15*t,$e=60*t;return this.int16[Ie+0]=s,this.int16[Ie+1]=u,this.int16[Ie+2]=h,this.float32[Fe+2]=m,this.float32[Fe+3]=_,this.uint16[Ie+8]=S,this.uint16[Ie+9]=E,this.uint32[Fe+5]=A,this.uint32[Fe+6]=D,this.uint32[Fe+7]=O,this.uint16[Ie+16]=F,this.uint16[Ie+17]=G,this.uint16[Ie+18]=W,this.float32[Fe+10]=Q,this.float32[Fe+11]=ae,this.uint8[$e+48]=ce,this.uint8[$e+49]=we,this.uint8[$e+50]=ve,this.uint32[Fe+13]=ee,this.int16[Ie+28]=ge,this.uint8[$e+58]=be,t}}df.prototype.bytesPerElement=60,un(df,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class hf extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,s,u,h,m,_,S,E,A,D,O,F,G,W,Q,ae,ce,we,ve,ee,ge,be,Ie,Fe,$e,Ze,et,St,jt,kt,Ft,Gt,vt){const zt=this.length;return this.resize(zt+1),this.emplace(zt,t,s,u,h,m,_,S,E,A,D,O,F,G,W,Q,ae,ce,we,ve,ee,ge,be,Ie,Fe,$e,Ze,et,St,jt,kt,Ft,Gt,vt)}emplace(t,s,u,h,m,_,S,E,A,D,O,F,G,W,Q,ae,ce,we,ve,ee,ge,be,Ie,Fe,$e,Ze,et,St,jt,kt,Ft,Gt,vt,zt){const gt=20*t,bt=40*t,qt=80*t;return this.float32[gt+0]=s,this.float32[gt+1]=u,this.int16[bt+4]=h,this.int16[bt+5]=m,this.int16[bt+6]=_,this.int16[bt+7]=S,this.int16[bt+8]=E,this.int16[bt+9]=A,this.int16[bt+10]=D,this.int16[bt+11]=O,this.int16[bt+12]=F,this.uint16[bt+13]=G,this.uint16[bt+14]=W,this.uint16[bt+15]=Q,this.uint16[bt+16]=ae,this.uint16[bt+17]=ce,this.uint16[bt+18]=we,this.uint16[bt+19]=ve,this.uint16[bt+20]=ee,this.uint16[bt+21]=ge,this.uint16[bt+22]=be,this.uint16[bt+23]=Ie,this.uint16[bt+24]=Fe,this.uint16[bt+25]=$e,this.uint16[bt+26]=Ze,this.uint16[bt+27]=et,this.uint32[gt+14]=St,this.float32[gt+15]=jt,this.float32[gt+16]=kt,this.float32[gt+17]=Ft,this.float32[gt+18]=Gt,this.uint8[qt+76]=vt,this.uint16[bt+39]=zt,t}}hf.prototype.bytesPerElement=80,un(hf,"StructArrayLayout2f9i15ui1ul4f1ub1ui80");class au extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,u,h,m){const _=this.length;return this.resize(_+1),this.emplace(_,t,s,u,h,m)}emplace(t,s,u,h,m,_){const S=5*t;return this.float32[S+0]=s,this.float32[S+1]=u,this.float32[S+2]=h,this.float32[S+3]=m,this.float32[S+4]=_,t}}au.prototype.bytesPerElement=20,un(au,"StructArrayLayout5f20");class sh extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,u,h,m,_,S){const E=this.length;return this.resize(E+1),this.emplace(E,t,s,u,h,m,_,S)}emplace(t,s,u,h,m,_,S,E){const A=7*t;return this.float32[A+0]=s,this.float32[A+1]=u,this.float32[A+2]=h,this.float32[A+3]=m,this.float32[A+4]=_,this.float32[A+5]=S,this.float32[A+6]=E,t}}sh.prototype.bytesPerElement=28,un(sh,"StructArrayLayout7f28");class sp extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,u,h,m,_,S,E,A,D,O){const F=this.length;return this.resize(F+1),this.emplace(F,t,s,u,h,m,_,S,E,A,D,O)}emplace(t,s,u,h,m,_,S,E,A,D,O,F){const G=11*t;return this.float32[G+0]=s,this.float32[G+1]=u,this.float32[G+2]=h,this.float32[G+3]=m,this.float32[G+4]=_,this.float32[G+5]=S,this.float32[G+6]=E,this.float32[G+7]=A,this.float32[G+8]=D,this.float32[G+9]=O,this.float32[G+10]=F,t}}sp.prototype.bytesPerElement=44,un(sp,"StructArrayLayout11f44");class ff extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,u,h,m,_,S,E,A){const D=this.length;return this.resize(D+1),this.emplace(D,t,s,u,h,m,_,S,E,A)}emplace(t,s,u,h,m,_,S,E,A,D){const O=9*t;return this.float32[O+0]=s,this.float32[O+1]=u,this.float32[O+2]=h,this.float32[O+3]=m,this.float32[O+4]=_,this.float32[O+5]=S,this.float32[O+6]=E,this.float32[O+7]=A,this.float32[O+8]=D,t}}ff.prototype.bytesPerElement=36,un(ff,"StructArrayLayout9f36");class lu extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s){const u=this.length;return this.resize(u+1),this.emplace(u,t,s)}emplace(t,s,u){const h=2*t;return this.float32[h+0]=s,this.float32[h+1]=u,t}}lu.prototype.bytesPerElement=8,un(lu,"StructArrayLayout2f8");class op extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s,u,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,s,u,h)}emplace(t,s,u,h,m){const _=6*t;return this.uint32[3*t+0]=s,this.uint16[_+2]=u,this.uint16[_+3]=h,this.uint16[_+4]=m,t}}op.prototype.bytesPerElement=12,un(op,"StructArrayLayout1ul3ui12");class pf extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const s=this.length;return this.resize(s+1),this.emplace(s,t)}emplace(t,s){return this.uint16[1*t+0]=s,t}}pf.prototype.bytesPerElement=2,un(pf,"StructArrayLayout1ui2");class no extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,u,h,m,_,S,E,A,D,O,F,G,W,Q,ae){const ce=this.length;return this.resize(ce+1),this.emplace(ce,t,s,u,h,m,_,S,E,A,D,O,F,G,W,Q,ae)}emplace(t,s,u,h,m,_,S,E,A,D,O,F,G,W,Q,ae,ce){const we=16*t;return this.float32[we+0]=s,this.float32[we+1]=u,this.float32[we+2]=h,this.float32[we+3]=m,this.float32[we+4]=_,this.float32[we+5]=S,this.float32[we+6]=E,this.float32[we+7]=A,this.float32[we+8]=D,this.float32[we+9]=O,this.float32[we+10]=F,this.float32[we+11]=G,this.float32[we+12]=W,this.float32[we+13]=Q,this.float32[we+14]=ae,this.float32[we+15]=ce,t}}no.prototype.bytesPerElement=64,un(no,"StructArrayLayout16f64");class ro extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,u,h,m,_,S){const E=this.length;return this.resize(E+1),this.emplace(E,t,s,u,h,m,_,S)}emplace(t,s,u,h,m,_,S,E){const A=10*t,D=5*t;return this.uint16[A+0]=s,this.uint16[A+1]=u,this.uint16[A+2]=h,this.uint16[A+3]=m,this.float32[D+2]=_,this.float32[D+3]=S,this.float32[D+4]=E,t}}ro.prototype.bytesPerElement=20,un(ro,"StructArrayLayout4ui3f20");class ap extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t){const s=this.length;return this.resize(s+1),this.emplace(s,t)}emplace(t,s){return this.int16[1*t+0]=s,t}}ap.prototype.bytesPerElement=2,un(ap,"StructArrayLayout1i2");class mf extends Ii{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(t){const s=this.length;return this.resize(s+1),this.emplace(s,t)}emplace(t,s){return this.uint8[1*t+0]=s,t}}mf.prototype.bytesPerElement=1,un(mf,"StructArrayLayout1ub1");class Cm extends eh{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Cm.prototype.size=40;class gf extends ip{get(t){return new Cm(this,t)}}un(gf,"CollisionBoxArray");class Tm extends eh{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t}}Tm.prototype.size=60;class lp extends df{get(t){return new Tm(this,t)}}un(lp,"PlacedSymbolArray");class Em extends eh{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(t){this._structArray.uint32[this._pos4+14]=t}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(t){this._structArray.float32[this._pos4+18]=t}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}get elevationFeatureIndex(){return this._structArray.uint16[this._pos2+39]}}Em.prototype.size=80;class cp extends hf{get(t){return new Em(this,t)}}un(cp,"SymbolInstanceArray");class up extends th{getoffsetX(t){return this.float32[1*t+0]}}un(up,"GlyphOffsetArray");class Im extends Vl{getx(t){return this.int16[2*t+0]}gety(t){return this.int16[2*t+1]}}un(Im,"SymbolLineVertexArray");class dp extends eh{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}dp.prototype.size=12;class hp extends op{get(t){return new dp(this,t)}}un(hp,"FeatureIndexArray");class Pm extends ol{geta_centroid_pos0(t){return this.uint16[2*t+0]}geta_centroid_pos1(t){return this.uint16[2*t+1]}}un(Pm,"FillExtrusionCentroidArray");class fp extends eh{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}fp.prototype.size=6;class _f extends of{get(t){return new fp(this,t)}}un(_f,"FillExtrusionWallArray");const sy=Vr([{name:"a_pos",components:2,type:"Int16"}],4),Mg=Vr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class ki{constructor(t=[]){this.segments=t}_prepareSegment(t,s,u,h){let m=this.segments[this.segments.length-1];return t>ki.MAX_VERTEX_ARRAY_LENGTH&&gr(`Max vertices per segment is ${ki.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!m||m.vertexLength+t>ki.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==h)&&(m={vertexOffset:s,primitiveOffset:u,vertexLength:0,primitiveLength:0},h!==void 0&&(m.sortKey=h),this.segments.push(m)),m}prepareSegment(t,s,u,h){return this._prepareSegment(t,s.length,u.length,h)}get(){return this.segments}destroy(){for(const t of this.segments)for(const s in t.vaos)t.vaos[s].destroy()}static simpleSegment(t,s,u,h){return new ki([{vertexOffset:t,primitiveOffset:s,vertexLength:u,primitiveLength:h,vaos:{},sortKey:0}])}}function Am(a,t){return 256*(a=Xe(Math.floor(a),0,255))+Xe(Math.floor(t),0,255)}ki.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,un(ki,"SegmentVector");const pp=Vr([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),ta=Vr([{name:"a_pattern_b",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),oy=Vr([{name:"a_dash",components:4,type:"Uint16"}]);class id{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(t,s,u,h){this.ids.push(mp(t)),this.positions.push(s,u,h)}eachPosition(t,s){const u=mp(t);let h=0,m=this.ids.length-1;for(;h<m;){const _=h+m>>1;this.ids[_]>=u?m=_:h=_+1}for(;this.ids[h]===u;)s(this.positions[3*h],this.positions[3*h+1],this.positions[3*h+2]),h++}static serialize(t,s){const u=new Float64Array(t.ids),h=new Uint32Array(t.positions);return yf(u,h,0,u.length-1),s&&(s.add(u.buffer),s.add(h.buffer)),{ids:u,positions:h}}static deserialize(t){const s=new id;let u;s.ids=t.ids,s.positions=t.positions;for(const h of s.ids)h!==u&&s.uniqueIds.push(h),u=h;return s.indexed=!0,s}}function mp(a){const t=+a;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:bo(String(a))}function yf(a,t,s,u){for(;s<u;){const h=a[s+u>>1];let m=s-1,_=u+1;for(;;){do m++;while(a[m]<h);do _--;while(a[_]>h);if(m>=_)break;oh(a,m,_),oh(t,3*m,3*_),oh(t,3*m+1,3*_+1),oh(t,3*m+2,3*_+2)}_-s<u-_?(yf(a,t,s,_),s=_+1):(yf(a,t,_+1,u),u=_)}}function oh(a,t,s){const u=a[t];a[t]=a[s],a[s]=u}un(id,"FeaturePositionMap");class na{constructor(t){this.gl=t.gl,this.initialized=!1}fetchUniformLocation(t,s){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(t,s),this.initialized=!0),!!this.location}set(t,s,u){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class io extends na{constructor(t){super(t),this.current=0}set(t,s,u){this.fetchUniformLocation(t,s)&&this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}}class _s extends na{constructor(t){super(t),this.current=0}set(t,s,u){this.fetchUniformLocation(t,s)&&this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class al extends na{constructor(t){super(t),this.current=[0,0]}set(t,s,u){this.fetchUniformLocation(t,s)&&(u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1])))}}class cu extends na{constructor(t){super(t),this.current=[0,0,0]}set(t,s,u){this.fetchUniformLocation(t,s)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2])))}}class so extends na{constructor(t){super(t),this.current=[0,0,0,0]}set(t,s,u){this.fetchUniformLocation(t,s)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3])))}}class Lg extends na{constructor(t){super(t),this.current=xr.transparent.toRenderColor(null)}set(t,s,u){this.fetchUniformLocation(t,s)&&(u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a)))}}const er=new Float32Array(16);class $l extends na{constructor(t){super(t),this.current=er}set(t,s,u){if(this.fetchUniformLocation(t,s)){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let h=1;h<16;h++)if(u[h]!==this.current[h]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}}}const gp=new Float32Array(9),_p=new Float32Array(4);class ka extends na{constructor(t){super(t),this.current=_p}set(t,s,u){if(this.fetchUniformLocation(t,s)){for(let h=0;h<4;h++)if(u[h]!==this.current[h]){this.current=u,this.gl.uniformMatrix2fv(this.location,!1,u);break}}}}function Tc(a){return[Am(255*a.r,255*a.g),Am(255*a.b,255*a.a)]}class uu{constructor(t,s,u,h){this.value=t,this.uniformNames=s.map(m=>`u_${m}`),this.type=u,this.context=h}setUniform(t,s,u,h,m){const _=h.constantOr(this.value);s.set(t,m,_ instanceof xr?_.toRenderColor(this.lutExpression&&this.lutExpression.value==="none"?null:this.context.lut):_)}getBinding(t,s){return this.type==="color"?new Lg(t):new _s(t)}}class du{constructor(t,s){this.uniformNames=s.map(u=>`u_${u}`),this.pattern=null,this.patternTransition=null,this.pixelRatio=1}setConstantPatternPositions(t,s){this.pixelRatio=t.pixelRatio||1,this.pattern=t.tl.concat(t.br),this.patternTransition=s?s.tl.concat(s.br):this.pattern}setUniform(t,s,u,h,m){let _=null;m!=="u_pattern"&&m!=="u_dash"||(_=this.pattern),m==="u_pattern_b"&&(_=this.patternTransition),m==="u_pixel_ratio"&&(_=this.pixelRatio),_&&s.set(t,m,_)}getBinding(t,s){return s==="u_pattern"||s==="u_pattern_b"||s==="u_dash"?new so(t):new _s(t)}}class Hl{constructor(t,s,u,h){this.expression=t,this.type=u,this.maxValue=0,this.paintVertexAttributes=s.map(m=>({name:`a_${m}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(t,s,u,h,m,_,S){const E=this.paintVertexArray.length,A=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new ni(0,{brightness:_}),s,{},m,h,S):this.expression.kind==="constant"&&this.expression.value,D=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new ni(0,{brightness:_}),s,{},m,h,S):this.lutExpression.value)==="none";this.paintVertexArray.resize(t),this._setPaintValue(E,t,A,D?null:this.context.lut)}updatePaintArray(t,s,u,h,m,_,S){const E=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:S},u,h,void 0,m):this.expression.kind==="constant"&&this.expression.value,A=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new ni(0,{brightness:S}),u,h,void 0,m):this.lutExpression.value)==="none";this._setPaintValue(t,s,E,A?null:this.context.lut)}_setPaintValue(t,s,u,h){if(this.type==="color"){const m=Tc(u.toRenderColor(h));for(let _=t;_<s;_++)this.paintVertexArray.emplace(_,m[0],m[1])}else{for(let m=t;m<s;m++)this.paintVertexArray.emplace(m,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Oa{constructor(t,s,u,h,m,_){this.expression=t,this.uniformNames=s.map(S=>`u_${S}_t`),this.type=u,this.useIntegerZoom=h,this.context=m,this.maxValue=0,this.paintVertexAttributes=s.map(S=>({name:`a_${S}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(t,s,u,h,m,_,S){const E=this.expression.evaluate(new ni(this.context.zoom,{brightness:_}),s,{},m,h,S),A=this.expression.evaluate(new ni(this.context.zoom+1,{brightness:_}),s,{},m,h,S),D=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new ni(0,{brightness:_}),s,{},m,h,S):this.lutExpression.value)==="none",O=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(O,t,E,A,D?null:this.context.lut)}updatePaintArray(t,s,u,h,m,_,S){const E=this.expression.evaluate({zoom:this.context.zoom,brightness:S},u,h,void 0,m),A=this.expression.evaluate({zoom:this.context.zoom+1,brightness:S},u,h,void 0,m),D=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new ni(0,{brightness:S}),u,h,void 0,m):this.lutExpression.value)==="none";this._setPaintValue(t,s,E,A,D?null:this.context.lut)}_setPaintValue(t,s,u,h,m){if(this.type==="color"){const _=Tc(u.toRenderColor(m)),S=Tc(u.toRenderColor(m));for(let E=t;E<s;E++)this.paintVertexArray.emplace(E,_[0],_[1],S[0],S[1])}else{for(let _=t;_<s;_++)this.paintVertexArray.emplace(_,u,h);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(h))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,s,u,h,m){const _=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,S=Xe(this.expression.interpolationFactor(_,this.context.zoom,this.context.zoom+1),0,1);s.set(t,m,S)}getBinding(t,s){return new _s(t)}}class za{constructor(t,s,u,h,m){this.expression=t,this.layerId=m,this.paintVertexAttributes=(u==="array"?oy:pp).members;for(let _=0;_<s.length;++_);this.paintVertexArray=new h,this.paintTransitionVertexArray=new Ul}populatePaintArray(t,s,u,h){const m=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValues(m,t,s.patterns&&s.patterns[this.layerId],u)}updatePaintArray(t,s,u,h,m,_,S){this._setPaintValues(t,s,u.patterns&&u.patterns[this.layerId],_)}_setPaintValues(t,s,u,h){if(!h||!u)return;const m=h[u[0]],_=h[u[1]];if(m){if(m){const{tl:S,br:E,pixelRatio:A}=m;for(let D=t;D<s;D++)this.paintVertexArray.emplace(D,S[0],S[1],E[0],E[1],A)}if(_){this.paintTransitionVertexArray.resize(this.paintVertexArray.length);const{tl:S,br:E,pixelRatio:A}=_;for(let D=t;D<s;D++)this.paintTransitionVertexArray.emplace(D,S[0],S[1],E[0],E[1],A)}}}upload(t){const s=this.expression.isStateDependent||!this.expression.isLightConstant;this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,s)),this.paintTransitionVertexArray&&this.paintTransitionVertexArray.length&&(this.paintTransitionVertexBuffer=t.createVertexBuffer(this.paintTransitionVertexArray,ta.members,s))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy(),this.paintTransitionVertexBuffer&&this.paintTransitionVertexBuffer.destroy()}}class Gl{constructor(t,s,u=()=>!0){this.binders={},this._buffers=[],this.context=s;const h=[];for(const m in t.paint._values){const _=t.paint.get(m);if(m.endsWith("-use-theme")||!u(m)||!(_ instanceof Sc&&hs(_.property.specification)))continue;const S=r(m,t.type),E=_.value,A=_.property.specification.type,D=!!_.property.useIntegerZoom,O=m==="line-dasharray"||m.endsWith("pattern"),F=t.paint.get(`${m}-use-theme`),G=m==="line-dasharray"&&t.layout.get("line-cap").value.kind!=="constant"||F&&F.value.kind!=="constant";if(E.kind!=="constant"||G)if(E.kind==="source"||G||O){const W=v(m,A,"source");this.binders[m]=O?new za(E,S,A,W,t.id):new Hl(E,S,A,W),h.push(`/a_${m}`)}else{const W=v(m,A,"composite");this.binders[m]=new Oa(E,S,A,D,s,W),h.push(`/z_${m}`)}else this.binders[m]=O?new du(E.value,S):new uu(E.value,S,A,s),h.push(`/u_${m}`);F&&(this.binders[m].lutExpression=F.value)}this.cacheKey=h.sort().join("")}getMaxValue(t){const s=this.binders[t];return s instanceof Hl||s instanceof Oa?s.maxValue:0}populatePaintArrays(t,s,u,h,m,_,S){for(const E in this.binders){const A=this.binders[E];A.context=this.context,(A instanceof Hl||A instanceof Oa||A instanceof za)&&A.populatePaintArray(t,s,u,h,m,_,S)}}setConstantPatternPositions(t,s){for(const u in this.binders){const h=this.binders[u];h instanceof du&&h.setConstantPatternPositions(t,s)}}getPatternTransitionVertexBuffer(t){const s=this.binders[t];return s instanceof za?s.paintTransitionVertexBuffer:null}updatePaintArrays(t,s,u,h,m,_,S,E,A){let D=!1;const O=Object.keys(t),F=O.length!==0&&!E,G=F?O:s.uniqueIds;this.context.lut=m.lut;for(const W in this.binders){const Q=this.binders[W];if(Q.context=this.context,(Q instanceof Hl||Q instanceof Oa||Q instanceof za)&&Q.expression&&Q.expression.kind&&Q.expression.kind!=="constant"&&(Q.expression.isStateDependent===!0||Q.expression.isLightConstant===!1)){const ae=m.paint.get(W);Q.expression=ae.value;for(const ce of G){const we=t[ce.toString()];s.eachPosition(ce,(ve,ee,ge)=>{const be=h.feature(ve);Q.updatePaintArray(ee,ge,be,we,_,S,A)})}if(!F)for(const ce of u.uniqueIds){const we=t[ce.toString()];u.eachPosition(ce,(ve,ee,ge)=>{const be=h.feature(ve);Q.updatePaintArray(ee,ge,be,we,_,S,A)})}D=!0}}return D}defines(){const t=[];for(const s in this.binders){const u=this.binders[s];(u instanceof uu||u instanceof du)&&t.push(...u.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return t}getBinderAttributes(){const t=[];for(const s in this.binders){const u=this.binders[s];if(u instanceof Hl||u instanceof Oa||u instanceof za)for(let h=0;h<u.paintVertexAttributes.length;h++)t.push(u.paintVertexAttributes[h].name);if(u instanceof za)for(let h=0;h<ta.members.length;h++)t.push(ta.members[h].name)}return t}getBinderUniforms(){const t=[];for(const s in this.binders){const u=this.binders[s];if(u instanceof uu||u instanceof du||u instanceof Oa)for(const h of u.uniformNames)t.push(h)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t){const s=[];for(const u in this.binders){const h=this.binders[u];if(h instanceof uu||h instanceof du||h instanceof Oa)for(const m of h.uniformNames)s.push({name:m,property:u,binding:h.getBinding(t,m)})}return s}setUniforms(t,s,u,h,m){for(const{name:_,property:S,binding:E}of u)this.binders[S].setUniform(t,E,m,h.get(S),_)}updatePaintBuffers(){this._buffers=[];for(const t in this.binders){const s=this.binders[t];(s instanceof Hl||s instanceof Oa||s instanceof za)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer),s instanceof za&&s.paintTransitionVertexBuffer&&this._buffers.push(s.paintTransitionVertexBuffer)}}upload(t){for(const s in this.binders){const u=this.binders[s];(u instanceof Hl||u instanceof Oa||u instanceof za)&&u.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const s=this.binders[t];(s instanceof Hl||s instanceof Oa||s instanceof za)&&s.destroy()}}}class Ec{constructor(t,s,u=()=>!0){this.programConfigurations={};for(const h of t)this.programConfigurations[h.id]=new Gl(h,s,u);this.needsUpload=!1,this._featureMap=new id,this._featureMapWithoutIds=new id,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(t,s,u,h,m,_,S,E){for(const A in this.programConfigurations)this.programConfigurations[A].populatePaintArrays(t,s,h,m,_,S,E);s.id!==void 0?this._featureMap.add(s.id,u,this._bufferOffset,t):(this._featureMapWithoutIds.add(this._idlessCounter,u,this._bufferOffset,t),this._idlessCounter+=1),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,s,u,h,m,_,S){for(const E of u)this.needsUpload=this.programConfigurations[E.id].updatePaintArrays(t,this._featureMap,this._featureMapWithoutIds,s,E,h,m,_,S||0)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const f={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio","pattern_b"],"fill-pattern":["pattern","pixel_ratio","pattern_b"],"fill-extrusion-pattern":["pattern","pixel_ratio","pattern_b"],"line-dasharray":["dash"]};function r(a,t){return f[a]||[a.replace(`${t}-`,"").replace(/-/g,"_")]}const l={"line-pattern":{source:Ul,composite:Ul},"fill-pattern":{source:Ul,composite:Ul},"fill-extrusion-pattern":{source:Ul,composite:Ul},"line-dasharray":{source:nd,composite:nd}},p={color:{source:lu,composite:Xs},number:{source:th,composite:lu}};function v(a,t,s){const u=l[a];return u&&u[s]||p[t][s]}un(uu,"ConstantBinder"),un(du,"PatternConstantBinder"),un(Hl,"SourceExpressionBinder"),un(za,"PatternCompositeBinder"),un(Oa,"CompositeExpressionBinder"),un(Gl,"ProgramConfiguration",{omit:["_buffers"]}),un(Ec,"ProgramConfigurationSet");const w=en/Math.PI/2,C=5,P=6,L=16383,z=64,j=[z,32,16],H=-w,$=w;function q(a,t,s,u=w){return s=ie(s),[a*Math.sin(s)*u,-t*u,a*Math.cos(s)*u]}function re(a,t,s){return q(Math.cos(ie(a)),Math.sin(ie(a)),t,s)}const te=63710088e-1,oe=2*Math.PI*te;class ne{constructor(t,s){if(isNaN(t)||isNaN(s))throw new Error(`Invalid LngLat object: (${t}, ${s})`);if(this.lng=+t,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ne(pt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const s=Math.PI/180,u=this.lat*s,h=t.lat*s,m=Math.sin(u)*Math.sin(h)+Math.cos(u)*Math.cos(h)*Math.cos((t.lng-this.lng)*s);return te*Math.acos(Math.min(m,1))}toBounds(t=0){const s=360*t/40075017,u=s/Math.cos(Math.PI/180*this.lat);return new ye({lng:this.lng-u,lat:this.lat-s},{lng:this.lng+u,lat:this.lat+s})}toEcef(t){return re(this.lat,this.lng,w+t*w/te)}static convert(t){if(t instanceof ne)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new ne(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new ne(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class ye{constructor(t,s){if(t)if(s)this.setSouthWest(t).setNorthEast(s);else if(t.length===4){const u=t;this.setSouthWest([u[0],u[1]]).setNorthEast([u[2],u[3]])}else{const u=t;this.setSouthWest(u[0]).setNorthEast(u[1])}}setNorthEast(t){return this._ne=t instanceof ne?new ne(t.lng,t.lat):ne.convert(t),this}setSouthWest(t){return this._sw=t instanceof ne?new ne(t.lng,t.lat):ne.convert(t),this}extend(t){const s=this._sw,u=this._ne;let h,m;if(t instanceof ne)h=t,m=t;else{if(!(t instanceof ye))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(ye.convert(t)):this.extend(ne.convert(t)):typeof t=="object"&&t!==null&&t.hasOwnProperty("lat")&&(t.hasOwnProperty("lon")||t.hasOwnProperty("lng"))?this.extend(ne.convert(t)):this;if(h=t._sw,m=t._ne,!h||!m)return this}return s||u?(s.lng=Math.min(h.lng,s.lng),s.lat=Math.min(h.lat,s.lat),u.lng=Math.max(m.lng,u.lng),u.lat=Math.max(m.lat,u.lat)):(this._sw=new ne(h.lng,h.lat),this._ne=new ne(m.lng,m.lat)),this}getCenter(){return new ne((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new ne(this.getWest(),this.getNorth())}getSouthEast(){return new ne(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:s,lat:u}=ne.convert(t);let h=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&h}static convert(t){if(t)return t instanceof ye?t:new ye(t)}}const Se=0,Te=25.5;function ke(a){return oe*Math.cos(a*Math.PI/180)}function De(a){return(180+a)/360}function Me(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function Pe(a,t){return a/ke(t)}function Oe(a){return 360*a-180}function Ne(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function ht(a,t){return a*ke(Ne(t))}const rt=85.051129;function Tt(a){return Math.cos(ie(Xe(a,-85.051129,rt)))}function It(a,t){const s=Xe(t,Se,Te),u=Math.pow(2,s);return Tt(a)*oe/(512*u)}function Ht(a){return 1/Math.cos(a*Math.PI/180)}function Qe(a,t=0){const s=Math.exp(Math.PI*(1-(a.y+t/en)/(1<<a.z)*2));return 80150034*s/(s*s+1)/en/(1<<a.z)}class dt{constructor(t,s,u=0){this.x=+t,this.y=+s,this.z=+u}static fromLngLat(t,s=0){const u=ne.convert(t);return new dt(De(u.lng),Me(u.lat),Pe(s,u.lat))}toLngLat(){return new ne(Oe(this.x),Ne(this.y))}toAltitude(){return ht(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/oe*Ht(Ne(this.y))}}function Je(a,t,s,u,h,m,_,S,E){const A=(t+u)/2,D=(s+h)/2,O=new Qt(A,D);S(O),function(F,G,W,Q,ae,ce){const we=W-ae,ve=Q-ce;return Math.abs((Q-G)*we-(W-F)*ve)/Math.hypot(we,ve)}(O.x,O.y,m.x,m.y,_.x,_.y)>=E?(Je(a,t,s,A,D,m,O,S,E),Je(a,A,D,u,h,O,_,S,E)):a.push(_)}function Dt(a,t,s){let u=a[0],h=u.x,m=u.y;t(u);const _=[u];for(let S=1;S<a.length;S++){const E=a[S],{x:A,y:D}=E;t(E),Je(_,h,m,A,D,u,E,t,s),h=A,m=D,u=E}return _}function mt(a,t,s,u){if(u(t,s)){const h=t.add(s)._mult(.5);mt(a,t,h,u),mt(a,h,s,u)}else a.push(s)}function Ot(a,t){let s=a[0];const u=[s];for(let h=1;h<a.length;h++){const m=a[h];mt(u,s,m,t),s=m}return u}const Mt=Math.pow(2,14)-1,Nt=-Mt-1;function Vt(a,t){const s=Math.round(a.x*t),u=Math.round(a.y*t);return a.x=Xe(s,Nt,Mt),a.y=Xe(u,Nt,Mt),(s<a.x||s>a.x+1||u<a.y||u>a.y+1)&&gr("Geometry exceeds allowed extent, reduce your vector tile buffer size"),a}function pn(a,t,s){const u=a.loadGeometry(),h=a.extent,m=en/h;if(t&&s&&s.projection.isReprojectedInTileSpace){const _=1<<t.z,{scale:S,x:E,y:A,projection:D}=s,O=F=>{const G=Oe((t.x+F.x/h)/_),W=Ne((t.y+F.y/h)/_),Q=D.project(G,W);F.x=(Q.x*S-E)*h,F.y=(Q.y*S-A)*h};for(let F=0;F<u.length;F++)if(a.type!==1)u[F]=Dt(u[F],O,1);else{const G=[];for(const W of u[F])W.x<0||W.x>=h||W.y<0||W.y>=h||(O(W),G.push(W));u[F]=G}}for(const _ of u)for(const S of _)Vt(S,m);return u}function bn(a,t){return{type:a.type,id:a.id,properties:a.properties,geometry:t?pn(a):[]}}function rn(a,t,s,u,h){a.emplaceBack(2*t+(u+1)/2,2*s+(h+1)/2)}function vn(a,t,s){a.emplaceBack(t.x,t.y,t.z,s[0]*16384,s[1]*16384,s[2]*16384)}class dn{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new Vl,this.indexArray=new gs,this.segments=new ki,this.programConfigurations=new Ec(t.layers,{zoom:t.zoom,lut:t.lut}),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}updateFootprints(t,s){}populate(t,s,u,h){const m=this.layers[0],_=[];let S=null;m.type==="circle"&&(S=m.layout.get("circle-sort-key"));for(const{feature:A,id:D,index:O,sourceLayerIndex:F}of t){const G=this.layers[0]._featureFilter.needGeometry,W=bn(A,G);if(!this.layers[0]._featureFilter.filter(new ni(this.zoom),W,u))continue;const Q=S?S.evaluate(W,{},u):void 0,ae={id:D,properties:A.properties,type:A.type,sourceLayerIndex:F,index:O,geometry:G?W.geometry:pn(A,u,h),patterns:{},sortKey:Q};_.push(ae)}S&&_.sort((A,D)=>A.sortKey-D.sortKey);let E=null;h.projection.name==="globe"&&(this.globeExtVertexArray=new rd,E=h.projection);for(const A of _){const{geometry:D,index:O,sourceLayerIndex:F}=A,G=t[O].feature;this.addFeature(A,D,O,s.availableImages,u,E,s.brightness),s.featureIndex.insert(G,D,O,F,this.index)}}update(t,s,u,h,m,_,S){this.programConfigurations.updatePaintArrays(t,s,m,u,h,_,S)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,sy.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,Mg.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(t,s,u,h,m,_,S){for(const E of s)for(const A of E){const D=A.x,O=A.y;if(D<0||D>=en||O<0||O>=en)continue;if(_){const W=_.projectTilePoint(D,O,m),Q=_.upVector(m,D,O),ae=this.globeExtVertexArray;vn(ae,W,Q),vn(ae,W,Q),vn(ae,W,Q),vn(ae,W,Q)}const F=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),G=F.vertexLength;rn(this.layoutVertexArray,D,O,-1,-1),rn(this.layoutVertexArray,D,O,1,-1),rn(this.layoutVertexArray,D,O,1,1),rn(this.layoutVertexArray,D,O,-1,1),this.indexArray.emplaceBack(G,G+1,G+2),this.indexArray.emplaceBack(G,G+2,G+3),F.vertexLength+=4,F.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,{},h,m,S)}}function Rn(a,t){for(let s=0;s<a.length;s++)if(si(t,a[s]))return!0;for(let s=0;s<t.length;s++)if(si(a,t[s]))return!0;return!!ii(a,t)}function Hn(a,t,s){return!!si(a,t)||!!Gn(t,a,s)}function dr(a,t){if(a.length===1)return Tr(t,a[0]);for(let s=0;s<t.length;s++){const u=t[s];for(let h=0;h<u.length;h++)if(si(a,u[h]))return!0}for(let s=0;s<a.length;s++)if(Tr(t,a[s]))return!0;for(let s=0;s<t.length;s++)if(ii(a,t[s]))return!0;return!1}function ri(a,t,s){if(a.length>1){if(ii(a,t))return!0;for(let u=0;u<t.length;u++)if(Gn(t[u],a,s))return!0}for(let u=0;u<a.length;u++)if(Gn(a[u],t,s))return!0;return!1}function ii(a,t){if(a.length===0||t.length===0)return!1;for(let s=0;s<a.length-1;s++){const u=a[s],h=a[s+1];for(let m=0;m<t.length-1;m++)if(tr(u,h,t[m],t[m+1]))return!0}return!1}function tr(a,t,s,u){return gi(a,s,u)!==gi(t,s,u)&&gi(a,t,s)!==gi(a,t,u)}function Hi(a,t,s){return(a.x-s.x)*(t.y-s.y)-(a.y-s.y)*(t.x-s.x)}function Pi(a,t,s,u){const h=Hi(a,t,u),m=Hi(a,t,s);if(Math.sign(h)===Math.sign(m))return;const _=Hi(s,u,a),S=_+m-h;return Math.sign(_)!==Math.sign(S)?[_/(_-S),m/(m-h)]:void 0}function Gn(a,t,s){const u=s*s;if(t.length===1)return a.distSqr(t[0])<u;for(let h=1;h<t.length;h++)if(Cr(a,t[h-1],t[h])<u)return!0;return!1}function Cr(a,t,s){const u=t.distSqr(s);if(u===0)return a.distSqr(t);const h=((a.x-t.x)*(s.x-t.x)+(a.y-t.y)*(s.y-t.y))/u;return a.distSqr(h<0?t:h>1?s:s.sub(t)._mult(h)._add(t))}function Tr(a,t){let s,u,h,m=!1;for(let _=0;_<a.length;_++){s=a[_];for(let S=0,E=s.length-1;S<s.length;E=S++)u=s[S],h=s[E],u.y>t.y!=h.y>t.y&&t.x<(h.x-u.x)*(t.y-u.y)/(h.y-u.y)+u.x&&(m=!m)}return m}function si(a,t){let s=!1;for(let u=0,h=a.length-1;u<a.length;h=u++){const m=a[u],_=a[h];m.y>t.y!=_.y>t.y&&t.x<(_.x-m.x)*(t.y-m.y)/(_.y-m.y)+m.x&&(s=!s)}return s}function ys(a,t,s,u,h){for(const _ of a)if(t<=_.x&&s<=_.y&&u>=_.x&&h>=_.y)return!0;const m=[new Qt(t,s),new Qt(t,h),new Qt(u,h),new Qt(u,s)];if(a.length>2){for(const _ of m)if(si(a,_))return!0}for(let _=0;_<a.length-1;_++)if(Gi(a[_],a[_+1],m))return!0;return!1}function Gi(a,t,s){const u=s[0],h=s[2];if(a.x<u.x&&t.x<u.x||a.x>h.x&&t.x>h.x||a.y<u.y&&t.y<u.y||a.y>h.y&&t.y>h.y)return!1;const m=gi(a,t,s[0]);return m!==gi(a,t,s[1])||m!==gi(a,t,s[2])||m!==gi(a,t,s[3])}function ns(a,t,s,u,h,m){let _=t.y-a.y,S=a.x-t.x;if(m=m||0){const E=_*_+S*S;if(E===0)return!0;const A=Math.sqrt(E);_/=A,S/=A}return!((s.x-a.x)*_+(s.y-a.y)*S-m<0||(u.x-a.x)*_+(u.y-a.y)*S-m<0||(h.x-a.x)*_+(h.y-a.y)*S-m<0)}function Oi(a,t,s,u,h,m,_){return!(ns(a,t,u,h,m,_)||ns(t,s,u,h,m,_)||ns(s,a,u,h,m,_)||ns(u,h,a,t,s,_)||ns(h,m,a,t,s,_)||ns(m,u,a,t,s,_))}function nr(a,t,s){const u=t.paint.get(a).value;return u.kind==="constant"?u.value:s.programConfigurations.get(t.id).getMaxValue(a)}function Si(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function zr(a,t,s,u,h){if(!t[0]&&!t[1])return a;const m=Qt.convert(t)._mult(h);s==="viewport"&&m._rotate(-u);const _=[];for(let S=0;S<a.length;S++)_.push(a[S].sub(m));return _}function ai(a,t,s,u){const h=Qt.convert(a)._mult(u);return t==="viewport"&&h._rotate(-s),h}let Xr,hi;function Fs(a,t,s){var u=2*Math.PI*6378137/256/Math.pow(2,s);return[a*u-2*Math.PI*6378137/2,t*u-2*Math.PI*6378137/2]}un(dn,"CircleBucket",{omit:["layers"]});class br{constructor(t,s,u){this.z=t,this.x=s,this.y=u,this.key=oo(0,t,t,s,u)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,s){const u=function(m,_,S){var E=Fs(256*m,256*(_=Math.pow(2,S)-_-1),S),A=Fs(256*(m+1),256*(_+1),S);return E[0]+","+E[1]+","+A[0]+","+A[1]}(this.x,this.y,this.z),h=function(m,_,S){let E,A="";for(let D=m;D>0;D--)E=1<<D-1,A+=(_&E?1:0)+(S&E?2:0);return A}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(s==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",h).replace("{bbox-epsg-3857}",u)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Ks{constructor(t,s){this.wrap=t,this.canonical=s,this.key=oo(t,s.z,s.z,s.x,s.y)}}class ls{constructor(t,s,u,h,m){this.overscaledZ=t,this.wrap=s,this.canonical=new br(u,+h,+m),this.key=s===0&&t===u?this.canonical.key:oo(s,t,u,h,m)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const s=this.canonical.z-t;return t>this.canonical.z?new ls(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ls(t,this.wrap,t,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(t,s=!0){if(this.overscaledZ===t&&s)return this.key;if(t>this.canonical.z)return oo(this.wrap*+s,t,this.canonical.z,this.canonical.x,this.canonical.y);{const u=this.canonical.z-t;return oo(this.wrap*+s,t,t,this.canonical.x>>u,this.canonical.y>>u)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const s=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.z<this.canonical.z&&t.canonical.x===this.canonical.x>>s&&t.canonical.y===this.canonical.y>>s}children(t){if(this.overscaledZ>=t)return[new ls(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,u=2*this.canonical.x,h=2*this.canonical.y;return[new ls(s,this.wrap,s,u,h),new ls(s,this.wrap,s,u+1,h),new ls(s,this.wrap,s,u,h+1),new ls(s,this.wrap,s,u+1,h+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new ls(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new ls(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Ks(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function oo(a,t,s,u,h){const m=1<<Math.min(s,22);let _=m*(h%m)+u%m;return a&&s<22&&(_+=m*m*((a<0?-2*a-1:2*a)%(1<<2*(22-s)))),16*(32*_+s)+(t-s)}const ll=[a=>{let t=a.canonical.x-1,s=a.wrap;return t<0&&(t=(1<<a.canonical.z)-1,s--),new ls(a.overscaledZ,s,a.canonical.z,t,a.canonical.y)},a=>{let t=a.canonical.x+1,s=a.wrap;return t===1<<a.canonical.z&&(t=0,s++),new ls(a.overscaledZ,s,a.canonical.z,t,a.canonical.y)},a=>new ls(a.overscaledZ,a.wrap,a.canonical.z,a.canonical.x,(a.canonical.y===0?1<<a.canonical.z:a.canonical.y)-1),a=>new ls(a.overscaledZ,a.wrap,a.canonical.z,a.canonical.x,a.canonical.y===(1<<a.canonical.z)-1?0:a.canonical.y+1)];un(br,"CanonicalTileID"),un(ls,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const Wl=Vr([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Jo}=Wl,Fa=Vr([{name:"a_pos_3",components:3,type:"Int16"}]);var Bs=Vr([{name:"a_pos",type:"Int16",components:2}]);class Na{constructor(t,s){this.pos=t,this.dir=s}intersectsPlane(t,s,u){const h=Ei(s,this.dir);if(Math.abs(h)<1e-6)return!1;const m=((t[0]-this.pos[0])*s[0]+(t[1]-this.pos[1])*s[1])/h;return u[0]=this.pos[0]+this.dir[0]*m,u[1]=this.pos[1]+this.dir[1]*m,!0}}class cl{constructor(t,s){this.pos=t,this.dir=s}intersectsPlane(t,s,u){const h=st(s,this.dir);if(Math.abs(h)<1e-6)return!1;const m=((t[0]-this.pos[0])*s[0]+(t[1]-this.pos[1])*s[1]+(t[2]-this.pos[2])*s[2])/h;return u[0]=this.pos[0]+this.dir[0]*m,u[1]=this.pos[1]+this.dir[1]*m,u[2]=this.pos[2]+this.dir[2]*m,!0}closestPointOnSphere(t,s,u){if(function(G,W){var Q=G[0],ae=G[1],ce=G[2],we=W[0],ve=W[1],ee=W[2];return Math.abs(Q-we)<=I*Math.max(1,Math.abs(Q),Math.abs(we))&&Math.abs(ae-ve)<=I*Math.max(1,Math.abs(ae),Math.abs(ve))&&Math.abs(ce-ee)<=I*Math.max(1,Math.abs(ce),Math.abs(ee))}(this.pos,t)||s===0)return u[0]=u[1]=u[2]=0,!1;const[h,m,_]=this.dir,S=this.pos[0]-t[0],E=this.pos[1]-t[1],A=this.pos[2]-t[2],D=h*h+m*m+_*_,O=2*(S*h+E*m+A*_),F=O*O-4*D*(S*S+E*E+A*A-s*s);if(F<0){const G=Math.max(-O/2,0),W=S+h*G,Q=E+m*G,ae=A+_*G,ce=Math.hypot(W,Q,ae);return u[0]=W*s/ce,u[1]=Q*s/ce,u[2]=ae*s/ce,!1}{const G=(-O-Math.sqrt(F))/(2*D);if(G<0){const W=Math.hypot(S,E,A);return u[0]=S*s/W,u[1]=E*s/W,u[2]=A*s/W,!1}return u[0]=S+h*G,u[1]=E+m*G,u[2]=A+_*G,!0}}}class va{constructor(t,s,u,h,m){this.TL=t,this.TR=s,this.BR=u,this.BL=h,this.horizon=m}static fromInvProjectionMatrix(t,s,u){const h=[-1,1,1],m=[1,1,1],_=[1,-1,1],S=[-1,-1,1],E=cn(h,h,t),A=cn(m,m,t),D=cn(_,_,t),O=cn(S,S,t);return new va(E,A,D,O,s/u)}}function ql(a,t,s){let u=1/0,h=-1/0;const m=[];for(const _ of a){An(m,_,t);const S=st(m,s);u=Math.min(u,S),h=Math.max(h,S)}return[u,h]}function Zl(a,t){let s=!0;for(let u=0;u<a.planes.length;u++){const h=a.planes[u];let m=0;for(let _=0;_<t.length;_++)m+=st(h,t[_])+h[3]>=0;if(m===0)return 0;m!==t.length&&(s=!1)}return s?2:1}function sd(a,t){for(const s of a.projections){const u=ql(t,a.points[0],s.axis);if(s.projection[1]<u[0]||s.projection[0]>u[1])return 0}return 1}function ah(a,t){let s=0;const u=[0,0,0,0];for(let _=0;_<a.length;_++)u[0]=a[_][0],u[1]=a[_][1],u[2]=a[_][2],u[3]=1,(h=u)[0]*(m=t)[0]+h[1]*m[1]+h[2]*m[2]+h[3]*m[3]>=0&&s++;var h,m;return s}class od{constructor(t,s){this.points=t||new Array(8).fill([0,0,0]),this.planes=s||new Array(6).fill([0,0,0,0]),this.bounds=Ai.fromPoints(this.points),this.projections=[],this.frustumEdges=[An([],this.points[2],this.points[3]),An([],this.points[0],this.points[3]),An([],this.points[4],this.points[0]),An([],this.points[5],this.points[1]),An([],this.points[6],this.points[2]),An([],this.points[7],this.points[3])];for(const u of this.frustumEdges){const h=[0,-u[2],u[1]],m=[u[2],0,-u[0]];this.projections.push({axis:h,projection:ql(this.points,this.points[0],h)}),this.projections.push({axis:m,projection:ql(this.points,this.points[0],m)})}}static fromInvProjectionMatrix(t,s,u,h){const m=Math.pow(2,u),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(A=>{const D=Xn([],A,t),O=1/D[3]/s*m;return(F=D)[0]=(G=D)[0]*(W=[O,O,h?1/D[3]:O,O])[0],F[1]=G[1]*W[1],F[2]=G[2]*W[2],F[3]=G[3]*W[3],F;var F,G,W}),S=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(A=>{const D=We([],Bt([],An([],_[A[0]],_[A[1]]),An([],_[A[2]],_[A[1]]))),O=-st(D,_[A[1]]);return D.concat(O)}),E=[];for(let A=0;A<_.length;A++)E.push([_[A][0],_[A][1],_[A][2]]);return new od(E,S)}intersectsPrecise(t,s,u){for(let h=0;h<s.length;h++)if(!ah(t,s[h]))return 0;for(let h=0;h<this.planes.length;h++)if(!ah(t,this.planes[h]))return 0;for(const h of u)for(const m of this.frustumEdges){const _=Bt([],h,m),S=_t(_);if(S===0)continue;ct(_,_,1/S);const E=ql(this.points,this.points[0],_),A=ql(t,this.points[0],_);if(E[0]>A[1]||A[0]>E[1])return 0}return 1}containsPoint(t){for(const s of this.planes){const u=s[3];if(st([s[0],s[1],s[2]],t)+u<0)return!1}return!0}}class Ai{static fromPoints(t){const s=[1/0,1/0,1/0],u=[-1/0,-1/0,-1/0];for(const h of t)tt(s,s,h),Rt(u,u,h);return new Ai(s,u)}static fromTileIdAndHeight(t,s,u){const h=1<<t.canonical.z,m=t.canonical.x,_=t.canonical.y;return new Ai([m/h,_/h,s],[(m+1)/h,(_+1)/h,u])}static applyTransform(t,s){const u=t.getCorners();for(let h=0;h<u.length;++h)cn(u[h],u[h],s);return Ai.fromPoints(u)}static applyTransformFast(t,s){const u=[s[12],s[13],s[14]],h=[...u];for(let m=0;m<3;m++)for(let _=0;_<3;_++){const S=s[4*_+m],E=S*t.min[_],A=S*t.max[_];u[m]+=Math.min(E,A),h[m]+=Math.max(E,A)}return new Ai(u,h)}static projectAabbCorners(t,s){const u=t.getCorners();for(let h=0;h<u.length;++h)cn(u[h],u[h],s);return u}constructor(t,s){this.min=t,this.max=s,this.center=ct([],Ge([],this.min,this.max),.5)}quadrant(t){const s=[t%2==0,t<2],u=lt(this.min),h=lt(this.max);for(let m=0;m<s.length;m++)u[m]=s[m]?this.min[m]:this.center[m],h[m]=s[m]?this.center[m]:this.max[m];return h[2]=this.max[2],new Ai(u,h)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}getCorners(){const t=this.min,s=this.max;return[[t[0],t[1],t[2]],[s[0],t[1],t[2]],[s[0],s[1],t[2]],[t[0],s[1],t[2]],[t[0],t[1],s[2]],[s[0],t[1],s[2]],[s[0],s[1],s[2]],[t[0],s[1],s[2]]]}intersects(t){return this.intersectsAabb(t.bounds)?Zl(t,this.getCorners()):0}intersectsFlat(t){return this.intersectsAabb(t.bounds)?Zl(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(t,s){return s||this.intersects(t)?sd(t,this.getCorners()):0}intersectsPreciseFlat(t,s){return s||this.intersectsFlat(t)?sd(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(t){for(let s=0;s<3;++s)if(this.min[s]>t.max[s]||t.min[s]>this.max[s])return!1;return!0}intersectsAabbXY(t){return!(this.min[0]>t.max[0]||t.min[0]>this.max[0]||this.min[1]>t.max[1]||t.min[1]>this.max[1])}encapsulate(t){for(let s=0;s<3;s++)this.min[s]=Math.min(this.min[s],t.min[s]),this.max[s]=Math.max(this.max[s],t.max[s])}encapsulatePoint(t){for(let s=0;s<3;s++)this.min[s]=Math.min(this.min[s],t[s]),this.max[s]=Math.max(this.max[s],t[s])}closestPoint(t){return[Math.max(Math.min(this.max[0],t[0]),this.min[0]),Math.max(Math.min(this.max[1],t[1]),this.min[1]),Math.max(Math.min(this.max[2],t[2]),this.min[2])]}}function hu(a){return a*w/te}un(Ai,"Aabb");const Rm=[new Ai([H,H,H],[$,$,$]),new Ai([H,H,H],[0,0,$]),new Ai([0,H,H],[$,0,$]),new Ai([H,0,H],[0,$,$]),new Ai([0,0,H],[$,$,$])];function ay(a,t,s,u=!0){const h=ct([],a._camera.position,a.worldSize),m=[t,s,1,1];Xn(m,m,a.pixelMatrixInverse),Gr(m,m,1/m[3]);const _=We([],An([],m,h)),S=a.globeMatrix,E=[S[12],S[13],S[14]],A=An([],E,h),D=_t(A),O=We([],A),F=a.worldSize/(2*Math.PI),G=st(O,_),W=Math.asin(F/D);if(W<Math.acos(G)){if(!u)return null;const Ze=[],et=[];ct(Ze,_,D/G),We(et,An(et,Ze,A)),We(_,Ge(_,A,ct(_,et,Math.tan(W)*D)))}const Q=[];new cl(h,_).closestPointOnSphere(E,F,Q);const ae=We([],Es(S,0)),ce=We([],Es(S,1)),we=We([],Es(S,2)),ve=st(ae,Q),ee=st(ce,Q),ge=st(we,Q),be=me(Math.asin(-ee/F));let Ie=me(Math.atan2(ve,ge));Ie=a.center.lng+function(Ze,et){const St=(et-Ze+180)%360-180;return St<-180?St+360:St}(a.center.lng,Ie);const Fe=De(Ie),$e=Xe(Me(be),0,1);return new dt(Fe,$e)}class ix{constructor(t,s,u){this.a=An([],t,u),this.b=An([],s,u),this.center=u;const h=We([],this.a),m=We([],this.b);this.angle=Math.acos(st(h,m))}}function yp(a,t){if(a.angle===0)return null;let s;return s=a.a[t]===0?1/a.angle*.5*Math.PI:1/a.angle*Math.atan(a.b[t]/a.a[t]/Math.sin(a.angle)-1/Math.tan(a.angle)),s<0||s>1?null:function(u,h,m,_){const S=Math.sin(m);return u*(Math.sin((1-_)*m)/S)+h*(Math.sin(_*m)/S)}(a.a[t],a.b[t],a.angle,Xe(s,0,1))+a.center[t]}function ul(a){if(a.z<=1)return Rm[a.z+2*a.y+a.x];const t=Lm(Mm(a));return Ai.fromPoints(t)}function fu(a,t,s){return ct(a,a,1-s),ze(a,a,t,s)}function Dg(a,t,s){for(const u of a)cn(u,u,t),ct(u,u,s)}function sx(a,t,s,u){const h=t/a.worldSize,m=a.globeMatrix;if(s.z<=1){const $e=ul(s).getCorners();return Dg($e,m,h),Ai.fromPoints($e)}const _=Mm(s,u),S=Lm(_,w+hu(a._tileCoverLift));Dg(S,m,h);const E=Number.MAX_VALUE,A=[-E,-E,-E],D=[E,E,E];if(_.contains(a.center)){for(const et of S)tt(D,D,et),Rt(A,A,et);A[2]=0;const $e=a.point,Ze=[$e.x*h,$e.y*h,0];return tt(D,D,Ze),Rt(A,A,Ze),new Ai(D,A)}if(a._tileCoverLift>0){for(const $e of S)tt(D,D,$e),Rt(A,A,$e);return new Ai(D,A)}const O=[m[12]*h,m[13]*h,m[14]*h],F=_.getCenter(),G=Xe(a.center.lat,-85.051129,rt),W=Xe(F.lat,-85.051129,rt),Q=De(a.center.lng),ae=Me(G);let ce=Q-De(F.lng);const we=ae-Me(W);ce>.5?ce-=1:ce<-.5&&(ce+=1);let ve=0;Math.abs(ce)>Math.abs(we)?ve=ce>=0?1:3:(ve=we>=0?0:2,ze(O,O,[m[4]*h,m[5]*h,m[6]*h],-Math.sin(ie(we>=0?_.getSouth():_.getNorth()))*w));const ee=S[ve],ge=S[(ve+1)%4],be=new ix(ee,ge,O),Ie=[yp(be,0)||ee[0],yp(be,1)||ee[1],yp(be,2)||ee[2]],Fe=ch(a.zoom);if(Fe>0){const $e=function({x:et,y:St,z:jt},kt,Ft,Gt,vt){const zt=1/(1<<jt);let gt=et*zt,bt=gt+zt,qt=St*zt,Kt=qt+zt,En=0;const _n=(gt+bt)/2-Gt;return _n>.5?En=-1:_n<-.5&&(En=1),gt=((gt+En)*kt-(Gt*=kt))*Ft+Gt,bt=((bt+En)*kt-Gt)*Ft+Gt,qt=(qt*kt-(vt*=kt))*Ft+vt,Kt=(Kt*kt-vt)*Ft+vt,[[gt,Kt,0],[bt,Kt,0],[bt,qt,0],[gt,qt,0]]}(s,t,a._pixelsPerMercatorPixel,Q,ae);for(let et=0;et<S.length;et++)fu(S[et],$e[et],Fe);const Ze=Ge([],$e[ve],$e[(ve+1)%4]);ct(Ze,Ze,.5),fu(Ie,Ze,Fe)}for(const $e of S)tt(D,D,$e),Rt(A,A,$e);return D[2]=Math.min(ee[2],ge[2]),tt(D,D,Ie),Rt(A,A,Ie),new Ai(D,A)}function Mm({x:a,y:t,z:s},u=!1){const h=1/(1<<s),m=new ne(Oe(a*h),t===(1<<s)-1&&u?-90:Ne((t+1)*h)),_=new ne(Oe((a+1)*h),t===0&&u?90:Ne(t*h));return new ye(m,_)}function Lm(a,t=w){const s=ie(a.getNorth()),u=ie(a.getSouth()),h=Math.cos(s),m=Math.cos(u),_=Math.sin(s),S=Math.sin(u),E=a.getWest(),A=a.getEast();return[q(m,S,E,t),q(m,S,A,t),q(h,_,A,t),q(h,_,E,t)]}function lh(a,t,s,u){const h=1<<s.z,m=(a/en+s.x)/h;return re(Ne((t/en+s.y)/h),Oe(m),u)}function vp({min:a,max:t}){return L/Math.max(t[0]-a[0],t[1]-a[1],t[2]-a[2])}const Dm=new Float64Array(16);function km(a){const t=vp(a),s=fe(Dm,[t,t,t]);return de(s,s,Ct([],a.min))}function ly(a){const t=(u=a.min,(s=Dm)[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=u[0],s[13]=u[1],s[14]=u[2],s[15]=1,s);var s,u;const h=1/vp(a);return ue(t,t,[h,h,h])}function xp(a){const t=en/(2*Math.PI);return a/(2*Math.PI)/t}function ox(a,t){return en/(512*Math.pow(2,a))*vp(ul(t))}function bp(a,t,s,u,h){const m=xp(s),_=[a,t,-s/(2*Math.PI)],S=Z(new Float64Array(16));return de(S,S,_),ue(S,S,[m,m,m]),pe(S,S,ie(-h)),he(S,S,ie(-u)),S}function ch(a){return Ke(C,P,a)}function Om(a,t){const s=re(t.lat,t.lng),u=function(W){const Q=re(W._center.lat,W._center.lng);let ae=Bt([],Ue(0,1,0),Q);const ce=_e([],-W.angle,Q);ae=cn(ae,ae,ce),_e(ce,-W._pitch,ae);const we=We([],Q);return ct(we,we,hu(W.cameraToCenterDistance/W.pixelsPerMeter)),cn(we,we,ce),Ge([],Q,we)}(a);return _=(h=at([],u,s))[0],S=h[1],E=h[2],A=(m=s)[0],D=m[1],O=m[2],G=(F=Math.sqrt(_*_+S*S+E*E)*Math.sqrt(A*A+D*D+O*O))&&st(h,m)/F,Math.acos(Math.min(Math.max(G,-1),1));var h,m,_,S,E,A,D,O,F,G}function g(a,t){return Om(a,t)>Math.PI/2*1.01}const b=ie(85),M=Math.cos(b),B=Math.sin(b),Y=X(),se=a=>{const t=[];return a.paint.get("circle-pitch-alignment")==="map"&&t.push("PITCH_WITH_MAP"),a.paint.get("circle-pitch-scale")==="map"&&t.push("SCALE_WITH_MAP"),t};function Re(a,t,s,u,h,m,_,S,E){if(m&&a.queryGeometry.isAboveHorizon)return!1;m&&(E*=a.pixelToTileUnitsFactor);const A=a.tileID.canonical,D=s.projection.upVectorScale(A,s.center.lat,s.worldSize).metersToTile;for(const O of t)for(const F of O){const G=F.add(S),W=h&&s.elevation?s.elevation.exaggeration()*h.getElevationAt(G.x,G.y,!0):0,Q=s.projection.projectTilePoint(G.x,G.y,A);if(W>0){const ve=s.projection.upVector(A,G.x,G.y);Q.x+=ve[0]*D*W,Q.y+=ve[1]*D*W,Q.z+=ve[2]*D*W}const ae=m?G:it(Q.x,Q.y,Q.z,u),ce=m?a.tilespaceRays.map(ve=>Mn(ve,W)):a.queryGeometry.screenGeometry,we=Xn([],[Q.x,Q.y,Q.z,1],u);if(!_&&m?E*=we[3]/s.cameraToCenterDistance:_&&!m&&(E*=s.cameraToCenterDistance/we[3]),m){const ve=Ne((F.y/en+A.y)/(1<<A.z));E/=s.projection.pixelsPerMeter(ve,1)/Pe(1,ve)}if(Hn(ce,ae,E))return!0}return!1}function it(a,t,s,u){const h=Xn([],[a,t,s,1],u);return new Qt(h[0]/h[3],h[1]/h[3])}const xt=Ue(0,0,0),Yt=Ue(0,0,1);function Mn(a,t){const s=He();return xt[2]=t,a.intersectsPlane(xt,Yt,s),new Qt(s[0],s[1])}class Dn extends dn{}let In,Kn,hr,_r;function Ys(a,{width:t,height:s},u,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==t*s*u)throw new RangeError("mismatched image size")}else h=new Uint8Array(t*s*u);return a.width=t,a.height=s,a.data=h,a}function Ut(a,t,s){const{width:u,height:h}=t;u===a.width&&h===a.height||(Pt(a,t,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,u),height:Math.min(a.height,h)},s,null),a.width=u,a.height=h,a.data=t.data)}function Pt(a,t,s,u,h,m,_,S){if(h.width===0||h.height===0)return t;if(h.width>a.width||h.height>a.height||s.x>a.width-h.width||s.y>a.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>t.width||h.height>t.height||u.x>t.width-h.width||u.y>t.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const E=a.data,A=t.data,D=m===4&&S;for(let O=0;O<h.height;O++){const F=((s.y+O)*a.width+s.x)*m,G=((u.y+O)*t.width+u.x)*m;if(D)for(let W=0;W<h.width;W++){const Q=F+W*m+3,ae=G+W*m;A[ae+0]=255,A[ae+1]=255,A[ae+2]=255,A[ae+3]=E[Q]}else if(_)for(let W=0;W<h.width;W++){const Q=F+W*m,ae=G+W*m,ce=E[Q+3],we=new xr(E[Q+0]/255*ce,E[Q+1]/255*ce,E[Q+2]/255*ce,ce).toRenderColor(_).toArray();A[ae+0]=we[0],A[ae+1]=we[1],A[ae+2]=we[2],A[ae+3]=we[3]}else for(let W=0;W<h.width*m;W++)A[G+W]=E[F+W]}return t}un(Dn,"HeatmapBucket",{omit:["layers"]});class $t{constructor(t,s){Ys(this,t,1,s)}resize(t){Ut(this,new $t(t),1)}clone(){return new $t({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,s,u,h,m){Pt(t,s,u,h,m,1,null)}}class Tn{constructor(t,s){Ys(this,t,4,s)}resize(t){Ut(this,new Tn(t),4)}replace(t,s){s?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Tn({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,s,u,h,m,_,S){Pt(t,s,u,h,m,4,_,S)}}class wr{constructor(t,s){this.width=t.width,this.height=t.height,this.data=s instanceof Uint8Array?new Float32Array(s.buffer):s}}function Rr(a){const t={},s=a.resolution||256,u=a.clips?a.clips.length:1,h=a.image||new Tn({width:s,height:u}),m=(_,S,E)=>{t[a.evaluationKey]=E;const A=a.expression.evaluate(t);A&&(h.data[_+S+0]=Math.floor(255*A.r/A.a),h.data[_+S+1]=Math.floor(255*A.g/A.a),h.data[_+S+2]=Math.floor(255*A.b/A.a),h.data[_+S+3]=Math.floor(255*A.a))};if(a.clips)for(let _=0,S=0;_<u;++_,S+=4*s)for(let E=0,A=0;E<s;E++,A+=4){const D=E/(s-1),{start:O,end:F}=a.clips[_];m(S,A,O*(1-D)+F*D)}else for(let _=0,S=0;_<s;_++,S+=4)m(0,S,_/(s-1));return h}un($t,"AlphaImage"),un(Tn,"RGBAImage");const Ur=Vr([{name:"a_pos",components:2,type:"Int16"}],4),Qr=Vr([{name:"a_road_z_offset",components:1,type:"Float32"}],4),Bo=Vr([{name:"a_pos",components:2,type:"Int16"},{name:"a_height",components:1,type:"Float32"}],4),ts=Vr([{name:"a_pos_normal_3",components:3,type:"Int16"}],4);function Xl(a,t,s=2){const u=t&&t.length,h=u?t[0]*s:a.length;let m=ax(a,0,h,s,!0);const _=[];if(!m||m.next===m.prev)return _;let S,E,A;if(u&&(m=function(D,O,F,G){const W=[];for(let Q=0,ae=O.length;Q<ae;Q++){const ce=ax(D,O[Q]*G,Q<ae-1?O[Q+1]*G:D.length,G,!1);ce===ce.next&&(ce.steiner=!0),W.push(q5(ce))}W.sort(H5);for(let Q=0;Q<W.length;Q++)F=G5(W[Q],F);return F}(a,t,m,s)),a.length>80*s){S=1/0,E=1/0;let D=-1/0,O=-1/0;for(let F=s;F<h;F+=s){const G=a[F],W=a[F+1];G<S&&(S=G),W<E&&(E=W),G>D&&(D=G),W>O&&(O=W)}A=Math.max(D-S,O-E),A=A!==0?32767/A:0}return cy(m,_,s,S,E,A,0),_}function ax(a,t,s,u,h){let m;if(h===function(_,S,E,A){let D=0;for(let O=S,F=E-A;O<E;O+=A)D+=(_[F]-_[O])*(_[O+1]+_[F+1]),F=O;return D}(a,t,s,u)>0)for(let _=t;_<s;_+=u)m=NT(_/u|0,a[_],a[_+1],m);else for(let _=s-u;_>=t;_-=u)m=NT(_/u|0,a[_],a[_+1],m);return m&&kg(m,m.next)&&(hy(m),m=m.next),m}function zm(a,t){if(!a)return a;t||(t=a);let s,u=a;do if(s=!1,u.steiner||!kg(u,u.next)&&ao(u.prev,u,u.next)!==0)u=u.next;else{if(hy(u),u=t=u.prev,u===u.next)break;s=!0}while(s||u!==t);return t}function cy(a,t,s,u,h,m,_){if(!a)return;!_&&m&&function(E,A,D,O){let F=E;do F.z===0&&(F.z=hb(F.x,F.y,A,D,O)),F.prevZ=F.prev,F.nextZ=F.next,F=F.next;while(F!==E);F.prevZ.nextZ=null,F.prevZ=null,function(G){let W,Q=1;do{let ae,ce=G;G=null;let we=null;for(W=0;ce;){W++;let ve=ce,ee=0;for(let be=0;be<Q&&(ee++,ve=ve.nextZ,ve);be++);let ge=Q;for(;ee>0||ge>0&&ve;)ee!==0&&(ge===0||!ve||ce.z<=ve.z)?(ae=ce,ce=ce.nextZ,ee--):(ae=ve,ve=ve.nextZ,ge--),we?we.nextZ=ae:G=ae,ae.prevZ=we,we=ae;ce=ve}we.nextZ=null,Q*=2}while(W>1)}(F)}(a,u,h,m);let S=a;for(;a.prev!==a.next;){const E=a.prev,A=a.next;if(m?V5(a,u,h,m):B5(a))t.push(E.i,a.i,A.i),hy(a),a=A.next,S=A.next;else if((a=A)===S){_?_===1?cy(a=U5(zm(a),t),t,s,u,h,m,2):_===2&&$5(a,t,s,u,h,m):cy(zm(a),t,s,u,h,m,1);break}}}function B5(a){const t=a.prev,s=a,u=a.next;if(ao(t,s,u)>=0)return!1;const h=t.x,m=s.x,_=u.x,S=t.y,E=s.y,A=u.y,D=Math.min(h,m,_),O=Math.min(S,E,A),F=Math.max(h,m,_),G=Math.max(S,E,A);let W=u.next;for(;W!==t;){if(W.x>=D&&W.x<=F&&W.y>=O&&W.y<=G&&uy(h,S,m,E,_,A,W.x,W.y)&&ao(W.prev,W,W.next)>=0)return!1;W=W.next}return!0}function V5(a,t,s,u){const h=a.prev,m=a,_=a.next;if(ao(h,m,_)>=0)return!1;const S=h.x,E=m.x,A=_.x,D=h.y,O=m.y,F=_.y,G=Math.min(S,E,A),W=Math.min(D,O,F),Q=Math.max(S,E,A),ae=Math.max(D,O,F),ce=hb(G,W,t,s,u),we=hb(Q,ae,t,s,u);let ve=a.prevZ,ee=a.nextZ;for(;ve&&ve.z>=ce&&ee&&ee.z<=we;){if(ve.x>=G&&ve.x<=Q&&ve.y>=W&&ve.y<=ae&&ve!==h&&ve!==_&&uy(S,D,E,O,A,F,ve.x,ve.y)&&ao(ve.prev,ve,ve.next)>=0||(ve=ve.prevZ,ee.x>=G&&ee.x<=Q&&ee.y>=W&&ee.y<=ae&&ee!==h&&ee!==_&&uy(S,D,E,O,A,F,ee.x,ee.y)&&ao(ee.prev,ee,ee.next)>=0))return!1;ee=ee.nextZ}for(;ve&&ve.z>=ce;){if(ve.x>=G&&ve.x<=Q&&ve.y>=W&&ve.y<=ae&&ve!==h&&ve!==_&&uy(S,D,E,O,A,F,ve.x,ve.y)&&ao(ve.prev,ve,ve.next)>=0)return!1;ve=ve.prevZ}for(;ee&&ee.z<=we;){if(ee.x>=G&&ee.x<=Q&&ee.y>=W&&ee.y<=ae&&ee!==h&&ee!==_&&uy(S,D,E,O,A,F,ee.x,ee.y)&&ao(ee.prev,ee,ee.next)>=0)return!1;ee=ee.nextZ}return!0}function U5(a,t){let s=a;do{const u=s.prev,h=s.next.next;!kg(u,h)&&zT(u,s,s.next,h)&&dy(u,h)&&dy(h,u)&&(t.push(u.i,s.i,h.i),hy(s),hy(s.next),s=a=h),s=s.next}while(s!==a);return zm(s)}function $5(a,t,s,u,h,m){let _=a;do{let S=_.next.next;for(;S!==_.prev;){if(_.i!==S.i&&Z5(_,S)){let E=FT(_,S);return _=zm(_,_.next),E=zm(E,E.next),cy(_,t,s,u,h,m,0),void cy(E,t,s,u,h,m,0)}S=S.next}_=_.next}while(_!==a)}function H5(a,t){let s=a.x-t.x;return s===0&&(s=a.y-t.y,s===0)&&(s=(a.next.y-a.y)/(a.next.x-a.x)-(t.next.y-t.y)/(t.next.x-t.x)),s}function G5(a,t){const s=function(h,m){let _=m;const S=h.x,E=h.y;let A,D=-1/0;if(kg(h,_))return _;do{if(kg(h,_.next))return _.next;if(E<=_.y&&E>=_.next.y&&_.next.y!==_.y){const Q=_.x+(E-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(Q<=S&&Q>D&&(D=Q,A=_.x<_.next.x?_:_.next,Q===S))return A}_=_.next}while(_!==m);if(!A)return null;const O=A,F=A.x,G=A.y;let W=1/0;_=A;do{if(S>=_.x&&_.x>=F&&S!==_.x&&OT(E<G?S:D,E,F,G,E<G?D:S,E,_.x,_.y)){const Q=Math.abs(E-_.y)/(S-_.x);dy(_,h)&&(Q<W||Q===W&&(_.x>A.x||_.x===A.x&&W5(A,_)))&&(A=_,W=Q)}_=_.next}while(_!==O);return A}(a,t);if(!s)return t;const u=FT(s,a);return zm(u,u.next),zm(s,s.next)}function W5(a,t){return ao(a.prev,a,t.prev)<0&&ao(t.next,a,a.next)<0}function hb(a,t,s,u,h){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-s)*h|0)|a<<8))|a<<4))|a<<2))|a<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-u)*h|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function q5(a){let t=a,s=a;do(t.x<s.x||t.x===s.x&&t.y<s.y)&&(s=t),t=t.next;while(t!==a);return s}function OT(a,t,s,u,h,m,_,S){return(h-_)*(t-S)>=(a-_)*(m-S)&&(a-_)*(u-S)>=(s-_)*(t-S)&&(s-_)*(m-S)>=(h-_)*(u-S)}function uy(a,t,s,u,h,m,_,S){return!(a===_&&t===S)&&OT(a,t,s,u,h,m,_,S)}function Z5(a,t){return a.next.i!==t.i&&a.prev.i!==t.i&&!function(s,u){let h=s;do{if(h.i!==s.i&&h.next.i!==s.i&&h.i!==u.i&&h.next.i!==u.i&&zT(h,h.next,s,u))return!0;h=h.next}while(h!==s);return!1}(a,t)&&(dy(a,t)&&dy(t,a)&&function(s,u){let h=s,m=!1;const _=(s.x+u.x)/2,S=(s.y+u.y)/2;do h.y>S!=h.next.y>S&&h.next.y!==h.y&&_<(h.next.x-h.x)*(S-h.y)/(h.next.y-h.y)+h.x&&(m=!m),h=h.next;while(h!==s);return m}(a,t)&&(ao(a.prev,a,t.prev)||ao(a,t.prev,t))||kg(a,t)&&ao(a.prev,a,a.next)>0&&ao(t.prev,t,t.next)>0)}function ao(a,t,s){return(t.y-a.y)*(s.x-t.x)-(t.x-a.x)*(s.y-t.y)}function kg(a,t){return a.x===t.x&&a.y===t.y}function zT(a,t,s,u){const h=cx(ao(a,t,s)),m=cx(ao(a,t,u)),_=cx(ao(s,u,a)),S=cx(ao(s,u,t));return h!==m&&_!==S||!(h!==0||!lx(a,s,t))||!(m!==0||!lx(a,u,t))||!(_!==0||!lx(s,a,u))||!(S!==0||!lx(s,t,u))}function lx(a,t,s){return t.x<=Math.max(a.x,s.x)&&t.x>=Math.min(a.x,s.x)&&t.y<=Math.max(a.y,s.y)&&t.y>=Math.min(a.y,s.y)}function cx(a){return a>0?1:a<0?-1:0}function dy(a,t){return ao(a.prev,a,a.next)<0?ao(a,t,a.next)>=0&&ao(a,a.prev,t)>=0:ao(a,t,a.prev)<0||ao(a,a.next,t)<0}function FT(a,t){const s=fb(a.i,a.x,a.y),u=fb(t.i,t.x,t.y),h=a.next,m=t.prev;return a.next=t,t.prev=a,s.next=h,h.prev=s,u.next=s,s.prev=u,m.next=u,u.prev=m,u}function NT(a,t,s,u){const h=fb(a,t,s);return u?(h.next=u.next,h.prev=u,u.next.prev=h,u.next=h):(h.prev=h,h.next=h),h}function hy(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function fb(a,t,s){return{i:a,x:t,y:s,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function ux(a,t){const s=a.length;if(s<=1)return[a];const u=[];let h,m;for(let _=0;_<s;_++){const S=Hr(a[_]);S!==0&&(a[_].area=Math.abs(S),m===void 0&&(m=S<0),m===S<0?(h&&u.push(h),h=[a[_]]):h.push(a[_]))}if(h&&u.push(h),t>1)for(let _=0;_<u.length;_++)u[_].length<=t||(cc(u[_],t,1,u[_].length-1,X5),u[_]=u[_].slice(0,t));return u}function X5(a,t){return t.area-a.area}function jT(a,t,s=1){if(!a)return null;const u=typeof a=="string"?Wo.from(a).getPrimary():a.getPrimary(),h=typeof a=="string"?null:a.getSecondary();for(const m of[u,h]){if(!m)continue;const _=m.id.toString();t.has(_)||t.set(_,[]),m.scaleSelf(s),t.get(_).push(m)}return{primary:u.toString(),secondary:h?h.toString():null}}function pb(a,t,s,u){const h=u.patternDependencies;let m=!1;for(const _ of t){const S=_.paint.get(`${a}-pattern`);S.isConstant()||(m=!0),jT(S.constantOr(null),h,s)&&(m=!0)}return m}function mb(a,t,s,u,h,m){const _=m.patternDependencies;for(const S of t){const E=S.paint.get(`${a}-pattern`).value;if(E.kind!=="constant"){let A=E.evaluate({zoom:u},s,{},m.availableImages);A=A&&A.name?A.name:A;const D=jT(A,_,h);if(!D)continue;const{primary:O,secondary:F}=D;O&&(s.patterns[S.id]=[O,F].filter(Boolean))}}return s}var gb,BT,_b,VT,yb,UT,$T,dx={};function HT(){if(BT)return gb;BT=1;var a=_d();function t(h,m,_,S,E){this.properties={},this.extent=_,this.type=0,this._pbf=h,this._geometry=-1,this._keys=S,this._values=E,h.readFields(s,this,m)}function s(h,m,_){h==1?m.id=_.readVarint():h==2?function(S,E){for(var A=S.readVarint()+S.pos;S.pos<A;){var D=E._keys[S.readVarint()],O=E._values[S.readVarint()];E.properties[D]=O}}(_,m):h==3?m.type=_.readVarint():h==4&&(m._geometry=_.pos)}function u(h){for(var m,_,S=0,E=0,A=h.length,D=A-1;E<A;D=E++)S+=((_=h[D]).x-(m=h[E]).x)*(m.y+_.y);return S}return gb=t,t.types=["Unknown","Point","LineString","Polygon"],t.prototype.loadGeometry=function(){var h=this._pbf;h.pos=this._geometry;for(var m,_=h.readVarint()+h.pos,S=1,E=0,A=0,D=0,O=[];h.pos<_;){if(E<=0){var F=h.readVarint();S=7&F,E=F>>3}if(E--,S===1||S===2)A+=h.readSVarint(),D+=h.readSVarint(),S===1&&(m&&O.push(m),m=[]),m.push(new a(A,D));else{if(S!==7)throw new Error("unknown command "+S);m&&m.push(m[0].clone())}}return m&&O.push(m),O},t.prototype.bbox=function(){var h=this._pbf;h.pos=this._geometry;for(var m=h.readVarint()+h.pos,_=1,S=0,E=0,A=0,D=1/0,O=-1/0,F=1/0,G=-1/0;h.pos<m;){if(S<=0){var W=h.readVarint();_=7&W,S=W>>3}if(S--,_===1||_===2)(E+=h.readSVarint())<D&&(D=E),E>O&&(O=E),(A+=h.readSVarint())<F&&(F=A),A>G&&(G=A);else if(_!==7)throw new Error("unknown command "+_)}return[D,F,O,G]},t.prototype.toGeoJSON=function(h,m,_){var S,E,A=this.extent*Math.pow(2,_),D=this.extent*h,O=this.extent*m,F=this.loadGeometry(),G=t.types[this.type];function W(ce){for(var we=0;we<ce.length;we++){var ve=ce[we];ce[we]=[360*(ve.x+D)/A-180,360/Math.PI*Math.atan(Math.exp((180-360*(ve.y+O)/A)*Math.PI/180))-90]}}switch(this.type){case 1:var Q=[];for(S=0;S<F.length;S++)Q[S]=F[S][0];W(F=Q);break;case 2:for(S=0;S<F.length;S++)W(F[S]);break;case 3:for(F=function(ce){var we=ce.length;if(we<=1)return[ce];for(var ve,ee,ge=[],be=0;be<we;be++){var Ie=u(ce[be]);Ie!==0&&(ee===void 0&&(ee=Ie<0),ee===Ie<0?(ve&&ge.push(ve),ve=[ce[be]]):ve.push(ce[be]))}return ve&&ge.push(ve),ge}(F),S=0;S<F.length;S++)for(E=0;E<F[S].length;E++)W(F[S][E])}F.length===1?F=F[0]:G="Multi"+G;var ae={type:"Feature",geometry:{type:G,coordinates:F},properties:this.properties};return"id"in this&&(ae.id=this.id),ae},gb}function GT(){if(VT)return _b;VT=1;var a=HT();function t(u,h){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(s,this,h),this.length=this._features.length}function s(u,h,m){u===15?h.version=m.readVarint():u===1?h.name=m.readString():u===5?h.extent=m.readVarint():u===2?h._features.push(m.pos):u===3?h._keys.push(m.readString()):u===4&&h._values.push(function(_){for(var S=null,E=_.readVarint()+_.pos;_.pos<E;){var A=_.readVarint()>>3;S=A===1?_.readString():A===2?_.readFloat():A===3?_.readDouble():A===4?_.readVarint64():A===5?_.readVarint():A===6?_.readSVarint():A===7?_.readBoolean():null}return S}(m))}return _b=t,t.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var h=this._pbf.readVarint()+this._pbf.pos;return new a(this._pbf,h,this.extent,this._keys,this._values)},_b}function WT(){return $T||($T=1,dx.VectorTile=function(){if(UT)return yb;UT=1;var a=GT();function t(s,u,h){if(s===3){var m=new a(h,h.readVarint()+h.pos);m.length&&(u[m.name]=m)}}return yb=function(s,u){this.layers=s.readFields(t,{},u)},yb}(),dx.VectorTileFeature=HT(),dx.VectorTileLayer=GT()),dx}var wp=WT();const Fm="3d_elevation_id",qT="level";class K5{constructor(){this._valid=!1}reset(t){return this.feature=t,this._valid=!0,this._geometry=t.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(t,s){return this._valid&&t(s(this._geometry)),this}require(t,s,u){return this.get(t,!0,s,u)}optional(t,s,u){return this.get(t,!1,s,u)}success(){return this._valid}get(t,s,u,h){const m=this.feature.properties.hasOwnProperty(t)?+this.feature.properties[t]:void 0;return this._valid&&m!==void 0&&!Number.isNaN(m)?u(h?h(m):m):s&&(this._valid=!1),this}}class ZT{constructor(t,s){this.featureFunc=t,this.vertexFunc=s}parseFeature(t,s,u){return this.featureFunc(t,s,u)}parseVertex(t,s,u){return this.vertexFunc(t,s,u)}}const Y5=new ZT((a,t,s)=>a.reset(t).require(Fm,u=>{s.id=u}).optional("fixed_height_relative",u=>{s.constantHeight=u},Nm.decodeRelativeHeight).geometry(u=>{s.bounds=u},Vf).success(),(a,t,s)=>a.reset(t).require(Fm,u=>{s.id=u}).require("elevation_idx",u=>{s.idx=u}).require("extent",u=>{s.extent=u}).require("height_relative",u=>{s.height=u},Nm.decodeRelativeHeight).geometry(u=>{s.position=u},Nm.getPoint).success()),J5=new ZT((a,t,s)=>a.reset(t).require(Fm,u=>{s.id=u}).optional("fixed_height",u=>{s.constantHeight=u},Nm.decodeMetricHeight).geometry(u=>{s.bounds=u},Vf).success(),(a,t,s)=>a.reset(t).require(Fm,u=>{s.id=u}).require("elevation_idx",u=>{s.idx=u}).require("extent",u=>{s.extent=u}).require("height",u=>{s.height=u},Nm.decodeMetricHeight).geometry(u=>{s.position=u},Nm.getPoint).success());class Nm{static getPoint(t){return Sr(t[0][0].x,t[0][0].y)}static decodeRelativeHeight(t){return 1e-4*t*5}static decodeMetricHeight(t){return 1e-4*t}static parse(t){const s=[],u=[],h=t.length,m=new K5;for(let S=0;S<h;S++){const E=t.feature(S),A=E.properties.hasOwnProperty("version")?String(E.properties.version):void 0,D=(_=A)?_==="1.0.1"?J5:void 0:Y5;if(D===void 0){gr(`Unknown elevation feature version number ${A||"(unknown)"}`);continue}const O=E.properties.hasOwnProperty("type")?E.properties.type:void 0;if(O){if(wp.VectorTileFeature.types[E.type]==="Point"&&O==="curve_point"){const F={};D.parseVertex(m,E,F)&&s.push(F)}else if(wp.VectorTileFeature.types[E.type]==="Polygon"&&O==="curve_meta"){const F={};D.parseFeature(m,E,F)&&u.push(F)}}}var _;return{vertices:s,features:u}}}class XT{constructor(t,s){this.feature=t,this.metersToTile=s,this.index=0}get(){const t=this.feature.vertices[this.index],s=this.feature.vertexProps[this.index].dir,u=s[1],h=-s[0],m=(t.extent+1)*this.metersToTile;return[new Qt(Math.trunc(t.position[0]+u*m),Math.trunc(t.position[1]+h*m)),new Qt(Math.trunc(t.position[0]-u*m),Math.trunc(t.position[1]-h*m))]}next(){this.index++}valid(){return this.index<this.feature.vertices.length}}class vb{constructor(t,s,u,h,m,_){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this.id=t,this.heightRange={min:u,max:u},this.safeArea=s,this.constantHeight=u,this.constantHeight==null&&(this.constantHeight!=null||h.length!==0)){this.vertices=h,this.edges=m,this.edges=this.edges.filter(S=>{return S.a<this.vertices.length&&S.b<this.vertices.length&&!((E=this.vertices[S.a].position)[0]===(A=this.vertices[S.b].position)[0]&&E[1]===A[1]);var E,A}),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const S of this.vertices)this.vertexProps.push({dir:Sr(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,S.height),this.heightRange.max=Math.max(this.heightRange.max,S.height);for(const S of this.edges){const E=this.vertices[S.a].position,A=this.vertices[S.b].position,D=Zr(ss(),A,E),O=ho(D),F=Ki(ss(),D,1/O);this.edgeProps.push({vec:D,dir:F,len:O});const G=this.vertexProps[S.a].dir,W=this.vertexProps[S.b].dir;On(G,G,F),On(W,W,F)}for(const S of this.vertexProps)S.dir[0]===0&&S.dir[1]===0||gl(S.dir,S.dir);this.tessellate(_)}}pointElevation(t){if(this.constantHeight!=null)return this.constantHeight;const s=this.getClosestEdge(t);if(s==null)return 0;const[u,h]=s;return((m,_,S)=>(1-S)*m+S*_)(this.vertices[this.edges[u].a].height,this.vertices[this.edges[u].b].height,h)}getSafeArea(){return this.safeArea}isTunnel(){return this.heightRange.max<=-5}getClosestEdge(t){if(this.edges.length===0)return;let s=0,u=Number.POSITIVE_INFINITY,h=0;const m=Sr(t.x,t.y);for(let _=0;_<this.edges.length;_++){const S=this.edges[_],E=this.edgeProps[_].dir,A=new Na(m,this.edgeProps[_].dir),D=this.vertices[S.a].position,O=this.vertices[S.b].position,F=ss(),G=ss(),W=A.intersectsPlane(D,this.vertexProps[S.a].dir,F),Q=A.intersectsPlane(O,this.vertexProps[S.b].dir,G);if(!W||!Q)continue;const ae=Zr(ss(),G,F),ce=Zr(ss(),m,F),we=Ei(ae,ae),ve=we>0?Ei(ce,ae)/we:0,ee=Xe(ve,0,1),ge=Math.abs((ve-ee)*this.edgeProps[_].len),be=Zr(ss(),m,D),Ie=ge+Math.abs(Ei(be,Sr(E[1],-E[0])));Ie<u&&(s=_,u=Ie,h=ee)}return[s,h]}tessellate(t){for(let s=this.edges.length-1;s>=0;--s){const u=this.edges[s].a,h=this.edges[s].b,{position:m,height:_,extent:S}=this.vertices[u],{position:E,height:A,extent:D}=this.vertices[h],O=this.vertexProps[u].dir,F=this.vertexProps[h].dir,G=Ue(m[0]/t,m[1]/t,_),W=Ue(E[0]/t,E[1]/t,A),Q=Ue(O[1],-O[0],0);ct(Q,Q,S);const ae=Ue(F[1],-F[0],0);if(ct(ae,ae,D),this.distSqLines(Ue(G[0]+.5*Q[0],G[1]+.5*Q[1],G[2]+.5*Q[2]),Ue(W[0]-.5*ae[0],W[1]-.5*ae[1],W[2]-.5*ae[2]),Ue(G[0]-.5*Q[0],G[1]-.5*Q[1],G[2]-.5*Q[2]),Ue(W[0]+.5*ae[0],W[1]+.5*ae[1],W[2]+.5*ae[2]))<=.0025000000000000005)continue;const ce=this.vertices.length,we=On(ss(),m,E);this.vertices.push({position:Ki(we,we,.5),height:.5*(_+A),extent:.5*(S+D)});const ve=On(ss(),O,F);this.vertexProps.push({dir:gl(ve,ve)}),this.edges.splice(s,1),this.edgeProps.splice(s,1),this.edges.push({a:u,b:ce}),this.edges.push({a:ce,b:h});const ee=Zr(ss(),this.vertices[ce].position,m),ge=ho(ee),be={vec:ee,dir:Ki(ss(),ee,1/ge),len:ge};this.edgeProps.push(be),this.edgeProps.push(be)}}distSqLines(t,s,u,h){const m=at(He(),s,t),_=at(He(),h,u),S=at(He(),t,u),E=st(m,m),A=st(m,_),D=st(m,S),O=st(_,_),F=st(_,S),G=E*O-A*A;if(G===0){const ae=st(S,_)/st(_,_);return Ye(hn(He(),u,h,ae),t)}const W=(A*F-D*O)/G,Q=(E*F-A*D)/G;return Ye(hn(He(),t,s,W),hn(He(),u,h,Q))}}class xb{static parseFrom(t,s){const u=Nm.parse(t);if(!u)return[];let{vertices:h,features:m}=u;const _=1/Qe(s);m.sort((D,O)=>D.id-O.id),h.sort((D,O)=>D.id-O.id||D.idx-O.idx),h=h.filter((D,O,F)=>O===F.findIndex(G=>G.id===D.id&&G.idx===D.idx));const S=new Array;let E=0;const A=h.length;for(const D of m){if(D.constantHeight){S.push(new vb(D.id,D.bounds,D.constantHeight));continue}for(;E!==A&&h[E].id<D.id;)E++;if(E===A||h[E].id!==D.id)continue;const O=new Array,F=new Array,G=E;for(;E!==A&&h[E].id===D.id;){const W=h[E];if(O.push({position:W.position,height:W.height,extent:W.extent}),E!==G&&h[E-1].idx===W.idx-1){const Q=E-G;F.push({a:Q-1,b:Q})}E++}S.push(new vb(D.id,D.bounds,void 0,O,F,_))}return S}static getElevationFeature(t,s){if(!s)return;const u=+t.properties[Fm];return Number.isNaN(u)?void 0:s.find(h=>h.id===u)}}class KT{constructor(t,s){this.zScale=1,this.xOffset=0,this.yOffset=0,t.equals(s)||(this.zScale=Math.pow(2,s.z-t.z),this.xOffset=(t.x*this.zScale-s.x)*en,this.yOffset=(t.y*this.zScale-s.y)*en)}constantElevation(t,s){if(t.constantHeight!=null)return this.computeBiasedHeight(t.constantHeight,s)}pointElevation(t,s,u){const h=this.constantElevation(s,u);return h??(t.x=t.x*this.zScale+this.xOffset,t.y=t.y*this.zScale+this.yOffset,this.computeBiasedHeight(s.pointElevation(t),u))}computeBiasedHeight(t,s){return s<=0?t:t+s*Ke(0,s,t>=0?t:Math.abs(.5*t))}}un(vb,"ElevationFeature");class YT{constructor(){this.polygons=new Map}add(t,...s){this.polygons.has(t)?this.polygons.get(t).push(...s):this.polygons.set(t,s)}merge(t){for(const[s,u]of t.polygons)this.add(s,...u)}}class jm{constructor(){this.portals=[]}static evaluate(t){if(t.length===0)return new jm;let s=[];for(const A of t)s.push(...A.portals);if(s.length===0)return new jm;const u=(A,D)=>A<=0&&D<=0||A>=en&&D>=en;for(const A of s){const D=A.va,O=A.vb;(u(D.x,O.x)||u(D.y,O.y))&&(A.type="border")}const h=s.filter(A=>A.type!=="unevaluated"),m=s.filter(A=>A.type==="unevaluated");if(m.length===0)return new jm;m.sort((A,D)=>A.hash===D.hash?A.isTunnel===D.isTunnel?0:A.isTunnel?-1:1:A.hash<D.hash?1:-1),s=h.concat(m);let _=h.length,S=_,E=_;do if(S++,S===s.length||s[_].hash!==s[S].hash){if(S-_==2){E<_&&(s[E]=s[_],s[_]=null);const A=s[E],D=s[S-1];A.type=A.isTunnel!==D.isTunnel?"tunnel":"polygon",A.connection={a:A.connection.a,b:D.connection.a},E++}_=S}while(_!==s.length);return s.splice(E),s.sort((A,D)=>A.hash<D.hash?1:-1),{portals:s}}}un(jm,"ElevationPortalGraph"),un(YT,"ElevationPolygons");class Q5{constructor(t,s,u){this.outPositions=t,this.outNormals=s,this.outIndices=u,this.vertexLookup=new Map,this.buffer=new ArrayBuffer(4),this.view=new DataView(this.buffer)}addVertex(t,s,u){let h=t[2];u!=null&&(h*=u);const m=this.getVec3Bits(t)<<96n|this.getVec3Bits(s),_=this.vertexLookup.get(m);if(_!=null)return _;const S=this.outPositions.length;this.vertexLookup.set(m,S);const E=Math.trunc(16384*s[0]),A=Math.trunc(16384*s[1]),D=Math.trunc(16384*s[2]);return this.outPositions.emplaceBack(t[0],t[1],h),this.outNormals.emplaceBack(E,A,D),S}addVertices(t,s,...u){const h=[];for(const m of u){const _=this.addVertex(m,t,s);h.push(_)}return h}addTriangles(t,s,u){if(s&&u){const h=u.length===1,m=Ue(0,0,0);for(let _=0;_<t.length;_+=3){const S=s[t[_+0]],E=s[t[_+1]],A=s[t[_+2]],D=h?u[0]:u[t[_+1]],O=h?u[0]:u[t[_+2]],F=this.addVertex(Ue(S.x,S.y,h?u[0]:u[t[_+0]]),m),G=this.addVertex(Ue(E.x,E.y,D),m),W=this.addVertex(Ue(A.x,A.y,O),m);this.outIndices.emplaceBack(F,G,W)}}else for(let h=0;h<t.length;h+=3)this.outIndices.emplaceBack(t[h+0],t[h+1],t[h+2])}addQuad(t,s){const u=this.addVertices(s,void 0,...t.map(E=>Ue(E.coord.x,E.coord.y,E.height))),[h,m,_,S]=u;this.addTriangles([h,m,_,_,S,h])}getBits(t){return this.view.setFloat32(0,t),BigInt(this.view.getUint32(0))}getVec3Bits(t){return this.getBits(t[0])<<64n|this.getBits(t[1])<<32n|this.getBits(t[2])}}class Kl{constructor(t){this.unevaluatedPortals=new jm,this.portalPolygons=new YT,this.vertexHashLookup=new Map,this.unevalVertices=[],this.unevalHeights=[],this.unevalTriangles=[],this.unevalTunnelTriangles=[],this.unevalEdges=[],this.vertexPositions=new af,this.vertexNormals=new nh,this.indexArray=new gs,this.tileToMeters=Qe(t)}addVertices(t,s){const u=this.unevalVertices.length;for(let h=0;h<t.length;h++)this.unevalVertices.push(t[h]),this.unevalHeights.push(s[h]);return u}addTriangles(t,s,u){const h=u?this.unevalTunnelTriangles:this.unevalTriangles;for(const m of t)h.push(m+s)}addRenderableRing(t,s,u,h,m){const _=[new Qt(m.min.x,m.min.y),new Qt(m.max.x,m.min.y),new Qt(m.max.x,m.max.y),new Qt(m.min.x,m.max.y)];for(let S=0;S<u-1;S++){const E=s+S,A=E+1,D=this.unevalVertices[E],O=this.unevalVertices[A];if(!(D.x>=m.min.x&&D.x<=m.max.x&&D.y>=m.min.y&&D.y<=m.max.y||O.x>=m.min.x&&O.x<=m.max.x&&O.y>=m.min.y&&O.y<=m.max.y||Gi(D,O,_))||this.isOnBorder(D.x,O.x)||this.isOnBorder(D.y,O.y))continue;const F=Kl.computeEdgeHash(this.unevalVertices[E],this.unevalVertices[A]);let G,W=this.vertexHashLookup.get(Kl.computePosHash(D));W!=null?G=W.next:(W=this.vertexHashLookup.get(Kl.computePosHash(O)),G=W!=null?W.prev:F),this.unevalEdges.push({polygonIdx:t,a:E,b:A,hash:F,portalHash:G,isTunnel:h,type:"unevaluated"})}}addPortalCandidates(t,s,u,h,m){if(s.length===0)return;this.portalPolygons.add(t,{geometry:s,zLevel:m});const _=s[0];this.vertexHashLookup.clear();let S=Kl.computeEdgeHash(_[_.length-2],_[_.length-1]);for(let E=0;E<_.length-1;E++){const A=_[E+0],D=_[E+1],O=Sr(D.x-A.x,D.y-A.y),F=ho(O);if(F===0)continue;let G="unevaluated";const W=h.pointElevation(A),Q=h.pointElevation(D);Math.abs(W)<.01&&Math.abs(Q)<.01?G="entrance":(this.isOnBorder(A.x,D.x)||this.isOnBorder(A.y,D.y))&&(G="border");const ae=Kl.computeEdgeHash(A,D);this.unevaluatedPortals.portals.push({connection:{a:t,b:void 0},va:A,vb:D,vab:O,length:F,hash:ae,isTunnel:u,type:G});const ce=Kl.computePosHash(A);this.vertexHashLookup.set(ce,{prev:S,next:ae}),S=ae}}construct(t){if(this.unevalVertices.length===0)return;const s=()=>({vertexOffset:0,primitiveOffset:this.indexArray.length}),u=O=>{O.primitiveLength=this.indexArray.length-O.primitiveOffset},h=new Q5(this.vertexPositions,this.vertexNormals,this.indexArray);this.prepareEdges(t.portals,this.unevalEdges);const m=s(),_=s(),S=s(),E=(O,F)=>{O.sort((W,Q)=>W.type===F&&Q.type!==F?-1:W.type!==F&&Q.type===F?1:0);const G=O.findIndex(W=>W.type!==F);return G>=0?G:O.length};let A=0;this.unevalEdges.length>0&&(A=E(this.unevalEdges,"none"),this.constructBridgeStructures(h,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:A},this.tileToMeters));const D=s();if(this.unevalEdges.length>0){const O=this.unevalEdges.splice(A),F=E(O,"tunnel")+A;this.unevalEdges.push(...O),this.constructTunnelStructures(h,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:A},{min:A,max:F})}u(S),h.addTriangles(this.unevalTriangles,this.unevalVertices,this.unevalHeights),u(D),h.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,this.unevalHeights),u(_),h.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,[-.1]),u(m),this.maskSegments=ki.simpleSegment(0,D.primitiveOffset,0,D.primitiveLength),this.depthSegments=ki.simpleSegment(0,_.primitiveOffset,0,_.primitiveLength),this.renderableSegments=ki.simpleSegment(0,S.primitiveOffset,0,S.primitiveLength),this.shadowCasterSegments=ki.simpleSegment(0,m.primitiveOffset,0,m.primitiveLength)}upload(t){this.vertexBuffer||this.vertexPositions.length===0||this.vertexNormals.length===0||this.indexArray.length===0||(this.vertexBuffer=t.createVertexBuffer(this.vertexPositions,Bo.members),this.vertexBufferNormal=t.createVertexBuffer(this.vertexNormals,ts.members),this.indexBuffer=t.createIndexBuffer(this.indexArray))}destroy(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBufferNormal.destroy(),this.indexBuffer.destroy()),this.maskSegments&&(this.maskSegments.destroy(),this.depthSegments.destroy(),this.renderableSegments.destroy(),this.shadowCasterSegments.destroy())}computeVertexConnections(t,s,u,h,m){const _=new Map;for(let S=h;S<m;S++){const E=u[S],A=E.a,D=E.b,O=Kl.computePosHash(t[A]),F=Kl.computePosHash(t[D]);_.has(O)||_.set(O,{}),_.has(F)||_.set(F,{});const G=_.get(O),W=_.get(F);s[A]<=0&&s[D]<=0||(G.to=D,W.from=A)}return _}constructBridgeStructures(t,s,u,h,m,_){const S=this.computeVertexConnections(s,u,h,m.min,m.max),E=1/_,A=.5*E,D=F=>Ue(s[F].x,s[F].y,u[F]*E),O=F=>{const G=S.get(Kl.computePosHash(s[F])),W=G.from,Q=G.to;if(!W||!Q)return;const ae=D(W),ce=D(F),we=D(Q),ve=Ue(0,0,0);if(!Vn(ae,ce)){const ge=An(He(),ce,ae);Ge(ve,ve,We(ge,ge))}if(!Vn(we,ce)){const ge=An(He(),we,ce);Ge(ve,ve,We(ge,ge))}const ee=mn(ve);return ee>0?ct(ve,ve,1/ee):void 0};for(let F=m.min;F<m.max;F++){const G=h[F],W=this.prepareEdgePoints(s,u,G,(Wt,Wn)=>Wt>Wn);if(W==null)continue;const Q=W[0],ae=W[1],ce=Ue(Q.coord.x,Q.coord.y,E*Q.height),we=Ue(ae.coord.x,ae.coord.y,E*ae.height);if(Vn(ce,we))continue;const ve=An(He(),we,ce);We(ve,ve);const ee=Wt=>We(Wt,Wt),ge=O(G.a)||ve,be=O(G.b)||ve,Ie=ee(Ue(ge[1],-ge[0],0)),Fe=ee(Ue(be[1],-be[0],0)),$e=ee(Bt(He(),Ie,ge)),Ze=ee(Bt(He(),Fe,be)),et=He(),St=[Ge(He(),ce,ct(et,An(et,Ie,$e),A)),Ge(He(),ce,ct(et,Ge(et,Ie,$e),A)),Ge(He(),ce,ct(et,$e,A)),ce],jt=[Ge(He(),we,ct(et,An(et,Fe,Ze),A)),Ge(He(),we,ct(et,Ge(et,Fe,Ze),A)),Ge(He(),we,ct(et,Ze,A)),we],[kt,Ft]=t.addVertices(Ie,_,St[0],St[1]),[Gt,vt]=t.addVertices(Fe,_,jt[0],jt[1]);t.addTriangles([kt,Ft,Gt,Ft,vt,Gt]);const[zt,gt]=t.addVertices($e,_,St[1],St[2]),[bt,qt]=t.addVertices(Ze,_,jt[1],jt[2]);t.addTriangles([zt,gt,bt,gt,qt,bt]);const[Kt,En]=t.addVertices(Ct(Ie,Ie),_,St[2],St[3]),[_n,sn]=t.addVertices(Ct(Fe,Fe),_,jt[2],jt[3]);t.addTriangles([Kt,En,_n,En,sn,_n])}}constructTunnelStructures(t,s,u,h,m,_){const S=E=>We(E,E);for(let E=m.min;E<m.max;E++){const A=this.prepareEdgePoints(s,u,h[E],(G,W)=>G<W);if(A==null)continue;const[D,O]=A,F=S(Ue(O.coord.y-D.coord.y,-(O.coord.x-D.coord.x),0));t.addQuad([D,O,{coord:O.coord,height:h[E].isTunnel?-.1:0},{coord:D.coord,height:h[E].isTunnel?-.1:0}],F)}for(let E=_.min;E<_.max;E++){const A=h[E],D=s[A.a],O=s[A.b],F=S(Ue(O.y-D.y,-(O.x-D.x),0));t.addQuad([{coord:O,height:0},{coord:D,height:0},{coord:D,height:u[A.a]+4},{coord:O,height:u[A.b]+4}],F),t.addQuad([{coord:D,height:0},{coord:O,height:0},{coord:O,height:u[A.b]+4},{coord:D,height:u[A.a]+4}],F)}}prepareEdgePoints(t,s,u,h){let m=s[u.a],_=s[u.b];const S=h(m,0),E=h(_,0);if(S&&E)return[{coord:t[u.a],height:m},{coord:t[u.b],height:_}];if(!S&&!E)return;const A=t[u.a].clone(),D=t[u.b].clone();if(S){if(!E){const O=_/(_-m);D.x=kn(D.x,A.x,O),D.y=kn(D.y,A.y,O),_=kn(_,m,O)}}else{const O=m/(m-_);A.x=kn(A.x,D.x,O),A.y=kn(A.y,D.y,O),m=kn(m,_,O)}return[{coord:A,height:m},{coord:D,height:_}]}prepareEdges(t,s){if(s.length===0)return;s.sort((S,E)=>S.hash===E.hash?E.polygonIdx-S.polygonIdx:E.hash>S.hash?1:-1);let u=0,h=0,m=0,_=s[u].polygonIdx;do h++,(h===s.length||s[u].hash!==s[h].hash)&&((h-u==1||s[h-1].polygonIdx!==_)&&(m<u&&(s[m]=s[u],s[u]=null),s[m].type="none",m++),u=h,u!==s.length&&(_=s[u].polygonIdx));while(u!==s.length);if(s.splice(m),s.length!==0&&t.length!==0){s.sort((A,D)=>A.portalHash<D.portalHash?1:-1);let S=0,E=0;for(;S!==s.length&&E!==t.length;){const A=s[S],D=t[E];A.portalHash>D.hash?S++:D.hash>A.portalHash?E++:(A.type=D.type,S++)}}}isOnBorder(t,s){return t<=0&&s<=0||t>=en&&s>=en}static computeEdgeHash(t,s){return(t.y===s.y&&t.x>s.x||t.y>s.y)&&([t,s]=[s,t]),BigInt(Kl.computePosHash(t))<<32n|BigInt(Kl.computePosHash(s))}static computePosHash(t){return((65535&t.x)<<16|65535&t.y)>>>0}}var JT,QT={exports:{}},eE=(JT||(JT=1,function(a,t){(function(s){function u(Ee,Ae){return Ee>Ae?1:Ee<Ae?-1:0}var h=function(Ee,Ae){Ee===void 0&&(Ee=u),Ae===void 0&&(Ae=!1),this._compare=Ee,this._root=null,this._size=0,this._noDuplicates=!!Ae},m={size:{configurable:!0}};function _(Ee,Ae,Et,Jt,an){var on=an-Jt;if(on>0){var Cn=Jt+Math.floor(on/2),jn={key:Ae[Cn],data:Et[Cn],parent:Ee};return jn.left=_(jn,Ae,Et,Jt,Cn),jn.right=_(jn,Ae,Et,Cn+1,an),jn}return null}function S(Ee,Ae,Et,Jt,an){if(!(Et>=Jt)){for(var on=Ee[Et+Jt>>1],Cn=Et-1,jn=Jt+1;;){do Cn++;while(an(Ee[Cn],on)<0);do jn--;while(an(Ee[jn],on)>0);if(Cn>=jn)break;var Er=Ee[Cn];Ee[Cn]=Ee[jn],Ee[jn]=Er,Er=Ae[Cn],Ae[Cn]=Ae[jn],Ae[jn]=Er}S(Ee,Ae,Et,jn,an),S(Ee,Ae,jn+1,Jt,an)}}h.prototype.rotateLeft=function(Ee){var Ae=Ee.right;Ae&&(Ee.right=Ae.left,Ae.left&&(Ae.left.parent=Ee),Ae.parent=Ee.parent),Ee.parent?Ee===Ee.parent.left?Ee.parent.left=Ae:Ee.parent.right=Ae:this._root=Ae,Ae&&(Ae.left=Ee),Ee.parent=Ae},h.prototype.rotateRight=function(Ee){var Ae=Ee.left;Ae&&(Ee.left=Ae.right,Ae.right&&(Ae.right.parent=Ee),Ae.parent=Ee.parent),Ee.parent?Ee===Ee.parent.left?Ee.parent.left=Ae:Ee.parent.right=Ae:this._root=Ae,Ae&&(Ae.right=Ee),Ee.parent=Ae},h.prototype._splay=function(Ee){for(;Ee.parent;){var Ae=Ee.parent;Ae.parent?Ae.left===Ee&&Ae.parent.left===Ae?(this.rotateRight(Ae.parent),this.rotateRight(Ae)):Ae.right===Ee&&Ae.parent.right===Ae?(this.rotateLeft(Ae.parent),this.rotateLeft(Ae)):Ae.left===Ee&&Ae.parent.right===Ae?(this.rotateRight(Ae),this.rotateLeft(Ae)):(this.rotateLeft(Ae),this.rotateRight(Ae)):Ae.left===Ee?this.rotateRight(Ae):this.rotateLeft(Ae)}},h.prototype.splay=function(Ee){for(var Ae,Et,Jt,an,on;Ee.parent;)(Et=(Ae=Ee.parent).parent)&&Et.parent?((Jt=Et.parent).left===Et?Jt.left=Ee:Jt.right=Ee,Ee.parent=Jt):(Ee.parent=null,this._root=Ee),an=Ee.left,on=Ee.right,Ee===Ae.left?(Et&&(Et.left===Ae?(Ae.right?(Et.left=Ae.right,Et.left.parent=Et):Et.left=null,Ae.right=Et,Et.parent=Ae):(an?(Et.right=an,an.parent=Et):Et.right=null,Ee.left=Et,Et.parent=Ee)),on?(Ae.left=on,on.parent=Ae):Ae.left=null,Ee.right=Ae,Ae.parent=Ee):(Et&&(Et.right===Ae?(Ae.left?(Et.right=Ae.left,Et.right.parent=Et):Et.right=null,Ae.left=Et,Et.parent=Ae):(on?(Et.left=on,on.parent=Et):Et.left=null,Ee.right=Et,Et.parent=Ee)),an?(Ae.right=an,an.parent=Ae):Ae.right=null,Ee.left=Ae,Ae.parent=Ee)},h.prototype.replace=function(Ee,Ae){Ee.parent?Ee===Ee.parent.left?Ee.parent.left=Ae:Ee.parent.right=Ae:this._root=Ae,Ae&&(Ae.parent=Ee.parent)},h.prototype.minNode=function(Ee){if(Ee===void 0&&(Ee=this._root),Ee)for(;Ee.left;)Ee=Ee.left;return Ee},h.prototype.maxNode=function(Ee){if(Ee===void 0&&(Ee=this._root),Ee)for(;Ee.right;)Ee=Ee.right;return Ee},h.prototype.insert=function(Ee,Ae){var Et=this._root,Jt=null,an=this._compare;if(this._noDuplicates)for(;Et;){if(Jt=Et,an(Et.key,Ee)===0)return;Et=an(Et.key,Ee)<0?Et.right:Et.left}else for(;Et;)Jt=Et,Et=an(Et.key,Ee)<0?Et.right:Et.left;return Et={key:Ee,data:Ae,left:null,right:null,parent:Jt},Jt?an(Jt.key,Et.key)<0?Jt.right=Et:Jt.left=Et:this._root=Et,this.splay(Et),this._size++,Et},h.prototype.find=function(Ee){for(var Ae=this._root,Et=this._compare;Ae;){var Jt=Et(Ae.key,Ee);if(Jt<0)Ae=Ae.right;else{if(!(Jt>0))return Ae;Ae=Ae.left}}return null},h.prototype.contains=function(Ee){for(var Ae=this._root,Et=this._compare;Ae;){var Jt=Et(Ee,Ae.key);if(Jt===0)return!0;Ae=Jt<0?Ae.left:Ae.right}return!1},h.prototype.remove=function(Ee){var Ae=this.find(Ee);if(!Ae)return!1;if(this.splay(Ae),Ae.left)if(Ae.right){var Et=this.minNode(Ae.right);Et.parent!==Ae&&(this.replace(Et,Et.right),Et.right=Ae.right,Et.right.parent=Et),this.replace(Ae,Et),Et.left=Ae.left,Et.left.parent=Et}else this.replace(Ae,Ae.left);else this.replace(Ae,Ae.right);return this._size--,!0},h.prototype.removeNode=function(Ee){if(!Ee)return!1;if(this.splay(Ee),Ee.left)if(Ee.right){var Ae=this.minNode(Ee.right);Ae.parent!==Ee&&(this.replace(Ae,Ae.right),Ae.right=Ee.right,Ae.right.parent=Ae),this.replace(Ee,Ae),Ae.left=Ee.left,Ae.left.parent=Ae}else this.replace(Ee,Ee.left);else this.replace(Ee,Ee.right);return this._size--,!0},h.prototype.erase=function(Ee){var Ae=this.find(Ee);if(Ae){this.splay(Ae);var Et=Ae.left,Jt=Ae.right,an=null;Et&&(Et.parent=null,an=this.maxNode(Et),this.splay(an),this._root=an),Jt&&(Et?an.right=Jt:this._root=Jt,Jt.parent=an),this._size--}},h.prototype.pop=function(){var Ee=this._root,Ae=null;if(Ee){for(;Ee.left;)Ee=Ee.left;Ae={key:Ee.key,data:Ee.data},this.remove(Ee.key)}return Ae},h.prototype.next=function(Ee){var Ae=Ee;if(Ae)if(Ae.right)for(Ae=Ae.right;Ae&&Ae.left;)Ae=Ae.left;else for(Ae=Ee.parent;Ae&&Ae.right===Ee;)Ee=Ae,Ae=Ae.parent;return Ae},h.prototype.prev=function(Ee){var Ae=Ee;if(Ae)if(Ae.left)for(Ae=Ae.left;Ae&&Ae.right;)Ae=Ae.right;else for(Ae=Ee.parent;Ae&&Ae.left===Ee;)Ee=Ae,Ae=Ae.parent;return Ae},h.prototype.forEach=function(Ee){for(var Ae=this._root,Et=[],Jt=!1,an=0;!Jt;)Ae?(Et.push(Ae),Ae=Ae.left):Et.length>0?(Ee(Ae=Et.pop(),an++),Ae=Ae.right):Jt=!0;return this},h.prototype.range=function(Ee,Ae,Et,Jt){for(var an=[],on=this._compare,Cn=this._root;an.length!==0||Cn;)if(Cn)an.push(Cn),Cn=Cn.left;else{if(on((Cn=an.pop()).key,Ae)>0)break;if(on(Cn.key,Ee)>=0&&Et.call(Jt,Cn))return this;Cn=Cn.right}return this},h.prototype.keys=function(){for(var Ee=this._root,Ae=[],Et=[],Jt=!1;!Jt;)Ee?(Ae.push(Ee),Ee=Ee.left):Ae.length>0?(Ee=Ae.pop(),Et.push(Ee.key),Ee=Ee.right):Jt=!0;return Et},h.prototype.values=function(){for(var Ee=this._root,Ae=[],Et=[],Jt=!1;!Jt;)Ee?(Ae.push(Ee),Ee=Ee.left):Ae.length>0?(Ee=Ae.pop(),Et.push(Ee.data),Ee=Ee.right):Jt=!0;return Et},h.prototype.at=function(Ee){for(var Ae=this._root,Et=[],Jt=!1,an=0;!Jt;)if(Ae)Et.push(Ae),Ae=Ae.left;else if(Et.length>0){if(Ae=Et.pop(),an===Ee)return Ae;an++,Ae=Ae.right}else Jt=!0;return null},h.prototype.load=function(Ee,Ae,Et){if(Ee===void 0&&(Ee=[]),Ae===void 0&&(Ae=[]),Et===void 0&&(Et=!1),this._size!==0)throw new Error("bulk-load: tree is not empty");var Jt=Ee.length;return Et&&S(Ee,Ae,0,Jt-1,this._compare),this._root=_(null,Ee,Ae,0,Jt),this._size=Jt,this},h.prototype.min=function(){var Ee=this.minNode(this._root);return Ee?Ee.key:null},h.prototype.max=function(){var Ee=this.maxNode(this._root);return Ee?Ee.key:null},h.prototype.isEmpty=function(){return this._root===null},m.size.get=function(){return this._size},h.createTree=function(Ee,Ae,Et,Jt,an){return new h(Et,an).load(Ee,Ae,Jt)},Object.defineProperties(h.prototype,m);var E=0,A=1,D=2,O=3,F=0,G=1,W=2,Q=3;function ae(Ee,Ae,Et){Ae===null?(Ee.inOut=!1,Ee.otherInOut=!0):(Ee.isSubject===Ae.isSubject?(Ee.inOut=!Ae.inOut,Ee.otherInOut=Ae.otherInOut):(Ee.inOut=!Ae.otherInOut,Ee.otherInOut=Ae.isVertical()?!Ae.inOut:Ae.inOut),Ae&&(Ee.prevInResult=!ce(Ae,Et)||Ae.isVertical()?Ae.prevInResult:Ae));var Jt=ce(Ee,Et);Ee.resultTransition=Jt?function(an,on){var Cn,jn=!an.inOut,Er=!an.otherInOut;switch(on){case F:Cn=jn&&Er;break;case G:Cn=jn||Er;break;case Q:Cn=jn^Er;break;case W:Cn=an.isSubject?jn&&!Er:Er&&!jn}return Cn?1:-1}(Ee,Et):0}function ce(Ee,Ae){switch(Ee.type){case E:switch(Ae){case F:return!Ee.otherInOut;case G:return Ee.otherInOut;case W:return Ee.isSubject&&Ee.otherInOut||!Ee.isSubject&&!Ee.otherInOut;case Q:return!0}break;case D:return Ae===F||Ae===G;case O:return Ae===W;case A:return!1}return!1}var we=function(Ee,Ae,Et,Jt,an){this.left=Ae,this.point=Ee,this.otherEvent=Et,this.isSubject=Jt,this.type=an||E,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.resultTransition=0,this.otherPos=-1,this.outputContourId=-1,this.isExteriorRing=!0},ve={inResult:{configurable:!0}};function ee(Ee,Ae){return Ee[0]===Ae[0]&&Ee[1]===Ae[1]}we.prototype.isBelow=function(Ee){var Ae=this.point,Et=this.otherEvent.point;return this.left?(Ae[0]-Ee[0])*(Et[1]-Ee[1])-(Et[0]-Ee[0])*(Ae[1]-Ee[1])>0:(Et[0]-Ee[0])*(Ae[1]-Ee[1])-(Ae[0]-Ee[0])*(Et[1]-Ee[1])>0},we.prototype.isAbove=function(Ee){return!this.isBelow(Ee)},we.prototype.isVertical=function(){return this.point[0]===this.otherEvent.point[0]},ve.inResult.get=function(){return this.resultTransition!==0},we.prototype.clone=function(){var Ee=new we(this.point,this.left,this.otherEvent,this.isSubject,this.type);return Ee.contourId=this.contourId,Ee.resultTransition=this.resultTransition,Ee.prevInResult=this.prevInResult,Ee.isExteriorRing=this.isExteriorRing,Ee.inOut=this.inOut,Ee.otherInOut=this.otherInOut,Ee},Object.defineProperties(we.prototype,ve);var ge=11102230246251565e-32,be=134217729,Ie=(3+8*ge)*ge;function Fe(Ee,Ae,Et,Jt,an){var on,Cn,jn,Er,Ir=Ae[0],lr=Jt[0],li=0,Ci=0;lr>Ir==lr>-Ir?(on=Ir,Ir=Ae[++li]):(on=lr,lr=Jt[++Ci]);var Pr=0;if(li<Ee&&Ci<Et)for(lr>Ir==lr>-Ir?(jn=on-((Cn=Ir+on)-Ir),Ir=Ae[++li]):(jn=on-((Cn=lr+on)-lr),lr=Jt[++Ci]),on=Cn,jn!==0&&(an[Pr++]=jn);li<Ee&&Ci<Et;)lr>Ir==lr>-Ir?(jn=on-((Cn=on+Ir)-(Er=Cn-on))+(Ir-Er),Ir=Ae[++li]):(jn=on-((Cn=on+lr)-(Er=Cn-on))+(lr-Er),lr=Jt[++Ci]),on=Cn,jn!==0&&(an[Pr++]=jn);for(;li<Ee;)jn=on-((Cn=on+Ir)-(Er=Cn-on))+(Ir-Er),Ir=Ae[++li],on=Cn,jn!==0&&(an[Pr++]=jn);for(;Ci<Et;)jn=on-((Cn=on+lr)-(Er=Cn-on))+(lr-Er),lr=Jt[++Ci],on=Cn,jn!==0&&(an[Pr++]=jn);return on===0&&Pr!==0||(an[Pr++]=on),Pr}function $e(Ee){return new Float64Array(Ee)}var Ze=33306690738754716e-32,et=22204460492503146e-32,St=11093356479670487e-47,jt=$e(4),kt=$e(8),Ft=$e(12),Gt=$e(16),vt=$e(4);function zt(Ee,Ae,Et){var Jt=function(an,on,Cn,jn,Er,Ir){var lr=(on-Ir)*(Cn-Er),li=(an-Er)*(jn-Ir),Ci=lr-li;if(lr===0||li===0||lr>0!=li>0)return Ci;var Pr=Math.abs(lr+li);return Math.abs(Ci)>=Ze*Pr?Ci:-function(Yi,Mi,oi,cs,zi,Ti,Li){var di,mr,fi,Ji,Fn,$r,Fi,rs,Ni,Ns,yi,Ds,ja,Vo,Io,Ba,hh,js,Js=Yi-zi,Uo=oi-zi,ra=Mi-Ti,Qo=cs-Ti;jt[0]=(Io=(rs=Js-(Fi=($r=be*Js)-($r-Js)))*(Ns=Qo-(Ni=($r=be*Qo)-($r-Qo)))-((Vo=Js*Qo)-Fi*Ni-rs*Ni-Fi*Ns))-((yi=Io-(hh=(rs=ra-(Fi=($r=be*ra)-($r-ra)))*(Ns=Uo-(Ni=($r=be*Uo)-($r-Uo)))-((Ba=ra*Uo)-Fi*Ni-rs*Ni-Fi*Ns)))+(Fn=Io-yi))+(Fn-hh),jt[1]=(ja=Vo-((Ds=Vo+yi)-(Fn=Ds-Vo))+(yi-Fn))-((yi=ja-Ba)+(Fn=ja-yi))+(Fn-Ba),jt[2]=Ds-((js=Ds+yi)-(Fn=js-Ds))+(yi-Fn),jt[3]=js;var Pp=function(ice,iA){for(var sA=iA[0],Cw=1;Cw<4;Cw++)sA+=iA[Cw];return sA}(0,jt),By=et*Li;if(Pp>=By||-Pp>=By||(di=Yi-(Js+(Fn=Yi-Js))+(Fn-zi),fi=oi-(Uo+(Fn=oi-Uo))+(Fn-zi),mr=Mi-(ra+(Fn=Mi-ra))+(Fn-Ti),Ji=cs-(Qo+(Fn=cs-Qo))+(Fn-Ti),di===0&&mr===0&&fi===0&&Ji===0)||(By=St*Li+Ie*Math.abs(Pp),(Pp+=Js*Ji+Qo*di-(ra*fi+Uo*mr))>=By||-Pp>=By))return Pp;vt[0]=(Io=(rs=di-(Fi=($r=be*di)-($r-di)))*(Ns=Qo-(Ni=($r=be*Qo)-($r-Qo)))-((Vo=di*Qo)-Fi*Ni-rs*Ni-Fi*Ns))-((yi=Io-(hh=(rs=mr-(Fi=($r=be*mr)-($r-mr)))*(Ns=Uo-(Ni=($r=be*Uo)-($r-Uo)))-((Ba=mr*Uo)-Fi*Ni-rs*Ni-Fi*Ns)))+(Fn=Io-yi))+(Fn-hh),vt[1]=(ja=Vo-((Ds=Vo+yi)-(Fn=Ds-Vo))+(yi-Fn))-((yi=ja-Ba)+(Fn=ja-yi))+(Fn-Ba),vt[2]=Ds-((js=Ds+yi)-(Fn=js-Ds))+(yi-Fn),vt[3]=js;var FB=Fe(4,jt,4,vt,kt);vt[0]=(Io=(rs=Js-(Fi=($r=be*Js)-($r-Js)))*(Ns=Ji-(Ni=($r=be*Ji)-($r-Ji)))-((Vo=Js*Ji)-Fi*Ni-rs*Ni-Fi*Ns))-((yi=Io-(hh=(rs=ra-(Fi=($r=be*ra)-($r-ra)))*(Ns=fi-(Ni=($r=be*fi)-($r-fi)))-((Ba=ra*fi)-Fi*Ni-rs*Ni-Fi*Ns)))+(Fn=Io-yi))+(Fn-hh),vt[1]=(ja=Vo-((Ds=Vo+yi)-(Fn=Ds-Vo))+(yi-Fn))-((yi=ja-Ba)+(Fn=ja-yi))+(Fn-Ba),vt[2]=Ds-((js=Ds+yi)-(Fn=js-Ds))+(yi-Fn),vt[3]=js;var NB=Fe(FB,kt,4,vt,Ft);vt[0]=(Io=(rs=di-(Fi=($r=be*di)-($r-di)))*(Ns=Ji-(Ni=($r=be*Ji)-($r-Ji)))-((Vo=di*Ji)-Fi*Ni-rs*Ni-Fi*Ns))-((yi=Io-(hh=(rs=mr-(Fi=($r=be*mr)-($r-mr)))*(Ns=fi-(Ni=($r=be*fi)-($r-fi)))-((Ba=mr*fi)-Fi*Ni-rs*Ni-Fi*Ns)))+(Fn=Io-yi))+(Fn-hh),vt[1]=(ja=Vo-((Ds=Vo+yi)-(Fn=Ds-Vo))+(yi-Fn))-((yi=ja-Ba)+(Fn=ja-yi))+(Fn-Ba),vt[2]=Ds-((js=Ds+yi)-(Fn=js-Ds))+(yi-Fn),vt[3]=js;var jB=Fe(NB,Ft,4,vt,Gt);return Gt[jB-1]}(an,on,Cn,jn,Er,Ir,Pr)}(Ee[0],Ee[1],Ae[0],Ae[1],Et[0],Et[1]);return Jt>0?-1:Jt<0?1:0}function gt(Ee,Ae){var Et=Ee.point,Jt=Ae.point;return Et[0]>Jt[0]?1:Et[0]<Jt[0]?-1:Et[1]!==Jt[1]?Et[1]>Jt[1]?1:-1:function(an,on,Cn,jn){return an.left!==on.left?an.left?1:-1:zt(Cn,an.otherEvent.point,on.otherEvent.point)!==0?an.isBelow(on.otherEvent.point)?-1:1:!an.isSubject&&on.isSubject?1:-1}(Ee,Ae,Et)}function bt(Ee,Ae,Et){var Jt=new we(Ae,!1,Ee,Ee.isSubject),an=new we(Ae,!0,Ee.otherEvent,Ee.isSubject);return ee(Ee.point,Ee.otherEvent.point)&&console.warn("what is that, a collapsed segment?",Ee),Jt.contourId=an.contourId=Ee.contourId,gt(an,Ee.otherEvent)>0&&(Ee.otherEvent.left=!0,an.left=!1),Ee.otherEvent.otherEvent=an,Ee.otherEvent=Jt,Et.push(an),Et.push(Jt),Et}function qt(Ee,Ae){return Ee[0]*Ae[1]-Ee[1]*Ae[0]}function Kt(Ee,Ae){return Ee[0]*Ae[0]+Ee[1]*Ae[1]}function En(Ee,Ae,Et){var Jt=function(Er,Ir,lr,li,Ci){var Pr=[Ir[0]-Er[0],Ir[1]-Er[1]],Yi=[li[0]-lr[0],li[1]-lr[1]];function Mi($r,Fi,rs){return[$r[0]+Fi*rs[0],$r[1]+Fi*rs[1]]}var oi=[lr[0]-Er[0],lr[1]-Er[1]],cs=qt(Pr,Yi),zi=cs*cs,Ti=Kt(Pr,Pr);if(zi>0){var Li=qt(oi,Yi)/cs;if(Li<0||Li>1)return null;var di=qt(oi,Pr)/cs;return di<0||di>1?null:Li===0||Li===1?[Mi(Er,Li,Pr)]:di===0||di===1?[Mi(lr,di,Yi)]:[Mi(Er,Li,Pr)]}if((zi=(cs=qt(oi,Pr))*cs)>0)return null;var mr=Kt(Pr,oi)/Ti,fi=mr+Kt(Pr,Yi)/Ti,Ji=Math.min(mr,fi),Fn=Math.max(mr,fi);return Ji<=1&&Fn>=0?Ji===1?[Mi(Er,Ji>0?Ji:0,Pr)]:Fn===0?[Mi(Er,Fn<1?Fn:1,Pr)]:[Mi(Er,Ji>0?Ji:0,Pr),Mi(Er,Fn<1?Fn:1,Pr)]:null}(Ee.point,Ee.otherEvent.point,Ae.point,Ae.otherEvent.point),an=Jt?Jt.length:0;if(an===0||an===1&&(ee(Ee.point,Ae.point)||ee(Ee.otherEvent.point,Ae.otherEvent.point))||an===2&&Ee.isSubject===Ae.isSubject)return 0;if(an===1)return ee(Ee.point,Jt[0])||ee(Ee.otherEvent.point,Jt[0])||bt(Ee,Jt[0],Et),ee(Ae.point,Jt[0])||ee(Ae.otherEvent.point,Jt[0])||bt(Ae,Jt[0],Et),1;var on=[],Cn=!1,jn=!1;return ee(Ee.point,Ae.point)?Cn=!0:gt(Ee,Ae)===1?on.push(Ae,Ee):on.push(Ee,Ae),ee(Ee.otherEvent.point,Ae.otherEvent.point)?jn=!0:gt(Ee.otherEvent,Ae.otherEvent)===1?on.push(Ae.otherEvent,Ee.otherEvent):on.push(Ee.otherEvent,Ae.otherEvent),Cn&&jn||Cn?(Ae.type=A,Ee.type=Ae.inOut===Ee.inOut?D:O,Cn&&!jn&&bt(on[1].otherEvent,on[0].point,Et),2):jn?(bt(on[0],on[1].point,Et),3):on[0]!==on[3].otherEvent?(bt(on[0],on[1].point,Et),bt(on[1],on[2].point,Et),3):(bt(on[0],on[1].point,Et),bt(on[3].otherEvent,on[2].point,Et),3)}function _n(Ee,Ae){if(Ee===Ae)return 0;if(zt(Ee.point,Ee.otherEvent.point,Ae.point)!==0||zt(Ee.point,Ee.otherEvent.point,Ae.otherEvent.point)!==0)return ee(Ee.point,Ae.point)?Ee.isBelow(Ae.otherEvent.point)?-1:1:Ee.point[0]===Ae.point[0]?Ee.point[1]<Ae.point[1]?-1:1:gt(Ee,Ae)===1?Ae.isAbove(Ee.point)?-1:1:Ee.isBelow(Ae.point)?-1:1;if(Ee.isSubject!==Ae.isSubject)return Ee.isSubject?-1:1;var Et=Ee.point,Jt=Ae.point;return Et[0]===Jt[0]&&Et[1]===Jt[1]?(Et=Ee.otherEvent.point)[0]===(Jt=Ae.otherEvent.point)[0]&&Et[1]===Jt[1]?0:Ee.contourId>Ae.contourId?1:-1:gt(Ee,Ae)===1?1:-1}var sn=function(){this.points=[],this.holeIds=[],this.holeOf=null,this.depth=null};function Wt(Ee,Ae,Et,Jt){var an,on=Ee+1,Cn=Ae[Ee].point,jn=Ae.length;for(on<jn&&(an=Ae[on].point);on<jn&&an[0]===Cn[0]&&an[1]===Cn[1];){if(!Et[on])return on;++on<jn&&(an=Ae[on].point)}for(on=Ee-1;Et[on]&&on>Jt;)on--;return on}sn.prototype.isExterior=function(){return this.holeOf==null};var Wn=Sn,wn=Sn;function Sn(Ee,Ae){if(!(this instanceof Sn))return new Sn(Ee,Ae);if(this.data=Ee||[],this.length=this.data.length,this.compare=Ae||$n,this.length>0)for(var Et=(this.length>>1)-1;Et>=0;Et--)this._down(Et)}function $n(Ee,Ae){return Ee<Ae?-1:Ee>Ae?1:0}Sn.prototype={push:function(Ee){this.data.push(Ee),this.length++,this._up(this.length-1)},pop:function(){if(this.length!==0){var Ee=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),Ee}},peek:function(){return this.data[0]},_up:function(Ee){for(var Ae=this.data,Et=this.compare,Jt=Ae[Ee];Ee>0;){var an=Ee-1>>1,on=Ae[an];if(Et(Jt,on)>=0)break;Ae[Ee]=on,Ee=an}Ae[Ee]=Jt},_down:function(Ee){for(var Ae=this.data,Et=this.compare,Jt=this.length>>1,an=Ae[Ee];Ee<Jt;){var on=1+(Ee<<1),Cn=on+1,jn=Ae[on];if(Cn<this.length&&Et(Ae[Cn],jn)<0&&(on=Cn,jn=Ae[Cn]),Et(jn,an)>=0)break;Ae[Ee]=jn,Ee=on}Ae[Ee]=an}},Wn.default=wn;var Jn=Math.max,ir=Math.min,yr=0;function fr(Ee,Ae,Et,Jt,an,on){var Cn,jn,Er,Ir,lr,li;for(Cn=0,jn=Ee.length-1;Cn<jn;Cn++)if(Ir=Ee[Cn+1],lr=new we(Er=Ee[Cn],!1,void 0,Ae),li=new we(Ir,!1,lr,Ae),lr.otherEvent=li,Er[0]!==Ir[0]||Er[1]!==Ir[1]){lr.contourId=li.contourId=Et,on||(lr.isExteriorRing=!1,li.isExteriorRing=!1),gt(lr,li)>0?li.left=!0:lr.left=!0;var Ci=Er[0],Pr=Er[1];an[0]=ir(an[0],Ci),an[1]=ir(an[1],Pr),an[2]=Jn(an[2],Ci),an[3]=Jn(an[3],Pr),Jt.push(lr),Jt.push(li)}}var ar=[];function _i(Ee,Ae,Et){typeof Ee[0][0][0]=="number"&&(Ee=[Ee]),typeof Ae[0][0][0]=="number"&&(Ae=[Ae]);var Jt=function(Pr,Yi,Mi){var oi=null;return Pr.length*Yi.length==0&&(Mi===F?oi=ar:Mi===W?oi=Pr:Mi!==G&&Mi!==Q||(oi=Pr.length===0?Yi:Pr)),oi}(Ee,Ae,Et);if(Jt)return Jt===ar?null:Jt;var an=[1/0,1/0,-1/0,-1/0],on=[1/0,1/0,-1/0,-1/0],Cn=function(Pr,Yi,Mi,oi,cs){var zi,Ti,Li,di,mr,fi,Ji=new Wn(null,gt);for(Li=0,di=Pr.length;Li<di;Li++)for(mr=0,fi=(zi=Pr[Li]).length;mr<fi;mr++)(Ti=mr===0)&&yr++,fr(zi[mr],!0,yr,Ji,Mi,Ti);for(Li=0,di=Yi.length;Li<di;Li++)for(mr=0,fi=(zi=Yi[Li]).length;mr<fi;mr++)Ti=mr===0,cs===W&&(Ti=!1),Ti&&yr++,fr(zi[mr],!1,yr,Ji,oi,Ti);return Ji}(Ee,Ae,an,on,Et);if(Jt=function(Pr,Yi,Mi,oi,cs){var zi=null;return(Mi[0]>oi[2]||oi[0]>Mi[2]||Mi[1]>oi[3]||oi[1]>Mi[3])&&(cs===F?zi=ar:cs===W?zi=Pr:cs!==G&&cs!==Q||(zi=Pr.concat(Yi))),zi}(Ee,Ae,an,on,Et))return Jt===ar?null:Jt;for(var jn=function(Pr){var Yi,Mi,oi=function(Li){var di,mr,fi,Ji,Fn=[];for(mr=0,fi=Li.length;mr<fi;mr++)((di=Li[mr]).left&&di.inResult||!di.left&&di.otherEvent.inResult)&&Fn.push(di);for(var $r=!1;!$r;)for($r=!0,mr=0,fi=Fn.length;mr<fi;mr++)mr+1<fi&&gt(Fn[mr],Fn[mr+1])===1&&(Ji=Fn[mr],Fn[mr]=Fn[mr+1],Fn[mr+1]=Ji,$r=!1);for(mr=0,fi=Fn.length;mr<fi;mr++)(di=Fn[mr]).otherPos=mr;for(mr=0,fi=Fn.length;mr<fi;mr++)(di=Fn[mr]).left||(Ji=di.otherPos,di.otherPos=di.otherEvent.otherPos,di.otherEvent.otherPos=Ji);return Fn}(Pr),cs={},zi=[],Ti=function(){if(!cs[Yi]){var Li=zi.length,di=function(Fn,$r,Fi){var rs=new sn;if(Fn.prevInResult!=null){var Ni=Fn.prevInResult,Ns=Ni.outputContourId;if(Ni.resultTransition>0){var yi=$r[Ns];if(yi.holeOf!=null){var Ds=yi.holeOf;$r[Ds].holeIds.push(Fi),rs.holeOf=Ds,rs.depth=$r[Ns].depth}else $r[Ns].holeIds.push(Fi),rs.holeOf=Ns,rs.depth=$r[Ns].depth+1}else rs.holeOf=null,rs.depth=$r[Ns].depth}else rs.holeOf=null,rs.depth=0;return rs}(oi[Yi],zi,Li),mr=function(Fn){cs[Fn]=!0,Fn<oi.length&&oi[Fn]&&(oi[Fn].outputContourId=Li)},fi=Yi,Ji=Yi;for(di.points.push(oi[Yi].point);mr(fi),mr(fi=oi[fi].otherPos),di.points.push(oi[fi].point),!((fi=Wt(fi,oi,cs,Ji))==Ji||fi>=oi.length)&&oi[fi];);zi.push(di)}};for(Yi=0,Mi=oi.length;Yi<Mi;Yi++)Ti();return zi}(function(Pr,Yi,Mi,oi,cs,zi){for(var Ti,Li,di,mr=new h(_n),fi=[],Ji=Math.min(oi[2],cs[2]);Pr.length!==0;){var Fn=Pr.pop();if(fi.push(Fn),zi===F&&Fn.point[0]>Ji||zi===W&&Fn.point[0]>oi[2])break;if(Fn.left){Li=Ti=mr.insert(Fn),Ti=Ti!==(di=mr.minNode())?mr.prev(Ti):null,Li=mr.next(Li);var $r=Ti?Ti.key:null;if(ae(Fn,$r,zi),Li&&En(Fn,Li.key,Pr)===2&&(ae(Fn,$r,zi),ae(Li.key,Fn,zi)),Ti&&En(Ti.key,Fn,Pr)===2){var Fi=Ti;ae($r,(Fi=Fi!==di?mr.prev(Fi):null)?Fi.key:null,zi),ae(Fn,$r,zi)}}else Li=Ti=mr.find(Fn=Fn.otherEvent),Ti&&Li&&(Ti=Ti!==di?mr.prev(Ti):null,Li=mr.next(Li),mr.remove(Fn),Li&&Ti&&En(Ti.key,Li.key,Pr))}return fi}(Cn,0,0,an,on,Et)),Er=[],Ir=0;Ir<jn.length;Ir++){var lr=jn[Ir];if(lr.isExterior()){for(var li=[lr.points],Ci=0;Ci<lr.holeIds.length;Ci++)li.push(jn[lr.holeIds[Ci]].points);Er.push(li)}}return Er}var Ri={UNION:G,DIFFERENCE:W,INTERSECTION:F,XOR:Q};s.diff=function(Ee,Ae){return _i(Ee,Ae,W)},s.intersection=function(Ee,Ae){return _i(Ee,Ae,F)},s.operations=Ri,s.union=function(Ee,Ae){return _i(Ee,Ae,G)},s.xor=function(Ee,Ae){return _i(Ee,Ae,Q)},Object.defineProperty(s,"__esModule",{value:!0})})(t)}(0,QT.exports)),QT.exports);/**
 * martinez v0.7.4
 * Martinez polygon clipping algorithm, does boolean operation on polygons (multipolygons, polygons with holes etc): intersection, union, difference, xor
 *
 * @author Alex Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 */function hx(a,t,s,u){const h=[],m=u===0?(_,S,E,A,D,O)=>{_.push(new Qt(O,E+(O-S)/(A-S)*(D-E)))}:(_,S,E,A,D,O)=>{_.push(new Qt(S+(O-E)/(D-E)*(A-S),O))};for(const _ of a){const S=[];for(const E of _){if(E.length<=2)continue;const A=[];for(let F=0;F<E.length-1;F++){const G=E[F].x,W=E[F].y,Q=E[F+1].x,ae=E[F+1].y,ce=u===0?G:W,we=u===0?Q:ae;ce<t?we>t&&m(A,G,W,Q,ae,t):ce>s?we<s&&m(A,G,W,Q,ae,s):A.push(E[F]),we<t&&ce>=t&&m(A,G,W,Q,ae,t),we>s&&ce<=s&&m(A,G,W,Q,ae,s)}let D=E[E.length-1];const O=u===0?D.x:D.y;O>=t&&O<=s&&A.push(D),A.length&&(D=A[A.length-1],A[0].x===D.x&&A[0].y===D.y||A.push(A[0]),S.push(A))}S.length&&h.push(S)}return h}function eN(a,t){const s=bb(a),u=bb([t]),h=eE.intersection(s,u);return h==null?[]:tE(h)}function tN(a,t){let u=bb(a,65536);for(;t.valid();t.next()){const[h,m]=t.get(),_=h.x*65536,S=h.y*65536,E=m.x*65536,A=m.y*65536,D=E-_,O=A-S,F=Math.hypot(D,O),G=Math.trunc(O/F*3),W=-Math.trunc(D/F*3);u=eE.diff(u,[[[_,S],[E,A],[E+G,A+W],[_+G,S+W],[_,S]]])}return tE(u,1/65536)}function bb(a,t=1){return[a.map(s=>s.map(u=>[u.x*t,u.y*t]))]}function tE(a,t=1){return a.map(s=>s.map((u,h)=>{const m=u.map(_=>new Qt(_[0]*t,_[1]*t).round());return h>0&&m.reverse(),m}))}class wb{constructor(t,s){this.layoutVertexArray=new Vl,this.indexArray=new gs,this.lineIndexArray=new ol,this.triangleSegments=new ki,this.lineSegments=new ki,this.programConfigurations=new Ec(t.layers,{zoom:t.zoom,lut:t.lut}),this.uploaded=!1,s&&(this.elevatedLayoutVertexArray=new th)}update(t,s,u,h,m,_,S){this.programConfigurations.updatePaintArrays(t,s,m,u,h,_,S)}isEmpty(){return this.layoutVertexArray.length===0}needsUpload(){return this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ur.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.lineIndexBuffer=t.createIndexBuffer(this.lineIndexArray),this.elevatedLayoutVertexArray&&this.elevatedLayoutVertexArray.length>0&&(this.elevatedLayoutVertexBuffer=t.createVertexBuffer(this.elevatedLayoutVertexArray,Qr.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.lineIndexBuffer.destroy(),this.programConfigurations.destroy(),this.triangleSegments.destroy(),this.lineSegments.destroy())}populatePaintArrays(t,s,u,h,m,_){this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,u,h,m,_)}}class Sb{constructor(t){this.zoom=t.zoom,this.pixelRatio=t.pixelRatio,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.bufferData=new wb(t,!1),this.elevationBufferData=new wb(t,!0),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.projection=t.projection,this.elevationMode=this.layers[0].layout.get("fill-elevation-reference")}updateFootprints(t,s){}populate(t,s,u,h){this.hasPattern=pb("fill",this.layers,this.pixelRatio,s);const m=this.layers[0].layout.get("fill-sort-key"),_=[];for(const{feature:S,id:E,index:A,sourceLayerIndex:D}of t){const O=this.layers[0]._featureFilter.needGeometry,F=bn(S,O);if(!this.layers[0]._featureFilter.filter(new ni(this.zoom),F,u))continue;const G=m?m.evaluate(F,{},u,s.availableImages):void 0,W={id:E,properties:S.properties,type:S.type,sourceLayerIndex:D,index:A,geometry:O?F.geometry:pn(S,u,h),patterns:{},sortKey:G};_.push(W)}m&&_.sort((S,E)=>S.sortKey-E.sortKey);for(const S of _){const{geometry:E,index:A,sourceLayerIndex:D}=S;if(this.hasPattern){const O=mb("fill",this.layers,S,this.zoom,this.pixelRatio,s);this.patternFeatures.push(O)}else this.addFeature(S,E,A,u,{},s.availableImages,s.brightness,s.elevationFeatures);s.featureIndex.insert(t[A].feature,E,A,D,this.index)}}update(t,s,u,h,m,_,S){this.bufferData.update(t,s,u,h,m,_,S),this.elevationBufferData.update(t,s,u,h,m,_,S)}addFeatures(t,s,u,h,m,_){for(const S of this.patternFeatures)this.addFeature(S,S.geometry,S.index,s,u,h,_,t.elevationFeatures)}isEmpty(){return this.bufferData.isEmpty()&&this.elevationBufferData.isEmpty()}uploadPending(){return!this.uploaded||this.bufferData.needsUpload()||this.elevationBufferData.needsUpload()}upload(t){this.bufferData.upload(t),this.elevationBufferData.upload(t),this.elevatedStructures&&this.elevatedStructures.upload(t)}destroy(){this.bufferData.destroy(),this.elevationBufferData.destroy(),this.elevatedStructures&&this.elevatedStructures.destroy()}addFeature(t,s,u,h,m,_=[],S,E){const A=ux(s,500);this.elevationMode!=="none"?this.addElevatedRoadFeature(t,A,h,u,E):this.addGeometry(A,this.bufferData),this.bufferData.populatePaintArrays(t,u,m,_,h,S),this.elevationBufferData.populatePaintArrays(t,u,m,_,h,S)}getUnevaluatedPortalGraph(){return this.elevatedStructures?this.elevatedStructures.unevaluatedPortals:void 0}getElevationPolygons(){return this.elevatedStructures?this.elevatedStructures.portalPolygons:void 0}setEvaluatedPortalGraph(t){this.elevatedStructures&&this.elevatedStructures.construct(t)}addElevatedRoadFeature(t,s,u,h,m){const _=new Array,S=xb.getElevationFeature(t,m);if(S){{const E=this.clipPolygonsToTile(s,1);E.length>0&&_.push({polygons:E,elevationFeature:S,elevationTileID:u})}for(const E of _)if(E.elevationFeature){if(this.elevationMode==="hd-road-base"){this.elevatedStructures||(this.elevatedStructures=new Kl(E.elevationTileID));const D=E.elevationFeature.isTunnel();let O=0;t.properties.hasOwnProperty(qT)&&(O=+t.properties[qT]);for(const F of E.polygons)this.elevatedStructures.addPortalCandidates(E.elevationFeature.id,F,D,E.elevationFeature,O)}E.elevationFeature.constantHeight==null&&(E.polygons=this.prepareElevatedPolygons(E.polygons,E.elevationFeature,E.elevationTileID));const A=new KT(u,E.elevationTileID);this.addElevatedGeometry(E.polygons,A,E.elevationFeature,this.elevationMode==="hd-road-base"?0:.05,h)}}else this.addGeometry(s,this.bufferData)}addElevatedGeometry(t,s,u,h,m){const _={elevation:u,elevationSampler:s,bias:h,index:m},[S,E]=this.addGeometry(t,this.elevationBufferData,_);this.elevationBufferData.heightRange==null?this.elevationBufferData.heightRange={min:S,max:E}:(this.elevationBufferData.heightRange.min=Math.min(this.elevationBufferData.heightRange.min,S),this.elevationBufferData.heightRange.max=Math.max(this.elevationBufferData.heightRange.max,E))}addGeometry(t,s,u){let h=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY,_=null;u&&(_=u.elevationSampler.constantElevation(u.elevation,u.bias),_!=null&&(h=_,m=_));const S=(E,A,D)=>{if(u!=null)if(A.push(E),_!=null)s.elevatedLayoutVertexArray.emplaceBack(_),D.push(_);else{const O=u.elevationSampler.pointElevation(E,u.elevation,u.bias);s.elevatedLayoutVertexArray.emplaceBack(O),D.push(O),h=Math.min(h,O),m=Math.max(m,O)}};for(const E of t){let A=0;for(const ve of E)A+=ve.length;const D=s.triangleSegments.prepareSegment(A,s.layoutVertexArray,s.indexArray),O=D.vertexLength,F=[],G=[],W=[],Q=[],ae=[],ce=s.layoutVertexArray.length;for(const ve of E){if(ve.length===0)continue;ve!==E[0]&&G.push(F.length/2);const ee=s.lineSegments.prepareSegment(ve.length,s.layoutVertexArray,s.lineIndexArray),ge=ee.vertexLength;u&&ae.push(s.layoutVertexArray.length-ce),S(ve[0],W,Q),s.layoutVertexArray.emplaceBack(ve[0].x,ve[0].y),s.lineIndexArray.emplaceBack(ge+ve.length-1,ge),F.push(ve[0].x),F.push(ve[0].y);for(let be=1;be<ve.length;be++)S(ve[be],W,Q),s.layoutVertexArray.emplaceBack(ve[be].x,ve[be].y),s.lineIndexArray.emplaceBack(ge+be-1,ge+be),F.push(ve[be].x),F.push(ve[be].y);ee.vertexLength+=ve.length,ee.primitiveLength+=ve.length}const we=Xl(F,G);for(let ve=0;ve<we.length;ve+=3)s.indexArray.emplaceBack(O+we[ve],O+we[ve+1],O+we[ve+2]);if(we.length>0&&u&&this.elevationMode==="hd-road-base"){const ve=u.elevation.isTunnel(),ee=u.elevation.safeArea,ge=this.elevatedStructures.addVertices(W,Q);this.elevatedStructures.addTriangles(we,ge,ve);const be=ae.length;if(be>0){for(let Ie=0;Ie<be-1;Ie++)this.elevatedStructures.addRenderableRing(u.index,ae[Ie]+ge,ae[Ie+1]-ae[Ie],ve,ee);this.elevatedStructures.addRenderableRing(u.index,ae[be-1]+ge,W.length-ae[be-1],ve,ee)}}D.vertexLength+=A,D.primitiveLength+=we.length/3}return[h,m]}prepareElevatedPolygons(t,s,u){const h=1/Qe(u),m=[];for(const _ of t){const S=tN(_,new XT(s,h));m.push(...S)}return m}clipPolygonsToTile(t,s){const u=-s,h=-s,m=en+s,_=en+s;let S=0;const E=[],A=[];for(;S<t.length;S++){const F=t[S],G=Vf(F);(G.min.x>=u&&G.max.x<=m&&G.min.y>=h&&G.max.y<=_?E:A).push(F)}if(E.length===t.length)return t;const D=[new Qt(u,h),new Qt(m,h),new Qt(m,_),new Qt(u,_),new Qt(u,h)],O=E;for(const F of A)O.push(...eN(F,D));return O}}let nE,rE,iE,sE;un(Sb,"FillBucket",{omit:["layers","patternFeatures"]}),un(wb,"FillBufferData"),un(Kl,"ElevatedStructures");class Cb{constructor(t,s,u,h){if(this.triangleCount=s.length/3,this.min=new Qt(0,0),this.max=new Qt(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||t.length===0)return;const[m,_]=[t[0].clone(),t[0].clone()];for(let O=1;O<t.length;++O){const F=t[O];m.x=Math.min(m.x,F.x),m.y=Math.min(m.y,F.y),_.x=Math.max(_.x,F.x),_.y=Math.max(_.y,F.y)}if(h){const O=Math.ceil(Math.max(_.x-m.x,_.y-m.y)/h);u=Math.max(u,O)}if(u===0)return;this.min=m,this.max=_;const S=this.max.sub(this.min);S.x=Math.max(S.x,1),S.y=Math.max(S.y,1);const E=Math.max(S.x,S.y)/u;this.cellsX=Math.max(1,Math.ceil(S.x/E)),this.cellsY=Math.max(1,Math.ceil(S.y/E)),this.xScale=1/E,this.yScale=1/E;const A=[];for(let O=0;O<this.triangleCount;O++){const F=t[s[3*O+0]].sub(this.min),G=t[s[3*O+1]].sub(this.min),W=t[s[3*O+2]].sub(this.min),Q=uh(Math.floor(Math.min(F.x,G.x,W.x)),this.xScale,this.cellsX),ae=uh(Math.floor(Math.max(F.x,G.x,W.x)),this.xScale,this.cellsX),ce=uh(Math.floor(Math.min(F.y,G.y,W.y)),this.yScale,this.cellsY),we=uh(Math.floor(Math.max(F.y,G.y,W.y)),this.yScale,this.cellsY),ve=new Qt(0,0),ee=new Qt(0,0),ge=new Qt(0,0),be=new Qt(0,0);for(let Ie=ce;Ie<=we;++Ie){ve.y=ee.y=Ie*E,ge.y=be.y=(Ie+1)*E;for(let Fe=Q;Fe<=ae;++Fe)ve.x=ge.x=Fe*E,ee.x=be.x=(Fe+1)*E,(Oi(F,G,W,ve,ee,be)||Oi(F,G,W,ve,be,ge))&&A.push({cellIdx:Ie*this.cellsX+Fe,triIdx:O})}}if(A.length===0)return;A.sort((O,F)=>O.cellIdx-F.cellIdx||O.triIdx-F.triIdx);let D=0;for(;D<A.length;){const O=A[D].cellIdx,F={start:this.payload.length,len:0};for(;D<A.length&&A[D].cellIdx===O;)++F.len,this.payload.push(A[D++].triIdx);this.cells[O]=F}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(t,s){if(this.triangleCount===0||this.cells.length===0||t.x>this.max.x||this.min.x>t.x||t.y>this.max.y||this.min.y>t.y)return;const u=uh(t.x-this.min.x,this.xScale,this.cellsX),h=uh(t.y-this.min.y,this.yScale,this.cellsY),m=this.cells[h*this.cellsX+u];if(m){this._lazyInitLookup();for(let _=0;_<m.len;_++){const S=this.payload[m.start+_],E=Math.floor(S/8),A=1<<S%8;if(!(this.lookup[E]&A)&&(this.lookup[E]|=A,s.push(S),s.length===this.triangleCount))return}}}query(t,s,u){if(this.triangleCount===0||this.cells.length===0||t.x>this.max.x||this.min.x>s.x||t.y>this.max.y||this.min.y>s.y)return;this._lazyInitLookup();const h=uh(t.x-this.min.x,this.xScale,this.cellsX),m=uh(s.x-this.min.x,this.xScale,this.cellsX),_=uh(t.y-this.min.y,this.yScale,this.cellsY),S=uh(s.y-this.min.y,this.yScale,this.cellsY);for(let E=_;E<=S;E++)for(let A=h;A<=m;A++){const D=this.cells[E*this.cellsX+A];if(D)for(let O=0;O<D.len;O++){const F=this.payload[D.start+O],G=Math.floor(F/8),W=1<<F%8;if(!(this.lookup[G]&W)&&(this.lookup[G]|=W,u.push(F),u.length===this.triangleCount))return}}}}function uh(a,t,s){return Math.max(0,Math.min(s-1,Math.floor(a*t)))}un(Cb,"TriangleGridIndex");class oE{constructor(t){this.zoom=t.zoom,this.layers=t.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=t.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.footprints=[]}updateFootprints(t,s){for(const u of this.footprints)s.push({footprint:u,id:t})}populate(t,s,u,h){const m=[];for(const{feature:_,id:S,index:E,sourceLayerIndex:A}of t){const D=this.layers[0]._featureFilter.needGeometry,O=bn(_,D);if(!this.layers[0]._featureFilter.filter(new ni(this.zoom),O,u))continue;const F={id:S,properties:_.properties,type:_.type,sourceLayerIndex:A,index:E,geometry:D?O.geometry:pn(_,u,h),patterns:{}};m.push(F)}for(const _ of m){const{geometry:S,index:E,sourceLayerIndex:A}=_;this.addFeature(_,S,E,u,{},s.availableImages,s.brightness),s.featureIndex.insert(t[E].feature,S,E,A,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(t){}update(t,s,u,h,m,_,S){}destroy(){}addFeature(t,s,u,h,m,_=[],S){for(const E of ux(s,2)){const A=[],D=[],O=[],F=new Qt(1/0,1/0),G=new Qt(-1/0,-1/0);for(const ae of E)if(ae.length!==0){ae!==E[0]&&O.push(D.length/2);for(let ce=0;ce<ae.length;ce++)D.push(ae[ce].x),D.push(ae[ce].y),A.push(ae[ce]),F.x=Math.min(F.x,ae[ce].x),F.y=Math.min(F.y,ae[ce].y),G.x=Math.max(G.x,ae[ce].x),G.y=Math.max(G.y,ae[ce].y)}const W=Xl(D,O),Q=new Cb(A,W,8,256);this.footprints.push({vertices:A,indices:W,grid:Q,min:F,max:G})}}}un(oE,"ClipBucket",{omit:["layers"]});const nN=Vr([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),rN=Vr([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),iN=Vr([{name:"a_centroid_pos",components:2,type:"Uint16"}]),sN=Vr([{name:"a_join_normal_inside",components:3,type:"Int16"}]),oN=Vr([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),aN=Vr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:lN}=nN,fx=Number.MAX_SAFE_INTEGER;function aE(a,t,s,u){return a.order<t||a.order===fx||!(a.clipMask&s)||function(h,m){return m.length!==0&&m.find(_=>_===h)===void 0}(u,a.clipScope)}function px(a,t){return a.x-t.x||a.y-t.y}function lE(a,t){return px(a.min,t.min)===0&&px(a.max,t.max)===0}function Tb(a,t){return!(a.min.x>t.max.x||a.max.x<t.min.x||a.min.y>t.max.y||a.max.y<t.min.y)}function Eb(a,t){if(a.length!==t.length)return!1;for(let s=0;s<a.length;s++)if(a[s].sourceId!==t[s].sourceId||!lE(a[s],t[s])||a[s].order!==t[s].order||a[s].clipMask!==t[s].clipMask||!yl(a[s].clipScope,t[s].clipScope))return!1;return!0}function cE(a,t,s){const u=1/en,h=1/(1<<s.canonical.z),m=(t.x*u+s.canonical.x)*h+s.wrap,_=(t.y*u+s.canonical.y)*h;return{min:new Qt((a.x*u+s.canonical.x)*h+s.wrap,(a.y*u+s.canonical.y)*h),max:new Qt(m,_)}}function cN(a,t,s){const u=1<<s.canonical.z,h=((t.x-s.wrap)*u-s.canonical.x)*en,m=(t.y*u-s.canonical.y)*en;return{min:new Qt(((a.x-s.wrap)*u-s.canonical.x)*en,(a.y*u-s.canonical.y)*en),max:new Qt(h,m)}}function uE(a,t,s,u,h,m,_){const S=a.indices,E=a.vertices,A=[];for(let D=u;D<u+h;D+=3){const O=t[s[D+0]+m],F=t[s[D+1]+m],G=t[s[D+2]+m],W=Math.min(O.x,F.x,G.x),Q=Math.max(O.x,F.x,G.x),ae=Math.min(O.y,F.y,G.y),ce=Math.max(O.y,F.y,G.y);A.length=0,a.grid.query(new Qt(W,ae),new Qt(Q,ce),A);for(let we=0;we<A.length;we++){const ve=A[we];if(Oi(E[S[3*ve+0]],E[S[3*ve+1]],E[S[3*ve+2]],O,F,G,_))return!0}}return!1}function dE(a,t,s,u){if(!a||!s)return!1;let h=a.vertices;if(!t.canonical.equals(u.canonical)||t.wrap!==u.wrap){if(s.vertices.length<a.vertices.length)return dE(s,u,a,t);const m=t.canonical,_=u.canonical,S=Math.pow(2,_.z-m.z);h=a.vertices.map(E=>new Qt((E.x+m.x*en)*S-_.x*en,(E.y+m.y*en)*S-_.y*en))}return uE(s,h,a.indices,0,a.indices.length,0,0)}function hE(a,t,s,u){const h=Math.pow(2,u.z-s.z);return new Qt((a+s.x*en)*h-u.x*en,(t+s.y*en)*h-u.y*en)}function fE(a,t){const s=[];t.grid.queryPoint(a,s);const u=t.indices,h=t.vertices;for(let m=0;m<s.length;m++){const _=s[m];if(si([h[u[3*_+0]],h[u[3*_+1]],h[u[3*_+2]]],a))return!0}return!1}const Ib=[new Qt(0,0),new Qt(en,0),new Qt(en,en),new Qt(0,en)];function pE(a,t){const s=[];let u=[];if(!t||a.length<2)return[a];if(a.length===2)return Gi(a[0],a[1],Ib)?[a]:[];for(let h=0;h<a.length+2;h++){const m=a[h%a.length],_=a[(h+1)%a.length],S=Gi(h===0?a[a.length-1]:a[(h-1)%a.length],m,Ib),E=Gi(m,_,Ib),A=S||E;A&&u.push(m),A&&E||u.length>0&&(u.length>1&&s.push(u),u=[])}return u.length>1&&s.push(u),s}const Pb=wp.VectorTileFeature.types,uN=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],dN=["fill-extrusion-flood-light-ground-radius"],hN=Math.pow(2,13),fN=Math.pow(2,15)-1,mE=new Qt(0,1),Sp=2147483648;function fy(a,t,s,u,h,m,_,S){a.emplaceBack((t<<1)+_,(s<<1)+m,(Math.floor(u*hN)<<1)+h,Math.round(S))}function py(a,t,s){a.emplaceBack(t.x*en,t.y*en,s?1:0)}function mx(a,t,s,u,h,m){a.emplaceBack(t.x,t.y,(s.x<<1)+u,(s.y<<1)+h,m)}function my(a,t,s){a.emplaceBack(t.x,t.y,t.z,s[0]*16384,s[1]*16384,s[2]*16384)}class gE{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class _E{constructor(){this.centroidXY=new Qt(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new Qt(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new Qt(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new Qt(this.max.x-this.min.x,this.max.y-this.min.y)}}class yE{constructor(){this.acc=new Qt(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(t,s){t.min.x===Number.MAX_VALUE&&(t.min.x=t.max.x=s.x,t.min.y=t.max.y=s.y)}appendEdge(t,s,u){this.accCount++,this.acc._add(s);let h=!!this.borders;s.x<t.min.x?(t.min.x=s.x,h=!0):s.x>t.max.x&&(t.max.x=s.x,h=!0),s.y<t.min.y?(t.min.y=s.y,h=!0):s.y>t.max.y&&(t.max.y=s.y,h=!0),((s.x===0||s.x===en)&&s.x===u.x)!=((s.y===0||s.y===en)&&s.y===u.y)&&this.processBorderOverlap(s,u),h&&this.checkBorderIntersection(s,u)}checkBorderIntersection(t,s){s.x<0!=t.x<0&&this.addBorderIntersection(0,kn(s.y,t.y,(0-s.x)/(t.x-s.x))),s.x>en!=t.x>en&&this.addBorderIntersection(1,kn(s.y,t.y,(en-s.x)/(t.x-s.x))),s.y<0!=t.y<0&&this.addBorderIntersection(2,kn(s.x,t.x,(0-s.y)/(t.y-s.y))),s.y>en!=t.y>en&&this.addBorderIntersection(3,kn(s.x,t.x,(en-s.y)/(t.y-s.y)))}addBorderIntersection(t,s){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const u=this.borders[t];s<u[0]&&(u[0]=s),s>u[1]&&(u[1]=s)}processBorderOverlap(t,s){if(t.x===s.x){if(t.y===s.y)return;const u=t.x===0?0:1;this.addBorderIntersection(u,s.y),this.addBorderIntersection(u,t.y)}else{const u=t.y===0?2:3;this.addBorderIntersection(u,s.x),this.addBorderIntersection(u,t.x)}}centroid(){return this.accCount===0?new Qt(0,0):new Qt(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((t,s)=>t+ +(s[0]!==Number.MAX_VALUE),0):0}}function vE(a,t){const s=a.add(t)._unit(),u=Xe(a.x*s.x+a.y*s.y,-1,1);var h,m,_;return h=Math.acos(u),Math.min(4,Math.max(-4,Math.tan(h)))/4*fN*((m=a).x*(_=t).y-m.y*_.x<0?-1:1)}const pN=[a=>a.x<0,a=>a.x>en,a=>a.y<0,a=>a.y>en];function mN(a,t,s,u){const h=[4];if(u===0)return h;s._mult(u);const m=a.sub(s),_=t.sub(s),S=[a,t,m,_];for(let E=0;E<4;E++)for(const A of S)if(pN[E](A)){h.push(E);break}return h}class xE{constructor(t){this.vertexArray=new Sm,this.indexArray=new gs,this.programConfigurations=new Ec(t.layers,{zoom:t.zoom,lut:t.lut},s=>dN.includes(s)),this._segments=new ki,this.hiddenByLandmarkVertexArray=new mf,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new ki}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(t,s,u,h=!1){const m=t.length;if(m>2){let _=Math.max(0,this._segments.get().length-1);const S=this._segments._prepareSegment(4*m,this.vertexArray.length,2*this._segmentToGroundQuads[_].length);let E;_!==this._segments.get().length-1&&(_++,this._segmentToGroundQuads[_]=[],this._segmentToRegionTriCounts[_]=[0,0,0,0,0]);{const A=t[0],D=t[1];E=vE(A.sub(t[m-1])._perp()._unit(),D.sub(A)._perp()._unit())}for(let A=0;A<m;A++){const D=A===m-1?0:A+1,O=t[A],F=t[D],G=t[D===m-1?0:D+1],W=F.sub(O)._perp()._unit(),Q=vE(W,G.sub(F)._perp()._unit()),ae=E,ce=Q;if(Ab(O,F,s)||h&&SE(O,s)&&SE(F,s)){E=Q;continue}const we=S.vertexLength;mx(this.vertexArray,O,F,1,1,ae),mx(this.vertexArray,O,F,1,0,ae),mx(this.vertexArray,O,F,0,1,ce),mx(this.vertexArray,O,F,0,0,ce),S.vertexLength+=4;const ve=mN(O,F,W,u);for(const ee of ve)this._segmentToGroundQuads[_].push({id:we,region:ee}),this._segmentToRegionTriCounts[_][ee]+=2,S.primitiveLength+=2;E=Q}}}prepareBorderSegments(){if(!this.hasData())return;const t=this._segments.get(),s=t.length;for(let u=0;u<s;u++)this._segmentToGroundQuads[u].sort((h,m)=>h.region-m.region);for(let u=0;u<s;u++){const h=this._segmentToGroundQuads[u],m=t[u],_=this._segmentToRegionTriCounts[u];_.reduce((E,A)=>E+A,0);let S=0;for(let E=0;E<=4;E++){const A=_[E];if(A!==0){let D=this.regionSegments[E];D||(D=this.regionSegments[E]=new ki);const O={vertexOffset:m.vertexOffset,primitiveOffset:m.primitiveOffset+S,vertexLength:m.vertexLength,primitiveLength:A};D.get().push(O)}S+=A}for(let E=0;E<h.length;E++){const A=h[E].id;this.indexArray.emplaceBack(A,A+1,A+3),this.indexArray.emplaceBack(A,A+3,A+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(t,s,u,h,m,_){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,t,s,u,h,m,_)}upload(t){this.hasData()&&(this.vertexBuffer=t.createVertexBuffer(this.vertexArray,rN.members),this.indexBuffer=t.createIndexBuffer(this.indexArray))}uploadPaintProperties(t){this.hasData()&&this.programConfigurations.upload(t)}update(t,s,u,h,m,_,S){this.hasData()&&this.programConfigurations.updatePaintArrays(t,s,u,h,m,_,S)}updateHiddenByLandmark(t){if(!this.hasData())return;const s=t.groundVertexCount+t.groundVertexArrayOffset;if(t.groundVertexCount===0)return;const u=t.flags&Sp?1:0;for(let h=t.groundVertexArrayOffset;h<s;++h)this.hiddenByLandmarkVertexArray.emplace(h,u);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(t){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=t.createVertexBuffer(this.hiddenByLandmarkVertexArray,oN.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let t=0;t<=4;t++){const s=this.regionSegments[t];s&&s.destroy()}}}}class gx{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.overscaling=t.overscaling,this.layers=t.layers,this.pixelRatio=t.pixelRatio,this.layerIds=this.layers.map(s=>s.fqid),this.index=t.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=t.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new gs,this.footprintVertices=new Vl,this.footprintSegments=[],this.layoutVertexArray=new ou,this.centroidVertexArray=new Pm,this.wallVertexArray=new _f,this.indexArray=new gs,this.programConfigurations=new Ec(t.layers,{zoom:t.zoom,lut:t.lut},s=>uN.includes(s)),this.segments=new ki,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.groundEffect=new xE(t),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(t,s){}populate(t,s,u,h){this.features=[],this.hasPattern=pb("fill-extrusion",this.layers,this.pixelRatio,s),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=Qe(u),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:m,id:_,index:S,sourceLayerIndex:E}of t){const A=this.layers[0]._featureFilter.needGeometry,D=bn(m,A);if(!this.layers[0]._featureFilter.filter(new ni(this.zoom),D,u))continue;const O={id:_,sourceLayerIndex:E,index:S,geometry:A?D.geometry:pn(m,u,h),properties:m.properties,type:m.type,patterns:{}},F=this.layoutVertexArray.length,G=Pb[O.type]==="Polygon";if(this.hasPattern)this.features.push(mb("fill-extrusion",this.layers,O,this.zoom,this.pixelRatio,s));else if(this.wallMode)for(const W of O.geometry)for(const Q of pE(W,G))this.addFeature(O,[Q],S,u,{},s.availableImages,h,s.brightness);else this.addFeature(O,O.geometry,S,u,{},s.availableImages,h,s.brightness);s.featureIndex.insert(m,O.geometry,S,E,this.index,F)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(t,s,u,h,m,_){for(const S of this.features){const E=Pb[S.type]==="Polygon",{geometry:A}=S;if(this.wallMode)for(const D of A)for(const O of pE(D,E))this.addFeature(S,[O],S.index,s,u,h,m,_);else this.addFeature(S,A,S.index,s,u,h,m,_)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(t,s,u,h,m,_,S){this.programConfigurations.updatePaintArrays(t,s,m,u,h,_,S),this.groundEffect.update(t,s,m,u,h,_,S)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,lN),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.wallVertexBuffer=t.createVertexBuffer(this.wallVertexArray,sN.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=t.createVertexBuffer(this.layoutVertexExtArray,aN.members,!0)),this.groundEffect.upload(t)),this.groundEffect.uploadPaintProperties(t),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){this.groundEffect.uploadHiddenByLandmark(t),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,iN.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,s,u,h,m,_,S,E){const A=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(t,{})/this.tileToMeter,D=[new Qt(0,0),new Qt(en,en)],O=S.projection,F=O.name==="globe",G=this.wallMode||Pb[t.type]==="Polygon",W=new yE;W.centroidDataIndex=this.centroidData.length;const Q=new _E,ae=this.layers[0].paint.get("fill-extrusion-base").evaluate(t,{},h)<=0,ce=this.layers[0].paint.get("fill-extrusion-height").evaluate(t,{},h);let we;if(Q.height=ce,Q.vertexArrayOffset=this.layoutVertexArray.length,Q.groundVertexArrayOffset=this.groundEffect.vertexArray.length,F&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new rd),this.wallMode){if(F)return void gr("Non zero fill-extrusion-line-width is not yet supported on globe.");if(s.length!==1)return;we=function(Ze){const et=Ze[0].x===Ze[Ze.length-1].x&&Ze[0].y===Ze[Ze.length-1].y;(function(sn){let Wt=0;const Wn=sn.length;for(let wn=0;wn<Wn;wn++)Wt+=(sn[(wn+1)%Wn].x-sn[wn].x)*(sn[(wn+1)%Wn].y+sn[wn].y);return Wt>=0})(Ze)||(Ze=Ze.reverse());const jt={geometry:[],joinNormals:[],indices:[]},kt=[],Ft=[],Gt=[];let vt=Ze.length;for(;vt>=2&&Ze[vt-1].equals(Ze[vt-2]);)vt--;if(vt<(et?3:2))return jt;let zt,gt,bt,qt,Kt,En=0;for(;En<vt-1&&Ze[En].equals(Ze[En+1]);)En++;et&&(zt=Ze[vt-2],Kt=Ze[En].sub(zt)._unit()._perp());for(let sn=En;sn<vt;sn++){if(bt=sn===vt-1?et?Ze[En+1]:void 0:Ze[sn+1],bt&&Ze[sn].equals(bt))continue;Kt&&(qt=Kt),zt&&(gt=zt),zt=Ze[sn],Kt=bt?bt.sub(zt)._unit()._perp():qt,qt=qt||Kt;let Wt=qt.add(Kt);Wt.x===0&&Wt.y===0||Wt._unit();const Wn=Wt.x*Kt.x+Wt.y*Kt.y,wn=Wn!==0?1/Wn:1/0,Sn=qt.x*Kt.y-qt.y*Kt.x>0;let $n="miter";const Jn=2;$n==="miter"&&wn>Jn&&($n="bevel"),$n==="bevel"&&(wn>100&&($n="flipbevel"),wn<Jn&&($n="miter"));const ir=(yr,fr,ar,_i)=>{const Ri=new Qt(yr.x,yr.y),Ee=new Qt(yr.x,yr.y);Ri.x+=fr.x*_i,Ri.y+=fr.y*_i,Ee.x-=fr.x*Math.max(ar,1),Ee.y-=fr.y*Math.max(ar,1),Gt.push(fr),kt.push(Ri),Ft.push(Ee)};if($n==="miter")Wt._mult(wn),ir(zt,Wt,0,0);else if($n==="flipbevel")Wt=Kt.mult(-1),ir(zt,Wt,0,0),ir(zt,Wt.mult(-1),0,0);else{const yr=-Math.sqrt(wn*wn-1),fr=Sn?yr:0,ar=Sn?0:yr;gt&&ir(zt,qt,fr,ar),bt&&ir(zt,Kt,fr,ar)}}jt.geometry=[...kt,...Ft.reverse(),kt[0]],jt.joinNormals=[...Gt,...Gt.reverse(),Gt[Gt.length-1]];const _n=jt.geometry.length-1;for(let sn=0;sn<_n/2;sn++)if(sn+1<_n/2){let Wt=sn,Wn=sn+1,wn=_n-1-sn,Sn=_n-2-sn;Wt=Wt===0?_n-1:Wt-1,Wn=Wn===0?_n-1:Wn-1,wn=wn===0?_n-1:wn-1,Sn=Sn===0?_n-1:Sn-1,jt.indices.push(wn),jt.indices.push(Wn),jt.indices.push(Wt),jt.indices.push(wn),jt.indices.push(Sn),jt.indices.push(Wn)}return jt}(s[0]),s=[we.geometry]}const ve=(Ze,et)=>Ze<(et.length-1)/2||Ze===et.length-1,ee=this.wallMode?[s]:ux(s,500);for(let Ze=ee.length-1;Ze>=0;Ze--){const et=ee[Ze];(et.length===0||(ge=et[0]).every(St=>St.x<=0)||ge.every(St=>St.x>=en)||ge.every(St=>St.y<=0)||ge.every(St=>St.y>=en))&&ee.splice(Ze,1)}var ge;let be;if(F)be=IE(ee,D,h);else{be=[];for(const Ze of ee)be.push({polygon:Ze,bounds:D})}const Ie=G?this.edgeRadius:0,Fe=Ie>0&&this.zoom<17,$e=(Ze,et)=>{if(Ze.length===0)return!1;const St=Ze[Ze.length-1];return et.x===St.x&&et.y===St.y};for(const{polygon:Ze,bounds:et}of be){let St=0,jt=0;for(const vt of Ze)G&&!vt[0].equals(vt[vt.length-1])&&vt.push(vt[0]),jt+=G?vt.length-1:vt.length;const kt=this.segments.prepareSegment((G?5:4)*jt,this.layoutVertexArray,this.indexArray);Q.footprintSegIdx<0&&(Q.footprintSegIdx=this.footprintSegments.length),Q.polygonSegIdx<0&&(Q.polygonSegIdx=this.polygonSegments.length);const Ft={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Gt=new gE;if(Gt.vertexOffset=this.footprintVertices.length,Gt.indexOffset=3*this.footprintIndices.length,Gt.ringIndices=[],G){const vt=[],zt=[];St=kt.vertexLength;for(let bt=0;bt<Ze.length;bt++){const qt=Ze[bt];qt.length&&bt!==0&&zt.push(vt.length/2);const Kt=[];let En,_n;En=qt[1].sub(qt[0])._perp()._unit(),Gt.ringIndices.push(qt.length-1);for(let sn=1;sn<qt.length;sn++){const Wt=qt[sn],Wn=qt[sn===qt.length-1?1:sn+1],wn=Wt.clone();if(Ie){_n=Wn.sub(Wt)._perp()._unit();const Sn=En.add(_n)._unit(),$n=Ie*Math.min(4,1/(En.x*Sn.x+En.y*Sn.y));wn.x+=$n*Sn.x,wn.y+=$n*Sn.y,wn.x=Math.round(wn.x),wn.y=Math.round(wn.y),En=_n}if(!ae||Ie!==0&&!Fe||$e(Kt,wn)||Kt.push(wn),fy(this.layoutVertexArray,wn.x,wn.y,0,0,1,1,0),this.wallMode){const Sn=ve(sn,qt);py(this.wallVertexArray,we.joinNormals[sn],!Sn)}kt.vertexLength++,this.footprintVertices.emplaceBack(Wt.x,Wt.y),vt.push(Wt.x,Wt.y),F&&my(this.layoutVertexExtArray,O.projectTilePoint(wn.x,wn.y,h),O.upVector(h,wn.x,wn.y))}ae&&(Ie===0||Fe)&&(Kt.length!==0&&$e(Kt,Kt[0])&&Kt.pop(),this.groundEffect.addData(Kt,et,A))}const gt=this.wallMode?we.indices:Xl(vt,zt);for(let bt=0;bt<gt.length;bt+=3)this.footprintIndices.emplaceBack(Gt.vertexOffset+gt[bt+0],Gt.vertexOffset+gt[bt+1],Gt.vertexOffset+gt[bt+2]),this.indexArray.emplaceBack(St+gt[bt],St+gt[bt+2],St+gt[bt+1]),kt.primitiveLength++;Gt.indexCount+=gt.length,Gt.vertexCount+=this.footprintVertices.length-Gt.vertexOffset}for(let vt=0;vt<Ze.length;vt++){const zt=Ze[vt];W.startRing(Q,zt[0]);let gt=zt.length>4&&CE(zt[zt.length-2],zt[0],zt[1]),bt=Ie?gN(zt[zt.length-2],zt[0],zt[1],Ie):0;const qt=[];let Kt,En,_n;En=zt[1].sub(zt[0])._perp()._unit();let sn=!0;for(let Wt=1,Wn=0;Wt<zt.length;Wt++){let wn=zt[Wt-1],Sn=zt[Wt];const $n=zt[Wt===zt.length-1?1:Wt+1];if(W.appendEdge(Q,Sn,wn),Ab(Sn,wn,et)){Ie&&(En=$n.sub(Sn)._perp()._unit(),sn=!sn);continue}const Jn=Sn.sub(wn)._perp(),ir=Jn.x/(Math.abs(Jn.x)+Math.abs(Jn.y)),yr=Jn.y>0?1:0,fr=wn.dist(Sn);if(Wn+fr>32768&&(Wn=0),Ie){_n=$n.sub(Sn)._perp()._unit();let Ee=wE(wn,Sn,$n,bE(En,_n),Ie);isNaN(Ee)&&(Ee=0);const Ae=Sn.sub(wn)._unit();wn=wn.add(Ae.mult(bt))._round(),Sn=Sn.add(Ae.mult(-Ee))._round(),bt=Ee,En=_n,ae&&this.zoom>=17&&($e(qt,wn)||qt.push(wn),$e(qt,Sn)||qt.push(Sn))}const ar=kt.vertexLength,_i=zt.length>4&&CE(wn,Sn,$n);let Ri=TE(Wn,gt,sn);if(fy(this.layoutVertexArray,wn.x,wn.y,ir,yr,0,0,Ri),fy(this.layoutVertexArray,wn.x,wn.y,ir,yr,0,1,Ri),this.wallMode){const Ee=ve(Wt-1,zt),Ae=we.joinNormals[Wt-1];py(this.wallVertexArray,Ae,Ee),py(this.wallVertexArray,Ae,Ee)}if(Wn+=fr,Ri=TE(Wn,_i,!sn),gt=_i,fy(this.layoutVertexArray,Sn.x,Sn.y,ir,yr,0,0,Ri),fy(this.layoutVertexArray,Sn.x,Sn.y,ir,yr,0,1,Ri),this.wallMode){const Ee=ve(Wt,zt),Ae=we.joinNormals[Wt];py(this.wallVertexArray,Ae,Ee),py(this.wallVertexArray,Ae,Ee)}if(kt.vertexLength+=4,this.indexArray.emplaceBack(ar+0,ar+1,ar+2),this.indexArray.emplaceBack(ar+1,ar+3,ar+2),kt.primitiveLength+=2,Ie){const Ee=St+(Wt===1?zt.length-2:Wt-2),Ae=Wt===1?St:Ee+1;if(this.indexArray.emplaceBack(ar+1,Ee,ar+3),this.indexArray.emplaceBack(Ee,Ae,ar+3),kt.primitiveLength+=2,Kt===void 0&&(Kt=ar),!Ab($n,zt[Wt],et)){const Et=Wt===zt.length-1?Kt:kt.vertexLength;this.indexArray.emplaceBack(ar+2,ar+3,Et),this.indexArray.emplaceBack(ar+3,Et+1,Et),this.indexArray.emplaceBack(ar+3,Ae,Et+1),kt.primitiveLength+=3}sn=!sn}if(F){const Ee=this.layoutVertexExtArray,Ae=O.projectTilePoint(wn.x,wn.y,h),Et=O.projectTilePoint(Sn.x,Sn.y,h),Jt=O.upVector(h,wn.x,wn.y),an=O.upVector(h,Sn.x,Sn.y);my(Ee,Ae,Jt),my(Ee,Ae,Jt),my(Ee,Et,an),my(Ee,Et,an)}}G&&(St+=zt.length-1),ae&&Ie&&this.zoom>=17&&(qt.length!==0&&$e(qt,qt[0])&&qt.pop(),this.groundEffect.addData(qt,et,A,Ie>0))}this.footprintSegments.push(Gt),Ft.triangleCount=this.indexArray.length-Ft.triangleArrayOffset,this.polygonSegments.push(Ft),++Q.footprintSegLen,++Q.polygonSegLen}if(Q.vertexCount=this.layoutVertexArray.length-Q.vertexArrayOffset,Q.groundVertexCount=this.groundEffect.vertexArray.length-Q.groundVertexArrayOffset,Q.vertexCount!==0){if(Q.centroidXY=W.borders?mE:this.encodeCentroid(W,Q),this.centroidData.push(Q),W.borders){this.featuresOnBorder.push(W);const Ze=this.featuresOnBorder.length-1;for(let et=0;et<W.borders.length;et++)W.borders[et][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[et].push(Ze)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,m,_,h,E),this.groundEffect.addPaintPropertiesData(t,u,m,_,h,E),this.maxHeight=Math.max(this.maxHeight,ce)}}sortBorders(){for(let t=0;t<this.borderFeatureIndices.length;t++)this.borderFeatureIndices[t].sort((s,u)=>this.featuresOnBorder[s].borders[t][0]-this.featuresOnBorder[u].borders[t][0])}splitToSubtiles(){const t=[];for(let S=0;S<this.centroidData.length;S++){const E=this.centroidData[S],A=+(E.min.y+E.max.y>en),D=2*A+(+(E.min.x+E.max.x>en)^A);for(let O=0;O<E.polygonSegLen;O++){const F=E.polygonSegIdx+O;t.push({centroidIdx:S,subtile:D,polygonSegmentIdx:F,triangleSegmentIdx:this.polygonSegments[F].triangleSegIdx})}}const s=new gs;t.sort((S,E)=>S.triangleSegmentIdx===E.triangleSegmentIdx?S.subtile-E.subtile:S.triangleSegmentIdx-E.triangleSegmentIdx);let u=0,h=0,m=0;for(const S of t){if(S.triangleSegmentIdx!==u)break;m++}const _=t.length;for(;h!==t.length;){u=t[h].triangleSegmentIdx;let S=0,E=h,A=h;for(let D=E;D<m&&t[D].subtile===S;D++)A++;for(;E!==m;){const D=t[E];S=D.subtile;const O=this.centroidData[D.centroidIdx].min.clone(),F=this.centroidData[D.centroidIdx].max.clone(),G={vertexOffset:this.segments.segments[u].vertexOffset,primitiveOffset:s.length,vertexLength:this.segments.segments[u].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let W=E;W<A;W++){const Q=t[W],ae=this.polygonSegments[Q.polygonSegmentIdx],ce=this.centroidData[Q.centroidIdx].min,we=this.centroidData[Q.centroidIdx].max,ve=this.indexArray.uint16;for(let ee=ae.triangleArrayOffset;ee<ae.triangleArrayOffset+ae.triangleCount;ee++)s.emplaceBack(ve[3*ee],ve[3*ee+1],ve[3*ee+2]);G.primitiveLength+=ae.triangleCount,O.x=Math.min(O.x,ce.x),O.y=Math.min(O.y,ce.y),F.x=Math.max(F.x,we.x),F.y=Math.max(F.y,we.y)}G.primitiveLength>0&&this.triangleSubSegments.push({segment:G,min:O,max:F}),E=A;for(let W=E;W<m&&t[W].subtile===t[E].subtile;W++)A++}h=m;for(let D=h;D<_&&t[D].triangleSegmentIdx===t[h].triangleSegmentIdx;D++)m++}s._trim(),this.indexArray=s}getVisibleSegments(t,s,u){const h=new ki;if(this.wallMode){for(const Q of this.triangleSubSegments)h.segments.push(Q.segment);return h}let m=0,_=0;const S=1<<t.canonical.z;if(s){const Q=s.getMinMaxForTile(t);Q&&(m=Q.min,_=Q.max)}_+=this.maxHeight;const E=t.toUnwrapped();let A;const D=[E.canonical.x/S+E.wrap,E.canonical.y/S],O=[(E.canonical.x+1)/S+E.wrap,(E.canonical.y+1)/S],F=(Q,ae,ce)=>[Q[0]*(1-ce[0])+ae[0]*ce[0],Q[1]*(1-ce[1])+ae[1]*ce[1]],G=[],W=[];for(const Q of this.triangleSubSegments){G[0]=Q.min.x/en,G[1]=Q.min.y/en,W[0]=Q.max.x/en,W[1]=Q.max.y/en;const ae=F(D,O,G),ce=F(D,O,W);if(new Ai([ae[0],ae[1],m],[ce[0],ce[1],_]).intersectsPrecise(u)===0){A&&(h.segments.push(A),A=void 0);continue}const we=Q.segment;A&&A.vertexOffset!==we.vertexOffset&&(h.segments.push(A),A=void 0),A?(A.vertexLength+=we.vertexLength,A.primitiveLength+=we.primitiveLength):A={vertexOffset:we.vertexOffset,primitiveLength:we.primitiveLength,vertexLength:we.vertexLength,primitiveOffset:we.primitiveOffset,sortKey:void 0,vaos:{}}}return A&&h.segments.push(A),h}encodeCentroid(t,s){const u=t.centroid(),h=s.span(),m=Math.min(7,Math.round(h.x*this.tileToMeter/10)),_=Math.min(7,Math.round(h.y*this.tileToMeter/10));return new Qt(Xe(u.x,1,en-1)<<3|m,Xe(u.y,1,en-1)<<3|_)}encodeBorderCentroid(t){if(!t.borders)return new Qt(0,0);const s=t.borders,u=Number.MAX_VALUE;if(s[0][0]!==u||s[1][0]!==u){const h=s[0][0]!==u?0:1;return new Qt(6|(s[0][0]!==u?0:65528),(s[h][0]+s[h][1])/2<<3|6)}{const h=s[2][0]!==u?2:3;return new Qt((s[h][0]+s[h][1])/2<<3|6,6|(s[2][0]!==u?0:65528))}}showCentroid(t){const s=this.centroidData[t.centroidDataIndex];s.flags&=Sp,s.centroidXY.x=0,s.centroidXY.y=0,this.writeCentroidToBuffer(s)}writeCentroidToBuffer(t){this.groundEffect.updateHiddenByLandmark(t);const s=t.vertexArrayOffset,u=t.vertexCount+t.vertexArrayOffset,h=t.flags&Sp?mE:t.centroidXY,m=this.centroidVertexArray.geta_centroid_pos0(s);if(this.centroidVertexArray.geta_centroid_pos1(s)!==h.y||m!==h.x){for(let _=s;_<u;++_)this.centroidVertexArray.emplace(_,h.x,h.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const t of this.centroidData)this.writeCentroidToBuffer(t)}updateReplacement(t,s,u){if(s.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=s.updateTime;const h=s.getReplacementRegionsForTile(t.toUnwrapped());if(Eb(this.activeReplacements,h))return;if(this.activeReplacements=h,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const _ of this.centroidData)_.flags&=2147483647;const m=[];for(const _ of this.activeReplacements){if(_.order<u)continue;const S=Math.max(1,Math.pow(2,_.footprintTileId.canonical.z-t.canonical.z));for(const E of this.centroidData)if(!(E.flags&Sp||_.min.x>E.max.x||E.min.x>_.max.x||_.min.y>E.max.y||E.min.y>_.max.y))for(let A=0;A<E.footprintSegLen;A++){const D=this.footprintSegments[E.footprintSegIdx+A];if(m.length=0,_N(this.footprintVertices,D.vertexOffset,D.vertexCount,_.footprintTileId.canonical,t.canonical,m),uE(_.footprint,m,this.footprintIndices.uint16,D.indexOffset,D.indexCount,-D.vertexOffset,-S)){E.flags|=Sp;break}}}for(const _ of this.centroidData)this.writeCentroidToBuffer(_);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(t,s,u){let h=!1;for(let m=0;m<u.footprintSegLen;m++){const _=this.footprintSegments[u.footprintSegIdx+m];let S=0;for(const E of _.ringIndices){for(let A=S,D=E+S-1;A<E+S;D=A++){const O=this.footprintVertices.int16[2*(A+_.vertexOffset)+0],F=this.footprintVertices.int16[2*(A+_.vertexOffset)+1],G=this.footprintVertices.int16[2*(D+_.vertexOffset)+1];F>s!=G>s&&t<(this.footprintVertices.int16[2*(D+_.vertexOffset)+0]-O)*(s-F)/(G-F)+O&&(h=!h)}S=E}}return h}getHeightAtTileCoord(t,s){let u=Number.NEGATIVE_INFINITY,h=!0;const m=4*(t+en)*en+(s+en);if(this.partLookup.hasOwnProperty(m)){const _=this.partLookup[m];return _?{height:_.height,hidden:!!(_.flags&Sp)}:void 0}for(const _ of this.centroidData)t>_.max.x||_.min.x>t||s>_.max.y||_.min.y>s||this.footprintContainsPoint(t,s,_)&&_&&_.height>u&&(u=_.height,this.partLookup[m]=_,h=!!(_.flags&Sp));if(u!==Number.NEGATIVE_INFINITY)return{height:u,hidden:h};this.partLookup[m]=void 0}}function bE(a,t){const s=a.add(t)._unit();return a.x*s.x+a.y*s.y}function gN(a,t,s,u){const h=t.sub(a)._perp()._unit(),m=s.sub(t)._perp()._unit();return wE(a,t,s,bE(h,m),u)}function wE(a,t,s,u,h){const m=Math.sqrt(1-u*u);return Math.min(a.dist(t)/3,t.dist(s)/3,h*m/u)}function Ab(a,t,s){return a.x<s[0].x&&t.x<s[0].x||a.x>s[1].x&&t.x>s[1].x||a.y<s[0].y&&t.y<s[0].y||a.y>s[1].y&&t.y>s[1].y}function SE(a,t){return a.x<t[0].x||a.x>t[1].x||a.y<t[0].y||a.y>t[1].y}function CE(a,t,s){if(a.x<0||a.x>=en||t.x<0||t.x>=en||s.x<0||s.x>=en)return!1;const u=s.sub(t),h=u.perp(),m=a.sub(t);return(u.x*m.x+u.y*m.y)/Math.sqrt((u.x*u.x+u.y*u.y)*(m.x*m.x+m.y*m.y))>-.866&&h.x*m.x+h.y*m.y<0}function TE(a,t,s){const u=t?2|a:-3&a;return s?1|u:-2&u}function EE(){const a=Math.PI/32,t=Math.tan(a),s=te;return s*Math.sqrt(1+2*t*t)-s}function IE(a,t,s){const u=1<<s.z,h=Oe(s.x/u),m=Oe((s.x+1)/u),_=Ne(s.y/u),S=Ne((s.y+1)/u);return function(E,A,D,O,F=0,G){const W=[];if(!E.length||!D||!O)return W;const Q=(be,Ie)=>{for(const Fe of be)W.push({polygon:Fe,bounds:Ie})},ae=Math.ceil(Math.log2(D)),ce=Math.ceil(Math.log2(O)),we=ae-ce,ve=[];for(let be=0;be<Math.abs(we);be++)ve.push(we>0?0:1);for(let be=0;be<Math.min(ae,ce);be++)ve.push(0),ve.push(1);let ee=E;if(ee=hx(ee,A[0].y-F,A[1].y+F,1),ee=hx(ee,A[0].x-F,A[1].x+F,0),!ee.length)return W;const ge=[];for(ve.length?ge.push({polygons:ee,bounds:A,depth:0}):Q(ee,A);ge.length;){const be=ge.pop(),Ie=be.depth,Fe=ve[Ie],$e=be.bounds[0],Ze=be.bounds[1],et=Fe===0?$e.x:$e.y,St=Fe===0?Ze.x:Ze.y,jt=G?G(Fe,et,St):.5*(et+St),kt=hx(be.polygons,et-F,jt+F,Fe),Ft=hx(be.polygons,jt-F,St+F,Fe);if(kt.length){const Gt=[$e,new Qt(Fe===0?jt:Ze.x,Fe===1?jt:Ze.y)];ve.length>Ie+1?ge.push({polygons:kt,bounds:Gt,depth:Ie+1}):Q(kt,Gt)}if(Ft.length){const Gt=[new Qt(Fe===0?jt:$e.x,Fe===1?jt:$e.y),Ze];ve.length>Ie+1?ge.push({polygons:Ft,bounds:Gt,depth:Ie+1}):Q(Ft,Gt)}}return W}(a,t,Math.ceil((m-h)/11.25),Math.ceil((_-S)/11.25),1,(E,A,D)=>{if(E===0)return .5*(A+D);{const O=Ne((s.y+A/en)/u);return(Me(.5*(Ne((s.y+D/en)/u)+O))*u-s.y)*en}})}function _N(a,t,s,u,h,m){const _=Math.pow(2,u.z-h.z);for(let S=0;S<s;S++){let E=a.int16[2*(S+t)+0],A=a.int16[2*(S+t)+1];E=(E+h.x*en)*_-u.x*en,A=(A+h.y*en)*_-u.y*en,m.push(new Qt(E,A))}}let PE,AE;un(gx,"FillExtrusionBucket",{omit:["layers","features"]}),un(_E,"PartData"),un(gE,"FootprintSegment"),un(yE,"BorderCentroidData"),un(xE,"GroundEffect");class Bm extends Qt{constructor(t,s,u){super(t,s),this.z=u}}class RE extends Bm{constructor(t,s,u,h){super(t,s,u),this.w=h}}function ME(a,t,s,u){const h=s==="x"?"y":"x",m=(u-a[s])/(t[s]-a[s]);a[h]=Math.round(a[h]+(t[h]-a[h])*m),a[s]=u,a.hasOwnProperty("z")&&(a.z=kn(a.z,t.z,m)),a.hasOwnProperty("w")&&(a.w=kn(a.w,t.w,m))}function LE(a,t,s,u){const h=s,m=u;for(const _ of["x","y"]){let S=a,E=t;S[_]>=E[_]&&(S=t,E=a),S[_]<h&&E[_]>h&&ME(S,E,_,h),S[_]<m&&E[_]>m&&ME(E,S,_,m)}}function _x(a,t,s,u,h,m){const _=[];for(let S=0;S<a.length;S++){const E=a[S];let A;const D=_.length;let O=0;for(let F=0;F<E.length-1;F++){let G=E[F],W=E[F+1],Q=0;const ae=O;let ce,we;m&&(Q=Math.hypot(W.x-G.x,W.y-G.y),O+=Q,ce=G,we=W),G.x<t&&W.x<t||(G.x<t?G=new Qt(t,G.y+(t-G.x)/(W.x-G.x)*(W.y-G.y))._round():W.x<t&&(W=new Qt(t,G.y+(t-G.x)/(W.x-G.x)*(W.y-G.y))._round()),G.y<s&&W.y<s||(G.y<s?G=new Qt(G.x+(s-G.y)/(W.y-G.y)*(W.x-G.x),s)._round():W.y<s&&(W=new Qt(G.x+(s-G.y)/(W.y-G.y)*(W.x-G.x),s)._round()),G.x>=u&&W.x>=u||(G.x>=u?G=new Qt(u,G.y+(u-G.x)/(W.x-G.x)*(W.y-G.y))._round():W.x>=u&&(W=new Qt(u,G.y+(u-G.x)/(W.x-G.x)*(W.y-G.y))._round()),G.y>=h&&W.y>=h||(G.y>=h?G=new Qt(G.x+(h-G.y)/(W.y-G.y)*(W.x-G.x),h)._round():W.y>=h&&(W=new Qt(G.x+(h-G.y)/(W.y-G.y)*(W.x-G.x),h)._round()),A&&G.equals(A[A.length-1])||(A=[G],_.push(A),m&&m.push({progress:{min:ae+DE(ce,we,G)*Q,max:1},parentIndex:S,prevPoint:ce,nextPoint:we})),A.push(W),m&&(m[m.length-1].progress.max=ae+DE(ce,we,W)*Q,m[m.length-1].nextPoint=we)))))}if(m&&O>0)for(let F=D;F<_.length;F++)m[F].progress.min/=O,m[F].progress.max/=O}return _}function yN(a,t,s,u,h){if(a.length<2)return void u.push(a);const m=[];for(;t.valid();){const[A,D]=t.get();for(let O=0;O<a.length-1;O++){const F=a[O],G=a[O+1],W=Pi(F,G,A,D);if(W){const[Q]=W,ae=new Qt(kn(F.x,G.x,Q),kn(F.y,G.y,Q));m.push({t:O+Q,distance:0,point:ae})}}t.next()}if(m.length===0)return void u.push(a);m.sort((A,D)=>A.t-D.t);let _=0,S=0,E=[];for(u.push(E);_!==a.length;){if(S===m.length){for(;_!==a.length;)E.length!==0&&E[E.length-1].equals(a[_])||E.push(a[_]),_++;break}m[S].t<=_?(E.length!==0&&E[E.length-1].equals(m[S].point)||E.push(m[S].point),Math.trunc(m[S].t),S++):(E.length!==0&&E[E.length-1].equals(a[_])||E.push(a[_]),_++)}}function DE(a,t,s){return a.x!==t.x?(s.x-a.x)/(t.x-a.x):a.y!==t.y?(s.y-a.y)/(t.y-a.y):0}function gy(a,t){return a.x*t.x+a.y*t.y}function kE(a,t){if(a.length===1){let s=0;const u=t[s++];let h;for(;!h||u.equals(h);)if(h=t[s++],!h)return 1/0;for(;s<t.length;s++){const m=t[s],_=a[0],S=h.sub(u),E=m.sub(u),A=_.sub(u),D=gy(S,S),O=gy(S,E),F=gy(E,E),G=gy(A,S),W=gy(A,E),Q=D*F-O*O,ae=(F*G-O*W)/Q,ce=(D*W-O*G)/Q,we=u.z*(1-ae-ce)+h.z*ae+m.z*ce;if(isFinite(we))return we}return 1/0}{let s=1/0;for(const u of t)s=Math.min(s,u.z);return s}}function OE(a,t,s,u,h,m,_,S){const E=_*h.getElevationAt(a,t,!0,!0),A=m[0]!==0,D=A?m[1]===0?_*(m[0]/7-450):_*function(O,F,G){const W=Math.floor(F[0]/8),Q=Math.floor(F[1]/8),ae=10*(F[0]-8*W),ce=10*(F[1]-8*Q),we=O.getElevationAt(W,Q,!0,!0),ve=O.getMeterToDEM(G),ee=Math.floor(.5*(ae*ve-1)),ge=Math.floor(.5*(ce*ve-1)),be=O.tileCoordToPixel(W,Q),Ie=2*ee+1,Fe=2*ge+1,$e=function(Ft,Gt,vt,zt,gt){return[Ft.getElevationAtPixel(Gt,vt,!0),Ft.getElevationAtPixel(Gt+gt,vt,!0),Ft.getElevationAtPixel(Gt,vt+gt,!0),Ft.getElevationAtPixel(Gt+zt,vt+gt,!0)]}(O,be.x-ee,be.y-ge,Ie,Fe),Ze=Math.abs($e[0]-$e[1]),et=Math.abs($e[2]-$e[3]),St=Math.abs($e[0]-$e[2])+Math.abs($e[1]-$e[3]),jt=Math.min(.25,.5*ve*(Ze+et)/Ie),kt=Math.min(.25,.5*ve*St/Fe);return we+Math.max(jt*ae,kt*ce)}(h,m,S):E;return{base:E+(s===0?-1:s),top:A?Math.max(D+u,E+s+2):E+u}}const vN=Vr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),xN=Vr([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:bN}=vN,wN=Vr([{name:"a_packed",components:3,type:"Float32"}]),{members:SN}=wN,CN=Vr([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:TN}=CN;class zE{constructor(t,s){this.width=t,this.height=s,this.nextRow=0,this.image=new $t({width:t,height:s}),this.positions={},this.uploaded=!1}getDash(t,s){const u=this.getKey(t,s);return this.positions[u]}trim(){const t=this.width,s=this.height=xn(this.nextRow);this.image.resize({width:t,height:s})}getKey(t,s){return t.join(",")+s}getDashRanges(t,s,u){const h=[];let m=t.length%2==1?-t[t.length-1]*u:0,_=t[0]*u,S=!0;h.push({left:m,right:_,isDash:S,zeroLength:t[0]===0});let E=t[0];for(let A=1;A<t.length;A++){S=!S;const D=t[A];m=E*u,E+=D,_=E*u,h.push({left:m,right:_,isDash:S,zeroLength:D===0})}return h}addRoundDash(t,s,u){const h=s/2;for(let m=-u;m<=u;m++){const _=this.width*(this.nextRow+u+m);let S=0,E=t[S];for(let A=0;A<this.width;A++){A/E.right>1&&(E=t[++S]);const D=Math.abs(A-E.left),O=Math.abs(A-E.right),F=Math.min(D,O);let G;const W=m/u*(h+1);if(E.isDash){const Q=h-Math.abs(W);G=Math.sqrt(F*F+Q*Q)}else G=h-Math.sqrt(F*F+W*W);this.image.data[_+A]=Math.max(0,Math.min(255,G+128))}}}addRegularDash(t,s){for(let E=t.length-1;E>=0;--E){const A=t[E],D=t[E+1];A.zeroLength?t.splice(E,1):D&&D.isDash===A.isDash&&(D.left=A.left,t.splice(E,1))}const u=t[0],h=t[t.length-1];u.isDash===h.isDash&&(u.left=h.left-this.width,h.right=u.right+this.width);const m=this.width*this.nextRow;let _=0,S=t[_];for(let E=0;E<this.width;E++){E/S.right>1&&(S=t[++_]);const A=Math.abs(E-S.left),D=Math.abs(E-S.right),O=Math.min(A,D);this.image.data[m+E]=Math.max(0,Math.min(255,(S.isDash?O:-O)+s+128))}}addDash(t,s){const u=this.getKey(t,s);if(this.positions[u])return this.positions[u];const h=s==="round",m=h?7:0,_=2*m+1;if(this.nextRow+_>this.height)return gr("LineAtlas out of space"),null;t.length===0&&t.push(1);let S=0;for(let D=0;D<t.length;D++)t[D]<0&&(gr("Negative value is found in line dasharray, replacing values with 0"),t[D]=0),S+=t[D];if(S!==0){const D=this.width/S,O=this.getDashRanges(t,this.width,D);h?this.addRoundDash(O,D,m):this.addRegularDash(O,s==="square"?.5*D:0)}const E=this.nextRow+m;this.nextRow+=_;const A={tl:[E,m],br:[S,0]};return this.positions[u]=A,A}}un(zE,"LineAtlas");const EN=wp.VectorTileFeature.types,IN=Math.cos(Math.PI/180*37.5),PN=Math.cos(Math.PI/180*5);class Rb{constructor(t){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.elevationType="none",this.zoom=t.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=t.overscaling,this.pixelRatio=t.pixelRatio,this.layers=t.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=t.index,this.projection=t.projection,this.hasPattern=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new rp,this.layoutVertexArray2=new sl,this.patternVertexArray=new sl,this.indexArray=new gs,this.programConfigurations=new Ec(t.layers,{zoom:t.zoom,lut:t.lut}),this.segments=new ki,this.maxLineLength=0,this.zOffsetVertexArray=new sl,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.tessellationStep=t.tessellationStep?t.tessellationStep:en/64}updateFootprints(t,s){}populate(t,s,u,h){this.hasPattern=pb("line",this.layers,this.pixelRatio,s);const m=this.layers[0].layout.get("line-sort-key");this.tileToMeter=Qe(u);const _=this.layers[0].layout.get("line-elevation-reference");if(_==="hd-road-markup")this.elevationType="road";else{const F=this.layers[0].layout.get("line-z-offset"),G=F.isConstant()&&!F.constantOr(0);this.elevationType=_!=="sea"&&_!=="ground"&&G?"none":"offset",this.elevationType==="offset"&&_==="none"&&gr(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`)}const S=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.elevationType==="offset"&&S!==void 0;const E=[];for(const{feature:F,id:G,index:W,sourceLayerIndex:Q}of t){const ae=this.layers[0]._featureFilter.needGeometry,ce=bn(F,ae);if(!this.layers[0]._featureFilter.filter(new ni(this.zoom),ce,u))continue;const we=m?m.evaluate(ce,{},u):void 0,ve={id:G,properties:F.properties,type:F.type,sourceLayerIndex:Q,index:W,geometry:ae?ce.geometry:pn(F,u,h),patterns:{},sortKey:we};E.push(ve)}m&&E.sort((F,G)=>F.sortKey-G.sortKey);const{lineAtlas:A,featureIndex:D}=s,O=this.addConstantDashes(A);for(const F of E){const{geometry:G,index:W,sourceLayerIndex:Q}=F;if(O&&this.addFeatureDashes(F,A),this.hasPattern){const ae=mb("line",this.layers,F,this.zoom,this.pixelRatio,s);this.patternFeatures.push(ae)}else this.addFeature(F,G,W,u,A.positions,s.availableImages,s.brightness,s.elevationFeatures);D.insert(t[W].feature,G,W,Q,this.index)}}addConstantDashes(t){let s=!1;for(const u of this.layers){const h=u.paint.get("line-dasharray").value,m=u.layout.get("line-cap").value;if(h.kind!=="constant"||m.kind!=="constant")s=!0;else{const _=m.value,S=h.value;if(!S)continue;t.addDash(S,_)}}return s}addFeatureDashes(t,s){const u=this.zoom;for(const h of this.layers){const m=h.paint.get("line-dasharray").value,_=h.layout.get("line-cap").value;if(m.kind==="constant"&&_.kind==="constant")continue;let S,E;if(m.kind==="constant"){if(S=m.value,!S)continue}else S=m.evaluate({zoom:u},t);E=_.kind==="constant"?_.value:_.evaluate({zoom:u},t),s.addDash(S,E),t.patterns[h.id]=[s.getKey(S,E)]}}update(t,s,u,h,m,_,S){this.programConfigurations.updatePaintArrays(t,s,m,u,h,_,S)}addFeatures(t,s,u,h,m,_){for(const S of this.patternFeatures)this.addFeature(S,S.geometry,S.index,s,u,h,_)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,SN)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=t.createVertexBuffer(this.patternVertexArray,TN)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=t.createVertexBuffer(this.zOffsetVertexArray,xN.members,!0)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,bN),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,s,u,h,m,_,S,E){const A=this.layers[0].layout,D=A.get("line-join").evaluate(t,{}),O=A.get("line-cap").evaluate(t,{}),F=A.get("line-miter-limit"),G=A.get("line-round-limit");this.lineClips=this.lineFeatureClips(t),this.lineFeature=t,this.zOffsetValue=A.get("line-z-offset").value;const W=this.layers[0].paint.get("line-width").value;if(W.kind!=="constant"&&W.isLineProgressConstant===!1&&(this.variableWidthValue=W),this.elevationType==="road"){const Q=this.layoutVertexArray.length;if(!this.addElevatedRoadFeature(t,s,h,E,D,O,F,G)){const[ae,ce]=this.clipRuntimeLinesToTile(s,1);for(let we=0;we<ae.length;we++){const ve=ae[we],ee=ce[we],ge={progress:{min:ee.progress.min,max:ee.progress.max},nextDir:this.computeSegNextDir(ee,ve),prevDir:this.computeSegPrevDir(ee,ve)};this.addLine(ve,t,h,D,O,F,G,ge)}this.fillNonElevatedRoadSegment(Q)}}else for(const Q of s)this.addLine(Q,t,h,D,O,F,G);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,m,_,h,S)}computeSegNextDir(t,s){return t.nextPoint.sub(s.at(-2)).unit()}computeSegPrevDir(t,s){return s[1].sub(t.prevPoint).unit()}clipLinesToTile(t,s){return _x(t,-s,-s,en+s,en+s)}clipRuntimeLinesToTile(t,s){const u=[];return[_x(t,-s,-s,en+s,en+s,u),u]}addElevatedRoadFeature(t,s,u,h,m,_,S,E){const A=[],D=xb.getElevationFeature(t,h);if(D){const O=this.clipLinesToTile(s,1),F=this.prepareElevatedLines(O,D,u);for(const G of F)A.push({geometry:G,elevation:D,elevationTileID:u,segment:{progress:{min:0,max:1},nextDir:void 0,prevDir:void 0}})}if(A.length===0)return!1;for(const O of A){const F=this.layoutVertexArray.length;this.addLine(O.geometry,t,u,m,_,S,E);const G=new KT(u,O.elevationTileID);if(O.elevation)for(let W=F;W<this.layoutVertexArray.length;W++){const Q=new Qt(this.layoutVertexArray.int16[6*W]>>1,this.layoutVertexArray.int16[6*W+1]>>1),ae=G.pointElevation(Q,O.elevation,.05);this.updateHeightRange(ae),this.zOffsetVertexArray.emplaceBack(ae,0,0)}else this.fillNonElevatedRoadSegment(F)}return!0}prepareElevatedLines(t,s,u){if(s.constantHeight!=null)return t;const h=[],m=1/Qe(u);for(const _ of t)yN(_,new XT(s,m),0,h);return h}fillNonElevatedRoadSegment(t){for(let s=t;s<this.layoutVertexArray.length;s++)this.zOffsetVertexArray.emplaceBack(0,0,0)}updateHeightRange(t){this.heightRange?(this.heightRange.min=Math.min(this.heightRange.min,t),this.heightRange.max=Math.max(this.heightRange.max,t)):this.heightRange={min:t,max:t}}addLine(t,s,u,h,m,_,S,E){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const A=h==="none";this.patternJoinNone=this.hasPattern&&A,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[];const D=E&&E.progress.min>0,O=E&&E.progress.max<1;if(this.lineClips){let Fe={min:this.lineClips.start,max:this.lineClips.end},$e=1;if(E){const St=this.lineClips.end-this.lineClips.start;Fe=function(jt,kt,Ft){return{min:Hs(jt.min,kt,Ft),max:Hs(jt.max,kt,Ft)}}(E.progress,{min:0,max:1},Fe),St>0&&($e=(Fe.max-Fe.min)/St)}const Ze=+s.properties.mapbox_clip_feature_len,et=+s.properties.mapbox_clip_seg_len;if(Number.isNaN(Ze)||Number.isNaN(et)){for(let jt=0;jt<t.length-1;jt++)this.totalDistance+=t[jt].dist(t[jt+1]);const St=this.totalDistance/(Fe.max-Fe.min);this.totalFeatureLength=Number.isFinite(St)?St:0,this.lineClips.start=Fe.min,this.lineClips.end=Fe.max,this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}else this.totalFeatureLength=Ze,this.distance=et*$e,this.lineClips.start=Fe.min,this.lineClips.end=Fe.max,this.maxLineLength=Math.max(this.maxLineLength,this.distance);this.lineClipsArray.push(this.lineClips),this.updateScaledDistance()}const F=EN[s.type]==="Polygon";let G=t.length;for(;G>=2&&t[G-1].equals(t[G-2]);)G--;let W=0;for(;W<G-1&&t[W].equals(t[W+1]);)W++;if(G<(F?3:2))return;h==="bevel"&&(_=1.05);const Q=this.segments.prepareSegment(10*G,this.layoutVertexArray,this.indexArray);let ae,ce,we,ve,ee,ge,be,Ie;E&&E.prevDir&&(ge=E.prevDir.perp()),E&&E.nextDir&&(be=E.nextDir.perp()),this.e1=this.e2=-1,F&&(ae=t[G-2],ee=t[W].sub(ae)._unit()._perp());for(let Fe=W;Fe<G;Fe++){if(we=Fe===G-1?F?t[W+1]:void 0:t[Fe+1],we&&t[Fe].equals(we))continue;ee&&(ve=ee),ae&&(ce=ae),ae=t[Fe],Ie=this.evaluateLineProgressFeatures(ce?ce.dist(ae):0),ee=we?we.sub(ae)._unit()._perp():ve,ve=ve||ee;const $e=ce&&we;let Ze=$e?h:F||A?"butt":m;const et=ve.x*ee.x+ve.y*ee.y;if(A){const gt=function(bt){if(bt.patternJoinNone){const qt=bt.segmentPoints.length/2,Kt=bt.lineSoFar-bt.segmentStart;for(let En=0;En<qt;++En){const _n=bt.segmentPoints[2*En+1],sn=Math.round(bt.segmentPoints[2*En])+.5+.25*_n;bt.patternVertexArray.emplaceBack(sn,Kt,bt.segmentStart),bt.patternVertexArray.emplaceBack(sn,Kt,bt.segmentStart)}bt.segmentPoints.length=0}bt.e1=bt.e2=-1};if($e&&et<PN){this.updateDistance(ce,ae),this.addCurrentVertex(ae,ve,1,1,Q,Ie),gt(this),this.addCurrentVertex(ae,ee,-1,-1,Q,Ie);continue}if(ce){if(!we){this.updateDistance(ce,ae),this.addCurrentVertex(ae,ve,1,1,Q,Ie),gt(this);continue}Ze="miter"}}let St=ve.add(ee);St.x===0&&St.y===0||St._unit();const jt=St.x*ee.x+St.y*ee.y,kt=jt!==0?1/jt:1/0,Ft=2*Math.sqrt(2-2*jt),Gt=jt<IN&&ce&&we,vt=ve.x*ee.y-ve.y*ee.x>0,zt=this.overscaling<=16?15*en/(512*this.overscaling):0;if($e&&Ze==="round"){if(kt<S)Ze="miter";else if(kt<=2){const gt=Mb(ae,-10,en+10);Ze=this.elevationType==="offset"&&(gt||this.hasCrossSlope)?"miter":"fakeround"}}if(Ze==="miter"&&kt>_&&(Ze="bevel"),Ze==="bevel"&&(kt>2&&(Ze="flipbevel"),kt<_&&(Ze="miter")),ce&&!(Ze==="miter"&&Gt)&&this.updateDistance(ce,ae),Ze==="miter")if(Gt){const gt=ae.dist(ce);if(gt>2*zt){const qt=ae.sub(ae.sub(ce)._mult(zt/gt)._round());this.updateDistance(ce,qt),this.addCurrentVertex(qt,ve,0,0,Q,Ie),ce=qt}this.updateDistance(ce,ae),St._mult(kt),this.addCurrentVertex(ae,St,0,0,Q,Ie);const bt=ae.dist(we);if(bt>2*zt){const qt=ae.add(we.sub(ae)._mult(zt/bt)._round());this.updateDistance(ae,qt),this.addCurrentVertex(qt,ee,0,0,Q,Ie),ae=qt}}else St._mult(kt),this.addCurrentVertex(ae,St,0,0,Q,Ie);else if(Ze==="flipbevel"){if(kt>100)St=ee.mult(-1);else{const gt=kt*ve.add(ee).mag()/ve.sub(ee).mag();St._perp()._mult(gt*(vt?-1:1))}this.addCurrentVertex(ae,St,0,0,Q,Ie),this.addCurrentVertex(ae,St.mult(-1),0,0,Q,Ie)}else if(Ze==="bevel"||Ze==="fakeround"){Ie!=null&&ce&&this.addCurrentVertex(ae,be||ve,-1,-1,Q,Ie);const gt=ae.dist(ce)<=2*zt&&Ze!=="bevel",bt=St.mult(vt?1:-1);bt._mult(kt);const qt=ee.mult(vt?-1:1),Kt=ve.mult(vt?-1:1),En=this.evaluateLineProgressFeatures(this.distance);if(Ie==null&&(this.addHalfVertex(ae,bt.x,bt.y,!1,!vt,0,Q,En),gt||this.addHalfVertex(ae,bt.x+2*Kt.x,bt.y+2*Kt.y,!1,vt,0,Q,En)),Ze==="fakeround"){const _n=Math.round(180*Ft/Math.PI/20);this.addHalfVertex(ae,Kt.x,Kt.y,!1,vt,0,Q,En);for(let sn=0;sn<_n;sn++){let Wt=sn/_n;if(Wt!==.5){const wn=Wt-.5;Wt+=Wt*wn*(Wt-1)*((1.0904+et*(et*(3.55645-1.43519*et)-3.2452))*wn*wn+(.848013+et*(.215638*et-1.06021)))}const Wn=qt.sub(Kt)._mult(Wt)._add(Kt)._unit();this.addHalfVertex(ae,Wn.x,Wn.y,!1,vt,0,Q,En)}this.addHalfVertex(ae,qt.x,qt.y,!1,vt,0,Q,En)}gt||Ie!=null||this.addHalfVertex(ae,bt.x+2*qt.x,bt.y+2*qt.y,!1,vt,0,Q,En),Ie!=null&&we&&this.addCurrentVertex(ae,ge||ee,1,1,Q,Ie)}else if(Ze==="butt")this.addCurrentVertex(ae,St,0,0,Q,Ie);else if(Ze==="square"){if(!ce){const gt=D?0:-1;this.addCurrentVertex(ae,St,gt,gt,Q,Ie)}if(this.addCurrentVertex(ae,St,0,0,Q,Ie),ce){const gt=O?0:1;this.addCurrentVertex(ae,St,gt,gt,Q,Ie)}}else if(Ze==="round"){if(ce){const gt=!$e&&be?be:ve;this.addCurrentVertex(ae,gt,0,0,Q,Ie),!$e&&O||this.addCurrentVertex(ae,gt,1,1,Q,Ie,!0)}if(we){const gt=!$e&&ge?ge:ee;!$e&&D||this.addCurrentVertex(ae,gt,-1,-1,Q,Ie,!0),this.addCurrentVertex(ae,gt,0,0,Q,Ie)}}}}addVerticesTo(t,s,u,h,m,_,S,E,A,D){const O=(s.w-t.w)/this.tessellationStep|0;let F=0;const G=this.scaledDistance;if(O>1){this.lineSoFar=t.w;const Q=(s.x-t.x)/O,ae=(s.y-t.y)/O,ce=(s.z-t.z)/O,we=(s.w-t.w)/O;for(let ve=1;ve<O;++ve){t.x+=Q,t.y+=ae,t.z+=ce,this.lineSoFar+=we,F+=we;const ee=this.evaluateLineProgressFeatures(this.prevDistance+F);this.scaledDistance=(this.prevDistance+F)/this.totalDistance,this.addHalfVertex(t,u,h,D,!1,S,A,ee),this.addHalfVertex(t,m,_,D,!0,-E,A,ee)}}this.lineSoFar=s.w,this.scaledDistance=G;const W=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(s,u,h,D,!1,S,A,W),this.addHalfVertex(s,m,_,D,!0,-E,A,W)}evaluateLineProgressFeatures(t){if(!this.variableWidthValue&&this.elevationType!=="offset")return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+t)/this.totalFeatureLength):gr(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let s=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(s=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.elevationType!=="offset"?{zOffset:0,variableWidth:s}:this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:s}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:s}}addCurrentVertex(t,s,u,h,m,_,S=!1){const E=s.x+s.y*u,A=s.y-s.x*u,D=s.y*h-s.x,O=-s.y-s.x*h;if(_!=null){const F=this.elevationType==="offset",G=-10,W=en+10,Q=_.zOffset,ae=new RE(t.x,t.y,Q,this.lineSoFar),ce=!!F&&Mb(t,G,W),we=this.lineSoFar,ve=this.distance;if(this.currentVertex)if(ce){const ee=this.currentVertexIsOutside,ge=this.currentVertex,be=new RE(t.x,t.y,Q,this.lineSoFar);if(LE(ge,be,G,W),!Mb(be,G,W)){if(ee){this.e1=this.e2=-1,this.distance-=ge.dist(ae),this.lineSoFar=ge.w;const Ie=this.evaluateLineProgressFeatures(ge.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(ge,E,A,S,!1,u,m,Ie),this.addHalfVertex(ge,D,O,S,!0,-h,m,Ie),this.prevDistance=this.distance}this.distance=this.prevDistance+ge.dist(be),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(ge,be,E,A,D,O,u,h,m,S),this.distance=ve,this.scaledDistance=this.distance/this.totalDistance}}else{const ee=this.currentVertex;if(this.currentVertexIsOutside){LE(ee,ae,G,W),this.e1=this.e2=-1,this.distance-=ee.dist(ae),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=ee.w;const ge=this.evaluateLineProgressFeatures(ee.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(ee,E,A,S,!1,u,m,ge),this.addHalfVertex(ee,D,O,S,!0,-h,m,ge),this.prevDistance=this.distance,this.distance=ve,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(ee,ae,E,A,D,O,u,h,m,S)}else ce||(this.addHalfVertex(t,E,A,S,!1,u,m,_),this.addHalfVertex(t,D,O,S,!0,-h,m,_));this.currentVertex=ae,this.currentVertexIsOutside=ce,this.lineSoFar=we}else this.addHalfVertex(t,E,A,S,!1,u,m,_),this.addHalfVertex(t,D,O,S,!0,-h,m,_)}addHalfVertex({x:t,y:s},u,h,m,_,S,E,A){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),_||this.segmentPoints.push(this.lineSoFar-this.segmentStart,S)),this.layoutVertexArray.emplaceBack((t<<1)+(m?1:0),(s<<1)+(_?1:0),Math.round(63*u)+128,Math.round(63*h)+128,1+(S===0?0:S<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const O=kn(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,O)}const D=E.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,D),E.primitiveLength++),_?this.e2=D:this.e1=D,A!=null&&this.zOffsetVertexArray.emplaceBack(A.zOffset,A.variableWidth,A.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(t,s){this.prevDistance=this.distance,this.distance+=t.dist(s),this.updateScaledDistance()}}function Mb(a,t,s){return a.x<t||a.x>s||a.y<t||a.y>s}let FE,NE;function jE(a,t,s){return t*(en/(a.tileSize*Math.pow(2,s-a.tileID.overscaledZ)))}un(Rb,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const BE=(a,t,s)=>(1-s)*a+s*t;function VE(a,t){return 1/jE(a,1,t.tileZoom)}function UE(a,t,s,u){return a.translatePosMatrix(u||t.tileID.projMatrix,t,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}const $E=a=>{const t=[];HE(a)&&t.push("RENDER_LINE_DASH"),a.paint.get("line-gradient")&&t.push("RENDER_LINE_GRADIENT");const s=a.paint.get("line-trim-offset");s[0]===0&&s[1]===0||t.push("RENDER_LINE_TRIM_OFFSET"),a.paint.get("line-border-width").constantOr(1)!==0&&t.push("RENDER_LINE_BORDER");const u=a.layout.get("line-join").constantOr("miter")==="none",h=!!a.paint.get("line-pattern").constantOr(1);return u&&h&&t.push("LINE_JOIN_NONE"),t};function HE(a){const t=a.paint.get("line-dasharray").value;return t.value||t.kind!=="constant"}let Lb;const GE=()=>Lb||(Lb={layout:FE||(FE=new $i({"line-cap":new fn(ut.layout_line["line-cap"]),"line-join":new fn(ut.layout_line["line-join"]),"line-miter-limit":new Xt(ut.layout_line["line-miter-limit"]),"line-round-limit":new Xt(ut.layout_line["line-round-limit"]),"line-sort-key":new fn(ut.layout_line["line-sort-key"]),"line-z-offset":new fn(ut.layout_line["line-z-offset"]),"line-elevation-reference":new Xt(ut.layout_line["line-elevation-reference"]),"line-cross-slope":new Xt(ut.layout_line["line-cross-slope"]),visibility:new Xt(ut.layout_line.visibility),"line-width-unit":new Xt(ut.layout_line["line-width-unit"])})),paint:NE||(NE=new $i({"line-opacity":new fn(ut.paint_line["line-opacity"]),"line-color":new fn(ut.paint_line["line-color"]),"line-translate":new Xt(ut.paint_line["line-translate"]),"line-translate-anchor":new Xt(ut.paint_line["line-translate-anchor"]),"line-width":new fn(ut.paint_line["line-width"]),"line-gap-width":new fn(ut.paint_line["line-gap-width"]),"line-offset":new fn(ut.paint_line["line-offset"]),"line-blur":new fn(ut.paint_line["line-blur"]),"line-dasharray":new fn(ut.paint_line["line-dasharray"]),"line-pattern":new fn(ut.paint_line["line-pattern"]),"line-pattern-cross-fade":new Xt(ut.paint_line["line-pattern-cross-fade"]),"line-gradient":new zs(ut.paint_line["line-gradient"]),"line-trim-offset":new Xt(ut.paint_line["line-trim-offset"]),"line-trim-fade-range":new Xt(ut.paint_line["line-trim-fade-range"]),"line-trim-color":new Xt(ut.paint_line["line-trim-color"]),"line-emissive-strength":new Xt(ut.paint_line["line-emissive-strength"]),"line-border-width":new fn(ut.paint_line["line-border-width"]),"line-border-color":new fn(ut.paint_line["line-border-color"]),"line-occlusion-opacity":new Xt(ut.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"})}))},Lb);class AN extends fn{possiblyEvaluate(t,s){return s=new ni(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,transition:s.transition}),super.possiblyEvaluate(t,s)}evaluate(t,s,u,h){return s=ft({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(t,s,u,h)}}let _y;function WE(a,t){return t>0?t+2*a:a}const RN=Vr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),MN=Vr([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),LN=Vr([{name:"a_projected_pos",components:4,type:"Float32"}],4);Vr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const DN=Vr([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),kN=Vr([{name:"a_texb",components:2,type:"Uint16"}]),ON=Vr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),zN=Vr([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);Vr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const qE=Vr([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),FN=Vr([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Vr([{name:"triangle",components:3,type:"Uint16"}]),Vr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Vr([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"},{type:"Uint16",name:"elevationFeatureIndex"}]),Vr([{type:"Float32",name:"offsetX"}]),Vr([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var mo=24;function NN(a,t,s){return a.sections.forEach(u=>{u.text=function(h,m,_){const S=m.layout.get("text-transform").evaluate(_,{});return S==="uppercase"?h=h.toLocaleUpperCase():S==="lowercase"&&(h=h.toLocaleLowerCase()),ea.applyArabicShaping&&(h=ea.applyArabicShaping(h)),h}(u.text,t,s)}),a}const yy={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function jN(a){return a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""}function BN(a){return a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""}var ZE,Db,XE,kb={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function VN(){return ZE||(ZE=1,kb.read=function(a,t,s,u,h){var m,_,S=8*h-u-1,E=(1<<S)-1,A=E>>1,D=-7,O=s?h-1:0,F=s?-1:1,G=a[t+O];for(O+=F,m=G&(1<<-D)-1,G>>=-D,D+=S;D>0;m=256*m+a[t+O],O+=F,D-=8);for(_=m&(1<<-D)-1,m>>=-D,D+=u;D>0;_=256*_+a[t+O],O+=F,D-=8);if(m===0)m=1-A;else{if(m===E)return _?NaN:1/0*(G?-1:1);_+=Math.pow(2,u),m-=A}return(G?-1:1)*_*Math.pow(2,m-u)},kb.write=function(a,t,s,u,h,m){var _,S,E,A=8*m-h-1,D=(1<<A)-1,O=D>>1,F=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,G=u?0:m-1,W=u?1:-1,Q=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(S=isNaN(t)?1:0,_=D):(_=Math.floor(Math.log(t)/Math.LN2),t*(E=Math.pow(2,-_))<1&&(_--,E*=2),(t+=_+O>=1?F/E:F*Math.pow(2,1-O))*E>=2&&(_++,E/=2),_+O>=D?(S=0,_=D):_+O>=1?(S=(t*E-1)*Math.pow(2,h),_+=O):(S=t*Math.pow(2,O-1)*Math.pow(2,h),_=0));h>=8;a[s+G]=255&S,G+=W,S/=256,h-=8);for(_=_<<h|S,A+=h;A>0;a[s+G]=255&_,G+=W,_/=256,A-=8);a[s+G-W]|=128*Q}),kb}function KE(){if(XE)return Db;XE=1,Db=t;var a=VN();function t(ee){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(ee)?ee:new Uint8Array(ee||0),this.pos=0,this.type=0,this.length=this.buf.length}t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;var s=4294967296,u=1/s,h=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function m(ee){return ee.type===t.Bytes?ee.readVarint()+ee.pos:ee.pos+1}function _(ee,ge,be){return be?4294967296*ge+(ee>>>0):4294967296*(ge>>>0)+(ee>>>0)}function S(ee,ge,be){var Ie=ge<=16383?1:ge<=2097151?2:ge<=268435455?3:Math.floor(Math.log(ge)/(7*Math.LN2));be.realloc(Ie);for(var Fe=be.pos-1;Fe>=ee;Fe--)be.buf[Fe+Ie]=be.buf[Fe]}function E(ee,ge){for(var be=0;be<ee.length;be++)ge.writeVarint(ee[be])}function A(ee,ge){for(var be=0;be<ee.length;be++)ge.writeSVarint(ee[be])}function D(ee,ge){for(var be=0;be<ee.length;be++)ge.writeFloat(ee[be])}function O(ee,ge){for(var be=0;be<ee.length;be++)ge.writeDouble(ee[be])}function F(ee,ge){for(var be=0;be<ee.length;be++)ge.writeBoolean(ee[be])}function G(ee,ge){for(var be=0;be<ee.length;be++)ge.writeFixed32(ee[be])}function W(ee,ge){for(var be=0;be<ee.length;be++)ge.writeSFixed32(ee[be])}function Q(ee,ge){for(var be=0;be<ee.length;be++)ge.writeFixed64(ee[be])}function ae(ee,ge){for(var be=0;be<ee.length;be++)ge.writeSFixed64(ee[be])}function ce(ee,ge){return(ee[ge]|ee[ge+1]<<8|ee[ge+2]<<16)+16777216*ee[ge+3]}function we(ee,ge,be){ee[be]=ge,ee[be+1]=ge>>>8,ee[be+2]=ge>>>16,ee[be+3]=ge>>>24}function ve(ee,ge){return(ee[ge]|ee[ge+1]<<8|ee[ge+2]<<16)+(ee[ge+3]<<24)}return t.prototype={destroy:function(){this.buf=null},readFields:function(ee,ge,be){for(be=be||this.length;this.pos<be;){var Ie=this.readVarint(),Fe=Ie>>3,$e=this.pos;this.type=7&Ie,ee(Fe,ge,this),this.pos===$e&&this.skip(Ie)}return ge},readMessage:function(ee,ge){return this.readFields(ee,ge,this.readVarint()+this.pos)},readFixed32:function(){var ee=ce(this.buf,this.pos);return this.pos+=4,ee},readSFixed32:function(){var ee=ve(this.buf,this.pos);return this.pos+=4,ee},readFixed64:function(){var ee=ce(this.buf,this.pos)+ce(this.buf,this.pos+4)*s;return this.pos+=8,ee},readSFixed64:function(){var ee=ce(this.buf,this.pos)+ve(this.buf,this.pos+4)*s;return this.pos+=8,ee},readFloat:function(){var ee=a.read(this.buf,this.pos,!0,23,4);return this.pos+=4,ee},readDouble:function(){var ee=a.read(this.buf,this.pos,!0,52,8);return this.pos+=8,ee},readVarint:function(ee){var ge,be,Ie=this.buf;return ge=127&(be=Ie[this.pos++]),be<128?ge:(ge|=(127&(be=Ie[this.pos++]))<<7,be<128?ge:(ge|=(127&(be=Ie[this.pos++]))<<14,be<128?ge:(ge|=(127&(be=Ie[this.pos++]))<<21,be<128?ge:function(Fe,$e,Ze){var et,St,jt=Ze.buf;if(et=(112&(St=jt[Ze.pos++]))>>4,St<128||(et|=(127&(St=jt[Ze.pos++]))<<3,St<128)||(et|=(127&(St=jt[Ze.pos++]))<<10,St<128)||(et|=(127&(St=jt[Ze.pos++]))<<17,St<128)||(et|=(127&(St=jt[Ze.pos++]))<<24,St<128)||(et|=(1&(St=jt[Ze.pos++]))<<31,St<128))return _(Fe,et,$e);throw new Error("Expected varint not more than 10 bytes")}(ge|=(15&(be=Ie[this.pos]))<<28,ee,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var ee=this.readVarint();return ee%2==1?(ee+1)/-2:ee/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var ee=this.readVarint()+this.pos,ge=this.pos;return this.pos=ee,ee-ge>=12&&h?function(be,Ie,Fe){return h.decode(be.subarray(Ie,Fe))}(this.buf,ge,ee):function(be,Ie,Fe){for(var $e="",Ze=Ie;Ze<Fe;){var et,St,jt,kt=be[Ze],Ft=null,Gt=kt>239?4:kt>223?3:kt>191?2:1;if(Ze+Gt>Fe)break;Gt===1?kt<128&&(Ft=kt):Gt===2?(192&(et=be[Ze+1]))==128&&(Ft=(31&kt)<<6|63&et)<=127&&(Ft=null):Gt===3?(St=be[Ze+2],(192&(et=be[Ze+1]))==128&&(192&St)==128&&((Ft=(15&kt)<<12|(63&et)<<6|63&St)<=2047||Ft>=55296&&Ft<=57343)&&(Ft=null)):Gt===4&&(St=be[Ze+2],jt=be[Ze+3],(192&(et=be[Ze+1]))==128&&(192&St)==128&&(192&jt)==128&&((Ft=(15&kt)<<18|(63&et)<<12|(63&St)<<6|63&jt)<=65535||Ft>=1114112)&&(Ft=null)),Ft===null?(Ft=65533,Gt=1):Ft>65535&&(Ft-=65536,$e+=String.fromCharCode(Ft>>>10&1023|55296),Ft=56320|1023&Ft),$e+=String.fromCharCode(Ft),Ze+=Gt}return $e}(this.buf,ge,ee)},readBytes:function(){var ee=this.readVarint()+this.pos,ge=this.buf.subarray(this.pos,ee);return this.pos=ee,ge},readPackedVarint:function(ee,ge){if(this.type!==t.Bytes)return ee.push(this.readVarint(ge));var be=m(this);for(ee=ee||[];this.pos<be;)ee.push(this.readVarint(ge));return ee},readPackedSVarint:function(ee){if(this.type!==t.Bytes)return ee.push(this.readSVarint());var ge=m(this);for(ee=ee||[];this.pos<ge;)ee.push(this.readSVarint());return ee},readPackedBoolean:function(ee){if(this.type!==t.Bytes)return ee.push(this.readBoolean());var ge=m(this);for(ee=ee||[];this.pos<ge;)ee.push(this.readBoolean());return ee},readPackedFloat:function(ee){if(this.type!==t.Bytes)return ee.push(this.readFloat());var ge=m(this);for(ee=ee||[];this.pos<ge;)ee.push(this.readFloat());return ee},readPackedDouble:function(ee){if(this.type!==t.Bytes)return ee.push(this.readDouble());var ge=m(this);for(ee=ee||[];this.pos<ge;)ee.push(this.readDouble());return ee},readPackedFixed32:function(ee){if(this.type!==t.Bytes)return ee.push(this.readFixed32());var ge=m(this);for(ee=ee||[];this.pos<ge;)ee.push(this.readFixed32());return ee},readPackedSFixed32:function(ee){if(this.type!==t.Bytes)return ee.push(this.readSFixed32());var ge=m(this);for(ee=ee||[];this.pos<ge;)ee.push(this.readSFixed32());return ee},readPackedFixed64:function(ee){if(this.type!==t.Bytes)return ee.push(this.readFixed64());var ge=m(this);for(ee=ee||[];this.pos<ge;)ee.push(this.readFixed64());return ee},readPackedSFixed64:function(ee){if(this.type!==t.Bytes)return ee.push(this.readSFixed64());var ge=m(this);for(ee=ee||[];this.pos<ge;)ee.push(this.readSFixed64());return ee},skip:function(ee){var ge=7&ee;if(ge===t.Varint)for(;this.buf[this.pos++]>127;);else if(ge===t.Bytes)this.pos=this.readVarint()+this.pos;else if(ge===t.Fixed32)this.pos+=4;else{if(ge!==t.Fixed64)throw new Error("Unimplemented type: "+ge);this.pos+=8}},writeTag:function(ee,ge){this.writeVarint(ee<<3|ge)},realloc:function(ee){for(var ge=this.length||16;ge<this.pos+ee;)ge*=2;if(ge!==this.length){var be=new Uint8Array(ge);be.set(this.buf),this.buf=be,this.length=ge}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(ee){this.realloc(4),we(this.buf,ee,this.pos),this.pos+=4},writeSFixed32:function(ee){this.realloc(4),we(this.buf,ee,this.pos),this.pos+=4},writeFixed64:function(ee){this.realloc(8),we(this.buf,-1&ee,this.pos),we(this.buf,Math.floor(ee*u),this.pos+4),this.pos+=8},writeSFixed64:function(ee){this.realloc(8),we(this.buf,-1&ee,this.pos),we(this.buf,Math.floor(ee*u),this.pos+4),this.pos+=8},writeVarint:function(ee){(ee=+ee||0)>268435455||ee<0?function(ge,be){var Ie,Fe;if(ge>=0?(Ie=ge%4294967296|0,Fe=ge/4294967296|0):(Fe=~(-ge/4294967296),4294967295^(Ie=~(-ge%4294967296))?Ie=Ie+1|0:(Ie=0,Fe=Fe+1|0)),ge>=18446744073709552e3||ge<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");be.realloc(10),function($e,Ze,et){et.buf[et.pos++]=127&$e|128,$e>>>=7,et.buf[et.pos++]=127&$e|128,$e>>>=7,et.buf[et.pos++]=127&$e|128,$e>>>=7,et.buf[et.pos++]=127&$e|128,et.buf[et.pos]=127&($e>>>=7)}(Ie,0,be),function($e,Ze){var et=(7&$e)<<4;Ze.buf[Ze.pos++]|=et|(($e>>>=3)?128:0),$e&&(Ze.buf[Ze.pos++]=127&$e|(($e>>>=7)?128:0),$e&&(Ze.buf[Ze.pos++]=127&$e|(($e>>>=7)?128:0),$e&&(Ze.buf[Ze.pos++]=127&$e|(($e>>>=7)?128:0),$e&&(Ze.buf[Ze.pos++]=127&$e|(($e>>>=7)?128:0),$e&&(Ze.buf[Ze.pos++]=127&$e)))))}(Fe,be)}(ee,this):(this.realloc(4),this.buf[this.pos++]=127&ee|(ee>127?128:0),ee<=127||(this.buf[this.pos++]=127&(ee>>>=7)|(ee>127?128:0),ee<=127||(this.buf[this.pos++]=127&(ee>>>=7)|(ee>127?128:0),ee<=127||(this.buf[this.pos++]=ee>>>7&127))))},writeSVarint:function(ee){this.writeVarint(ee<0?2*-ee-1:2*ee)},writeBoolean:function(ee){this.writeVarint(!!ee)},writeString:function(ee){ee=String(ee),this.realloc(4*ee.length),this.pos++;var ge=this.pos;this.pos=function(Ie,Fe,$e){for(var Ze,et,St=0;St<Fe.length;St++){if((Ze=Fe.charCodeAt(St))>55295&&Ze<57344){if(!et){Ze>56319||St+1===Fe.length?(Ie[$e++]=239,Ie[$e++]=191,Ie[$e++]=189):et=Ze;continue}if(Ze<56320){Ie[$e++]=239,Ie[$e++]=191,Ie[$e++]=189,et=Ze;continue}Ze=et-55296<<10|Ze-56320|65536,et=null}else et&&(Ie[$e++]=239,Ie[$e++]=191,Ie[$e++]=189,et=null);Ze<128?Ie[$e++]=Ze:(Ze<2048?Ie[$e++]=Ze>>6|192:(Ze<65536?Ie[$e++]=Ze>>12|224:(Ie[$e++]=Ze>>18|240,Ie[$e++]=Ze>>12&63|128),Ie[$e++]=Ze>>6&63|128),Ie[$e++]=63&Ze|128)}return $e}(this.buf,ee,this.pos);var be=this.pos-ge;be>=128&&S(ge,be,this),this.pos=ge-1,this.writeVarint(be),this.pos+=be},writeFloat:function(ee){this.realloc(4),a.write(this.buf,ee,this.pos,!0,23,4),this.pos+=4},writeDouble:function(ee){this.realloc(8),a.write(this.buf,ee,this.pos,!0,52,8),this.pos+=8},writeBytes:function(ee){var ge=ee.length;this.writeVarint(ge),this.realloc(ge);for(var be=0;be<ge;be++)this.buf[this.pos++]=ee[be]},writeRawMessage:function(ee,ge){this.pos++;var be=this.pos;ee(ge,this);var Ie=this.pos-be;Ie>=128&&S(be,Ie,this),this.pos=be-1,this.writeVarint(Ie),this.pos+=Ie},writeMessage:function(ee,ge,be){this.writeTag(ee,t.Bytes),this.writeRawMessage(ge,be)},writePackedVarint:function(ee,ge){ge.length&&this.writeMessage(ee,E,ge)},writePackedSVarint:function(ee,ge){ge.length&&this.writeMessage(ee,A,ge)},writePackedBoolean:function(ee,ge){ge.length&&this.writeMessage(ee,F,ge)},writePackedFloat:function(ee,ge){ge.length&&this.writeMessage(ee,D,ge)},writePackedDouble:function(ee,ge){ge.length&&this.writeMessage(ee,O,ge)},writePackedFixed32:function(ee,ge){ge.length&&this.writeMessage(ee,G,ge)},writePackedSFixed32:function(ee,ge){ge.length&&this.writeMessage(ee,W,ge)},writePackedFixed64:function(ee,ge){ge.length&&this.writeMessage(ee,Q,ge)},writePackedSFixed64:function(ee,ge){ge.length&&this.writeMessage(ee,ae,ge)},writeBytesField:function(ee,ge){this.writeTag(ee,t.Bytes),this.writeBytes(ge)},writeFixed32Field:function(ee,ge){this.writeTag(ee,t.Fixed32),this.writeFixed32(ge)},writeSFixed32Field:function(ee,ge){this.writeTag(ee,t.Fixed32),this.writeSFixed32(ge)},writeFixed64Field:function(ee,ge){this.writeTag(ee,t.Fixed64),this.writeFixed64(ge)},writeSFixed64Field:function(ee,ge){this.writeTag(ee,t.Fixed64),this.writeSFixed64(ge)},writeVarintField:function(ee,ge){this.writeTag(ee,t.Varint),this.writeVarint(ge)},writeSVarintField:function(ee,ge){this.writeTag(ee,t.Varint),this.writeSVarint(ge)},writeStringField:function(ee,ge){this.writeTag(ee,t.Bytes),this.writeString(ge)},writeFloatField:function(ee,ge){this.writeTag(ee,t.Fixed32),this.writeFloat(ge)},writeDoubleField:function(ee,ge){this.writeTag(ee,t.Fixed64),this.writeDouble(ge)},writeBooleanField:function(ee,ge){this.writeVarintField(ee,!!ge)}},Db}var yx=Sa(KE());const Ob=3;function UN(a,t,s){t.glyphs=[],a===1&&s.readMessage($N,t)}function $N(a,t,s){if(a===3){const{id:u,bitmap:h,width:m,height:_,left:S,top:E,advance:A}=s.readMessage(HN,{});t.glyphs.push({id:u,bitmap:new $t({width:m+2*Ob,height:_+2*Ob},h),metrics:{width:m,height:_,left:S,top:E,advance:A}})}else a===4?t.ascender=s.readSVarint():a===5&&(t.descender=s.readSVarint())}function HN(a,t,s){a===1?t.id=s.readVarint():a===2?t.bitmap=s.readBytes():a===3?t.width=s.readVarint():a===4?t.height=s.readVarint():a===5?t.left=s.readSVarint():a===6?t.top=s.readSVarint():a===7&&(t.advance=s.readVarint())}const GN=Ob,dl={horizontal:1,vertical:2,horizontalOnly:3};class vy{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(t,s){const u=new vy;return u.scale=t||1,u.fontStack=s,u}static forImage(t){const s=new vy;return s.image=t,s}}class Og{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,s,u){const h=new Og;for(let m=0;m<t.sections.length;m++){const _=t.sections[m];_.image?h.addImageSection(_,u):h.addTextSection(_,s)}return h}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCodePoint(t){return this.text.codePointAt(t)}verticalizePunctuation(t){this.text=function(s,u){let h="";for(let m=0;m<s.length;m++){const _=s.charCodeAt(m+1)||null,S=s.charCodeAt(m-1)||null;h+=!u&&(_&&wc(_)&&!yy[s[m+1]]||S&&wc(S)&&!yy[s[m-1]])||!yy[s[m]]?s[m]:yy[s[m]]}return h}(this.text,t)}trim(){let t=0;for(let u=0;u<this.text.length&&vx[this.text.charCodeAt(u)];u++)t++;let s=this.text.length;for(let u=this.text.length-1;u>=0&&u>=t&&vx[this.text.charCodeAt(u)];u--)s--;this.text=this.text.substring(t,s),this.sectionIndex=this.sectionIndex.slice(t,s)}substring(t,s){const u=new Og;return u.text=this.text.substring(t,s),u.sectionIndex=this.sectionIndex.slice(t,s),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,s)=>Math.max(t,this.sections[s].scale),0)}addTextSection(t,s){this.text+=t.text,this.sections.push(vy.forText(t.scale,t.fontStack||s));const u=this.sections.length-1;for(let h=0;h<t.text.length;++h)this.sectionIndex.push(u)}addImageSection(t,s){const u=t.image?t.image.getPrimary():null;if(!u)return void gr("Can't add FormattedSection with an empty image.");u.scaleSelf(s);const h=this.getNextImageSectionCharCode();h?(this.text+=String.fromCodePoint(h),this.sections.push(vy.forImage(u)),this.sectionIndex.push(this.sections.length-1)):gr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function zb(a,t,s,u,h,m,_,S,E,A,D,O,F,G,W,Q=1){const ae=Og.fromFeature(a,h,Q);O===dl.vertical&&ae.verticalizePunctuation(F);let ce=[];const we=function(Ie,Fe,$e,Ze,et,St){if(!Ie)return[];const jt=[],kt=function(zt,gt,bt,qt,Kt,En){let _n=0;for(let sn=0;sn<zt.length();sn++){const Wt=zt.getSection(sn);_n+=YE(zt.getCodePoint(sn),Wt,qt,Kt,gt,En)}return _n/Math.max(1,Math.ceil(_n/bt))}(Ie,Fe,$e,Ze,et,St),Ft=Ie.text.indexOf("")>=0;let Gt=0;for(let zt=0;zt<Ie.length();zt++){const gt=Ie.getSection(zt),bt=Ie.getCodePoint(zt);if(vx[bt]||(Gt+=YE(bt,gt,Ze,et,Fe,St)),zt<Ie.length()-1){const qt=!((vt=bt)<11904||!(Ln["Bopomofo Extended"](vt)||Ln.Bopomofo(vt)||Ln["CJK Compatibility Forms"](vt)||Ln["CJK Compatibility Ideographs"](vt)||Ln["CJK Compatibility"](vt)||Ln["CJK Radicals Supplement"](vt)||Ln["CJK Strokes"](vt)||Ln["CJK Symbols and Punctuation"](vt)||Ln["CJK Unified Ideographs Extension A"](vt)||Ln["CJK Unified Ideographs"](vt)||Ln["Enclosed CJK Letters and Months"](vt)||Ln["Halfwidth and Fullwidth Forms"](vt)||Ln.Hiragana(vt)||Ln["Ideographic Description Characters"](vt)||Ln["Kangxi Radicals"](vt)||Ln["Katakana Phonetic Extensions"](vt)||Ln.Katakana(vt)||Ln["Vertical Forms"](vt)||Ln["Yi Radicals"](vt)||Ln["Yi Syllables"](vt)));(WN[bt]||qt||gt.image)&&jt.push(QE(zt+1,Gt,kt,jt,qN(bt,Ie.getCodePoint(zt+1),qt&&Ft),!1))}}var vt;return eI(QE(Ie.length(),Gt,kt,jt,0,!0))}(ae,A,m,t,u,G),{processBidirectionalText:ve,processStyledBidirectionalText:ee}=ea;if(ve&&ae.sections.length===1){const Ie=ve(ae.toString(),we);for(const Fe of Ie){const $e=new Og;$e.text=Fe,$e.sections=ae.sections;for(let Ze=0;Ze<Fe.length;Ze++)$e.sectionIndex.push(0);ce.push($e)}}else if(ee){const Ie=ee(ae.text,ae.sectionIndex,we);for(const Fe of Ie){const $e=new Og;$e.text=Fe[0],$e.sectionIndex=Fe[1],$e.sections=ae.sections,ce.push($e)}}else ce=function(Ie,Fe){const $e=[],Ze=Ie.text;let et=0;for(const St of Fe)$e.push(Ie.substring(et,St)),et=St;return et<Ze.length&&$e.push(Ie.substring(et,Ze.length)),$e}(ae,we);const ge=[],be={positionedLines:ge,text:ae.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:O,iconsInText:!1,verticalizable:!1,hasBaseline:!1};if(function(Ie,Fe,$e,Ze,et,St,jt,kt,Ft,Gt,vt,zt){let gt=0,bt=0,qt=0;const Kt=kt==="right"?1:kt==="left"?0:.5;let En=!1;for(const Sn of et){const $n=Sn.getSections();for(const Jn of $n){if(Jn.image)continue;const ir=Fe[Jn.fontStack];if(ir&&(En=ir.ascender!==void 0&&ir.descender!==void 0,!En))break}if(!En)break}let _n=0;for(const Sn of et){Sn.trim();const $n=Sn.getMaxScale(),Jn=($n-1)*mo,ir={positionedGlyphs:[],lineOffset:0};Ie.positionedLines[_n]=ir;const yr=ir.positionedGlyphs;let fr=0;if(!Sn.length()){bt+=St,++_n;continue}let ar=0,_i=0;for(let Ee=0;Ee<Sn.length();Ee++){const Ae=Sn.getSection(Ee),Et=Sn.getSectionIndex(Ee),Jt=Sn.getCodePoint(Ee);let an=Ae.scale,on=null,Cn=null,jn=null,Er=mo,Ir=0;Ft===dl.vertical&&((sn=Jt)===12312||sn===12313||sn===12316||sn===12540||sn===12448)&&(Ft=dl.horizontal);const lr=!(Ft===dl.horizontal||!vt&&!ga(Jt)||vt&&(vx[Jt]||Yf(Jt)));if(Ae.image){const li=Ze.get(Ae.image.toString());if(!li)continue;jn=Ae.image,Ie.iconsInText=Ie.iconsInText||!0,Cn=li.paddedRect;const Ci=li.displaySize;an=an*mo/zt,on={width:Ci[0],height:Ci[1],left:0,top:-3,advance:lr?Ci[1]:Ci[0],localGlyph:!1},Ir=En?-on.height*an:$n*mo-17-Ci[1]*an,Er=on.advance;const Pr=(lr?Ci[0]:Ci[1])*an-mo*$n;Pr>0&&Pr>fr&&(fr=Pr)}else{const li=$e[Ae.fontStack];if(!li)continue;li[Jt]&&(Cn=li[Jt]);const Ci=Fe[Ae.fontStack];if(!Ci)continue;const Pr=Ci.glyphs[Jt];if(!Pr)continue;if(on=Pr.metrics,Er=Jt!==8203?mo:0,En){const Yi=Ci.ascender!==void 0?Math.abs(Ci.ascender):0,Mi=Ci.descender!==void 0?Math.abs(Ci.descender):0,oi=(Yi+Mi)*an;ar<oi&&(ar=oi,_i=(Yi-Mi)/2*an),Ir=-Yi*an}else Ir=($n-an)*mo-17}lr?(Ie.verticalizable=!0,yr.push({glyph:Jt,image:jn,x:gt,y:bt+Ir,vertical:lr,scale:an,localGlyph:on.localGlyph,fontStack:Ae.fontStack,sectionIndex:Et,metrics:on,rect:Cn}),gt+=Er*an+Gt):(yr.push({glyph:Jt,image:jn,x:gt,y:bt+Ir,vertical:lr,scale:an,localGlyph:on.localGlyph,fontStack:Ae.fontStack,sectionIndex:Et,metrics:on,rect:Cn}),gt+=on.advance*an+Gt)}yr.length!==0&&(qt=Math.max(gt-Gt,qt),En?tI(yr,Kt,fr,_i,St*$n/2):tI(yr,Kt,fr,0,St/2)),gt=0;const Ri=St*$n+fr;ir.lineOffset=Math.max(fr,Jn),bt+=Ri,++_n}var sn;const Wt=bt,{horizontalAlign:Wn,verticalAlign:wn}=Fb(jt);(function(Sn,$n,Jn,ir,yr,fr){const ar=($n-Jn)*yr,_i=-fr*ir;for(const Ri of Sn)for(const Ee of Ri.positionedGlyphs)Ee.x+=ar,Ee.y+=_i})(Ie.positionedLines,Kt,Wn,wn,qt,Wt),Ie.top+=-wn*Wt,Ie.bottom=Ie.top+Wt,Ie.left+=-Wn*qt,Ie.right=Ie.left+qt,Ie.hasBaseline=En}(be,t,s,u,ce,_,S,E,O,A,F,W),!function(Ie){for(const Fe of Ie)if(Fe.positionedGlyphs.length!==0)return!1;return!0}(ge))return be}const vx={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},WN={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function YE(a,t,s,u,h,m){if(t.image){const _=u.get(t.image.toString());return _?_.displaySize[0]*t.scale*mo/m+h:0}{const _=s[t.fontStack],S=_&&_.glyphs[a];return S?S.metrics.advance*t.scale+h:0}}function JE(a,t,s,u){const h=Math.pow(a-t,2);return u?a<t?h/2:2*h:h+Math.abs(s)*s}function qN(a,t,s){let u=0;return a===10&&(u-=1e4),s&&(u+=150),a!==40&&a!==65288||(u+=50),t!==41&&t!==65289||(u+=50),u}function QE(a,t,s,u,h,m){let _=null,S=JE(t,s,h,m);for(const E of u){const A=JE(t-E.x,s,h,m)+E.badness;A<=S&&(_=E,S=A)}return{index:a,x:t,priorBreak:_,badness:S}}function eI(a){return a?eI(a.priorBreak).concat(a.index):[]}function Fb(a){let t=.5,s=.5;switch(a){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:t,verticalAlign:s}}function tI(a,t,s,u,h){if(!(t||s||u||h))return;const m=a.length-1,_=a[m],S=(_.x+_.metrics.advance*_.scale)*t;for(let E=0;E<=m;E++)a[E].x-=S,a[E].y+=s+u+h}function nI(a){return a.imagePrimary!==void 0&&a.top!==void 0&&a.bottom!==void 0&&a.left!==void 0&&a.right!==void 0}function ZN(a,t,s,u){const{horizontalAlign:h,verticalAlign:m}=Fb(u),_=s[0]-a.displaySize[0]*h,S=s[1]-a.displaySize[1]*m;return{imagePrimary:a,imageSecondary:t,top:S,bottom:S+a.displaySize[1],left:_,right:_+a.displaySize[0]}}function rI(a,t,s,u,h,m){const _=a.imagePrimary;let S;if(_.content){const ae=_.content,ce=_.pixelRatio||1;S=[ae[0]/ce,ae[1]/ce,_.displaySize[0]-ae[2]/ce,_.displaySize[1]-ae[3]/ce]}const E=t.left*m,A=t.right*m;let D,O,F,G;s==="width"||s==="both"?(G=h[0]+E-u[3],O=h[0]+A+u[1]):(G=h[0]+(E+A-_.displaySize[0])/2,O=G+_.displaySize[0]);const W=t.top*m,Q=t.bottom*m;return s==="height"||s==="both"?(D=h[1]+W-u[0],F=h[1]+Q+u[2]):(D=h[1]+(W+Q-_.displaySize[1])/2,F=D+_.displaySize[1]),{imagePrimary:_,imageSecondary:void 0,top:D,right:O,bottom:F,left:G,collisionPadding:S}}function iI(a){return!a.imagePrimary.stretchX}function sI(a){return!a.imagePrimary.stretchY}function oI(a){return{width:a.right-a.left,height:a.bottom-a.top}}const dh=128;function aI(a,t){const{expression:s}=t;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new ni(a+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:h}=s;let m=0;for(;m<u.length&&u[m]<=a;)m++;m=Math.max(0,m-1);let _=m;for(;_<u.length&&u[_]<a+1;)_++;_=Math.min(u.length-1,_);const S=u[m],E=u[_];return s.kind==="composite"?{kind:"composite",minZoom:S,maxZoom:E,interpolationType:h}:{kind:"camera",minZoom:S,maxZoom:E,minSize:s.evaluate(new ni(S)),maxSize:s.evaluate(new ni(E)),interpolationType:h}}}function Nb(a,{uSize:t,uSizeT:s},{lowerSize:u,upperSize:h}){return a.kind==="source"?u/dh:a.kind==="composite"?kn(u/dh,h/dh,s):t}function xy(a,t,s=1){let u=0,h=0;if(a.kind==="constant")h=a.layoutSize*s;else if(a.kind!=="source"){const{interpolationType:m,minZoom:_,maxZoom:S}=a,E=m?Xe(Os.interpolationFactor(m,t,_,S),0,1):0;a.kind==="camera"?h=kn(a.minSize,a.maxSize,E)*s:u=E*s}return{uSizeT:u,uSize:h}}class vf extends Qt{constructor(t,s,u,h,m){super(t,s),this.angle=h,this.z=u,m!==void 0&&(this.segment=m)}clone(){return new vf(this.x,this.y,this.z,this.angle,this.segment)}}function lI(a,t,s,u,h){if(t.segment===void 0)return!0;let m=t,_=t.segment+1,S=0;for(;S>-s/2;){if(_--,_<0)return!1;S-=a[_].dist(m),m=a[_]}S+=a[_].dist(a[_+1]),_++;const E=[];let A=0;for(;S<s/2;){const D=a[_],O=a[_+1];if(!O)return!1;let F=a[_-1].angleTo(D)-D.angleTo(O);for(F=Math.abs((F+3*Math.PI)%(2*Math.PI)-Math.PI),E.push({distance:S,angleDelta:F}),A+=F;S-E[0].distance>u;)A-=E.shift().angleDelta;if(A>h)return!1;_++,S+=D.dist(O)}return!0}function cI(a){let t=0;for(let s=0;s<a.length-1;s++)t+=a[s].dist(a[s+1]);return t}function uI(a,t,s){return a?.6*t*s:0}function dI(a,t){return Math.max(a?a.right-a.left:0,t?t.right-t.left:0)}function XN(a,t,s,u,h,m){const _=uI(s,h,m),S=dI(s,u)*m;let E=0;const A=cI(a)/2;for(let D=0;D<a.length-1;D++){const O=a[D],F=a[D+1],G=O.dist(F);if(E+G>A){const W=(A-E)/G,Q=kn(O.x,F.x,W),ae=kn(O.y,F.y,W),ce=new vf(Q,ae,0,F.angleTo(O),D);return!_||lI(a,ce,S,_,t)?ce:void 0}E+=G}}function KN(a,t,s,u,h,m,_,S,E){const A=uI(u,m,_),D=dI(u,h),O=D*_,F=a[0].x===0||a[0].x===E||a[0].y===0||a[0].y===E;return t-O<t/4&&(t=O+t/4),hI(a,F?t/2*S%t:(D/2+2*m)*_*S%t,t,A,s,O,F,!1,E)}function hI(a,t,s,u,h,m,_,S,E){const A=m/2,D=cI(a);let O=0,F=t-s,G=[];for(let W=0;W<a.length-1;W++){const Q=a[W],ae=a[W+1],ce=Q.dist(ae),we=ae.angleTo(Q);for(;F+s<O+ce;){F+=s;const ve=(F-O)/ce,ee=kn(Q.x,ae.x,ve),ge=kn(Q.y,ae.y,ve);if(ee>=0&&ee<E&&ge>=0&&ge<E&&F-A>=0&&F+A<=D){const be=new vf(ee,ge,0,we,W);u&&!lI(a,be,m,u,h)||G.push(be)}}O+=ce}return S||G.length||_||(G=hI(a,O/2,s,u,h,m,_,!0,E)),G}function fI(a){let t=0,s=0;for(const _ of a)t+=_.w*_.h,s=Math.max(s,_.w);a.sort((_,S)=>S.h-_.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),s),h:1/0}];let h=0,m=0;for(const _ of a)for(let S=u.length-1;S>=0;S--){const E=u[S];if(!(_.w>E.w||_.h>E.h)){if(_.x=E.x,_.y=E.y,m=Math.max(m,_.y+_.h),h=Math.max(h,_.x+_.w),_.w===E.w&&_.h===E.h){const A=u.pop();S<u.length&&(u[S]=A)}else _.h===E.h?(E.x+=_.w,E.w-=_.w):_.w===E.w?(E.y+=_.h,E.h-=_.h):(u.push({x:E.x+_.w,y:E.y,w:E.w-_.w,h:_.h}),E.y+=_.h,E.h-=_.h);break}}return{w:h,h:m,fill:t/(h*m)||0}}un(vf,"Anchor");const Vm=1;class by{static getImagePositionScale(t,s,u){if(s&&t&&t.options&&t.options.transform){const h=t.options.transform;return{x:h.a,y:h.d}}return{x:u,y:u}}constructor(t,s,u,h){this.paddedRect=t;const{pixelRatio:m,version:_,stretchX:S,stretchY:E,content:A,sdf:D,usvg:O}=s;this.pixelRatio=m,this.stretchX=S,this.stretchY=E,this.content=A,this.version=_,this.padding=u,this.sdf=D,this.scale=by.getImagePositionScale(h,O,m)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}function jb(a,t,s){const u=Ta.parse(a),h=function(m,_,S=[1,1]){return{x:0,y:0,w:(m.data?m.data.width:m.width*S[0])+2*_,h:(m.data?m.data.height:m.height*S[1])+2*_}}(t,s,[u.options.transform.a,u.options.transform.d]);return{bin:h,imagePosition:new by(h,t,s,u),imageVariant:u}}class pI{constructor(t,s,u){const h=new Map,m=new Map;this.haveRenderCallbacks=[];const _=[];this.addImages(t,h,Vm,_),this.addImages(s,m,2,_);const{w:S,h:E}=fI(_),A=new Tn({width:S||1,height:E||1});for(const[D,O]of t.entries()){const F=h.get(D).paddedRect;Tn.copy(O.data,A,{x:0,y:0},{x:F.x+Vm,y:F.y+Vm},O.data,u,O.sdf)}for(const[D,O]of s.entries()){const F=m.get(D),G=F.paddedRect;let W=F.padding;const Q=G.x+W,ae=G.y+W,ce=O.data.width,we=O.data.height;W=W>1?W-1:W,Tn.copy(O.data,A,{x:0,y:0},{x:Q,y:ae},O.data,u),Tn.copy(O.data,A,{x:0,y:we-W},{x:Q,y:ae-W},{width:ce,height:W},u),Tn.copy(O.data,A,{x:0,y:0},{x:Q,y:ae+we},{width:ce,height:W},u),Tn.copy(O.data,A,{x:ce-W,y:0},{x:Q-W,y:ae},{width:W,height:we},u),Tn.copy(O.data,A,{x:0,y:0},{x:Q+ce,y:ae},{width:W,height:we},u),Tn.copy(O.data,A,{x:ce-W,y:we-W},{x:Q-W,y:ae-W},{width:W,height:W},u),Tn.copy(O.data,A,{x:0,y:we-W},{x:Q+ce,y:ae-W},{width:W,height:W},u),Tn.copy(O.data,A,{x:0,y:0},{x:Q+ce,y:ae+we},{width:W,height:W},u),Tn.copy(O.data,A,{x:ce-W,y:0},{x:Q-W,y:ae+we},{width:W,height:W},u)}this.lut=u,this.image=A,this.iconPositions=h,this.patternPositions=m}addImages(t,s,u,h){for(const[m,_]of t.entries()){const{bin:S,imagePosition:E,imageVariant:A}=jb(m,_,u);s.set(m,E),h.push(S),_.hasRenderCallback&&this.haveRenderCallbacks.push(A.id)}}patchUpdatedImages(t,s,u){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(h=>t.hasImage(h,u)),t.dispatchRenderCallbacks(this.haveRenderCallbacks,u);for(const h of t.getUpdatedImages(u)){for(const m of this.iconPositions.keys()){const _=Ta.parse(m);if(Go.isEqual(_.id,h)){const S=t.getImage(h,u);this.patchUpdatedImage(this.iconPositions.get(m),S,s)}}for(const m of this.patternPositions.keys()){const _=Ta.parse(m);if(Go.isEqual(_.id,h)){const S=t.getImage(h,u);this.patchUpdatedImage(this.patternPositions.get(m),S,s)}}}}patchUpdatedImage(t,s,u){if(!t||!s||t.version===s.version)return;t.version=s.version;const[h,m]=t.tl,_=t.sdf;if(this.lut||_){const S={width:s.data.width,height:s.data.height},E=new Tn(S);Tn.copy(s.data,E,{x:0,y:0},{x:0,y:0},S,this.lut,_),u.update(E,{position:{x:h,y:m}})}else u.update(s.data,{position:{x:h,y:m}})}}un(by,"ImagePosition"),un(pI,"ImageAtlas");const xx=1e20;function mI(a,t,s,u,h,m,_,S,E){for(let A=t;A<t+u;A++)gI(a,s*m+A,m,h,_,S,E);for(let A=s;A<s+h;A++)gI(a,A*m+t,1,u,_,S,E)}function gI(a,t,s,u,h,m,_){m[0]=0,_[0]=-1e20,_[1]=xx,h[0]=a[t];for(let S=1,E=0,A=0;S<u;S++){h[S]=a[t+S*s];const D=S*S;do{const O=m[E];A=(h[S]-h[O]+D-O*O)/(S-O)/2}while(A<=_[E]&&--E>-1);E++,m[E]=S,_[E]=A,_[E+1]=xx}for(let S=0,E=0;S<u;S++){for(;_[E+1]<S;)E++;const A=m[E],D=S-A;a[t+S*s]=h[A]+D*D}}const ad=2,Bb={none:0,ideographs:1,all:2};class zg{constructor(t,s,u){this.requestManager=t,this.localGlyphMode=s,this.localFontFamily=u,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t,s){this.urls[s]=t}getGlyphs(t,s,u){const h=[],m=this.urls[s]||os.GLYPHS_URL;for(const _ in t)for(const S of t[_])h.push({stack:_,id:S});Lt(h,({stack:_,id:S},E)=>{let A=this.entries[_];A||(A=this.entries[_]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let D=A.glyphs[S];if(D!==void 0)return void E(null,{stack:_,id:S,glyph:D});if(D=this._tinySDF(A,_,S),D)return A.glyphs[S]=D,void E(null,{stack:_,id:S,glyph:D});const O=Math.floor(S/256);if(256*O>65535)return gr("glyphs > 65535 not supported"),void E(null,{stack:_,id:S,glyph:D});if(A.ranges[O])return void E(null,{stack:_,id:S,glyph:D});let F=A.requests[O];F||(F=A.requests[O]=[],zg.loadGlyphRange(_,O,m,this.requestManager,(G,W)=>{if(W){A.ascender=W.ascender,A.descender=W.descender;for(const Q in W.glyphs)this._doesCharSupportLocalGlyph(+Q)||(A.glyphs[+Q]=W.glyphs[+Q]);A.ranges[O]=!0}for(const Q of F)Q(G,W);delete A.requests[O]})),F.push((G,W)=>{G?E(G):W&&E(null,{stack:_,id:S,glyph:W.glyphs[S]||null})})},(_,S)=>{if(_)u(_);else if(S){const E={};for(const{stack:A,id:D,glyph:O}of S)E[A]===void 0&&(E[A]={}),E[A].glyphs===void 0&&(E[A].glyphs={}),E[A].glyphs[D]=O&&{id:O.id,bitmap:O.bitmap.clone(),metrics:O.metrics},E[A].ascender=this.entries[A].ascender,E[A].descender=this.entries[A].descender;u(null,E)}})}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==Bb.none&&(this.localGlyphMode===Bb.all?!!this.localFontFamily:!!this.localFontFamily&&(Ln["CJK Unified Ideographs"](t)||Ln["Hangul Syllables"](t)||Ln.Hiragana(t)||Ln.Katakana(t)||Ln["CJK Symbols and Punctuation"](t)||Ln["CJK Unified Ideographs Extension A"](t)||Ln["CJK Unified Ideographs Extension B"](t)||Ln.Osage(t)))}_tinySDF(t,s,u){const h=this.localFontFamily;if(!h||!this._doesCharSupportLocalGlyph(u))return;let m=t.tinySDF;if(!m){let Q="400";/bold/i.test(s)?Q="900":/medium/i.test(s)?Q="500":/light/i.test(s)&&(Q="200"),m=t.tinySDF=new zg.TinySDF({fontFamily:h,fontWeight:Q,fontSize:24*ad,buffer:3*ad,radius:8*ad}),m.fontWeight=Q}if(this.localGlyphs[m.fontWeight][u])return this.localGlyphs[m.fontWeight][u];const _=String.fromCodePoint(u),{data:S,width:E,height:A,glyphWidth:D,glyphHeight:O,glyphLeft:F,glyphTop:G,glyphAdvance:W}=m.draw(_);return this.localGlyphs[m.fontWeight][u]={id:u,bitmap:new $t({width:E,height:A},S),metrics:{width:D/ad,height:O/ad,left:F/ad,top:G/ad-27,advance:W/ad,localGlyph:!0}}}}zg.loadGlyphRange=function(a,t,s,u,h){const m=256*t,_=m+255,S=u.transformRequest(u.normalizeGlyphsURL(s).replace("{fontstack}",a).replace("{range}",`${m}-${_}`),jc.Glyphs);Sl(S,(E,A)=>{if(E)h(E);else if(A){const D={},O=function(F){return new yx(F).readFields(UN,{})}(A);for(const F of O.glyphs)D[F.id]=F;h(null,{glyphs:D,ascender:O.ascender,descender:O.descender})}})},zg.TinySDF=class{constructor({fontSize:a=24,buffer:t=3,radius:s=8,cutoff:u=.25,fontFamily:h="sans-serif",fontWeight:m="normal",fontStyle:_="normal"}={}){this.buffer=t,this.cutoff=u,this.radius=s;const S=this.size=a+4*t,E=this._createCanvas(S),A=this.ctx=E.getContext("2d",{willReadFrequently:!0});A.font=`${_} ${m} ${a}px ${h}`,A.textBaseline="alphabetic",A.textAlign="left",A.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Uint16Array(S)}_createCanvas(a){const t=document.createElement("canvas");return t.width=t.height=a,t}draw(a){const{width:t,actualBoundingBoxAscent:s,actualBoundingBoxDescent:u,actualBoundingBoxLeft:h,actualBoundingBoxRight:m}=this.ctx.measureText(a),_=Math.ceil(s),S=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-h))),E=Math.min(this.size-this.buffer,_+Math.ceil(u)),A=S+2*this.buffer,D=E+2*this.buffer,O=Math.max(A*D,0),F=new Uint8ClampedArray(O),G={data:F,width:A,height:D,glyphWidth:S,glyphHeight:E,glyphTop:_,glyphLeft:0,glyphAdvance:t};if(S===0||E===0)return G;const{ctx:W,buffer:Q,gridInner:ae,gridOuter:ce}=this;W.clearRect(Q,Q,S,E),W.fillText(a,Q,Q+_);const we=W.getImageData(Q,Q,S,E);ce.fill(xx,0,O),ae.fill(0,0,O);for(let ve=0;ve<E;ve++)for(let ee=0;ee<S;ee++){const ge=we.data[4*(ve*S+ee)+3]/255;if(ge===0)continue;const be=(ve+Q)*A+ee+Q;if(ge===1)ce[be]=0,ae[be]=xx;else{const Ie=.5-ge;ce[be]=Ie>0?Ie*Ie:0,ae[be]=Ie<0?Ie*Ie:0}}mI(ce,0,0,A,D,A,this.f,this.v,this.z),mI(ae,Q,Q,S,E,A,this.f,this.v,this.z);for(let ve=0;ve<O;ve++){const ee=Math.sqrt(ce[ve])-Math.sqrt(ae[ve]);F[ve]=Math.round(255-255*(ee/this.radius+this.cutoff))}return G}};const Um=Vm;function _I(a,t){return a+t[1]-t[0]}function yI(a,t,s,u,h=1){const m=[],_=a.imagePrimary,S=_.pixelRatio,E=_.paddedRect.w-2*Um,A=_.paddedRect.h-2*Um,D=(a.right-a.left)*h,O=(a.bottom-a.top)*h,F=_.stretchX||[[0,E]],G=_.stretchY||[[0,A]],W=F.reduce(_I,0),Q=G.reduce(_I,0),ae=E-W,ce=A-Q;let we=0,ve=W,ee=0,ge=Q,be=0,Ie=ae,Fe=0,$e=ce;if(_.content&&u){const et=_.content;we=bx(F,0,et[0]),ee=bx(G,0,et[1]),ve=bx(F,et[0],et[2]),ge=bx(G,et[1],et[3]),be=et[0]-we,Fe=et[1]-ee,Ie=et[2]-et[0]-ve,$e=et[3]-et[1]-ge}const Ze=(et,St,jt,kt)=>{const Ft=wx(et.stretch-we,ve,D,a.left*h),Gt=Sx(et.fixed-be,Ie,et.stretch,W),vt=wx(St.stretch-ee,ge,O,a.top*h),zt=Sx(St.fixed-Fe,$e,St.stretch,Q),gt=wx(jt.stretch-we,ve,D,a.left*h),bt=Sx(jt.fixed-be,Ie,jt.stretch,W),qt=wx(kt.stretch-ee,ge,O,a.top*h),Kt=Sx(kt.fixed-Fe,$e,kt.stretch,Q),En=new Qt(Ft,vt),_n=new Qt(gt,vt),sn=new Qt(gt,qt),Wt=new Qt(Ft,qt),Wn=new Qt(Gt/S,zt/S),wn=new Qt(bt/S,Kt/S),Sn=t*Math.PI/180;if(Sn){const ar=Math.sin(Sn),_i=Math.cos(Sn),Ri=[_i,-ar,ar,_i];En._matMult(Ri),_n._matMult(Ri),Wt._matMult(Ri),sn._matMult(Ri)}const $n=et.stretch+et.fixed,Jn=jt.stretch+jt.fixed,ir=St.stretch+St.fixed,yr=kt.stretch+kt.fixed,fr=a.imageSecondary;return{tl:En,tr:_n,bl:Wt,br:sn,texPrimary:{x:_.paddedRect.x+Um+$n,y:_.paddedRect.y+Um+ir,w:Jn-$n,h:yr-ir},texSecondary:fr?{x:fr.paddedRect.x+Um+$n,y:fr.paddedRect.y+Um+ir,w:Jn-$n,h:yr-ir}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Wn,pixelOffsetBR:wn,minFontScaleX:Ie/S/D,minFontScaleY:$e/S/O,isSDF:s}};if(u&&(_.stretchX||_.stretchY)){const et=vI(F,ae,W),St=vI(G,ce,Q);for(let jt=0;jt<et.length-1;jt++){const kt=et[jt],Ft=et[jt+1];for(let Gt=0;Gt<St.length-1;Gt++)m.push(Ze(kt,St[Gt],Ft,St[Gt+1]))}}else m.push(Ze({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:A+1}));return m}function bx(a,t,s){let u=0;for(const h of a)u+=Math.max(t,Math.min(s,h[1]))-Math.max(t,Math.min(s,h[0]));return u}function vI(a,t,s){const u=[{fixed:-1,stretch:0}];for(const[h,m]of a){const _=u[u.length-1];u.push({fixed:h-_.stretch,stretch:_.stretch}),u.push({fixed:h-_.stretch,stretch:_.stretch+(m-h)})}return u.push({fixed:t+Um,stretch:s}),u}function wx(a,t,s,u){return a/t*s+u}function Sx(a,t,s,u){return a-t*s/u}function YN(a,t,s,u){const h=t+a.positionedLines[u].lineOffset;return u===0?s+h/2:s+(h+(t+a.positionedLines[u-1].lineOffset))/2}function JN(a,t=1,s=!1){let u=1/0,h=1/0,m=-1/0,_=-1/0;const S=a[0];for(let G=0;G<S.length;G++){const W=S[G];(!G||W.x<u)&&(u=W.x),(!G||W.y<h)&&(h=W.y),(!G||W.x>m)&&(m=W.x),(!G||W.y>_)&&(_=W.y)}const E=Math.min(m-u,_-h);let A=E/2;const D=new Vh([],QN);if(E===0)return new Qt(u,h);for(let G=u;G<m;G+=E)for(let W=h;W<_;W+=E)D.push(new Fg(G+A,W+A,A,a));let O=function(G){let W=0,Q=0,ae=0;const ce=G[0];for(let we=0,ve=ce.length,ee=ve-1;we<ve;ee=we++){const ge=ce[we],be=ce[ee],Ie=ge.x*be.y-be.x*ge.y;Q+=(ge.x+be.x)*Ie,ae+=(ge.y+be.y)*Ie,W+=3*Ie}return new Fg(Q/W,ae/W,0,G)}(a),F=D.length;for(;D.length;){const G=D.pop();(G.d>O.d||!O.d)&&(O=G,s&&console.log("found best %d after %d probes",Math.round(1e4*G.d)/1e4,F)),G.max-O.d<=t||(A=G.h/2,D.push(new Fg(G.p.x-A,G.p.y-A,A,a)),D.push(new Fg(G.p.x+A,G.p.y-A,A,a)),D.push(new Fg(G.p.x-A,G.p.y+A,A,a)),D.push(new Fg(G.p.x+A,G.p.y+A,A,a)),F+=4)}return s&&(console.log(`num probes: ${F}`),console.log(`best distance: ${O.d}`)),O.p}function QN(a,t){return t.max-a.max}class Fg{constructor(t,s,u,h){this.p=new Qt(t,s),this.h=u,this.d=function(m,_){let S=!1,E=1/0;for(let A=0;A<_.length;A++){const D=_[A];for(let O=0,F=D.length,G=F-1;O<F;G=O++){const W=D[O],Q=D[G];W.y>m.y!=Q.y>m.y&&m.x<(Q.x-W.x)*(m.y-W.y)/(Q.y-W.y)+W.x&&(S=!S),E=Math.min(E,Cr(m,W,Q))}}return(S?1:-1)*Math.sqrt(E)}(this.p,h),this.max=this.d+this.h*Math.SQRT2}}const ej=Object.keys,Vb=Number.POSITIVE_INFINITY,tj=Math.sqrt(2);function xI(a,[t,s]){let u=0,h=0;if(s===Vb){t<0&&(t=0);const m=t/tj;switch(a){case"top-right":case"top-left":h=m-7;break;case"bottom-right":case"bottom-left":h=7-m;break;case"bottom":h=7-t;break;case"top":h=t-7}switch(a){case"top-right":case"bottom-right":u=-m;break;case"top-left":case"bottom-left":u=m;break;case"left":u=t;break;case"right":u=-t}}else{switch(t=Math.abs(t),s=Math.abs(s),a){case"top-right":case"top-left":case"top":h=s-7;break;case"bottom-right":case"bottom-left":case"bottom":h=7-s}switch(a){case"top-right":case"bottom-right":case"right":u=-t;break;case"top-left":case"bottom-left":case"left":u=t}}return[u,h]}function Cx(a,t,s,u,h,m,_,S,E){if(!t||!t.usvg)return;const A=oI(u),D=oI(h),O=m!=="both"&&m!=="width"||!iI(u)?1:Math.max(1,D.width/A.width),F=m!=="both"&&m!=="height"||!sI(u)?1:Math.max(1,D.height/A.height);s.scaleSelf(O,F);const G=s.toString();_.set(G,s),S.set(G,t);const{imagePosition:W}=jb(G,t,Vm);E.set(G,W)}function bI(a,t,s,u,h,m,_,S){if(!a)return;const E=function(A,D,O,F,G){if(A.kind==="camera")return A.maxSize;if(A.kind==="composite"){const W=D.possiblyEvaluate(new ni(A.maxZoom),O).evaluate(G,{},O),Q=D.possiblyEvaluate(new ni(A.minZoom),O).evaluate(G,{},O);return Math.max(W,Q)}return D.possiblyEvaluate(new ni(F)).evaluate(G,{},O)}(t,s,u,h,m);return a.scaleSelf(E*S*_)}function wI(a,t,s,u,h,m,_,S){return{iconPrimary:bI(a.getPrimary(),t,s,u,h,m,_,S),iconSecondary:bI(a.getSecondary(),t,s,u,h,m,_,S)}}function SI(a,t,s,u){if(!a)return;const h=t.get(s.toString());if(a.imagePrimary=h,u){const m=t.get(u.toString());a.imageSecondary=m}}function nj(a,t){for(const s in a.horizontal)CI(a.horizontal[s],t);CI(a.vertical,t)}function CI(a,t){if(a){for(const s of a.positionedLines)for(const u of s.positionedGlyphs)if(u.image!==null){const h=u.image.toString();u.rect=t.get(h).paddedRect}}}function Ub(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function rj(a,t,s,u,h,m,_,S,E){const A=$b(m.horizontal)||m.vertical,D=s.get("icon-text-fit-padding").evaluate(u,{},h);let O,F=t;return t&&E!=="none"&&(a.allowVerticalPlacement&&m.vertical&&(O=rI(t,m.vertical,E,D,S,_)),A&&(F=rI(t,A,E,D,S,_))),{defaultShapedIcon:F,verticallyShapedIcon:O}}function ij(a,t,s,u,h,m,_,S,E,A,D,O,F,G,W,Q,ae,ce,we,ve){let ee=_.textMaxSize.evaluate(t,{},F);ee===void 0?ee=S*_.textScaleFactor:ee*=_.textScaleFactor;const ge=a.layers[0].layout,be=$b(s.horizontal)||s.vertical,Ie=G.name==="globe",Fe=mo,$e=a.tilePixelRatio*ee/Fe,Ze=(Gt=a.overscaling,a.zoom>18&&Gt>2&&(Gt>>=1),Math.max(en/(512*Gt),1)*ge.get("symbol-spacing")),et=ge.get("text-padding")*a.tilePixelRatio,St=ge.get("icon-padding")*a.tilePixelRatio,jt=ie(ge.get("text-max-angle")),kt=ge.get("icon-rotation-alignment")==="map"&&ve!=="point",Ft=Ze/2;var Gt;a.hasAnyIconTextFit===!1&&ae!=="none"&&(a.hasAnyIconTextFit=!0);const vt=t.properties?+t.properties[Fm]:null,zt=vt&&a.elevationFeatureIdToIndex?a.elevationFeatureIdToIndex.get(vt):65535,gt=(bt,qt,Kt)=>{if(qt.x<0||qt.x>=en||qt.y<0||qt.y>=en)return;let En=null;if(Ie){const{x:_n,y:sn,z:Wt}=G.projectTilePoint(qt.x,qt.y,Kt);En={anchor:new vf(_n,sn,Wt,0,void 0),up:G.upVector(Kt,qt.x,qt.y)}}(function(_n,sn,Wt,Wn,wn,Sn,$n,Jn,ir,yr,fr,ar,_i,Ri,Ee,Ae,Et,Jt,an,on,Cn,jn,Er,Ir,lr,li,Ci,Pr,Yi){const Mi=_n.addToLineVertexArray(sn,Wn);let oi,cs,zi,Ti,Li,di,mr,fi=0,Ji=0,Fn=0,$r=0,Fi=-1,rs=-1;const Ni={};let Ns=bo("");const yi=Wt?Wt.anchor:sn,Ds=Pr!=="none";let ja=0,Vo=0;if(ir._unevaluatedLayout.getValue("text-radial-offset")===void 0){const js=ir.layout.get("text-offset").evaluate(Cn,{},lr);ja=js[0]*mo,Vo=js[1]*mo}else ja=ir.layout.get("text-radial-offset").evaluate(Cn,{},lr)*mo,Vo=Vb;if(_n.allowVerticalPlacement&&wn.vertical){const js=wn.vertical;if(Ee)di=Hb(js),Jn&&(mr=Hb(Jn));else{const Js=ir.layout.get("text-rotate").evaluate(Cn,{},lr)+90;zi=Tx(yr,yi,sn,fr,ar,_i,js,Ri,Js,Ae),Jn&&(Ti=Tx(yr,yi,sn,fr,ar,_i,Jn,Jt,Js))}}if(Sn){const js=_n.iconSizeData,Js=ir.layout.get("icon-rotate").evaluate(Cn,{},lr),Uo=yI(Sn,Js,Er,Ds,jn.iconScaleFactor),ra=Jn?yI(Jn,Js,Er,Ds,jn.iconScaleFactor):void 0;cs=Tx(yr,yi,sn,fr,ar,_i,Sn,Jt,Js,null),fi=4*Uo.length;let Qo=null;js.kind==="source"?(Qo=[dh*ir.layout.get("icon-size").evaluate(Cn,{},lr)*jn.iconScaleFactor],Qo[0]>Cp&&gr(`${_n.layerIds[0]}: Value for "icon-size" is >= ${wy}. Reduce your "icon-size".`)):js.kind==="composite"&&(Qo=[dh*jn.compositeIconSizes[0].evaluate(Cn,{},lr)*jn.iconScaleFactor,dh*jn.compositeIconSizes[1].evaluate(Cn,{},lr)*jn.iconScaleFactor],(Qo[0]>Cp||Qo[1]>Cp)&&gr(`${_n.layerIds[0]}: Value for "icon-size" is >= ${wy}. Reduce your "icon-size".`)),_n.addSymbols(_n.icon,Uo,Qo,on,an,Cn,void 0,Wt,sn,Mi.lineStartIndex,Mi.lineLength,-1,Ir,lr,li,Ci),Fi=_n.icon.placedSymbolArray.length-1,ra&&(Ji=4*ra.length,_n.addSymbols(_n.icon,ra,Qo,on,an,Cn,dl.vertical,Wt,sn,Mi.lineStartIndex,Mi.lineLength,-1,Ir,lr,li,Ci),rs=_n.icon.placedSymbolArray.length-1)}for(const js in wn.horizontal){const Js=js,Uo=wn.horizontal[Js];oi||(Ns=bo(Uo.text),Ee?Li=Hb(Uo):oi=Tx(yr,yi,sn,fr,ar,_i,Uo,Ri,ir.layout.get("text-rotate").evaluate(Cn,{},lr),Ae));const ra=Uo.positionedLines.length===1;if(Fn+=TI(_n,Wt,sn,Uo,$n,ir,Ee,Cn,Ae,Mi,wn.vertical?dl.horizontal:dl.horizontalOnly,ra?ej(wn.horizontal):[Js],Ni,Fi,jn,Ir,lr,li),ra)break}wn.vertical&&($r+=TI(_n,Wt,sn,wn.vertical,$n,ir,Ee,Cn,Ae,Mi,dl.vertical,["vertical"],Ni,rs,jn,Ir,lr,li));let Io=-1;const Ba=(js,Js)=>js?Math.max(js,Js):Js;Io=Ba(Li,Io),Io=Ba(di,Io),Io=Ba(mr,Io);const hh=Io>-1?1:0;_n.glyphOffsetArray.length>=65535&&gr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Cn.sortKey!==void 0&&_n.addToSortKeyRanges(_n.symbolInstances.length,Cn.sortKey),_n.symbolInstances.emplaceBack(sn.x,sn.y,yi.x,yi.y,yi.z,Ni.right>=0?Ni.right:-1,Ni.center>=0?Ni.center:-1,Ni.left>=0?Ni.left:-1,Ni.vertical>=0?Ni.vertical:-1,Fi,rs,Ns,oi!==void 0?oi:_n.collisionBoxArray.length,oi!==void 0?oi+1:_n.collisionBoxArray.length,zi!==void 0?zi:_n.collisionBoxArray.length,zi!==void 0?zi+1:_n.collisionBoxArray.length,cs!==void 0?cs:_n.collisionBoxArray.length,cs!==void 0?cs+1:_n.collisionBoxArray.length,Ti||_n.collisionBoxArray.length,Ti?Ti+1:_n.collisionBoxArray.length,fr,Fn,$r,fi,Ji,hh,0,ja,Vo,Io,0,Ds?1:0,Yi)})(a,qt,En,bt,s,u,m,h,a.layers[0],a.collisionBoxArray,t.index,t.sourceLayerIndex,a.index,et,we,A,0,St,kt,ce,t,_,D,O,F,W,Q,ae,zt)};if(ve==="line")for(const bt of _x(t.geometry,0,0,en,en)){const qt=KN(bt,Ze,jt,s.vertical||be,u,Fe,$e,a.overscaling,en);for(const Kt of qt)be&&sj(a,be.text,Ft,Kt)||gt(bt,Kt,F)}else if(ve==="line-center"){for(const bt of t.geometry)if(bt.length>1){const qt=XN(bt,jt,s.vertical||be,u,Fe,$e);qt&&gt(bt,qt,F)}}else if(t.type==="Polygon")for(const bt of ux(t.geometry,0)){const qt=JN(bt,16);gt(bt[0],new vf(qt.x,qt.y,0,0,void 0),F)}else if(t.type==="LineString")for(const bt of t.geometry)gt(bt,new vf(bt[0].x,bt[0].y,0,0,void 0),F);else if(t.type==="Point")for(const bt of t.geometry)for(const qt of bt)gt([qt],new vf(qt.x,qt.y,0,0,void 0),F)}const wy=255,Cp=wy*dh;function TI(a,t,s,u,h,m,_,S,E,A,D,O,F,G,W,Q,ae,ce){const we=function(ge,be,Ie,Fe,$e,Ze,et,St){const jt=[];if(be.positionedLines.length===0)return jt;const kt=Fe.layout.get("text-rotate").evaluate(Ze,{})*Math.PI/180,Ft=function(bt){const qt=bt[0],Kt=bt[1],En=qt*Kt;return En>0?[qt,-Kt]:En<0?[-qt,Kt]:qt===0?[Kt,qt]:[Kt,-qt]}(Ie);let Gt=Math.abs(be.top-be.bottom);for(const bt of be.positionedLines)Gt-=bt.lineOffset;const vt=be.positionedLines.length,zt=Gt/vt;let gt=be.top-Ie[1];for(let bt=0;bt<vt;++bt){const qt=be.positionedLines[bt];gt=YN(be,zt,gt,bt);for(const Kt of qt.positionedGlyphs){if(!Kt.rect)continue;const En=Kt.rect||{};let _n=GN+1,sn=!0,Wt=1,Wn=0;if(Kt.image){const Cn=et.get(Kt.image.toString());if(!Cn)continue;if(Cn.sdf){gr("SDF images are not supported in formatted text and will be ignored.");continue}sn=!1,Wt=Cn.pixelRatio,_n=Vm/Wt}const wn=($e||St)&&Kt.vertical,Sn=Kt.metrics.advance*Kt.scale/2,$n=Kt.metrics,Jn=Kt.rect;if(Jn===null)continue;St&&be.verticalizable&&(Wn=Kt.image?Sn-Kt.metrics.width*Kt.scale/2:0);const ir=$e?[Kt.x+Sn,Kt.y]:[0,0];let yr=[0,0],fr=[0,0],ar=!1;$e||(wn?(fr=[Kt.x+Sn+Ft[0],Kt.y+Ft[1]-Wn],ar=!0):yr=[Kt.x+Sn+Ie[0],Kt.y+Ie[1]-Wn]);const _i=Jn.w*Kt.scale/(Wt*(Kt.localGlyph?ad:1)),Ri=Jn.h*Kt.scale/(Wt*(Kt.localGlyph?ad:1));let Ee,Ae,Et,Jt;if(wn){const Cn=Kt.y-gt,jn=new Qt(-Sn,Sn-Cn),Er=-Math.PI/2,Ir=new Qt(...fr);Ee=new Qt(-Sn+yr[0],yr[1]),Ee._rotateAround(Er,jn)._add(Ir),Ee.x+=-Cn+Sn,Ee.y-=($n.left-_n)*Kt.scale;const lr=Kt.image?$n.advance*Kt.scale:mo*Kt.scale,li=String.fromCodePoint(Kt.glyph);jN(li)?Ee.x+=(1-_n)*Kt.scale:BN(li)?Ee.x+=lr-$n.height*Kt.scale+(-_n-1)*Kt.scale:Ee.x+=Kt.image||$n.width+2*_n===Jn.w&&$n.height+2*_n===Jn.h?(lr-Ri)/2:(lr-($n.height+2*_n)*Kt.scale)/2,Ae=new Qt(Ee.x,Ee.y-_i),Et=new Qt(Ee.x+Ri,Ee.y),Jt=new Qt(Ee.x+Ri,Ee.y-_i)}else{const Cn=($n.left-_n)*Kt.scale-Sn+yr[0],jn=(-$n.top-_n)*Kt.scale+yr[1],Er=Cn+_i,Ir=jn+Ri;Ee=new Qt(Cn,jn),Ae=new Qt(Er,jn),Et=new Qt(Cn,Ir),Jt=new Qt(Er,Ir)}if(kt){let Cn;Cn=$e?new Qt(0,0):ar?new Qt(Ft[0],Ft[1]):new Qt(Ie[0],Ie[1]),Ee._rotateAround(kt,Cn),Ae._rotateAround(kt,Cn),Et._rotateAround(kt,Cn),Jt._rotateAround(kt,Cn)}const an=new Qt(0,0),on=new Qt(0,0);jt.push({tl:Ee,tr:Ae,bl:Et,br:Jt,texPrimary:En,texSecondary:void 0,writingMode:be.writingMode,glyphOffset:ir,sectionIndex:Kt.sectionIndex,isSDF:sn,pixelOffsetTL:an,pixelOffsetBR:on,minFontScaleX:0,minFontScaleY:0})}}return jt}(0,u,E,m,_,S,h,a.allowVerticalPlacement),ve=a.textSizeData;let ee=null;ve.kind==="source"?(ee=[dh*m.layout.get("text-size").evaluate(S,{},ae)*W.textScaleFactor],ee[0]>Cp&&gr(`${a.layerIds[0]}: Value for "text-size" is >= ${wy}. Reduce your "text-size".`)):ve.kind==="composite"&&(ee=[dh*W.compositeTextSizes[0].evaluate(S,{},ae)*W.textScaleFactor,dh*W.compositeTextSizes[1].evaluate(S,{},ae)*W.textScaleFactor],(ee[0]>Cp||ee[1]>Cp)&&gr(`${a.layerIds[0]}: Value for "text-size" is >= ${wy}. Reduce your "text-size".`)),a.addSymbols(a.text,we,ee,E,_,S,D,t,s,A.lineStartIndex,A.lineLength,G,Q,ae,ce,!1);for(const ge of O)F[ge]=a.text.placedSymbolArray.length-1;return 4*we.length}function $b(a){for(const t in a)return a[t];return null}function Tx(a,t,s,u,h,m,_,S,E,A){let D=_.top,O=_.bottom,F=_.left,G=_.right;if(nI(_)&&_.collisionPadding){const W=_.collisionPadding;F-=W[0],D-=W[1],G+=W[2],O+=W[3]}if(E){const W=new Qt(F,D),Q=new Qt(G,D),ae=new Qt(F,O),ce=new Qt(G,O),we=ie(E);let ve=new Qt(0,0);A&&(ve=new Qt(A[0],A[1])),W._rotateAround(we,ve),Q._rotateAround(we,ve),ae._rotateAround(we,ve),ce._rotateAround(we,ve),F=Math.min(W.x,Q.x,ae.x,ce.x),G=Math.max(W.x,Q.x,ae.x,ce.x),D=Math.min(W.y,Q.y,ae.y,ce.y),O=Math.max(W.y,Q.y,ae.y,ce.y)}return a.emplaceBack(t.x,t.y,t.z,s.x,s.y,F,D,G,O,S,u,h,m),a.length-1}function Hb(a){nI(a)&&a.collisionPadding&&(a.top-=a.collisionPadding[1],a.bottom+=a.collisionPadding[3]);const t=a.bottom-a.top;return t>0?Math.max(10,t):null}function sj(a,t,s,u){const h=a.compareText;if(t in h){const m=h[t];for(let _=m.length-1;_>=0;_--)if(u.dist(m[_])<s)return!0}else h[t]=[];return h[t].push(u),!1}function EI(a,t){const s=a.fovAboveCenter,u=a.elevation?a.elevation.getMinElevationBelowMSL()*t:0,h=(a._camera.position[2]*a.worldSize-u)/Math.cos(a._pitch),m=Math.sin(s)*h/Math.sin(Math.max(Math.PI/2-a._pitch-s,.01));let _=Math.sin(a._pitch)*m+h;const S=h*(1/a._horizonShift);if(!a.elevation||a.elevation.exaggeration()===0){let E=Math.max(a.zoom-17,0);a.isOrthographic&&(E/=10),_*=1+E}return Math.min(1.01*_,S)}function Sy(a,t){if(!t.isReprojectedInTileSpace)return{scale:1<<a.z,x:a.x,y:a.y,x2:a.x+1,y2:a.y+1,projection:t};const s=Math.pow(2,-a.z),u=a.x*s,h=(a.x+1)*s,m=a.y*s,_=(a.y+1)*s,S=Oe(u),E=Oe(h),A=Ne(m),D=Ne(_),O=t.project(S,A),F=t.project(E,A),G=t.project(E,D),W=t.project(S,D);let Q=Math.min(O.x,F.x,G.x,W.x),ae=Math.min(O.y,F.y,G.y,W.y),ce=Math.max(O.x,F.x,G.x,W.x),we=Math.max(O.y,F.y,G.y,W.y);const ve=s/16;function ee(be,Ie,Fe,$e,Ze,et){const St=(Fe+Ze)/2,jt=($e+et)/2,kt=t.project(Oe(St),Ne(jt)),Ft=Math.max(0,Q-kt.x,ae-kt.y,kt.x-ce,kt.y-we);Q=Math.min(Q,kt.x),ce=Math.max(ce,kt.x),ae=Math.min(ae,kt.y),we=Math.max(we,kt.y),Ft>ve&&(ee(be,kt,Fe,$e,St,jt),ee(kt,Ie,St,jt,Ze,et))}ee(O,F,u,m,h,m),ee(F,G,h,m,h,_),ee(G,W,h,_,u,_),ee(W,O,u,_,u,m),Q-=ve,ae-=ve,ce+=ve,we+=ve;const ge=1/Math.max(ce-Q,we-ae);return{scale:ge,x:Q*ge,y:ae*ge,x2:ce*ge,y2:we*ge,projection:t}}function II(a,{x:t,y:s},u=0){return new Qt(((t-u)*a.scale-a.x)*en,(s*a.scale-a.y)*en)}const oj=Z(new Float32Array(16));class Tp{constructor(t){this.spec=t,this.name=t.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(t,s){return{x:0,y:0,z:0}}unproject(t,s){return new ne(0,0)}projectTilePoint(t,s,u){return{x:t,y:s,z:0}}locationPoint(t,s,u,h=!0){return t._coordinatePoint(t.locationCoordinate(s,u),h)}pixelsPerMeter(t,s){return Pe(1,t)*s}pixelSpaceConversion(t,s,u){return 1}farthestPixelDistance(t){return EI(t,t.pixelsPerMeter)}pointCoordinate(t,s,u,h){const m=t.horizonLineFromTop(!1),_=new Qt(s,Math.max(m,u));return t.rayIntersectionCoordinate(t.pointRayIntersection(_,h))}pointCoordinate3D(t,s,u){const h=new Qt(s,u);if(t.elevation)return t.elevation.pointCoordinate(h);{const m=this.pointCoordinate(t,h.x,h.y,0);return[m.x,m.y,m.z]}}isPointAboveHorizon(t,s){if(t.elevation&&t.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(t,s.x,s.y);const u=t.horizonLineFromTop();return s.y<u}createInversionMatrix(t,s){return oj}createTileMatrix(t,s,u){let h,m,_;const S=u.canonical,E=Z(new Float64Array(16));if(this.isReprojectedInTileSpace){const A=Sy(S,this);h=1,m=A.x+u.wrap*A.scale,_=A.y,ue(E,E,[h/A.scale,h/A.scale,t.pixelsPerMeter/s])}else h=s/t.zoomScale(S.z),m=(S.x+Math.pow(2,S.z)*u.wrap)*h,_=S.y*h;return de(E,E,[m,_,0]),ue(E,E,[h/en,h/en,1]),E}upVector(t,s,u){return[0,0,1]}upVectorScale(t,s,u){return{metersToTile:1}}}class aj extends Tp{constructor(t){super(t),this.range=[4,7],this.center=t.center||[-96,37.5];const[s,u]=this.parallels=t.parallels||[29.5,45.5],h=Math.sin(ie(s));this.n=(h+Math.sin(ie(u)))/2,this.c=1+h*(2*this.n-h),this.r0=Math.sqrt(this.c)/this.n}project(t,s){const{n:u,c:h,r0:m}=this,_=ie(t-this.center[0]),S=ie(s),E=Math.sqrt(h-2*u*Math.sin(S))/u;return{x:E*Math.sin(_*u),y:E*Math.cos(_*u)-m,z:0}}unproject(t,s){const{n:u,c:h,r0:m}=this,_=m+s;let S=Math.atan2(t,Math.abs(_))*Math.sign(_);_*u<0&&(S-=Math.PI*Math.sign(t)*Math.sign(_));const E=ie(this.center[0])*u;S=pt(S,-Math.PI-E,Math.PI-E);const A=Xe(me(S/u)+this.center[0],-180,180),D=Math.asin(Xe((h-(t*t+_*_)*u*u)/(2*u),-1,1)),O=Xe(me(D),-85.051129,rt);return new ne(A,O)}}const Cy=1.340264,Ty=-.081106,Ey=893e-6,Iy=.003796,Ex=Math.sqrt(3)/2;class lj extends Tp{project(t,s){s=s/180*Math.PI,t=t/180*Math.PI;const u=Math.asin(Ex*Math.sin(s)),h=u*u,m=h*h*h;return{x:.5*(t*Math.cos(u)/(Ex*(Cy+3*Ty*h+m*(7*Ey+9*Iy*h)))/Math.PI+.5),y:1-.5*(u*(Cy+Ty*h+m*(Ey+Iy*h))/Math.PI+1),z:0}}unproject(t,s){t=(2*t-.5)*Math.PI;let u=s=(2*(1-s)-1)*Math.PI,h=u*u,m=h*h*h;for(let D,O,F,G=0;G<12&&(O=u*(Cy+Ty*h+m*(Ey+Iy*h))-s,F=Cy+3*Ty*h+m*(7*Ey+9*Iy*h),D=O/F,u=Xe(u-D,-Math.PI/3,Math.PI/3),h=u*u,m=h*h*h,!(Math.abs(D)<1e-12));++G);const _=Ex*t*(Cy+3*Ty*h+m*(7*Ey+9*Iy*h))/Math.cos(u),S=Math.asin(Math.sin(u)/Ex),E=Xe(180*_/Math.PI,-180,180),A=Xe(180*S/Math.PI,-85.051129,rt);return new ne(E,A)}}class cj extends Tp{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0}project(t,s){return{x:.5+t/360,y:.5-s/360,z:0}}unproject(t,s){const u=360*(t-.5),h=Xe(360*(.5-s),-85.051129,rt);return new ne(u,h)}}const Ng=Math.PI/2;function Ix(a){return Math.tan((Ng+a)/2)}class uj extends Tp{constructor(t){super(t),this.center=t.center||[0,30];const[s,u]=this.parallels=t.parallels||[30,30];let h=ie(s),m=ie(u);this.southernCenter=h+m<0,this.southernCenter&&(h=-h,m=-m);const _=Math.cos(h),S=Ix(h);this.n=h===m?Math.sin(h):Math.log(_/Math.cos(m))/Math.log(Ix(m)/S),this.f=_*Math.pow(Ix(h),this.n)/this.n}project(t,s){s=ie(s),this.southernCenter&&(s=-s),t=ie(t-this.center[0]);const u=1e-6,{n:h,f:m}=this;m>0?s<-Ng+u&&(s=-Ng+u):s>Ng-u&&(s=Ng-u);const _=m/Math.pow(Ix(s),h);let S=_*Math.sin(h*t),E=m-_*Math.cos(h*t);return S=.5*(S/Math.PI+.5),E=.5*(E/Math.PI+.5),{x:S,y:this.southernCenter?E:1-E,z:0}}unproject(t,s){t=(2*t-.5)*Math.PI,this.southernCenter&&(s=1-s),s=(2*(1-s)-.5)*Math.PI;const{n:u,f:h}=this,m=h-s,_=Math.sign(m),S=Math.sign(u)*Math.sqrt(t*t+m*m);let E=Math.atan2(t,Math.abs(m))*_;m*u<0&&(E-=Math.PI*Math.sign(t)*_);const A=Xe(me(E/u)+this.center[0],-180,180),D=Xe(me(2*Math.atan(Math.pow(h/S,1/u))-Ng),-85.051129,rt);return new ne(A,this.southernCenter?-D:D)}}class PI extends Tp{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(t,s){return{x:De(t),y:Me(s),z:0}}unproject(t,s){const u=Oe(t),h=Ne(s);return new ne(u,h)}}const AI=ie(rt);class dj extends Tp{project(t,s){const u=(s=ie(s))*s,h=u*u;return{x:.5*((t=ie(t))*(.8707-.131979*u+h*(h*(.003971*u-.001529*h)-.013791))/Math.PI+.5),y:1-.5*(s*(1.007226+u*(.015085+h*(.028874*u-.044475-.005916*h)))/Math.PI+1),z:0}}unproject(t,s){t=(2*t-.5)*Math.PI;let u=s=(2*(1-s)-1)*Math.PI,h=25,m=0,_=u*u;do{_=u*u;const A=_*_;m=(u*(1.007226+_*(.015085+A*(.028874*_-.044475-.005916*A)))-s)/(1.007226+_*(.045255+A*(.259866*_-.311325-.005916*11*A))),u=Xe(u-m,-AI,AI)}while(Math.abs(m)>1e-6&&--h>0);_=u*u;const S=Xe(me(t/(.8707+_*(_*(_*_*_*(.003971-.001529*_)-.013791)-.131979))),-180,180),E=me(u);return new ne(S,E)}}const RI=ie(rt);class hj extends Tp{project(t,s){s=ie(s),t=ie(t);const u=Math.cos(s),h=2/Math.PI,m=Math.acos(u*Math.cos(t/2)),_=Math.sin(m)/m,S=.5*(t*h+2*u*Math.sin(t/2)/_)||0,E=.5*(s+Math.sin(s)/_)||0;return{x:.5*(S/Math.PI+.5),y:1-.5*(E/Math.PI+1),z:0}}unproject(t,s){let u=t=(2*t-.5)*Math.PI,h=s=(2*(1-s)-1)*Math.PI,m=25;const _=1e-6;let S=0,E=0;do{const A=Math.cos(h),D=Math.sin(h),O=2*D*A,F=D*D,G=A*A,W=Math.cos(u/2),Q=Math.sin(u/2),ae=2*W*Q,ce=Q*Q,we=1-G*W*W,ve=we?1/we:0,ee=we?Math.acos(A*W)*Math.sqrt(1/we):0,ge=.5*(2*ee*A*Q+2*u/Math.PI)-t,be=.5*(ee*D+h)-s,Ie=.5*ve*(G*ce+ee*A*W*F)+1/Math.PI,Fe=ve*(ae*O/4-ee*D*Q),$e=.125*ve*(O*Q-ee*D*G*ae),Ze=.5*ve*(F*W+ee*ce*A)+.5,et=Fe*$e-Ze*Ie;S=(be*Fe-ge*Ze)/et,E=(ge*$e-be*Ie)/et,u=Xe(u-S,-Math.PI,Math.PI),h=Xe(h-E,-RI,RI)}while((Math.abs(S)>_||Math.abs(E)>_)&&--m>0);return new ne(me(u),me(h))}}class MI extends Tp{constructor(t){super(t),this.center=t.center||[0,0],this.parallels=t.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(ie(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(t,s){const{scale:u,cosPhi:h}=this;return{x:ie(t)*h*u+.5,y:-Math.sin(ie(s))/h*u+.5,z:0}}unproject(t,s){const{scale:u,cosPhi:h}=this,m=-(s-.5)/u,_=Xe(me((t-.5)/u)/h,-180,180),S=Math.asin(Xe(m*h,-1,1)),E=Xe(me(S),-85.051129,rt);return new ne(_,E)}}class fj extends PI{constructor(t){super(t),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(t,s,u){const h=lh(t,s,u);return cn(h,h,km(ul(u))),{x:h[0],y:h[1],z:h[2]}}locationPoint(t,s,u){const h=re(s.lat,s.lng),m=We([],h),_=u?t._centerAltitude+u:t.elevation?t.elevation.getAtPointOrZero(t.locationCoordinate(s),t._centerAltitude):t._centerAltitude;ze(h,h,m,Pe(1,0)*en*_);const S=Z(new Float64Array(16));return le(S,t.pixelMatrix,t.globeMatrix),cn(h,h,S),new Qt(h[0],h[1])}pixelsPerMeter(t,s){return Pe(1,0)*s}pixelSpaceConversion(t,s,u){const h=Pe(1,t)*s,m=kn(Pe(1,45)*s,h,u);return this.pixelsPerMeter(t,s)/m}createTileMatrix(t,s,u){const h=ly(ul(u.canonical));return le(new Float64Array(16),t.globeMatrix,h)}createInversionMatrix(t,s){const{center:u}=t,h=km(ul(s));return he(h,h,ie(u.lng)),pe(h,h,ie(u.lat)),ue(h,h,[t._pixelsPerMercatorPixel,t._pixelsPerMercatorPixel,1]),Float32Array.from(h)}pointCoordinate(t,s,u,h){return ay(t,s,u,!0)||new dt(0,0)}pointCoordinate3D(t,s,u){const h=this.pointCoordinate(t,s,u,0);return[h.x,h.y,h.z]}isPointAboveHorizon(t,s){return!ay(t,s.x,s.y,!1)}farthestPixelDistance(t){const s=function(h,m){const _=h.cameraToCenterDistance,S=h._centerAltitude*m,E=h._camera,A=h._camera.forward(),D=Ge([],ct([],A,-_),[0,0,S]),O=h.worldSize/(2*Math.PI),F=[0,0,-O],G=h.width/h.height,W=Math.tan(h.fovAboveCenter),Q=ct([],E.up(),W),ae=ct([],E.right(),W*G),ce=We([],Ge([],Ge([],A,Q),ae)),we=[];let ve;if(new cl(D,ce).closestPointOnSphere(F,O,we)){const ee=Ge([],we,F),ge=An([],ee,D);ve=Math.cos(h.fovAboveCenter)*_t(ge)}else{const ee=An([],D,F),ge=An([],F,D);We(ge,ge);const be=_t(ee)-O;ve=Math.sqrt(be*(be+2*O));const Ie=Math.acos(ve/(O+be))-Math.acos(st(A,ge));ve*=Math.cos(Ie)}return 1.01*ve}(t,this.pixelsPerMeter(t.center.lat,t.worldSize)),u=ch(t.zoom);if(u>0){const h=EI(t,Pe(1,t.center.lat)*t.worldSize),m=t.worldSize/(2*Math.PI),_=Math.max(t.width,t.height)/t.worldSize*Math.PI;return kn(s,h+m*(1-Math.cos(_)),Math.pow(u,10))}return s}upVector(t,s,u){return lh(s,u,t,1)}upVectorScale(t){return{metersToTile:hu(vp(ul(t)))}}}function LI(a){const t=a.parallels,s=!!t&&Math.abs(t[0]+t[1])<.01;switch(a.name){case"mercator":return new PI(a);case"equirectangular":return new cj(a);case"naturalEarth":return new dj(a);case"equalEarth":return new lj(a);case"winkelTripel":return new hj(a);case"albers":return s?new MI(a):new aj(a);case"lambertConformalConic":return s?new MI(a):new uj(a);case"globe":return new fj(a)}throw new Error(`Invalid projection name: ${a.name}`)}const pj=wp.VectorTileFeature.types,mj=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Px(a,t,s,u,h,m,_,S,E,A,D,O,F){const G=S?Math.min(Cp,Math.round(S[0])):0,W=S?Math.min(Cp,Math.round(S[1])):0;a.emplaceBack(t,s,Math.round(32*u),Math.round(32*h),m,_,(G<<1)+(E?1:0),W,16*A,16*D,256*O,256*F)}function Ax(a,t,s){a.emplaceBack(t,s)}function Rx(a,t,s,u,h,m,_){a.emplaceBack(t,s,u,h,m,_)}function Mx(a,t,s,u,h){a.emplaceBack(t,s,u,h),a.emplaceBack(t,s,u,h),a.emplaceBack(t,s,u,h),a.emplaceBack(t,s,u,h)}function gj(a){for(const t of a.sections)if(Ig(t.text))return!0;return!1}class Gb{constructor(t){this.layoutVertexArray=new rh,this.indexArray=new gs,this.programConfigurations=t,this.segments=new ki,this.dynamicLayoutVertexArray=new Xs,this.opacityVertexArray=new lf,this.placedSymbolArray=new lp,this.iconTransitioningVertexArray=new ol,this.globeExtVertexArray=new Yo,this.zOffsetVertexArray=new th}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(t,s,u,h,m){this.isEmpty()||(u&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,RN.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,LN.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,mj,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=t.createVertexBuffer(this.iconTransitioningVertexArray,kN.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,MN.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||m)&&(this.zOffsetVertexBuffer=t.createVertexBuffer(this.zOffsetVertexArray,DN.members,!0)),this.opacityVertexBuffer.itemSize=1),(u||h)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}un(Gb,"SymbolBuffers");class Wb{constructor(t,s,u){this.layoutVertexArray=new t,this.layoutAttributes=s,this.indexArray=new u,this.segments=new ki,this.collisionVertexArray=new uf,this.collisionVertexArrayExt=new Xs}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,ON.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,zN.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}un(Wb,"CollisionBuffers");class Lx{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.lut=t.lut,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(_=>_.fqid),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Z([]),this.placementViewportMatrix=Z([]);const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=aI(this.zoom,s["text-size"]),this.iconSizeData=aI(this.zoom,s["icon-size"]);const u=this.layers[0].layout,h=u.get("symbol-sort-key"),m=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&h.constantOr(1)!==void 0,this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=u.get("text-writing-mode").map(_=>dl[_]),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=t.sourceID,this.projection=t.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=!1,this.elevationType="none",this.elevationStateComplete=!1,this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new Gb(new Ec(this.layers,{zoom:this.zoom,lut:this.lut},t=>t.startsWith("text")||t.startsWith("symbol"))),this.icon=new Gb(new Ec(this.layers,{zoom:this.zoom,lut:this.lut},t=>t.startsWith("icon")||t.startsWith("symbol"))),this.glyphOffsetArray=new up,this.lineVertexArray=new Im,this.symbolInstances=new cp}calculateGlyphDependencies(t,s,u,h,m){for(const _ of t){const S=_.codePointAt(0);if(S===void 0)break;if(s[S]=!0,h&&m&&S<=65535){const E=yy[_];E&&(s[E.charCodeAt(0)]=!0)}}}updateFootprints(t,s){}updateReplacement(t,s){if(s.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=s.updateTime;const u=s.getReplacementRegionsForTile(t.toUnwrapped(),!0);return!Eb(this.activeReplacements,u)&&(this.activeReplacements=u,!0)}populate(t,s,u,h){const m=this.layers[0],_=m.layout,S=this.projection.name==="globe",E=_.get("text-font"),A=_.get("text-field"),D=_.get("icon-image"),[O,F]=_.get("icon-size-scale-range"),G=Xe(s.scaleFactor||1,O,F),W=(A.value.kind!=="constant"||A.value.value instanceof Oo&&!A.value.value.isEmpty()||A.value.value.toString().length>0)&&(E.value.kind!=="constant"||E.value.value.length>0),Q=D.value.kind!=="constant"||!!D.value.value||Object.keys(D.parameters).length>0,ae=_.get("symbol-sort-key");if(this.features=[],!W&&!Q)return;const ce=s.iconDependencies,we=s.glyphDependencies,ve=s.availableImages,ee=new ni(this.zoom);for(const{feature:ge,id:be,index:Ie,sourceLayerIndex:Fe}of t){const $e=m._featureFilter.needGeometry,Ze=bn(ge,$e);if(!m._featureFilter.filter(ee,Ze,u))continue;if($e||(Ze.geometry=pn(ge,u,h)),S&&ge.type!==1&&u.z<=5){const Ft=Ze.geometry,Gt=.98078528056,vt=(zt,gt)=>st(lh(zt.x,zt.y,u,1),lh(gt.x,gt.y,u,1))<Gt;for(let zt=0;zt<Ft.length;zt++)Ft[zt]=Ot(Ft[zt],vt)}let et,St;if(W){const Ft=m.getValueAndResolveTokens("text-field",Ze,u,ve),Gt=Oo.factory(Ft);gj(Gt)&&(this.hasRTLText=!0),(!this.hasRTLText||as()==="unavailable"||this.hasRTLText&&ea.isParsed())&&(et=NN(Gt,m,Ze))}if(Q){const Ft=m.getValueAndResolveTokens("icon-image",Ze,u,ve);St=typeof Ft=="string"?Wo.build(Ft):Ft}if(!et&&!St)continue;const jt=this.sortFeaturesByKey?ae.evaluate(Ze,{},u):void 0,kt={id:be,text:et,icon:St,index:Ie,sourceLayerIndex:Fe,geometry:Ze.geometry,properties:ge.properties,type:pj[ge.type],sortKey:jt};if(this.features.push(kt),St){const Ft=this.layers[0]._unevaluatedLayout._values,{iconPrimary:Gt,iconSecondary:vt}=wI(St,this.iconSizeData,Ft["icon-size"],u,this.zoom,kt,this.pixelRatio,G),zt=Gt.id.toString();if(ce.has(zt)?ce.get(zt).push(Gt):ce.set(zt,[Gt]),vt){const gt=vt.id.toString();ce.has(gt)?ce.get(gt).push(vt):ce.set(gt,[vt])}}if(et){const Ft=E.evaluate(Ze,{},u).join(","),Gt=_.get("text-rotation-alignment")==="map"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(dl.vertical)>=0;for(const vt of et.sections)if(vt.image){const zt=vt.image.getPrimary().scaleSelf(this.pixelRatio),gt=zt.id.toString(),bt=ce.get(gt)||[];bt.push(zt),ce.set(gt,bt)}else{const zt=Fl(et.toString()),gt=vt.fontStack||Ft,bt=we[gt]=we[gt]||{};this.calculateGlyphDependencies(vt.text,bt,Gt,this.allowVerticalPlacement,zt)}}}if(_.get("symbol-placement")==="line"&&(this.features=function(ge){const be={},Ie={},Fe=[];let $e=0;function Ze(kt){Fe.push(ge[kt]),$e++}function et(kt,Ft,Gt){const vt=Ie[kt];return delete Ie[kt],Ie[Ft]=vt,Fe[vt].geometry[0].pop(),Fe[vt].geometry[0]=Fe[vt].geometry[0].concat(Gt[0]),vt}function St(kt,Ft,Gt){const vt=be[Ft];return delete be[Ft],be[kt]=vt,Fe[vt].geometry[0].shift(),Fe[vt].geometry[0]=Gt[0].concat(Fe[vt].geometry[0]),vt}function jt(kt,Ft,Gt){const vt=Gt?Ft[0][Ft[0].length-1]:Ft[0][0];return`${kt}:${vt.x}:${vt.y}`}for(let kt=0;kt<ge.length;kt++){const Ft=ge[kt],Gt=Ft.geometry,vt=Ft.text?Ft.text.toString():null;if(!vt){Ze(kt);continue}const zt=jt(vt,Gt),gt=jt(vt,Gt,!0);if(zt in Ie&&gt in be&&Ie[zt]!==be[gt]){const bt=St(zt,gt,Gt),qt=et(zt,gt,Fe[bt].geometry);delete be[zt],delete Ie[gt],Ie[jt(vt,Fe[qt].geometry,!0)]=qt,Fe[bt].geometry=null}else zt in Ie?et(zt,gt,Gt):gt in be?St(zt,gt,Gt):(Ze(kt),be[zt]=$e-1,Ie[gt]=$e-1)}return Fe.filter(kt=>kt.geometry)}(this.features)),_.get("symbol-elevation-reference")==="hd-road-markup"){if(this.elevationType="road",s.elevationFeatures){!this.elevationFeatures&&s.elevationFeatures.length>0&&(this.elevationFeatures=[],this.elevationFeatureIdToIndex=new Map);for(const ge of s.elevationFeatures)this.elevationFeatureIdToIndex.set(ge.id,this.elevationFeatures.length),this.elevationFeatures.push(ge)}}else _.get("symbol-z-elevate")&&(this.elevationType="offset");this.elevationType!=="none"&&(this.zOffsetBuffersNeedUpload=!0),this.sortFeaturesByKey&&this.features.sort((ge,be)=>ge.sortKey-be.sortKey)}update(t,s,u,h,m,_,S){this.text.programConfigurations.updatePaintArrays(t,s,m,u,h,_,S),this.icon.programConfigurations.updatePaintArrays(t,s,m,u,h,_,S)}updateRoadElevation(){if(this.elevationType!=="road"||!this.elevationFeatures||this.elevationStateComplete)return;this.elevationStateComplete=!0,this.hasAnyZOffset=!1;let t=!1;for(let s=0;s<this.symbolInstances.length;s++){const u=this.symbolInstances.get(s);if(u.elevationFeatureIndex===65535)continue;const h=this.elevationFeatures[u.elevationFeatureIndex];if(h){const m=.05+h.pointElevation(new Qt(u.tileAnchorX,u.tileAnchorY));u.zOffset!==m&&(t=!0,u.zOffset=m)}}t&&(this.zOffsetBuffersNeedUpload=!0,this.zOffsetSortDirty=!0)}updateZOffset(){const t=(m,_,S)=>{u+=_,u>m.length&&m.resize(u);for(let E=-_;E<0;E++)m.emplace(E+u,S)},s=(m,_,S)=>{h+=_,h>m.length&&m.resize(h);for(let E=-_;E<0;E++)m.emplace(E+h,S)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let u=0,h=0;for(let m=0;m<this.symbolInstances.length;m++){const _=this.symbolInstances.get(m),{numHorizontalGlyphVertices:S,numVerticalGlyphVertices:E,numIconVertices:A}=_,D=_.zOffset,O=A>0;if((S>0||E>0)&&(t(this.text.zOffsetVertexArray,S,D),t(this.text.zOffsetVertexArray,E,D)),O){const{placedIconSymbolIndex:F,verticalPlacedIconSymbolIndex:G}=_;F>=0&&s(this.icon.zOffsetVertexArray,A,D),G>=0&&s(this.icon.zOffsetVertexArray,_.numVerticalIconVertices,D)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=LI(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,s){const u=this.lineVertexArray.length;if(t.segment!==void 0)for(const{x:h,y:m}of s)this.lineVertexArray.emplaceBack(h,m);return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(t,s,u,h,m,_,S,E,A,D,O,F,G,W,Q,ae){const ce=t.indexArray,we=t.layoutVertexArray,ve=t.globeExtVertexArray,ee=t.segments.prepareSegment(4*s.length,we,ce,this.canOverlap?_.sortKey:void 0),ge=this.glyphOffsetArray.length,be=ee.vertexLength,Ie=this.allowVerticalPlacement&&S===dl.vertical?Math.PI/2:0,Fe=_.text&&_.text.sections;for(let Ze=0;Ze<s.length;Ze++){const{tl:et,tr:St,bl:jt,br:kt,texPrimary:Ft,texSecondary:Gt,pixelOffsetTL:vt,pixelOffsetBR:zt,minFontScaleX:gt,minFontScaleY:bt,glyphOffset:qt,isSDF:Kt,sectionIndex:En}=s[Ze],_n=ee.vertexLength,sn=qt[1];if(Px(we,A.x,A.y,et.x,sn+et.y,Ft.x,Ft.y,u,Kt,vt.x,vt.y,gt,bt),Px(we,A.x,A.y,St.x,sn+St.y,Ft.x+Ft.w,Ft.y,u,Kt,zt.x,vt.y,gt,bt),Px(we,A.x,A.y,jt.x,sn+jt.y,Ft.x,Ft.y+Ft.h,u,Kt,vt.x,zt.y,gt,bt),Px(we,A.x,A.y,kt.x,sn+kt.y,Ft.x+Ft.w,Ft.y+Ft.h,u,Kt,zt.x,zt.y,gt,bt),E){const{x:Wt,y:Wn,z:wn}=E.anchor,[Sn,$n,Jn]=E.up;Rx(ve,Wt,Wn,wn,Sn,$n,Jn),Rx(ve,Wt,Wn,wn,Sn,$n,Jn),Rx(ve,Wt,Wn,wn,Sn,$n,Jn),Rx(ve,Wt,Wn,wn,Sn,$n,Jn),Mx(t.dynamicLayoutVertexArray,Wt,Wn,wn,Ie)}else Mx(t.dynamicLayoutVertexArray,A.x,A.y,A.z,Ie);if(ae){const Wt=Gt||Ft;Ax(t.iconTransitioningVertexArray,Wt.x,Wt.y),Ax(t.iconTransitioningVertexArray,Wt.x+Wt.w,Wt.y),Ax(t.iconTransitioningVertexArray,Wt.x,Wt.y+Wt.h),Ax(t.iconTransitioningVertexArray,Wt.x+Wt.w,Wt.y+Wt.h)}ce.emplaceBack(_n,_n+1,_n+2),ce.emplaceBack(_n+1,_n+2,_n+3),ee.vertexLength+=4,ee.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(qt[0]),Ze!==s.length-1&&En===s[Ze+1].sectionIndex||t.programConfigurations.populatePaintArrays(we.length,_,_.index,{},G,W,Q,Fe&&Fe[En])}const $e=E?E.anchor:A;t.placedSymbolArray.emplaceBack($e.x,$e.y,$e.z,A.x,A.y,ge,this.glyphOffsetArray.length-ge,be,D,O,A.segment,u?u[0]:0,u?u[1]:0,h[0],h[1],S,0,0,0,F,0)}_commitLayoutVertex(t,s,u,h,m,_,S){t.emplaceBack(s,u,h,m,_,Math.round(S.x),Math.round(S.y))}_addCollisionDebugVertices(t,s,u,h,m,_,S){const E=u.segments.prepareSegment(4,u.layoutVertexArray,u.indexArray),A=E.vertexLength,D=S.tileAnchorX,O=S.tileAnchorY;for(let G=0;G<4;G++)u.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(u.collisionVertexArrayExt,s,t.padding,S.zOffset),this._commitLayoutVertex(u.layoutVertexArray,h,m,_,D,O,new Qt(t.x1,t.y1)),this._commitLayoutVertex(u.layoutVertexArray,h,m,_,D,O,new Qt(t.x2,t.y1)),this._commitLayoutVertex(u.layoutVertexArray,h,m,_,D,O,new Qt(t.x2,t.y2)),this._commitLayoutVertex(u.layoutVertexArray,h,m,_,D,O,new Qt(t.x1,t.y2)),E.vertexLength+=4;const F=u.indexArray;F.emplaceBack(A,A+1),F.emplaceBack(A+1,A+2),F.emplaceBack(A+2,A+3),F.emplaceBack(A+3,A),E.primitiveLength+=4}_addTextDebugCollisionBoxes(t,s,u,h,m,_){for(let S=h;S<m;S++){const E=u.get(S),A=this.getSymbolInstanceTextSize(t,_,s,S);this._addCollisionDebugVertices(E,A,this.textCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,_)}}_addIconDebugCollisionBoxes(t,s,u,h,m,_){for(let S=h;S<m;S++){const E=u.get(S),A=this.getSymbolInstanceIconSize(t,s,_.placedIconSymbolIndex);this._addCollisionDebugVertices(E,A,this.iconCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,_)}}generateCollisionDebugBuffers(t,s,u){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Wb(cf,qE.members,ol),this.iconCollisionBox=new Wb(cf,qE.members,ol);const h=xy(this.iconSizeData,t),m=xy(this.textSizeData,t,u);for(let _=0;_<this.symbolInstances.length;_++){const S=this.symbolInstances.get(_);this._addTextDebugCollisionBoxes(m,t,s,S.textBoxStartIndex,S.textBoxEndIndex,S),this._addTextDebugCollisionBoxes(m,t,s,S.verticalTextBoxStartIndex,S.verticalTextBoxEndIndex,S),this._addIconDebugCollisionBoxes(h,t,s,S.iconBoxStartIndex,S.iconBoxEndIndex,S),this._addIconDebugCollisionBoxes(h,t,s,S.verticalIconBoxStartIndex,S.verticalIconBoxEndIndex,S)}}getSymbolInstanceTextSize(t,s,u,h){const m=this.text.placedSymbolArray.get(s.rightJustifiedTextSymbolIndex>=0?s.rightJustifiedTextSymbolIndex:s.centerJustifiedTextSymbolIndex>=0?s.centerJustifiedTextSymbolIndex:s.leftJustifiedTextSymbolIndex>=0?s.leftJustifiedTextSymbolIndex:s.verticalPlacedTextSymbolIndex>=0?s.verticalPlacedTextSymbolIndex:h),_=Nb(this.textSizeData,t,m)/mo;return this.tilePixelRatio*_}getSymbolInstanceIconSize(t,s,u){const h=this.icon.placedSymbolArray.get(u),m=Nb(this.iconSizeData,t,h);return this.tilePixelRatio*m}_commitDebugCollisionVertexUpdate(t,s,u,h){t.emplaceBack(s,-u,-u,h),t.emplaceBack(s,u,-u,h),t.emplaceBack(s,u,u,h),t.emplaceBack(s,-u,u,h)}_updateTextDebugCollisionBoxes(t,s,u,h,m,_,S){for(let E=h;E<m;E++){const A=u.get(E),D=this.getSymbolInstanceTextSize(t,_,s,E);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,D,A.padding,_.zOffset)}}_updateIconDebugCollisionBoxes(t,s,u,h,m,_,S){for(let E=h;E<m;E++){const A=u.get(E),D=this.getSymbolInstanceIconSize(t,s,_.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,D,A.padding,_.zOffset)}}updateCollisionDebugBuffers(t,s,u,h){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const m=xy(this.iconSizeData,t,h),_=xy(this.textSizeData,t,u);for(let S=0;S<this.symbolInstances.length;S++){const E=this.symbolInstances.get(S);this._updateTextDebugCollisionBoxes(_,t,s,E.textBoxStartIndex,E.textBoxEndIndex,E,u),this._updateTextDebugCollisionBoxes(_,t,s,E.verticalTextBoxStartIndex,E.verticalTextBoxEndIndex,E,u),this._updateIconDebugCollisionBoxes(m,t,s,E.iconBoxStartIndex,E.iconBoxEndIndex,E,h),this._updateIconDebugCollisionBoxes(m,t,s,E.verticalIconBoxStartIndex,E.verticalIconBoxEndIndex,E,h)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,s,u,h,m,_,S,E,A){const D={};if(s<u){const{x1:O,y1:F,x2:G,y2:W,padding:Q,projectedAnchorX:ae,projectedAnchorY:ce,projectedAnchorZ:we,tileAnchorX:ve,tileAnchorY:ee,featureIndex:ge}=t.get(s);D.textBox={x1:O,y1:F,x2:G,y2:W,padding:Q,projectedAnchorX:ae,projectedAnchorY:ce,projectedAnchorZ:we,tileAnchorX:ve,tileAnchorY:ee},D.textFeatureIndex=ge}if(h<m){const{x1:O,y1:F,x2:G,y2:W,padding:Q,projectedAnchorX:ae,projectedAnchorY:ce,projectedAnchorZ:we,tileAnchorX:ve,tileAnchorY:ee,featureIndex:ge}=t.get(h);D.verticalTextBox={x1:O,y1:F,x2:G,y2:W,padding:Q,projectedAnchorX:ae,projectedAnchorY:ce,projectedAnchorZ:we,tileAnchorX:ve,tileAnchorY:ee},D.verticalTextFeatureIndex=ge}if(_<S){const{x1:O,y1:F,x2:G,y2:W,padding:Q,projectedAnchorX:ae,projectedAnchorY:ce,projectedAnchorZ:we,tileAnchorX:ve,tileAnchorY:ee,featureIndex:ge}=t.get(_);D.iconBox={x1:O,y1:F,x2:G,y2:W,padding:Q,projectedAnchorX:ae,projectedAnchorY:ce,projectedAnchorZ:we,tileAnchorX:ve,tileAnchorY:ee},D.iconFeatureIndex=ge}if(E<A){const{x1:O,y1:F,x2:G,y2:W,padding:Q,projectedAnchorX:ae,projectedAnchorY:ce,projectedAnchorZ:we,tileAnchorX:ve,tileAnchorY:ee,featureIndex:ge}=t.get(E);D.verticalIconBox={x1:O,y1:F,x2:G,y2:W,padding:Q,projectedAnchorX:ae,projectedAnchorY:ce,projectedAnchorZ:we,tileAnchorX:ve,tileAnchorY:ee},D.verticalIconFeatureIndex=ge}return D}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const u=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(t,s){const u=t.placedSymbolArray.get(s),h=u.vertexStartIndex+4*u.numGlyphs;for(let m=u.vertexStartIndex;m<h;m+=4)t.indexArray.emplaceBack(m,m+1,m+2),t.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(t),u=Math.cos(t),h=[],m=[],_=[];for(let S=0;S<this.symbolInstances.length;++S){_.push(S);const E=this.symbolInstances.get(S);h.push(0|Math.round(s*E.tileAnchorX+u*E.tileAnchorY)),m.push(E.featureIndex)}return _.sort((S,E)=>h[S]-h[E]||m[E]-m[S]),_}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let t=0;t<this.symbolInstances.length;++t)this.symbolInstanceIndexesSortedZOffset.push(t)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((t,s)=>this.symbolInstances.get(s).zOffset-this.symbolInstances.get(t).zOffset)}addToSortKeyRanges(t,s){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===s?u.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const u=this.symbolInstances.get(s);this.featureSortOrder.push(u.featureIndex);const{rightJustifiedTextSymbolIndex:h,centerJustifiedTextSymbolIndex:m,leftJustifiedTextSymbolIndex:_,verticalPlacedTextSymbolIndex:S,placedIconSymbolIndex:E,verticalPlacedIconSymbolIndex:A}=u;h>=0&&this.addIndicesForPlacedSymbol(this.text,h),m>=0&&m!==h&&this.addIndicesForPlacedSymbol(this.text,m),_>=0&&_!==m&&_!==h&&this.addIndicesForPlacedSymbol(this.text,_),S>=0&&this.addIndicesForPlacedSymbol(this.text,S),E>=0&&this.addIndicesForPlacedSymbol(this.icon,E),A>=0&&this.addIndicesForPlacedSymbol(this.icon,A)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let DI,kI,qb;un(Lx,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Lx.addDynamicAttributes=Mx;class OI{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:ac,this.defaultValue=t}evaluate(t){if(t.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(t.formattedSection))return s.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}un(OI,"FormatSectionOverride",{omit:["defaultValue"]});const Zb=()=>qb||(qb={layout:DI||(DI=new $i({"symbol-placement":new Xt(ut.layout_symbol["symbol-placement"]),"symbol-spacing":new Xt(ut.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Xt(ut.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new fn(ut.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Xt(ut.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Xt(ut.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new Xt(ut.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new Xt(ut.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Xt(ut.layout_symbol["icon-ignore-placement"]),"icon-optional":new Xt(ut.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Xt(ut.layout_symbol["icon-rotation-alignment"]),"icon-size":new fn(ut.layout_symbol["icon-size"]),"icon-size-scale-range":new Xt(ut.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new fn(ut.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new fn(ut.layout_symbol["icon-text-fit-padding"]),"icon-image":new fn(ut.layout_symbol["icon-image"]),"icon-rotate":new fn(ut.layout_symbol["icon-rotate"]),"icon-padding":new Xt(ut.layout_symbol["icon-padding"]),"icon-keep-upright":new Xt(ut.layout_symbol["icon-keep-upright"]),"icon-offset":new fn(ut.layout_symbol["icon-offset"]),"icon-anchor":new fn(ut.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Xt(ut.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Xt(ut.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Xt(ut.layout_symbol["text-rotation-alignment"]),"text-field":new fn(ut.layout_symbol["text-field"]),"text-font":new fn(ut.layout_symbol["text-font"]),"text-size":new fn(ut.layout_symbol["text-size"]),"text-size-scale-range":new Xt(ut.layout_symbol["text-size-scale-range"]),"text-max-width":new fn(ut.layout_symbol["text-max-width"]),"text-line-height":new fn(ut.layout_symbol["text-line-height"]),"text-letter-spacing":new fn(ut.layout_symbol["text-letter-spacing"]),"text-justify":new fn(ut.layout_symbol["text-justify"]),"text-radial-offset":new fn(ut.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Xt(ut.layout_symbol["text-variable-anchor"]),"text-anchor":new fn(ut.layout_symbol["text-anchor"]),"text-max-angle":new Xt(ut.layout_symbol["text-max-angle"]),"text-writing-mode":new Xt(ut.layout_symbol["text-writing-mode"]),"text-rotate":new fn(ut.layout_symbol["text-rotate"]),"text-padding":new Xt(ut.layout_symbol["text-padding"]),"text-keep-upright":new Xt(ut.layout_symbol["text-keep-upright"]),"text-transform":new fn(ut.layout_symbol["text-transform"]),"text-offset":new fn(ut.layout_symbol["text-offset"]),"text-allow-overlap":new Xt(ut.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Xt(ut.layout_symbol["text-ignore-placement"]),"text-optional":new Xt(ut.layout_symbol["text-optional"]),visibility:new Xt(ut.layout_symbol.visibility)})),paint:kI||(kI=new $i({"icon-opacity":new fn(ut.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new fn(ut.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new fn(ut.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new fn(ut.paint_symbol["text-emissive-strength"]),"icon-color":new fn(ut.paint_symbol["icon-color"]),"icon-halo-color":new fn(ut.paint_symbol["icon-halo-color"]),"icon-halo-width":new fn(ut.paint_symbol["icon-halo-width"]),"icon-halo-blur":new fn(ut.paint_symbol["icon-halo-blur"]),"icon-translate":new Xt(ut.paint_symbol["icon-translate"]),"icon-translate-anchor":new Xt(ut.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Xt(ut.paint_symbol["icon-image-cross-fade"]),"text-opacity":new fn(ut.paint_symbol["text-opacity"]),"text-occlusion-opacity":new fn(ut.paint_symbol["text-occlusion-opacity"]),"text-color":new fn(ut.paint_symbol["text-color"],{runtimeType:wo,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new fn(ut.paint_symbol["text-halo-color"]),"text-halo-width":new fn(ut.paint_symbol["text-halo-width"]),"text-halo-blur":new fn(ut.paint_symbol["text-halo-blur"]),"text-translate":new Xt(ut.paint_symbol["text-translate"]),"text-translate-anchor":new Xt(ut.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Xt(ut.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Xt(ut.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Xt(ut.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Xt(ut.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new fn(ut.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"})}))},qb);class Dx extends po{constructor(t,s,u,h){super(t,Zb(),s,u,h),this._colorAdjustmentMatrix=Z([]),this.hasInitialOcclusionOpacityProperties=t.paint!==void 0&&("icon-occlusion-opacity"in t.paint||"text-occlusion-opacity"in t.paint)}recalculate(t,s){super.recalculate(t,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const u=this.layout.get("text-writing-mode");if(u){const h=[];for(const m of u)h.indexOf(m)<0&&h.push(m);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(t,s,u,h){return this._saturation===t&&this._contrast===s&&this._brightnessMin===u&&this._brightnessMax===h||(this._colorAdjustmentMatrix=function(m,_,S,E){m=ms(m),_=$s(_);const A=X(),D=m/3,O=1-2*D,F=[O,D,D,0,D,O,D,0,D,D,O,0,0,0,0,1],G=.5-.5*_,W=E-S;return le(A,[W,0,0,0,0,W,0,0,0,0,W,0,S,S,S,1],[_,0,0,0,0,_,0,0,0,0,_,0,G,G,G,1]),le(A,A,F),A}(t,s,u,h),this._saturation=t,this._contrast=s,this._brightnessMin=u,this._brightnessMax=h),this._colorAdjustmentMatrix}getValueAndResolveTokens(t,s,u,h){const m=this.layout.get(t).evaluate(s,{},u,h),_=this._unevaluatedLayout._values[t];return _.isDataDriven()||qu(_.value)||!m?m:function(S,E){return E.replace(/{([^{}]+)}/g,(A,D)=>D in S?String(S[D]):"")}(s.properties,m)}createBucket(t){return new Lx(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of Zb().paint.overridableProperties){if(!Dx.hasPaintOverride(this.layout,t))continue;const s=this.paint.get(t),u=new OI(s),h=new Wu(u,s.property.specification,this.scope,this.options);let m=null;m=s.value.kind==="constant"||s.value.kind==="source"?new Qc("source",h):new rl("composite",h,s.value.zoomStops,s.value.interpolationType),this.paint._values[t]=new Sc(s.property,m,s.parameters)}}_handleOverridablePaintPropertyUpdate(t,s,u){return!(!this.layout||s.isDataDriven()||u.isDataDriven())&&Dx.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,s){const u=t.get("text-field"),h=Zb().paint.properties[s];let m=!1;const _=S=>{for(const E of S)if(h.overrides&&h.overrides.hasOverride(E))return void(m=!0)};if(u.value.kind==="constant"&&u.value.value instanceof Oo)_(u.value.value.sections);else if(u.value.kind==="source"){const S=A=>{m||(A instanceof or&&ks(A.value)===kh?_(A.value.sections):A instanceof zu?_(A.sections):A.eachChild(S))},E=u.value;E._styleExpression&&S(E._styleExpression.expression)}return m}getProgramIds(){return["symbol"]}getDefaultProgramParams(t,s,u){return{config:new Gl(this,{zoom:s,lut:u}),overrideFog:!1}}hasElevation(){return this.layout&&this.layout.get("symbol-elevation-reference")==="hd-road-markup"}}let zI,FI,NI,jI;var Xb=Vr([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function Kb(a){switch(a){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function Yb(a){switch(a){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class Jb{constructor(t,s,u,h){this.context=t,this.format=u,this.useMipmap=h&&h.useMipmap,this.texture=t.gl.createTexture(),this.update(s,{premultiply:h&&h.premultiply})}update(t,s){const u=t&&t instanceof HTMLVideoElement&&t.width===0?t.videoWidth:t.width,h=t&&t instanceof HTMLVideoElement&&t.height===0?t.videoHeight:t.height,{context:m}=this,{gl:_}=m,{x:S,y:E}=s&&s.position?s.position:{x:0,y:0},A=S+u,D=E+h;!this.size||this.size[0]===A&&this.size[1]===D||(_.bindTexture(_.TEXTURE_2D,null),_.deleteTexture(this.texture),this.texture=_.createTexture(),this.size=null),_.bindTexture(_.TEXTURE_2D,this.texture),m.pixelStoreUnpackFlipY.set(!1),m.pixelStoreUnpack.set(1),m.pixelStoreUnpackPremultiplyAlpha.set(this.format===_.RGBA8&&(!s||s.premultiply!==!1));const O=t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||ImageBitmap&&t instanceof ImageBitmap;if(!this.size&&A>0&&D>0){const F=this.useMipmap?Math.floor(Math.log2(Math.max(A,D)))+1:1;_.texStorage2D(_.TEXTURE_2D,F,this.format,A,D),this.size=[A,D]}if(this.size)if(O)_.texSubImage2D(_.TEXTURE_2D,0,S,E,Kb(this.format),Yb(this.format),t);else{const F=t.data;F&&_.texSubImage2D(_.TEXTURE_2D,0,S,E,u,h,Kb(this.format),Yb(this.format),F)}this.useMipmap&&_.generateMipmap(_.TEXTURE_2D)}bind(t,s,u=!1){const{context:h}=this,{gl:m}=h;m.bindTexture(m.TEXTURE_2D,this.texture),t!==this.minFilter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,t),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,this.useMipmap&&!u?t===m.NEAREST?m.NEAREST_MIPMAP_NEAREST:m.LINEAR_MIPMAP_LINEAR:t),this.minFilter=t),s!==this.wrapS&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,s),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,s),this.wrapS=s)}bindExtraParam(t,s,u,h){const{context:m}=this,{gl:_}=m;_.bindTexture(_.TEXTURE_2D,this.texture),s!==this.magFilter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,s),this.magFilter=s),t!==this.minFilter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,this.useMipmap?t===_.NEAREST?_.NEAREST_MIPMAP_NEAREST:_.LINEAR_MIPMAP_LINEAR:t),this.minFilter=t),u!==this.wrapS&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,u),this.wrapS=u),h!==this.wrapT&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,h),this.wrapT=h)}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class kx{constructor(t,s){this.context=t,this.texture=s}bind(t,s){const{context:u}=this,{gl:h}=u;h.bindTexture(h.TEXTURE_2D,this.texture),t!==this.minFilter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,t),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,t),this.minFilter=t),s!==this.wrapS&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,s),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,s),this.wrapS=s)}}function Ox(a,t,s,u,h,m,_,S){const E=[a,t,1,s,u,1,h,m,1],A=[_,S,1],D=U([],E),[O,F,G]=cr(A,A,D);return K(E,E,[O,0,0,0,F,0,0,0,G])}function BI(a,t,s,u,h,m,_,S){const E=function(A,D,O,F,G,W,Q,ae){const ce=Ox(0,0,1,0,1,1,0,1),we=Ox(A,D,O,F,G,W,Q,ae);return K(we,we,U([],ce))}(a,t,s,u,h,m,_,S);return[E[2]/E[8]/en,E[5]/E[8]/en]}function zx(a){return[a[0],Math.min(Math.max(a[1],-85.051129),rt)]}class VI extends Il{constructor(t,s,u,h){super(),this.id=t,this.dispatcher=u,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(h),this.options=s,this._dirty=!1}load(t,s){if(this._loaded=s||!1,this.fire(new Tl("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return t&&(this.coordinates=t),this._loaded=!0,void this._finishLoading();this._imageRequest=bd(this.map._requestManager.transformRequest(this.url,jc.Image),(u,h)=>{this._imageRequest=null,this._loaded=!0,u?this.fire(new Nf(u)):h&&(this.image=h instanceof HTMLImageElement?sa.getImageData(h):h,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,t&&(this.coordinates=t),this._finishLoading())})}loaded(){return this._loaded}updateImage(t){return t.url?(this._imageRequest&&t.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=t.url,this.load(t.coordinates,this._loaded),this):this}setTexture(t){if(!(t.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new kx(this.map.painter.context,t.handle),this.width=t.dimensions[0],this.height=t.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Tl("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(t){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof kx||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(t){if(this.coordinates=t,this._boundsArray=void 0,this._unsupportedCoords=!1,!t.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let s=t[0][1],u=t[0][1];for(const m of t)m[1]>u&&(u=m[1]),m[1]<s&&(s=m[1]);const h=(u+s)/2;if(h>rt?this.onNorthPole=!0:h<-85.051129&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const m=t.map(dt.fromLngLat);this.tileID=function(_){let S=1/0,E=1/0,A=-1/0,D=-1/0;for(const Q of _)S=Math.min(S,Q.x),E=Math.min(E,Q.y),A=Math.max(A,Q.x),D=Math.max(D,Q.y);const O=Math.max(A-S,D-E),F=Math.max(0,Math.floor(-Math.log(O)/Math.LN2)),G=Math.pow(2,F);let W=Math.floor((S+A)/2*G);return W>1&&(W-=1),new br(F,W,Math.floor((E+D)/2*G))}(m),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Tl("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(t){for(const ce in this.tiles){const we=this.tiles[ce];we.state!=="loaded"&&(we.state="loaded",we.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const s=Sy(new br(0,0,0),this.map.transform.projection),u=[s.projection.project(this.coordinates[0][0],this.coordinates[0][1]),s.projection.project(this.coordinates[1][0],this.coordinates[1][1]),s.projection.project(this.coordinates[2][0],this.coordinates[2][1]),s.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(ce){const we=ce[1].x-ce[0].x,ve=ce[1].y-ce[0].y,ee=ce[2].x-ce[1].x,ge=ce[2].y-ce[1].y,be=ce[3].x-ce[2].x,Ie=ce[3].y-ce[2].y,Fe=ce[0].x-ce[3].x,$e=ce[0].y-ce[3].y,Ze=we*ge-ee*ve,et=ee*Ie-be*ge,St=be*$e-Fe*Ie,jt=Fe*ve-we*$e;return Ze>0&&et>0&&St>0&&jt>0||Ze<0&&et<0&&St<0&&jt<0}(u))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const h=Sy(this.tileID,this.map.transform.projection),[m,_,S,E]=this.coordinates.map(ce=>{const we=h.projection.project(ce[0],ce[1]);return II(h,we)._round()});this.perspectiveTransform=BI(m.x,m.y,_.x,_.y,S.x,S.y,E.x,E.y);const A=this._boundsArray=new ou;A.emplaceBack(m.x,m.y,0,0),A.emplaceBack(_.x,_.y,en,0),A.emplaceBack(E.x,E.y,0,en),A.emplaceBack(S.x,S.y,en,en),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=t.createVertexBuffer(A,Xb.members),this.boundsSegments=ki.simpleSegment(0,0,4,2);const D=[],O=[zx((F=this.coordinates)[0]),zx(F[1]),zx(F[2]),zx(F[3])];var F;const[G,W,Q,ae]=function(ce){let we=ce[0][0],ve=we,ee=ce[0][1],ge=ee;for(let be=1;be<ce.length;be++)ce[be][0]<we?we=ce[be][0]:ce[be][0]>ve&&(ve=ce[be][0]),ce[be][1]<ee?ee=ce[be][1]:ce[be][1]>ge&&(ge=ce[be][1]);return[we,ee,ve-we,ge-ee]}(O);{const ce=new ou,[we,ve,ee,ge]=function(vt){let zt=vt[0].x,gt=zt,bt=vt[0].y,qt=bt;for(let Kt=1;Kt<vt.length;Kt++)vt[Kt].x<zt?zt=vt[Kt].x:vt[Kt].x>gt&&(gt=vt[Kt].x),vt[Kt].y<bt?bt=vt[Kt].y:vt[Kt].y>qt&&(qt=vt[Kt].y);return[zt,bt,gt-zt,qt-bt]}(u),be=vt=>[(vt.x-we)/ee,(vt.y-ve)/ge],[Ie,Fe,$e,Ze]=u.map(be),et=function(vt,zt,gt,bt,qt,Kt,En,_n){const sn=Ox(0,0,1,0,1,1,0,1);return K(sn,sn,U([],Ox(vt,zt,gt,bt,qt,Kt,En,_n)))}(Ie[0],Ie[1],Fe[0],Fe[1],$e[0],$e[1],Ze[0],Ze[1]);this.elevatedGlobePerspectiveTransform=BI(Ie[0],Ie[1],Fe[0],Fe[1],$e[0],$e[1],Ze[0],Ze[1]);const St=(vt,zt)=>{D.push(vt.lng);const gt=Math.round((vt.lng-G)/Q*en),bt=Math.round((vt.lat-W)/ae*en),qt=be(zt),Kt=cr([],[qt[0],qt[1],1],et),En=Math.round(Kt[0]/Kt[2]*en),_n=Math.round(Kt[1]/Kt[2]*en);ce.emplaceBack(gt,bt,En,_n)},jt=u[3].x-u[0].x,kt=u[3].y-u[0].y,Ft=u[2].x-u[1].x,Gt=u[2].y-u[1].y;for(let vt=0;vt<65;vt++){const zt=vt/64,gt=[u[0].x+zt*jt,u[0].y+zt*kt],bt=[u[1].x+zt*Ft,u[1].y+zt*Gt],qt=bt[0]-gt[0],Kt=bt[1]-gt[1];for(let En=0;En<65;En++){const _n=En/64,sn={x:gt[0]+qt*_n,y:gt[1]+Kt*_n};St(s.projection.unproject(sn.x,sn.y),sn)}}this.elevatedGlobeVertexBuffer=t.createVertexBuffer(ce,Xb.members)}{this.maxLongitudeTriangleSize=0;let ce=[],we=new gs;const ve=(ee,ge,be)=>{we.emplaceBack(ee,ge,be);const Ie=D[ee],Fe=D[ge],$e=D[be],Ze=Math.min(Math.min(Ie,Fe),$e),et=Math.max(Math.max(Ie,Fe),$e)-Ze;et>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=et),ce.push(Ze+et/2)};for(let ee=0;ee<64;ee++)for(let ge=0;ge<64;ge++){const be=65*ee+ge,Ie=be+1,Fe=be+65,$e=Fe+1;ve(be,Fe,Ie),ve(Ie,Fe,$e)}[ce,we]=function(ee,ge){const be=Array.from({length:ee.length},($e,Ze)=>Ze);be.sort(($e,Ze)=>ee[$e]-ee[Ze]);const Ie=[],Fe=new gs;for(let $e=0;$e<be.length;$e++){const Ze=be[$e];Ie.push(ee[Ze]);const et=3*Ze,St=et+1;Fe.emplaceBack(ge.uint16[et],ge.uint16[St],ge.uint16[St+1])}return[Ie,Fe]}(ce,we),this.elevatedGlobeTrianglesCenterLongitudes=ce,this.elevatedGlobeIndexBuffer=t.createIndexBuffer(we)}this.elevatedGlobeSegments=ki.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,Q/en,0,ae/en,0,0,W,G,0])}prepare(){const t=Object.keys(this.tiles).length!==0;if(this.tileID&&!t)return;const s=this.map.painter.context,u=s.gl;!this._dirty||this.texture instanceof kx||(this.texture?this.texture.update(this.image):(this.texture=new Jb(s,this.image,u.RGBA8),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this._dirty=!1),t&&this._prepareData(s)}loadTile(t,s){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},s(null)):(t.state="errored",s(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(t){const s=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!s)return null;const u=this.elevatedGlobeTrianglesCenterLongitudes;let h=(m=t+180)+360*Math.round((u[0]-m)/360);var m;const _=new ki,S=(O,F)=>{_.segments.push({vertexOffset:0,primitiveOffset:O,vertexLength:s.segments[0].vertexLength,primitiveLength:F,sortKey:void 0,vaos:{}})},E=.51*this.maxLongitudeTriangleSize;if(Math.abs(u[0]-h)<=E){const O=vl(u,0,u.length,h+E);return O===u.length||S(O,eo(u,O+1,u.length,h+360-E)-O),_}h<u[0]&&(h+=360);const A=eo(u,0,u.length,h-E);if(A===u.length)return S(0,u.length),_;S(0,A-0);const D=vl(u,A+1,u.length,h+E);return D!==u.length&&S(D,u.length-D),_}}const _j=(Math.pow(256,2)-1)/16907520;class UI extends po{constructor(t,s,u,h){super(t,{layout:NI||(NI=new $i({visibility:new Xt(ut.layout_raster.visibility)})),paint:jI||(jI=new $i({"raster-opacity":new Xt(ut.paint_raster["raster-opacity"]),"raster-color":new zs(ut.paint_raster["raster-color"]),"raster-color-mix":new Xt(ut.paint_raster["raster-color-mix"]),"raster-color-range":new Xt(ut.paint_raster["raster-color-range"]),"raster-hue-rotate":new Xt(ut.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Xt(ut.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Xt(ut.paint_raster["raster-brightness-max"]),"raster-saturation":new Xt(ut.paint_raster["raster-saturation"]),"raster-contrast":new Xt(ut.paint_raster["raster-contrast"]),"raster-resampling":new Xt(ut.paint_raster["raster-resampling"]),"raster-fade-duration":new Xt(ut.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Xt(ut.paint_raster["raster-emissive-strength"]),"raster-array-band":new Xt(ut.paint_raster["raster-array-band"]),"raster-elevation":new Xt(ut.paint_raster["raster-elevation"]),"raster-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"})}))},s,u,h),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(t){return!(t&&t._source instanceof VI&&(t._source.onNorthPole||t._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(t){t!=="raster-color"&&t!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(t){if(!this.hasColorMap()||!this._curRampRange)return;const s=this._transitionablePaint._values["raster-color"].value.expression,[u,h]=t||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(u)&&isNaN(h)||u===this._curRampRange[0]&&h===this._curRampRange[1]||(this.colorRamp=Rr({expression:s,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:u,end:h}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[u,h])}}let $I,HI,GI,WI,qI;class ZI extends po{constructor(t,s,u,h){super(t,{layout:$I||($I=new $i({visibility:new Xt(ut["layout_raster-particle"].visibility)})),paint:HI||(HI=new $i({"raster-particle-array-band":new Xt(ut["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Xt(ut["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new zs(ut["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Xt(ut["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Xt(ut["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Xt(ut["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Xt(ut["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new Xt(ut["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"})}))},s,u,h),this._updateColorRamp(),this.lastInvalidatedAt=sa.now()}onRemove(t){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(t){return!1}_handleSpecialPaintPropertyUpdate(t){t!=="raster-particle-color"&&t!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),t==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const t=this._transitionablePaint._values["raster-particle-color"].value.expression,s=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=Rr({expression:t,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:s}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=sa.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class yj extends po{constructor(t,s){super(t,{},s,null),this.implementation=t,t.slot&&(this.slot=t.slot)}is3D(t){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(t){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}function Qb(a,t,s){const u=[0,0,1],h=Or([]);return Zi(h,h,s?-ie(a)+Math.PI:ie(a)),is(h,h,-ie(t)),Nn(u,u,h),We(u,u)}function XI(a,t){const s=Fx(a.projection,a.zoom,a.width,a.height),u=function(m,_,S,E,A){const D=new ne(S.lng-180*Ep,S.lat),O=new ne(S.lng+180*Ep,S.lat),F=m.project(D.lng,D.lat),G=m.project(O.lng,O.lat),W=-Math.atan2(G.y-F.y,G.x-F.x),Q=dt.fromLngLat(S);Q.y=Xe(Q.y,-1+Ep,1-Ep);const ae=Q.toLngLat(),ce=m.project(ae.lng,ae.lat),we=dt.fromLngLat(ae);we.x+=Ep;const ve=we.toLngLat(),ee=m.project(ve.lng,ve.lat),ge=YI(ee.x-ce.x,ee.y-ce.y,W),be=dt.fromLngLat(ae);be.y+=Ep;const Ie=be.toLngLat(),Fe=m.project(Ie.lng,Ie.lat),$e=YI(Fe.x-ce.x,Fe.y-ce.y,W),Ze=Math.abs(ge.x)/Math.abs($e.y),et=Z([]);xe(et,et,-W*(1-(A?0:E)));const St=Z([]);return ue(St,St,[1,1-(1-Ze)*E,1]),St[4]=-$e.x/$e.y*E,xe(St,St,W),le(St,et,St),St}(a.projection,0,a.center,s,t),h=KI(a);return ue(u,u,[h,h,1]),u}function KI(a){const t=a.projection,s=Fx(a.projection,a.zoom,a.width,a.height),u=ew(t,a.center),h=ew(t,ne.convert(t.center));return Math.pow(2,u*s+(1-s)*h)}function Fx(a,t,s,u,h=1/0){const m=a.range;if(!m)return 0;const _=Math.min(h,Math.max(s,u)),S=Math.log(_/1024)/Math.LN2;return Ke(m[0]+S,m[1]+S,t)}const Ep=1/4e4;function ew(a,t){const s=Xe(t.lat,-85.051129,rt),u=new ne(t.lng-180*Ep,s),h=new ne(t.lng+180*Ep,s),m=a.project(u.lng,s),_=a.project(h.lng,s),S=dt.fromLngLat(u),E=dt.fromLngLat(h),A=_.x-m.x,D=_.y-m.y,O=E.x-S.x,F=E.y-S.y,G=Math.sqrt((O*O+F*F)/(A*A+D*D));return Math.log(G)/Math.LN2}function YI(a,t,s){const u=Math.cos(s),h=Math.sin(s);return{x:a*u-t*h,y:a*h+t*u}}function JI(a,t,s){Z(a),xe(a,a,ie(t[2])),pe(a,a,ie(t[0])),he(a,a,ie(t[1])),ue(a,a,s),le(a,a,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function Nx(a,t,s,u,h,m,_,S){const E=[s[0]-t[0],s[1]-t[1],0],A=[u[0]-t[0],u[1]-t[1],0];if(_t(E)<1e-12||_t(A)<1e-12)return Or(a);const D=Bt([],E,A);We(D,D),at(A,u,t),E[2]=(m-h)*S,A[2]=(_-h)*S;const O=E;return Bt(O,E,A),We(O,O),us(a,D,O)}function tw(a,t,s=!1){const u=ch(t.zoom),h=function(m,_,S){const E=_.worldSize,A=[m[12],m[13],m[14]],D=Ne(A[1]/E),O=Oe(A[0]/E),F=Z([]),G=Pe(1,D)*E,W=Pe(1,0)*E*It(D,_.zoom),Q=1/xp(E);let ae=W*Q;if(S){const ee=Fx(_.projection,_.zoom,_.width,_.height,1024);ae=Q*_.projection.pixelSpaceConversion(_.center.lat,E,ee)}const ce=re(D,O);Ge(ce,ce,ct([],We([],ce),G*ae*A[2]));const we=function(ee){const ge=[ee[0],ee[1],ee[2]];let be=[0,1,0];const Ie=Bt([],be,ge);return Bt(be,ge,Ie),At(be)===0&&(be=[0,1,0],Bt(Ie,ge,be)),We(Ie,Ie),We(be,be),We(ge,ge),[Ie[0],Ie[1],Ie[2],0,be[0],be[1],be[2],0,ge[0],ge[1],ge[2],0,ee[0],ee[1],ee[2],1]}(ce);ue(F,F,[ae,ae,ae*G]),de(F,F,[-A[0],-A[1],-A[2]]);const ve=le([],_.globeMatrix,we);return le(ve,ve,F),le(ve,ve,m),ve}(a,t,s);if(u>0){const m=function(_,S){const E=S.worldSize,A=Pe(1,0)*E*It(S.center.lat,S.zoom)/xp(E),D=Pe(1,S.center.lat)*E,O=Z([]);return he(O,O,ie(S.center.lng)),pe(O,O,ie(S.center.lat)),de(O,O,[0,0,w]),ue(O,O,[A,A,A*D]),de(O,O,[S.point.x-.5*E,S.point.y-.5*E,0]),le(O,O,_),le(O,S.globeMatrix,O)}(a,t);return function(_,S,E){const A=(W,Q,ae)=>{const ce=_t(W),we=_t(Q),ve=fu(W,Q,ae);return ct(ve,ve,1/_t(ve)*kn(ce,we,ae))},D=A([_[0],_[1],_[2]],[S[0],S[1],S[2]],E),O=A([_[4],_[5],_[6]],[S[4],S[5],S[6]],E),F=A([_[8],_[9],_[10]],[S[8],S[9],S[10]],E),G=fu([_[12],_[13],_[14]],[S[12],S[13],S[14]],E);return[D[0],D[1],D[2],0,O[0],O[1],O[2],0,F[0],F[1],F[2],0,G[0],G[1],G[2],1]}(h,m,u)}return h}function QI(a,t,s,u){const h=Ai.projectAabbCorners(u,s);let m=Number.MAX_VALUE,_=-1;for(let A=0;A<h.length;++A){const D=h[A];D[0]=(.5*D[0]+.5)*t.width,D[1]=(.5-.5*D[1])*t.height,D[2]<m&&(_=A,m=D[2])}const S=A=>new Qt(h[A][0],h[A][1]);let E;switch(_){case 0:case 6:E=[S(1),S(5),S(4),S(7),S(3),S(2),S(1)];break;case 1:case 7:E=[S(0),S(4),S(5),S(6),S(2),S(3),S(0)];break;case 3:case 5:E=[S(1),S(0),S(4),S(7),S(6),S(2),S(1)];break;default:E=[S(1),S(5),S(6),S(7),S(3),S(0),S(1)]}if(Rn(a,E))return m}const vj=Vr([{name:"a_pos_3f",components:3,type:"Float32"}]),xj=Vr([{name:"a_color_3f",components:3,type:"Float32"}]),bj=Vr([{name:"a_color_4f",components:4,type:"Float32"}]),wj=Vr([{name:"a_uv_2f",components:2,type:"Float32"}]),Sj=Vr([{name:"a_normal_3f",components:3,type:"Float32"}]),Cj=Vr([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),Tj=Vr([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),eP={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class jx{constructor(t,s,u,h){this.message=(t?`${t}: `:"")+u,h&&(this.identifier=h),s!=null&&s.__line__&&(this.line=s.__line__)}}function nw(a,t){const s=a.indexOf("://")===-1;try{return new URL(a,s&&t?"http://example.com":void 0),!0}catch{return!1}}class tP{constructor(t,s){this.feature=t,this.instancedDataOffset=s,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class nP{constructor(){this.instancedDataArray=new no,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class rw{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.layers=t.layers,this.layerIds=this.layers.map(s=>s.fqid),this.projection=t.projection,this.index=t.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.styleDefinedModelURLs=t.styleDefinedModelURLs}updateFootprints(t,s){}populate(t,s,u,h){this.tileToMeter=Qe(u);const m=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:_,id:S,index:E,sourceLayerIndex:A}of t){const D=S??(_.properties&&_.properties.hasOwnProperty("id")?_.properties.id:void 0),O=bn(_,m);if(!this.layers[0]._featureFilter.filter(new ni(this.zoom),O,u))continue;const F={id:D,sourceLayerIndex:A,index:E,geometry:m?O.geometry:pn(_,u,h),properties:_.properties,type:_.type,patterns:{}},G=this.addFeature(F,F.geometry,O);G&&s.featureIndex.insert(_,F.geometry,E,A,this.index,this.instancesPerModel[G].instancedDataArray.length,en/32)}this.lookup=null}update(t,s,u,h){for(const m in this.instancesPerModel){const _=this.instancesPerModel[m];for(const S in t)_.idToFeaturesIndex.hasOwnProperty(S)&&(this.evaluate(_.features[_.idToFeaturesIndex[S]],t[S],_,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let t=!1;for(const s in this.instancesPerModel){const u=this.instancesPerModel[s];for(const h of u.features){const m=this.layers[0],_=h.feature,S=this.canonical,E=m.paint.get("model-rotation").evaluate(_,{},S),A=m.paint.get("model-scale").evaluate(_,{},S),D=m.paint.get("model-translation").evaluate(_,{},S);Vn(h.rotation,E)&&Vn(h.scale,A)&&Vn(h.translation,D)||(this.evaluate(h,h.featureStates,u,!0),t=!0)}}return t}updateReplacement(t,s,u,h){if(s.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=s.updateTime;const m=s.getReplacementRegionsForTile(t.toUnwrapped(),!0);if(Eb(this.activeReplacements,m))return!1;this.activeReplacements=m;let _=!1;for(const S in this.instancesPerModel){const E=this.instancesPerModel[S],A=E.instancedDataArray;for(const D of E.features){const O=D.instancedDataOffset,F=D.instancedDataCount;for(let G=0;G<F;G++){const W=16*(G+O);let Q=A.float32[W+0];const ae=Q>en;Q=ae?Q-en:Q;const ce=Math.floor(Q),we=A.float32[W+1];let ve=!1;for(const ee of this.activeReplacements)if(!aE(ee,u,eP.Model,h)&&!(ee.min.x>ce||ce>ee.max.x||ee.min.y>we||we>ee.max.y)&&(ve=fE(hE(ce,we,t.canonical,ee.footprintTileId.canonical),ee.footprint),ve))break;A.float32[W]=ve?Q+en:Q,_=_||ve!==ae}}}return _}isEmpty(){for(const t in this.instancesPerModel)if(this.instancesPerModel[t].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(t){if(!this.uploaded)for(const s in this.instancesPerModel){const u=this.instancesPerModel[s];u.instancedDataArray.length<0||u.instancedDataArray.length===0||(u.instancedDataBuffer?u.instancedDataBuffer.updateData(u.instancedDataArray):u.instancedDataBuffer=t.createVertexBuffer(u.instancedDataArray,Cj.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const s in this.instancesPerModel){const u=this.instancesPerModel[s];u.instancedDataArray.length!==0&&u.instancedDataBuffer&&u.instancedDataBuffer.destroy()}const t=this.layers[0].modelManager;if(t&&this.modelUris&&this.modelsRequested)for(const s of this.modelUris)t.removeModel(s,"",!0)}addFeature(t,s,u){const h=this.layers[0],m=h.layout.get("model-id").evaluate(u,{},this.canonical);if(!m)return gr(`modelId is not evaluated for layer ${h.id} and it is not going to get rendered.`),m;(nw(m,!1)||this.styleDefinedModelURLs[m]!==void 0)&&(this.modelUris.includes(m)||this.modelUris.push(m)),this.instancesPerModel[m]||(this.instancesPerModel[m]=new nP);const _=this.instancesPerModel[m],S=_.instancedDataArray,E=new tP(u,S.length);for(const A of s)for(const D of A){if(D.x<0||D.x>=en||D.y<0||D.y>=en)continue;const O=(this.lookupDim-1)/en,F=this.lookupDim*(D.y*O|0)+D.x*O|0;if(this.lookup){if(this.lookup[F]!==0)continue;this.lookup[F]=1}this.instanceCount++;const G=S.length;S.resize(G+1),_.instancesEvaluatedElevation.push(0),S.float32[16*G]=D.x,S.float32[16*G+1]=D.y}return E.instancedDataCount=_.instancedDataArray.length-E.instancedDataOffset,E.instancedDataCount>0&&(t.id&&(_.idToFeaturesIndex[t.id]=_.features.length),_.features.push(E),this.evaluate(E,{},_,!1)),m}getModelUris(){return this.modelUris}evaluate(t,s,u,h){const m=this.layers[0],_=t.feature,S=this.canonical,E=t.rotation=m.paint.get("model-rotation").evaluate(_,s,S),A=t.scale=m.paint.get("model-scale").evaluate(_,s,S),D=t.translation=m.paint.get("model-translation").evaluate(_,s,S),O=m.paint.get("model-color").evaluate(_,s,S);O.a=m.paint.get("model-color-mix-intensity").evaluate(_,s,S);const F=[];this.maxVerticalOffset<D[2]&&(this.maxVerticalOffset=D[2]),this.maxScale=Math.max(Math.max(this.maxScale,A[0]),Math.max(A[1],A[2])),JI(F,E,A);const G=Math.round(100*O.a)+O.b/1.05;for(let W=0;W<t.instancedDataCount;++W){const Q=t.instancedDataOffset+W,ae=16*Q,ce=u.instancedDataArray.float32;let we=0;h&&(we=ce[ae+6]-u.instancesEvaluatedElevation[Q]);const ve=0|ce[ae+1];ce[ae]=(0|ce[ae])+O.r/1.05,ce[ae+1]=ve+O.g/1.05,ce[ae+2]=G,ce[ae+3]=1/(S.z>10?this.tileToMeter:Qe(S,ve)),ce[ae+4]=D[0],ce[ae+5]=D[1],ce[ae+6]=D[2]+we,ce[ae+7]=F[0],ce[ae+8]=F[1],ce[ae+9]=F[2],ce[ae+10]=F[4],ce[ae+11]=F[5],ce[ae+12]=F[6],ce[ae+13]=F[8],ce[ae+14]=F[9],ce[ae+15]=F[10],u.instancesEvaluatedElevation[Q]=D[2]}}}let rP,iP;un(rw,"ModelBucket",{omit:["layers"]}),un(nP,"PerModelAttributes"),un(tP,"ModelFeature");const $m=64,jg={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function sP(a,t,s,u,h,m,_,S,E,A=!1){const D=s.zoom,O=s.project(u),F=It(u.lat,D),G=1/F;Z(a),de(a,a,[O.x+_[0]*G,O.y+_[1]*G,_[2]]);let W=1,Q=1;const ae=s.worldSize;if(A){if(s.projection.name==="mercator"){let ee=0;s.elevation&&(ee=s.elevation.getAtPointOrZero(new dt(O.x/ae,O.y/ae),0));const ge=Xn([],[O.x,O.y,ee,1],s.projMatrix)[3]/s.cameraToCenterDistance;W=ge,Q=ge*It(s.center.lat,D)}else if(s.projection.name==="globe"){const ee=tw(a,s),ge=[0,0,0,1];Xn(ge,ge,le([],s.projMatrix,ee));const be=ge[3]/s.cameraToCenterDistance,Ie=ch(D),Fe=s.projection.pixelsPerMeter(u.lat,ae)*It(u.lat,D),$e=s.projection.pixelsPerMeter(s.center.lat,ae)*It(s.center.lat,D);W=be/kn(Fe,Tt(s.center.lat),Ie),Q=be*F/Fe,W*=$e,Q*=$e}}else W=G;ue(a,a,[W,W,Q]);const ce=[...a],we=t.orientation,ve=[];if(JI(ve,[we[0]+h[0],we[1]+h[1],we[2]+h[2]],m),le(a,ce,ve),S&&s.elevation){let ee=0;const ge=[];if(E&&s.elevation){ee=function(Ie,Fe,$e,Ze,et){const St=Fe.elevation;if(!St)return 0;const jt=Ai.projectAabbCorners($e,Ze),kt=Pe(1,et.lat)*Fe.worldSize,Ft=function(Wt,Wn){const wn=[0,0,1],Sn=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const $n of Sn){const Jn=Wt[$n.corners[0]],ir=Wt[$n.corners[1]],yr=Wt[$n.corners[2]],fr=[ir[0]-Jn[0],ir[1]-Jn[1],Wn*(ir[2]-Jn[2])],ar=Bt(fr,fr,[yr[0]-Jn[0],yr[1]-Jn[1],Wn*(yr[2]-Jn[2])]);We(ar,ar),$n.dotProductWithUp=st(ar,wn)}return Sn.sort(($n,Jn)=>$n.dotProductWithUp-Jn.dotProductWithUp),Sn[0].corners}(jt,kt),Gt=jt[Ft[0]],vt=jt[Ft[1]],zt=jt[Ft[2]],gt=jt[Ft[3]],bt=St.getAtPointOrZero(new dt(Gt[0]/Fe.worldSize,Gt[1]/Fe.worldSize),0),qt=St.getAtPointOrZero(new dt(vt[0]/Fe.worldSize,vt[1]/Fe.worldSize),0),Kt=St.getAtPointOrZero(new dt(zt[0]/Fe.worldSize,zt[1]/Fe.worldSize),0),En=St.getAtPointOrZero(new dt(gt[0]/Fe.worldSize,gt[1]/Fe.worldSize),0),_n=(bt+En)/2,sn=(qt+Kt)/2;return _n>sn?qt<Kt?Nx(Ie,vt,gt,Gt,qt,En,bt,kt):Nx(Ie,zt,Gt,gt,Kt,bt,En,kt):bt<En?Nx(Ie,Gt,vt,zt,bt,qt,Kt,kt):Nx(Ie,gt,zt,vt,En,Kt,qt,kt),Math.max(_n,sn)}(ge,s,t.aabb,a,u);const be=le([],Ce([],ge),ve);le(a,ce,be)}else ee=s.elevation.getAtPointOrZero(new dt(O.x/ae,O.y/ae),0);ee!==0&&(a[14]+=ee)}}function Py(a,t,s=!1){a.uploaded||(a.gfxTexture=new Jb(t,a.image,s?t.gl.R8:t.gl.RGBA8,{useMipmap:a.sampler.minFilter>=t.gl.NEAREST_MIPMAP_NEAREST}),a.uploaded=!0,a.image=null)}function Ej(a,t,s){a.indexBuffer=t.createIndexBuffer(a.indexArray,!1,!0),a.vertexBuffer=t.createVertexBuffer(a.vertexArray,vj.members,!1,!0),a.normalArray&&(a.normalBuffer=t.createVertexBuffer(a.normalArray,Sj.members,!1,!0)),a.texcoordArray&&(a.texcoordBuffer=t.createVertexBuffer(a.texcoordArray,wj.members,!1,!0)),a.colorArray&&(a.colorBuffer=t.createVertexBuffer(a.colorArray,(a.colorArray.bytesPerElement===12?xj:bj).members,!1,!0)),a.featureArray&&(a.pbrBuffer=t.createVertexBuffer(a.featureArray,Tj.members,!0)),a.segments=ki.simpleSegment(0,0,a.vertexArray.length,a.indexArray.length);const u=a.material;u.pbrMetallicRoughness.baseColorTexture&&Py(u.pbrMetallicRoughness.baseColorTexture,t),u.pbrMetallicRoughness.metallicRoughnessTexture&&Py(u.pbrMetallicRoughness.metallicRoughnessTexture,t),u.normalTexture&&Py(u.normalTexture,t),u.occlusionTexture&&Py(u.occlusionTexture,t,s),u.emissionTexture&&Py(u.emissionTexture,t)}function iw(a,t,s){if(a.meshes)for(const u of a.meshes)Ej(u,t,s);if(a.children)for(const u of a.children)iw(u,t,s)}function Bx(a){if(a.meshes)for(const t of a.meshes)t.indexArray.destroy(),t.vertexArray.destroy(),t.colorArray&&t.colorArray.destroy(),t.normalArray&&t.normalArray.destroy(),t.texcoordArray&&t.texcoordArray.destroy(),t.featureArray&&t.featureArray.destroy();if(a.children)for(const t of a.children)Bx(t)}function sw(a){if(a.meshes)for(const s of a.meshes)s.vertexBuffer&&(s.vertexBuffer.destroy(),s.indexBuffer.destroy(),s.normalBuffer&&s.normalBuffer.destroy(),s.texcoordBuffer&&s.texcoordBuffer.destroy(),s.colorBuffer&&s.colorBuffer.destroy(),s.pbrBuffer&&s.pbrBuffer.destroy(),s.segments.destroy(),s.material&&((t=s.material).pbrMetallicRoughness.baseColorTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),t.pbrMetallicRoughness.metallicRoughnessTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),t.normalTexture&&t.normalTexture.gfxTexture&&t.normalTexture.gfxTexture.destroy(),t.emissionTexture&&t.emissionTexture.gfxTexture&&t.emissionTexture.gfxTexture.destroy(),t.occlusionTexture&&t.occlusionTexture.gfxTexture&&t.occlusionTexture.gfxTexture.destroy()));var t;if(a.children)for(const s of a.children)sw(s)}class Bg{constructor(t,s,u){this._demTile=t,this._dem=this._demTile.dem,this._scale=s,this._offset=u}static create(t,s,u){const h=u||t.findDEMTileFor(s);if(!h||!h.dem)return;const m=h.dem,_=h.tileID,S=1<<s.canonical.z-_.canonical.z;return new Bg(h,m.dim/en/S,[(s.canonical.x/S-_.canonical.x)*m.dim,(s.canonical.y/S-_.canonical.y)*m.dim])}tileCoordToPixel(t,s){const u=s*this._scale+this._offset[1],h=Math.floor(t*this._scale+this._offset[0]),m=Math.floor(u);return new Qt(h,m)}getElevationAt(t,s,u,h){const m=t*this._scale+this._offset[0],_=s*this._scale+this._offset[1],S=Math.floor(m),E=Math.floor(_),A=this._dem;return h=!!h,u?kn(kn(A.get(S,E,h),A.get(S,E+1,h),_-E),kn(A.get(S+1,E,h),A.get(S+1,E+1,h),_-E),m-S):A.get(S,E,h)}getElevationAtPixel(t,s,u){return this._dem.get(t,s,!!u)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*Pe(1,t)*this._dem.stride}}const ow=new Float32Array(262144),Hm=new Uint8Array(262144);function oP(a){let t=0;if(a.meshes)for(const s of a.meshes)t=Math.max(t,s.aabb.max[2]);if(a.children)for(const s of a.children)t=Math.max(t,oP(s));return t}function aP(a,t,s){if(a.meshes)for(const u of a.meshes){if(u.aabb.min[0]===1/0)continue;const h=Ai.applyTransform(u.aabb,a.matrix);s.insert(t,h.min[0],h.min[1],h.max[0],h.max[1])}if(a.children)for(const u of a.children)aP(u,t,s)}const lP=["","wall","door","roof","window","lamp","logo"];class cP{constructor(t){this.node=t,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:t.id,geometry:[],properties:{height:oP(t)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new Ai([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let t=0;const s=new Ai([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const u of this.node.meshes)this.node.lightMeshIndex!==t&&(u.transformedAabb=Ai.applyTransformFast(u.aabb,this.node.matrix),s.encapsulate(u.transformedAabb)),t++;this.aabb=s}return this.aabb}}class Vx{constructor(t,s,u,h,m,_,S){this.id=u,this.layers=t,this.layerIds=this.layers.map(E=>E.fqid),this.stateDependentLayerIds=this.layers.filter(E=>E.isStateDependent()).map(E=>E.id),this.modelTraits|=jg.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,h&&(this.modelTraits|=jg.HasMapboxMeshFeatures),m&&(this.modelTraits|=jg.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=_,this.dirty=!0,this.needsUpload=!1,this.filter=null,this.nodesInfo=[];for(const E of s)this.nodesInfo.push(new cP(E)),aP(E,S.featureIndexArray.length,S.grid),S.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,S.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(t,s){for(const u of this.getNodesInfo()){const h=u.node;h.footprint&&s.push({footprint:h.footprint,id:t})}}update(t){const s=Object.keys(t).length!==0;if(s&&!this.stateDependentLayers.length)return;const u=s?this.stateDependentLayers:this.layers;if(!yl(t,this.states))for(const h of u)this.evaluate(h,t);this.states=structuredClone(t)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(t){if(!this.needsUpload)return;const s=this.getNodesInfo();for(const u of s){const h=u.node;this.uploaded?this.updatePbrBuffer(h):iw(h,t,!0)}for(const u of s)Bx(u.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(t){let s=!1;if(!t.meshes)return s;for(const u of t.meshes)u.pbrBuffer&&(u.pbrBuffer.updateData(u.featureArray),s=!0);return s}needsReEvaluation(t,s,u){const h=t.transform.projectionOptions,m=t.style.getBrightness(),_=this.brightness!==m;if(!this.uploaded||this.dirty||h.name!==this.projection.name||Ay(u.paint.get("model-color").value,_)||Ay(u.paint.get("model-color-mix-intensity").value,_)||Ay(u.paint.get("model-roughness").value,_)||Ay(u.paint.get("model-emissive-strength").value,_)||Ay(u.paint.get("model-height-based-emissive-strength-multiplier").value,_)){this.projection=h,this.brightness=m;const S=this.getNodesInfo();for(const E of S)E.state=null;return!0}return!1}evaluateScale(t,s){if(t.transform.zoom===this.zoom)return;this.zoom=t.transform.zoom;const u=this.getNodesInfo(),h=this.id.canonical;for(const m of u){const _=m.feature;m.evaluatedScale=s.paint.get("model-scale").evaluate(_,{},h)}}evaluate(t,s){const u=this.getNodesInfo();for(const h of u){if(!h.node.meshes)continue;const m=h.feature,_=s&&s[m.id];if(yl(_,h.state))continue;h.state=structuredClone(_);const S=h.node.meshes&&h.node.meshes[0].featureData,E=h.evaluatedColor[2],A=h.evaluatedRMEA[2],D=this.id.canonical;if(h.hasTranslucentParts=!1,S){for(let O=0;O<lP.length;O++){const F=lP[O];F.length&&(m.properties.part=F);const G=t.paint.get("model-color").evaluate(m,_,D).toRenderColor(null),W=t.paint.get("model-color-mix-intensity").evaluate(m,_,D);h.evaluatedColor[O]=[G.r,G.g,G.b,W],h.evaluatedRMEA[O][0]=t.paint.get("model-roughness").evaluate(m,_,D),h.evaluatedRMEA[O][2]=t.paint.get("model-emissive-strength").evaluate(m,_,D),h.evaluatedRMEA[O][3]=G.a,h.emissionHeightBasedParams[O]=t.paint.get("model-height-based-emissive-strength-multiplier").evaluate(m,_,D),!h.hasTranslucentParts&&G.a<1&&(h.hasTranslucentParts=!0)}delete m.properties.part,Pj(h,E!==h.evaluatedColor[2]||A!==h.evaluatedRMEA[2],this.modelTraits)}else h.evaluatedRMEA[0][2]=t.paint.get("model-emissive-strength").evaluate(m,_,D);h.evaluatedScale=t.paint.get("model-scale").evaluate(m,_,D),this.updatePbrBuffer(h.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(t,s,u,h){const m=t.findDEMTileFor(u);if(m&&(m.tileID.canonical!==this.terrainTile||s!==this.terrainExaggeration)){if(m.dem&&m.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=m.tileID.overscaledZ;const _=Bg.create(t,u,m);if(!_)return;this.modelTraits&jg.HasMapboxMeshFeatures&&this.updateDEM(t,_,u,h);for(const S of this.getNodesInfo()){const E=S.node;if(!E.footprint||!E.footprint.vertices||!E.footprint.vertices.length)continue;const A=E.footprint.vertices;let D=_.getElevationAt(A[0].x,A[0].y,!0,!0);for(let O=1;O<A.length;O++)D=Math.min(D,_.getElevationAt(A[O].x,A[O].y,!0,!0));E.elevation=D}}this.terrainTile=m.tileID.canonical,this.terrainExaggeration=s}}updateDEM(t,s,u,h){let m=s._dem._modifiedForSources[h];if(m===void 0&&(s._dem._modifiedForSources[h]=[],m=s._dem._modifiedForSources[h]),m.includes(u.canonical))return;const _=s._dem.dim;m.push(u.canonical);let S=!1;for(const E of this.getNodesInfo()){const A=E.node;if(!A.footprint||!A.footprint.grid)continue;const D=A.footprint.grid,O=s.tileCoordToPixel(D.min.x,D.min.y),F=s.tileCoordToPixel(D.max.x,D.max.y),G=Math.min(Math.min(_-F.y,O.x),Math.min(O.y,_-F.x));if(G<0)continue;const W=Xe(G,2,5);let Q=Math.max(0,O.x-W),ae=Math.max(0,O.y-W),ce=Math.min(F.x+W,_-1),we=Math.min(F.y+W,_-1);for(let be=ae;be<=we;++be)for(let Ie=Q;Ie<=ce;++Ie)Hm[be*_+Ie]=255;let ve=0,ee=0;for(let be=0;be<D.cellsY;++be)for(let Ie=0;Ie<D.cellsX;++Ie){if(!D.cells[be*D.cellsX+Ie])continue;const Fe=s.tileCoordToPixel(D.min.x+Ie/D.xScale,D.min.y+be/D.yScale),$e=s.tileCoordToPixel(D.min.x+(Ie+1)/D.xScale,D.min.y+(be+1)/D.yScale);for(let Ze=Fe.y;Ze<=Math.min($e.y+1,_-1);++Ze)for(let et=Fe.x;et<=Math.min($e.x+1,_-1);++et)Hm[Ze*_+et]===255&&(Hm[Ze*_+et]=0,ve+=s.getElevationAtPixel(et,Ze),ee++)}const ge=ve/ee;Q=Math.max(1,O.x-W),ae=Math.max(1,O.y-W),ce=Math.min(F.x+W,_-2),we=Math.min(F.y+W,_-2),S=!0;for(let be=ae;be<=we;++be)for(let Ie=Q;Ie<=ce;++Ie)Hm[be*_+Ie]===0&&(ow[be*_+Ie]=s._dem.set(Ie,be,ge));for(let be=1;be<W;++be){Q=Math.max(1,O.x-be),ae=Math.max(1,O.y-be),ce=Math.min(F.x+be,_-2),we=Math.min(F.y+be,_-2);for(let Ie=ae;Ie<=we;++Ie)for(let Fe=Q;Fe<=ce;++Fe){const $e=Ie*_+Fe;if(Hm[$e]===255){let Ze=0,et=0,St=-1,jt=-1;for(let kt=-1;kt<=1;++kt)for(let Ft=-1;Ft<=1;++Ft){const Gt=(Ie+kt)*_+Fe+Ft;if(Hm[Gt]>=be)continue;const vt=ow[Gt],zt=Math.abs(vt);zt>et&&(Ze=vt,et=zt,St=Ft,jt=kt)}if(et>.1){const kt=1-(be+.5*Math.abs(St*jt))/W;let Ft=s._dem.get(Fe,Ie)+Ze*kt;const Gt=s._dem.get(Fe+St,Ie+jt),vt=s._dem.get(Fe-St,Ie-jt,!0);(Ft-Gt)*(Ft-vt)>0&&(Ft=(Gt+vt)/2),ow[$e]=s._dem.set(Fe,Ie,Ft),Hm[$e]=be}}}}}S&&(s._demTile.needsDEMTextureUpload=!0,s._dem._timestamp=sa.now())}setFilter(t){this.filter=t?ed(t):null}getNodesInfo(){return this.filter?this.nodesInfo.filter(t=>this.filter.filter(new ni(this.id.overscaledZ),t.feature,this.id.canonical)):this.nodesInfo}destroy(){const t=this.getNodesInfo();for(const s of t)Bx(s.node),sw(s.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(t,s){if(s.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=s.updateTime;const u=s.getReplacementRegionsForTile(t.toUnwrapped()),h=this.getNodesInfo();for(let m=0;m<this.nodesInfo.length;m++){const _=h[m].node;h[m].hiddenByReplacement=!!_.footprint&&!u.find(S=>S.footprint===_.footprint)}}getHeightAtTileCoord(t,s){const u=this.getNodesInfo(),h=[],m=[0,0,0],_=Z([]);for(let S=0;S<this.nodesInfo.length;S++){const E=u[S],A=E.node.meshes[0],D=A.transformedAabb;if(t<D.min[0]||s<D.min[1]||t>D.max[0]||s>D.max[1])continue;if(E.node.hidden===!0)return{height:1/0,maxHeight:E.feature.properties.height,hidden:!1,verticalScale:E.evaluatedScale[2]};J(_,E.node.matrix),m[0]=t,m[1]=s,cn(m,m,_);const O=(m[0]-A.aabb.min[0])/(A.aabb.max[0]-A.aabb.min[0])*$m|0,F=Math.min(63,(m[1]-A.aabb.min[1])/(A.aabb.max[1]-A.aabb.min[1])*$m|0)*$m+Math.min(63,O),G=A.heightmap[F];if(!(G<0&&E.node.footprint))return E.hiddenByReplacement?void 0:{height:G,maxHeight:E.feature.properties.height,hidden:!1,verticalScale:E.evaluatedScale[2]};if(E.node.footprint.grid.query(new Qt(t,s),new Qt(t,s),h),h.length>0)return{height:void 0,maxHeight:E.feature.properties.height,hidden:E.hiddenByReplacement,verticalScale:E.evaluatedScale[2]}}}}function Ay(a,t){return a instanceof Qc&&!a.isLightConstant&&t}function Ij(a,t,s,u,h,m,_,S){let E=(61440&t|(61440&t)>>4)>>8,A=(3840&t|(3840&t)>>4)>>4,D=240&t|(240&t)>>4;s[3]>0&&(E=kn(E,255*s[0],s[3]),A=kn(A,255*s[1],s[3]),D=kn(D,255*s[2],s[3]));const O=E<<8|A,F=D<<8|Math.floor(255*u[3]),G=function(be){const Ie=Xe(be,0,2);return Math.min(Math.round(.5*Ie*255),255)}(u[2])<<8|15*u[0]<<4|15*u[1],W=Xe(h[0],0,1),Q=Xe(h[1],0,1),ae=Xe(h[2],0,1),ce=Xe(h[3],0,1);let we,ve,ee,ge;if(W!==Q&&_!==m&&Q!==W){const be=_-m;ve=1/(be*(Q-W)),ee=-(m+be*W)/(be*(Q-W));const Ie=Xe(h[4],-1,1);ge=Math.pow(10,Ie),we=255*ae<<8|255*ce}else we=65535,ve=0,ee=1,ge=1;if(a.emplaceBack(O,F,G,we,ve,ee,ge),S){const be=S.length;S.clear();for(let Ie=0;Ie<be;Ie++)S.emplaceBack(O,F,G,we,ve,ee,ge)}}function Pj(a,t,s){const u=a.node;let h=0;const m=s&jg.HasMeshoptCompression;for(const _ of u.meshes){if(u.lights&&u.lightMeshIndex===h||!_.featureData)continue;_.featureArray=new ro,_.featureArray.reserve(_.featureData.length);let S=t;for(const E of _.featureData){const A=m?65535&E:E>>16&65535,D=m?E>>16&65535:65535&E,O=(15&D)<8?15&D:0,F=a.evaluatedRMEA[O],G=a.evaluatedColor[O],W=a.emissionHeightBasedParams[O];let Q;if(S&&O===2&&u.lights&&(Q=new ro,Q.resize(10*u.lights.length)),Ij(_.featureArray,A,G,F,W,_.aabb.min[2],_.aabb.max[2],Q),Q&&S){S=!1;const ae=u.meshes[u.lightMeshIndex];ae.featureArray=Q,ae.featureArray._trim()}}_.featureArray._trim(),h++}}function uP(a,t,s,u){const h=1<<a.z;t.lat=Ne((u/en+a.y)/h),t.lng=Oe((s/en+a.x)/h)}un(Vx,"Tiled3dModelBucket",{omit:["layers"]}),un(cP,"Tiled3dModelFeature");const Aj={circle:class extends po{constructor(a,t,s,u){super(a,{layout:Xr||(Xr=new $i({"circle-sort-key":new fn(ut.layout_circle["circle-sort-key"]),"circle-elevation-reference":new Xt(ut.layout_circle["circle-elevation-reference"]),visibility:new Xt(ut.layout_circle.visibility)})),paint:hi||(hi=new $i({"circle-radius":new fn(ut.paint_circle["circle-radius"]),"circle-color":new fn(ut.paint_circle["circle-color"]),"circle-blur":new fn(ut.paint_circle["circle-blur"]),"circle-opacity":new fn(ut.paint_circle["circle-opacity"]),"circle-translate":new Xt(ut.paint_circle["circle-translate"]),"circle-translate-anchor":new Xt(ut.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Xt(ut.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Xt(ut.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new fn(ut.paint_circle["circle-stroke-width"]),"circle-stroke-color":new fn(ut.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new fn(ut.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Xt(ut.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"})}))},t,s,u)}createBucket(a){return new dn(a)}queryRadius(a){const t=a;return nr("circle-radius",this,t)+nr("circle-stroke-width",this,t)+Si(this.paint.get("circle-translate"))}queryIntersectsFeature(a,t,s,u,h,m,_,S){const E=ai(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),m.angle,a.pixelToTileUnitsFactor),A=this.paint.get("circle-radius").evaluate(t,s)+this.paint.get("circle-stroke-width").evaluate(t,s);return Re(a,u,m,_,S,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",E,A)}getProgramIds(){return["circle"]}getDefaultProgramParams(a,t,s){const u=se(this);return{config:new Gl(this,{zoom:t,lut:s}),defines:u,overrideFog:!1}}hasElevation(){return this.layout&&this.layout.get("circle-elevation-reference")!=="none"}},heatmap:class extends po{createBucket(a){return new Dn(a)}constructor(a,t,s,u){super(a,{layout:In||(In=new $i({visibility:new Xt(ut.layout_heatmap.visibility)})),paint:Kn||(Kn=new $i({"heatmap-radius":new fn(ut.paint_heatmap["heatmap-radius"]),"heatmap-weight":new fn(ut.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Xt(ut.paint_heatmap["heatmap-intensity"]),"heatmap-color":new zs(ut.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Xt(ut.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"})}))},t,s,u),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){a==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Rr({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(a){return nr("heatmap-radius",this,a)}queryIntersectsFeature(a,t,s,u,h,m,_,S){const E=this.paint.get("heatmap-radius").evaluate(t,s);return Re(a,u,m,_,S,!0,!0,new Qt(0,0),E)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(a,t,s){return a==="heatmap"?{config:new Gl(this,{zoom:t,lut:s}),overrideFog:!1}:{}}},hillshade:class extends po{constructor(a,t,s,u){super(a,{layout:hr||(hr=new $i({visibility:new Xt(ut.layout_hillshade.visibility)})),paint:_r||(_r=new $i({"hillshade-illumination-direction":new Xt(ut.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Xt(ut.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Xt(ut.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Xt(ut.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Xt(ut.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Xt(ut.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Xt(ut.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"})}))},t,s,u)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(a,t,s){return{overrideFog:!1}}},fill:class extends po{constructor(a,t,s,u){super(a,{layout:nE||(nE=new $i({"fill-sort-key":new fn(ut.layout_fill["fill-sort-key"]),visibility:new Xt(ut.layout_fill.visibility),"fill-elevation-reference":new Xt(ut.layout_fill["fill-elevation-reference"]),"fill-construct-bridge-guard-rail":new fn(ut.layout_fill["fill-construct-bridge-guard-rail"])})),paint:rE||(rE=new $i({"fill-antialias":new Xt(ut.paint_fill["fill-antialias"]),"fill-opacity":new fn(ut.paint_fill["fill-opacity"]),"fill-color":new fn(ut.paint_fill["fill-color"]),"fill-outline-color":new fn(ut.paint_fill["fill-outline-color"]),"fill-translate":new Xt(ut.paint_fill["fill-translate"]),"fill-translate-anchor":new Xt(ut.paint_fill["fill-translate-anchor"]),"fill-pattern":new fn(ut.paint_fill["fill-pattern"]),"fill-pattern-cross-fade":new Xt(ut.paint_fill["fill-pattern-cross-fade"]),"fill-emissive-strength":new Xt(ut.paint_fill["fill-emissive-strength"]),"fill-z-offset":new fn(ut.paint_fill["fill-z-offset"]),"fill-bridge-guard-rail-color":new fn(ut.paint_fill["fill-bridge-guard-rail-color"]),"fill-tunnel-structure-color":new fn(ut.paint_fill["fill-tunnel-structure-color"]),"fill-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"fill-bridge-guard-rail-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"fill-tunnel-structure-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"})}))},t,s,u)}getProgramIds(){const a=this.paint.get("fill-pattern"),t=a&&a.constantOr(1),s=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&s.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),s}getDefaultProgramParams(a,t,s){return{config:new Gl(this,{zoom:t,lut:s}),overrideFog:!1}}recalculate(a,t){super.recalculate(a,t);const s=this.paint._values["fill-outline-color"];s.value.kind==="constant"&&s.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(a){return new Sb(a)}queryRadius(){return Si(this.paint.get("fill-translate"))}queryIntersectsFeature(a,t,s,u,h,m){return!a.queryGeometry.isAboveHorizon&&dr(zr(a.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),m.angle,a.pixelToTileUnitsFactor),u)}isTileClipped(){return this.paint.get("fill-z-offset").constantOr(1)===0}is3D(a){if(this.paint.get("fill-z-offset").constantOr(1)!==0)return!0;const t=this.layout&&this.layout.get("fill-elevation-reference")!=="none";return a!=null?t&&!a:t}hasElevation(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}hasShadowPass(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}},"fill-extrusion":class extends po{constructor(a,t,s,u){super(a,{layout:PE||(PE=new $i({visibility:new Xt(ut["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Xt(ut["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:AE||(AE=new $i({"fill-extrusion-opacity":new Xt(ut["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new fn(ut["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Xt(ut["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Xt(ut["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new fn(ut["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-pattern-cross-fade":new Xt(ut["paint_fill-extrusion"]["fill-extrusion-pattern-cross-fade"]),"fill-extrusion-height":new fn(ut["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new fn(ut["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new Xt(ut["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new Xt(ut["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new Xt(ut["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Xt(ut["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Xt(ut["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Xt(ut["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Xt(ut["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Xt(ut["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Xt(ut["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Xt(ut["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new fn(ut["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new fn(ut["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Xt(ut["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Xt(ut["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Xt(ut["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Xt(ut["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new fn(ut["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new fn(ut["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new Xt(ut["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"})}))},t,s,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(a){return new gx(a)}queryRadius(){return Si(this.paint.get("fill-extrusion-translate"))}is3D(a){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(a,t,s,u,h,m,_,S,E){const A=ai(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),m.angle,a.pixelToTileUnitsFactor),D=this.paint.get("fill-extrusion-height").evaluate(t,s),O=this.paint.get("fill-extrusion-base").evaluate(t,s),F=[0,0],G=S&&m.elevation,W=m.elevation?m.elevation.exaggeration():1,Q=a.tile.getBucket(this);if(G&&Q instanceof gx){const ee=Q.centroidVertexArray,ge=E+1;ge<ee.length&&(F[0]=ee.geta_centroid_pos0(ge),F[1]=ee.geta_centroid_pos1(ge))}if(F[0]===0&&F[1]===1)return!1;m.projection.name==="globe"&&(u=IE([u],[new Qt(0,0),new Qt(en,en)],a.tileID.canonical).map(ee=>ee.polygon).flat());const ae=G?S:null,[ce,we]=function(ee,ge,be,Ie,Fe,$e,Ze,et,St,jt,kt){return ee.projection.name==="globe"?function(Ft,Gt,vt,zt,gt,bt,qt,Kt,En,_n,sn){const Wt=[],Wn=[],wn=Ft.projection.upVectorScale(sn,Ft.center.lat,Ft.worldSize).metersToTile,Sn=[0,0,0,1],$n=[0,0,0,1],Jn=(yr,fr,ar,_i)=>{yr[0]=fr,yr[1]=ar,yr[2]=_i,yr[3]=1},ir=EE();vt>0&&(vt+=ir),zt+=ir;for(const yr of Gt){const fr=[],ar=[];for(const _i of yr){const Ri=_i.x+gt.x,Ee=_i.y+gt.y,Ae=Ft.projection.projectTilePoint(Ri,Ee,sn),Et=Ft.projection.upVector(sn,_i.x,_i.y);let Jt=vt,an=zt;if(qt){const on=OE(Ri,Ee,vt,zt,qt,Kt,En,_n);Jt+=on.base,an+=on.top}vt!==0?Jn(Sn,Ae.x+Et[0]*wn*Jt,Ae.y+Et[1]*wn*Jt,Ae.z+Et[2]*wn*Jt):Jn(Sn,Ae.x,Ae.y,Ae.z),Jn($n,Ae.x+Et[0]*wn*an,Ae.y+Et[1]*wn*an,Ae.z+Et[2]*wn*an),cn(Sn,Sn,bt),cn($n,$n,bt),fr.push(new Bm(Sn[0],Sn[1],Sn[2])),ar.push(new Bm($n[0],$n[1],$n[2]))}Wt.push(fr),Wn.push(ar)}return[Wt,Wn]}(ee,ge,be,Ie,Fe,$e,Ze,et,St,jt,kt):Ze?function(Ft,Gt,vt,zt,gt,bt,qt,Kt,En){const _n=[],sn=[],Wt=[0,0,0,1];for(const Wn of Ft){const wn=[],Sn=[];for(const $n of Wn){const Jn=$n.x+zt.x,ir=$n.y+zt.y,yr=OE(Jn,ir,Gt,vt,bt,qt,Kt,En);Wt[0]=Jn,Wt[1]=ir,Wt[2]=yr.base,Wt[3]=1,Xn(Wt,Wt,gt),Wt[3]=Math.max(Wt[3],1e-5);const fr=new Bm(Wt[0]/Wt[3],Wt[1]/Wt[3],Wt[2]/Wt[3]);Wt[0]=Jn,Wt[1]=ir,Wt[2]=yr.top,Wt[3]=1,Xn(Wt,Wt,gt),Wt[3]=Math.max(Wt[3],1e-5);const ar=new Bm(Wt[0]/Wt[3],Wt[1]/Wt[3],Wt[2]/Wt[3]);wn.push(fr),Sn.push(ar)}_n.push(wn),sn.push(Sn)}return[_n,sn]}(ge,be,Ie,Fe,$e,Ze,et,St,jt):function(Ft,Gt,vt,zt,gt){const bt=[],qt=[],Kt=gt[8]*Gt,En=gt[9]*Gt,_n=gt[10]*Gt,sn=gt[11]*Gt,Wt=gt[8]*vt,Wn=gt[9]*vt,wn=gt[10]*vt,Sn=gt[11]*vt;for(const $n of Ft){const Jn=[],ir=[];for(const yr of $n){const fr=yr.x+zt.x,ar=yr.y+zt.y,_i=gt[0]*fr+gt[4]*ar+gt[12],Ri=gt[1]*fr+gt[5]*ar+gt[13],Ee=gt[2]*fr+gt[6]*ar+gt[14],Ae=gt[3]*fr+gt[7]*ar+gt[15],Et=_i+Kt,Jt=Ri+En,an=Ee+_n,on=Math.max(Ae+sn,1e-5),Cn=_i+Wt,jn=Ri+Wn,Er=Ee+wn,Ir=Math.max(Ae+Sn,1e-5);Jn.push(new Bm(Et/on,Jt/on,an/on)),ir.push(new Bm(Cn/Ir,jn/Ir,Er/Ir))}bt.push(Jn),qt.push(ir)}return[bt,qt]}(ge,be,Ie,Fe,$e)}(m,u,O,D,A,_,ae,F,W,m.center.lat,a.tileID.canonical),ve=a.queryGeometry;return function(ee,ge,be){let Ie=1/0;dr(be,ge)&&(Ie=kE(be,ge[0]));for(let Fe=0;Fe<ge.length;Fe++){const $e=ge[Fe],Ze=ee[Fe];for(let et=0;et<$e.length-1;et++){const St=$e[et],jt=[St,$e[et+1],Ze[et+1],Ze[et],St];Rn(be,jt)&&(Ie=Math.min(Ie,kE(be,jt)))}}return Ie!==1/0&&Ie}(ce,we,ve.isPointQuery()?ve.screenBounds:ve.screenGeometry)}},line:class extends po{constructor(a,t,s,u){const h=GE();super(a,h,t,s,u),h.layout&&(this.layout=new il(h.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(a){if(a==="line-gradient"){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof Vu,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(a,t){super.recalculate(a,t),this.paint._values["line-floorwidth"]=(()=>{if(_y)return _y;const s=GE();return _y=new AN(s.paint.properties["line-width"].specification),_y.useIntegerZoom=!0,_y})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)}createBucket(a){return new Rb(a)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(a,t,s){const u=$E(this);return{config:new Gl(this,{zoom:t,lut:s}),defines:u,overrideFog:!1}}queryRadius(a){const t=a,s=WE(nr("line-width",this,t),nr("line-gap-width",this,t)),u=nr("line-offset",this,t);return s/2+Math.abs(u)+Si(this.paint.get("line-translate"))}queryIntersectsFeature(a,t,s,u,h,m){if(a.queryGeometry.isAboveHorizon)return!1;const _=zr(a.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),m.angle,a.pixelToTileUnitsFactor),S=a.pixelToTileUnitsFactor/2*WE(this.paint.get("line-width").evaluate(t,s),this.paint.get("line-gap-width").evaluate(t,s)),E=this.paint.get("line-offset").evaluate(t,s);return E&&(u=function(A,D){const O=[],F=new Qt(0,0);for(let G=0;G<A.length;G++){const W=A[G],Q=[];for(let ae=0;ae<W.length;ae++){const ce=W[ae],we=W[ae+1],ve=ae===0?F:ce.sub(W[ae-1])._unit()._perp(),ee=ae===W.length-1?F:we.sub(ce)._unit()._perp(),ge=ve._add(ee)._unit();ge._mult(1/(ge.x*ee.x+ge.y*ee.y)),Q.push(ge._mult(D)._add(ce))}O.push(Q)}return O}(u,E*a.pixelToTileUnitsFactor)),function(A,D,O){for(let F=0;F<D.length;F++){const G=D[F];if(A.length>=3){for(let W=0;W<G.length;W++)if(si(A,G[W]))return!0}if(ri(A,G,O))return!0}return!1}(_,u,S)}isTileClipped(){return this.hasNonElevatedBuckets}isDraped(a){return!this.hasElevatedBuckets}hasElevation(){return this.layout&&this.layout.get("line-elevation-reference")!=="none"}},symbol:Dx,background:class extends po{constructor(a,t,s,u){super(a,{layout:zI||(zI=new $i({visibility:new Xt(ut.layout_background.visibility)})),paint:FI||(FI=new $i({"background-pitch-alignment":new Xt(ut.paint_background["background-pitch-alignment"]),"background-color":new Xt(ut.paint_background["background-color"]),"background-pattern":new Xt(ut.paint_background["background-pattern"]),"background-opacity":new Xt(ut.paint_background["background-opacity"]),"background-emissive-strength":new Xt(ut.paint_background["background-emissive-strength"]),"background-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"})}))},t,s,u)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(a,t,s){return{overrideFog:!1}}is3D(a){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:UI,"raster-particle":ZI,sky:class extends po{constructor(a,t,s,u){super(a,{layout:GI||(GI=new $i({visibility:new Xt(ut.layout_sky.visibility)})),paint:WI||(WI=new $i({"sky-type":new Xt(ut.paint_sky["sky-type"]),"sky-atmosphere-sun":new Xt(ut.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Xt(ut.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Xt(ut.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Xt(ut.paint_sky["sky-gradient-radius"]),"sky-gradient":new zs(ut.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Xt(ut.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Xt(ut.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Xt(ut.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"})}))},t,s,u),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){a==="sky-gradient"?this._updateColorRamp():a!=="sky-atmosphere-sun"&&a!=="sky-atmosphere-halo-color"&&a!=="sky-atmosphere-color"&&a!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Rr({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(a){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const t=a.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}getCenter(a,t){if(this.paint.get("sky-type")==="atmosphere"){const u=this.paint.get("sky-atmosphere-sun"),h=!u,m=a.style.light,_=m.properties.get("position");return h&&m.properties.get("anchor")==="viewport"&&gr("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),h?Qb(_.azimuthal,90-_.polar,t):Qb(u[0],90-u[1],t)}const s=this.paint.get("sky-gradient-center");return Qb(s[0],90-s[1],t)}isSky(){return!0}markSkyboxValid(a){this._skyboxInvalidated=!1,this._lightPosition=a.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const a=this.paint.get("sky-type");return a==="atmosphere"?["skyboxCapture","skybox"]:a==="gradient"?["skyboxGradient"]:null}},slot:class extends po{constructor(a,t,s,u){super(a,{paint:qI||(qI=new $i({}))},t,null)}},model:class extends po{constructor(a,t,s,u){super(a,{layout:rP||(rP=new $i({visibility:new Xt(ut.layout_model.visibility),"model-id":new fn(ut.layout_model["model-id"])})),paint:iP||(iP=new $i({"model-opacity":new fn(ut.paint_model["model-opacity"]),"model-rotation":new fn(ut.paint_model["model-rotation"]),"model-scale":new fn(ut.paint_model["model-scale"]),"model-translation":new fn(ut.paint_model["model-translation"]),"model-color":new fn(ut.paint_model["model-color"]),"model-color-mix-intensity":new fn(ut.paint_model["model-color-mix-intensity"]),"model-type":new Xt(ut.paint_model["model-type"]),"model-cast-shadows":new Xt(ut.paint_model["model-cast-shadows"]),"model-receive-shadows":new Xt(ut.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Xt(ut.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new fn(ut.paint_model["model-emissive-strength"]),"model-roughness":new fn(ut.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new fn(ut.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Xt(ut.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Xt(ut.paint_model["model-front-cutoff"]),"model-color-use-theme":new fn({type:"string",default:"default","property-type":"data-driven"})}))},t,s,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(a){return new rw(a)}getProgramIds(){return["model"]}is3D(a){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(a){return a instanceof Vx?en-1:0}queryIntersectsFeature(a,t,s,u,h,m){if(!this.modelManager)return!1;const _=this.modelManager,S=a.tile.getBucket(this);if(!(S&&S instanceof rw))return!1;for(const E in S.instancesPerModel){const A=S.instancesPerModel[E],D=t.id!==void 0?t.id:t.properties&&t.properties.hasOwnProperty("id")?t.properties.id:void 0;if(A.idToFeaturesIndex.hasOwnProperty(D)){const O=A.features[A.idToFeaturesIndex[D]],F=_.getModel(E,this.scope);if(!F)return!1;let G=X();const W=new ne(0,0),Q=S.canonical;let ae=Number.MAX_VALUE;for(let ce=0;ce<O.instancedDataCount;++ce){const we=16*(O.instancedDataOffset+ce),ve=A.instancedDataArray.float32,ee=[ve[we+4],ve[we+5],ve[we+6]];uP(Q,W,ve[we],0|ve[we+1]),sP(G,F,m,W,O.rotation,O.scale,ee,!1,!1,!1),m.projection.name==="globe"&&(G=tw(G,m));const ge=le([],m.projMatrix,G),be=a.queryGeometry,Ie=QI(be.isPointQuery()?be.screenBounds:be.screenGeometry,m,ge,F.aabb);Ie!=null&&(ae=Math.min(Ie,ae))}return ae!==Number.MAX_VALUE&&ae}}return!1}_handleOverridablePaintPropertyUpdate(a,t,s){return!(!this.layout||t.isDataDriven()||s.isDataDriven()||a!=="model-color"&&a!=="model-color-mix-intensity"&&a!=="model-rotation"&&a!=="model-scale"&&a!=="model-translation"&&a!=="model-emissive-strength")}_isPropertyZoomDependent(a){const t=this._transitionablePaint._values[a];return t!=null&&t.value!=null&&t.value.expression!=null&&t.value.expression instanceof rl}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends po{constructor(a,t,s,u){super(a,{layout:iE||(iE=new $i({"clip-layer-types":new Xt(ut.layout_clip["clip-layer-types"]),"clip-layer-scope":new Xt(ut.layout_clip["clip-layer-scope"])})),paint:sE||(sE=new $i({}))},t,s,u)}recalculate(a,t){super.recalculate(a,t)}createBucket(a){return new oE(a)}is3D(a){return!0}}};class Rj{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Mj{constructor(){this.tasks={},this.taskQueue=[],Zn(["process"],this),this.invoker=new Rj(this.process),this.nextId=0}add(t,s){const u=this.nextId++,h=function({type:m,isSymbolTile:_,zoom:S}){return S=S||0,m==="message"?0:m!=="maybePrepare"||_?m!=="parseTile"||_?m==="parseTile"&&_?300-S:m==="maybePrepare"&&_?400-S:500:200-S:100-S}(s);if(h===0){try{t()}finally{}return null}return this.tasks[u]={fn:t,metadata:s,priority:h,id:u},this.taskQueue.push(u),this.invoker.trigger(),{cancel:()=>{delete this.tasks[u]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(u=>!!this.tasks[u]),!this.taskQueue.length)return;const t=this.pick();if(t===null)return;const s=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!s)return;s.fn()}finally{}}pick(){let t=null,s=1/0;for(let h=0;h<this.taskQueue.length;h++){const m=this.tasks[this.taskQueue[h]];m.priority<s&&(s=m.priority,t=h)}if(t===null)return null;const u=this.taskQueue[t];return this.taskQueue.splice(t,1),u}remove(){this.invoker.remove()}}class dP{constructor(t,s,u){this.target=t,this.parent=s,this.mapId=u,this.callbacks={},this.cancelCallbacks={},Zn(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new Mj}send(t,s,u,h,m=!1,_){const S=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(u.metadata=_,this.callbacks[S]=u);const E=new Set;return this.target.postMessage({id:S,type:t,hasCallback:!!u,targetMapId:h,mustQueue:m,sourceMapId:this.mapId,data:zl(s,E)},E),{cancel:()=>{u&&delete this.callbacks[S],this.target.postMessage({id:S,type:"<cancel>",targetMapId:h,sourceMapId:this.mapId})}}}receive(t){const s=t.data;if(!s)return;const u=s.id;if(u&&(!s.targetMapId||this.mapId===s.targetMapId))if(s.type==="<cancel>"){const h=this.cancelCallbacks[u];delete this.cancelCallbacks[u],h&&h.cancel()}else if(s.mustQueue||xi(self)){const h=this.callbacks[u],m=this.scheduler.add(()=>this.processTask(u,s),h&&h.metadata||{type:"message"});m&&(this.cancelCallbacks[u]=m)}else this.processTask(u,s)}processTask(t,s){if(delete this.cancelCallbacks[t],s.type==="<response>"){const u=this.callbacks[t];delete this.callbacks[t],u&&(s.error?u(bc(s.error)):u(null,bc(s.data)))}else{const u=new Set,h=s.hasCallback?(_,S)=>{this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:_?zl(_):null,data:zl(S,u)},u)}:()=>{},m=bc(s.data);if(this.parent[s.type])this.parent[s.type](s.sourceMapId,m,h);else if(this.parent.getWorkerSource){const _=s.type.split("."),{source:S,scope:E}=m;this.parent.getWorkerSource(s.sourceMapId,_[0],S,E)[_[1]](m,h)}else h(new Error(`Could not find function ${s.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var Ry={workerUrl:"",workerClass:null,workerParams:void 0};const aw="mapboxgl_preloaded_worker_pool";class Gm{constructor(){this.active={}}acquire(t,s=Gm.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<s;)this.workers.push(Ry.workerClass!=null?new Ry.workerClass:new self.Worker(Ry.workerUrl,Ry.workerParams));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.workers&&this.numActive()===0&&(this.workers.forEach(s=>{s.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[aw]}numActive(){return Object.keys(this.active).length}}Gm.workerCount=2;class Vg{constructor(t,s,u="Worker",h=Gm.workerCount){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=ln();const m=this.workerPool.acquire(this.id,h);for(let _=0;_<m.length;_++){const S=new Vg.Actor(m[_],s,this.id);S.name=`${u} ${_}`,this.actors.push(S)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(t,s,u){Lt(this.actors,(h,m)=>{h.send(t,s,m)},u=u||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(t=>{t.remove()}),this.actors=[],this.workerPool.release(this.id)}}let My,lw;function Ux(){return My||(My=new Gm),My}Vg.Actor=dP;const cw=new xr(0,0,0),uw={PATH_RULE_NON_ZERO:1,PATH_RULE_EVEN_ODD:2},dw={LINE_CAP_BUTT:1,LINE_CAP_ROUND:2,LINE_CAP_SQUARE:3},$x={LINE_JOIN_MITER:1,LINE_JOIN_MITER_CLIP:2,LINE_JOIN_ROUND:3,LINE_JOIN_BEVEL:4},Lj={PAINT_ORDER_FILL_AND_STROKE:1},Ly={PATH_COMMAND_MOVE:1,PATH_COMMAND_LINE:2,PATH_COMMAND_QUAD:3,PATH_COMMAND_CUBIC:4,PATH_COMMAND_CLOSE:5},hP={MASK_TYPE_LUMINANCE:1};function Dj(a,t,s){a===1&&t.icons.push(function(u,h){return function(m){if(m.usvg_tree.height||(m.usvg_tree.height=m.usvg_tree.width),!m.metadata)return m;const{metadata:_}=m;if(_.content_area){const{content_area:S}=_;S.top==null&&(S.top=S.left),S.width==null&&(S.width=m.usvg_tree.width),S.height==null&&(S.height=S.width)}return _.stretch_x&&_.stretch_x.length&&fP(_,"x"),_.stretch_y&&_.stretch_y.length&&fP(_,"y"),m}(u.readFields(kj,{name:void 0},h))}(s,s.readVarint()+s.pos))}function fP(a,t){const s=[],u=a[`stretch_${t}`];let h=null;for(let m=0;m<u.length;m++)h===null?h=s.length===0?u[0]:s[s.length-1][1]+u[m]:(s.push([h,h+u[m]]),h=null);a[`stretch_${t}_areas`]=s}function kj(a,t,s){a===1?t.name=s.readString():a===2?t.metadata=function(u,h){return u.readFields(Oj,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},h)}(s,s.readVarint()+s.pos):a===3&&(t.usvg_tree=function(u,h){return u.readFields(Nj,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},h)}(s,s.readVarint()+s.pos),t.data="usvg_tree")}function Oj(a,t,s){a===1?t.stretch_x=s.readPackedVarint():a===2?t.stretch_y=s.readPackedVarint():a===3?t.content_area=function(u,h){return u.readFields(zj,{left:0},h)}(s,s.readVarint()+s.pos):a===4&&t.variables.push(function(u,h){return u.readFields(Fj,{name:void 0},h)}(s,s.readVarint()+s.pos))}function zj(a,t,s){a===1?t.left=s.readVarint():a===2?t.width=s.readVarint():a===3?t.top=s.readVarint():a===4&&(t.height=s.readVarint())}function Fj(a,t,s){a===1?t.name=s.readString():a===2&&(t.rgb_color=Wx(s.readVarint()),t.value="rgb_color")}function Nj(a,t,s){a===1?t.width=t.height=s.readVarint():a===2?t.height=s.readVarint():a===3?t.children.push(Hx(s,s.readVarint()+s.pos)):a===4?t.linear_gradients.push(function(u,h){return u.readFields(Gj,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},h)}(s,s.readVarint()+s.pos)):a===5?t.radial_gradients.push(function(u,h){return u.readFields(qj,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},h)}(s,s.readVarint()+s.pos)):a===7?t.clip_paths.push(function(u,h){return u.readFields(Zj,{children:[]},h)}(s,s.readVarint()+s.pos)):a===8&&t.masks.push(function(u,h){const m=u.readFields(Xj,{left:0,width:20,mask_type:hP.MASK_TYPE_LUMINANCE,children:[]},h);return m.height==null&&(m.height=m.width),m.top==null&&(m.top=m.left),m}(s,s.readVarint()+s.pos))}function Hx(a,t){return a.readFields(jj,{},t)}function jj(a,t,s){a===1?(t.group=function(u,h){return u.readFields(Bj,{opacity:255,children:[]},h)}(s,s.readVarint()+s.pos),t.node="group"):a===2&&(t.path=function(u,h){return u.readFields(Uj,{paint_order:1,commands:[],step:1,diffs:[],rule:uw.PATH_RULE_NON_ZERO},h)}(s,s.readVarint()+s.pos),t.node="path")}function Bj(a,t,s){a===1?t.transform=Gx(s,s.readVarint()+s.pos):a===2?t.opacity=s.readVarint():a===5?t.clip_path_idx=s.readVarint():a===6?t.mask_idx=s.readVarint():a===7&&t.children.push(Hx(s,s.readVarint()+s.pos))}function Gx(a,t){return a.readFields(Vj,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},t)}function Vj(a,t,s){a===1?t.sx=s.readFloat():a===2?t.ky=s.readFloat():a===3?t.kx=s.readFloat():a===4?t.sy=s.readFloat():a===5?t.tx=s.readFloat():a===6&&(t.ty=s.readFloat())}function Uj(a,t,s){a===1?t.fill=function(u,h){return u.readFields($j,{rgb_color:cw,paint:"rgb_color",opacity:255},h)}(s,s.readVarint()+s.pos):a===2?t.stroke=function(u,h){return u.readFields(Hj,{rgb_color:cw,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},h)}(s,s.readVarint()+s.pos):a===3?t.paint_order=s.readVarint():a===5?s.readPackedVarint(t.commands):a===6?t.step=s.readFloat():a===7?s.readPackedSVarint(t.diffs):a===8&&(t.rule=s.readVarint())}function $j(a,t,s){a===1?(t.rgb_color=Wx(s.readVarint()),t.paint="rgb_color"):a===2?(t.linear_gradient_idx=s.readVarint(),t.paint="linear_gradient_idx"):a===3?(t.radial_gradient_idx=s.readVarint(),t.paint="radial_gradient_idx"):a===5&&(t.opacity=s.readVarint())}function Wx(a){return new xr((a>>16&255)/255,(a>>8&255)/255,(255&a)/255,1)}function Hj(a,t,s){a===1?(t.rgb_color=Wx(s.readVarint()),t.paint="rgb_color"):a===2?(t.linear_gradient_idx=s.readVarint(),t.paint="linear_gradient_idx"):a===3?(t.radial_gradient_idx=s.readVarint(),t.paint="radial_gradient_idx"):a===5?s.readPackedFloat(t.dasharray):a===6?t.dashoffset=s.readFloat():a===7?t.miterlimit=s.readFloat():a===8?t.opacity=s.readVarint():a===9?t.width=s.readFloat():a===10?t.linecap=s.readVarint():a===11&&(t.linejoin=s.readVarint())}function Gj(a,t,s){a===1?t.transform=Gx(s,s.readVarint()+s.pos):a===2?t.spread_method=s.readVarint():a===3?t.stops.push(pP(s,s.readVarint()+s.pos)):a===4?t.x1=s.readFloat():a===5?t.y1=s.readFloat():a===6?t.x2=s.readFloat():a===7&&(t.y2=s.readFloat())}function pP(a,t){return a.readFields(Wj,{offset:0,opacity:255,rgb_color:cw},t)}function Wj(a,t,s){a===1?t.offset=s.readFloat():a===2?t.opacity=s.readVarint():a===3&&(t.rgb_color=Wx(s.readVarint()))}function qj(a,t,s){a===1?t.transform=Gx(s,s.readVarint()+s.pos):a===2?t.spread_method=s.readVarint():a===3?t.stops.push(pP(s,s.readVarint()+s.pos)):a===4?t.cx=s.readFloat():a===5?t.cy=s.readFloat():a===6?t.r=s.readFloat():a===7?t.fx=s.readFloat():a===8?t.fy=s.readFloat():a===9&&(t.fr=s.readFloat())}function Zj(a,t,s){a===1?t.transform=Gx(s,s.readVarint()+s.pos):a===2?t.clip_path_idx=s.readVarint():a===3&&t.children.push(Hx(s,s.readVarint()+s.pos))}function Xj(a,t,s){a===1?t.left=t.top=s.readFloat():a===2?t.width=t.height=s.readFloat():a===3?t.top=s.readFloat():a===4?t.height=s.readFloat():a===5?t.mask_type=s.readVarint():a===6?t.mask_idx=s.readVarint():a===7&&t.children.push(Hx(s,s.readVarint()+s.pos))}class Kj{static calculate(t={},s=[]){const u=new Map,h=new Map;if(Object.keys(t).length===0)return u;s.forEach(m=>{h.set(m.name,m.rgb_color||new xr(0,0,0))});for(const[m,_]of Object.entries(t))h.has(m)?u.set(h.get(m).toStringPremultipliedAlpha(),_):console.warn(`Ignoring unknown image variable "${m}"`);return u}}function Ug(a,t=255,s){const u=t/255,h=a.toStringPremultipliedAlpha(),m=s.has(h)?s.get(h).clone():a.clone();return m.a*=u,m.toString()}function Dy(a,t){if(!tm()){const s=document.createElement("canvas");return s.width=a,s.height=t,s}return new OffscreenCanvas(a,t)}function Yj(a,t){const s=Kj.calculate(t.params,a.metadata?a.metadata.variables:[]),u=a.usvg_tree,h=u.width,m=u.height,_=t.transform?t.transform:new DOMMatrix,S=Math.max(1,Math.round(h*_.a)),E=Math.max(1,Math.round(m*_.d)),A=new DOMMatrix([S/h,0,0,E/m,0,0]),D=Dy(S,E).getContext("2d");return hw(D,A,u,u,s),D.getImageData(0,0,S,E)}function hw(a,t,s,u,h){for(const m of u.children)mP(a,t,s,m,h)}function mP(a,t,s,u,h){u.group?(a.save(),function(m,_,S,E,A){const D=E.mask_idx!=null?S.masks[E.mask_idx]:null,O=E.clip_path_idx!=null?S.clip_paths[E.clip_path_idx]:null;if(E.transform&&(_=qx(E.transform).preMultiplySelf(_)),!function(W,Q,ae){return W.opacity!==255||Q||ae}(E,O!=null,D!=null))return void hw(m,_,S,E,A);const F=Dy(m.canvas.width,m.canvas.height),G=F.getContext("2d");hw(G,_,S,E,A),O&&wP(G,_,S,O),D&&SP(G,_,S,D,A),m.globalAlpha=E.opacity/255,m.drawImage(F,0,0)}(a,t,s,u.group,h),a.restore()):u.path&&(a.save(),function(m,_,S,E,A){const D=CP(E);m.setTransform(_),E.paint_order===Lj.PAINT_ORDER_FILL_AND_STROKE?(gP(m,S,E,D,A),yP(m,S,E,D,A)):(yP(m,S,E,D,A),gP(m,S,E,D,A))}(a,t,s,u.path,h),a.restore())}function gP(a,t,s,u,h){const m=s.fill;if(!m)return;const _=m.opacity/255;switch(m.paint){case"rgb_color":a.fillStyle=Ug(m.rgb_color,m.opacity,h);break;case"linear_gradient_idx":a.fillStyle=vP(a,t.linear_gradients[m.linear_gradient_idx],_,h);break;case"radial_gradient_idx":a.fillStyle=xP(a,t.radial_gradients[m.radial_gradient_idx],_,h)}a.fill(u,_P(s))}function _P(a){return a.rule===uw.PATH_RULE_NON_ZERO?"nonzero":a.rule===uw.PATH_RULE_EVEN_ODD?"evenodd":void 0}function yP(a,t,s,u,h){const m=s.stroke;if(!m)return;a.lineWidth=m.width,a.miterLimit=m.miterlimit,a.setLineDash(m.dasharray),a.lineDashOffset=m.dashoffset;const _=m.opacity/255;switch(m.paint){case"rgb_color":a.strokeStyle=Ug(m.rgb_color,m.opacity,h);break;case"linear_gradient_idx":a.strokeStyle=vP(a,t.linear_gradients[m.linear_gradient_idx],_,h);break;case"radial_gradient_idx":a.strokeStyle=xP(a,t.radial_gradients[m.radial_gradient_idx],_,h)}switch(m.linejoin){case $x.LINE_JOIN_MITER_CLIP:case $x.LINE_JOIN_MITER:a.lineJoin="miter";break;case $x.LINE_JOIN_ROUND:a.lineJoin="round";break;case $x.LINE_JOIN_BEVEL:a.lineJoin="bevel"}switch(m.linecap){case dw.LINE_CAP_BUTT:a.lineCap="butt";break;case dw.LINE_CAP_ROUND:a.lineCap="round";break;case dw.LINE_CAP_SQUARE:a.lineCap="square"}a.stroke(u)}function vP(a,t,s,u){if(t.stops.length===1){const F=t.stops[0];return Ug(F.rgb_color,F.opacity*s,u)}const h=qx(t.transform),{x1:m,y1:_,x2:S,y2:E}=t,A=h.transformPoint(new DOMPoint(m,_)),D=h.transformPoint(new DOMPoint(S,E)),O=a.createLinearGradient(A.x,A.y,D.x,D.y);for(const F of t.stops)O.addColorStop(F.offset,Ug(F.rgb_color,F.opacity*s,u));return O}function xP(a,t,s,u){if(t.stops.length===1){const F=t.stops[0];return Ug(F.rgb_color,F.opacity*s,u)}const h=qx(t.transform),{fx:m,fy:_,cx:S,cy:E}=t,A=h.transformPoint(new DOMPoint(m,_)),D=h.transformPoint(new DOMPoint(S,E)),O=a.createRadialGradient(A.x,A.y,0,D.x,D.y,t.r*((h.a+h.d)/2));for(const F of t.stops)O.addColorStop(F.offset,Ug(F.rgb_color,F.opacity*s,u));return O}function bP(a,t,s,u){const h=u.transform?qx(u.transform).preMultiplySelf(t):t,m=Dy(a.canvas.width,a.canvas.height),_=m.getContext("2d");for(const E of u.children)if(E.group)bP(_,h,s,E.group);else if(E.path){const A=E.path,D=new Path2D;D.addPath(CP(A),h),_.fill(D,_P(A))}const S=u.clip_path_idx!=null?s.clip_paths[u.clip_path_idx]:null;S&&wP(_,h,s,S),a.globalCompositeOperation="source-over",a.drawImage(m,0,0)}function wP(a,t,s,u){const h=Dy(a.canvas.width,a.canvas.height);bP(h.getContext("2d"),t,s,u),a.globalCompositeOperation="destination-in",a.drawImage(h,0,0)}function SP(a,t,s,u,h){if(u.children.length===0)return;const m=u.mask_idx!=null?s.masks[u.mask_idx]:null;m&&SP(a,t,s,m,h);const _=a.canvas.width,S=a.canvas.height,E=Dy(_,S),A=E.getContext("2d"),D=u.width,O=u.height,F=u.left,G=u.top,W=new Path2D,Q=new Path2D;Q.rect(F,G,D,O),W.addPath(Q,t),A.clip(W);for(const we of u.children)mP(A,t,s,we,h);const ae=A.getImageData(0,0,_,S),ce=ae.data;if(u.mask_type===hP.MASK_TYPE_LUMINANCE)for(let we=0;we<ce.length;we+=4)ce[we+3]=ce[we+3]/255*(.2126*ce[we]+.7152*ce[we+1]+.0722*ce[we+2]);A.putImageData(ae,0,0),a.globalCompositeOperation="destination-in",a.drawImage(E,0,0)}function qx(a){return a?new DOMMatrix([a.sx,a.ky,a.kx,a.sy,a.tx,a.ty]):new DOMMatrix}function CP(a){const t=new Path2D,s=a.step;let u=a.diffs[0]*s,h=a.diffs[1]*s;t.moveTo(u,h);for(let m=0,_=2;m<a.commands.length;m++)switch(a.commands[m]){case Ly.PATH_COMMAND_MOVE:u+=a.diffs[_++]*s,h+=a.diffs[_++]*s,t.moveTo(u,h);break;case Ly.PATH_COMMAND_LINE:u+=a.diffs[_++]*s,h+=a.diffs[_++]*s,t.lineTo(u,h);break;case Ly.PATH_COMMAND_QUAD:{const S=u+a.diffs[_++]*s,E=h+a.diffs[_++]*s;u=S+a.diffs[_++]*s,h=E+a.diffs[_++]*s,t.quadraticCurveTo(S,E,u,h);break}case Ly.PATH_COMMAND_CUBIC:{const S=u+a.diffs[_++]*s,E=h+a.diffs[_++]*s,A=S+a.diffs[_++]*s,D=E+a.diffs[_++]*s;u=A+a.diffs[_++]*s,h=D+a.diffs[_++]*s,t.bezierCurveTo(S,E,A,D,u,h);break}case Ly.PATH_COMMAND_CLOSE:t.closePath()}return t}class Zx{constructor(t){this.capacity=t,this.cache=new Map}get(t){if(!this.cache.has(t))return;const s=this.cache.get(t);return this.cache.delete(t),this.cache.set(t,s),s}put(t,s){this.cache.has(t)?this.cache.delete(t):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(t,s)}delete(t){this.cache.delete(t)}}un(Zx,"LRUCache");class fw{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(t){return new Tn(t,t.data)}getFromCache(t,s,u){return this.cacheMap.has(u)||this.cacheMap.set(u,new Zx(150)),this.cacheMap.get(u).get(Bl(t.toString(),s))}setInCache(t,s,u,h){this.cacheDependenciesMap.has(h)||this.cacheDependenciesMap.set(h,new Map),this.cacheMap.has(h)||this.cacheMap.set(h,new Zx(150));const m=this.cacheDependenciesMap.get(h),_=Bl(t.id.toString(),u);m.get(_)||m.set(_,new Set);const S=this.cacheMap.get(h),E=t.toString();m.get(_).add(E),S.put(Bl(t.toString(),u),s)}removeImagesFromCacheByIds(t,s,u=0){if(!this.cacheMap.has(u)||!this.cacheDependenciesMap.has(u))return;const h=this.cacheMap.get(u),m=this.cacheDependenciesMap.get(u);for(const _ of t){const S=Bl(_.toString(),s);if(m.has(S)){for(const E of m.get(S))h.delete(E);m.delete(S)}}}rasterize(t,s,u,h,m=Yj){const _=this.getFromCache(t,u,h);if(_)return _.clone();const S=m(s.icon,t.options),E=fw._getImage(S);return this.setInCache(t,E,u,h),E.clone()}}class TP{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,s){const u=this.toIdx(t,s);return{min:this.minimums[u],max:this.maximums[u]}}isLeaf(t,s){return this.leaves[this.toIdx(t,s)]}toIdx(t,s){return s*this.size+t}}function EP(a,t,s,u){let h=0,m=Number.MAX_VALUE;for(let _=0;_<3;_++)if(Math.abs(u[_])<1e-15){if(s[_]<a[_]||s[_]>t[_])return null}else{const S=1/u[_];let E=(a[_]-s[_])*S,A=(t[_]-s[_])*S;if(E>A){const D=E;E=A,A=D}if(E>h&&(h=E),A<m&&(m=A),h>m)return null}return h}function IP(a,t,s,u,h,m,_,S,E,A,D){const O=u-a,F=h-t,G=m-s,W=_-a,Q=S-t,ae=E-s,ce=D[1]*ae-D[2]*Q,we=D[2]*W-D[0]*ae,ve=D[0]*Q-D[1]*W,ee=O*ce+F*we+G*ve;if(Math.abs(ee)<1e-15)return null;const ge=1/ee,be=A[0]-a,Ie=A[1]-t,Fe=A[2]-s,$e=(be*ce+Ie*we+Fe*ve)*ge;if($e<0||$e>1)return null;const Ze=Ie*G-Fe*F,et=Fe*O-be*G,St=be*F-Ie*O,jt=(D[0]*Ze+D[1]*et+D[2]*St)*ge;return jt<0||$e+jt>1?null:(W*Ze+Q*et+ae*St)*ge}function PP(a,t,s){return(a-t)/(s-t)}function AP(a,t,s,u,h,m,_,S,E){const A=1<<s,D=m-u,O=_-h,F=(a+1)/A*D+u,G=(t+0)/A*O+h,W=(t+1)/A*O+h;S[0]=(a+0)/A*D+u,S[1]=G,E[0]=F,E[1]=W}class RP{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const s=function(m){const _=Math.ceil(Math.log2(m.dim/8)),S=[];let E=Math.ceil(Math.pow(2,_));const A=1/E,D=(G,W,Q,ae,ce)=>{const we=ae?1:0,ve=(G+1)*Q-we,ee=W*Q,ge=(W+1)*Q-we;ce[0]=G*Q,ce[1]=ee,ce[2]=ve,ce[3]=ge};let O=new TP(E);const F=[];for(let G=0;G<E*E;G++){D(G%E,Math.floor(G/E),A,!1,F);const W=Ip(F[0],F[1],m),Q=Ip(F[2],F[1],m),ae=Ip(F[2],F[3],m),ce=Ip(F[0],F[3],m);O.minimums.push(Math.min(W,Q,ae,ce)),O.maximums.push(Math.max(W,Q,ae,ce)),O.leaves.push(1)}for(S.push(O),E/=2;E>=1;E/=2){const G=S[S.length-1];O=new TP(E);for(let W=0;W<E*E;W++){D(W%E,Math.floor(W/E),2,!0,F);const Q=G.getElevation(F[0],F[1]),ae=G.getElevation(F[2],F[1]),ce=G.getElevation(F[2],F[3]),we=G.getElevation(F[0],F[3]),ve=G.isLeaf(F[0],F[1]),ee=G.isLeaf(F[2],F[1]),ge=G.isLeaf(F[2],F[3]),be=G.isLeaf(F[0],F[3]),Ie=Math.min(Q.min,ae.min,ce.min,we.min),Fe=Math.max(Q.max,ae.max,ce.max,we.max),$e=ve&&ee&&ge&&be;O.maximums.push(Fe),O.minimums.push(Ie),O.leaves.push(Fe-Ie<=5&&$e?1:0)}S.push(O)}return S}(this.dem),u=s.length-1,h=s[u];this._addNode(h.minimums[0],h.maximums[0],h.leaves[0]),this._construct(s,0,0,u,0)}raycastRoot(t,s,u,h,m,_,S=1){return EP([t,s,-100],[u,h,this.maximums[0]*S],m,_)}raycast(t,s,u,h,m,_,S=1){if(!this.nodeCount)return null;const E=this.raycastRoot(t,s,u,h,m,_,S);if(E==null)return null;const A=[],D=[],O=[],F=[],G=[{idx:0,t:E,nodex:0,nodey:0,depth:0}];for(;G.length>0;){const{idx:W,t:Q,nodex:ae,nodey:ce,depth:we}=G.pop();if(this.leaves[W]){AP(ae,ce,we,t,s,u,h,O,F);const ee=1<<we,ge=(ae+0)/ee,be=(ae+1)/ee,Ie=(ce+0)/ee,Fe=(ce+1)/ee,$e=Ip(ge,Ie,this.dem)*S,Ze=Ip(be,Ie,this.dem)*S,et=Ip(be,Fe,this.dem)*S,St=Ip(ge,Fe,this.dem)*S,jt=IP(O[0],O[1],$e,F[0],O[1],Ze,F[0],F[1],et,m,_),kt=IP(F[0],F[1],et,O[0],F[1],St,O[0],O[1],$e,m,_),Ft=Math.min(jt!==null?jt:Number.MAX_VALUE,kt!==null?kt:Number.MAX_VALUE);if(Ft!==Number.MAX_VALUE)return Ft;{const Gt=ze([],m,_,Q);if(MP($e,Ze,St,et,PP(Gt[0],O[0],F[0]),PP(Gt[1],O[1],F[1]))>=Gt[2])return Q}continue}let ve=0;for(let ee=0;ee<this._siblingOffset.length;ee++){AP((ae<<1)+this._siblingOffset[ee][0],(ce<<1)+this._siblingOffset[ee][1],we+1,t,s,u,h,O,F),O[2]=-100,F[2]=this.maximums[this.childOffsets[W]+ee]*S;const ge=EP(O,F,m,_);if(ge!=null){const be=ge;A[ee]=be;let Ie=!1;for(let Fe=0;Fe<ve&&!Ie;Fe++)be>=A[D[Fe]]&&(D.splice(Fe,0,ee),Ie=!0);Ie||(D[ve]=ee),ve++}}for(let ee=0;ee<ve;ee++){const ge=D[ee];G.push({idx:this.childOffsets[W]+ge,t:A[ge],nodex:(ae<<1)+this._siblingOffset[ge][0],nodey:(ce<<1)+this._siblingOffset[ge][1],depth:we+1})}}return null}_addNode(t,s,u){return this.minimums.push(t),this.maximums.push(s),this.leaves.push(u),this.childOffsets.push(0),this.nodeCount++}_construct(t,s,u,h,m){if(t[h].isLeaf(s,u)===1)return;this.childOffsets[m]||(this.childOffsets[m]=this.nodeCount);const _=h-1,S=t[_];let E=0,A=0;for(let D=0;D<this._siblingOffset.length;D++){const O=2*s+this._siblingOffset[D][0],F=2*u+this._siblingOffset[D][1],G=S.getElevation(O,F),W=S.isLeaf(O,F),Q=this._addNode(G.min,G.max,W);W&&(E|=1<<D),A||(A=Q)}for(let D=0;D<this._siblingOffset.length;D++)E&1<<D||this._construct(t,2*s+this._siblingOffset[D][0],2*u+this._siblingOffset[D][1],_,A+D)}}function MP(a,t,s,u,h,m){return kn(kn(a,s,m),kn(t,u,m),h)}function Ip(a,t,s){const u=s.dim,h=Xe(a*u-.5,0,u-1),m=Xe(t*u-.5,0,u-1),_=Math.floor(h),S=Math.floor(m),E=Math.min(_+1,u-1),A=Math.min(S+1,u-1);return MP(s.get(_,S),s.get(E,S),s.get(_,A),s.get(E,A),h-_,m-S)}const Jj={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Qj(a,t,s){return(256*a*256+256*t+s)/10-1e4}function eB(a,t,s){return 256*a+t+s/256-32768}class Xx{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,s,u,h=!1){if(this.uid=t,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return void gr(`"${u}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=s.height;const m=this.dim=s.height-2,_=new Uint32Array(s.data.buffer);if(this.pixels=new Uint8Array(s.data.buffer),this.floatView=new Float32Array(s.data.buffer),this.borderReady=h,this._modifiedForSources={},!h){for(let E=0;E<m;E++)_[this._idx(-1,E)]=_[this._idx(0,E)],_[this._idx(m,E)]=_[this._idx(m-1,E)],_[this._idx(E,-1)]=_[this._idx(E,0)],_[this._idx(E,m)]=_[this._idx(E,m-1)];_[this._idx(-1,-1)]=_[this._idx(0,0)],_[this._idx(m,-1)]=_[this._idx(m-1,0)],_[this._idx(-1,m)]=_[this._idx(0,m-1)],_[this._idx(m,m)]=_[this._idx(m-1,m-1)]}const S=u==="terrarium"?eB:Qj;for(let E=0;E<_.length;++E){const A=4*E;this.floatView[E]=S(this.pixels[A],this.pixels[A+1],this.pixels[A+2])}this._timestamp=sa.now()}_buildQuadTree(){this._tree=new RP(this)}get(t,s,u=!1){u&&(t=Xe(t,-1,this.dim),s=Xe(s,-1,this.dim));const h=this._idx(t,s);return this.floatView[h]}set(t,s,u){const h=this._idx(t,s),m=this.floatView[h];return this.floatView[h]=u,u-m}static getUnpackVector(t){return Jj[t]}_idx(t,s){if(t<-1||t>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(t+1)}static pack(t,s){const u=[0,0,0,0],h=Xx.getUnpackVector(s);let m=Math.floor((t+h[3])/h[2]);return u[2]=m%256,m=Math.floor(m/256),u[1]=m%256,m=Math.floor(m/256),u[0]=m,u}getPixels(){return new wr({width:this.stride,height:this.stride},this.pixels)}backfillBorder(t,s,u){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let h=s*this.dim,m=s*this.dim+this.dim,_=u*this.dim,S=u*this.dim+this.dim;switch(s){case-1:h=m-1;break;case 1:m=h+1}switch(u){case-1:_=S-1;break;case 1:S=_+1}const E=-s*this.dim,A=-u*this.dim;for(let D=_;D<S;D++)for(let O=h;O<m;O++){const F=4*this._idx(O,D),G=4*this._idx(O+E,D+A);this.pixels[F+0]=t.pixels[G+0],this.pixels[F+1]=t.pixels[G+1],this.pixels[F+2]=t.pixels[G+2],this.pixels[F+3]=t.pixels[G+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function tB(a,t,s){a===1?t.headerLength=s.readFixed32():a===2?t.x=s.readVarint():a===3?t.y=s.readVarint():a===4?t.z=s.readVarint():a===5&&t.layers.push(function(u,h){return u.readFields(oB,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},h)}(s,s.readVarint()+s.pos))}function nB(a,t,s){a===1?(t.delta_filter=function(u,h){return u.readFields(rB,{blockSize:0},h)}(s,s.readVarint()+s.pos),t.filter="delta_filter"):a===2?(s.readVarint(),t.filter="zigzag_filter"):a===3?(s.readVarint(),t.filter="bitshuffle_filter"):a===4&&(s.readVarint(),t.filter="byteshuffle_filter")}function rB(a,t,s){a===1&&(t.blockSize=s.readVarint())}function iB(a,t,s){a===1?(s.readVarint(),t.codec="gzip_data"):a===2?(s.readVarint(),t.codec="jpeg_image"):a===3?(s.readVarint(),t.codec="webp_image"):a===4&&(s.readVarint(),t.codec="png_image")}function sB(a,t,s){let u=0,h=0;a===1?t.firstByte=s.readFixed64():a===2?t.lastByte=s.readFixed64():a===3?t.filters.push(function(m,_){return m.readFields(nB,{},_)}(s,s.readVarint()+s.pos)):a===4?t.codec=function(m,_){return m.readFields(iB,{},_)}(s,s.readVarint()+s.pos):a===5?h=s.readFloat():a===6?u=s.readFloat():a===7?t.bands.push(s.readString()):a===8?t.offset=s.readDouble():a===9&&(t.scale=s.readDouble()),t.offset===0&&(t.offset=h),t.scale===0&&(t.scale=u)}function oB(a,t,s){a===1?t.version=s.readVarint():a===2?t.name=s.readString():a===3?t.units=s.readString():a===4?t.tileSize=s.readVarint():a===5?t.buffer=s.readVarint():a===6?t.pixelFormat=s.readVarint():a===7&&t.dataIndex.push(function(u,h){return u.readFields(sB,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},h)}(s,s.readVarint()+s.pos))}function aB(a,t,s){if(a===2)(function(u,h,m){u.readFields(lB,m,h)})(s,s.readVarint()+s.pos,t);else if(a===3)throw new Error("Not implemented")}function lB(a,t,s){if(a===1){let u=0;const h=s.readVarint()+s.pos;for(;s.pos<h;)t[u++]=s.readVarint()}}function cB(a,t){if(t.length!==4)throw new Error(`Expected data of dimension 4 but got ${t.length}.`);let s=t[3];for(let u=2;u>=1;u--){const h=u===1?1:0,m=u===2?1:0;for(let _=0;_<t[0];_++){const S=t[1]*_;for(let E=h;E<t[1];E++){const A=t[2]*(E+S);for(let D=m;D<t[2];D++){const O=t[3]*(D+A);for(let F=0;F<t[3];F++){const G=O+F;a[G]+=a[G-s]}}}}s*=t[u]}return a}function uB(a){for(let t=0,s=a.length;t<s;t++)a[t]=a[t]>>>1^-(1&a[t]);return a}function dB(a,t){switch(t){case"uint32":return a;case"uint16":for(let s=0;s<a.length;s+=2){const u=a[s],h=a[s+1];a[s]=(240&u)>>4|(61440&u)>>8|(240&h)<<4|61440&h,a[s+1]=15&u|(3840&u)>>4|(15&h)<<8|(3840&h)<<4}return a;case"uint8":for(let s=0;s<a.length;s+=4){const u=a[s],h=a[s+1],m=a[s+2],_=a[s+3];a[s+0]=(192&u)>>6|(192&h)>>4|(192&m)>>2|192&_,a[s+1]=(48&u)>>4|(48&h)>>2|48&m|(48&_)<<2,a[s+2]=(12&u)>>2|12&h|(12&m)<<2|(12&_)<<4,a[s+3]=3&u|(3&h)<<2|(3&m)<<4|(3&_)<<6}return a;default:throw new Error(`Invalid pixel format, "${t}"`)}}un(Xx,"DEMData"),un(RP,"DemMinMaxQuadTree",{omit:["dem"]});var Ic=Uint8Array,ky=Uint16Array,hB=Int32Array,LP=new Ic([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),DP=new Ic([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),fB=new Ic([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),kP=function(a,t){for(var s=new ky(31),u=0;u<31;++u)s[u]=t+=1<<a[u-1];var h=new hB(s[30]);for(u=1;u<30;++u)for(var m=s[u];m<s[u+1];++m)h[m]=m-s[u]<<5|u;return{b:s,r:h}},OP=kP(LP,2),zP=OP.b,pB=OP.r;zP[28]=258,pB[258]=28;for(var mB=kP(DP,0).b,FP=new ky(32768),Vs=0;Vs<32768;++Vs){var $g=(43690&Vs)>>1|(21845&Vs)<<1;FP[Vs]=((65280&($g=(61680&($g=(52428&$g)>>2|(13107&$g)<<2))>>4|(3855&$g)<<4))>>8|(255&$g)<<8)>>1}var Oy=function(a,t,s){for(var u=a.length,h=0,m=new ky(t);h<u;++h)a[h]&&++m[a[h]-1];var _,S=new ky(t);for(h=1;h<t;++h)S[h]=S[h-1]+m[h-1]<<1;_=new ky(1<<t);var E=15-t;for(h=0;h<u;++h)if(a[h])for(var A=h<<4|a[h],D=t-a[h],O=S[a[h]-1]++<<D,F=O|(1<<D)-1;O<=F;++O)_[FP[O]>>E]=A;return _},zy=new Ic(288);for(Vs=0;Vs<144;++Vs)zy[Vs]=8;for(Vs=144;Vs<256;++Vs)zy[Vs]=9;for(Vs=256;Vs<280;++Vs)zy[Vs]=7;for(Vs=280;Vs<288;++Vs)zy[Vs]=8;var NP=new Ic(32);for(Vs=0;Vs<32;++Vs)NP[Vs]=5;var gB=Oy(zy,9),_B=Oy(NP,5),pw=function(a){for(var t=a[0],s=1;s<a.length;++s)a[s]>t&&(t=a[s]);return t},ld=function(a,t,s){var u=t/8|0;return(a[u]|a[u+1]<<8)>>(7&t)&s},mw=function(a,t){var s=t/8|0;return(a[s]|a[s+1]<<8|a[s+2]<<16)>>(7&t)},yB=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],cd=function(a,t,s){var u=new Error(t||yB[a]);if(u.code=a,Error.captureStackTrace&&Error.captureStackTrace(u,cd),!s)throw u;return u},vB=new Ic(0),xB=typeof TextDecoder<"u"&&new TextDecoder;try{xB.decode(vB,{stream:!0})}catch{}const bB={gzip_data:"gzip"};class pu extends Error{constructor(t){super(t),this.name="MRTError"}}const wB={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},jP={uint32:1,uint16:2,uint8:4},SB={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let gw;class Kx{constructor(t=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=t}getLayer(t){const s=this.layers[t];if(!s)throw new pu(`Layer '${t}' not found`);return s}getHeaderLength(t){const s=new Uint8Array(t),u=new DataView(t);if(s[0]!==13)throw new pu("File is not a valid MRT.");return u.getUint32(1,!0)}parseHeader(t){const s=new Uint8Array(t),u=this.getHeaderLength(t);if(s.length<u)throw new pu(`Expected header with length >= ${u} but got buffer of length ${s.length}`);const h=function(m,_){return m.readFields(tB,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new gw(s.subarray(0,u)));if(!isNaN(this.x)&&(this.x!==h.x||this.y!==h.y||this.z!==h.z))throw new pu(`Invalid attempt to parse header ${h.z}/${h.x}/${h.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=h.x,this.y=h.y,this.z=h.z;for(const m of h.layers)this.layers[m.name]=new BP(m,{cacheSize:this._cacheSize});return this}createDecodingTask(t){const s=[],u=this.getLayer(t.layerName);for(let h of t.blockIndices){const m=u.dataIndex[h],_=m.firstByte-t.firstByte,S=m.lastByte-t.firstByte;if(u._blocksInProgress.has(h))continue;const E={layerName:u.name,firstByte:_,lastByte:S,pixelFormat:u.pixelFormat,blockIndex:h,blockShape:[m.bands.length].concat(u.bandShape),buffer:u.buffer,codec:m.codec.codec,filters:m.filters.map(A=>A.filter)};u._blocksInProgress.add(h),s.push(E)}return new VP(s,()=>{s.forEach(h=>u._blocksInProgress.delete(h.blockIndex))},(h,m)=>{if(s.forEach(_=>u._blocksInProgress.delete(_.blockIndex)),h)throw h;m.forEach(_=>{this.getLayer(_.layerName).processDecodedData(_)})})}}class BP{constructor({version:t,name:s,units:u,tileSize:h,pixelFormat:m,buffer:_,dataIndex:S},E){if(this.version=t,this.version!==1)throw new pu(`Cannot parse raster layer encoded with MRT version ${t}`);this.name=s,this.units=u,this.tileSize=h,this.buffer=_,this.pixelFormat=wB[m],this.dataIndex=S,this.bandShape=[h+2*_,h+2*_,jP[this.pixelFormat]],this._decodedBlocks=new Zx(E?E.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return jP[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:t})=>t).flat()}processDecodedData(t){const s=t.blockIndex.toString();this._decodedBlocks.get(s)||this._decodedBlocks.put(s,t.data)}getBlockForBand(t){let s=0;switch(typeof t){case"string":for(const[u,h]of this.dataIndex.entries()){for(const[m,_]of h.bands.entries())if(_===t)return{bandIndex:s+m,blockIndex:u,blockBandIndex:m};s+=h.bands.length}break;case"number":for(const[u,h]of this.dataIndex.entries()){if(t>=s&&t<s+h.bands.length)return{bandIndex:t,blockIndex:u,blockBandIndex:t-s};s+=h.bands.length}break;default:throw new pu(`Invalid band \`${JSON.stringify(t)}\`. Expected string or integer.`)}return{blockIndex:-1,blockBandIndex:-1}}getDataRange(t){let s=1/0,u=-1/0;const h=[],m=new Set;for(const _ of t){const{blockIndex:S}=this.getBlockForBand(_);if(S<0)throw new pu(`Invalid band: ${JSON.stringify(_)}`);const E=this.dataIndex[S];h.includes(S)||h.push(S),m.add(S),s=Math.min(s,E.firstByte),u=Math.max(u,E.lastByte)}if(m.size>this.cacheSize)throw new pu(`Number of blocks to decode (${m.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:s,lastByte:u,blockIndices:h}}hasBand(t){const{blockIndex:s}=this.getBlockForBand(t);return s>=0}hasDataForBand(t){const{blockIndex:s}=this.getBlockForBand(t);return s>=0&&!!this._decodedBlocks.get(s.toString())}getBandView(t){const{blockIndex:s,blockBandIndex:u}=this.getBlockForBand(t);if(s<0)throw new pu(`Band not found: ${JSON.stringify(t)}`);const h=this._decodedBlocks.get(s.toString());if(!h)throw new pu(`Data for band ${JSON.stringify(t)} of layer "${this.name}" not decoded.`);const m=this.dataIndex[s],_=this.bandShape.reduce((A,D)=>A*D,1),S=u*_,E=h.subarray(S,S+_);return{data:E,bytes:new Uint8Array(E.buffer).subarray(E.byteOffset,E.byteOffset+E.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:m.offset,scale:m.scale}}}Kx.setPbf=function(a){gw=a};class VP{constructor(t,s,u){this.tasks=t,this._onCancel=s,this._onComplete=u,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(t,s){this._finalized||(this._onComplete(t,s),this._finalized=!0)}}Kx.performDecoding=function(a,t){const s=new Uint8Array(a);return Promise.all(t.tasks.map(u=>{const{layerName:h,firstByte:m,lastByte:_,pixelFormat:S,blockShape:E,blockIndex:A,filters:D,codec:O}=u,F=s.subarray(m,_+1),G=new Uint32Array(E[0]*E[1]*E[2]);let W;if(O!=="gzip_data")throw new pu(`Unhandled codec: ${O}`);return W=function(Q,ae){if(!globalThis.DecompressionStream&&ae==="gzip_data")return Promise.resolve(((ee=function(Ie){Ie[0]==31&&Ie[1]==139&&Ie[2]==8||cd(6,"invalid gzip data");var Fe=Ie[3],$e=10;4&Fe&&($e+=2+(Ie[10]|Ie[11]<<8));for(var Ze=(Fe>>3&1)+(Fe>>4&1);Ze>0;Ze-=!Ie[$e++]);return $e+(2&Fe)}(ve=Q))+8>ve.length&&cd(6,"invalid gzip data"),function(Ie,Fe,$e,Ze){var et=Ie.length;if(!et||Fe.f&&!Fe.l)return $e||new Ic(0);var St=!$e,jt=St||Fe.i!=2,kt=Fe.i;St&&($e=new Ic(3*et));var Ft,Gt,vt=function(cs){var zi=$e.length;if(cs>zi){var Ti=new Ic(Math.max(2*zi,cs));Ti.set($e),$e=Ti}},zt=Fe.f||0,gt=Fe.p||0,bt=Fe.b||0,qt=Fe.l,Kt=Fe.d,En=Fe.m,_n=Fe.n,sn=8*et;do{if(!qt){zt=ld(Ie,gt,1);var Wt=ld(Ie,gt+1,3);if(gt+=3,!Wt){var Wn=Ie[(Ee=4+((gt+7)/8|0))-4]|Ie[Ee-3]<<8,wn=Ee+Wn;if(wn>et){kt&&cd(0);break}jt&&vt(bt+Wn),$e.set(Ie.subarray(Ee,wn),bt),Fe.b=bt+=Wn,Fe.p=gt=8*wn,Fe.f=zt;continue}if(Wt==1)qt=gB,Kt=_B,En=9,_n=5;else if(Wt==2){var Sn=ld(Ie,gt,31)+257,$n=ld(Ie,gt+10,15)+4,Jn=Sn+ld(Ie,gt+5,31)+1;gt+=14;for(var ir=new Ic(Jn),yr=new Ic(19),fr=0;fr<$n;++fr)yr[fB[fr]]=ld(Ie,gt+3*fr,7);gt+=3*$n;var ar=pw(yr),_i=(1<<ar)-1,Ri=Oy(yr,ar);for(fr=0;fr<Jn;){var Ee,Ae=Ri[ld(Ie,gt,_i)];if(gt+=15&Ae,(Ee=Ae>>4)<16)ir[fr++]=Ee;else{var Et=0,Jt=0;for(Ee==16?(Jt=3+ld(Ie,gt,3),gt+=2,Et=ir[fr-1]):Ee==17?(Jt=3+ld(Ie,gt,7),gt+=3):Ee==18&&(Jt=11+ld(Ie,gt,127),gt+=7);Jt--;)ir[fr++]=Et}}var an=ir.subarray(0,Sn),on=ir.subarray(Sn);En=pw(an),_n=pw(on),qt=Oy(an,En),Kt=Oy(on,_n)}else cd(1);if(gt>sn){kt&&cd(0);break}}jt&&vt(bt+131072);for(var Cn=(1<<En)-1,jn=(1<<_n)-1,Er=gt;;Er=gt){var Ir=(Et=qt[mw(Ie,gt)&Cn])>>4;if((gt+=15&Et)>sn){kt&&cd(0);break}if(Et||cd(2),Ir<256)$e[bt++]=Ir;else{if(Ir==256){Er=gt,qt=null;break}var lr=Ir-254;Ir>264&&(lr=ld(Ie,gt,(1<<(Pr=LP[fr=Ir-257]))-1)+zP[fr],gt+=Pr);var li=Kt[mw(Ie,gt)&jn],Ci=li>>4;if(li||cd(3),gt+=15&li,on=mB[Ci],Ci>3){var Pr=DP[Ci];on+=mw(Ie,gt)&(1<<Pr)-1,gt+=Pr}if(gt>sn){kt&&cd(0);break}jt&&vt(bt+131072);var Yi=bt+lr;if(bt<on){var Mi=0-on,oi=Math.min(on,Yi);for(Mi+bt<0&&cd(3);bt<oi;++bt)$e[bt]=(void 0)[Mi+bt]}for(;bt<Yi;++bt)$e[bt]=$e[bt-on]}}Fe.l=qt,Fe.p=Er,Fe.b=bt,Fe.f=zt,qt&&(zt=1,Fe.m=En,Fe.d=Kt,Fe.n=_n)}while(!zt);return bt!=$e.length&&St?(Ft=$e,((Gt=bt)==null||Gt>Ft.length)&&(Gt=Ft.length),new Ic(Ft.subarray(0,Gt))):$e.subarray(0,bt)}(ve.subarray(ee,-8),{i:2},new Ic(((ce=ve)[(we=ce.length)-4]|ce[we-3]<<8|ce[we-2]<<16|ce[we-1]<<24)>>>0))));var ce,we,ve,ee;const ge=bB[ae];if(!ge)throw new Error(`Unhandled codec: ${ae}`);const be=new globalThis.DecompressionStream(ge);return new Response(new Blob([Q]).stream().pipeThrough(be)).arrayBuffer().then(Ie=>new Uint8Array(Ie))}(F,O).then(Q=>(function(ae,ce){ae.readFields(aB,ce)}(new gw(Q),G),new SB[S](G.buffer))),W.then(Q=>{for(let ae=D.length-1;ae>=0;ae--)switch(D[ae]){case"delta_filter":cB(Q,E);break;case"zigzag_filter":uB(Q);break;case"bitshuffle_filter":dB(Q,S);break;default:throw new pu(`Unhandled filter "${D[ae]}"`)}return{layerName:h,blockIndex:A,data:Q}}).catch(Q=>{throw Q})}))},un(VP,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]}),un(Kx,"MapboxRasterTile"),un(BP,"MapboxRasterLayer",{omit:["_blocksInProgress"]});let Fy,_w,ud,Hg,yw,Gg=null;function UP(){return xi(self)&&self.worker.dracoUrl?self.worker.dracoUrl:_w||os.DRACO_URL}function $P(){if(xi(self)&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Hg)return Hg;const a=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Hg=WebAssembly.validate(a)?os.MESHOPT_SIMD_URL:os.MESHOPT_URL,Hg}const Yx={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},CB={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},Ny={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function HP(a,t,s){const u=s.json.bufferViews.length,h=s.buffers.length;t.bufferView=u,s.json.bufferViews[u]={buffer:h,byteLength:a.byteLength},s.buffers[h]=a}const vw="KHR_draco_mesh_compression";function TB(a,t){const s=a.extensions&&a.extensions[vw];if(!s)return;const u=new ud.Decoder,h=ZP(t,s.bufferView),m=new ud.Mesh;if(!u.DecodeArrayToMesh(h,h.byteLength,m))throw new Error("Failed to decode Draco mesh");const _=t.json.accessors[a.indices],S=Yx[_.componentType],E=_.count*S.BYTES_PER_ELEMENT,A=ud._malloc(E);S===Uint16Array?u.GetTrianglesUInt16Array(m,E,A):u.GetTrianglesUInt32Array(m,E,A),HP(ud.memory.buffer.slice(A,A+E),_,t),ud._free(A);for(const D of Object.keys(s.attributes)){const O=u.GetAttributeByUniqueId(m,s.attributes[D]),F=t.json.accessors[a.attributes[D]],G=CB[F.componentType],W=F.count*Ny[F.type]*Yx[F.componentType].BYTES_PER_ELEMENT,Q=ud._malloc(W);u.GetAttributeDataArrayForAllPoints(m,O,ud[G],W,Q),HP(ud.memory.buffer.slice(Q,Q+W),F,t),ud._free(Q)}u.destroy(),m.destroy(),delete a.extensions[vw]}const Jx="EXT_meshopt_compression";function EB(a,t){if(!a.extensions||!a.extensions[Jx])return;const s=a.extensions[Jx],u=new Uint8Array(t.buffers[s.buffer],s.byteOffset||0,s.byteLength||0),h=new Uint8Array(s.count*s.byteStride);yw.decodeGltfBuffer(h,s.count,s.byteStride,u,s.mode,s.filter),a.buffer=t.buffers.length,a.byteOffset=0,t.buffers[a.buffer]=h.buffer,delete a.extensions[Jx]}const GP=1179937895,WP=new TextDecoder("utf8");function qP(a,t){return new URL(a,t).href}function IB(a,t,s,u){return fetch(qP(a.uri,u)).then(h=>h.arrayBuffer()).then(h=>{t.buffers[s]=h})}function ZP(a,t){const s=a.json.bufferViews[t];return new Uint8Array(a.buffers[s.buffer],s.byteOffset||0,s.byteLength)}function PB(a,t,s,u){if(a.uri){const h=qP(a.uri,u);return fetch(h).then(m=>m.blob()).then(m=>createImageBitmap(m)).then(m=>{t.images[s]=m})}if(a.bufferView!==void 0){const h=ZP(t,a.bufferView),m=new Blob([h],{type:a.mimeType});return createImageBitmap(m).then(_=>{t.images[s]=_})}}function XP(a,t=0,s){const u={json:null,images:[],buffers:[]};if(new Uint32Array(a,t,1)[0]===GP){const D=new Uint32Array(a,t);let O=2;const F=(D[O++]>>2)-3,G=D[O++]>>2;if(O++,u.json=JSON.parse(WP.decode(D.subarray(O,O+G))),O+=G,O<F){const W=D[O++];O++;const Q=t+(O<<2);u.buffers[0]=a.slice(Q,Q+W)}}else u.json=JSON.parse(WP.decode(new Uint8Array(a,t)));const{buffers:h,images:m,meshes:_,extensionsUsed:S,bufferViews:E}=u.json;let A=Promise.resolve();if(h){const D=[];for(let O=0;O<h.length;O++){const F=h[O];F.uri?D.push(IB(F,u,O,s)):u.buffers[O]||(u.buffers[O]=null)}A=Promise.all(D)}return A.then(()=>{const D=[],O=S&&S.includes(vw),F=S&&S.includes(Jx);if(O&&D.push(function(){if(!ud)return Fy??(Fy=function(G){let W,Q=null;function ae(){W=new Uint8Array(Q.buffer)}function ce(){throw new Error("Unexpected Draco error.")}const we={a:{a:ce,d:function(ve,ee,ge){return W.copyWithin(ve,ee,ee+ge)},c:function(ve){const ee=W.length,ge=Math.max(ve>>>0,Math.ceil(1.2*ee)),be=Math.ceil((ge-ee)/65536);try{return Q.grow(be),ae(),!0}catch{return!1}},b:ce}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(G,we):G.then(ve=>ve.arrayBuffer()).then(ve=>WebAssembly.instantiate(ve,we))).then(ve=>{const{Rb:ee,Qb:ge,P:be,T:Ie,X:Fe,Ja:$e,La:Ze,Qa:et,Va:St,Wa:jt,eb:kt,jb:Ft,f:Gt,e:vt,yb:zt,zb:gt,Ab:bt,Bb:qt,Db:Kt,Gb:En}=ve.instance.exports;Q=vt;const _n=(()=>{let sn=0,Wt=0,Wn=0,wn=0;return Sn=>{Wn&&(ee(wn),ee(sn),Wt+=Wn,Wn=sn=0),sn||(Wt+=128,sn=ge(Wt));const $n=Sn.length+7&-8;let Jn=sn;$n>=Wt&&(Wn=$n,Jn=wn=ge($n));for(let ir=0;ir<Sn.length;ir++)W[Jn+ir]=Sn[ir];return Jn}})();return ae(),Gt(),{memory:vt,_free:ee,_malloc:ge,Mesh:class{constructor(){this.ptr=be()}destroy(){Ie(this.ptr)}},Decoder:class{constructor(){this.ptr=$e()}destroy(){Ft(this.ptr)}DecodeArrayToMesh(sn,Wt,Wn){const wn=_n(sn),Sn=Ze(this.ptr,wn,Wt,Wn.ptr);return!!Fe(Sn)}GetAttributeByUniqueId(sn,Wt){return{ptr:et(this.ptr,sn.ptr,Wt)}}GetTrianglesUInt16Array(sn,Wt,Wn){St(this.ptr,sn.ptr,Wt,Wn)}GetTrianglesUInt32Array(sn,Wt,Wn){jt(this.ptr,sn.ptr,Wt,Wn)}GetAttributeDataArrayForAllPoints(sn,Wt,Wn,wn,Sn){kt(this.ptr,sn.ptr,Wt.ptr,Wn,wn,Sn)}},DT_INT8:zt(),DT_UINT8:gt(),DT_INT16:bt(),DT_UINT16:qt(),DT_UINT32:Kt(),DT_FLOAT32:En()}})}(fetch(UP())),Fy.then(G=>{ud=G,Fy=void 0}))}()),F&&D.push(function(){if(yw)return;const G=function(W){let Q;const ae=WebAssembly.instantiateStreaming(W,{}).then(ve=>{Q=ve.instance,Q.exports.__wasm_call_ctors()}),ce={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},we={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:ae,supported:!0,decodeGltfBuffer(ve,ee,ge,be,Ie,Fe){(function($e,Ze,et,St,jt,kt,Ft){const Gt=$e.exports.sbrk,vt=St+3&-4,zt=Gt(vt*jt),gt=Gt(kt.length),bt=new Uint8Array($e.exports.memory.buffer);bt.set(kt,gt);const qt=Ze(zt,St,jt,gt,kt.length);if(qt===0&&Ft&&Ft(zt,vt,jt),et.set(bt.subarray(zt,zt+St*jt)),Gt(zt-Gt(0)),qt!==0)throw new Error(`Malformed buffer data: ${qt}`)})(Q,Q.exports[we[Ie]],ve,ee,ge,be,Q.exports[ce[Fe]])}}}(fetch($P()));return G.ready.then(()=>{yw=G})}()),m)for(let G=0;G<m.length;G++)D.push(PB(m[G],u,G,s));return(D.length?Promise.all(D):Promise.resolve()).then(()=>{if(O&&_)for(const{primitives:G}of _)for(const W of G)TB(W,u);if(F&&_&&E)for(const G of E)EB(G,u);return u})})}function Wm(a,t){const s=a.json.bufferViews[t.bufferView],u=Yx[t.componentType];return new u(a.buffers[s.buffer],(t.byteOffset||0)+(s.byteOffset||0),t.count*(s.byteStride&&s.byteStride!==Ny[t.type]*u.BYTES_PER_ELEMENT?s.byteStride/u.BYTES_PER_ELEMENT:Ny[t.type]))}function xw(a,t,s,u){const h=Yx[t.componentType],m=function(D){switch(D){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(h),_=a.json.bufferViews[t.bufferView],S=_.byteStride?_.byteStride/h.BYTES_PER_ELEMENT:Ny[t.type],E=s.float32,A=E.length/s.capacity;for(let D=0,O=0;D<t.count*S;D+=S,O+=A)for(let F=0;F<A;F++)E[O+F]=u[D+F]*m;s._trim()}function AB(a,t,s){const u=a.indices,h=a.attributes,m={};m.indexArray=new gs;const _=t.json.accessors[u],S=_.count/3;m.indexArray.reserve(S);const E=Wm(t,_);for(let F=0;F<S;F++)m.indexArray.emplaceBack(E[3*F],E[3*F+1],E[3*F+2]);m.indexArray._trim(),m.vertexArray=new sl;const A=t.json.accessors[h.POSITION];m.vertexArray.reserve(A.count);const D=Wm(t,A);for(let F=0;F<A.count;F++)m.vertexArray.emplaceBack(D[3*F],D[3*F+1],D[3*F+2]);if(m.vertexArray._trim(),m.aabb=new Ai(A.min,A.max),m.centroid=function(F,G){const W=[0,0,0],Q=F.length;if(Q>0){for(let ae=0;ae<Q;ae++){const ce=3*F[ae];W[0]+=G[ce],W[1]+=G[ce+1],W[2]+=G[ce+2]}W[0]/=Q,W[1]/=Q,W[2]/=Q}return W}(E,D),h.COLOR_0!==void 0){const F=t.json.accessors[h.COLOR_0],G=Ny[F.type],W=Wm(t,F);m.colorArray=G===3?new sl:new Xs,m.colorArray.resize(F.count),xw(t,F,m.colorArray,W)}if(h.NORMAL!==void 0){m.normalArray=new sl;const F=t.json.accessors[h.NORMAL];m.normalArray.resize(F.count);const G=Wm(t,F);xw(t,F,m.normalArray,G)}if(h.TEXCOORD_0!==void 0&&s.length>0){m.texcoordArray=new lu;const F=t.json.accessors[h.TEXCOORD_0];m.texcoordArray.resize(F.count);const G=Wm(t,F);xw(t,F,m.texcoordArray,G)}if(h._FEATURE_ID_RGBA4444!==void 0){const F=t.json.accessors[h._FEATURE_ID_RGBA4444];t.json.extensionsUsed&&t.json.extensionsUsed.includes("EXT_meshopt_compression")&&(m.featureData=Wm(t,F))}h._FEATURE_RGBA4444!==void 0&&(m.featureData=new Uint32Array(Wm(t,t.json.accessors[h._FEATURE_RGBA4444]).buffer));const O=a.material;return m.material=function(F,G){const{emissiveFactor:W=[0,0,0],alphaMode:Q="OPAQUE",alphaCutoff:ae=.5,normalTexture:ce,occlusionTexture:we,emissiveTexture:ve,doubleSided:ee}=F,{baseColorFactor:ge=[1,1,1,1],metallicFactor:be=1,roughnessFactor:Ie=1,baseColorTexture:Fe,metallicRoughnessTexture:$e}=F.pbrMetallicRoughness||{},Ze=we?G[we.index]:void 0;if(we&&we.extensions&&we.extensions.KHR_texture_transform&&Ze){const et=we.extensions.KHR_texture_transform;Ze.offsetScale=[et.offset[0],et.offset[1],et.scale[0],et.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new xr(...ge),metallicFactor:be,roughnessFactor:Ie,baseColorTexture:Fe?G[Fe.index]:void 0,metallicRoughnessTexture:$e?G[$e.index]:void 0},doubleSided:ee,emissiveFactor:W,alphaMode:Q,alphaCutoff:ae,normalTexture:ce?G[ce.index]:void 0,occlusionTexture:Ze,emissionTexture:ve?G[ve.index]:void 0,defined:F.defined===void 0}}(O!==void 0?t.json.materials[O]:{defined:!1},s),m}function KP(a,t,s){const{matrix:u,rotation:h,translation:m,scale:_,mesh:S,extras:E,children:A}=a,D={};if(D.matrix=u||function(O,F,G,W){var Q=F[0],ae=F[1],ce=F[2],we=F[3],ve=Q+Q,ee=ae+ae,ge=ce+ce,be=Q*ve,Ie=Q*ee,Fe=Q*ge,$e=ae*ee,Ze=ae*ge,et=ce*ge,St=we*ve,jt=we*ee,kt=we*ge,Ft=W[0],Gt=W[1],vt=W[2];return O[0]=(1-($e+et))*Ft,O[1]=(Ie+kt)*Ft,O[2]=(Fe-jt)*Ft,O[3]=0,O[4]=(Ie-kt)*Gt,O[5]=(1-(be+et))*Gt,O[6]=(Ze+St)*Gt,O[7]=0,O[8]=(Fe+jt)*vt,O[9]=(Ze-St)*vt,O[10]=(1-(be+$e))*vt,O[11]=0,O[12]=G[0],O[13]=G[1],O[14]=G[2],O[15]=1,O}([],h||[0,0,0,1],m||[0,0,0],_||[1,1,1]),S!==void 0){D.meshes=s[S];const O=D.anchor=[0,0];for(const F of D.meshes){const{min:G,max:W}=F.aabb;O[0]+=G[0]+W[0],O[1]+=G[1]+W[1]}O[0]=Math.floor(O[0]/D.meshes.length/2),O[1]=Math.floor(O[1]/D.meshes.length/2)}if(E&&(E.id&&(D.id=E.id),E.lights&&(D.lights=function(O){if(!O.length)return[];const F=function(ce){const we=atob(ce),ve=new Uint8Array(we.length);for(let ee=0;ee<we.length;ee++)ve[ee]=we.codePointAt(ee);return ve}(O),G=[],W=F.length/24,Q=new Uint16Array(F.buffer),ae=new Float32Array(F.buffer);for(let ce=0;ce<W;ce++){const we=Q[2*ce*6]/30,ve=Q[2*ce*6+1]/30,ee=Q[2*ce*6+10]/100,ge=ae[6*ce+1],be=ae[6*ce+2],Ie=ae[6*ce+3],Fe=ae[6*ce+4],$e=Ie-ge,Ze=Fe-be,et=Math.hypot($e,Ze);G.push({pos:[ge+.5*$e,be+.5*Ze,ve],normal:[Ze/et,-$e/et,0],width:et,height:we,depth:ee,points:[ge,be,Ie,Fe]})}return G}(E.lights))),A){const O=[];for(const F of A)O.push(KP(t.json.nodes[F],t,s));D.children=O}return D}function RB(a){if(a.vertices.length===0||a.indices.length===0)return null;const t=new Cb(a.vertices,a.indices,8,256),[s,u]=[t.min.clone(),t.max.clone()];return{vertices:a.vertices,indices:a.indices,grid:t,min:s,max:u}}function MB(a){if(!a.extras||!a.extras.ground)return null;const t=a.extras.ground;if(!t||!Array.isArray(t)||t.length===0)return null;const s=t[0];if(!s||!Array.isArray(s)||s.length===0)return null;const u=[];for(const _ of s){if(!Array.isArray(_)||_.length!==2)continue;const S=_[0],E=_[1];typeof S=="number"&&typeof E=="number"&&u.push(new Qt(S,E))}if(u.length<3)return null;u.length>1&&u[u.length-1].equals(u[0])&&u.pop();let h=0;for(let _=0;_<u.length;_++){const S=u[_],E=u[(_+1)%u.length],A=u[(_+2)%u.length];h+=(S.x-E.x)*(A.y-E.y)-(A.x-E.x)*(S.y-E.y)}h>0&&u.reverse();const m=Xl(u.flatMap(_=>[_.x,_.y]),[]);return m.length===0?null:{vertices:u,indices:m}}function LB(a,t){const s=[],u=[];let h=0;const m=[];for(const _ of a){h=s.length;const S=_.vertexArray.float32,E=_.indexArray.uint16;for(let A=0;A<_.vertexArray.length;A++)m[0]=S[3*A+0],m[1]=S[3*A+1],m[2]=S[3*A+2],cn(m,m,t),s.push(new Qt(m[0],m[1]));for(let A=0;A<3*_.indexArray.length;A++)u.push(E[A]+h)}if(u.length%3!=0)return null;for(let _=0;_<u.length;_+=3){const S=s[u[_+0]],E=s[u[_+1]],A=s[u[_+2]];(S.x-E.x)*(A.y-E.y)-(A.x-E.x)*(S.y-E.y)>0&&([u[_+1],u[_+2]]=[u[_+2],u[_+1]])}return{vertices:s,indices:u}}function YP(a){const t=function(E,A){const D=[],O=WebGL2RenderingContext;if(E.json.textures)for(const F of E.json.textures){const G={magFilter:O.LINEAR,minFilter:O.NEAREST,wrapS:O.REPEAT,wrapT:O.REPEAT};F.sampler!==void 0&&Object.assign(G,E.json.samplers[F.sampler]),D.push({image:A[F.source],sampler:G,uploaded:!1})}return D}(a,a.images),s=function(E,A){const D=[];for(const O of E.json.meshes){const F=[];for(const G of O.primitives)F.push(AB(G,E,A));D.push(F)}return D}(a,t),{scenes:u,scene:h,nodes:m}=a.json,_=u?u[h||0].nodes:m,S=[];for(const E of _)S.push(KP(m[E],a,s));return function(E,A,D){const O={},F=new Set;for(let G=0;G<E.length;G++){const W=D[A[G]];if(!W.extras)continue;const Q=W.extras["mapbox:footprint:version"],ae=W.extras["mapbox:footprint:id"];(Q||ae)&&F.add(G),Q==="1.0.0"&&ae&&(O[ae]=G)}for(let G=0;G<E.length;G++){if(F.has(G))continue;const W=E[G],Q=D[A[G]];if(!Q.extras)continue;let ae=null;W.id in O&&(ae=LB(E[O[W.id]].meshes,W.matrix)),ae||(ae=MB(Q)),ae&&(W.footprint=RB(ae))}if(F.size>0){const G=Array.from(F.values()).sort((W,Q)=>W-Q);for(let W=G.length-1;W>=0;W--)E.splice(G[W],1)}}(S,_,a.json.nodes),S}function DB(a){a.heightmap=new Float32Array(4096),a.heightmap.fill(-1);const t=a.vertexArray.float32,s=a.aabb.min[0]-1,u=a.aabb.min[1]-1,h=$m/(a.aabb.max[0]-s+2),m=$m/(a.aabb.max[1]-u+2);for(let _=0;_<t.length;_+=3){const S=t[_+2],E=(t[_+0]-s)*h|0,A=(t[_+1]-u)*m|0;S>a.heightmap[A*$m+E]&&(a.heightmap[A*$m+E]=S)}}function kB(a,t){const s={};s.indexArray=new gs,s.indexArray.reserve(4*a.length),s.vertexArray=new sl,s.vertexArray.reserve(10*a.length),s.colorArray=new Xs,s.vertexArray.reserve(10*a.length);let u=0;for(const _ of a){const S=Math.min(10,Math.max(4,1.3*_.height))*t,E=[-_.normal[1],_.normal[0],0],A=Math.min(.29,.1*_.width/_.depth),D=_.width-2*_.depth*t*(A+.01),O=ze([],_.pos,E,D/2),F=ze([],_.pos,E,-D/2),G=[O[0],O[1],O[2]+_.height],W=[F[0],F[1],F[2]+_.height],Q=ze([],_.normal,E,A);ct(Q,Q,S);const ae=ze([],_.normal,E,-A);ct(ae,ae,S),Ge(Q,O,Q),Ge(ae,F,ae),O[2]+=.1,F[2]+=.1,s.vertexArray.emplaceBack(Q[0],Q[1],Q[2]),s.vertexArray.emplaceBack(ae[0],ae[1],ae[2]),s.vertexArray.emplaceBack(O[0],O[1],O[2]),s.vertexArray.emplaceBack(F[0],F[1],F[2]),s.vertexArray.emplaceBack(G[0],G[1],G[2]),s.vertexArray.emplaceBack(W[0],W[1],W[2]),s.vertexArray.emplaceBack(O[0],O[1],O[2]),s.vertexArray.emplaceBack(F[0],F[1],F[2]),s.vertexArray.emplaceBack(Q[0],Q[1],Q[2]),s.vertexArray.emplaceBack(ae[0],ae[1],ae[2]);const ce=D/S/2;s.colorArray.emplaceBack(-ce-A,-1,ce,.8),s.colorArray.emplaceBack(ce+A,-1,ce,.8),s.colorArray.emplaceBack(-ce,0,ce,1.3),s.colorArray.emplaceBack(ce,0,ce,1.3),s.colorArray.emplaceBack(ce+A,-.8,ce,.7),s.colorArray.emplaceBack(ce+A,-.8,ce,.7),s.colorArray.emplaceBack(0,0,ce,1.3),s.colorArray.emplaceBack(0,0,ce,1.3),s.colorArray.emplaceBack(ce+A,-1.2,ce,.8),s.colorArray.emplaceBack(ce+A,-1.2,ce,.8),s.indexArray.emplaceBack(6+u,4+u,8+u),s.indexArray.emplaceBack(7+u,9+u,5+u),s.indexArray.emplaceBack(0+u,1+u,2+u),s.indexArray.emplaceBack(1+u,3+u,2+u),u+=10}const h={defined:!0,emissiveFactor:[0,0,0]},m={};return m.baseColorFactor=xr.white,h.pbrMetallicRoughness=m,s.material=h,s.aabb=new Ai([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),s}class JP{constructor(t){this._stringToNumber={},this._numberToString=[];for(let s=0;s<t.length;s++){const u=t[s];this._stringToNumber[u]=s,this._numberToString[s]=u}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}const OB=["id","tile","layer","source","sourceLayer","state"];class Wg{constructor(t,s,u,h,m){this.type="Feature",this._vectorTileFeature=t,this._z=s,this._x=u,this._y=h,this.properties=t.properties,this.id=m}clone(){const t=new Wg(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(t.state=Object.assign({},this.state)),this.layer&&(t.layer=Object.assign({},this.layer)),this.source&&(t.source=this.source),this.sourceLayer&&(t.sourceLayer=this.sourceLayer),t}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const s of OB)this[s]!==void 0&&(t[s]=this[s]);return t}}class QP{constructor(t,s){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new nu(en,16,0),this.featureIndexArray=new hp,this.promoteId=s,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(t,s,u,h,m,_=0,S=0){const E=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,h,m,_);const A=this.grid;for(let D=0;D<s.length;D++){const O=s[D],F=[1/0,1/0,-1/0,-1/0];for(let G=0;G<O.length;G++){const W=O[G];F[0]=Math.min(F[0],W.x),F[1]=Math.min(F[1],W.y),F[2]=Math.max(F[2],W.x),F[3]=Math.max(F[3],W.y)}S!==0&&(F[0]-=S,F[1]-=S,F[2]+=S,F[3]+=S),F[0]<en&&F[1]<en&&F[2]>=0&&F[3]>=0&&A.insert(E,F[0],F[1],F[2],F[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new wp.VectorTile(new yx(this.rawTileData)).layers,this.sourceLayerCoder=new JP(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const t in this.vtLayers)this.vtFeatures[t]=[]}return this.vtLayers}query(t,s){const{tilespaceGeometry:u,transform:h,tileTransform:m,pixelPosMatrix:_,availableImages:S}=s;this.loadVTLayers(),this.serializedLayersCache.clear();const E=u.bufferedTilespaceBounds,A=this.grid.query(E.min.x,E.min.y,E.max.x,E.max.y,(G,W,Q,ae)=>ys(u.bufferedTilespaceGeometry,G,W,Q,ae));A.sort(zB);let D=null;h.elevation&&A.length>0&&(D=Bg.create(h.elevation,this.tileID));const O={};let F;for(let G=0;G<A.length;G++){const W=A[G];if(W===F)continue;F=W;const Q=this.featureIndexArray.get(W);let ae=null;this.is3DTile?this.loadMatchingModelFeature(O,Q,t,u,h):this.loadMatchingFeature(O,Q,t,S,(ce,we,ve,ee=0)=>(ae||(ae=pn(ce,this.tileID.canonical,m)),we.queryIntersectsFeature(u,ce,ve,ae,this.z,h,_,D,ee)))}return O}loadMatchingFeature(t,s,u,h,m){const{featureIndex:_,bucketIndex:S,sourceLayerIndex:E,layoutVertexArrayOffset:A}=s,D=this.bucketLayerIDs[S],O=u.layers,F=Object.keys(O);if(F.length&&!function(ce,we){for(let ve=0;ve<ce.length;ve++)if(we.indexOf(ce[ve])>=0)return!0;return!1}(F,D))return;const G=u.sourceCache,W=this.sourceLayerCoder.decode(E),Q=this.vtLayers[W].feature(_),ae=this.getId(Q,W);for(let ce=0;ce<D.length;ce++){const we=D[ce];if(!O[we])continue;const{styleLayer:ve,targets:ee}=O[we];let ge={};ae!==void 0&&(ge=G.getFeatureState(ve.sourceLayer,ae));const be=!m||m(Q,ve,ge,A);if(!be)continue;const Ie=new Wg(Q,this.z,this.x,this.y,ae);Ie.tile=this.tileID.canonical,Ie.state=ge;let Fe=this.serializedLayersCache.get(we);Fe||(Fe=ve.serialize(),Fe.id=we,this.serializedLayersCache.set(we,Fe)),Ie.source=Fe.source,Ie.sourceLayer=Fe["source-layer"],Ie.layer=ft({},Fe),Ie.layer.paint=eA(Fe.paint,ve.paint,Q,ge,h),Ie.layer.layout=eA(Fe.layout,ve.layout,Q,ge,h);let $e=!1;for(const Ze of ee){this.updateFeatureProperties(Ie,Ze);const{filter:et}=Ze;if(et){if(Q.properties=Ie.properties,et.needGeometry){const St=bn(Q,!0);if(!et.filter(new ni(this.tileID.overscaledZ),St,this.tileID.canonical))continue}else if(!et.filter(new ni(this.tileID.overscaledZ),Q))continue}$e=!0,Ze.targetId&&this.addFeatureVariant(Ie,Ze)}$e&&this.appendToResult(t,we,_,Ie,be)}}loadMatchingModelFeature(t,s,u,h,m){const _=this.bucketLayerIDs[0][0],S=u.layers;if(!S[_])return;const{styleLayer:E,targets:A}=S[_];if(E.type!=="model")return;const D=h.tile,O=s.featureIndex,F=D.getBucket(E);if(!(F&&F instanceof Vx))return;const G=function(Fe,$e,Ze,et){const St=Fe.getNodesInfo()[$e];if(St.hiddenByReplacement||!St.node.meshes)return;let jt=Number.MAX_VALUE;const kt=St.node,Ft=Ze.tile,Gt=et.calculatePosMatrix(Ft.tileID.toUnwrapped(),et.worldSize),vt=St.evaluatedScale;let zt=0;et.elevation&&kt.elevation&&(zt=kt.elevation*et.elevation.exaggeration()),de(Gt,Gt,[(kt.anchor?kt.anchor[0]:0)*(vt[0]-1),(kt.anchor?kt.anchor[1]:0)*(vt[1]-1),zt]),ue(Gt,Gt,vt);const gt=Ze.queryGeometry,bt=gt.isPointQuery()?gt.screenBounds:gt.screenGeometry,qt=function(En){const _n=le([],Gt,En.matrix);le(_n,et.expandedFarZProjMatrix,_n);for(let sn=0;sn<En.meshes.length;++sn){const Wt=En.meshes[sn];if(sn===En.lightMeshIndex)continue;const Wn=QI(bt,et,_n,Wt.aabb);Wn!=null&&(jt=Math.min(Wn,jt))}if(En.children)for(const sn of En.children)qt(sn)};if(qt(kt),jt===Number.MAX_VALUE)return;const Kt=new ne(0,0);return uP(Ft.tileID.canonical,Kt,St.node.anchor[0],St.node.anchor[1]),{intersectionZ:jt,position:Kt,feature:St.feature}}(F,O,h,m);if(!G)return;const{z:W,x:Q,y:ae}=D.tileID.canonical,{feature:ce,intersectionZ:we,position:ve}=G;let ee={};ce.id!==void 0&&(ee=u.sourceCache.getFeatureState(E.sourceLayer,ce.id));const ge=new Wg({},W,Q,ae,ce.id);ge.tile=this.tileID.canonical,ge.state=ee,ge.properties=ce.properties,ge.geometry={type:"Point",coordinates:[ve.lng,ve.lat]};let be=this.serializedLayersCache.get(_);be||(be=E.serialize(),be.id=_,this.serializedLayersCache.set(_,be)),ge.source=be.source,ge.sourceLayer=be["source-layer"],ge.layer=ft({},be);let Ie=!1;for(const Fe of A){this.updateFeatureProperties(ge,Fe);const{filter:$e}=Fe;if($e){if(ce.properties=ge.properties,$e.needGeometry){if(!$e.filter(new ni(this.tileID.overscaledZ),ce,this.tileID.canonical))continue}else if(!$e.filter(new ni(this.tileID.overscaledZ),ce))continue}Ie=!0,Fe.targetId&&this.addFeatureVariant(ge,Fe)}Ie&&this.appendToResult(t,_,O,ge,we)}updateFeatureProperties(t,s,u){if(s.properties){const h={};for(const m in s.properties){const _=s.properties[m].evaluate({zoom:this.z},t._vectorTileFeature,t.state,t.tile,u);_!=null&&(h[m]=_)}t.properties=h}}addFeatureVariant(t,s,u){const h={target:s.target,namespace:s.namespace,uniqueFeatureID:s.uniqueFeatureID};s.properties&&(h.properties=t.properties),t.variants=t.variants||{},t.variants[s.targetId]=t.variants[s.targetId]||[],t.variants[s.targetId].push(h)}appendToResult(t,s,u,h,m){let _=t[s];_===void 0&&(_=t[s]=[]),_.push({featureIndex:u,feature:h,intersectionZ:m})}lookupSymbolFeatures(t,s,u,h,m){const _={};this.loadVTLayers();for(const S of t)this.loadMatchingFeature(_,{bucketIndex:s,sourceLayerIndex:u,featureIndex:S,layoutVertexArrayOffset:0},h,m);return _}loadFeature(t){const{featureIndex:s,sourceLayerIndex:u}=t;this.loadVTLayers();const h=this.sourceLayerCoder.decode(u),m=this.vtFeatures[h];if(m[s])return m[s];const _=this.vtLayers[h].feature(s);return m[s]=_,_}hasLayer(t){for(const s of this.bucketLayerIDs)for(const u of s)if(t===u)return!0;return!1}getId(t,s){let u=t.id;if(this.promoteId){const h=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[s];if(h!=null)if(Array.isArray(h)){if(!this.promoteIdExpression){const m=Zu(h);if(m.result!=="success"){const _=m.value.map(S=>`${S.key}: ${S.message}`).join(", ");return void gr(`Failed to create expression for promoteId: ${_}`)}this.promoteIdExpression=m.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new lc),u=this.promoteIdExpression.evaluate({zoom:0},t)}else u=t.properties[h];typeof u=="boolean"&&(u=Number(u))}return u}}function eA(a,t,s,u,h){return Yn(a,(m,_)=>{const S=t instanceof il?t.get(_):null;return S&&S.evaluate?S.evaluate(s,u,void 0,h):S})}function zB(a,t){return t-a}un(QP,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const tA=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class bw{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,u]=new Uint8Array(t,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=u>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);const m=tA[15&u];if(!m)throw new Error("Unrecognized array type.");const[_]=new Uint16Array(t,2,1),[S]=new Uint32Array(t,4,1);return new bw(S,_,m,t)}constructor(t,s=64,u=Float64Array,h){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=u,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const m=tA.indexOf(this.ArrayType),_=2*t*this.ArrayType.BYTES_PER_ELEMENT,S=t*this.IndexArrayType.BYTES_PER_ELEMENT,E=(8-S%8)%8;if(m<0)throw new Error(`Unexpected typed array class: ${u}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+S+E,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+_+S+E),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+S+E,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+m]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=t)}add(t,s){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=t,this.coords[this._pos++]=s,u}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return ww(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,s,u,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:_,nodeSize:S}=this,E=[0,m.length-1,0],A=[];for(;E.length;){const D=E.pop()||0,O=E.pop()||0,F=E.pop()||0;if(O-F<=S){for(let ae=F;ae<=O;ae++){const ce=_[2*ae],we=_[2*ae+1];ce>=t&&ce<=u&&we>=s&&we<=h&&A.push(m[ae])}continue}const G=F+O>>1,W=_[2*G],Q=_[2*G+1];W>=t&&W<=u&&Q>=s&&Q<=h&&A.push(m[G]),(D===0?t<=W:s<=Q)&&(E.push(F),E.push(G-1),E.push(1-D)),(D===0?u>=W:h>=Q)&&(E.push(G+1),E.push(O),E.push(1-D))}return A}within(t,s,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:m,nodeSize:_}=this,S=[0,h.length-1,0],E=[],A=u*u;for(;S.length;){const D=S.pop()||0,O=S.pop()||0,F=S.pop()||0;if(O-F<=_){for(let ae=F;ae<=O;ae++)rA(m[2*ae],m[2*ae+1],t,s)<=A&&E.push(h[ae]);continue}const G=F+O>>1,W=m[2*G],Q=m[2*G+1];rA(W,Q,t,s)<=A&&E.push(h[G]),(D===0?t-u<=W:s-u<=Q)&&(S.push(F),S.push(G-1),S.push(1-D)),(D===0?t+u>=W:s+u>=Q)&&(S.push(G+1),S.push(O),S.push(1-D))}return E}}function ww(a,t,s,u,h,m){if(h-u<=s)return;const _=u+h>>1;nA(a,t,_,u,h,m),ww(a,t,s,u,_-1,1-m),ww(a,t,s,_+1,h,1-m)}function nA(a,t,s,u,h,m){for(;h>u;){if(h-u>600){const A=h-u+1,D=s-u+1,O=Math.log(A),F=.5*Math.exp(2*O/3),G=.5*Math.sqrt(O*F*(A-F)/A)*(D-A/2<0?-1:1);nA(a,t,s,Math.max(u,Math.floor(s-D*F/A+G)),Math.min(h,Math.floor(s+(A-D)*F/A+G)),m)}const _=t[2*s+m];let S=u,E=h;for(jy(a,t,u,s),t[2*h+m]>_&&jy(a,t,u,h);S<E;){for(jy(a,t,S,E),S++,E--;t[2*S+m]<_;)S++;for(;t[2*E+m]>_;)E--}t[2*u+m]===_?jy(a,t,u,E):(E++,jy(a,t,E,h)),E<=s&&(u=E+1),s<=E&&(h=E-1)}}function jy(a,t,s,u){Sw(a,s,u),Sw(t,2*s,2*u),Sw(t,2*s+1,2*u+1)}function Sw(a,t,s){const u=a[t];a[t]=a[s],a[s]=u}function rA(a,t,s,u){const h=a-s,m=t-u;return h*h+m*m}i.$=Co,i.A=Tl,i.B=Ta,i.C=Bl,i.D=Vg,i.E=Il,i.F=2,i.G=by,i.H=fI,i.I=Go,i.J=class extends jx{},i.K=Bn,i.L=Du,i.M=_a,i.N=Jh,i.O=hs,i.P=Qt,i.Q=Xf,i.R=jc,i.S=qu,i.T=Jb,i.U=ya,i.V=jx,i.W=Xd,i.X=Zu,i.Y=Nd,i.Z=Yc,i._=Kc,i.a=function(a){return os.API_CDN_URL_REGEX.test(a)},i.a$=ln,i.a0=Ed,i.a1=Ko,i.a2=qd,i.a3=Ma,i.a4=function(a){const t=a.value;let s=[];if(!t)return s;const u=Bn(t);return u!=="string"?(s=s.concat([new jx(a.key,t,`string expected, "${u}" found`)]),s):(nw(t,!0)||(s=s.concat([new jx(a.key,t,`invalid url "${t}"`)])),s)},i.a5=ut,i.a6=iu,i.a7=$i,i.a8=Xt,i.a9=class{constructor(a){this.specification=a}possiblyEvaluate(a,t){return vr(a.expression.evaluate(t))}interpolate(a,t,s){return{x:kn(a.x,t.x,s),y:kn(a.y,t.y,s),z:kn(a.z,t.z,s),azimuthal:kn(a.azimuthal,t.azimuthal,s),polar:kn(a.polar,t.polar,s)}}},i.aA=Xn,i.aB=si,i.aC=Dt,i.aD=Xe,i.aE=w,i.aF=function(a,t){const s={};for(let u=0;u<t.length;u++){const h=t[u];h in a&&(s[h]=a[h])}return s},i.aG=ye,i.aH=Me,i.aI=class{constructor(a){this.entries={},this.scheduler=a}request(a,t,s,u){const h=this.entries[a]=this.entries[a]||{callbacks:[]};if(h.result){const[m,_]=h.result;return this.scheduler?this.scheduler.add(()=>{u(m,_)},t):u(m,_),()=>{}}return h.callbacks.push(u),h.cancel||(h.cancel=s((m,_)=>{h.result=[m,_];for(const S of h.callbacks)this.scheduler?this.scheduler.add(()=>{S(m,_)},t):S(m,_);setTimeout(()=>delete this.entries[a],3e3)})),()=>{h.result||(h.callbacks=h.callbacks.filter(m=>m!==u),h.callbacks.length||(h.cancel(),delete this.entries[a]))}}},i.aJ=function(a,t,s){const u=JSON.stringify(a.request);return a.data&&(this.deduped.entries[u]={result:[null,a.data]}),this.deduped.request(u,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom},h=>{const m=Sl(a.request,(_,S,E,A)=>{_?h(_):S&&h(null,{vectorTile:s?void 0:new wp.VectorTile(new yx(S)),rawData:S,cacheControl:E,expires:A})});return()=>{m.cancel(),h()}},t)},i.aK=function(a){vd++,vd>oa&&(a.getActor().send("enforceCacheSizeLimit",sc),vd=0)},i.aL=function(a){return a<=1?1:Math.pow(2,Math.floor(Math.log(a)/Math.LN2))},i.aM=ls,i.aN=UI,i.aO=ZI,i.aP=VI,i.aQ=function(a,t){const s=document.createElement("video");s.muted=!0,s.onloadstart=function(){t(null,s)};for(let u=0;u<a.length;u++){const h=document.createElement("source");K_(a[u])||(s.crossOrigin="Anonymous"),h.src=a[u],s.appendChild(h)}return{cancel:()=>{}}},i.aR=kx,i.aS=function(a){return fetch(a).then(t=>t.arrayBuffer()).then(t=>XP(t,0,a))},i.aT=YP,i.aU=class{constructor(a,t,s,u){this.id=a,this.position=t!=null?new ne(t[0],t[1]):new ne(0,0),this.orientation=s??[0,0,0],this.nodes=u,this.uploaded=!1,this.aabb=new Ai([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(a,t){if(le(a.matrix,t,a.matrix),a.meshes)for(const s of a.meshes){const u=Ai.applyTransformFast(s.aabb,a.matrix);this.aabb.encapsulate(u)}if(a.children)for(const s of a.children)this._applyTransformations(s,a.matrix)}computeBoundsAndApplyParent(){const a=Z([]);for(const t of this.nodes)this._applyTransformations(t,a)}computeModelMatrix(a,t,s,u,h,m,_=!1){sP(this.matrix,this,a.transform,this.position,t,s,u,h,m,_)}upload(a){if(!this.uploaded){for(const t of this.nodes)iw(t,a);for(const t of this.nodes)Bx(t);this.uploaded=!0}}destroy(){for(const a of this.nodes)sw(a)}},i.aV=Zn,i.aW=Sy,i.aX=Oe,i.aY=Ne,i.aZ=ou,i.a_=gs,i.aa=ni,i.ab=rl,i.ac=dt,i.ad=cn,i.ae=_t,i.af=Ke,i.ag=il,i.ah=ch,i.ai=kn,i.aj=en,i.ak=Id,i.al=ie,i.am=xr,i.an=class{constructor(a){this.specification=a}possiblyEvaluate(a,t){return function([s,u]){const h=vr([1,s,u]);return{x:h.x,y:h.y,z:h.z}}(a.expression.evaluate(t))}interpolate(a,t,s){return{x:kn(a.x,t.x,s),y:kn(a.y,t.y,s),z:kn(a.z,t.z,s)}}},i.ao=function(a,t,s=0,u=!0){const h=new Qt(s,s),m=a.sub(h),_=t.add(h),S=[m,new Qt(_.x,m.y),_,new Qt(m.x,_.y)];return u&&S.push(m.clone()),S},i.ap=function(a,t){const s=[];for(let u=0;u<a.length;u++){const h=pt(u-1,-1,a.length-1),m=pt(u+1,-1,a.length-1),_=a[u],S=a[m],E=a[h].sub(_).unit(),A=S.sub(_).unit(),D=A.angleWithSep(E.x,E.y),O=E.add(A).unit().mult(-1*t/Math.sin(D/2));s.push(_.add(O))}return s},i.aq=II,i.ar=ys,i.as=function(a,t,s=0){return Ue(((t.x-s)*a.scale-a.x)*en,(t.y*a.scale-a.y)*en,ht(t.z,t.y))},i.at=An,i.au=We,i.av=cl,i.aw=jE,i.ax=function(a){let t=1/0,s=1/0,u=-1/0,h=-1/0;for(const m of a)t=Math.min(t,m.x),s=Math.min(s,m.y),u=Math.max(u,m.x),h=Math.max(h,m.y);return{min:new Qt(t,s),max:new Qt(u,h)}},i.ay=De,i.az=le,i.b=function(a){return os.API_FONTS_REGEX.test(a)},i.b$=ct,i.b0=gf,i.b1=Lx,i.b2=function(){ea.isLoading()||ea.isLoaded()||as()!=="deferred"||nf()},i.b3=ed,i.b4=bn,i.b5=Wg,i.b6=Qi,i.b7=Rb,i.b8=Sb,i.b9=pn,i.bA=function(a,t){const{x:s,y:u}=a.point,h=bp(s,u,a.worldSize/a._pixelsPerMercatorPixel,0,0);return le(h,h,ly(ul(t)))},i.bB=k,i.bC=function(a){return a[0]=0,a[1]=0,a[2]=0,a},i.bD=function(a,t){return Math.hypot(t[0]-a[0],t[1]-a[1],t[2]-a[2])},i.bE=st,i.bF=ze,i.bG=Bt,i.bH=xy,i.bI=dl,i.bJ=Nb,i.bK=function(a,t,s,u,h){const m=5*t+2;a.float32[m+0]=s,a.float32[m+1]=u,a.float32[m+2]=h},i.bL=Mx,i.bM=_x,i.bN=Rn,i.bO=mo,i.bP=aE,i.bQ=eP,i.bR=hE,i.bS=fE,i.bT=Ub,i.bU=xI,i.bV=Fb,i.bW=bw,i.bX=pt,i.bY=Or,i.bZ=function(a,t,s){s*=.5;var u=t[0],h=t[1],m=t[2],_=t[3],S=Math.sin(s),E=Math.cos(s);return a[0]=u*E+h*S,a[1]=h*E-u*S,a[2]=m*E+_*S,a[3]=_*E-m*S,a},i.b_=is,i.ba=Vl,i.bb=pf,i.bc=Bs,i.bd=ki,i.be=Xl,i.bf=Xb,i.bg=function(a,t){const s=ch(t.zoom);if(s===0)return ul(a);const u=Mm(a),h=Lm(u),m=De(u.getWest())*t.worldSize,_=De(u.getEast())*t.worldSize,S=Me(u.getNorth())*t.worldSize,E=Me(u.getSouth())*t.worldSize,A=[m,S,0],D=[_,S,0],O=[m,E,0],F=[_,E,0],G=J([],t.globeMatrix);return cn(A,A,G),cn(D,D,G),cn(O,O,G),cn(F,F,G),h[0]=fu(h[0],O,s),h[1]=fu(h[1],F,s),h[2]=fu(h[2],D,s),h[3]=fu(h[3],A,s),Ai.fromPoints(h)},i.bh=km,i.bi=J,i.bj=lh,i.bk=fu,i.bl=of,i.bm=Fa,i.bn=fe,i.bo=de,i.bp=Kx,i.bq=yx,i.br=Sl,i.bs=function(a,t){const s=[];for(const u in a)u in t||s.push(u);return s},i.bt=Lt,i.bu=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.bv=yl,i.bw=function(a){var t=new R(16);return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15],t},i.bx=Z,i.by=xe,i.bz=X,i.c=Eu,i.c$=function(a){return a({pluginStatus:qs,pluginURL:Nl}),Yd.on("pluginStateChange",a),a},i.c0=mn,i.c1=Es,i.c2=function(a,t){return a[0]=-t[0],a[1]=-t[1],a[2]=-t[2],a[3]=t[3],a},i.c3=Ce,i.c4=function(a,t,s,u,h){var m,_=1/Math.tan(t/2);return a[0]=_/s,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=_,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,h!=null&&h!==1/0?(a[10]=(h+u)*(m=1/(u-h)),a[14]=2*h*u*m):(a[10]=-1,a[14]=-2*u),a},i.c5=function(a,t,s,u,h,m,_){var S=1/(t-s),E=1/(u-h),A=1/(m-_);return a[0]=-2*S,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*E,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*A,a[11]=0,a[12]=(t+s)*S,a[13]=(h+u)*E,a[14]=(_+m)*A,a[15]=1,a},i.c6=Pe,i.c7=function(a,t,s){a[4*t+0]=s[0],a[4*t+1]=s[1],a[4*t+2]=s[2],a[4*t+3]=s[3]},i.c8=$l,i.c9=al,i.cA=Fx,i.cB=je,i.cC=XI,i.cD=function(a){const t=XI(a,!0);return k([],[t[0],t[1],t[4],t[5]])},i.cE=ue,i.cF=va,i.cG=pe,i.cH=function(a){const{x:t,y:s}=a.point,{lng:u,lat:h}=a._center;return bp(t,s,a.worldSize,u,h)},i.cI=yt,i.cJ=me,i.cK=oo,i.cL=C,i.cM=function(a,t,s){let u=0;for(let h=0;h<2;++h)a[h]>0&&(u+=(a[h]-0)*(a[h]-0)),t[h]<0&&(u+=(0-t[h])*(0-t[h]));return u},i.cN=45,i.cO=jf,i.cP=ke,i.cQ=so,i.cR=function(a,t,s){const u=Math.sqrt(a*a+t*t+s*s),h=u>0?Math.acos(s/u)*wt:0;let m=a!==0||t!==0?Math.atan2(-t,-a)*wt+90:0;return m<0&&(m+=360),[u,m,h]},i.cS=Ue,i.cT=Qe,i.cU=Ge,i.cV=Ai,i.cW=vr,i.cX=function(a){return[Math.pow(a[0],1/2.2),Math.pow(a[1],1/2.2),Math.pow(a[2],1/2.2)]},i.cY=at,i.cZ=nw,i.c_=function(a,t){return a.readFields(Dj,{icons:[]},t)},i.ca=cu,i.cb=_s,i.cc=io,i.cd=ne,i.ce=LI,i.cf=function(){var a=new R(4);return R!=Float32Array&&(a[1]=0,a[2]=0),a[0]=1,a[3]=1,a},i.cg=function(a,t,s){var u=t[0],h=t[1],m=t[2],_=t[3],S=Math.sin(s),E=Math.cos(s);return a[0]=u*E+m*S,a[1]=h*E+_*S,a[2]=u*-S+m*E,a[3]=h*-S+_*E,a},i.ch=function(a,t){return a[0]===t[0]&&a[1]===t[1]&&a[2]===t[2]&&a[3]===t[3]},i.ci=Vn,i.cj=function(a){return Math.hypot(a[0],a[1],a[2],a[3])},i.ck=ur,i.cl=Nn,i.cm=Ks,i.cn=od,i.co=KI,i.cp=br,i.cq=sx,i.cr=function(a,t,s,u,h,m,_,S,E){if(E.name==="globe")return sx(a,t,new br(s,u,h),!1);const A=Sy({z:s,x:u,y:h},E);return new Ai([(m+A.x/A.scale)*t,t*(A.y/A.scale),_],[(m+A.x2/A.scale)*t,t*(A.y2/A.scale),S])},i.cs=function(a,t,s){return a[0]=Math.min(t[0],s[0]),a[1]=Math.min(t[1],s[1]),a[2]=Math.min(t[2],s[2]),a[3]=Math.min(t[3],s[3]),a},i.ct=function(a,t,s){return a[0]=Math.max(t[0],s[0]),a[1]=Math.max(t[1],s[1]),a[2]=Math.max(t[2],s[2]),a[3]=Math.max(t[3],s[3]),a},i.cu=function(a){const t=Math.round((a+45+360)%360/90)%4;return Le[t]},i.cv=rt,i.cw=Gr,i.cx=P,i.cy=function(a){const t=Z(new Float64Array(16));le(t,a.pixelMatrix,a.globeMatrix);const s=[0,H,0],u=[0,$,0];return cn(s,s,t),cn(u,u,t),[s[0]>0&&s[0]<=a.width&&s[1]>0&&s[1]<=a.height&&!g(a,new ne(a.center.lat,90)),u[0]>0&&u[0]<=a.width&&u[1]>0&&u[1]<=a.height&&!g(a,new ne(a.center.lat,-90))]},i.cz=function(a,t){const{scale:s}=a.tileTransform,u=s*en/(a.tileSize*Math.pow(2,t.zoom-a.tileID.overscaledZ+a.tileID.canonical.z));return function(h,m,_){var S=m[1],E=m[2],A=m[3],D=_[0],O=_[1];return h[0]=m[0]*D,h[1]=S*D,h[2]=E*O,h[3]=A*O,h}(new Float32Array(4),t.inverseAdjustmentMatrix,[u,u])},i.d=function(a){return os.API_TILEJSON_REGEX.test(a)},i.d$=ap,i.d0=Ux,i.d1=zg,i.d2=Bb,i.d3=Br,i.d4=Da,i.d5=Do,i.d6=bo,i.d7=pr,i.d8=function(a){const t=a.indexOf(Jd);return t>=0?a.slice(0,t):a},i.d9=function(a){return a.indexOf(Jd)>=0},i.dA=ox,i.dB=ms,i.dC=$s,i.dD=256,i.dE=function(a,t){const s=[0,0,0];return cn(s,s,km(ul(t.canonical))),cn(s,s,a),s},i.dF=a=>({u_camera_to_center_distance:new _s(a),u_extrude_scale:new ka(a),u_device_pixel_ratio:new _s(a),u_matrix:new $l(a),u_inv_rot_matrix:new $l(a),u_merc_center:new al(a),u_tile_id:new cu(a),u_zoom_transition:new _s(a),u_up_dir:new cu(a),u_emissive_strength:new _s(a)}),i.dG=a=>({u_matrix:new $l(a),u_pixels_to_tile_units:new ka(a),u_device_pixel_ratio:new _s(a),u_width_scale:new _s(a),u_floor_width_scale:new _s(a),u_units_to_pixels:new al(a),u_dash_image:new io(a),u_gradient_image:new io(a),u_image_height:new _s(a),u_texsize:new al(a),u_tile_units_to_pixels:new _s(a),u_alpha_discard_threshold:new _s(a),u_trim_offset:new al(a),u_trim_fade_range:new al(a),u_trim_color:new so(a),u_emissive_strength:new _s(a),u_zbias_factor:new _s(a),u_tile_to_meter:new _s(a),u_ground_shadow_factor:new cu(a)}),i.dH=a=>({u_matrix:new $l(a),u_texsize:new al(a),u_pixels_to_tile_units:new ka(a),u_device_pixel_ratio:new _s(a),u_width_scale:new _s(a),u_floor_width_scale:new _s(a),u_image:new io(a),u_units_to_pixels:new al(a),u_tile_units_to_pixels:new _s(a),u_alpha_discard_threshold:new _s(a),u_trim_offset:new al(a),u_trim_fade_range:new al(a),u_trim_color:new so(a),u_emissive_strength:new _s(a),u_zbias_factor:new _s(a),u_tile_to_meter:new _s(a),u_ground_shadow_factor:new cu(a),u_pattern_transition:new _s(a)}),i.dI=ih,i.dJ=FN,i.dK=se,i.dL=(a,t,s,u,h,m)=>{const _=a.transform,S=_.projection.name==="globe";let E;if(m.paint.get("circle-pitch-alignment")==="map")if(S){const D=ox(_.zoom,t.canonical)*_._pixelsPerMercatorPixel;E=Float32Array.from([D,0,0,D])}else E=_.calculatePixelsToTileUnitsMatrix(s);else E=new Float32Array([_.pixelsToGLUnits[0],0,0,_.pixelsToGLUnits[1]]);const A={u_camera_to_center_distance:a.transform.getCameraToCenterDistance(_.projection),u_matrix:a.translatePosMatrix(t.projMatrix,s,m.paint.get("circle-translate"),m.paint.get("circle-translate-anchor")),u_device_pixel_ratio:sa.devicePixelRatio,u_extrude_scale:E,u_inv_rot_matrix:Y,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:m.paint.get("circle-emissive-strength")};if(S){A.u_inv_rot_matrix=u,A.u_merc_center=h,A.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],A.u_zoom_transition=ch(_.zoom);const D=h[0]*en,O=h[1]*en;A.u_up_dir=_.projection.upVector(new br(0,0,0),D,O)}return A},i.dM=$E,i.dN=Wo,i.dO=(a,t,s,u,h,m,_,S,E,A)=>{const D=a.transform,O=D.pitch<15?BE(.07,.7,Xe((14-D.zoom)/5,0,1)):.07,F=s.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:UE(a,t,s,u),u_texsize:t.imageAtlasTexture?t.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:D.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:h,u_width_scale:m,u_floor_width_scale:_,u_image:0,u_tile_units_to_pixels:VE(t,D),u_units_to_pixels:[1/D.pixelsToGLUnits[0],1/D.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:S,u_trim_fade_range:s.paint.get("line-trim-fade-range"),u_trim_color:s.paint.get("line-trim-color").toRenderColor(F?null:s.lut).toArray01(),u_emissive_strength:s.paint.get("line-emissive-strength"),u_zbias_factor:O,u_tile_to_meter:Qe(t.tileID.canonical,0),u_ground_shadow_factor:E,u_pattern_transition:A}},i.dP=(a,t,s,u,h,m,_,S,E,A)=>{const D=a.transform,O=D.calculatePixelsToTileUnitsMatrix(t),F=s.paint.get("line-trim-color-use-theme").constantOr("default")==="none",G=D.pitch<15?BE(.07,.7,Xe((14-D.zoom)/5,0,1)):.07;return{u_matrix:UE(a,t,s,u),u_pixels_to_tile_units:O,u_device_pixel_ratio:m,u_width_scale:_,u_floor_width_scale:S,u_units_to_pixels:[1/D.pixelsToGLUnits[0],1/D.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:h,u_texsize:HE(s)&&t.lineAtlasTexture?t.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:VE(t,a.transform),u_alpha_discard_threshold:0,u_trim_offset:E,u_trim_fade_range:s.paint.get("line-trim-fade-range"),u_trim_color:s.paint.get("line-trim-color").toRenderColor(F?null:s.lut).toArray01(),u_emissive_strength:s.paint.get("line-emissive-strength"),u_zbias_factor:G,u_tile_to_meter:Qe(t.tileID.canonical,0),u_ground_shadow_factor:A}},i.dQ=xn,i.dR=Rr,i.dS=ht,i.dT=EE,i.dU=ll,i.dV=gx,i.dW=Sp,i.dX=450,i.dY=7,i.dZ=_j,i.d_=Vr,i.da=function(a){const t=a.lastIndexOf(Jd);return t>=0?a.slice(t+1):""},i.db=function(a){const t=[],s=a.id;return s===void 0&&t.push({message:`layers.${s}: missing required property "id"`}),a.render===void 0&&t.push({message:`layers.${s}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&t.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),t},i.dc=function(a,t,s,u){return a.type==="custom"?new yj(a,t):new Aj[a.type](a,t,s,u)},i.dd=rr,i.de=function(a){const t=a.indexOf(Jd);return t>=0?a.slice(t+1):""},i.df=class extends Wg{constructor(a,t){super(a._vectorTileFeature,a._z,a._x,a._y,a.id),a.state&&(this.state=Object.assign({},a.state)),this.target=t.target,this.namespace=t.namespace,t.properties&&(this.properties=t.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=a.source,this.sourceLayer=a.sourceLayer,this.layer=a.layer)}toJSON(){const a=super.toJSON();return a.target=this.target,a.namespace=this.namespace,a}},i.dg=Yd,i.dh=Au,i.di=Lg,i.dj=class extends na{constructor(a){super(a),this.current=gp}set(a,t,s){if(this.fetchUniformLocation(a,t)){for(let u=0;u<9;u++)if(s[u]!==this.current[u]){this.current=s,this.gl.uniformMatrix3fv(this.location,!1,s);break}}}},i.dk=Be,i.dl=function(a,t,s){const u=ch(s.zoom),h=a.style.map._antialias,m=a.terrain&&a.terrain.exaggeration()>0;return u===0&&!h&&!m},i.dm=function(a){const t=a.pixelsPerMeter,s=t/Pe(1,a.center.lat),u=Z(new Float64Array(16));return de(u,u,[a.point.x,a.point.y,0]),ue(u,u,[s,s,t]),Float32Array.from(u)},i.dn=Mm,i.dp=function(a){const t=rt-5;a=Xe(a,-80.051129,t)/t*90;const s=Math.pow(Math.abs(Math.sin(ie(a))),3);return Math.round(s*(j.length-1))},i.dq=function(a,t,s,u){const h=t.getNorth(),m=t.getSouth(),_=t.getWest(),S=t.getEast(),E=1<<a.z,A=S-_,D=h-m,O=A/z,F=-D/j[s],G=[0,O,0,F,0,0,h,_,0];if(a.z>0){const W=180/u;K(G,G,[W/A+1,0,0,0,W/D+1,0,-.5*W/O,.5*W/F,1])}return G[2]=E,G[5]=a.x,G[8]=a.y,G},i.dr=ul,i.ds=function(a,t,s){const u=Z(new Float64Array(16)),h=(t/(1<<a)-.5)*Math.PI*2;return he(u,s.globeMatrix,h),Float32Array.from(u)},i.dt=class{isDataAvailableAtPoint(a){const t=this._source();if(this.isUsingMockSource()||!t||a.y<0||a.y>1)return!1;const s=t.getSource().maxzoom,u=1<<s,h=Math.floor(a.x),m=Math.floor((a.x-h)*u),_=Math.floor(a.y*u),S=this.findDEMTileFor(new ls(s,h,s,m,_));return!(!S||!S.dem)}getAtPointOrZero(a,t=0){return this.getAtPoint(a,t)||0}getAtPoint(a,t,s=!0){if(this.isUsingMockSource())return null;t==null&&(t=null);const u=this._source();if(!u||a.y<0||a.y>1)return t;const h=u.getSource().maxzoom,m=1<<h,_=Math.floor(a.x),S=a.x-_,E=new ls(h,_,h,Math.floor(S*m),Math.floor(a.y*m)),A=this.findDEMTileFor(E);if(!A||!A.dem)return t;const D=A.dem,O=1<<A.tileID.canonical.z,F=(S*O-A.tileID.canonical.x)*D.dim,G=(a.y*O-A.tileID.canonical.y)*D.dim,W=Math.floor(F),Q=Math.floor(G);return(s?this.exaggeration():1)*kn(kn(D.get(W,Q),D.get(W,Q+1),G-Q),kn(D.get(W+1,Q),D.get(W+1,Q+1),G-Q),F-W)}getAtTileOffset(a,t,s){const u=1<<a.canonical.z;return this.getAtPointOrZero(new dt(a.wrap+(a.canonical.x+t/en)/u,(a.canonical.y+s/en)/u))}getAtTileOffsetFunc(a,t,s,u){return h=>{const m=this.getAtTileOffset(a,h.x,h.y),_=u.upVector(a.canonical,h.x,h.y);return ct(_,_,m*u.upVectorScale(a.canonical,t,s).metersToTile),_}}getForTilePoints(a,t,s,u){if(this.isUsingMockSource())return!1;const h=Bg.create(this,a,u);return!!h&&(t.forEach(m=>{m[2]=this.exaggeration()*h.getElevationAt(m[0],m[1],s)}),!0)}getMinMaxForTile(a){if(this.isUsingMockSource())return null;const t=this.findDEMTileFor(a);if(!t||!t.dem)return null;const s=t.dem.tree,u=t.tileID,h=1<<a.canonical.z-u.canonical.z;let m=a.canonical.x/h-u.canonical.x,_=a.canonical.y/h-u.canonical.y,S=0;for(let E=0;E<a.canonical.z-u.canonical.z&&!s.leaves[S];E++){m*=2,_*=2;const A=2*Math.floor(_)+Math.floor(m);S=s.childOffsets[S]+A,m%=1,_%=1}return{min:this.exaggeration()*s.minimums[S],max:this.exaggeration()*s.maximums[S]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(a,t,s){throw new Error("Pure virtual method called.")}pointCoordinate(a){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(a){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const a=this.visibleDemTiles;if(a.length===0)return null;let t=!1,s=Number.MAX_VALUE,u=Number.MIN_VALUE;for(const h of a){const m=this.getMinMaxForTile(h.tileID);m&&(s=Math.min(s,m.min),u=Math.max(u,m.max),t=!0)}return t?{min:s,max:u}:null}},i.du=wr,i.dv=hu,i.dw=function(a,t){return[Math.pow(a[0],2.2)*t,Math.pow(a[1],2.2)*t,Math.pow(a[2],2.2)*t]},i.dx=N,i.dy=function(a,t){var s=Math.sin(t),u=Math.cos(t);return a[0]=u,a[1]=s,a[2]=0,a[3]=-s,a[4]=u,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},i.dz=cr,i.e=os,i.e$=JP,i.e0=256,i.e1=ly,i.e2=sl,i.e3=he,i.e4=function(a,t){return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[4],a[4]=t[5],a[5]=t[6],a[6]=t[8],a[7]=t[9],a[8]=t[10],a},i.e5=au,i.e6=sh,i.e7=function(a,t,s,u,h){return Xe((a-t)/(s-t)*(h-u)+u,u,h)},i.e8=Zi,i.e9=function(a,t){var s=t[0],u=t[1],h=t[2],m=t[3],_=t[4],S=t[5],E=t[6],A=t[7],D=t[8],O=D*_-S*A,F=-D*m+S*E,G=A*m-_*E,W=s*O+u*F+h*G;return W?(a[0]=O*(W=1/W),a[1]=(-D*u+h*A)*W,a[2]=(S*u-h*_)*W,a[3]=F*W,a[4]=(D*s-h*E)*W,a[5]=(-S*s+h*m)*W,a[6]=G*W,a[7]=(-A*s+u*E)*W,a[8]=(_*s-u*m)*W,a):null},i.eA=function(a,t,s){return a[0]=t[0]/s[0],a[1]=t[1]/s[1],a[2]=t[2]/s[2],a},i.eB=Zt,i.eC=re,i.eD=At,i.eE=function(a,t,s,u){return a[0]=t,a[1]=s,a[2]=u,a},i.eF=function([a,t,s]){const u=Math.hypot(a,t,s),h=Math.atan2(a,s),m=.5*Math.PI-Math.acos(-t/u);return new ne(me(h),me(m))},i.eG=Yr,i.eH=ew,i.eI=function(a){const t=a.navigator?a.navigator.userAgent:null;return!!function(s){if(bs==null){const u=s.navigator?s.navigator.userAgent:null;bs=!!s.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return bs}(a)&&!(!t||!(t.match("Version/15.4")||t.match("Version/15.5")||t.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/)))},i.eJ=function(a,t){sc=a,oa=t},i.eK=g,i.eL=Om,i.eM=function(a){const t=[0,0,0],s=Z(new Float64Array(16));return le(s,a.pixelMatrix,a.globeMatrix),cn(t,t,s),new Qt(t[0],t[1])},i.eN=function(a,t,s=!1){if(qs===Yu||qs===La||qs===Ju)throw new Error("setRTLTextPlugin cannot be called multiple times.");Nl=sa.resolveURL(a),qs=Yu,Qu=t,tf(),s||nf()},i.eO=as,i.eP=function(){Ux().acquire(aw)},i.eQ=function(){const a=My;a&&(a.isPreloaded()&&a.numActive()===1?(a.release(aw),My=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},i.eR=Gm,i.eS=function(a){const t=Lh();if(!t)return;const s=t.delete(Ho);a&&s.then(()=>a()).catch(a)},i.eT=Ry,i.eU=UP,i.eV=function(a){_w=sa.resolveURL(a),Gg||(Gg=new Vg(Ux(),new Il)),Gg.broadcast("setDracoUrl",_w)},i.eW=$P,i.eX=function(a){Hg=sa.resolveURL(a),Gg||(Gg=new Vg(Ux(),new Il)),Gg.broadcast("setMeshoptUrl",Hg)},i.eY=un,i.eZ=$t,i.e_=ad,i.ea=fa,i.eb=Ct,i.ec=It,i.ed=class{constructor(a,t,s,u){this.context=a,this.format=u,this.size=s,this.texture=a.gl.createTexture();const[h,m,_]=this.size,{gl:S}=a;S.bindTexture(S.TEXTURE_3D,this.texture),a.pixelStoreUnpackFlipY.set(!1),a.pixelStoreUnpack.set(1),a.pixelStoreUnpackPremultiplyAlpha.set(!1),S.texImage3D(S.TEXTURE_3D,0,this.format,h,m,_,0,Kb(this.format),Yb(this.format),t.data)}bind(a,t){const{context:s}=this,{gl:u}=s;u.bindTexture(u.TEXTURE_3D,this.texture),a!==this.minFilter&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MAG_FILTER,a),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MIN_FILTER,a),this.minFilter=a),t!==this.wrapS&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_S,t),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_T,t),this.wrapS=t)}destroy(){const{gl:a}=this.context;a.deleteTexture(this.texture),this.texture=null}},i.ee=function(a,t){if(a===t){var s=t[1],u=t[2],h=t[3],m=t[6],_=t[7],S=t[11];a[1]=t[4],a[2]=t[8],a[3]=t[12],a[4]=s,a[6]=t[9],a[7]=t[13],a[8]=u,a[9]=m,a[11]=t[14],a[12]=h,a[13]=_,a[14]=S}else a[0]=t[0],a[1]=t[4],a[2]=t[8],a[3]=t[12],a[4]=t[1],a[5]=t[5],a[6]=t[9],a[7]=t[13],a[8]=t[2],a[9]=t[6],a[10]=t[10],a[11]=t[14],a[12]=t[3],a[13]=t[7],a[14]=t[11],a[15]=t[15];return a},i.ef=tw,i.eg=He,i.eh=[1,1,1],i.ei=function(a,t,s,u){var h=new R(4);return h[0]=a,h[1]=t,h[2]=s,h[3]=u,h},i.ej=kr,i.ek=function(a,t,s,u){var h=t[0],m=t[1],_=t[2],S=t[3];return a[0]=h+u*(s[0]-h),a[1]=m+u*(s[1]-m),a[2]=_+u*(s[2]-_),a[3]=S+u*(s[3]-S),a},i.el=Bg,i.em=jg,i.en=ol,i.eo=lu,i.ep=function(a,t,s,u,h,m,_,S,E,A,D,O,F,G,W,Q){var ae=new R(16);return ae[0]=a,ae[1]=t,ae[2]=s,ae[3]=u,ae[4]=h,ae[5]=m,ae[6]=_,ae[7]=S,ae[8]=E,ae[9]=A,ae[10]=D,ae[11]=O,ae[12]=F,ae[13]=G,ae[14]=W,ae[15]=Q,ae},i.eq=te,i.er=ff,i.es=sp,i.et=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new Qt(1/0,1/0),max:new Qt(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(a,t=!1){const s=cE(new Qt(0,0),new Qt(en,en),a),u=[];if(t&&!Tb(s,this._globalClipBounds))return u;for(const h of this._activeRegions){if(h.hiddenByOverlap||!Tb(s,h))continue;const m=cN(h.min,h.max,a);u.push({min:m.min,max:m.max,sourceId:this._sourceIds[h.priority],footprint:h.footprint,footprintTileId:h.tileId,order:h.order,clipMask:h.clipMask,clipScope:h.clipScope})}return u}setSources(a){this._setSources(a.map(t=>({getSourceId:()=>t.cache.id,getFootprints:()=>{const s=[];for(const u of t.cache.getVisibleCoordinates()){const h=t.cache.getTile(u).buckets[t.layer];h&&h.updateFootprints(u.toUnwrapped(),s)}return s},getOrder:()=>t.order,getClipMask:()=>t.clipMask,getClipScope:()=>t.clipScope})))}_addSource(a){const t=a.getFootprints();if(t.length===0)return;const s=a.getOrder(),u=a.getClipMask(),h=a.getClipScope();for(const m of t){if(!m.footprint)continue;const _=cE(m.footprint.min,m.footprint.max,m.id);this._activeRegions.push({min:_.min,max:_.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:m.id,footprint:m.footprint,order:s,clipMask:u,clipScope:h})}this._sourceIds.push(a.getSourceId())}_computeReplacement(){this._activeRegions.sort((t,s)=>t.priority-s.priority||px(t.min,s.min)||px(t.max,s.max)||t.order-s.order||t.clipMask-s.clipMask||function(u,h){const m=(_,S)=>_+S;return u.length-h.length||u.reduce(m,"").localeCompare(h.reduce(m,""))}(t.clipScope,s.clipScope));let a=this._activeRegions.length!==this._prevRegions.length;if(!a){let t=0;for(;!a&&t!==this._activeRegions.length;){const s=this._activeRegions[t],u=this._prevRegions[t];a=s.priority!==u.priority||!lE(s,u)||s.order!==u.order||s.clipMask!==u.clipMask||!yl(s.clipScope,u.clipScope),++t}}if(a){++this._updateTime;for(const s of this._activeRegions)s.order!==fx&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,s.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,s.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,s.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,s.max.y));const t=s=>{const u=this._activeRegions;if(s>=u.length)return s;const h=u[s].priority;for(;s<u.length&&u[s].priority===h;)++s;return s};if(this._sourceIds.length>1){let s=0,u=t(s);for(;s!==u;){let h=s;const m=s;for(;h!==u;){const _=this._activeRegions[h];_.hiddenByOverlap=!1;for(let S=0;S<m;S++){const E=this._activeRegions[S];if(!E.hiddenByOverlap&&_.order===fx&&Tb(_,E)&&(_.hiddenByOverlap=dE(_.footprint,_.tileId,E.footprint,E.tileId),_.hiddenByOverlap))break}++h}s=u,u=t(s)}}}}_setSources(a){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let t=a.length-1;t>=0;t--)this._addSource(a[t]);this._computeReplacement()}},i.eu=class{constructor(a){this._createGrid(a),this._createPoles(a)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const a of this._poleSegments)a.destroy();for(const a of this._gridSegments)a.withSkirts.destroy(),a.withoutSkirts.destroy()}_fillGridMeshWithLods(a,t){const s=new Vl,u=new gs,h=[],m=a+1+2,_=t[0]+1,S=t[0]+1+(1+t.length),E=(A,D,O)=>{let F=A===m-1?A-2:A===0?A:A-1;return F+=O?24575:0,[F,D]};for(let A=0;A<m;++A)s.emplaceBack(...E(A,0,!0));for(let A=0;A<_;++A)for(let D=0;D<m;++D)s.emplaceBack(...E(D,A,(D===0||D===m-1)&&!0));for(let A=0;A<t.length;++A){const D=t[A];for(let O=0;O<m;++O)s.emplaceBack(...E(O,D,!0))}for(let A=0;A<t.length;++A){const D=u.length,O=t[A]+1+2,F=new gs;for(let Q=0;Q<O-1;Q++){const ae=Q===O-2,ce=ae?m*(S-t.length+A-Q):m;for(let we=0;we<m-1;we++){const ve=Q*m+we;Q===0||ae||we===0||we===m-2?(F.emplaceBack(ve+1,ve,ve+ce),F.emplaceBack(ve+ce,ve+ce+1,ve+1)):(u.emplaceBack(ve+1,ve,ve+ce),u.emplaceBack(ve+ce,ve+ce+1,ve+1))}}const G=ki.simpleSegment(0,D,s.length,u.length-D);for(let Q=0;Q<F.uint16.length;Q+=3)u.emplaceBack(F.uint16[Q],F.uint16[Q+1],F.uint16[Q+2]);const W=ki.simpleSegment(0,D,s.length,u.length-D);h.push({withoutSkirts:G,withSkirts:W})}return{vertices:s,indices:u,segments:h}}_createGrid(a){const t=this._fillGridMeshWithLods(z,j);this._gridSegments=t.segments,this._gridBuffer=a.createVertexBuffer(t.vertices,Bs.members),this._gridIndexBuffer=a.createIndexBuffer(t.indices,!0)}_createPoles(a){const t=new gs;for(let _=0;_<=z;_++)t.emplaceBack(0,_+1,_+2);this._poleIndexBuffer=a.createIndexBuffer(t,!0);const s=new au,u=new au,h=new au,m=new au;this._poleSegments=[];for(let _=0,S=0;_<C;_++){const E=360/(1<<_);s.emplaceBack(0,-w,0,.5,0),u.emplaceBack(0,-w,0,.5,1),h.emplaceBack(0,-w,0,.5,.5),m.emplaceBack(0,-w,0,.5,.5);for(let A=0;A<=z;A++){let D=A/z,O=0;const F=kn(0,E,D),[G,W,Q]=q(M,B,F,w);s.emplaceBack(G,W,Q,D,O),u.emplaceBack(G,W,Q,D,1-O);const ae=ie(F);D=.5+.5*Math.sin(ae),O=.5+.5*Math.cos(ae),h.emplaceBack(G,W,Q,D,O),m.emplaceBack(G,W,Q,D,1-O)}this._poleSegments.push(ki.simpleSegment(S,0,66,64)),S+=66}this._poleNorthVertexBuffer=a.createVertexBuffer(s,Jo,!1),this._poleSouthVertexBuffer=a.createVertexBuffer(u,Jo,!1),this._texturedPoleNorthVertexBuffer=a.createVertexBuffer(h,Jo,!1),this._texturedPoleSouthVertexBuffer=a.createVertexBuffer(m,Jo,!1)}getGridBuffers(a,t){return[this._gridBuffer,this._gridIndexBuffer,t?this._gridSegments[a].withSkirts:this._gridSegments[a].withoutSkirts]}getPoleBuffers(a,t){return[t?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,t?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[a]]}},i.ev=fx,i.ew=Ve,i.ex=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},i.ey=qe,i.ez=Ht,i.f=function(a){return a.indexOf("mapbox:")===0},i.f0=QP,i.f1=zE,i.f2=Fm,i.f3="hd_road_elevation",i.f4=xb,i.f5=Yn,i.f6=jm,i.f7=jb,i.f8=Vm,i.f9=function(a,t,s,u,h,m,_,S=1,E,A){a.createArrays(),a.tilePixelRatio=en/(512*a.overscaling),a.compareText={},a.iconsNeedLinear=!1;const D=a.layers[0].layout,O=a.layers[0]._unevaluatedLayout._values,F={};F.scaleFactor=S,F.textSizeScaleRange=D.get("text-size-scale-range"),F.iconSizeScaleRange=D.get("icon-size-scale-range");const[G,W]=F.textSizeScaleRange,[Q,ae]=F.iconSizeScaleRange;F.textScaleFactor=Xe(F.scaleFactor,G,W),F.iconScaleFactor=Xe(F.scaleFactor,Q,ae);const ce=O["text-size"],we=O["icon-size"];if(a.textSizeData.kind==="composite"){const{minZoom:Fe,maxZoom:$e}=a.textSizeData;F.compositeTextSizes=[ce.possiblyEvaluate(new ni(Fe),m),ce.possiblyEvaluate(new ni($e),m)]}if(a.iconSizeData.kind==="composite"){const{minZoom:Fe,maxZoom:$e}=a.iconSizeData;F.compositeIconSizes=[we.possiblyEvaluate(new ni(Fe),m),we.possiblyEvaluate(new ni($e),m)]}F.layoutTextSize=ce.possiblyEvaluate(new ni(_+1),m),F.layoutIconSize=we.possiblyEvaluate(new ni(_+1),m),F.textMaxSize=ce.possiblyEvaluate(new ni(18),m);const ve=D.get("symbol-placement"),ee=D.get("text-rotation-alignment")==="map"&&ve!=="point",ge=D.get("text-size");let be=!1;const Ie=[];for(const Fe of a.features){const $e=D.get("text-font").evaluate(Fe,{},m).join(","),Ze=ge.evaluate(Fe,{},m)*F.textScaleFactor,et=F.layoutTextSize.evaluate(Fe,{},m)*F.textScaleFactor,St=F.layoutIconSize.evaluate(Fe,{},m)*F.iconScaleFactor,jt={horizontal:{},vertical:void 0},kt=Fe.text;let Ft,Gt=[0,0];if(kt){const Sn=kt.toString(),$n=D.get("text-letter-spacing").evaluate(Fe,{},m)*mo,Jn=D.get("text-line-height").evaluate(Fe,{},m)*mo,ir=ym(Sn)?$n:0,yr=D.get("text-anchor").evaluate(Fe,{},m),fr=D.get("text-variable-anchor");if(!fr){const Ae=D.get("text-radial-offset").evaluate(Fe,{},m);if(Ae)Gt=xI(yr,[Ae*mo,Vb]);else{const Et=D.get("text-offset").evaluate(Fe,{},m);Gt=[Et[0]*mo,Et[1]*mo]}}let ar=ee?"center":D.get("text-justify").evaluate(Fe,{},m);const _i=ve==="point",Ri=_i?D.get("text-max-width").evaluate(Fe,{},m)*mo:1/0,Ee=Ae=>{a.allowVerticalPlacement&&Fl(Sn)&&(jt.vertical=zb(kt,t,s,h,$e,Ri,Jn,yr,Ae,ir,Gt,dl.vertical,!0,et,Ze,E))};if(!ee&&fr){const Ae=ar==="auto"?fr.map(Jt=>Ub(Jt)):[ar];let Et=!1;for(let Jt=0;Jt<Ae.length;Jt++){const an=Ae[Jt];if(!jt.horizontal[an])if(Et)jt.horizontal[an]=jt.horizontal[0];else{const on=zb(kt,t,s,h,$e,Ri,Jn,"center",an,ir,Gt,dl.horizontal,!1,et,Ze,E);on&&(jt.horizontal[an]=on,Et=on.positionedLines.length===1)}}Ee("left")}else{if(ar==="auto"&&(ar=Ub(yr)),_i||D.get("text-writing-mode").indexOf("horizontal")>=0||!Fl(Sn)){const Ae=zb(kt,t,s,h,$e,Ri,Jn,yr,ar,ir,Gt,dl.horizontal,!1,et,Ze,E);Ae&&(jt.horizontal[ar]=Ae)}Ee(_i?"left":ar)}}let vt,zt,gt,bt,qt,Kt,En,_n=!1;if(Fe.icon&&Fe.icon.hasPrimary()){const Sn=wI(Fe.icon,a.iconSizeData,O["icon-size"],m,a.zoom,Fe,E,F.iconScaleFactor);vt=Sn.iconPrimary,gt=Sn.iconSecondary;const $n=vt.toString();if(zt=u.get($n),zt&&(qt=D.get("icon-offset").evaluate(Fe,{},m),Kt=D.get("icon-anchor").evaluate(Fe,{},m),En=D.get("icon-text-fit").evaluate(Fe,{},m),Ft=ZN(h.get($n),gt?h.get(gt.toString()):void 0,qt,Kt),_n=zt.sdf,a.sdfIcons===void 0?a.sdfIcons=zt.sdf:a.sdfIcons!==zt.sdf&&gr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(zt.pixelRatio!==a.pixelRatio||D.get("icon-rotate").constantOr(1)!==0)&&(a.iconsNeedLinear=!0)),gt){const Jn=gt.toString();bt=u.get(Jn)}}be=be||!(!Fe.icon||!Fe.icon.hasSecondary());const sn=$b(jt.horizontal)||jt.vertical;a.iconsInText||(a.iconsInText=!!sn&&sn.iconsInText);const Wt=et*F.textScaleFactor/mo,{defaultShapedIcon:Wn,verticallyShapedIcon:wn}=rj(a,Ft,D,Fe,m,jt,Wt,qt,En);En!=="none"&&Ft&&(iI(Ft)||sI(Ft))&&(Cx(0,zt,vt,Ft,Wn,En,A,u,h),Cx(0,bt,gt,Ft,Wn,En,A,u,h),wn&&(Cx(0,zt,vt,Ft,wn,En,A,u,h),Cx(0,bt,gt,Ft,wn,En,A,u,h))),Ft=Wn,Ie.push({feature:Fe,shapedTextOrientations:jt,shapedText:sn,shapedIcon:Ft,iconPrimary:vt,iconSecondary:gt,iconOffset:qt,iconAnchor:Kt,verticallyShapedIcon:wn,layoutTextSize:et,layoutIconSize:St,textOffset:Gt,isSDFIcon:_n,iconTextFit:En})}return{featureData:Ie,sizes:F,hasAnySecondaryIcon:be,textAlongLine:ee,symbolPlacement:ve}},i.fa=pI,i.fb=function(a,t,s,u,h,m,_,S,E,A){const{featureData:D,hasAnySecondaryIcon:O,sizes:F,textAlongLine:G,symbolPlacement:W}=t;for(const Q of D){const{shapedIcon:ae,verticallyShapedIcon:ce,feature:we,shapedTextOrientations:ve,shapedText:ee,layoutTextSize:ge,textOffset:be,isSDFIcon:Ie,iconPrimary:Fe,iconSecondary:$e,iconTextFit:Ze,iconOffset:et}=Q;SI(ae,A.iconPositions,Fe,$e),SI(ce,A.iconPositions,Fe,$e),nj(ve,A.iconPositions),(ee||ae)&&ij(a,we,ve,ae,ce,E,F,ge,0,be,Ie,u,h,_,S,O,Ze,et,G,W)}s&&a.generateCollisionDebugBuffers(m,a.collisionBoxArray,F.textScaleFactor)},i.fc=wp,i.fd=Xx,i.fe=_d,i.ff=WT,i.fg=KE,i.fh=Sa,i.fi=function(a){let t=0;if(new Uint32Array(a,0,1)[0]!==GP){const s=new Uint32Array(a,0,7),[,,u,h,m,_]=s;t=s.byteLength+h+m+_+m,(u!==a.byteLength||t>=a.byteLength)&&gr("Invalid b3dm header information.")}return XP(a,t)},i.fj=function(a,t){const s=YP(a);for(const u of s){for(const h of u.meshes)DB(h);u.lights&&(u.lightMeshIndex=u.meshes.length,u.meshes.push(kB(u.lights,t)))}return s},i.fk=Vx,i.fl=xi,i.fm=dP,i.fn=ea,i.fo=function(a){wl(),aa!=null&&aa.then(t=>{t.keys().then(s=>{for(let u=0;u<s.length-a;u++)t.delete(s[u]).catch(h=>gr(h.message))}).catch(s=>gr(s.message))}).catch(t=>gr(t.message))},i.g=function(a,t){return Au(ft(a,{method:"GET"}),t)},i.h=xl,i.i=function(a){return os.API_STYLE_REGEX.test(a)&&!Eu(a)},i.j=function(a){return decodeURIComponent(atob(a).split("").map(t=>"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)).join(""))},i.k=function(a){return btoa(encodeURIComponent(a).replace(/%([0-9A-F]{2})/g,(t,s)=>String.fromCharCode(+("0x"+s))))},i.l=ft,i.m=zf,i.n=function(a,t){return Au(ft(a,{type:"json"}),t)},i.o=bd,i.p=function(a,t){return Au(ft(a,{method:"POST"}),t)},i.q=sa,i.r=Tn,i.s=function(a){try{const t=self[a];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}},i.t=tm,i.u=function(){return function a(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,a)}()},i.v=function(a){return!!a&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(a)},i.w=gr,i.x=function(){return lw||(lw=new Gm),lw},i.y=fw,i.z=Nf}),y(["./shared"],function(i){function I(wt){const ie=wt?wt.url.toString():void 0;return ie?performance.getEntriesByName(ie):[]}function R(wt){if(typeof wt=="number"||typeof wt=="boolean"||typeof wt=="string"||wt==null)return JSON.stringify(wt);if(Array.isArray(wt)){let me="[";for(const Le of wt)me+=`${R(Le)},`;return`${me}]`}let ie="{";for(const me of Object.keys(wt).sort())ie+=`${me}:${R(wt[me])},`;return`${ie}}`}function k(wt){let ie="";for(const me of i.bu)(wt.type!=="model"||me!=="minzoom"&&me!=="maxzoom")&&(ie+=`/${R(wt[me])}`);return ie}class N{constructor(ie){this.keyCache={},this._layers={},this._layerConfigs={},ie&&this.replace(ie)}replace(ie,me){this._layerConfigs={},this._layers={},this.update(ie,[],me)}update(ie,me,Le){this._options=Le;for(const Ve of ie)this._layerConfigs[Ve.id]=Ve,(this._layers[Ve.id]=i.dc(Ve,this.scope,null,this._options)).compileFilter(Le),this.keyCache[Ve.id]&&delete this.keyCache[Ve.id];for(const Ve of me)delete this.keyCache[Ve],delete this._layerConfigs[Ve],delete this._layers[Ve];this.familiesBySource={};const Be=function(Ve,qe){const Xe={};for(let pt=0;pt<Ve.length;pt++){const Lt=Ve[pt];let ft=qe&&qe[Lt.id];ft||(Lt.type==="symbol"?ft=Lt.id:(ft=k(Lt),Lt.type==="line"&&Lt.paint&&function ln(xn){return typeof xn=="string"&&xn==="line-progress"||(Array.isArray(xn)?xn.some(ln):!(!xn||typeof xn!="object")&&Object.values(xn).some(ln))}(Lt.paint["line-width"])&&(ft+=`/${R(Lt.paint["line-width"])}`))),qe&&(qe[Lt.id]=ft);let tn=Xe[ft];tn||(tn=Xe[ft]=[]),tn.push(Lt)}const Ke=[];for(const pt in Xe)Ke.push(Xe[pt]);return Ke}(Object.values(this._layerConfigs),this.keyCache);for(const Ve of Be){const qe=Ve.map(tn=>this._layers[tn.id]),Xe=qe[0];if(Xe.visibility==="none")continue;const Ke=Xe.source||"";let pt=this.familiesBySource[Ke];pt||(pt=this.familiesBySource[Ke]={});const Lt=Xe.sourceLayer||"_geojsonTileLayer";let ft=pt[Lt];ft||(ft=pt[Lt]=[]),ft.push(qe)}}}const U=1*i.e_;class K{constructor(ie){const me={},Le=[];for(const Xe in ie){const Ke=ie[Xe],pt=me[Xe]={};for(const Lt in Ke.glyphs){const ft=Ke.glyphs[+Lt];if(!ft||ft.bitmap.width===0||ft.bitmap.height===0)continue;const tn=ft.metrics.localGlyph?U:1,ln={x:0,y:0,w:ft.bitmap.width+2*tn,h:ft.bitmap.height+2*tn};Le.push(ln),pt[Lt]=ln}}const{w:Be,h:Ve}=i.H(Le),qe=new i.eZ({width:Be||1,height:Ve||1});for(const Xe in ie){const Ke=ie[Xe];for(const pt in Ke.glyphs){const Lt=Ke.glyphs[+pt];if(!Lt||Lt.bitmap.width===0||Lt.bitmap.height===0)continue;const ft=me[Xe][pt],tn=Lt.metrics.localGlyph?U:1;i.eZ.copy(Lt.bitmap,qe,{x:0,y:0},{x:ft.x+tn,y:ft.y+tn},Lt.bitmap)}}this.image=qe,this.positions=me}}i.eY(K,"GlyphAtlas");class X{constructor(ie){this.tileID=new i.aM(ie.tileID.overscaledZ,ie.tileID.wrap,ie.tileID.canonical.z,ie.tileID.canonical.x,ie.tileID.canonical.y),this.tileZoom=ie.tileZoom,this.uid=ie.uid,this.zoom=ie.zoom,this.lut=ie.lut,this.canonical=ie.tileID.canonical,this.pixelRatio=ie.pixelRatio,this.tileSize=ie.tileSize,this.source=ie.source,this.scope=ie.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ie.showCollisionBoxes,this.collectResourceTiming=!!ie.request&&ie.request.collectResourceTiming,this.promoteId=ie.promoteId,this.isSymbolTile=ie.isSymbolTile,this.tileTransform=i.aW(ie.tileID.canonical,ie.projection),this.projection=ie.projection,this.worldview=ie.worldview,this.localizableLayerIds=ie.localizableLayerIds,this.brightness=ie.brightness,this.extraShadowCaster=!!ie.extraShadowCaster,this.tessellationStep=ie.tessellationStep,this.scaleFactor=ie.scaleFactor}parse(ie,me,Le,Be,Ve,qe){this.status="parsing",this.data=ie,this.collisionBoxArray=new i.b0;const Xe=new i.e$(Object.keys(ie.layers).sort()),Ke=new i.f0(this.tileID,this.promoteId);Ke.bucketLayerIDs=[];const pt={},Lt=new i.f1(256,256),ft={featureIndex:Ke,iconDependencies:new Map,patternDependencies:new Map,glyphDependencies:{},lineAtlas:Lt,availableImages:Le,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},tn=me.familiesBySource[this.source];for(const Hr in tn){const vr=ie.layers[Hr];if(!vr)continue;let xi=!1,Qi=!1,bs=!1;for(const $s of tn[Hr])$s[0].type==="symbol"?xi=!0:Qi=!0,$s[0].is3D()&&$s[0].type!=="model"&&(bs=!0);if(this.extraShadowCaster&&!bs||this.isSymbolTile===!0&&!xi||this.isSymbolTile===!1&&!Qi)continue;vr.version===1&&i.w(`Vector tile source "${this.source}" layer "${Hr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Es=Xe.encode(Hr),eo=[];let vl=!1;for(let $s=0,ms=0;$s<vr.length;$s++){const Hs=vr.feature($s),os=Ke.getId(Hs,Hr);if(this.localizableLayerIds&&this.localizableLayerIds.has(Hr)){const xl=Hs.properties?Hs.properties.worldview:null;if(this.worldview&&typeof xl=="string")if(xl==="all")Hs.properties.$localized=!0;else{if(!xl.split(",").includes(this.worldview))continue;Hs.properties.$localized=!0,Hs.properties.worldview=this.worldview}}!vl&&Hs.properties&&Hs.properties.hasOwnProperty(i.f2)&&(vl=!0),eo.push({feature:Hs,id:os,index:ms,sourceLayerIndex:Es}),ms++}vl&&!ft.elevationFeatures&&ie.layers.hasOwnProperty(i.f3)&&(ft.elevationFeatures=i.f4.parseFrom(ie.layers[i.f3],this.canonical));for(const $s of tn[Hr]){const ms=$s[0];(!this.extraShadowCaster||ms.is3D()&&ms.type!=="model")&&(this.isSymbolTile!==void 0&&ms.type==="symbol"!==this.isSymbolTile||ms.minzoom&&this.zoom<Math.floor(ms.minzoom)||ms.maxzoom&&this.zoom>=ms.maxzoom||ms.visibility!=="none"&&(Z($s,this.zoom,ft.brightness,Le),(pt[ms.id]=ms.createBucket({index:Ke.bucketLayerIDs.length,layers:$s,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Es,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep,styleDefinedModelURLs:Be})).populate(eo,ft,this.tileID.canonical,this.tileTransform),Ke.bucketLayerIDs.push($s.map(Hs=>i.C(Hs.id,Hs.scope)))))}}let ln,xn,Zn,Yn,rr,pr;Lt.trim();const Vi={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},gr=()=>{if(ln)return this.status="done",qe(ln);if(this.extraShadowCaster)this.status="done",qe(null,{buckets:Object.values(pt).filter(Hr=>!Hr.isEmpty()),featureIndex:Ke,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:ft.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(xn&&Zn&&Yn){const Hr=new K(xn),vr=new Map;for(const[bs,Es]of Zn.entries()){const{imagePosition:eo}=i.f7(bs,Es,i.f8);vr.set(bs,eo)}const xi={};for(const bs in pt){const Es=pt[bs];Es instanceof i.b1&&(Z(Es.layers,this.zoom,ft.brightness,Le),xi[bs]=i.f9(Es,xn,Hr.positions,Zn,vr,this.tileID.canonical,this.tileZoom,this.scaleFactor,this.pixelRatio,rr))}const Qi={iconsPending:!0,patternsPending:!0};this.rasterizeIfNeeded(Ve,Zn,rr,()=>{Qi.iconsPending=!1,gi(xi,Hr,Qi)}),this.rasterizeIfNeeded(Ve,Yn,pr,()=>{Qi.patternsPending=!1,gi(xi,Hr,Qi)})}},gi=(Hr,vr,xi,Qi)=>{if(xi.iconsPending||xi.patternsPending)return;const bs=new i.fa(Zn,Yn,this.lut);for(const Es in pt){const eo=pt[Es];if(Es in Hr)i.fb(eo,Hr[Es],this.showCollisionBoxes,Le,this.tileID.canonical,this.tileZoom,this.projection,this.brightness,Zn,bs);else if(eo.hasPattern&&(eo instanceof i.b7||eo instanceof i.b8||eo instanceof i.dV)){Z(eo.layers,this.zoom,ft.brightness,Le);const vl=Object.fromEntries(bs.patternPositions);eo.addFeatures(ft,this.tileID.canonical,vl,Le,this.tileTransform,this.brightness)}}this.status="done",qe(null,{buckets:Object.values(pt).filter(Es=>!Es.isEmpty()),featureIndex:Ke,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:vr.image,lineAtlas:Lt,imageAtlas:bs,brightness:ft.brightness})};if(!this.extraShadowCaster){const Hr=i.f5(ft.glyphDependencies,Qi=>Object.keys(Qi).map(Number));Object.keys(Hr).length?Ve.send("getGlyphs",{uid:this.uid,stacks:Hr,scope:this.scope},(Qi,bs)=>{ln||(ln=Qi,xn=bs,gr())},void 0,!1,Vi):xn={};const vr=Array.from(ft.iconDependencies.keys()).map(Qi=>i.I.parse(Qi));vr.length?Ve.send("getImages",{images:vr,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(Qi,bs)=>{ln||(ln=Qi,Zn=new Map,rr=this.updateImageMapAndGetImageTaskQueue(Zn,bs,ft.iconDependencies),gr())},void 0,!1,Vi):(Zn=new Map,rr=new Map);const xi=Array.from(ft.patternDependencies.keys()).map(Qi=>i.I.parse(Qi));xi.length?Ve.send("getImages",{images:xi,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(Qi,bs)=>{ln||(ln=Qi,Yn=new Map,pr=this.updateImageMapAndGetImageTaskQueue(Yn,bs,ft.patternDependencies),gr())},void 0,!1,Vi):(Yn=new Map,pr=new Map)}if(ft.elevationFeatures&&ft.elevationFeatures.length>0){const Hr=[];for(const xi of Object.values(pt))if(xi instanceof i.b8){const Qi=xi.getUnevaluatedPortalGraph();Qi&&Hr.push(Qi)}const vr=i.f6.evaluate(Hr);for(const xi of Object.values(pt))xi instanceof i.b8&&xi.setEvaluatedPortalGraph(vr)}gr()}rasterizeIfNeeded(ie,me,Le,Be){Array.from(me.values()).some(Ve=>Ve.usvg)?this.rasterize(ie,me,Le,Be):Be()}updateImageMapAndGetImageTaskQueue(ie,me,Le){const Be=new Map;for(const Ve of me.keys()){const qe=Le.get(Ve)||[];for(const Xe of qe){const Ke=Xe.toString(),pt=me.get(Xe.id.toString());pt.usvg?Be.has(Ke)||(Be.set(Ke,Xe),ie.set(Ke,Object.assign({},pt))):ie.set(Ke,pt)}}return Be}rasterize(ie,me,Le,Be){this.rasterizeTask=ie.send("rasterizeImages",{scope:this.scope,tasks:Le},(Ve,qe)=>{if(!Ve)for(const[Xe,Ke]of qe.entries()){const pt=Object.assign(me.get(Xe),{data:Ke});me.set(Xe,pt)}Be()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function Z(wt,ie,me,Le){const Be=new i.aa(ie,{brightness:me});for(const Ve of wt)Ve.recalculate(Be,Le)}class J extends i.E{constructor(ie,me,Le,Be,Ve,qe,Xe){super(),this.actor=ie,this.layerIndex=me,this.availableImages=Le,this.availableModels=Be,this.loadVectorData=qe||i.aJ,this.loading={},this.loaded={},this.deduped=new i.aI(ie.scheduler),this.isSpriteLoaded=Ve,this.scheduler=ie.scheduler,this.brightness=Xe}loadTile(ie,me){const Le=ie.uid,Be=ie&&ie.request,Ve=Be&&Be.collectResourceTiming,qe=this.loading[Le]=new X(ie);qe.abort=this.loadVectorData(ie,(Xe,Ke)=>{const pt=!this.loading[Le];if(delete this.loading[Le],qe.cancelRasterize(),pt||Xe||!Ke)return qe.status="done",pt||(this.loaded[Le]=qe),me(Xe);const Lt=Ke.rawData,ft={};Ke.expires&&(ft.expires=Ke.expires),Ke.cacheControl&&(ft.cacheControl=Ke.cacheControl),qe.vectorTile=Ke.vectorTile||new i.fc.VectorTile(new i.bq(Lt));const tn=()=>{qe.parse(qe.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,(ln,xn)=>{if(ln||!xn)return me(ln);const Zn={};if(Ve){const Yn=I(Be);Yn.length>0&&(Zn.resourceTiming=JSON.parse(JSON.stringify(Yn)))}me(null,i.l({rawTileData:Lt.slice(0)},xn,ft,Zn))})};this.isSpriteLoaded?tn():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(tn,{type:"parseTile",isSymbolTile:ie.isSymbolTile,zoom:ie.tileZoom}):tn()}),this.loaded=this.loaded||{},this.loaded[Le]=qe})}reloadTile(ie,me){const Le=this.loaded,Be=ie.uid;if(Le&&Le[Be]){const Ve=Le[Be];Ve.scaleFactor=ie.scaleFactor,Ve.showCollisionBoxes=ie.showCollisionBoxes,Ve.projection=ie.projection,Ve.brightness=ie.brightness,Ve.tileTransform=i.aW(ie.tileID.canonical,ie.projection),Ve.extraShadowCaster=ie.extraShadowCaster,Ve.lut=ie.lut;const qe=(Xe,Ke)=>{const pt=Ve.reloadCallback;pt&&(delete Ve.reloadCallback,Ve.parse(Ve.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,pt)),me(Xe,Ke)};Ve.status==="parsing"?Ve.reloadCallback=qe:Ve.status==="done"&&(Ve.vectorTile?Ve.parse(Ve.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,qe):qe())}else me(null,void 0)}abortTile(ie,me){const Le=ie.uid,Be=this.loading[Le];Be&&(Be.abort&&Be.abort(),delete this.loading[Le]),me()}removeTile(ie,me){const Le=this.loaded,Be=ie.uid;Le&&Le[Be]&&delete Le[Be],me()}}class le{loadTile(ie,me){const{uid:Le,encoding:Be,rawImageData:Ve,padding:qe}=ie,Xe=ImageBitmap&&Ve instanceof ImageBitmap?this.getImageData(Ve,qe):Ve;me(null,new i.fd(Le,Xe,Be,qe<1))}reloadTile(ie,me){me(null,null)}abortTile(ie,me){me()}removeTile(ie,me){me()}getImageData(ie,me){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ie.width,ie.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ie.width,this.offscreenCanvas.height=ie.height,this.offscreenCanvasContext.drawImage(ie,0,0,ie.width,ie.height);const Le=this.offscreenCanvasContext.getImageData(-me,-me,ie.width+2*me,ie.height+2*me);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Le}}i.bp.setPbf(i.bq);class de{constructor(ie){this._mrt=new i.bp(ie.partial?30:1/0),this._isHeaderLoaded=!1,this.uid=ie.uid,this.tileID=ie.tileID,this.source=ie.source}parse(ie,me){const Le=this._mrt;this.status="parsing",this._entireBuffer=ie;try{Le.parseHeader(ie),this._isHeaderLoaded=!0;const Be=[];for(const Ve in Le.layers){const qe=Le.getLayer(Ve),Xe=qe.getDataRange(qe.getBandList()),Ke=Le.createDecodingTask(Xe),pt=ie.slice(Xe.firstByte,Xe.lastByte+1),Lt=i.bp.performDecoding(pt,Ke).then(ft=>Ke.complete(null,ft)).catch(ft=>Ke.complete(ft,null));Be.push(Lt)}Promise.allSettled(Be).then(()=>me(null,Le)).catch(Ve=>me(Ve))}catch(Be){me(Be)}}}class ue{constructor(ie){this.actor=ie,this.loading={},this.loaded={}}loadTile(ie,me){const Le=ie.uid,Be=ie.request,Ve=this.loading[Le]=new de(ie),{cancel:qe}=i.br(Be,(Xe,Ke,pt,Lt)=>{const ft=!this.loading[Le];if(delete this.loading[Le],ft||Xe||!Ke)return Ve.status="done",ft||(this.loaded[Le]=Ve),me(Xe);Ve.parse(Ke,(tn,ln)=>{if(tn||!ln)return me(tn);me(null,ln,pt,Lt)}),this.loaded[Le]=Ve});Ve.abort=qe}reloadTile(ie,me){me(null,void 0)}abortTile(ie,me){const Le=ie.uid,Be=this.loading[Le];Be&&(Be.abort&&Be.abort(),delete this.loading[Le]),me()}removeTile(ie,me){const Le=ie.uid;this.loaded[Le]&&delete this.loaded[Le],me()}decodeRasterArray(ie,me){i.bp.performDecoding(ie.buffer,ie.task).then(Le=>me(null,Le)).catch(Le=>me(Le))}}const pe=i.fc.VectorTileFeature.prototype.toGeoJSON;class he{constructor(ie){this._feature=ie,this.extent=i.aj,this.type=ie.type,this.properties=ie.tags,"id"in ie&&!isNaN(ie.id)&&(this.id=parseInt(ie.id,10))}loadGeometry(){if(this._feature.type===1){const ie=[];for(const me of this._feature.geometry)ie.push([new i.P(me[0],me[1])]);return ie}{const ie=[];for(const me of this._feature.geometry){const Le=[];for(const Be of me)Le.push(new i.P(Be[0],Be[1]));ie.push(Le)}return ie}}toGeoJSON(ie,me,Le){return pe.call(this,ie,me,Le)}}class xe{constructor(ie){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=i.aj,this.length=ie.length,this._features=ie}feature(ie){return new he(this._features[ie])}}const fe=64/4096,_e=128;class Ce{constructor(){this.features=new Map}clear(){this.features.clear()}load(ie=[],me){for(const Le of ie){const Be=Le.id;if(Be==null)continue;let Ve=this.features.get(Be);Ve&&this.updateCache(Ve,me),Le.geometry?(Ve=He(Le),this.updateCache(Ve,me),this.features.set(Be,Ve)):this.features.delete(Be),this.updateCache(Ve,me)}}updateCache(ie,me){for(const{canonical:Le,uid:Be}of Object.values(me)){const{z:Ve,x:qe,y:Xe}=Le;je(ie,Math.pow(2,Ve),qe,Xe)&&delete me[Be]}}getTile(ie,me,Le){const Be=Math.pow(2,ie),Ve=[];for(const qe of this.features.values())je(qe,Be,me,Le)&&Ve.push(Ge(qe,Be,me,Le));return{features:Ve}}getFeatures(){return[...this.features.values()]}}function je({minX:wt,minY:ie,maxX:me,maxY:Le},Be,Ve,qe){return wt<(Ve+1+fe)/Be&&ie<(qe+1+fe)/Be&&me>(Ve-fe)/Be&&Le>(qe-fe)/Be}function He(wt){const{id:ie,geometry:me,properties:Le}=wt;if(!me)return;if(me.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:Be,coordinates:Ve}=me,qe={id:ie,type:1,geometry:[],tags:Le,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},Xe=qe.geometry;if(Be==="Point")lt(Ve,Xe,qe);else if(Be==="MultiPoint")for(const Ke of Ve)lt(Ke,Xe,qe);else if(Be==="LineString")qe.type=2,_t(Ve,Xe,qe);else if(Be==="MultiLineString")qe.type=2,Ue(Ve,Xe,qe);else if(Be==="Polygon")qe.type=3,Ue(Ve,Xe,qe,!0);else{if(Be!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");qe.type=3;for(const Ke of Ve)Ue(Ke,Xe,qe,!0)}return qe}function lt([wt,ie],me,Le){const Be=i.ay(wt);let Ve=i.aH(ie);Ve=Ve<0?0:Ve>1?1:Ve,me.push(Be,Ve),Le.minX=Math.min(Le.minX,Be),Le.minY=Math.min(Le.minY,Ve),Le.maxX=Math.max(Le.maxX,Be),Le.maxY=Math.max(Le.maxY,Ve)}function _t(wt,ie,me,Le=!1,Be=!1){const Ve=[];for(const qe of wt)lt(qe,Ve,me);ie.push(Ve),Le&&function(qe,Xe){let Ke=0;for(let pt=0,Lt=qe.length,ft=Lt-2;pt<Lt;ft=pt,pt+=2)Ke+=(qe[pt]-qe[ft])*(qe[pt+1]+qe[ft+1]);if(Ke>0===Xe)for(let pt=0,Lt=qe.length;pt<Lt/2;pt+=2){const ft=qe[pt],tn=qe[pt+1];qe[pt]=qe[Lt-2-pt],qe[pt+1]=qe[Lt-1-pt],qe[Lt-2-pt]=ft,qe[Lt-1-pt]=tn}}(Ve,Be)}function Ue(wt,ie,me,Le=!1){for(let Be=0;Be<wt.length;Be++)_t(wt[Be],ie,me,Le,Be===0)}function Ge(wt,ie,me,Le){const{id:Be,type:Ve,geometry:qe,tags:Xe}=wt,Ke=[];if(Ve===1)(function(pt,Lt,ft,tn,ln){for(let xn=0;xn<pt.length;xn+=2){const Zn=Math.round(i.aj*(pt[xn+0]*Lt-ft)),Yn=Math.round(i.aj*(pt[xn+1]*Lt-tn));ln.push([Zn,Yn])}})(qe,ie,me,Le,Ke);else for(const pt of qe)at(pt,ie,me,Le,Ke);return{id:Be,type:Ve,geometry:Ke,tags:Xe}}function at(wt,ie,me,Le,Be){const qe=i.aj+_e;let Xe;for(let Ke=0;Ke<wt.length-2;Ke+=2){let pt=Math.round(i.aj*(wt[Ke+0]*ie-me)),Lt=Math.round(i.aj*(wt[Ke+1]*ie-Le)),ft=Math.round(i.aj*(wt[Ke+2]*ie-me)),tn=Math.round(i.aj*(wt[Ke+3]*ie-Le));const ln=ft-pt,xn=tn-Lt;pt<-128&&ft<-128||(pt<-128?(Lt+=Math.round(xn*((-128-pt)/ln)),pt=-128):ft<-128&&(tn=Lt+Math.round(xn*((-128-pt)/ln)),ft=-128),Lt<-128&&tn<-128||(Lt<-128?(pt+=Math.round(ln*((-128-Lt)/xn)),Lt=-128):tn<-128&&(ft=pt+Math.round(ln*((-128-Lt)/xn)),tn=-128),pt>=qe&&ft>=qe||(pt>=qe?(Lt+=Math.round(xn*((qe-pt)/ln)),pt=qe):ft>=qe&&(tn=Lt+Math.round(xn*((qe-pt)/ln)),ft=qe),Lt>=qe&&tn>=qe||(Lt>=qe?(pt+=Math.round(ln*((qe-Lt)/xn)),Lt=qe):tn>=qe&&(ft=pt+Math.round(ln*((qe-Lt)/xn)),tn=qe),Xe&&pt===Xe[Xe.length-1][0]&&Lt===Xe[Xe.length-1][1]||(Xe=[[pt,Lt]],Be.push(Xe)),Xe.push([ft,tn])))))}}var yt,tt,Rt,ct={exports:{}},ze=function(){if(Rt)return ct.exports;Rt=1;var wt=i.fg(),ie=function(){if(tt)return yt;tt=1;var Lt=i.fe(),ft=i.ff().VectorTileFeature;function tn(xn,Zn){this.options=Zn||{},this.features=xn,this.length=xn.length}function ln(xn,Zn){this.id=typeof xn.id=="number"?xn.id:void 0,this.type=xn.type,this.rawGeometry=xn.type===1?[xn.geometry]:xn.geometry,this.properties=xn.tags,this.extent=Zn||4096}return yt=tn,tn.prototype.feature=function(xn){return new ln(this.features[xn],this.options.extent)},ln.prototype.loadGeometry=function(){var xn=this.rawGeometry;this.geometry=[];for(var Zn=0;Zn<xn.length;Zn++){for(var Yn=xn[Zn],rr=[],pr=0;pr<Yn.length;pr++)rr.push(new Lt(Yn[pr][0],Yn[pr][1]));this.geometry.push(rr)}return this.geometry},ln.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var xn=this.geometry,Zn=1/0,Yn=-1/0,rr=1/0,pr=-1/0,Vi=0;Vi<xn.length;Vi++)for(var gr=xn[Vi],gi=0;gi<gr.length;gi++){var Hr=gr[gi];Zn=Math.min(Zn,Hr.x),Yn=Math.max(Yn,Hr.x),rr=Math.min(rr,Hr.y),pr=Math.max(pr,Hr.y)}return[Zn,rr,Yn,pr]},ln.prototype.toGeoJSON=ft.prototype.toGeoJSON,yt}();function me(Lt){var ft=new wt;return function(tn,ln){for(var xn in tn.layers)ln.writeMessage(3,Le,tn.layers[xn])}(Lt,ft),ft.finish()}function Le(Lt,ft){var tn;ft.writeVarintField(15,Lt.version||1),ft.writeStringField(1,Lt.name||""),ft.writeVarintField(5,Lt.extent||4096);var ln={keys:[],values:[],keycache:{},valuecache:{}};for(tn=0;tn<Lt.length;tn++)ln.feature=Lt.feature(tn),ft.writeMessage(2,Be,ln);var xn=ln.keys;for(tn=0;tn<xn.length;tn++)ft.writeStringField(3,xn[tn]);var Zn=ln.values;for(tn=0;tn<Zn.length;tn++)ft.writeMessage(4,pt,Zn[tn])}function Be(Lt,ft){var tn=Lt.feature;tn.id!==void 0&&ft.writeVarintField(1,tn.id),ft.writeMessage(2,Ve,Lt),ft.writeVarintField(3,tn.type),ft.writeMessage(4,Ke,tn)}function Ve(Lt,ft){var tn=Lt.feature,ln=Lt.keys,xn=Lt.values,Zn=Lt.keycache,Yn=Lt.valuecache;for(var rr in tn.properties){var pr=tn.properties[rr],Vi=Zn[rr];if(pr!==null){Vi===void 0&&(ln.push(rr),Zn[rr]=Vi=ln.length-1),ft.writeVarint(Vi);var gr=typeof pr;gr!=="string"&&gr!=="boolean"&&gr!=="number"&&(pr=JSON.stringify(pr));var gi=gr+":"+pr,Hr=Yn[gi];Hr===void 0&&(xn.push(pr),Yn[gi]=Hr=xn.length-1),ft.writeVarint(Hr)}}}function qe(Lt,ft){return(ft<<3)+(7&Lt)}function Xe(Lt){return Lt<<1^Lt>>31}function Ke(Lt,ft){for(var tn=Lt.loadGeometry(),ln=Lt.type,xn=0,Zn=0,Yn=tn.length,rr=0;rr<Yn;rr++){var pr=tn[rr],Vi=1;ln===1&&(Vi=pr.length),ft.writeVarint(qe(1,Vi));for(var gr=ln===3?pr.length-1:pr.length,gi=0;gi<gr;gi++){gi===1&&ln!==1&&ft.writeVarint(qe(2,gr-1));var Hr=pr[gi].x-xn,vr=pr[gi].y-Zn;ft.writeVarint(Xe(Hr)),ft.writeVarint(Xe(vr)),xn+=Hr,Zn+=vr}ln===3&&ft.writeVarint(qe(7,1))}}function pt(Lt,ft){var tn=typeof Lt;tn==="string"?ft.writeStringField(1,Lt):tn==="boolean"?ft.writeBooleanField(7,Lt):tn==="number"&&(Lt%1!=0?ft.writeDoubleField(3,Lt):Lt<0?ft.writeSVarintField(6,Lt):ft.writeVarintField(5,Lt))}return ct.exports=me,ct.exports.fromVectorTileJs=me,ct.exports.fromGeojsonVt=function(Lt,ft){ft=ft||{};var tn={};for(var ln in Lt)tn[ln]=new ie(Lt[ln].features,ft),tn[ln].name=ln,tn[ln].version=ft.version,tn[ln].extent=ft.extent;return me({layers:tn})},ct.exports.GeoJSONWrapper=ie,ct.exports}(),Ye=i.fh(ze);const At={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:wt=>wt},Ct=Math.fround||(We=new Float32Array(1),wt=>(We[0]=+wt,We[0]));var We;const st=3,Bt=5,hn=6;class cn{constructor(ie){this.options=Object.assign(Object.create(At),ie),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ie){const{log:me,minZoom:Le,maxZoom:Be}=this.options;me&&console.time("total time");const Ve=`prepare ${ie.length} points`;me&&console.time(Ve),this.points=ie;const qe=[];for(let Ke=0;Ke<ie.length;Ke++){const pt=ie[Ke];if(!pt.geometry)continue;const[Lt,ft]=pt.geometry.coordinates,tn=Ct(Vn(Lt)),ln=Ct(An(ft));qe.push(tn,ln,1/0,Ke,-1,1),this.options.reduce&&qe.push(0)}let Xe=this.trees[Be+1]=this._createTree(qe);me&&console.timeEnd(Ve);for(let Ke=Be;Ke>=Le;Ke--){const pt=+Date.now();Xe=this.trees[Ke]=this._createTree(this._cluster(Xe,Ke)),me&&console.log("z%d: %d clusters in %dms",Ke,Xe.numItems,+Date.now()-pt)}return me&&console.timeEnd("total time"),this}getClusters(ie,me){let Le=((ie[0]+180)%360+360)%360-180;const Be=Math.max(-90,Math.min(90,ie[1]));let Ve=ie[2]===180?180:((ie[2]+180)%360+360)%360-180;const qe=Math.max(-90,Math.min(90,ie[3]));if(ie[2]-ie[0]>=360)Le=-180,Ve=180;else if(Le>Ve){const ft=this.getClusters([Le,Be,180,qe],me),tn=this.getClusters([-180,Be,Ve,qe],me);return ft.concat(tn)}const Xe=this.trees[this._limitZoom(me)],Ke=Xe.range(Vn(Le),An(qe),Vn(Ve),An(Be)),pt=Xe.data,Lt=[];for(const ft of Ke){const tn=this.stride*ft;Lt.push(pt[tn+Bt]>1?cr(pt,tn,this.clusterProps):this.points[pt[tn+st]])}return Lt}getChildren(ie){const me=this._getOriginId(ie),Le=this._getOriginZoom(ie),Be="No cluster with the specified id.",Ve=this.trees[Le];if(!Ve)throw new Error(Be);const qe=Ve.data;if(me*this.stride>=qe.length)throw new Error(Be);const Xe=this.options.radius/(this.options.extent*Math.pow(2,Le-1)),Ke=Ve.within(qe[me*this.stride],qe[me*this.stride+1],Xe),pt=[];for(const Lt of Ke){const ft=Lt*this.stride;qe[ft+4]===ie&&pt.push(qe[ft+Bt]>1?cr(qe,ft,this.clusterProps):this.points[qe[ft+st]])}if(pt.length===0)throw new Error(Be);return pt}getLeaves(ie,me,Le){const Be=[];return this._appendLeaves(Be,ie,me=me||10,Le=Le||0,0),Be}getTile(ie,me,Le){const Be=this.trees[this._limitZoom(ie)],Ve=Math.pow(2,ie),{extent:qe,radius:Xe}=this.options,Ke=Xe/qe,pt=(Le-Ke)/Ve,Lt=(Le+1+Ke)/Ve,ft={features:[]};return this._addTileFeatures(Be.range((me-Ke)/Ve,pt,(me+1+Ke)/Ve,Lt),Be.data,me,Le,Ve,ft),me===0&&this._addTileFeatures(Be.range(1-Ke/Ve,pt,1,Lt),Be.data,Ve,Le,Ve,ft),me===Ve-1&&this._addTileFeatures(Be.range(0,pt,Ke/Ve,Lt),Be.data,-1,Le,Ve,ft),ft.features.length?ft:null}getClusterExpansionZoom(ie){let me=this._getOriginZoom(ie)-1;for(;me<=this.options.maxZoom;){const Le=this.getChildren(ie);if(me++,Le.length!==1)break;ie=Le[0].properties.cluster_id}return me}_appendLeaves(ie,me,Le,Be,Ve){const qe=this.getChildren(me);for(const Xe of qe){const Ke=Xe.properties;if(Ke&&Ke.cluster?Ve+Ke.point_count<=Be?Ve+=Ke.point_count:Ve=this._appendLeaves(ie,Ke.cluster_id,Le,Be,Ve):Ve<Be?Ve++:ie.push(Xe),ie.length===Le)break}return Ve}_createTree(ie){const me=new i.bW(ie.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Le=0;Le<ie.length;Le+=this.stride)me.add(ie[Le],ie[Le+1]);return me.finish(),me.data=ie,me}_addTileFeatures(ie,me,Le,Be,Ve,qe){for(const Xe of ie){const Ke=Xe*this.stride,pt=me[Ke+Bt]>1;let Lt,ft,tn;if(pt)Lt=Nn(me,Ke,this.clusterProps),ft=me[Ke],tn=me[Ke+1];else{const Zn=this.points[me[Ke+st]];Lt=Zn.properties;const[Yn,rr]=Zn.geometry.coordinates;ft=Vn(Yn),tn=An(rr)}const ln={type:1,geometry:[[Math.round(this.options.extent*(ft*Ve-Le)),Math.round(this.options.extent*(tn*Ve-Be))]],tags:Lt};let xn;xn=pt||this.options.generateId?me[Ke+st]:this.points[me[Ke+st]].id,xn!==void 0&&(ln.id=xn),qe.features.push(ln)}}_limitZoom(ie){return Math.max(this.options.minZoom,Math.min(Math.floor(+ie),this.options.maxZoom+1))}_cluster(ie,me){const{radius:Le,extent:Be,reduce:Ve,minPoints:qe}=this.options,Xe=Le/(Be*Math.pow(2,me)),Ke=ie.data,pt=[],Lt=this.stride;for(let ft=0;ft<Ke.length;ft+=Lt){if(Ke[ft+2]<=me)continue;Ke[ft+2]=me;const tn=Ke[ft],ln=Ke[ft+1],xn=ie.within(Ke[ft],Ke[ft+1],Xe),Zn=Ke[ft+Bt];let Yn=Zn;for(const rr of xn){const pr=rr*Lt;Ke[pr+2]>me&&(Yn+=Ke[pr+Bt])}if(Yn>Zn&&Yn>=qe){let rr,pr=tn*Zn,Vi=ln*Zn,gr=-1;const gi=(ft/Lt<<5)+(me+1)+this.points.length;for(const Hr of xn){const vr=Hr*Lt;if(Ke[vr+2]<=me)continue;Ke[vr+2]=me;const xi=Ke[vr+Bt];pr+=Ke[vr]*xi,Vi+=Ke[vr+1]*xi,Ke[vr+4]=gi,Ve&&(rr||(rr=this._map(Ke,ft,!0),gr=this.clusterProps.length,this.clusterProps.push(rr)),Ve(rr,this._map(Ke,vr)))}Ke[ft+4]=gi,pt.push(pr/Yn,Vi/Yn,1/0,gi,-1,Yn),Ve&&pt.push(gr)}else{for(let rr=0;rr<Lt;rr++)pt.push(Ke[ft+rr]);if(Yn>1)for(const rr of xn){const pr=rr*Lt;if(!(Ke[pr+2]<=me)){Ke[pr+2]=me;for(let Vi=0;Vi<Lt;Vi++)pt.push(Ke[pr+Vi])}}}}return pt}_getOriginId(ie){return ie-this.points.length>>5}_getOriginZoom(ie){return(ie-this.points.length)%32}_map(ie,me,Le){if(ie[me+Bt]>1){const qe=this.clusterProps[ie[me+hn]];return Le?Object.assign({},qe):qe}const Be=this.points[ie[me+st]].properties,Ve=this.options.map(Be);return Le&&Ve===Be?Object.assign({},Ve):Ve}}function cr(wt,ie,me){return{type:"Feature",id:wt[ie+st],properties:Nn(wt,ie,me),geometry:{type:"Point",coordinates:[(Le=wt[ie],360*(Le-.5)),Zt(wt[ie+1])]}};var Le}function Nn(wt,ie,me){const Le=wt[ie+Bt],Be=Le>=1e4?`${Math.round(Le/1e3)}k`:Le>=1e3?Math.round(Le/100)/10+"k":Le,Ve=wt[ie+hn],qe=Ve===-1?{}:Object.assign({},me[Ve]);return Object.assign(qe,{cluster:!0,cluster_id:wt[ie+st],point_count:Le,point_count_abbreviated:Be})}function Vn(wt){return wt/360+.5}function An(wt){const ie=Math.sin(wt*Math.PI/180),me=.5-.25*Math.log((1+ie)/(1-ie))/Math.PI;return me<0?0:me>1?1:me}function Zt(wt){const ie=(180-360*wt)*Math.PI/180;return 360*Math.atan(Math.exp(ie))/Math.PI-90}function mn(wt,ie,me,Le){let Be=Le;const Ve=ie+(me-ie>>1);let qe,Xe=me-ie;const Ke=wt[ie],pt=wt[ie+1],Lt=wt[me],ft=wt[me+1];for(let tn=ie+3;tn<me;tn+=3){const ln=kr(wt[tn],wt[tn+1],Ke,pt,Lt,ft);if(ln>Be)qe=tn,Be=ln;else if(ln===Be){const xn=Math.abs(tn-Ve);xn<Xe&&(qe=tn,Xe=xn)}}Be>Le&&(qe-ie>3&&mn(wt,ie,qe,Le),wt[qe+2]=Be,me-qe>3&&mn(wt,qe,me,Le))}function kr(wt,ie,me,Le,Be,Ve){let qe=Be-me,Xe=Ve-Le;if(qe!==0||Xe!==0){const Ke=((wt-me)*qe+(ie-Le)*Xe)/(qe*qe+Xe*Xe);Ke>1?(me=Be,Le=Ve):Ke>0&&(me+=qe*Ke,Le+=Xe*Ke)}return qe=wt-me,Xe=ie-Le,qe*qe+Xe*Xe}function Gr(wt,ie,me,Le){const Be={id:wt??null,type:ie,geometry:me,tags:Le,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ie==="Point"||ie==="MultiPoint"||ie==="LineString")Yr(Be,me);else if(ie==="Polygon")Yr(Be,me[0]);else if(ie==="MultiLineString")for(const Ve of me)Yr(Be,Ve);else if(ie==="MultiPolygon")for(const Ve of me)Yr(Be,Ve[0]);return Be}function Yr(wt,ie){for(let me=0;me<ie.length;me+=3)wt.minX=Math.min(wt.minX,ie[me]),wt.minY=Math.min(wt.minY,ie[me+1]),wt.maxX=Math.max(wt.maxX,ie[me]),wt.maxY=Math.max(wt.maxY,ie[me+1])}function Xn(wt,ie,me,Le){if(!ie.geometry)return;const Be=ie.geometry.coordinates;if(Be&&Be.length===0)return;const Ve=ie.geometry.type,qe=Math.pow(me.tolerance/((1<<me.maxZoom)*me.extent),2);let Xe=[],Ke=ie.id;if(me.promoteId?Ke=ie.properties[me.promoteId]:me.generateId&&(Ke=Le||0),Ve==="Point")Lr(Be,Xe);else if(Ve==="MultiPoint")for(const pt of Be)Lr(pt,Xe);else if(Ve==="LineString")Or(Be,Xe,qe,!1);else if(Ve==="MultiLineString"){if(me.lineMetrics){for(const pt of Be)Xe=[],Or(pt,Xe,qe,!1),wt.push(Gr(Ke,"LineString",Xe,ie.properties));return}is(Be,Xe,qe,!1)}else if(Ve==="Polygon")is(Be,Xe,qe,!0);else{if(Ve!=="MultiPolygon"){if(Ve==="GeometryCollection"){for(const pt of ie.geometry.geometries)Xn(wt,{id:Ke,geometry:pt,properties:ie.properties},me,Le);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const pt of Be){const Lt=[];is(pt,Lt,qe,!0),Xe.push(Lt)}}wt.push(Gr(Ke,Ve,Xe,ie.properties))}function Lr(wt,ie){ie.push(Zi(wt[0]),Dr(wt[1]),0)}function Or(wt,ie,me,Le){let Be,Ve,qe=0;for(let Ke=0;Ke<wt.length;Ke++){const pt=Zi(wt[Ke][0]),Lt=Dr(wt[Ke][1]);ie.push(pt,Lt,0),Ke>0&&(qe+=Le?(Be*Lt-pt*Ve)/2:Math.sqrt(Math.pow(pt-Be,2)+Math.pow(Lt-Ve,2))),Be=pt,Ve=Lt}const Xe=ie.length-3;ie[2]=1,mn(ie,0,Xe,me),ie[Xe+2]=1,ie.size=Math.abs(qe),ie.start=0,ie.end=ie.size}function is(wt,ie,me,Le){for(let Be=0;Be<wt.length;Be++){const Ve=[];Or(wt[Be],Ve,me,Le),ie.push(Ve)}}function Zi(wt){return wt/360+.5}function Dr(wt){const ie=Math.sin(wt*Math.PI/180),me=.5-.25*Math.log((1+ie)/(1-ie))/Math.PI;return me<0?0:me>1?1:me}function Bi(wt,ie,me,Le,Be,Ve,qe,Xe){if(Le/=ie,Ve>=(me/=ie)&&qe<Le)return wt;if(qe<me||Ve>=Le)return null;const Ke=[];for(const pt of wt){const Lt=pt.geometry;let ft=pt.type;const tn=Be===0?pt.minX:pt.minY,ln=Be===0?pt.maxX:pt.maxY;if(tn>=me&&ln<Le){Ke.push(pt);continue}if(ln<me||tn>=Le)continue;let xn=[];if(ft==="Point"||ft==="MultiPoint")Fr(Lt,xn,me,Le,Be);else if(ft==="LineString")Xi(Lt,xn,me,Le,Be,!1,Xe.lineMetrics);else if(ft==="MultiLineString")ur(Lt,xn,me,Le,Be,!1);else if(ft==="Polygon")ur(Lt,xn,me,Le,Be,!0);else if(ft==="MultiPolygon")for(const Zn of Lt){const Yn=[];ur(Zn,Yn,me,Le,Be,!0),Yn.length&&xn.push(Yn)}if(xn.length){if(Xe.lineMetrics&&ft==="LineString"){for(const Zn of xn)Ke.push(Gr(pt.id,ft,Zn,pt.tags));continue}ft!=="LineString"&&ft!=="MultiLineString"||(xn.length===1?(ft="LineString",xn=xn[0]):ft="MultiLineString"),ft!=="Point"&&ft!=="MultiPoint"||(ft=xn.length===3?"Point":"MultiPoint"),Ke.push(Gr(pt.id,ft,xn,pt.tags))}}return Ke.length?Ke:null}function Fr(wt,ie,me,Le,Be){for(let Ve=0;Ve<wt.length;Ve+=3){const qe=wt[Ve+Be];qe>=me&&qe<=Le&&us(ie,wt[Ve],wt[Ve+1],wt[Ve+2])}}function Xi(wt,ie,me,Le,Be,Ve,qe){let Xe=ei(wt);const Ke=Be===0?ss:Sr;let pt,Lt,ft=wt.start;for(let Yn=0;Yn<wt.length-3;Yn+=3){const rr=wt[Yn],pr=wt[Yn+1],Vi=wt[Yn+2],gr=wt[Yn+3],gi=wt[Yn+4],Hr=Be===0?rr:pr,vr=Be===0?gr:gi;let xi=!1;qe&&(pt=Math.sqrt(Math.pow(rr-gr,2)+Math.pow(pr-gi,2))),Hr<me?vr>me&&(Lt=Ke(Xe,rr,pr,gr,gi,me),qe&&(Xe.start=ft+pt*Lt)):Hr>Le?vr<Le&&(Lt=Ke(Xe,rr,pr,gr,gi,Le),qe&&(Xe.start=ft+pt*Lt)):us(Xe,rr,pr,Vi),vr<me&&Hr>=me&&(Lt=Ke(Xe,rr,pr,gr,gi,me),xi=!0),vr>Le&&Hr<=Le&&(Lt=Ke(Xe,rr,pr,gr,gi,Le),xi=!0),!Ve&&xi&&(qe&&(Xe.end=ft+pt*Lt),ie.push(Xe),Xe=ei(wt)),qe&&(ft+=pt)}let tn=wt.length-3;const ln=wt[tn],xn=wt[tn+1],Zn=Be===0?ln:xn;Zn>=me&&Zn<=Le&&us(Xe,ln,xn,wt[tn+2]),tn=Xe.length-3,Ve&&tn>=3&&(Xe[tn]!==Xe[0]||Xe[tn+1]!==Xe[1])&&us(Xe,Xe[0],Xe[1],Xe[2]),Xe.length&&ie.push(Xe)}function ei(wt){const ie=[];return ie.size=wt.size,ie.start=wt.start,ie.end=wt.end,ie}function ur(wt,ie,me,Le,Be,Ve){for(const qe of wt)Xi(qe,ie,me,Le,Be,Ve,!1)}function us(wt,ie,me,Le){wt.push(ie,me,Le)}function ss(wt,ie,me,Le,Be,Ve){const qe=(Ve-ie)/(Le-ie);return us(wt,Ve,me+(Be-me)*qe,1),qe}function Sr(wt,ie,me,Le,Be,Ve){const qe=(Ve-me)/(Be-me);return us(wt,ie+(Le-ie)*qe,Ve,1),qe}function On(wt,ie){const me=[];for(let Le=0;Le<wt.length;Le++){const Be=wt[Le],Ve=Be.type;let qe;if(Ve==="Point"||Ve==="MultiPoint"||Ve==="LineString")qe=Zr(Be.geometry,ie);else if(Ve==="MultiLineString"||Ve==="Polygon"){qe=[];for(const Xe of Be.geometry)qe.push(Zr(Xe,ie))}else if(Ve==="MultiPolygon"){qe=[];for(const Xe of Be.geometry){const Ke=[];for(const pt of Xe)Ke.push(Zr(pt,ie));qe.push(Ke)}}me.push(Gr(Be.id,Ve,qe,Be.tags))}return me}function Zr(wt,ie){const me=[];me.size=wt.size,wt.start!==void 0&&(me.start=wt.start,me.end=wt.end);for(let Le=0;Le<wt.length;Le+=3)me.push(wt[Le]+ie,wt[Le+1],wt[Le+2]);return me}function Ki(wt,ie){if(wt.transformed)return wt;const me=1<<wt.z,Le=wt.x,Be=wt.y;for(const Ve of wt.features){const qe=Ve.geometry,Xe=Ve.type;if(Ve.geometry=[],Xe===1)for(let Ke=0;Ke<qe.length;Ke+=2)Ve.geometry.push(ho(qe[Ke],qe[Ke+1],ie,me,Le,Be));else for(let Ke=0;Ke<qe.length;Ke++){const pt=[];for(let Lt=0;Lt<qe[Ke].length;Lt+=2)pt.push(ho(qe[Ke][Lt],qe[Ke][Lt+1],ie,me,Le,Be));Ve.geometry.push(pt)}}return wt.transformed=!0,wt}function ho(wt,ie,me,Le,Be,Ve){return[Math.round(me*(wt*Le-Be)),Math.round(me*(ie*Le-Ve))]}function gl(wt,ie,me,Le,Be){const Ve=ie===Be.maxZoom?0:Be.tolerance/((1<<ie)*Be.extent),qe={features:[],numPoints:0,numSimplified:0,numFeatures:wt.length,source:null,x:me,y:Le,z:ie,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Xe of wt)Ei(qe,Xe,Ve,Be);return qe}function Ei(wt,ie,me,Le){const Be=ie.geometry,Ve=ie.type,qe=[];if(wt.minX=Math.min(wt.minX,ie.minX),wt.minY=Math.min(wt.minY,ie.minY),wt.maxX=Math.max(wt.maxX,ie.maxX),wt.maxY=Math.max(wt.maxY,ie.maxY),Ve==="Point"||Ve==="MultiPoint")for(let Xe=0;Xe<Be.length;Xe+=3)qe.push(Be[Xe],Be[Xe+1]),wt.numPoints++,wt.numSimplified++;else if(Ve==="LineString")Sa(qe,Be,wt,me,!1,!1);else if(Ve==="MultiLineString"||Ve==="Polygon")for(let Xe=0;Xe<Be.length;Xe++)Sa(qe,Be[Xe],wt,me,Ve==="Polygon",Xe===0);else if(Ve==="MultiPolygon")for(let Xe=0;Xe<Be.length;Xe++){const Ke=Be[Xe];for(let pt=0;pt<Ke.length;pt++)Sa(qe,Ke[pt],wt,me,!0,pt===0)}if(qe.length){let Xe=ie.tags||null;if(Ve==="LineString"&&Le.lineMetrics){Xe={};for(const pt in ie.tags)Xe[pt]=ie.tags[pt];Xe.mapbox_clip_start=Be.start/Be.size,Xe.mapbox_clip_end=Be.end/Be.size}const Ke={geometry:qe,type:Ve==="Polygon"||Ve==="MultiPolygon"?3:Ve==="LineString"||Ve==="MultiLineString"?2:1,tags:Xe};ie.id!==null&&(Ke.id=ie.id),wt.features.push(Ke)}}function Sa(wt,ie,me,Le,Be,Ve){const qe=Le*Le;if(Le>0&&ie.size<(Be?qe:Le))return void(me.numPoints+=ie.length/3);const Xe=[];for(let Ke=0;Ke<ie.length;Ke+=3)(Le===0||ie[Ke+2]>qe)&&(me.numSimplified++,Xe.push(ie[Ke],ie[Ke+1])),me.numPoints++;Be&&function(Ke,pt){let Lt=0;for(let ft=0,tn=Ke.length,ln=tn-2;ft<tn;ln=ft,ft+=2)Lt+=(Ke[ft]-Ke[ln])*(Ke[ft+1]+Ke[ln+1]);if(Lt>0===pt)for(let ft=0,tn=Ke.length;ft<tn/2;ft+=2){const ln=Ke[ft],xn=Ke[ft+1];Ke[ft]=Ke[tn-2-ft],Ke[ft+1]=Ke[tn-1-ft],Ke[tn-2-ft]=ln,Ke[tn-1-ft]=xn}}(Xe,Ve),wt.push(Xe)}const Nc={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class xo{constructor(ie,me){const Le=(me=this.options=function(Ve,qe){for(const Xe in qe)Ve[Xe]=qe[Xe];return Ve}(Object.create(Nc),me)).debug;if(Le&&console.time("preprocess data"),me.maxZoom<0||me.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(me.promoteId&&me.generateId)throw new Error("promoteId and generateId cannot be used together.");let Be=function(Ve,qe){const Xe=[];if(Ve.type==="FeatureCollection")for(let Ke=0;Ke<Ve.features.length;Ke++)Xn(Xe,Ve.features[Ke],qe,Ke);else Xn(Xe,Ve.type==="Feature"?Ve:{geometry:Ve},qe);return Xe}(ie,me);this.tiles={},this.tileCoords=[],Le&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",me.indexMaxZoom,me.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Be=function(Ve,qe){const Xe=qe.buffer/qe.extent;let Ke=Ve;const pt=Bi(Ve,1,-1-Xe,Xe,0,-1,2,qe),Lt=Bi(Ve,1,1-Xe,2+Xe,0,-1,2,qe);return(pt||Lt)&&(Ke=Bi(Ve,1,-Xe,1+Xe,0,-1,2,qe)||[],pt&&(Ke=On(pt,1).concat(Ke)),Lt&&(Ke=Ke.concat(On(Lt,-1)))),Ke}(Be,me),Be.length&&this.splitTile(Be,0,0,0),Le&&(Be.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ie,me,Le,Be,Ve,qe,Xe){const Ke=[ie,me,Le,Be],pt=this.options,Lt=pt.debug;for(;Ke.length;){Be=Ke.pop(),Le=Ke.pop(),me=Ke.pop(),ie=Ke.pop();const ft=1<<me,tn=_l(me,Le,Be);let ln=this.tiles[tn];if(!ln&&(Lt>1&&console.time("creation"),ln=this.tiles[tn]=gl(ie,me,Le,Be,pt),this.tileCoords.push({z:me,x:Le,y:Be}),Lt)){Lt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",me,Le,Be,ln.numFeatures,ln.numPoints,ln.numSimplified),console.timeEnd("creation"));const xi=`z${me}`;this.stats[xi]=(this.stats[xi]||0)+1,this.total++}if(ln.source=ie,Ve==null){if(me===pt.indexMaxZoom||ln.numPoints<=pt.indexMaxPoints)continue}else{if(me===pt.maxZoom||me===Ve)continue;if(Ve!=null){const xi=Ve-me;if(Le!==qe>>xi||Be!==Xe>>xi)continue}}if(ln.source=null,ie.length===0)continue;Lt>1&&console.time("clipping");const xn=.5*pt.buffer/pt.extent,Zn=.5-xn,Yn=.5+xn,rr=1+xn;let pr=null,Vi=null,gr=null,gi=null,Hr=Bi(ie,ft,Le-xn,Le+Yn,0,ln.minX,ln.maxX,pt),vr=Bi(ie,ft,Le+Zn,Le+rr,0,ln.minX,ln.maxX,pt);ie=null,Hr&&(pr=Bi(Hr,ft,Be-xn,Be+Yn,1,ln.minY,ln.maxY,pt),Vi=Bi(Hr,ft,Be+Zn,Be+rr,1,ln.minY,ln.maxY,pt),Hr=null),vr&&(gr=Bi(vr,ft,Be-xn,Be+Yn,1,ln.minY,ln.maxY,pt),gi=Bi(vr,ft,Be+Zn,Be+rr,1,ln.minY,ln.maxY,pt),vr=null),Lt>1&&console.timeEnd("clipping"),Ke.push(pr||[],me+1,2*Le,2*Be),Ke.push(Vi||[],me+1,2*Le,2*Be+1),Ke.push(gr||[],me+1,2*Le+1,2*Be),Ke.push(gi||[],me+1,2*Le+1,2*Be+1)}}getTile(ie,me,Le){ie=+ie,me=+me,Le=+Le;const Be=this.options,{extent:Ve,debug:qe}=Be;if(ie<0||ie>24)return null;const Xe=1<<ie,Ke=_l(ie,me=me+Xe&Xe-1,Le);if(this.tiles[Ke])return Ki(this.tiles[Ke],Ve);qe>1&&console.log("drilling down to z%d-%d-%d",ie,me,Le);let pt,Lt=ie,ft=me,tn=Le;for(;!pt&&Lt>0;)Lt--,ft>>=1,tn>>=1,pt=this.tiles[_l(Lt,ft,tn)];return pt&&pt.source?(qe>1&&(console.log("found parent tile z%d-%d-%d",Lt,ft,tn),console.time("drilling down")),this.splitTile(pt.source,Lt,ft,tn,ie,me,Le),qe>1&&console.timeEnd("drilling down"),this.tiles[Ke]?Ki(this.tiles[Ke],Ve):null):null}}function _l(wt,ie,me){return 32*((1<<wt)*me+ie)+wt}function Ph(wt,ie){const me=wt.tileID.canonical;if(!this._geoJSONIndex)return void ie(null,null);const Le=this._geoJSONIndex.getTile(me.z,me.x,me.y);if(!Le)return void ie(null,null);const Be=new xe(Le.features);let Ve=Ye(Be);Ve.byteOffset===0&&Ve.byteLength===Ve.buffer.byteLength||(Ve=new Uint8Array(Ve)),ie(null,{vectorTile:Be,rawData:Ve.buffer})}class _d extends J{constructor(ie,me,Le,Be,Ve,qe,Xe){super(ie,me,Le,Be,Ve,Ph,Xe),qe&&(this.loadGeoJSON=qe),this._dynamicIndex=new Ce}loadData(ie,me){const Le=ie&&ie.request,Be=Le&&Le.collectResourceTiming;this.loadGeoJSON(ie,(Ve,qe)=>{if(Ve||!qe)return me(Ve);if(typeof qe!="object")return me(new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`));{try{if(ie.filter){const Ke=i.X(ie.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ke.result==="error")throw new Error(Ke.value.map(pt=>`${pt.key}: ${pt.message}`).join(", "));qe.features=qe.features.filter(pt=>Ke.value.evaluate({zoom:0},pt))}ie.dynamic?(qe.type==="Feature"&&(qe={type:"FeatureCollection",features:[qe]}),ie.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(qe.features,this.loaded),ie.cluster&&(qe.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=ie.cluster?new cn(function({superclusterOptions:Ke,clusterProperties:pt}){if(!pt||!Ke)return Ke;const Lt={},ft={},tn={accumulated:null,zoom:0},ln={properties:null},xn=Object.keys(pt);for(const Zn of xn){const[Yn,rr]=pt[Zn],pr=i.X(rr),Vi=i.X(typeof Yn=="string"?[Yn,["accumulated"],["get",Zn]]:Yn);Lt[Zn]=pr.value,ft[Zn]=Vi.value}return Ke.map=Zn=>{ln.properties=Zn;const Yn={};for(const rr of xn)Yn[rr]=Lt[rr].evaluate(tn,ln);return Yn},Ke.reduce=(Zn,Yn)=>{ln.properties=Yn;for(const rr of xn)tn.accumulated=Zn[rr],Zn[rr]=ft[rr].evaluate(tn,ln)},Ke}(ie)).load(qe.features):ie.dynamic?this._dynamicIndex:function(Ke,pt){return new xo(Ke,pt)}(qe,ie.geojsonVtOptions)}catch(Ke){return me(Ke)}const Xe={};if(Be){const Ke=I(Le);Ke&&(Xe.resourceTiming={},Xe.resourceTiming[ie.source]=JSON.parse(JSON.stringify(Ke)))}me(null,Xe)}})}reloadTile(ie,me){const Le=this.loaded;return Le&&Le[ie.uid]?ie.partial?me(null,void 0):super.reloadTile(ie,me):this.loadTile(ie,me)}loadGeoJSON(ie,me){if(ie.request)i.n(ie.request,me);else{if(typeof ie.data!="string")return me(new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`));try{return me(null,JSON.parse(ie.data))}catch{return me(new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ie,me){try{me(null,this._geoJSONIndex.getClusterExpansionZoom(ie.clusterId))}catch(Le){me(Le)}}getClusterChildren(ie,me){try{me(null,this._geoJSONIndex.getChildren(ie.clusterId))}catch(Le){me(Le)}}getClusterLeaves(ie,me){try{me(null,this._geoJSONIndex.getLeaves(ie.clusterId,ie.limit,ie.offset))}catch(Le){me(Le)}}}class Qt{constructor(ie,me){this.tileID=new i.aM(ie.tileID.overscaledZ,ie.tileID.wrap,ie.tileID.canonical.z,ie.tileID.canonical.x,ie.tileID.canonical.y),this.tileZoom=ie.tileZoom,this.uid=ie.uid,this.zoom=ie.zoom,this.canonical=ie.tileID.canonical,this.pixelRatio=ie.pixelRatio,this.tileSize=ie.tileSize,this.source=ie.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=ie.projection,this.brightness=me}parse(ie,me,Le,Be){this.status="parsing";const Ve=new i.aM(Le.tileID.overscaledZ,Le.tileID.wrap,Le.tileID.canonical.z,Le.tileID.canonical.x,Le.tileID.canonical.y),qe=[],Xe=me.familiesBySource[Le.source],Ke=new i.f0(Ve,Le.promoteId);Ke.bucketLayerIDs=[],Ke.is3DTile=!0,i.fi(ie).then(pt=>{if(!pt)return Be(new Error("Could not parse tile"));const Lt=i.fj(pt,1/i.cT(Le.tileID.canonical)),ft=pt.json.extensionsUsed&&pt.json.extensionsUsed.includes("MAPBOX_mesh_features")||pt.json.asset.extras&&pt.json.asset.extras.MAPBOX_mesh_features,tn=pt.json.extensionsUsed&&pt.json.extensionsUsed.includes("EXT_meshopt_compression"),ln=new i.aa(this.zoom,{brightness:this.brightness});for(const xn in Xe)for(const Zn of Xe[xn]){const Yn=Zn[0];Ke.bucketLayerIDs.push(Zn.map(pr=>i.C(pr.id,pr.scope))),Yn.recalculate(ln,[]);const rr=new i.fk(Zn,Lt,Ve,ft,tn,this.brightness,Ke);ft||(rr.needsUpload=!0),qe.push(rr),rr.evaluate(Yn)}this.status="done",Be(null,{buckets:qe,featureIndex:Ke,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(pt=>Be(new Error(pt.message)))}}class yl{constructor(ie,me,Le,Be,Ve,qe,Xe){this.actor=ie,this.layerIndex=me,this.availableImages=Le,this.availableModels=Be,this.brightness=Xe,this.loading={},this.loaded={}}loadTile(ie,me){const Le=ie.uid,Be=this.loading[Le]=new Qt(ie,this.brightness);i.br(ie.request,(Ve,qe)=>{const Xe=!this.loading[Le];return delete this.loading[Le],Xe||Ve?(Be.status="done",Xe||(this.loaded[Le]=Be),me(Ve)):qe&&qe.byteLength!==0?void Be.parse(qe,this.layerIndex,ie,(Ke,pt)=>{Be.status="done",this.loaded=this.loaded||{},this.loaded[Le]=Be,Ke||!pt?me(Ke):me(null,pt)}):(Be.status="done",this.loaded[Le]=Be,me())})}reloadTile(ie,me){const Le=this.loaded,Be=ie.uid;if(Le&&Le[Be]){const Ve=Le[Be];Ve.projection=ie.projection,Ve.brightness=ie.brightness;const qe=(Xe,Ke)=>{Ve.reloadCallback&&(delete Ve.reloadCallback,this.loadTile(ie,me)),me(Xe,Ke)};Ve.status==="parsing"?Ve.reloadCallback=qe:Ve.status==="done"&&this.loadTile(ie,me)}}abortTile(ie,me){const Le=ie.uid;this.loading[Le]&&delete this.loading[Le],me()}removeTile(ie,me){const Le=this.loaded,Be=ie.uid;Le&&Le[Be]&&delete Le[Be],me()}}class Ah{constructor(ie){this.self=ie,this.actor=new i.fm(ie,this),this.layerIndexes={},this.availableImages={},this.availableModels={},this.isSpriteLoaded={},this.imageRasterizer=new i.y,this.projections={},this.defaultProjection=i.ce({name:"mercator"}),this.workerSourceTypes={vector:J,geojson:_d,"raster-dem":le,"raster-array":ue,"batched-model":yl},this.workerSources={},this.self.registerWorkerSource=(me,Le)=>{if(this.workerSourceTypes[me])throw new Error(`Worker source with name "${me}" already registered.`);this.workerSourceTypes[me]=Le},this.self.registerRTLTextPlugin=me=>{if(i.fn.isParsed())throw new Error("RTL text plugin already registered.");i.fn.applyArabicShaping=me.applyArabicShaping,i.fn.processBidirectionalText=me.processBidirectionalText,i.fn.processStyledBidirectionalText=me.processStyledBidirectionalText}}clearCaches(ie,me,Le){delete this.layerIndexes[ie],delete this.availableImages[ie],delete this.availableModels[ie],delete this.workerSources[ie],Le()}checkIfReady(ie,me,Le){Le()}setReferrer(ie,me){this.referrer=me}spriteLoaded(ie,me){this.isSpriteLoaded[ie]||(this.isSpriteLoaded[ie]={});const{scope:Le,isLoaded:Be}=me;if(this.isSpriteLoaded[ie][Le]=Be,this.workerSources[ie]&&this.workerSources[ie][Le])for(const Ve in this.workerSources[ie][Le]){const qe=this.workerSources[ie][Le][Ve];for(const Xe in qe){const Ke=qe[Xe];Ke instanceof J&&(Ke.isSpriteLoaded=Be,Ke.fire(new i.A("isSpriteLoaded")))}}}setImages(ie,me,Le){this.availableImages[ie]||(this.availableImages[ie]={});const{scope:Be,images:Ve}=me;if(this.availableImages[ie][Be]=Ve,this.workerSources[ie]&&this.workerSources[ie][Be]){for(const qe in this.workerSources[ie][Be]){const Xe=this.workerSources[ie][Be][qe];for(const Ke in Xe)Xe[Ke].availableImages=Ve}Le()}else Le()}setModels(ie,{scope:me,models:Le},Be){if(this.availableModels[ie]||(this.availableModels[ie]={}),this.availableModels[ie][me]=Le,this.workerSources[ie]&&this.workerSources[ie][me]){for(const Ve in this.workerSources[ie][me]){const qe=this.workerSources[ie][me][Ve];for(const Xe in qe)qe[Xe].availableModels=Le}Be()}else Be()}setProjection(ie,me){this.projections[ie]=i.ce(me)}setBrightness(ie,me,Le){this.brightness=me,Le()}setLayers(ie,me,Le){this.getLayerIndex(ie,me.scope).replace(me.layers,me.options),Le()}updateLayers(ie,me,Le){this.getLayerIndex(ie,me.scope).update(me.layers,me.removedIds,me.options),Le()}loadTile(ie,me,Le){me.projection=this.projections[ie]||this.defaultProjection,this.getWorkerSource(ie,me.type,me.source,me.scope).loadTile(me,Le)}decodeRasterArray(ie,me,Le){this.getWorkerSource(ie,me.type,me.source,me.scope).decodeRasterArray(me,Le)}reloadTile(ie,me,Le){me.projection=this.projections[ie]||this.defaultProjection,this.getWorkerSource(ie,me.type,me.source,me.scope).reloadTile(me,Le)}abortTile(ie,me,Le){this.getWorkerSource(ie,me.type,me.source,me.scope).abortTile(me,Le)}removeTile(ie,me,Le){this.getWorkerSource(ie,me.type,me.source,me.scope).removeTile(me,Le)}removeSource(ie,me,Le){if(!(this.workerSources[ie]&&this.workerSources[ie][me.scope]&&this.workerSources[ie][me.scope][me.type]&&this.workerSources[ie][me.scope][me.type][me.source]))return;const Be=this.workerSources[ie][me.scope][me.type][me.source];delete this.workerSources[ie][me.scope][me.type][me.source],Be.removeSource!==void 0?Be.removeSource(me,Le):Le()}loadWorkerSource(ie,me,Le){try{this.self.importScripts(me.url),Le()}catch(Be){Le(Be.toString())}}syncRTLPluginState(ie,me,Le){try{i.fn.setState(me);const Be=i.fn.getPluginURL();if(i.fn.isLoaded()&&!i.fn.isParsed()&&Be!=null){this.self.importScripts(Be);const Ve=i.fn.isParsed();Le(Ve?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Be}`),Ve)}}catch(Be){Le(Be.toString())}}setDracoUrl(ie,me){this.dracoUrl=me}getAvailableImages(ie,me){this.availableImages[ie]||(this.availableImages[ie]={});let Le=this.availableImages[ie][me];return Le||(Le=[]),Le}getAvailableModels(ie,me){this.availableModels[ie]||(this.availableModels[ie]={});let Le=this.availableModels[ie][me];return Le||(Le={}),Le}getLayerIndex(ie,me){this.layerIndexes[ie]||(this.layerIndexes[ie]={});let Le=this.layerIndexes[ie][me];return Le||(Le=this.layerIndexes[ie][me]=new N,Le.scope=me),Le}getWorkerSource(ie,me,Le,Be){const Ve=this.workerSources;return Ve[ie]||(Ve[ie]={}),Ve[ie][Be]||(Ve[ie][Be]={}),Ve[ie][Be][me]||(Ve[ie][Be][me]={}),this.isSpriteLoaded[ie]||(this.isSpriteLoaded[ie]={}),Ve[ie][Be][me][Le]||(Ve[ie][Be][me][Le]=new this.workerSourceTypes[me]({send:(qe,Xe,Ke,pt,Lt,ft)=>this.actor.send(qe,Xe,Ke,ie,Lt,ft),scheduler:this.actor.scheduler},this.getLayerIndex(ie,Be),this.getAvailableImages(ie,Be),this.getAvailableModels(ie,Be),this.isSpriteLoaded[ie][Be],void 0,this.brightness)),Ve[ie][Be][me][Le]}rasterizeImagesWorker(ie,me,Le){const Be=new Map;for(const[Ve,{image:qe,imageVariant:Xe}]of me.tasks.entries()){const Ke=this.imageRasterizer.rasterize(Xe,qe,me.scope,ie);Be.set(Ve,Ke)}Le(void 0,Be)}removeRasterizedImages(ie,me,Le){this.imageRasterizer.removeImagesFromCacheByIds(me.imageIds,me.scope,ie),Le()}enforceCacheSizeLimit(ie,me){i.fo(me)}getWorkerPerformanceMetrics(ie,me,Le){Le(void 0,void 0)}}return i.fl(self)&&(self.worker=new Ah(self)),Ah}),y(["./shared"],function(i){var I="3.12.0";const R={create:"create",load:"load",fullLoad:"fullLoad"},k={mark(f){performance.mark(f)},measure(f,r,l){performance.measure(f,r,l)}};function N(f){const r=f.name.split("?")[0];return i.a(r)&&r.includes("mapbox-gl.js")?"javascript":i.a(r)&&r.includes("mapbox-gl.css")?"css":i.b(r)?"fontRange":i.c(r)?"sprite":i.i(r)?"style":i.d(r)?"tilejson":"other"}var U,K={},X=function(){if(U)return K;function f(p){return!r(p)}function r(p){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var w,C,P=new Blob([""],{type:"text/javascript"}),L=URL.createObjectURL(P);try{C=new Worker(L),w=!0}catch{w=!1}return C&&C.terminate(),URL.revokeObjectURL(L),w}()?function(){var w=document.createElement("canvas");w.width=w.height=1;var C=w.getContext("2d");if(!C)return!1;var P=C.getImageData(0,0,1,1);return P&&P.width===w.width}()?(l[v=p&&p.failIfMajorPerformanceCaveat]===void 0&&(l[v]=function(w){var C,P=function(L){var z=document.createElement("canvas"),j=Object.create(f.webGLContextAttributes);return j.failIfMajorPerformanceCaveat=L,z.getContext("webgl2",j)}(w);if(!P)return!1;try{C=P.createShader(P.VERTEX_SHADER)}catch{return!1}return!(!C||P.isContextLost())&&(P.shaderSource(C,"void main() {}"),P.compileShader(C),P.getShaderParameter(C,P.COMPILE_STATUS)===!0)}(v)),l[v]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var v}U=1,K.supported=f,K.notSupportedReason=r;var l={};return f.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},K}();function Z(f,r,l){const p=document.createElement(f);return r!=null&&(p.className=r),l&&l.appendChild(p),p}function J(f,r,l){const p=document.createElementNS("http://www.w3.org/2000/svg",f);for(const v of Object.keys(r))p.setAttributeNS(null,v,String(r[v]));return l&&l.appendChild(p),p}const le=typeof document<"u"?document.documentElement&&document.documentElement.style:null,de=le&&le.userSelect!==void 0?"userSelect":"WebkitUserSelect";let ue;function pe(){le&&de&&(ue=le[de],le[de]="none")}function he(){le&&de&&(le[de]=ue)}function xe(f){f.preventDefault(),f.stopPropagation(),window.removeEventListener("click",xe,!0)}function fe(){window.addEventListener("click",xe,!0),window.setTimeout(()=>{window.removeEventListener("click",xe,!0)},0)}function _e(f,r){const l=f.getBoundingClientRect();return He(f,l,r)}function Ce(f,r){const l=f.getBoundingClientRect(),p=[];for(let v=0;v<r.length;v++)p.push(He(f,l,r[v]));return p}function je(f){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&f.button===2&&f.ctrlKey?0:f.button}function He(f,r,l){const p=f.offsetWidth===r.width?1:f.offsetWidth/r.width;return new i.P((l.clientX-r.left)*p,(l.clientY-r.top)*p)}const lt="01",_t="NO_ACCESS_TOKEN";class Ue{constructor(r,l,p){this._transformRequestFn=r,this._customAccessToken=l,this._silenceAuthErrors=!!p,this._createSkuToken()}_createSkuToken(){const r=function(){let l="";for(let p=0;p<10;p++)l+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",lt,l].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=r.token,this._skuTokenExpiresAt=r.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(r,l){return this._transformRequestFn&&this._transformRequestFn(r,l)||{url:r}}normalizeStyleURL(r,l){if(!i.f(r))return r;const p=at(r);return p.params.push(`sdk=js-${I}`),p.path=`/styles/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||l)}normalizeGlyphsURL(r,l){if(!i.f(r))return r;const p=at(r);return p.path=`/fonts/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||l)}normalizeModelURL(r,l){if(!i.f(r))return r;const p=at(r);return p.path=`/models/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||l)}normalizeSourceURL(r,l,p,v){if(!i.f(r))return r;const w=at(r);return w.path=`/v4/${w.authority}.json`,w.params.push("secure"),p&&w.params.push(`language=${p}`),v&&w.params.push(`worldview=${v}`),this._makeAPIURL(w,this._customAccessToken||l)}normalizeIconsetURL(r,l){const p=at(r);return i.f(r)?(p.path=`/styles/v1${p.path}/iconset.pbf`,this._makeAPIURL(p,this._customAccessToken||l)):yt(p)}normalizeSpriteURL(r,l,p,v){const w=at(r);return i.f(r)?(w.path=`/styles/v1${w.path}/sprite${l}${p}`,this._makeAPIURL(w,this._customAccessToken||v)):(w.path+=`${l}${p}`,yt(w))}normalizeTileURL(r,l,p){if(this._isSkuTokenExpired()&&this._createSkuToken(),r&&!i.f(r))return r;const v=at(r);v.path=v.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${l||p&&v.authority!=="raster"&&p===512?"@2x":""}${i.m.supported?".webp":"$1"}`),v.authority==="raster"?v.path=`/${i.e.RASTER_URL_PREFIX}${v.path}`:v.authority==="rasterarrays"?v.path=`/${i.e.RASTERARRAYS_URL_PREFIX}${v.path}`:v.authority==="3dtiles"?v.path=`/${i.e.TILES3D_URL_PREFIX}${v.path}`:(v.path=v.path.replace(/^.+\/v4\//,"/"),v.path=`/${i.e.TILE_URL_VERSION}${v.path}`);const w=this._customAccessToken||function(C){for(const P of C){const L=P.match(/^access_token=(.*)$/);if(L)return L[1]}return null}(v.params)||i.e.ACCESS_TOKEN;return i.e.REQUIRE_ACCESS_TOKEN&&w&&this._skuToken&&v.params.push(`sku=${this._skuToken}`),this._makeAPIURL(v,w)}canonicalizeTileURL(r,l){const p=at(r);if(!p.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!p.path.match(/\.[\w]+$/))return r;let v="mapbox://";p.path.match(/^\/raster\/v1\//)?v+=`raster/${p.path.replace(`/${i.e.RASTER_URL_PREFIX}/`,"")}`:p.path.match(/^\/rasterarrays\/v1\//)?v+=`rasterarrays/${p.path.replace(`/${i.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:v+=`tiles/${p.path.replace(`/${i.e.TILE_URL_VERSION}/`,"")}`;let w=p.params;return l&&(w=w.filter(C=>!C.match(/^access_token=/))),w.length&&(v+=`?${w.join("&")}`),v}canonicalizeTileset(r,l){const p=!!l&&i.f(l),v=[];for(const w of r.tiles||[])i.h(w)?v.push(this.canonicalizeTileURL(w,p)):v.push(w);return v}_makeAPIURL(r,l){const p="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",v=at(i.e.API_URL);if(r.protocol=v.protocol,r.authority=v.authority,r.protocol==="http"){const w=r.params.indexOf("secure");w>=0&&r.params.splice(w,1)}if(v.path!=="/"&&(r.path=`${v.path}${r.path}`),!i.e.REQUIRE_ACCESS_TOKEN)return yt(r);if(l=l||i.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!l)throw new Error(`An API access token is required to use Mapbox GL. ${p}`);if(l[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${p}`)}return r.params=r.params.filter(w=>w.indexOf("access_token")===-1),r.params.push(`access_token=${l||""}`),yt(r)}}const Ge=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function at(f){const r=f.match(Ge);if(!r)throw new Error("Unable to parse URL object");return{protocol:r[1],authority:r[2],path:r[3]||"/",params:r[4]?r[4].split("&"):[]}}function yt(f){const r=f.params.length?`?${f.params.join("&")}`:"";return`${f.protocol}://${f.authority}${f.path}${r}`}const tt="mapbox.eventData";function Rt(f){if(!f)return null;const r=f.split(".");if(!r||r.length!==3)return null;try{return JSON.parse(i.j(r[1]))}catch{return null}}class ct{constructor(r){this.type=r,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(r){const l=Rt(i.e.ACCESS_TOKEN);let p="";return p=l&&l.u?i.k(l.u):i.e.ACCESS_TOKEN||"",r?`${tt}.${r}:${p}`:`${tt}:${p}`}fetchEventData(){const r=i.s("localStorage"),l=this.getStorageKey(),p=this.getStorageKey("uuid");if(r)try{const v=localStorage.getItem(l);v&&(this.eventData=JSON.parse(v));const w=localStorage.getItem(p);w&&(this.anonId=w)}catch{i.w("Unable to read from LocalStorage")}}saveEventData(){const r=i.s("localStorage"),l=this.getStorageKey(),p=this.getStorageKey("uuid"),v=this.anonId;if(r&&v)try{localStorage.setItem(p,v),Object.keys(this.eventData).length>=1&&localStorage.setItem(l,JSON.stringify(this.eventData))}catch{i.w("Unable to write to LocalStorage")}}processRequests(r){}postEvent(r,l,p,v){if(!i.e.EVENTS_URL)return;const w=at(i.e.EVENTS_URL);w.params.push(`access_token=${v||i.e.ACCESS_TOKEN||""}`);const C={event:this.type,created:new Date(r).toISOString()},P=l?i.l(C,l):C,L={url:yt(w),headers:{"Content-Type":"text/plain"},body:JSON.stringify([P])};this.pendingRequest=i.p(L,z=>{this.pendingRequest=null,p(z),this.saveEventData(),this.processRequests(v)})}queueRequest(r,l){this.queue.push(r),this.processRequests(l)}}const ze=new class extends ct{constructor(f){super("appUserTurnstile"),this._customAccessToken=f}postTurnstileEvent(f,r){i.e.EVENTS_URL&&i.e.ACCESS_TOKEN&&Array.isArray(f)&&f.some(l=>i.f(l)||i.h(l))&&this.queueRequest(Date.now(),r)}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const r=Rt(i.e.ACCESS_TOKEN),l=r?r.u:i.e.ACCESS_TOKEN;let p=l!==this.eventData.tokenU;i.v(this.anonId)||(this.anonId=i.u(),p=!0);const v=this.queue.shift();if(this.eventData.lastSuccess){const w=new Date(this.eventData.lastSuccess),C=new Date(v),P=(v-this.eventData.lastSuccess)/864e5;p=p||P>=1||P<-1||w.getDate()!==C.getDate()}else p=!0;p?this.postEvent(v,{sdkIdentifier:"mapbox-gl-js",sdkVersion:I,skuId:lt,"enabled.telemetry":!1,userId:this.anonId},w=>{w||(this.eventData.lastSuccess=v,this.eventData.tokenU=l)},f):this.processRequests()}},Ye=ze.postTurnstileEvent.bind(ze),At=new class extends ct{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(f,r,l,p){this.skuToken=r,this.errorCb=p,i.e.EVENTS_URL&&(l||i.e.ACCESS_TOKEN?this.queueRequest({id:f,timestamp:Date.now()},l):this.errorCb(new Error(_t)))}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:l}=this.queue.shift();r&&this.success[r]||(this.anonId||this.fetchEventData(),i.v(this.anonId)||(this.anonId=i.u()),this.postEvent(l,{sdkIdentifier:"mapbox-gl-js",sdkVersion:I,skuId:lt,skuToken:this.skuToken,userId:this.anonId},p=>{p?this.errorCb(p):r&&(this.success[r]=!0)},f))}remove(){this.errorCb=null}},Ct=At.postMapLoadEvent.bind(At),We=new class extends ct{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(f){let r=this.mapInstanceIdMap.get(f);return r||(r=i.u(),this.mapInstanceIdMap.set(f,r)),r}getEventId(f){const r=this.eventIdPerMapInstanceMap.get(f)||0;return this.eventIdPerMapInstanceMap.set(f,r+1),r}postStyleLoadEvent(f,r){const{map:l,style:p,importedStyles:v}=r;if(!i.e.EVENTS_URL||!f&&!i.e.ACCESS_TOKEN)return;const w=this.getMapInstanceId(l),C={mapInstanceId:w,eventId:this.getEventId(w),style:p};v.length&&(C.importedStyles=v),this.queueRequest({timestamp:Date.now(),payload:C},f)}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:r,payload:l}=this.queue.shift();this.postEvent(r,l,()=>{},f)}},st=We.postStyleLoadEvent.bind(We),Bt=new class extends ct{constructor(){super("gljs.performance")}postPerformanceEvent(f,r){i.e.EVENTS_URL&&(f||i.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:r},f)}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:r,performanceData:l}=this.queue.shift(),p=function(v){const w=performance.getEntriesByType("resource"),C=performance.getEntriesByType("mark"),P=function(q){const re={};if(q){for(const te in q)if(te!=="other")for(const oe of q[te]){const ne=`${te}ResolveRangeMin`,ye=`${te}ResolveRangeMax`,Se=`${te}RequestCount`,Te=`${te}RequestCachedCount`;re[ne]=Math.min(re[ne]||1/0,oe.startTime),re[ye]=Math.max(re[ye]||-1/0,oe.responseEnd);const ke=De=>{re[De]===void 0&&(re[De]=0),++re[De]};oe.transferSize!==void 0&&oe.transferSize===0&&ke(Te),ke(Se)}}return re}(function(q,re){const te={};if(q)for(const oe of q){const ne=re(oe);te[ne]===void 0&&(te[ne]=[]),te[ne].push(oe)}return te}(w,N)),L=window.devicePixelRatio,z=navigator.connection||navigator.mozConnection||navigator.webkitConnection,j=z?z.effectiveType:void 0,H={counters:[],metadata:[],attributes:[]},$=(q,re,te)=>{te!=null&&q.push({name:re,value:te.toString()})};for(const q in P)$(H.counters,q,P[q]);if(v.interactionRange[0]!==1/0&&v.interactionRange[1]!==-1/0&&($(H.counters,"interactionRangeMin",v.interactionRange[0]),$(H.counters,"interactionRangeMax",v.interactionRange[1])),C)for(const q of Object.keys(R)){const re=R[q],te=C.find(oe=>oe.name===re);te&&$(H.counters,re,te.startTime)}return $(H.counters,"visibilityHidden",v.visibilityHidden),$(H.attributes,"style",function(q){if(q)for(const re of q){const te=re.name.split("?")[0];if(i.i(te)){const oe=te.split("/").slice(-2);if(oe.length===2)return`mapbox://styles/${oe[0]}/${oe[1]}`}}}(w)),$(H.attributes,"terrainEnabled",v.terrainEnabled?"true":"false"),$(H.attributes,"fogEnabled",v.fogEnabled?"true":"false"),$(H.attributes,"projection",v.projection),$(H.attributes,"zoom",v.zoom),$(H.metadata,"devicePixelRatio",L),$(H.metadata,"connectionEffectiveType",j),$(H.metadata,"navigatorUserAgent",navigator.userAgent),$(H.metadata,"screenWidth",window.screen.width),$(H.metadata,"screenHeight",window.screen.height),$(H.metadata,"windowWidth",window.innerWidth),$(H.metadata,"windowHeight",window.innerHeight),$(H.metadata,"mapWidth",v.width/L),$(H.metadata,"mapHeight",v.height/L),$(H.metadata,"webglRenderer",v.renderer),$(H.metadata,"webglVendor",v.vendor),$(H.metadata,"sdkVersion",I),$(H.metadata,"sdkIdentifier","mapbox-gl-js"),H}(l);for(const v of p.metadata);for(const v of p.counters);for(const v of p.attributes);this.postEvent(r,p,()=>{},f)}},hn=Bt.postPerformanceEvent.bind(Bt),cn=new class extends ct{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(f,r,l,p){if(!i.e.API_URL||!i.e.SESSION_PATH)return;const v=at(i.e.API_URL+i.e.SESSION_PATH);v.params.push(`sku=${r||""}`),v.params.push(`access_token=${p||i.e.ACCESS_TOKEN||""}`);const w={url:yt(v),headers:{"Content-Type":"text/plain"}};this.pendingRequest=i.g(w,C=>{this.pendingRequest=null,l(C),this.saveEventData(),this.processRequests(p)})}getSessionAPI(f,r,l,p){this.skuToken=r,this.errorCb=p,i.e.SESSION_PATH&&i.e.API_URL&&(l||i.e.ACCESS_TOKEN?this.queueRequest({id:f,timestamp:Date.now()},l):this.errorCb(new Error(_t)))}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:l}=this.queue.shift();r&&this.success[r]||this.getSession(l,this.skuToken,p=>{p?this.errorCb(p):r&&(this.success[r]=!0)},f)}remove(){this.errorCb=null}},cr=cn.getSessionAPI.bind(cn),Nn=new Set;function Vn(f,r){r?Nn.add(f):Nn.delete(f)}class An{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages={}}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(r,l){this._updatedSourceCaches[r]=l,this.setDirty()}discardSourceCacheUpdate(r){delete this._updatedSourceCaches[r]}updateLayer(r){const l=r.scope;this._updatedLayers[l]=this._updatedLayers[l]||new Set,this._updatedLayers[l].add(r.id),this.setDirty()}removeLayer(r){const l=r.scope;this._removedLayers[l]=this._removedLayers[l]||{},this._updatedLayers[l]=this._updatedLayers[l]||new Set,this._removedLayers[l][r.id]=r,this._updatedLayers[l].delete(r.id),this._updatedPaintProps.delete(r.fqid),this.setDirty()}getRemovedLayer(r){return this._removedLayers[r.scope]?this._removedLayers[r.scope][r.id]:null}discardLayerRemoval(r){this._removedLayers[r.scope]&&delete this._removedLayers[r.scope][r.id]}getLayerUpdatesByScope(){const r={};for(const l in this._updatedLayers)r[l]=r[l]||{},r[l].updatedIds=Array.from(this._updatedLayers[l].values());for(const l in this._removedLayers)r[l]=r[l]||{},r[l].removedIds=Object.keys(this._removedLayers[l]);return r}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(r){this._updatedPaintProps.add(r.fqid),this.setDirty()}getUpdatedImages(r){return this._updatedImages[r]?Array.from(this._updatedImages[r].values()):[]}updateImage(r,l){this._updatedImages[l]=this._updatedImages[l]||new Set,this._updatedImages[l].add(i.I.toString(r)),this.setDirty()}resetUpdatedImages(r){this._updatedImages[r]&&this._updatedImages[r].clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages={}}}function Zt(f){const{userImage:r}=f;return!!(r&&r.render&&r.render())&&(f.data.replace(new Uint8Array(r.data.buffer)),!0)}class mn extends i.E{constructor(r){super(),this.imageProviders=new Map,this.images=new Map,this.updatedImages=new Map,this.callbackDispatchedThisFrame=new Map,this.loaded=new Map,this.requestors=[],this.patterns=new Map,this.patternsInFlight=new Set,this.atlasImage=new Map,this.atlasTexture=new Map,this.dirty=!0,this.spriteFormat=r,r!=="raster"&&i.t()&&(this.imageRasterizerDispatcher=new i.D(i.x(),this,"Image Rasterizer Worker",1))}addScope(r){this.loaded.set(r,!1),this.imageProviders.set(r,new Map),this.images.set(r,new Map),this.updatedImages.set(r,new Set),this.callbackDispatchedThisFrame.set(r,new Set),this.patterns.set(r,new Map),this.atlasImage.set(r,new i.r({width:1,height:1}))}removeScope(r){this.loaded.delete(r),this.imageProviders.delete(r),this.images.delete(r),this.updatedImages.delete(r),this.callbackDispatchedThisFrame.delete(r),this.patterns.delete(r),this.atlasImage.delete(r);const l=this.atlasTexture.get(r);l&&(l.destroy(),this.atlasTexture.delete(r))}addImageProvider(r,l){this.imageProviders.has(l)||this.imageProviders.set(l,new Map),this.imageProviders.get(l).set(r.id,r)}removeImageProvider(r,l){this.imageProviders.has(l)&&this.imageProviders.get(l).delete(r)}getPendingImageProviders(){const r=[];for(const l of this.imageProviders.values())for(const p of l.values())p.hasPendingRequests()&&r.push(p);return r}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new i.y),this._imageRasterizer}isLoaded(){for(const r of this.loaded.keys())if(!this.loaded.get(r))return!1;return!0}setLoaded(r,l){if(this.loaded.get(l)!==r&&(this.loaded.set(l,r),r)){for(const{ids:p,callback:v}of this.requestors)this._notify(p,l,v);this.requestors=[]}}hasImage(r,l){return!!this.getImage(r,l)}getImage(r,l){return this.images.get(l).get(r.toString())}addImage(r,l,p){this._validate(r,p)&&this.images.get(l).set(r.toString(),p)}_validate(r,l){let p=!0;return this._validateStretch(l.stretchX,l.data&&l.data.width)||(this.fire(new i.z(new Error(`Image "${r.name}" has invalid "stretchX" value`))),p=!1),this._validateStretch(l.stretchY,l.data&&l.data.height)||(this.fire(new i.z(new Error(`Image "${r.name}" has invalid "stretchY" value`))),p=!1),this._validateContent(l.content,l)||(this.fire(new i.z(new Error(`Image "${r.name}" has invalid "content" value`))),p=!1),p}_validateStretch(r,l){if(!r)return!0;let p=0;for(const v of r){if(v[0]<p||v[1]<v[0]||l<v[1])return!1;p=v[1]}return!0}_validateContent(r,l){return r?r.length!==4||!l.usvg&&(r[0]<0||l.data.width<r[0]||r[1]<0||l.data.height<r[1]||r[2]<0||l.data.width<r[2]||r[3]<0||l.data.height<r[3])?!1:!(r[2]<r[0]||r[3]<r[1]):!0}updateImage(r,l,p){const v=this.images.get(l).get(r.toString());p.version=v.version+1,this.images.get(l).set(r.toString(),p),this.updatedImages.get(l).add(r),this.removeFromImageRasterizerCache(r,l)}clearUpdatedImages(r){this.updatedImages.get(r).clear()}removeFromImageRasterizerCache(r,l){this.spriteFormat!=="raster"&&(i.t()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[r],scope:l}):this.imageRasterizer.removeImagesFromCacheByIds([r],l))}removeImage(r,l){const p=this.images.get(l),v=p.get(r.toString());p.delete(r.toString()),this.patterns.get(l).delete(r.toString()),this.removeFromImageRasterizerCache(r,l),v.userImage&&v.userImage.onRemove&&v.userImage.onRemove()}listImages(r){return Array.from(this.images.get(r).keys()).map(l=>i.I.from(l))}getImages(r,l,p){const v=[],w=[],C=this.imageProviders.get(l);for(const j of r){if(!j.iconsetId){v.push(j);continue}const H=C.get(j.iconsetId);H&&(this.getImage(j,l)?w.push(j):H.addPendingRequest(j))}if(v.length===0)return void this._notify(w,l,p);let P=!0;const L=!!this.loaded.get(l),z=this.images.get(l);if(!L)for(const j of v)z.has(j.toString())||(P=!1);L||P?this._notify(v,l,p):this.requestors.push({ids:v,scope:l,callback:p})}rasterizeImages(r,l){const p=new Map,{tasks:v,scope:w}=r;for(const[C,P]of v.entries()){const L=this.getImage(P.id,w);L&&p.set(C,{image:L,imageVariant:P})}this._rasterizeImages(w,p,l)}_rasterizeImages(r,l,p){if(i.t())this.imageRasterizerDispatcher.getActor().send("rasterizeImagesWorker",{tasks:l,scope:r},p);else{const v=new Map;for(const[w,{image:C,imageVariant:P}]of l.entries())v.set(w,this.imageRasterizer.rasterize(P,C,r,0));p(void 0,v)}}getUpdatedImages(r){return this.updatedImages.get(r)||new Set}_notify(r,l,p){const v=this.images.get(l),w=new Map;for(const C of r){if(!v.get(C.toString())){if(C.iconsetId)continue;this.fire(new i.A("styleimagemissing",{id:C.name}))}const P=v.get(C.toString());if(!P){i.w(`Image "${C.name}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`);continue}const L={data:P.usvg?null:P.data.clone(),pixelRatio:P.pixelRatio,sdf:P.sdf,usvg:P.usvg,version:P.version,stretchX:P.stretchX,stretchY:P.stretchY,content:P.content,hasRenderCallback:!!(P.userImage&&P.userImage.render)};P.usvg&&Object.assign(L,{width:P.icon.usvg_tree.width,height:P.icon.usvg_tree.height}),w.set(i.I.toString(C),L)}p(null,w)}getPixelSize(r){const{width:l,height:p}=this.atlasImage.get(r);return{width:l,height:p}}getPattern(r,l,p){const v=r.toString(),w=this.patterns.get(l),C=w.get(v),P=this.getImage(r,l);if(!P)return null;if(C){if(C.position.version===P.version)return C.position;C.position.version=P.version}else{if(P.usvg&&!P.data){const L=this.getPatternInFlightId(v,l);if(this.patternsInFlight.has(L))return null;this.patternsInFlight.add(L);const z=new i.B(r).scaleSelf(i.q.devicePixelRatio),j=new Map([[z.toString(),{image:P,imageVariant:z}]]);return this._rasterizeImages(l,j,(H,$)=>this.storePatternImage(z,l,P,p,$)),null}this.storePattern(r,l,P)}return this._updatePatternAtlas(l,p),w.get(v).position}getPatternInFlightId(r,l){return i.C(r,l)}hasPatternsInFlight(){return this.patternsInFlight.size!==0}storePatternImage(r,l,p,v,w){const C=r.toString(),P=w?w.get(C):void 0;P&&(p.data=P,this.storePattern(r.id,l,p),this._updatePatternAtlas(l,v),this.patternsInFlight.delete(this.getPatternInFlightId(r.id.toString(),l)))}storePattern(r,l,p){const v={w:p.data.width+2*i.F,h:p.data.height+2*i.F,x:0,y:0},w=new i.G(v,p,i.F);this.patterns.get(l).set(r.toString(),{bin:v,position:w})}bind(r,l){const p=r.gl;let v=this.atlasTexture.get(l);v?this.dirty&&(v.update(this.atlasImage.get(l)),this.dirty=!1):(v=new i.T(r,this.atlasImage.get(l),p.RGBA8),this.atlasTexture.set(l,v)),v.bind(p.LINEAR,p.CLAMP_TO_EDGE)}_updatePatternAtlas(r,l){const p=this.patterns.get(r),v=Array.from(p.values()).map(({bin:z})=>z),{w,h:C}=i.H(v),P=this.atlasImage.get(r);P.resize({width:w||1,height:C||1});const L=this.images.get(r);for(const[z,{bin:j,position:H}]of p.entries()){let $=H.padding;const q=j.x+$,re=j.y+$,te=L.get(z).data,oe=te.width,ne=te.height;$=$>1?$-1:$,i.r.copy(te,P,{x:0,y:0},{x:q,y:re},{width:oe,height:ne},l),i.r.copy(te,P,{x:0,y:ne-$},{x:q,y:re-$},{width:oe,height:$},l),i.r.copy(te,P,{x:0,y:0},{x:q,y:re+ne},{width:oe,height:$},l),i.r.copy(te,P,{x:oe-$,y:0},{x:q-$,y:re},{width:$,height:ne},l),i.r.copy(te,P,{x:0,y:0},{x:q+oe,y:re},{width:$,height:ne},l),i.r.copy(te,P,{x:oe-$,y:ne-$},{x:q-$,y:re-$},{width:$,height:$},l),i.r.copy(te,P,{x:0,y:ne-$},{x:q+oe,y:re-$},{width:$,height:$},l),i.r.copy(te,P,{x:0,y:0},{x:q+oe,y:re+ne},{width:$,height:$},l),i.r.copy(te,P,{x:oe-$,y:0},{x:q-$,y:re+ne},{width:$,height:$},l)}this.dirty=!0}beginFrame(){for(const r of this.images.keys())this.callbackDispatchedThisFrame.set(r,new Set)}dispatchRenderCallbacks(r,l){const p=this.images.get(l);for(const v of r){if(this.callbackDispatchedThisFrame.get(l).has(v.toString()))continue;this.callbackDispatchedThisFrame.get(l).add(v.toString());const w=p.get(v.toString());Zt(w)&&this.updateImage(v,l,w)}}}function kr(f){const r=f.key,l=f.value,p=f.valueSpec||{},v=f.objectElementValidators||{},w=f.style,C=f.styleSpec;let P=[];const L=i.K(l);if(L!=="object")return[new i.V(r,l,`object expected, ${L} found`)];for(const z in l){const j=z.split(".")[0];let H;v[j]?H=v[j]:p[j]?H=Ei:v["*"]?H=v["*"]:p["*"]&&(H=Ei),H?P=P.concat(H({key:(r&&`${r}.`)+z,value:l[z],valueSpec:p[j]||p["*"],style:w,styleSpec:C,object:l,objectKey:z},l)):P.push(new i.J(r,l[z],`unknown property "${z}"`))}for(const z in p)v[z]||p[z].required&&p[z].default===void 0&&l[z]===void 0&&P.push(new i.V(r,l,`missing required property "${z}"`));return P}function Gr(f){const r=f.value,l=f.valueSpec,p=f.style,v=f.styleSpec,w=f.key,C=f.arrayElementValidator||Ei;if(i.K(r)!=="array")return[new i.V(w,r,`array expected, ${i.K(r)} found`)];if(l.length&&r.length!==l.length)return[new i.V(w,r,`array length ${l.length} expected, length ${r.length} found`)];if(l["min-length"]&&r.length<l["min-length"])return[new i.V(w,r,`array length at least ${l["min-length"]} expected, length ${r.length} found`)];let P={type:l.value,values:l.values,minimum:l.minimum,maximum:l.maximum,function:void 0};v.$version<7&&(P.function=l.function),i.K(l.value)==="object"&&(P=l.value);let L=[];for(let z=0;z<r.length;z++)L=L.concat(C({array:r,arrayIndex:z,value:r[z],valueSpec:P,style:p,styleSpec:v,key:`${w}[${z}]`},!0));return L}function Yr(f){const r=f.key,l=f.value,p=f.valueSpec;let v=i.K(l);if(v==="number"&&l!=l&&(v="NaN"),v!=="number")return[new i.V(r,l,`number expected, ${v} found`)];if("minimum"in p){let w=p.minimum;if(i.K(p.minimum)==="array"&&(w=p.minimum[f.arrayIndex]),l<w)return[new i.V(r,l,`${l} is less than the minimum value ${w}`)]}if("maximum"in p){let w=p.maximum;if(i.K(p.maximum)==="array"&&(w=p.maximum[f.arrayIndex]),l>w)return[new i.V(r,l,`${l} is greater than the maximum value ${w}`)]}return[]}function Xn(f){const r=f.valueSpec,l=i.M(f.value.type);let p,v,w,C={};const P=l!=="categorical"&&f.value.property===void 0,L=!P,z=i.K(f.value.stops)==="array"&&i.K(f.value.stops[0])==="array"&&i.K(f.value.stops[0][0])==="object",j=kr({key:f.key,value:f.value,valueSpec:f.styleSpec.function,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{stops:function(q){if(l==="identity")return[new i.V(q.key,q.value,'identity function may not have a "stops" property')];let re=[];const te=q.value;return re=re.concat(Gr({key:q.key,value:te,valueSpec:q.valueSpec,style:q.style,styleSpec:q.styleSpec,arrayElementValidator:H})),i.K(te)==="array"&&te.length===0&&re.push(new i.V(q.key,te,"array must have at least one stop")),re},default:function(q){return Ei({key:q.key,value:q.value,valueSpec:r,style:q.style,styleSpec:q.styleSpec})}}});return l==="identity"&&P&&j.push(new i.V(f.key,f.value,'missing required property "property"')),l==="identity"||f.value.stops||j.push(new i.V(f.key,f.value,'missing required property "stops"')),l==="exponential"&&f.valueSpec.expression&&!i.N(f.valueSpec)&&j.push(new i.V(f.key,f.value,"exponential functions not supported")),f.styleSpec.$version>=8&&(L&&!i.O(f.valueSpec)?j.push(new i.V(f.key,f.value,"property functions not supported")):P&&!i.Q(f.valueSpec)&&j.push(new i.V(f.key,f.value,"zoom functions not supported"))),l!=="categorical"&&!z||f.value.property!==void 0||j.push(new i.V(f.key,f.value,'"property" property is required')),j;function H(q){let re=[];const te=q.value,oe=q.key;if(i.K(te)!=="array")return[new i.V(oe,te,`array expected, ${i.K(te)} found`)];if(te.length!==2)return[new i.V(oe,te,`array length 2 expected, length ${te.length} found`)];if(z){if(i.K(te[0])!=="object")return[new i.V(oe,te,`object expected, ${i.K(te[0])} found`)];if(te[0].zoom===void 0)return[new i.V(oe,te,"object stop key must have zoom")];if(te[0].value===void 0)return[new i.V(oe,te,"object stop key must have value")];const ne=i.M(te[0].zoom);if(typeof ne!="number")return[new i.V(oe,te[0].zoom,"stop zoom values must be numbers")];if(w&&w>ne)return[new i.V(oe,te[0].zoom,"stop zoom values must appear in ascending order")];ne!==w&&(w=ne,v=void 0,C={}),re=re.concat(kr({key:`${oe}[0]`,value:te[0],valueSpec:{zoom:{}},style:q.style,styleSpec:q.styleSpec,objectElementValidators:{zoom:Yr,value:$}}))}else re=re.concat($({key:`${oe}[0]`,value:te[0],style:q.style,styleSpec:q.styleSpec},te));return i.S(i.U(te[1]))?re.concat([new i.V(`${oe}[1]`,te[1],"expressions are not allowed in function stops.")]):re.concat(Ei({key:`${oe}[1]`,value:te[1],valueSpec:r,style:q.style,styleSpec:q.styleSpec}))}function $(q,re){const te=i.K(q.value),oe=i.M(q.value),ne=q.value!==null?q.value:re;if(p){if(te!==p)return[new i.V(q.key,ne,`${te} stop domain type must match previous stop domain type ${p}`)]}else p=te;if(te!=="number"&&te!=="string"&&te!=="boolean"&&typeof oe!="number"&&typeof oe!="string"&&typeof oe!="boolean")return[new i.V(q.key,ne,"stop domain value must be a number, string, or boolean")];if(te!=="number"&&l!=="categorical"){let ye=`number expected, ${te} found`;return i.O(r)&&l===void 0&&(ye+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new i.V(q.key,ne,ye)]}return l!=="categorical"||te!=="number"||typeof oe=="number"&&isFinite(oe)&&Math.floor(oe)===oe?l!=="categorical"&&te==="number"&&typeof oe=="number"&&typeof v=="number"&&v!==void 0&&oe<v?[new i.V(q.key,ne,"stop domain values must appear in ascending order")]:(v=oe,l==="categorical"&&oe in C?[new i.V(q.key,ne,"stop domain values must be unique")]:(C[oe]=!0,[])):[new i.V(q.key,ne,`integer expected, found ${String(oe)}`)]}}function Lr(f){const r=(f.expressionContext==="property"?i.W:i.X)(i.U(f.value),f.valueSpec);if(r.result==="error")return r.value.map(p=>new i.V(`${f.key}${p.key}`,f.value,p.message));const l=r.value.expression||r.value._styleExpression.expression;if(f.expressionContext==="property"&&f.propertyKey==="text-font"&&!l.outputDefined())return[new i.V(f.key,f.value,`Invalid data expression for "${f.propertyKey}". Output values must be contained as literals within the expression.`)];if(f.expressionContext==="property"&&f.propertyType==="layout"&&!i.Y(l))return[new i.V(f.key,f.value,'"feature-state" data expressions are not supported with layout properties.')];if(f.expressionContext==="filter")return Or(l,f);if(f.expressionContext&&f.expressionContext.indexOf("cluster")===0){if(!i.Z(l,["zoom","feature-state"]))return[new i.V(f.key,f.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(f.expressionContext==="cluster-initial"&&!i._(l))return[new i.V(f.key,f.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Or(f,r){const l=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(r.valueSpec&&r.valueSpec.expression)for(const v of r.valueSpec.expression.parameters)l.delete(v);if(l.size===0)return[];const p=[];return f instanceof i.$&&l.has(f.name)?[new i.V(r.key,r.value,`["${f.name}"] expression is not supported in a filter for a ${r.object.type} layer with id: ${r.object.id}`)]:(f.eachChild(v=>{p.push(...Or(v,r))}),p)}function is(f){const r=f.key,l=f.value,p=f.valueSpec,v=[];return Array.isArray(p.values)?p.values.indexOf(i.M(l))===-1&&v.push(new i.V(r,l,`expected one of [${p.values.join(", ")}], ${JSON.stringify(l)} found`)):Object.keys(p.values).indexOf(i.M(l))===-1&&v.push(new i.V(r,l,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(l)} found`)),v}function Zi(f){return i.a1(i.U(f.value))?Lr(i.L({},f,{expressionContext:"filter",valueSpec:f.styleSpec[`filter_${f.layerType||"fill"}`]})):Dr(f)}function Dr(f){const r=f.value,l=f.key;if(i.K(r)!=="array")return[new i.V(l,r,`array expected, ${i.K(r)} found`)];const p=f.styleSpec;let v,w=[];if(r.length<1)return[new i.V(l,r,"filter array must have at least 1 element")];switch(w=w.concat(is({key:`${l}[0]`,value:r[0],valueSpec:p.filter_operator,style:f.style,styleSpec:f.styleSpec})),i.M(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&i.M(r[1])==="$type"&&w.push(new i.V(l,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&w.push(new i.V(l,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(v=i.K(r[1]),v!=="string"&&w.push(new i.V(`${l}[1]`,r[1],`string expected, ${v} found`)));for(let C=2;C<r.length;C++)v=i.K(r[C]),i.M(r[1])==="$type"?w=w.concat(is({key:`${l}[${C}]`,value:r[C],valueSpec:p.geometry_type,style:f.style,styleSpec:f.styleSpec})):v!=="string"&&v!=="number"&&v!=="boolean"&&w.push(new i.V(`${l}[${C}]`,r[C],`string, number, or boolean expected, ${v} found`));break;case"any":case"all":case"none":for(let C=1;C<r.length;C++)w=w.concat(Dr({key:`${l}[${C}]`,value:r[C],style:f.style,styleSpec:f.styleSpec}));break;case"has":case"!has":v=i.K(r[1]),r.length!==2?w.push(new i.V(l,r,`filter array for "${r[0]}" operator must have 2 elements`)):v!=="string"&&w.push(new i.V(`${l}[1]`,r[1],`string expected, ${v} found`))}return w}function Bi(f,r){const l=f.key,p=f.style,v=f.layer,w=f.styleSpec,C=f.value,P=f.objectKey,L=w[`${r}_${f.layerType}`];if(!L)return[];const z=P.match(/^(.*)-use-theme$/);if(r==="paint"&&z&&L[z[1]])return i.S(C)?[].concat(Ei({key:f.key,value:C,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:p,styleSpec:w,expressionContext:"property",propertyType:r,propertyKey:P})):Ei({key:l,value:C,valueSpec:{type:"string"},style:p,styleSpec:w});const j=P.match(/^(.*)-transition$/);if(r==="paint"&&j&&L[j[1]]&&L[j[1]].transition)return Ei({key:l,value:C,valueSpec:w.transition,style:p,styleSpec:w});const H=f.valueSpec||L[P];if(!H)return[new i.J(l,C,`unknown property "${P}"`)];let $;if(i.K(C)==="string"&&i.O(H)&&!H.tokens&&($=/^{([^}]+)}$/.exec(C))){const re=`\`{ "type": "identity", "property": ${$?JSON.stringify($[1]):'"_"'} }\``;return[new i.V(l,C,`"${P}" does not support interpolation syntax
Use an identity property function instead: ${re}.`)]}const q=[];if(f.layerType==="symbol")P!=="text-field"||!p||p.glyphs||p.imports||q.push(new i.V(l,C,'use of "text-field" requires a style "glyphs" property')),P==="text-font"&&i.a2(i.U(C))&&i.M(C.type)==="identity"&&q.push(new i.V(l,C,'"text-font" does not support identity functions'));else if(f.layerType==="model"&&r==="paint"&&v&&v.layout&&v.layout.hasOwnProperty("model-id")&&i.O(H)&&(i.a3(H)||i.Q(H))){const re=i.W(i.U(C),H),te=re.value.expression||re.value._styleExpression.expression;te&&!i.Z(te,["measure-light"])&&(P==="model-emissive-strength"&&i._(te)&&i.Y(te)||q.push(new i.V(l,C,`${P} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return q.concat(Ei({key:f.key,value:C,valueSpec:H,style:p,styleSpec:w,expressionContext:"property",propertyType:r,propertyKey:P}))}function Fr(f){return Bi(f,"paint")}function Xi(f){return Bi(f,"layout")}function ei(f){let r=[];const l=f.value,p=f.key,v=f.style,w=f.styleSpec;l.type||l.ref||r.push(new i.V(p,l,'either "type" or "ref" is required'));let C=i.M(l.type);const P=i.M(l.ref);if(l.id){const L=i.M(l.id);for(let z=0;z<f.arrayIndex;z++){const j=v.layers[z];i.M(j.id)===L&&r.push(new i.V(p,l.id,`duplicate layer id "${l.id}", previously used at line ${j.id.__line__}`))}}if("ref"in l){let L;["type","source","source-layer","filter","layout"].forEach(z=>{z in l&&r.push(new i.V(p,l[z],`"${z}" is prohibited for ref layers`))}),v.layers.forEach(z=>{i.M(z.id)===P&&(L=z)}),L?L.ref?r.push(new i.V(p,l.ref,"ref cannot reference another ref layer")):C=i.M(L.type):typeof P=="string"&&r.push(new i.V(p,l.ref,`ref layer "${P}" not found`))}else if(C!=="background"&&C!=="sky"&&C!=="slot")if(l.source){const L=v.sources&&v.sources[l.source],z=L&&i.M(L.type);L?z==="vector"&&C==="raster"?r.push(new i.V(p,l.source,`layer "${l.id}" requires a raster source`)):z==="raster"&&C!=="raster"?r.push(new i.V(p,l.source,`layer "${l.id}" requires a vector source`)):z!=="vector"||l["source-layer"]?z==="raster-dem"&&C!=="hillshade"?r.push(new i.V(p,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):z!=="raster-array"||["raster","raster-particle"].includes(C)?C==="line"&&l.paint&&(l.paint["line-gradient"]||l.paint["line-trim-offset"])&&z==="geojson"&&!L.lineMetrics?r.push(new i.V(p,l,`layer "${l.id}" specifies a line-gradient, which requires the GeoJSON source to have \`lineMetrics\` enabled.`)):C==="raster-particle"&&z!=="raster-array"&&r.push(new i.V(p,l.source,`layer "${l.id}" requires a 'raster-array' source.`)):r.push(new i.V(p,l.source,"raster-array source can only be used with layer type 'raster'.")):r.push(new i.V(p,l,`layer "${l.id}" must specify a "source-layer"`)):r.push(new i.V(p,l.source,`source "${l.source}" not found`))}else r.push(new i.V(p,l,'missing required property "source"'));return r=r.concat(kr({key:p,value:l,valueSpec:w.layer,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Ei({key:`${p}.type`,value:l.type,valueSpec:w.layer.type,style:f.style,styleSpec:f.styleSpec,object:l,objectKey:"type"}),filter:L=>Zi(i.L({layerType:C},L)),layout:L=>kr({layer:l,key:L.key,value:L.value,valueSpec:{},style:L.style,styleSpec:L.styleSpec,objectElementValidators:{"*":z=>Xi(i.L({layerType:C},z))}}),paint:L=>kr({layer:l,key:L.key,value:L.value,valueSpec:{},style:L.style,styleSpec:L.styleSpec,objectElementValidators:{"*":z=>Fr(i.L({layerType:C,layer:l},z))}})}})),r}function ur(f){const r=f.value,l=f.key,p=i.K(r);return p!=="string"?[new i.V(l,r,`string expected, ${p} found`)]:[]}const us={promoteId:function f({key:r,value:l}){if(i.K(l)==="string")return ur({key:r,value:l});if(Array.isArray(l)){const p=[],v=i.U(l),w=i.X(v);return w.result==="error"&&w.value.forEach(C=>{p.push(new i.V(`${r}${C.key}`,null,`${C.message}`))}),i.Z(w.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||p.push(new i.V(`${r}`,null,"promoteId expression should be only feature dependent")),p}{const p=[];for(const v in l)p.push(...f({key:`${r}.${v}`,value:l[v]}));return p}}};function ss(f){const r=f.value,l=f.key,p=f.styleSpec,v=f.style;if(!r.type)return[new i.V(l,r,'"type" is required')];const w=i.M(r.type);let C=[];switch(["vector","raster","raster-dem","raster-array"].includes(w)&&(r.url||r.tiles||C.push(new i.J(l,r,'Either "url" or "tiles" is required.'))),w){case"vector":case"raster":case"raster-dem":case"raster-array":return C=C.concat(kr({key:l,value:r,valueSpec:p[`source_${w.replace("-","_")}`],style:f.style,styleSpec:p,objectElementValidators:us})),C;case"geojson":if(C=kr({key:l,value:r,valueSpec:p.source_geojson,style:v,styleSpec:p,objectElementValidators:us}),r.cluster)for(const P in r.clusterProperties){const[L,z]=r.clusterProperties[P],j=typeof L=="string"?[L,["accumulated"],["get",P]]:L;C.push(...Lr({key:`${l}.${P}.map`,value:z,expressionContext:"cluster-map"})),C.push(...Lr({key:`${l}.${P}.reduce`,value:j,expressionContext:"cluster-reduce"}))}return C;case"video":return kr({key:l,value:r,valueSpec:p.source_video,style:v,styleSpec:p});case"image":return kr({key:l,value:r,valueSpec:p.source_image,style:v,styleSpec:p});case"canvas":return[new i.V(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return is({key:`${l}.type`,value:r.type,valueSpec:{values:Sr(p)}})}}function Sr(f){return f.source.reduce((r,l)=>{const p=f[l];return p.type.type==="enum"&&(r=r.concat(Object.keys(p.type.values))),r},[])}function On(f){const r=f.value,l=f.styleSpec,p=l.light,v=f.style;let w=[];const C=i.K(r);if(r===void 0)return w;if(C!=="object")return w=w.concat([new i.V("light",r,`object expected, ${C} found`)]),w;for(const P in r){const L=P.match(/^(.*)-transition$/),z=P.match(/^(.*)-use-theme$/);w=w.concat(z&&p[z[1]]?Ei({key:P,value:r[P],valueSpec:{type:"string"},style:v,styleSpec:l}):L&&p[L[1]]&&p[L[1]].transition?Ei({key:P,value:r[P],valueSpec:l.transition,style:v,styleSpec:l}):p[P]?Ei({key:P,value:r[P],valueSpec:p[P],style:v,styleSpec:l}):[new i.V(P,r[P],`unknown property "${P}"`)])}return w}function Zr(f){const r=f.value;let l=[];if(!r)return l;const p=i.K(r);if(p!=="object")return l=l.concat([new i.V("light-3d",r,`object expected, ${p} found`)]),l;const v=f.styleSpec,w=v["light-3d"],C=f.key,P=f.style,L=f.style.lights;for(const H of["type","id"])if(!(H in r))return l=l.concat([new i.V("light-3d",r,`missing property ${H} on light`)]),l;if(r.type&&L)for(let H=0;H<f.arrayIndex;H++){const $=i.M(r.type),q=L[H];i.M(q.type)===$&&l.push(new i.V(C,r.id,`duplicate light type "${r.type}", previously defined at line ${q.id.__line__}`))}const z=`properties_light_${r.type}`;if(!(z in v))return l=l.concat([new i.V("light-3d",r,`Invalid light type ${r.type}`)]),l;const j=v[z];for(const H in r)if(H==="properties"){const $=r[H],q=i.K($);if(q!=="object")return l=l.concat([new i.V("properties",$,`object expected, ${q} found`)]),l;for(const re in $)l=l.concat(j[re]?Ei({key:re,value:$[re],valueSpec:j[re],style:P,styleSpec:v}):[new i.J(f.key,$[re],`unknown property "${re}"`)])}else{const $=H.match(/^(.*)-transition$/),q=H.match(/^(.*)-use-theme$/);l=l.concat(q&&w[q[1]]?Ei({key:H,value:r[H],valueSpec:{type:"string"},style:P,styleSpec:v}):$&&w[$[1]]&&w[$[1]].transition?Ei({key:H,value:r[H],valueSpec:v.transition,style:P,styleSpec:v}):w[H]?Ei({key:H,value:r[H],valueSpec:w[H],style:P,styleSpec:v}):[new i.J(H,r[H],`unknown property "${H}"`)])}return l}function Ki(f){const r=f.value,l=f.key,p=f.style,v=f.styleSpec,w=v.terrain;let C=[];const P=i.K(r);if(r===void 0||P==="null")return C;if(P!=="object")return C=C.concat([new i.V("terrain",r,`object expected, ${P} found`)]),C;for(const L in r){const z=L.match(/^(.*)-transition$/),j=L.match(/^(.*)-use-theme$/);C=C.concat(j&&w[j[1]]?Ei({key:L,value:r[L],valueSpec:{type:"string"},style:p,styleSpec:v}):z&&w[z[1]]&&w[z[1]].transition?Ei({key:L,value:r[L],valueSpec:v.transition,style:p,styleSpec:v}):w[L]?Ei({key:L,value:r[L],valueSpec:w[L],style:p,styleSpec:v}):[new i.J(L,r[L],`unknown property "${L}"`)])}if(r.source){const L=p.sources&&p.sources[r.source],z=L&&i.M(L.type);L?z!=="raster-dem"&&C.push(new i.V(l,r.source,`terrain cannot be used with a source of type ${String(z)}, it only be used with a "raster-dem" source type`)):C.push(new i.V(l,r.source,`source "${r.source}" not found`))}else C.push(new i.V(l,r,'terrain is missing required property "source"'));return C}function ho(f){const r=f.value,l=f.style,p=f.styleSpec,v=p.fog;let w=[];const C=i.K(r);if(r===void 0)return w;if(C!=="object")return w=w.concat([new i.V("fog",r,`object expected, ${C} found`)]),w;for(const P in r){const L=P.match(/^(.*)-transition$/),z=P.match(/^(.*)-use-theme$/);w=w.concat(z&&v[z[1]]?Ei({key:P,value:r[P],valueSpec:{type:"string"},style:l,styleSpec:p}):L&&v[L[1]]&&v[L[1]].transition?Ei({key:P,value:r[P],valueSpec:p.transition,style:l,styleSpec:p}):v[P]?Ei({key:P,value:r[P],valueSpec:v[P],style:l,styleSpec:p}):[new i.J(P,r[P],`unknown property "${P}"`)])}return w}const gl={"*":()=>[],array:Gr,boolean:function(f){const r=f.value,l=f.key,p=i.K(r);return p!=="boolean"?[new i.V(l,r,`boolean expected, ${p} found`)]:[]},number:Yr,color:function(f){const r=f.key,l=f.value,p=i.K(l);return p!=="string"?[new i.V(r,l,`color expected, ${p} found`)]:i.a0.parseCSSColor(l)===null?[new i.V(r,l,`color expected, "${l}" found`)]:[]},enum:is,filter:Zi,function:Xn,layer:ei,object:kr,source:ss,model:i.a4,light:On,"light-3d":Zr,terrain:Ki,fog:ho,string:ur,formatted:function(f){return ur(f).length===0?[]:Lr(f)},resolvedImage:function(f){return ur(f).length===0?[]:Lr(f)},projection:function(f){const r=f.value,l=f.styleSpec,p=l.projection,v=f.style;let w=[];const C=i.K(r);if(C==="object")for(const P in r)w=w.concat(Ei({key:P,value:r[P],valueSpec:p[P],style:v,styleSpec:l}));else C!=="string"&&(w=w.concat([new i.V("projection",r,`object or string expected, ${C} found`)]));return w},import:function(f){const{value:r,styleSpec:l}=f,{data:p,...v}=r;Object.defineProperty(v,"__line__",{value:r.__line__,enumerable:!1});let w=kr(i.L({},f,{value:v,valueSpec:l.import}));return i.M(v.id)===""&&w.push(new i.V(`${f.key}.id`,v,"import id can't be an empty string")),p&&(w=w.concat(Nc(p,l,{key:`${f.key}.data`}))),w},iconset:function(f){const r=f.value,l=f.key,p=f.styleSpec,v=f.style;if(!r.type)return[new i.V(l,r,'"type" is required')];const w=i.M(r.type);let C=[];if(C=C.concat(kr({key:l,value:r,valueSpec:p[`iconset_${w}`],style:v,styleSpec:p})),w==="source"&&r.source){const P=v.sources&&v.sources[r.source],L=P&&i.M(P.type);P?L!=="raster-array"&&C.push(new i.V(l,r.source,`iconset cannot be used with a source of type ${String(L)}, it only be used with a "raster-array" source type`)):C.push(new i.V(l,r.source,`source "${r.source}" not found`))}return C}};function Ei(f,r=!1){const l=f.value,p=f.valueSpec,v=f.styleSpec;if(p.expression&&i.a2(i.M(l)))return Xn(f);if(p.expression&&i.S(i.U(l)))return Lr(f);if(p.type&&gl[p.type]){const w=gl[p.type](f);return r===!0&&w.length>0&&i.K(f.value)==="array"?Lr(f):w}return kr(i.L({},f,{valueSpec:p.type?v[p.type]:p}))}function Sa(f){const r=f.value,l=f.key,p=ur(f);return p.length||(r.indexOf("{fontstack}")===-1&&p.push(new i.V(l,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&p.push(new i.V(l,r,'"glyphs" url must include a "{range}" token'))),p}function Nc(f,r=i.a5,l={}){return Ei({key:l.key||"",value:f,valueSpec:r.$root,styleSpec:r,style:f,objectElementValidators:{glyphs:Sa,"*":()=>[]}})}function xo(f,r=i.a5){return qe(Nc(f,r))}const _l=f=>qe(ss(f)),Ph=f=>qe(On(f)),_d=f=>qe(Zr(f)),Qt=f=>qe(Ki(f)),yl=f=>qe(ho(f)),Ah=f=>qe(function(r){const l=r.value,p=r.style,v=r.styleSpec,w=v.snow;let C=[];const P=i.K(l);if(l===void 0)return C;if(P!=="object")return C=C.concat([new i.V("snow",l,`object expected, ${P} found`)]),C;for(const L in l){const z=L.match(/^(.*)-transition$/);C=C.concat(z&&w[z[1]]&&w[z[1]].transition?Ei({key:L,value:l[L],valueSpec:v.transition,style:p,styleSpec:v}):w[L]?Ei({key:L,value:l[L],valueSpec:w[L],style:p,styleSpec:v}):[new i.J(L,l[L],`unknown property "${L}"`)])}return C}(f)),wt=f=>qe(function(r){const l=r.value,p=r.style,v=r.styleSpec,w=v.rain;let C=[];const P=i.K(l);if(l===void 0)return C;if(P!=="object")return C=C.concat([new i.V("rain",l,`object expected, ${P} found`)]),C;for(const L in l){const z=L.match(/^(.*)-transition$/);C=C.concat(z&&w[z[1]]&&w[z[1]].transition?Ei({key:L,value:l[L],valueSpec:v.transition,style:p,styleSpec:v}):w[L]?Ei({key:L,value:l[L],valueSpec:w[L],style:p,styleSpec:v}):[new i.J(L,l[L],`unknown property "${L}"`)])}return C}(f)),ie=f=>qe(ei(f)),me=f=>qe(Zi(f)),Le=f=>qe(Fr(f)),Be=f=>qe(Xi(f)),Ve=f=>qe(i.a4(f));function qe(f){return f.slice().sort((r,l)=>r.line&&l.line?r.line-l.line:0)}function Xe(f,r){let l=!1;if(r&&r.length)for(const p of r)p instanceof i.J?i.w(p.message):(f.fire(new i.z(new Error(p.message))),l=!0);return l}let Ke;class pt extends i.E{constructor(r,l="flat"){super(),this._transitionable=new i.a6(Ke||(Ke=new i.a7({anchor:new i.a8(i.a5.light.anchor),position:new i.a9(i.a5.light.position),color:new i.a8(i.a5.light.color),intensity:new i.a8(i.a5.light.intensity)}))),this.setLight(r,l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,l,p={}){this._validate(Ph,r,p)||(this._transitionable.setTransitionOrValue(r),this.id=l)}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,l,p){return(!p||p.validate!==!1)&&Xe(this,r.call(xo,i.l({value:l,style:{glyphs:!0,sprite:!0},styleSpec:i.a5})))}}let Lt=class extends i.E{constructor(f,r,l,p){super(),this.scope=l,this._transitionable=new i.a6(new i.a7({source:new i.a8(i.a5.terrain.source),exaggeration:new i.a8(i.a5.terrain.exaggeration)}),l,p),this._transitionable.setTransitionOrValue(f,p),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=r}get(){return this._transitionable.serialize()}set(f,r){this._transitionable.setTransitionOrValue(f,r)}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}getExaggeration(f){return this._transitioning.possiblyEvaluate(new i.aa(f)).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const f=this._transitionable._values.exaggeration;if(!f)return null;const r=f.value.expression;if(!r)return null;let l=-1,p=-1,v=1;for(const w of r.zoomStops)v=r.evaluate(new i.aa(w)),v>.01?(l=w,p=-1):p=w;return v<.01&&l>0&&p>l?[l,p]:null}isZoomDependent(){const f=this._transitionable._values.exaggeration;return f!=null&&f.value!=null&&f.value.expression!=null&&f.value.expression instanceof i.ab}};const ft=45,tn=65,ln=.05;function xn(f,r,l,p){const v=i.af(ft,tn,l),[w,C]=Zn(f,p);let P=1-Math.min(1,Math.exp((r-w)/(C-w)*-6));return P*=P*P,P=Math.min(1,1.00747*P),P*v*f.alpha}function Zn(f,r){const l=.5/Math.tan(.5*r);return[f.range[0]+l,f.range[1]+l]}function Yn(f,r,l,p,v){const w=i.ad([],[r,l,p],v.mercatorFogMatrix);return xn(f,i.ae(w),v.pitch,v._fov)}function rr(f,r,l,p,v,w,C){const P=[[l,p,0],[v,p,0],[v,w,0],[l,w,0]];let L=Number.MAX_VALUE,z=-Number.MAX_VALUE;for(const j of P){const H=i.ad([],j,r),$=i.ae(H);L=Math.min(L,$),z=Math.max(z,$)}return[xn(f,L,C.pitch,C._fov),xn(f,z,C.pitch,C._fov)]}class pr extends i.E{constructor(r,l,p,v){super();const w=new i.a7({range:new i.a8(i.a5.fog.range),color:new i.a8(i.a5.fog.color),"color-use-theme":new i.a8({type:"string","property-type":"data-constant",default:"default"}),"high-color":new i.a8(i.a5.fog["high-color"]),"high-color-use-theme":new i.a8({type:"string","property-type":"data-constant",default:"default"}),"space-color":new i.a8(i.a5.fog["space-color"]),"space-color-use-theme":new i.a8({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new i.a8(i.a5.fog["horizon-blend"]),"star-intensity":new i.a8(i.a5.fog["star-intensity"]),"vertical-range":new i.a8(i.a5.fog["vertical-range"])});this._transitionable=new i.a6(w,p,new Map(v)),this.set(r,v),this._transitioning=this._transitionable.untransitioned(),this._transform=l,this.properties=new i.ag(w),this.scope=p}get state(){const r=this._transform,l=r.projection.name==="globe",p=i.ah(r.zoom),v=this.properties.get("range"),w=[.5,3];return{range:l?[i.ai(w[0],v[0],p),i.ai(w[1],v[1],p)]:v,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(r,l,p={}){if(this._validate(yl,r,p))return;const v=i.l({},r);for(const w of Object.keys(i.a5.fog))v[w]===void 0&&(v[w]=i.a5.fog[w].default);this._options=v,this._transitionable.setTransitionOrValue(this._options,l)}getOpacity(r){if(!this._transform.projection.supportsFog)return 0;const l=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:i.af(ft,tn,r))*l.a}getOpacityAtLatLng(r,l){return this._transform.projection.supportsFog?function(p,v,w){const C=i.ac.fromLngLat(v),P=w.elevation?w.elevation.getAtPointOrZero(C):0;return Yn(p,C.x,C.y,P,w)}(this.state,r,l):0}getOpacityForTile(r){if(!this._transform.projection.supportsFog)return[1,1];const l=this._transform.calculateFogTileMatrix(r.toUnwrapped());return rr(this.state,l,0,0,i.aj,i.aj,this._transform)}getOpacityForBounds(r,l,p,v,w){return this._transform.projection.supportsFog?rr(this.state,r,l,p,v,w,this._transform):[1,1]}getFovAdjustedRange(r){return this._transform.projection.supportsFog?Zn(this.state,r):[0,1]}isVisibleOnFrustum(r){if(!this._transform.projection.supportsFog)return!1;const l=[4,5,6,7];for(const p of l){const v=r.points[p];let w;if(v[2]>=0)w=v;else{const C=r.points[p-4];w=i.ak(C,v,C[2]/(C[2]-v[2]))}if(Yn(this.state,w[0],w[1],0,this._transform)>=ln)return!0}return!1}updateConfig(r){this._transitionable.setTransitionOrValue(this._options,new Map(r))}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,l,p){return(!p||p.validate!==!1)&&Xe(this,r.call(xo,i.l({value:l,style:{glyphs:!0,sprite:!0},styleSpec:i.a5})))}}let Vi,gr,gi,Hr,vr=class extends i.E{constructor(f,r,l,p){super();const v=Vi||(Vi=new i.a7({density:new i.a8(i.a5.snow.density),intensity:new i.a8(i.a5.snow.intensity),color:new i.a8(i.a5.snow.color),opacity:new i.a8(i.a5.snow.opacity),vignette:new i.a8(i.a5.snow.vignette),"vignette-color":new i.a8(i.a5.snow["vignette-color"]),"center-thinning":new i.a8(i.a5.snow["center-thinning"]),direction:new i.a8(i.a5.snow.direction),"flake-size":new i.a8(i.a5.snow["flake-size"])}));this._transitionable=new i.a6(v,l,new Map(p)),this.set(f,p),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ag(v),this.scope=l}get state(){const f=this.properties.get("opacity"),r=this.properties.get("color"),l=this.properties.get("direction"),p=i.al(l[0]),v=-Math.max(i.al(l[1]),.01),w=[Math.cos(p)*Math.cos(v),Math.sin(p)*Math.cos(v),Math.sin(v)],C=this.properties.get("vignette"),P=this.properties.get("vignette-color");return P.a=C,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.am(r.r,r.g,r.b,r.a*f),direction:w,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:P}}get(){return this._transitionable.serialize()}set(f,r,l={}){if(this._validate(Ah,f,l))return;const p=i.l({},f);for(const v of Object.keys(i.a5.snow))p[v]===void 0&&(p[v]=i.a5.snow[v].default);this._options=p,this._transitionable.setTransitionOrValue(this._options,r)}updateConfig(f){this._transitionable.setTransitionOrValue(this._options,new Map(f))}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}_validate(f,r,l){return(!l||l.validate!==!1)&&Xe(this,f.call(xo,i.l({value:r,style:{glyphs:!0,sprite:!0},styleSpec:i.a5})))}},xi=class extends i.E{constructor(f,r,l,p){super();const v=gr||(gr=new i.a7({density:new i.a8(i.a5.rain.density),intensity:new i.a8(i.a5.rain.intensity),color:new i.a8(i.a5.rain.color),opacity:new i.a8(i.a5.rain.opacity),vignette:new i.a8(i.a5.rain.vignette),"vignette-color":new i.a8(i.a5.rain["vignette-color"]),"center-thinning":new i.a8(i.a5.rain["center-thinning"]),direction:new i.a8(i.a5.rain.direction),"droplet-size":new i.a8(i.a5.rain["droplet-size"]),"distortion-strength":new i.a8(i.a5.rain["distortion-strength"])}));this._transitionable=new i.a6(v,l,new Map(p)),this.set(f,p),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ag(v),this.scope=l}get state(){const f=this.properties.get("opacity"),r=this.properties.get("color"),l=this.properties.get("direction"),p=i.al(l[0]),v=-Math.max(i.al(l[1]),.01),w=[Math.cos(p)*Math.cos(v),Math.sin(p)*Math.cos(v),Math.sin(v)],C=this.properties.get("vignette-color");return C.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.am(r.r,r.g,r.b,r.a*f),direction:w,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:C}}get(){return this._transitionable.serialize()}set(f,r,l={}){if(this._validate(wt,f,l))return;const p=i.l({},f);for(const v of Object.keys(i.a5.rain))p[v]===void 0&&(p[v]=i.a5.rain[v].default);this._options=p,this._transitionable.setTransitionOrValue(this._options,r)}updateConfig(f){this._transitionable.setTransitionOrValue(this._options,new Map(f))}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}_validate(f,r,l){return(!l||l.validate!==!1)&&Xe(this,f.call(xo,i.l({value:r,style:{glyphs:!0,sprite:!0},styleSpec:i.a5})))}};class Qi extends i.E{constructor(r,l,p,v){super(),this.scope=p,this._options=r,this.properties=new i.ag(l),this._transitionable=new i.a6(l,p,new Map(v)),this._transitionable.setTransitionOrValue(r.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(r){this._transitionable.setTransitionOrValue(this._options.properties,new Map(r))}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(r,l){this._options=r,this._transitionable.setTransitionOrValue(r.properties,l)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class bs{constructor(r,l,p,v){this.screenBounds=r,this.cameraPoint=l,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=p,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,v)}static createFromScreenPoints(r,l){let p,v;if(r instanceof i.P||typeof r[0]=="number"){const w=i.P.convert(r);p=[w],v=l.isPointAboveHorizon(w)}else{const w=i.P.convert(r[0]),C=i.P.convert(r[1]),P=w.add(C)._div(2);p=[w,C],v=i.ao(w,C).every(L=>l.isPointAboveHorizon(L))&&l.isPointAboveHorizon(P)}return new bs(p,l.getCameraPoint(),v,l)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(r){return i.ao(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],r)}bufferedCameraGeometry(r){const l=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],v=i.ao(l,p,0,!1);return this.cameraPoint.y>p.y&&(this.cameraPoint.x>l.x&&this.cameraPoint.x<p.x?v.splice(3,0,this.cameraPoint):this.cameraPoint.x>=p.x?v[2]=this.cameraPoint:this.cameraPoint.x<=l.x&&(v[3]=this.cameraPoint)),i.ap(v,r)}bufferedCameraGeometryGlobe(r){const l=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],v=i.ao(l,p,r),w=this.cameraPoint.clone();switch(3*((w.y>l.y)+(w.y>p.y))+((w.x>l.x)+(w.x>p.x))){case 0:v[0]=w,v[4]=w.clone();break;case 1:v.splice(1,0,w);break;case 2:v[1]=w;break;case 3:v.splice(4,0,w);break;case 5:v.splice(2,0,w);break;case 6:v[3]=w;break;case 7:v.splice(3,0,w);break;case 8:v[2]=w}return v}containsTile(r,l,p,v=0){const w=r.queryPadding/l._pixelsPerMercatorPixel+1,C=p?this._bufferedCameraMercator(w,l):this._bufferedScreenMercator(w,l);let P=r.tileID.wrap+(C.unwrapped?v:0);const L=C.polygon.map(oe=>i.aq(r.tileTransform,oe,P));if(!i.ar(L,0,0,i.aj,i.aj))return;P=r.tileID.wrap+(this.screenGeometryMercator.unwrapped?v:0);const z=this.screenGeometryMercator.polygon.map(oe=>i.as(r.tileTransform,oe,P)),j=z.map(oe=>new i.P(oe[0],oe[1])),H=l.getFreeCameraOptions().position||new i.ac(0,0,0),$=i.as(r.tileTransform,H,P),q=z.map(oe=>{const ne=i.at(oe,oe,$);return i.au(ne,ne),new i.av($,ne)}),re=i.aw(r,1,l.zoom)*l._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:j,tilespaceRays:q,bufferedTilespaceGeometry:L,bufferedTilespaceBounds:(te=i.ax(L),te.min.x=i.aD(te.min.x,0,i.aj),te.min.y=i.aD(te.min.y,0,i.aj),te.max.x=i.aD(te.max.x,0,i.aj),te.max.y=i.aD(te.max.y,0,i.aj),te),tile:r,tileID:r.tileID,pixelToTileUnitsFactor:re};var te}_bufferedScreenMercator(r,l){const p=vl(r);if(this._screenRaycastCache[p])return this._screenRaycastCache[p];{let v;return v=l.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(r),l):{polygon:this.bufferedScreenGeometry(r).map(w=>l.pointCoordinate3D(w)),unwrapped:!0},this._screenRaycastCache[p]=v,v}}_bufferedCameraMercator(r,l){const p=vl(r);if(this._cameraRaycastCache[p])return this._cameraRaycastCache[p];{let v;return v=l.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(r),l):{polygon:this.bufferedCameraGeometry(r).map(w=>l.pointCoordinate3D(w)),unwrapped:!0},this._cameraRaycastCache[p]=v,v}}_projectAndResample(r,l){const p=function(w,C){const P=i.az([],C.pixelMatrix,C.globeMatrix),L=[0,-i.aE,0,1],z=[0,i.aE,0,1],j=[0,0,0,1];i.aA(L,L,P),i.aA(z,z,P),i.aA(j,j,P);const H=new i.P(L[0]/L[3],L[1]/L[3]),$=new i.P(z[0]/z[3],z[1]/z[3]),q=i.aB(w,H)&&L[3]<j[3],re=i.aB(w,$)&&z[3]<j[3];if(!q&&!re)return null;const te=function(Me,Pe,Oe){for(let Ne=1;Ne<Me.length;Ne++){const ht=eo(Pe.pointCoordinate3D(Me[Ne-1]).x),rt=eo(Pe.pointCoordinate3D(Me[Ne]).x);if(Oe<0){if(ht<rt)return{idx:Ne,t:-ht/(rt-1-ht)}}else if(rt<ht)return{idx:Ne,t:(1-ht)/(rt+1-ht)}}return null}(w,C,q?-1:1);if(!te)return null;const{idx:oe,t:ne}=te;let ye=oe>1?Es(w.slice(0,oe),C):[],Se=oe<w.length?Es(w.slice(oe),C):[];ye=ye.map(Me=>new i.P(eo(Me.x),Me.y)),Se=Se.map(Me=>new i.P(eo(Me.x),Me.y));const Te=[...ye];Te.length===0&&Te.push(Se[Se.length-1]);const ke=i.ai(Te[Te.length-1].y,(Se.length===0?ye[0]:Se[0]).y,ne);let De;return De=q?[new i.P(0,ke),new i.P(0,0),new i.P(1,0),new i.P(1,ke)]:[new i.P(1,ke),new i.P(1,1),new i.P(0,1),new i.P(0,ke)],Te.push(...De),Se.length===0?Te.push(ye[0]):Te.push(...Se),{polygon:Te.map(Me=>new i.ac(Me.x,Me.y)),unwrapped:!1}}(r,l);if(p)return p;const v=function(w,C){let P=!1,L=-1/0,z=0;for(let H=0;H<w.length-1;H++)w[H].x>L&&(L=w[H].x,z=H);for(let H=0;H<w.length-1;H++){const $=(z+H)%(w.length-1),q=w[$],re=w[$+1];Math.abs(q.x-re.x)>.5&&(q.x<re.x?(q.x+=1,$===0&&(w[w.length-1].x+=1)):(re.x+=1,$+1===w.length-1&&(w[0].x+=1)),P=!0)}const j=i.ay(C.center.lng);return P&&j<Math.abs(j-1)&&w.forEach(H=>{H.x-=1}),{polygon:w,unwrapped:P}}(Es(r,l).map(w=>new i.P(eo(w.x),w.y)),l);return{polygon:v.polygon.map(w=>new i.ac(w.x,w.y)),unwrapped:v.unwrapped}}}function Es(f,r){return i.aC(f,l=>{const p=r.pointCoordinate3D(l);l.x=p.x,l.y=p.y},1/256)}function eo(f){return f<0?1+f%1:f%1}function vl(f){return 100*f|0}function $s(f,r,l,p,v){const w=function(P,L){if(P)return v(P);if(L){if(f.url&&L.tiles&&f.tiles&&delete f.tiles,L.variants){if(!Array.isArray(L.variants))return v(new Error("variants must be an array"));for(const j of L.variants){if(j==null||typeof j!="object"||j.constructor!==Object)return v(new Error("variant must be an object"));if(!Array.isArray(j.capabilities))return v(new Error("capabilities must be an array"));if(j.capabilities.length===1&&j.capabilities[0]==="meshopt"){L=i.l(L,j);break}}}const z=i.aF(i.l({},L,f),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","extra_bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);z.tiles=r.canonicalizeTileset(z,f.url),v(null,z)}},C=function(P,L,z){if(!P)return null;if(!L&&!z)return P;z=z||P.worldview_default;const j=Object.values(P.language||{});if(j.length===0)return null;const H=Object.values(P.worldview||{});if(H.length===0)return null;const $=j.every(re=>re===L),q=H.every(re=>re===z);return $&&q?P:L in(P.language_options||{})||z in(P.worldview_options||{})?null:P.language_options&&P.worldview_options?P:null}(f.data,l,p);return C?i.q.frame(()=>w(null,C)):f.url?i.n(r.transformRequest(r.normalizeSourceURL(f.url,null,l,p),i.R.Source),w):i.q.frame(()=>{const{data:P,...L}=f;w(null,L)})}function ms(f,r){const l=Math.pow(2,r.z),p=Math.floor(i.ay(f.getWest())*l),v=Math.floor(i.aH(f.getNorth())*l),w=Math.ceil(i.ay(f.getEast())*l),C=Math.ceil(i.aH(f.getSouth())*l);return r.x>=p&&r.x<w&&r.y>=v&&r.y<C}class Hs{constructor(r,l,p){this.bounds=r?i.aG.convert(this.validateBounds(r)):null,this.minzoom=l||0,this.maxzoom=p||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}addExtraBounds(r){if(r){this.extraBounds||(this.extraBounds=[]);for(const l of r)this.extraBounds.push(i.aG.convert(this.validateBounds(l)))}}contains(r){if(r.z>this.maxzoom||r.z<this.minzoom||this.bounds&&!ms(this.bounds,r))return!1;if(!this.extraBounds)return!0;for(const l of this.extraBounds)if(ms(l,r))return!0;return!1}static fromTileJSON(r){if(!r.bounds&&!r.extra_bounds)return null;const l=new Hs(r.bounds,r.minzoom,r.maxzoom);return l.addExtraBounds(r.extra_bounds),l}}class os extends i.E{constructor(r,l,p,v){if(super(),this.id=r,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,i.l(this,i.aF(l,["url","scheme","tileSize","promoteId"])),this._options=i.l({type:"vector"},l),this._collectResourceTiming=!!l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(v),this._tileWorkers={},this._deduped=new i.aI}load(r){this._loaded=!1,this.fire(new i.A("dataloading",{dataType:"source"}));const l=Array.isArray(this.map._language)?this.map._language.join():this.map._language,p=this.map.getWorldview();this._tileJSONRequest=$s(this._options,this.map._requestManager,l,p,(v,w)=>{if(this._tileJSONRequest=null,this._loaded=!0,v)l&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${l}`),p&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${p}`),this.fire(new i.z(v));else if(w){if(i.l(this,w),this.hasWorldviews=!!w.worldview_options,w.worldview_default&&(this.worldviewDefault=w.worldview_default),w.vector_layers){this.vectorLayers=w.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const C of w.vector_layers)this.vectorLayerIds.push(C.id),w.worldview&&w.worldview[C.source]&&this.localizableLayerIds.add(C.id)}this.tileBounds=Hs.fromTileJSON(w),Ye(w.tiles,this.map._requestManager._customAccessToken),this.fire(new i.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.A("data",{dataType:"source",sourceDataType:"content"}))}r&&r(v)})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest();const r=i.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(r))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(r){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}loadTile(r,l){const p=r.tileID.canonical.url(this.tiles,this.scheme),v=this.map._requestManager.normalizeTileURL(p),w=this.map._requestManager.transformRequest(v,i.R.Tile),C=this.map.style?this.map.style.getLut(this.scope):null,P=C?{image:C.image.clone()}:null,L={request:w,data:void 0,uid:r.uid,tileID:r.tileID,tileZoom:r.tileZoom,zoom:r.tileID.overscaledZ,maxZoom:this.maxzoom,lut:P,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:r.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:r.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor()};if(this.hasWorldviews&&i.f(p)&&(L.worldview=this.map.getWorldview()||this.worldviewDefault,L.localizableLayerIds=this.localizableLayerIds),L.request.collectResourceTiming=this._collectResourceTiming,r.actor&&r.state!=="expired")r.state==="loading"?r.reloadCallback=l:r.request=r.actor.send("reloadTile",L,z.bind(this));else if(r.actor=this._tileWorkers[v]=this._tileWorkers[v]||this.dispatcher.getActor(),this.dispatcher.ready)r.request=r.actor.send("loadTile",L,z.bind(this),void 0,!0);else{const j=i.aJ.call({deduped:this._deduped},L,(H,$)=>{H||!$?z.call(this,H):(L.data={cacheControl:$.cacheControl,expires:$.expires,rawData:$.rawData.slice(0)},r.actor&&r.actor.send("loadTile",L,z.bind(this),void 0,!0))},!0);r.request={cancel:j}}function z(j,H){return delete r.request,r.aborted?l(null):j&&j.status!==404?l(j):(H&&H.resourceTiming&&(r.resourceTiming=H.resourceTiming),this.map._refreshExpiredTiles&&H&&r.setExpiryData(H),r.loadVectorData(H,this.map.painter),i.aK(this.dispatcher),l(null),void(r.reloadCallback&&(this.loadTile(r,r.reloadCallback),r.reloadCallback=null)))}}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(r,l){r.actor&&r.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope}),r.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class xl extends i.E{constructor(r,l,p,v){super(),this.id=r,this.dispatcher=p,this.setEventedParent(v),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=i.l({type:"raster"},l),i.l(this,i.aF(l,["url","scheme","tileSize"]))}load(r){this._loaded=!1,this.fire(new i.A("dataloading",{dataType:"source"})),this._tileJSONRequest=$s(this._options,this.map._requestManager,null,null,(l,p)=>{this._tileJSONRequest=null,this._loaded=!0,l?this.fire(new i.z(l)):p&&(i.l(this,p),p.raster_layers&&(this.rasterLayers=p.raster_layers,this.rasterLayerIds=this.rasterLayers.map(v=>v.id)),this.tileBounds=Hs.fromTileJSON(p),Ye(p.tiles),this.fire(new i.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.A("data",{dataType:"source",sourceDataType:"content"}))),r&&r(l)})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}reload(){this.cancelTileJSONRequest();const r=i.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(r))}setTiles(r){return this._options.tiles=r,this.reload(),this}setUrl(r){return this.url=r,this._options.url=r,this.reload(),this}onRemove(r){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,l){const p=i.q.devicePixelRatio>=2,v=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),p,this.tileSize);r.request=i.o(this.map._requestManager.transformRequest(v,i.R.Tile),(w,C,P,L)=>(delete r.request,r.aborted?(r.state="unloaded",l(null)):w?(r.state="errored",l(w)):C?(this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:P,expires:L}),r.setTexture(C,this.map.painter),r.state="loaded",i.aK(this.dispatcher),void l(null)):l(null)))}abortTile(r,l){r.request&&(r.request.cancel(),delete r.request),l&&l()}unloadTile(r,l){r.texture&&r.texture instanceof i.T?(r.destroy(!0),r.texture&&r.texture instanceof i.T&&this.map.painter.saveTileTexture(r.texture)):r.destroy(),l&&l()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Eu extends xl{constructor(r,l,p,v){super(r,l,p,v),this.type="raster-array",this.maxzoom=22,this.partial=!0,this._options=i.l({type:"raster-array"},l)}triggerRepaint(r){const l=this.map.painter._terrain,p=this.map.style.getSourceCache(this.id);l&&l.enabled&&p&&l._clearRenderCacheForTile(p.id,r.tileID),this.map.triggerRepaint()}loadTile(r,l){const p=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),v=this.map._requestManager.transformRequest(p,i.R.Tile),w={request:v,uid:r.uid,tileID:r.tileID,type:this.type,source:this.id,scope:this.scope,partial:this.partial};r.source=this.id,r.scope=this.scope,r.requestParams=v,r.actor||(r.actor=this.dispatcher.getActor());const C=(P,L,z,j)=>{if(delete r.request,r.aborted)return r.state="unloaded",l(null);if(P)return P.name==="AbortError"?void 0:(r.state="errored",l(P));if(this.map._refreshExpiredTiles&&L&&r.setExpiryData({cacheControl:z,expires:j}),this.partial)r.state="empty";else{if(!L)return l(null);r.state="loaded",r._isHeaderLoaded=!0,r._mrt=L}l(null)};r.request=this.partial?r.fetchHeader(void 0,C.bind(this)):r.actor.send("loadTile",w,C.bind(this),void 0,!0)}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(r,l){const p=r.texture;p&&p instanceof i.T?(r.destroy(!0),this.map.painter.saveTileTexture(p)):(r.destroy(),r.flushQueues(),r._isHeaderLoaded=!1,delete r._mrt,delete r.textureDescriptor),r.fbo&&(r.fbo.destroy(),delete r.fbo),delete r.request,delete r.requestParams,delete r.neighboringTiles,r.state="unloaded"}prepareTile(r,l,p){r._isHeaderLoaded&&(r.state!=="empty"&&(r.state="reloading"),r.fetchBand(l,p,(v,w)=>{if(v)return r.state="errored",this.fire(new i.z(v)),void this.triggerRepaint(r);w&&(r._isHeaderLoaded=!0,r.setTexture(w,this.map.painter),r.state="loaded",this.triggerRepaint(r))}))}getInitialBand(r){if(!this.rasterLayers)return 0;const l=this.rasterLayers.find(({id:w})=>w===r),p=l&&l.fields,v=p&&p.bands&&p.bands;return v?v[0]:0}getTextureDescriptor(r,l,p){if(!r)return;const v=l.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!v)return;let w=null;l instanceof i.aN?w=l.paint.get("raster-array-band"):l instanceof i.aO&&(w=l.paint.get("raster-particle-array-band"));const C=w||this.getInitialBand(v);if(C!=null)if(r.textureDescriptor){if(!r.updateNeeded(v,C)||p)return Object.assign({},r.textureDescriptor,{texture:r.texture})}else this.prepareTile(r,v,C)}getImages(r,l){const p=new Map;for(const v of r)for(const w of l){const[C,P]=w.split("/"),L=v.getLayer(C);if(!L||!L.hasBand(P)||!L.hasDataForBand(P))continue;const{bytes:z,tileSize:j,buffer:H}=L.getBandView(P),$=j+2*H,q={data:new i.r({width:$,height:$},z),pixelRatio:2,sdf:!1,usvg:!1,version:0};p.set(w,q)}return p}}const Rh={vector:os,raster:xl,"raster-dem":class extends xl{constructor(f,r,l,p){super(f,r,l,p),this.type="raster-dem",this.maxzoom=22,this._options=i.l({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}loadTile(f,r){const l=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function p(v,w){v&&(f.state="errored",r(v)),w&&(f.dem=w,f.dem.onDeserialize(),f.needsHillshadePrepare=!0,f.needsDEMTextureUpload=!0,f.state="loaded",r(null))}f.request=i.o(this.map._requestManager.transformRequest(l,i.R.Tile),(function(v,w,C,P){if(delete f.request,f.aborted)f.state="unloaded",r(null);else if(v)f.state="errored",r(v);else if(w){this.map._refreshExpiredTiles&&f.setExpiryData({cacheControl:C,expires:P});const L=ImageBitmap&&w instanceof ImageBitmap&&i.t(),z=1-(w.width-i.aL(w.width))/2;z<1||f.neighboringTiles||(f.neighboringTiles=this._getNeighboringTiles(f.tileID));const j=L?w:i.q.getImageData(w,z),H={uid:f.uid,tileID:f.tileID,source:this.id,type:this.type,scope:this.scope,rawImageData:j,encoding:this.encoding,padding:z};f.actor&&f.state!=="expired"||(f.actor=this.dispatcher.getActor(),f.actor.send("loadTile",H,p.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(f){const r=f.canonical,l=Math.pow(2,r.z),p=(r.x-1+l)%l,v=r.x===0?f.wrap-1:f.wrap,w=(r.x+1+l)%l,C=r.x+1===l?f.wrap+1:f.wrap,P={};return P[new i.aM(f.overscaledZ,v,r.z,p,r.y).key]={backfilled:!1},P[new i.aM(f.overscaledZ,C,r.z,w,r.y).key]={backfilled:!1},r.y>0&&(P[new i.aM(f.overscaledZ,v,r.z,p,r.y-1).key]={backfilled:!1},P[new i.aM(f.overscaledZ,f.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},P[new i.aM(f.overscaledZ,C,r.z,w,r.y-1).key]={backfilled:!1}),r.y+1<l&&(P[new i.aM(f.overscaledZ,v,r.z,p,r.y+1).key]={backfilled:!1},P[new i.aM(f.overscaledZ,f.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},P[new i.aM(f.overscaledZ,C,r.z,w,r.y+1).key]={backfilled:!1}),P}},"raster-array":Eu,geojson:class extends i.E{constructor(f,r,l,p){super(),this.id=f,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=l.getActor(),this.setEventedParent(p),this._data=r.data,this._options=i.l({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.minzoom!==void 0&&(this.minzoom=r.minzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;const v=i.aj/this.tileSize;this.workerOptions=i.l({source:this.id,scope:this.scope,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(r.buffer!==void 0?r.buffer:128)*v,tolerance:(r.tolerance!==void 0?r.tolerance:.375)*v,extent:i.aj,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:i.aj,radius:(r.clusterRadius!==void 0?r.clusterRadius:50)*v,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter,dynamic:r.dynamic},r.workerOptions)}onAdd(f){this.map=f,this.setData(this._data)}setData(f){return this._data=f,this._updateWorkerData(),this}updateData(f){if(!this._options.dynamic)return this.fire(new i.z(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof f!="string"&&(f.type==="Feature"&&(f={type:"FeatureCollection",features:[f]}),f.type!=="FeatureCollection"))return this.fire(new i.z(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof f!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const r=new Map;for(const l of this._data.features)r.set(l.id,l);for(const l of f.features)r.set(l.id,l);this._data.features=[...r.values()]}else this._data=f;return this._updateWorkerData(!0),this}getClusterExpansionZoom(f,r){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:f,source:this.id,scope:this.scope},r),this}getClusterChildren(f,r){return this.actor.send("geojson.getClusterChildren",{clusterId:f,source:this.id,scope:this.scope},r),this}getClusterLeaves(f,r,l,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:f,limit:r,offset:l},p),this}_updateWorkerData(f=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new i.A("dataloading",{dataType:"source"})),this._loaded=!1;const r=i.l({append:f},this.workerOptions);r.scope=this.scope;const l=this._data;typeof l=="string"?(r.request=this.map._requestManager.transformRequest(i.q.resolveURL(l),i.R.Source),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(l),this._pendingLoad=this.actor.send(`${this.type}.loadData`,r,(p,v)=>{if(this._loaded=!0,this._pendingLoad=null,p)this.fire(new i.z(p));else{const w={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&v&&v.resourceTiming&&v.resourceTiming[this.id]&&(w.resourceTiming=v.resourceTiming[this.id]),f&&(this._partialReload=!0),this.fire(new i.A("data",w)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(f),this._coalesce=!1)})}loaded(){return this._loaded}reload(){const f=i.C(this.id,this.scope);this.map.style.clearSource(f),this._updateWorkerData()}loadTile(f,r){const l=f.actor?"reloadTile":"loadTile";f.actor=this.actor;const p=this.map.style?this.map.style.getLut(this.scope):null,v=p?{image:p.image.clone()}:null,w=this._partialReload,C={type:this.type,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:v,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:f.isExtraShadowCaster,scaleFactor:this.map.getScaleFactor(),partial:w};f.request=this.actor.send(l,C,(P,L)=>w&&!L?(f.state="loaded",r(null)):(delete f.request,f.destroy(),f.aborted?r(null):P?r(P):(f.loadVectorData(L,this.map.painter,l==="reloadTile"),r(null))),void 0,l==="loadTile")}abortTile(f){f.request&&(f.request.cancel(),delete f.request),f.aborted=!0}unloadTile(f,r){this.actor.send("removeTile",{uid:f.uid,type:this.type,source:this.id,scope:this.scope}),f.destroy()}onRemove(f){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return i.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends i.aP{constructor(f,r,l,p){super(f,r,l,p),this.roundZoom=!0,this.type="video",this.options=r}load(){this._loaded=!1;const f=this.options;this.urls=[];for(const r of f.urls)this.urls.push(this.map._requestManager.transformRequest(r,i.R.Source).url);i.aQ(this.urls,(r,l)=>{this._loaded=!0,r?this.fire(new i.z(r)):l&&(this.video=l,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(f){if(this.video){const r=this.video.seekable;f<r.start(0)||f>r.end(0)?this.fire(new i.z(new i.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=f}}getVideo(){return this.video}onAdd(f){this.map||(this.map=f,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const f=this.map.painter.context,r=f.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new i.T(f,this.video,r.RGBA8),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(f)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:i.aP,model:class extends i.E{constructor(f,r,l,p){super(),this.id=f,this.type="model",this.models=[],this._loaded=!1,this._options=r}load(){const f=[];for(const r in this._options.models){const l=this._options.models[r],p=i.aS(this.map._requestManager.transformRequest(l.uri,i.R.Model).url).then(v=>{if(!v)return;const w=i.aT(v),C=new i.aU(r,l.position,l.orientation,w);C.computeBoundsAndApplyParent(),this.models.push(C)}).catch(v=>{this.fire(new i.z(new Error(`Could not load model ${r} from ${l.uri}: ${v.message}`)))});f.push(p)}Promise.allSettled(f).then(()=>{this._loaded=!0,this.fire(new i.A("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(r=>{this._loaded=!0,this.fire(new i.z(new Error(`Could not load models: ${r.message}`)))})}onAdd(f){this.map=f,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(f,r){}serialize(){return this._options}},"batched-model":class extends i.E{constructor(f,r,l,p){super(),this.type="batched-model",this.id=f,this.tileSize=512,this._options=r,this.tiles=this._options.tiles,this.maxzoom=r.maxzoom||19,this.minzoom=r.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=l,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(p)}onAdd(f){this.map=f,this.load()}reload(){this.cancelTileJSONRequest();const f=i.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(f))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(f){this._loaded=!1,this.fire(new i.A("dataloading",{dataType:"source"}));const r=Array.isArray(this.map._language)?this.map._language.join():this.map._language,l=this.map.getWorldview();this._tileJSONRequest=$s(this._options,this.map._requestManager,r,l,(p,v)=>{this._tileJSONRequest=null,this._loaded=!0,p?(r&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${r}`),l&&l.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${l}`),this.fire(new i.z(p))):v&&(i.l(this,v),v.bounds&&(this.tileBounds=new Hs(v.bounds,this.minzoom,this.maxzoom)),Ye(v.tiles,this.map._requestManager._customAccessToken),this.fire(new i.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.A("data",{dataType:"source",sourceDataType:"content"}))),f&&f(p)})}hasTransition(){return!1}hasTile(f){return!this.tileBounds||this.tileBounds.contains(f.canonical)}loaded(){return this._loaded}loadTile(f,r){const l=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme)),p={request:this.map._requestManager.transformRequest(l,i.R.Tile),data:void 0,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,tileSize:this.tileSize*f.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:f.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,pixelRatio:i.q.devicePixelRatio,promoteId:this.promoteId};if(f.actor&&f.state!=="expired")if(f.state==="loading")f.reloadCallback=r;else{if(f.buckets){const w=Object.values(f.buckets);for(const C of w)C.dirty=!0;return void(f.state="loaded")}f.request=f.actor.send("reloadTile",p,v.bind(this))}else f.actor=this.dispatcher.getActor(),f.request=f.actor.send("loadTile",p,v.bind(this),void 0,!0);function v(w,C){return f.aborted?r(null):w&&w.status!==404?r(w):(this.map._refreshExpiredTiles&&C&&f.setExpiryData(C),f.loadModelData(C,this.map.painter),f.state="loaded",void r(null))}}serialize(){return i.l({},this._options)}},canvas:class extends i.aP{constructor(f,r,l,p){super(f,r,l,p),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(v=>!Array.isArray(v)||v.length!==2||v.some(w=>typeof w!="number"))||this.fire(new i.z(new i.V(`sources.${f}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.z(new i.V(`sources.${f}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new i.z(new i.V(`sources.${f}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof HTMLCanvasElement||this.fire(new i.z(new i.V(`sources.${f}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.z(new i.V(`sources.${f}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.z(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(f){this.map=f,this.load(),this.canvas&&this.animate&&this.play()}onRemove(f){this.pause()}prepare(){let f=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,f=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,f=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context;this.texture?!f&&!this._playing||this.texture instanceof i.aR||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.T(r,this.canvas,r.gl.RGBA8,{premultiply:!0}),this._prepareData(r)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const f of[this.canvas.width,this.canvas.height])if(isNaN(f)||f<=0)return!0;return!1}},custom:class extends i.E{constructor(f,r,l,p){super(),this.id=f,this.type="custom",this._dataType="raster",this._dispatcher=l,this._implementation=r,this.setEventedParent(p),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new i.z(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new i.z(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Hs(this._implementation.bounds,this.minzoom,this.maxzoom)),r.update=this._update.bind(this),r.clearTiles=this._clearTiles.bind(this),r.coveringTiles=this._coveringTiles.bind(this),i.l(this,i.aF(r,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return i.aF(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new i.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.A("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(f){this.map=f,this._loaded=!1,this.fire(new i.A("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(f),this.load()}onRemove(f){this._implementation.onRemove&&this._implementation.onRemove(f)}hasTile(f){if(this._implementation.hasTile){const{x:r,y:l,z:p}=f.canonical;return this._implementation.hasTile({x:r,y:l,z:p})}return!this.tileBounds||this.tileBounds.contains(f.canonical)}loadTile(f,r){const{x:l,y:p,z:v}=f.tileID.canonical,w=new AbortController;f.request=Promise.resolve(this._implementation.loadTile({x:l,y:p,z:v},{signal:w.signal})).then((function(C){return delete f.request,f.aborted?(f.state="unloaded",r(null)):C===void 0?(f.state="errored",r(null)):C===null?(this.loadTileData(f,{width:this.tileSize,height:this.tileSize,data:null}),f.state="loaded",r(null)):function(P){return P instanceof ImageData||P instanceof HTMLCanvasElement||P instanceof ImageBitmap||P instanceof HTMLImageElement}(C)?(this.loadTileData(f,C),f.state="loaded",void r(null)):(f.state="errored",r(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(C=>{C.name!=="AbortError"&&(f.state="errored",r(C))}),f.request.cancel=()=>w.abort()}loadTileData(f,r){f.setTexture(r,this.map.painter)}unloadTile(f,r){if(f.texture&&f.texture instanceof i.T?(f.destroy(!0),f.texture&&f.texture instanceof i.T&&this.map.painter.saveTileTexture(f.texture)):f.destroy(),this._implementation.unloadTile){const{x:l,y:p,z:v}=f.tileID.canonical;this._implementation.unloadTile({x:l,y:p,z:v})}r&&r()}abortTile(f,r){f.request&&f.request.cancel&&(f.request.cancel(),delete f.request),r&&r()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(f=>({x:f.canonical.x,y:f.canonical.y,z:f.canonical.z}))}_clearTiles(){const f=i.C(this.id,this.scope);this.map.style.clearSource(f)}_update(){this.fire(new i.A("data",{dataType:"source",sourceDataType:"content"}))}}},rc=function(f,r,l,p){const v=new Rh[r.type](f,r,l,p);if(v.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${v.id}`);return i.aV(["load","abort","unload","serialize","prepare"],v),v};function Iu(f,r,l=""){return`${l}:${r.id||""}:${r.layer.id}:${function(p){if("layerId"in p)return`layer:${p.layerId}`;{const{featuresetId:v,importId:w}=p;return`featureset:${v}${w?`:import:${w}`:""}`}}(f.target)}`}function ic(f,r,l,p=""){if(f.uniqueFeatureID){const v=Iu(f,r,p);if(l.has(v))return!0;l.add(v)}return!1}function bl(f,r,l,p,v=!1){const w=r.sourceCache.transform,C=r.sourceCache.tilesIn(f,r.has3DLayers,v);C.sort(sa);const P=[];for(const L of C){const z=L.tile.queryRenderedFeatures(r,L,l,p,w,v);Object.keys(z).length&&P.push({wrappedTileID:L.tile.tileID.wrapped().key,queryResults:z})}return P.length===0?{}:function(L){const z={},j={};for(const H of L){const $=H.queryResults,q=H.wrappedTileID,re=j[q]=j[q]||{};for(const te in $){const oe=$[te],ne=re[te]=re[te]||{},ye=z[te]=z[te]||[];for(const Se of oe)ne[Se.featureIndex]||(ne[Se.featureIndex]=!0,ye.push(Se))}}return z}(P)}function Mh(f,r,l,p,v){const w={},C=p.queryRenderedSymbols(f),P=[];for(const L of Object.keys(C).map(Number))P.push(v[L]);P.sort(sa);for(const L of P){const z=L.featureIndex.lookupSymbolFeatures(C[L.bucketInstanceId],L.bucketIndex,L.sourceLayerIndex,r,l);for(const j in z){const H=w[j]=w[j]||[],$=z[j];$.sort((q,re)=>{const te=L.featureSortOrder;if(te){const oe=te.indexOf(q.featureIndex);return te.indexOf(re.featureIndex)-oe}return re.featureIndex-q.featureIndex});for(const q of $)H.push(q)}}return w}function tm(f,r){const l=f.getRenderableIds().map(w=>f.getTileByID(w)),p=[],v={};for(let w=0;w<l.length;w++){const C=l[w],P=C.tileID.canonical.key;v[P]||(v[P]=!0,C.querySourceFeatures(p,r))}return p}function sa(f,r){const l=f.tileID,p=r.tileID;return l.overscaledZ-p.overscaledZ||l.canonical.y-p.canonical.y||l.wrap-p.wrap||l.canonical.x-p.canonical.x}function Of(f,r){const l={};if(!r)return l;for(const p of f){const v=p.layerIds.map(w=>r.getLayer(w)).filter(Boolean);if(v.length!==0){p.layers=v,p.stateDependentLayerIds&&(p.stateDependentLayers=p.stateDependentLayerIds.map(w=>v.filter(C=>C.id===w)[0]));for(const w of v)l[w.fqid]=p}}return l}const Do=32,Ho=33,sc=new Uint16Array(8184);for(let f=0;f<2046;f++){let r=f+2,l=0,p=0,v=0,w=0,C=0,P=0;for(1&r?v=w=C=Do:l=p=P=Do;(r>>=1)>1;){const z=l+v>>1,j=p+w>>1;1&r?(v=l,w=p,l=C,p=P):(l=v,p=w,v=C,w=P),C=z,P=j}const L=4*f;sc[L+0]=l,sc[L+1]=p,sc[L+2]=v,sc[L+3]=w}const oa=new Uint16Array(2178),wi=new Uint8Array(1089),aa=new Uint16Array(1089);function yd(f){return f===0?-.03125:f===32?.03125:0}const Lh={type:2,extent:i.aj,loadGeometry:()=>[[new i.P(0,0),new i.P(i.aj+1,0),new i.P(i.aj+1,i.aj+1),new i.P(0,i.aj+1),new i.P(0,0)]]};class wl{constructor(r,l,p,v,w){this.tileID=r,this.uid=i.a$(),this.uses=0,this.tileSize=l,this.tileZoom=p,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=w,v&&v.style&&(this._lastUpdatedBrightness=v.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",v&&v.transform&&(this.projection=v.transform.projection)}registerFadeDuration(r){const l=r+this.timeAdded;l<i.q.now()||this.fadeEndTime&&l<this.fadeEndTime||(this.fadeEndTime=l)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=i.aW(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(r,l,p){if(this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=Of(r.buckets,l.style),this.hasSymbolBuckets=!1;for(const v in this.buckets){const w=this.buckets[v];if(w instanceof i.b1){if(this.hasSymbolBuckets=!0,!p)break;w.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const v in this.buckets){const w=this.buckets[v];if(w instanceof i.b1&&w.hasRTLText){this.hasRTLText=!0,i.b2();break}}this.queryPadding=0;for(const v in this.buckets){const w=this.buckets[v],C=l.style.getOwnLayer(v);if(!C)continue;const P=C.queryRadius(w);this.queryPadding=Math.max(this.queryPadding,P)}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage),r.lineAtlas&&(this.lineAtlas=r.lineAtlas),this._lastUpdatedBrightness=r.brightness}else this.collisionBoxArray=new i.b0}unloadVectorData(){if(this.hasData()){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(r,l,p){r&&(r.resourceTiming&&(this.resourceTiming=r.resourceTiming),this.buckets=Object.assign({},this.buckets,Of(r.buckets,l.style)),r.featureIndex&&(this.latestFeatureIndex=r.featureIndex))}getBucket(r){return this.buckets[r.fqid]}upload(r){for(const v in this.buckets){const w=this.buckets[v];w.uploadPending()&&w.upload(r)}const l=r.gl,p=this.imageAtlas;p&&!p.uploaded&&(this.imageAtlasTexture=new i.T(r,p.image,l.RGBA8,{useMipmap:!!p.patternPositions.size}),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new i.T(r,this.glyphAtlasImage,l.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new i.T(r,this.lineAtlas.image,l.R8),this.lineAtlas.uploaded=!0)}prepare(r,l,p){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture,p),!l||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const v=l.style.getBrightness();(this._lastUpdatedBrightness||v)&&(this._lastUpdatedBrightness&&v&&Math.abs(this._lastUpdatedBrightness-v)<.001||(this.updateBuckets(l,this._lastUpdatedBrightness!==v),this._lastUpdatedBrightness=v))}queryRenderedFeatures(r,l,p,v,w,C){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const P=function(L,z){const j=i.bn([],[.5*L.width,.5*-L.height,1]);return i.bo(j,j,[1,-1,0]),i.az(j,j,L.calculateProjMatrix(z.toUnwrapped())),Float32Array.from(j)}(w,this.tileID);return this.latestFeatureIndex.query(r,{tilespaceGeometry:l,pixelPosMatrix:P,transform:v,availableImages:p,tileTransform:this.tileTransform})}querySourceFeatures(r,l){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const v=p.loadVTLayers(),w=l?l.sourceLayer:"",C=v._geojsonTileLayer||v[w];if(!C)return;const P=i.b3(l&&l.filter),{z:L,x:z,y:j}=this.tileID.canonical,H={z:L,x:z,y:j};for(let $=0;$<C.length;$++){const q=C.feature($);if(P.needGeometry){const oe=i.b4(q,!0);if(!P.filter(new i.aa(this.tileID.overscaledZ),oe,this.tileID.canonical))continue}else if(!P.filter(new i.aa(this.tileID.overscaledZ),q))continue;const re=p.getId(q,w),te=new i.b5(q,L,z,j,re);te.tile=H,r.push(te)}}loaded(){return this.state==="loaded"||this.state==="errored"}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!this.imageAtlas.patternPositions.size}setExpiryData(r){const l=this.expirationTime;if(r.cacheControl){const p=i.b6(r.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const p=Date.now();let v=!1;if(this.expirationTime>p)v=!1;else if(l)if(this.expirationTime<l)v=!0;else{const w=this.expirationTime-l;w?this.expirationTime=p+Math.max(w,3e4):v=!0}else v=!0;v?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(r){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&r&&this.updateBuckets(r)}updateBuckets(r,l){if(!this.latestFeatureIndex||!r.style)return;const p=this.latestFeatureIndex.loadVTLayers(),v=r.style.listImages(),w=r.style.getBrightness();for(const C in this.buckets){if(!r.style.hasLayer(C))continue;const P=this.buckets[C],L=P.layers[0],z=L.sourceLayer||"_geojsonTileLayer",j=p[z],H=r.style.getLayerSourceCache(L);let $={};H&&($=H._state.getState(z,void 0));const q=this.imageAtlas?Object.fromEntries(this.imageAtlas.patternPositions):{},re=Object.keys($).length>0&&!l;re&&!P.stateDependentLayers.length&&!l||P.update($,j,v,q,re?P.stateDependentLayers:P.layers,l,w),(P instanceof i.b7||P instanceof i.b8)&&r._terrain&&r._terrain.enabled&&H&&P.uploadPending()&&r._terrain._clearRenderCacheForTile(H.id,this.tileID);const te=r&&r.style&&r.style.getOwnLayer(C);te&&(this.queryPadding=Math.max(this.queryPadding,te.queryRadius(P)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<i.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=i.q.now()+r}setTexture(r,l){const p=l.context,v=p.gl;this.texture=this.texture||l.getTileTexture(r.width),this.texture&&this.texture instanceof i.T?this.texture.update(r):(this.texture=new i.T(p,r,v.RGBA8,{useMipmap:!0}),this.texture.bind(v.LINEAR,v.CLAMP_TO_EDGE))}setDependencies(r,l){const p={};for(const v of l)p[v]=!0;this.dependencies[r]=p}hasDependency(r,l){for(const p of r){const v=this.dependencies[p];if(v){for(const w of l)if(v[w])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(r,l){if(!l||l.name==="mercator"||this._tileDebugBuffer)return;const p=i.b9(Lh,this.tileID.canonical,this.tileTransform)[0],v=new i.ba,w=new i.bb;for(let C=0;C<p.length;C++){const{x:P,y:L}=p[C];v.emplaceBack(P,L),w.emplaceBack(C)}w.emplaceBack(0),this._tileDebugIndexBuffer=r.createIndexBuffer(w),this._tileDebugBuffer=r.createVertexBuffer(v,i.bc.members),this._tileDebugSegments=i.bd.simpleSegment(0,0,v.length,w.length)}_makeTileBoundsBuffers(r,l){if(this._tileBoundsBuffer||!l||l.name==="mercator")return;const p=i.b9(Lh,this.tileID.canonical,this.tileTransform)[0];let v,w;if(this.isRaster){const C=function(P,L){const z=i.aW(P,L),j=Math.pow(2,P.z);for(let oe=0;oe<Ho;oe++)for(let ne=0;ne<Ho;ne++){const ye=i.aX((P.x+(ne+yd(ne))/Do)/j),Se=i.aY((P.y+(oe+yd(oe))/Do)/j),Te=L.project(ye,Se),ke=oe*Ho+ne;oa[2*ke+0]=Math.round((Te.x*z.scale-z.x)*i.aj),oa[2*ke+1]=Math.round((Te.y*z.scale-z.y)*i.aj)}wi.fill(0),aa.fill(0);for(let oe=2045;oe>=0;oe--){const ne=4*oe,ye=sc[ne+0],Se=sc[ne+1],Te=sc[ne+2],ke=sc[ne+3],De=ye+Te>>1,Me=Se+ke>>1,Pe=De+Me-Se,Oe=Me+ye-De,Ne=Se*Ho+ye,ht=ke*Ho+Te,rt=Me*Ho+De,Tt=Math.hypot((oa[2*Ne+0]+oa[2*ht+0])/2-oa[2*rt+0],(oa[2*Ne+1]+oa[2*ht+1])/2-oa[2*rt+1])>=16;wi[rt]=wi[rt]||(Tt?1:0),oe<1022&&(wi[rt]=wi[rt]||wi[(Se+Oe>>1)*Ho+(ye+Pe>>1)]||wi[(ke+Oe>>1)*Ho+(Te+Pe>>1)])}const H=new i.aZ,$=new i.a_;let q=0;function re(oe,ne){const ye=ne*Ho+oe;return aa[ye]===0&&(H.emplaceBack(oa[2*ye+0],oa[2*ye+1],oe*i.aj/Do,ne*i.aj/Do),aa[ye]=++q),aa[ye]-1}function te(oe,ne,ye,Se,Te,ke){const De=oe+ye>>1,Me=ne+Se>>1;if(Math.abs(oe-Te)+Math.abs(ne-ke)>1&&wi[Me*Ho+De])te(Te,ke,oe,ne,De,Me),te(ye,Se,Te,ke,De,Me);else{const Pe=re(oe,ne),Oe=re(ye,Se),Ne=re(Te,ke);$.emplaceBack(Pe,Oe,Ne)}}return te(0,0,Do,Do,Do,0),te(Do,Do,0,0,0,Do),{vertices:H,indices:$}}(this.tileID.canonical,l);v=C.vertices,w=C.indices}else{v=new i.aZ,w=new i.a_;for(const{x:P,y:L}of p)v.emplaceBack(P,L,0,0);const C=i.be(v.int16.subarray(0,4*v.length),void 0,4);for(let P=0;P<C.length;P+=3)w.emplaceBack(C[P],C[P+1],C[P+2])}this._tileBoundsBuffer=r.createVertexBuffer(v,i.bf.members),this._tileBoundsIndexBuffer=r.createIndexBuffer(w),this._tileBoundsSegments=i.bd.simpleSegment(0,0,v.length,w.length)}_makeGlobeTileDebugBuffers(r,l){const p=l.projection;if(!p||p.name!=="globe"||l.freezeTileCoverage)return;const v=this.tileID.canonical,w=i.bg(v,l),C=i.bh(w),P=i.ah(l.zoom);let L;P>0&&(L=i.bi(new Float64Array(16),l.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(r,v,l,C,L,P),this._makeGlobeTileDebugTextBuffer(r,v,l,C,L,P)}_globePoint(r,l,p,v,w,C,P){let L=i.bj(r,l,p);if(C){const z=1<<p.z,j=i.ay(v.center.lng),H=i.aH(v.center.lat),$=(p.x+.5)/z-j;let q=0;$>.5?q=-1:$<-.5&&(q=1);let re=(r/i.aj+p.x)/z+q,te=(l/i.aj+p.y)/z;re=(re-j)*v._pixelsPerMercatorPixel+j,te=(te-H)*v._pixelsPerMercatorPixel+H;const oe=[re*v.worldSize,te*v.worldSize,0];i.ad(oe,oe,C),L=i.bk(L,oe,P)}return i.ad(L,L,w)}_makeGlobeTileDebugBorderBuffer(r,l,p,v,w,C){const P=new i.ba,L=new i.bb,z=new i.bl,j=($,q,re,te,oe)=>{const ne=(re-$)/(oe-1),ye=(te-q)/(oe-1),Se=P.length;for(let Te=0;Te<oe;Te++){const ke=$+Te*ne,De=q+Te*ye;P.emplaceBack(ke,De);const Me=this._globePoint(ke,De,l,p,v,w,C);z.emplaceBack(Me[0],Me[1],Me[2]),L.emplaceBack(Se+Te)}},H=i.aj;j(0,0,H,0,16),j(H,0,H,H,16),j(H,H,0,H,16),j(0,H,0,0,16),this._tileDebugIndexBuffer=r.createIndexBuffer(L),this._tileDebugBuffer=r.createVertexBuffer(P,i.bc.members),this._globeTileDebugBorderBuffer=r.createVertexBuffer(z,i.bm.members),this._tileDebugSegments=i.bd.simpleSegment(0,0,P.length,L.length)}_makeGlobeTileDebugTextBuffer(r,l,p,v,w,C){const P=i.aj/4,L=new i.ba,z=new i.a_,j=new i.bl,H=25;z.reserve(32),L.reserve(H),j.reserve(H);const $=(q,re)=>H*q+re;for(let q=0;q<H;q++){const re=q*P;for(let te=0;te<H;te++){const oe=te*P;L.emplaceBack(oe,re);const ne=this._globePoint(oe,re,l,p,v,w,C);j.emplaceBack(ne[0],ne[1],ne[2])}}for(let q=0;q<4;q++)for(let re=0;re<4;re++){const te=$(q,re),oe=$(q,re+1),ne=$(q+1,re),ye=$(q+1,re+1);z.emplaceBack(te,oe,ne),z.emplaceBack(ne,oe,ye)}this._tileDebugTextIndexBuffer=r.createIndexBuffer(z),this._tileDebugTextBuffer=r.createVertexBuffer(L,i.bc.members),this._globeTileDebugTextBuffer=r.createVertexBuffer(j,i.bm.members),this._tileDebugTextSegments=i.bd.simpleSegment(0,0,H,32)}destroy(r=!1){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!r&&this.texture&&this.texture instanceof i.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}i.bp.setPbf(i.bq);class vd extends wl{constructor(r,l,p,v,w){super(r,l,p,v,w),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}getLayers(){return this._mrt?Object.values(this._mrt.layers):[]}getLayer(r){return this._mrt&&this._mrt.getLayer(r)}setTexture(r,l){const p=l.context,v=p.gl;this.texture=this.texture||l.getTileTexture(r.width),this.texture&&this.texture instanceof i.T?this.texture.update(r,{premultiply:!1}):this.texture=new i.T(p,r,v.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(r=16384,l){const p=this._mrt=new i.bp(30),v=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(r-1)}});return this.entireBuffer=null,this.request=i.br(v,(w,C,P,L)=>{if(w)l(w);else try{const z=p.getHeaderLength(C);if(z>r)return void(this.request=this.fetchHeader(z,l));p.parseHeader(C),this._isHeaderLoaded=!0;let j=0;for(const H of Object.values(p.layers))j=Math.max(j,H.dataIndex[H.dataIndex.length-1].lastByte);C.byteLength>=j&&(this.entireBuffer=C),l(null,this.entireBuffer||C,P,L)}catch(z){l(z)}}),this.request}fetchBand(r,l,p){const v=this._mrt;if(!this._isHeaderLoaded||!v)return void p(new Error("Tile header is not ready"));const w=this.actor;if(!w)return void p(new Error("Can't fetch tile band without an actor"));let C;const P=(H,$)=>{C.complete(H,$),H?p(H):(this.updateTextureDescriptor(r,l),p(null,this.textureDescriptor&&this.textureDescriptor.img))},L=(H,$)=>{if(H)return p(H);const q=w.send("decodeRasterArray",{type:"raster-array",source:this.source,scope:this.scope,tileID:this.tileID,uid:this.uid,buffer:$,task:C},P,void 0,!0);this._workQueue.push(()=>{q&&q.cancel(),C.cancel()})},z=v.getLayer(r);if(!z)return void p(new Error(`Unknown sourceLayer "${r}"`));if(z.hasDataForBand(l))return this.updateTextureDescriptor(r,l),void p(null,this.textureDescriptor?this.textureDescriptor.img:null);const j=z.getDataRange([l]);if(C=v.createDecodingTask(j),!C||C.tasks.length)if(this.flushQueues(),this.entireBuffer)L(null,this.entireBuffer.slice(j.firstByte,j.lastByte+1));else{const H=Object.assign({},this.requestParams,{headers:{Range:`bytes=${j.firstByte}-${j.lastByte}`}}),$=i.br(H,L);this._fetchQueue.push(()=>{$.cancel(),C.cancel()})}else p(null)}updateNeeded(r,l){return(!this.textureDescriptor||this.textureDescriptor.band!==l||this.textureDescriptor.layer!==r)&&this.state!=="errored"}updateTextureDescriptor(r,l){if(!this._mrt)return;const p=this._mrt.getLayer(r);if(!p||!p.hasBand(l)||!p.hasDataForBand(l))return;const{bytes:v,tileSize:w,buffer:C,offset:P,scale:L}=p.getBandView(l),z=w+2*C,j=new i.r({width:z,height:z},v),H=this.texture;H&&H instanceof i.T&&H.update(j,{premultiply:!1}),this.textureDescriptor={layer:r,band:l,img:j,buffer:C,offset:P,tileSize:w,format:p.pixelFormat,mix:[L,256*L,65536*L,16777216*L]}}}class zf{constructor(r,l){this.max=r,this.onRemove=l,this.reset()}reset(){for(const r in this.data)for(const l of this.data[r])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(r,l,p){const v=r.wrapped().key;this.data[v]===void 0&&(this.data[v]=[]);const w={value:l,timeout:void 0};if(p!==void 0&&(w.timeout=setTimeout(()=>{this.remove(r,w)},p)),this.data[v].push(w),this.order.push(v),this.order.length>this.max){const C=this._getAndRemoveByKey(this.order[0]);C&&this.onRemove(C)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const l=this.data[r].shift();return l.timeout&&clearTimeout(l.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),l.value}getByKey(r){const l=this.data[r];return l?l[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,l){if(!this.has(r))return this;const p=r.wrapped().key,v=l===void 0?0:this.data[p].indexOf(l),w=this.data[p][v];return this.data[p].splice(v,1),w.timeout&&clearTimeout(w.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(w.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(r){const l=[];for(const p in this.data)for(const v of this.data[p])r(v.value)||l.push(v);for(const p of l)this.remove(p.value.tileID,p)}}class Pu{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,l,p){const v=String(l);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][v]=this.stateChanges[r][v]||{},i.l(this.stateChanges[r][v],p),this.deletedStates[r]===null){this.deletedStates[r]={};for(const w in this.state[r])w!==v&&(this.deletedStates[r][w]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][v]===null){this.deletedStates[r][v]={};for(const w in this.state[r][v])p[w]||(this.deletedStates[r][v][w]=null)}else for(const w in p)this.deletedStates[r]&&this.deletedStates[r][v]&&this.deletedStates[r][v][w]===null&&delete this.deletedStates[r][v][w]}removeFeatureState(r,l,p){if(this.deletedStates[r]===null)return;const v=String(l);if(this.deletedStates[r]=this.deletedStates[r]||{},p&&l!==void 0)this.deletedStates[r][v]!==null&&(this.deletedStates[r][v]=this.deletedStates[r][v]||{},this.deletedStates[r][v][p]=null);else if(l!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][v])for(p in this.deletedStates[r][v]={},this.stateChanges[r][v])this.deletedStates[r][v][p]=null;else this.deletedStates[r][v]=null;else this.deletedStates[r]=null}getState(r,l){const p=this.state[r]||{},v=this.stateChanges[r]||{},w=this.deletedStates[r];if(w===null)return{};if(l!==void 0){const P=String(l),L=i.l({},p[P],v[P]);if(w){const z=w[l];if(z===null)return{};for(const j in z)delete L[j]}return L}const C=i.l({},p,v);if(w)for(const P in w)delete C[P];return C}initializeTileState(r,l){r.refreshFeatureState(l)}coalesceChanges(r,l){const p={};for(const v in this.stateChanges){this.state[v]=this.state[v]||{};const w={};for(const C in this.stateChanges[v])this.state[v][C]||(this.state[v][C]={}),i.l(this.state[v][C],this.stateChanges[v][C]),w[C]=this.state[v][C];p[v]=w}for(const v in this.deletedStates){this.state[v]=this.state[v]||{};const w={};if(this.deletedStates[v]===null)for(const C in this.state[v])w[C]={},this.state[v][C]={};else for(const C in this.deletedStates[v]){if(this.deletedStates[v][C]===null)this.state[v][C]={};else if(this.state[v][C])for(const P of Object.keys(this.deletedStates[v][C]))delete this.state[v][C][P];w[C]=this.state[v][C]}p[v]=p[v]||{},i.l(p[v],w)}if(this.stateChanges={},this.deletedStates={},Object.keys(p).length!==0)for(const v in r)r[v].refreshFeatureState(l)}}class to extends i.E{constructor(r,l,p){super(),this.id=r,this._onlySymbols=p,l.on("data",v=>{v.dataType==="source"&&v.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&v.dataType==="source"&&v.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),l.on("error",()=>{this._sourceErrored=!0}),this._source=l,this._tiles={},this._cache=new zf(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=l.minTileCacheSize,this._maxTileCacheSize=l.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Pu,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(r){this.map=r,this._minTileCacheSize=this._minTileCacheSize===void 0&&r?r._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&r?r._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const r in this._tiles)if(!this._tiles[r].loaded())return!1;return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(r,l){return r.isSymbolTile=this._onlySymbols,r.isExtraShadowCaster=this._shadowCasterTiles[r.tileID.key],this._source.loadTile(r,l)}_unloadTile(r){if(this._source.unloadTile)return this._source.unloadTile(r)}_abortTile(r){if(this._source.abortTile)return this._source.abortTile(r)}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const p=this._tiles[l];p.upload(r),p.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Object.values(this._tiles).map(r=>r.tileID).sort(Ka).map(r=>r.key)}getRenderableIds(r,l){const p=[];for(const v in this._tiles)this._isIdRenderable(+v,r,l)&&p.push(this._tiles[v]);return r?p.sort((v,w)=>{const C=v.tileID,P=w.tileID,L=new i.P(C.canonical.x,C.canonical.y)._rotate(this.transform.angle),z=new i.P(P.canonical.x,P.canonical.y)._rotate(this.transform.angle);return C.overscaledZ-P.overscaledZ||z.y-L.y||z.x-L.x}).map(v=>v.tileID.key):p.map(v=>v.tileID).sort(Ka).map(v=>v.key)}hasRenderableParent(r){const l=this.findLoadedParent(r,0);return!!l&&this._isIdRenderable(l.tileID.key)}_isIdRenderable(r,l,p){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(l||!this._tiles[r].holdingForFade())&&(p||!this._shadowCasterTiles[r])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)this._tiles[r].state!=="errored"&&this._reloadTile(+r,"reloading")}}_reloadTile(r,l){const p=this._tiles[r];p&&(p.state!=="loading"&&(p.state=l),this._loadTile(p,this._tileLoaded.bind(this,p,r,l)))}_tileLoaded(r,l,p,v){if(v)if(r.state="errored",v.status!==404)this._source.fire(new i.z(v,{tile:r}));else{if(this._source.fire(new i.A("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:r})),!(r.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const w=this.map.painter.terrain;this.update(this.transform,w.getScaledDemTileSize(),!0),w.resetTileLookupCache(this.id)}else this.update(this.transform)}else r.timeAdded=i.q.now(),p==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(l,r),this._source.type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),this._source.fire(new i.A("data",{dataType:"source",tile:r,coord:r.tileID,sourceCacheId:this.id}))}_backfillDEM(r){const l=this.getRenderableIds();for(let v=0;v<l.length;v++){const w=l[v];if(r.neighboringTiles&&r.neighboringTiles[w]){const C=this.getTileByID(w);p(r,C),p(C,r)}}function p(v,w){if(!v.dem||v.dem.borderReady)return;v.needsHillshadePrepare=!0,v.needsDEMTextureUpload=!0;let C=w.tileID.canonical.x-v.tileID.canonical.x;const P=w.tileID.canonical.y-v.tileID.canonical.y,L=Math.pow(2,v.tileID.canonical.z),z=w.tileID.key;C===0&&P===0||Math.abs(P)>1||(Math.abs(C)>1&&(Math.abs(C+L)===1?C+=L:Math.abs(C-L)===1&&(C-=L)),w.dem&&v.dem&&(v.dem.backfillBorder(w.dem,C,P),v.neighboringTiles&&v.neighboringTiles[z]&&(v.neighboringTiles[z].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,l,p,v){for(const w in this._tiles){let C=this._tiles[w];if(v[w]||!C.hasData()||C.tileID.overscaledZ<=l||C.tileID.overscaledZ>p)continue;let P=C.tileID;for(;C&&C.tileID.overscaledZ>l+1;){const z=C.tileID.scaledTo(C.tileID.overscaledZ-1);C=this._tiles[z.key],C&&C.hasData()&&(P=z)}let L=P;for(;L.overscaledZ>l;)if(L=L.scaledTo(L.overscaledZ-1),r[L.key]){v[P.key]=P;break}}}findLoadedParent(r,l){if(r.key in this._loadedParentTiles){const p=this._loadedParentTiles[r.key];return p&&p.tileID.overscaledZ>=l?p:null}for(let p=r.overscaledZ-1;p>=l;p--){const v=r.scaledTo(p),w=this._getLoadedTile(v);if(w)return w}}_getLoadedTile(r){const l=this._tiles[r.key];return l&&l.hasData()?l:this._cache.getByKey(this._source.reparseOverscaled?r.wrapped().key:r.canonical.key)}updateCacheSize(r,l){l=l||this._source.tileSize;const p=Math.ceil(r.width/l)+1,v=Math.ceil(r.height/l)+1,w=Math.floor(p*v*5),C=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,w):w,P=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,C):C;this._cache.setMaxSize(P)}handleWrapJump(r){const l=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,l){const p={};for(const v in this._tiles){const w=this._tiles[v];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+l),p[w.tileID.key]=w}this._tiles=p;for(const v in this._timers)clearTimeout(this._timers[v]),delete this._timers[v];for(const v in this._tiles)this._setTileReloadTimer(+v,this._tiles[v])}}update(r,l,p,v,w){if(this.transform=r,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!p)return;this.updateCacheSize(r,l),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const C=this._source.type==="batched-model";let P,L=this._source.maxzoom;const z=this.map&&this.map.painter?this.map.painter._terrain:null;if(z&&z.sourceCache===this&&z.attenuationRange()){const $=z.attenuationRange()[0],q=Math.floor($)-Math.log2(z.getDemUpscale());L>q&&(L=q)}if(this.used||this.usedForTerrain){if(this._source.tileID)P=r.getVisibleUnwrappedCoordinates(this._source.tileID).map($=>new i.aM($.canonical.z,$.wrap,$.canonical.z,$.canonical.x,$.canonical.y));else if(this.tileCoverLift!==0){const $=r.clone();$.tileCoverLift=this.tileCoverLift,P=$.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:L,roundZoom:this._source.roundZoom&&!p,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:C}),this._source.minzoom<=1&&r.projection.name==="globe"&&(P.push(new i.aM(1,0,1,0,0)),P.push(new i.aM(1,0,1,1,0)),P.push(new i.aM(1,0,1,0,1)),P.push(new i.aM(1,0,1,1,1)))}else if(P=r.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:L,roundZoom:this._source.roundZoom&&!p,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:C}),this._source.hasTile){const $=this._source.hasTile.bind(this._source);P=P.filter(q=>$(q))}}else P=[];if(P.length>0&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Ya(this._source.type)){const $=r.coveringZoomLevel({tileSize:l||this._source.tileSize,roundZoom:this._source.roundZoom&&!p}),q=Math.min($,this._source.maxzoom);if(C){const re=r.extendTileCover(P,q);for(const te of re)P.push(te)}else if(w){const re=r.extendTileCover(P,q,this.transform._camera.forward());for(const te of re)P.push(te)}else if(this.castsShadows&&v){const re=r.extendTileCover(P,q,v);for(const te of re)this._shadowCasterTiles[te.key]=!0,P.push(te)}}const j=this._updateRetainedTiles(P);if(Ya(this._source.type)&&P.length!==0){const $={},q={},re=Object.keys(j);for(const oe of re){const ne=j[oe],ye=this._tiles[oe];if(!ye||ye.fadeEndTime&&ye.fadeEndTime<=i.q.now())continue;const Se=this.findLoadedParent(ne,Math.max(ne.overscaledZ-to.maxOverzooming,this._source.minzoom));Se&&(this._addTile(Se.tileID),$[Se.tileID.key]=Se.tileID),q[oe]=ne}const te=P[P.length-1].overscaledZ;for(const oe in this._tiles){const ne=this._tiles[oe];if(j[oe]||!ne.hasData())continue;let ye=ne.tileID;for(;ye.overscaledZ>te;){ye=ye.scaledTo(ye.overscaledZ-1);const Se=this._tiles[ye.key];if(Se&&Se.hasData()&&q[ye.key]){j[oe]=ne.tileID;break}}}for(const oe in $)j[oe]||(this._coveredTiles[oe]=!0,j[oe]=$[oe])}for(const $ in j)this._tiles[$].clearFadeHold();const H=i.bs(this._tiles,j);for(const $ of H){const q=this._tiles[$];q.hasSymbolBuckets&&!q.holdingForFade()?q.setHoldDuration(this.map._fadeDuration):q.hasSymbolBuckets&&!q.symbolFadeFinished()||this._removeTile(+$)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(+r)}_updateRetainedTiles(r){const l={};if(r.length===0)return l;const p={},v=r.reduce((z,j)=>Math.min(z,j.overscaledZ),1/0),w=r[0].overscaledZ,C=Math.max(w-to.maxOverzooming,this._source.minzoom),P=Math.max(w+to.maxUnderzooming,this._source.minzoom),L={};for(const z of r){const j=this._addTile(z);l[z.key]=z,j.hasData()||v<this._source.maxzoom&&(L[z.key]=z)}this._retainLoadedChildren(L,v,P,l);for(const z of r){let j=this._tiles[z.key];if(j.hasData())continue;if(z.canonical.z>=this._source.maxzoom){const $=z.children(this._source.maxzoom)[0],q=this.getTile($);if(q&&q.hasData()){l[$.key]=$;continue}}else{const $=z.children(this._source.maxzoom);if(l[$[0].key]&&l[$[1].key]&&l[$[2].key]&&l[$[3].key])continue}let H=j.wasRequested();for(let $=z.overscaledZ-1;$>=C;--$){const q=z.scaledTo($);if(p[q.key]||(p[q.key]=!0,j=this.getTile(q),!j&&H&&(j=this._addTile(q)),j&&(l[q.key]=q,H=j.wasRequested(),j.hasData())))break}}return l}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const l=[];let p,v=this._tiles[r].tileID;for(;v.overscaledZ>0;){if(v.key in this._loadedParentTiles){p=this._loadedParentTiles[v.key];break}l.push(v.key);const w=v.scaledTo(v.overscaledZ-1);if(p=this._getLoadedTile(w),p)break;v=w}for(const w of l)this._loadedParentTiles[w]=p}}_addTile(r){let l=this._tiles[r.key];if(l)return l.isExtraShadowCaster!==!0||this._shadowCasterTiles[r.key]||this._reloadTile(r.key,"reloading"),l;l=this._cache.getAndRemove(r),l&&(this._setTileReloadTimer(r.key,l),l.tileID=r,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,l)));const p=!!l;if(!p){const v=this.map?this.map.painter:null,w=this._source.tileSize*r.overscaleFactor();l=this._source.type==="raster-array"?new vd(r,w,this.transform.tileZoom,v,this._isRaster):new wl(r,w,this.transform.tileZoom,v,this._isRaster),this._loadTile(l,this._tileLoaded.bind(this,l,r.key,l.state))}return l.uses++,this._tiles[r.key]=l,p||this._source.fire(new i.A("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l}_setTileReloadTimer(r,l){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const p=l.getExpiryTimeout();p&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},p))}_removeTile(r){const l=this._tiles[r];l&&(l.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),l.uses>0||(l.hasData()&&l.state!=="reloading"||l.state==="empty"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(+r);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(r,l,p){const v=[],w=this.transform;if(!w)return v;const C=w.projection.name==="globe",P=i.ay(w.center.lng);for(const L in this._tiles){const z=this._tiles[L];if(p&&z.clearQueryDebugViz(),z.holdingForFade())continue;let j;if(C){const H=z.tileID.canonical;if(H.z===0){const $=[Math.abs(i.aD(P,...la(H,-1))-P),Math.abs(i.aD(P,...la(H,1))-P)];j=[0,2*$.indexOf(Math.min(...$))-1]}else{const $=[Math.abs(i.aD(P,...la(H,-1))-P),Math.abs(i.aD(P,...la(H,0))-P),Math.abs(i.aD(P,...la(H,1))-P)];j=[$.indexOf(Math.min(...$))-1]}}else j=[0];for(const H of j){const $=r.containsTile(z,w,l,H);$&&v.push($)}}return v}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(r){return this._getRenderableCoordinates(r)}_getRenderableCoordinates(r,l){const p=this.getRenderableIds(r,l).map(w=>this._tiles[w].tileID),v=this.transform.projection.name==="globe";for(const w of p)w.projMatrix=this.transform.calculateProjMatrix(w.toUnwrapped()),w.expandedProjMatrix=v?this.transform.calculateProjMatrix(w.toUnwrapped(),!1,!0):w.projMatrix;return p}sortCoordinatesByDistance(r){const l=r.slice(),p=this.transform._camera.position,v=this.transform._camera.forward(),w={};for(const C of l){const P=1/(1<<C.canonical.z);w[C.key]=((C.canonical.x+.5)*P+C.wrap-p[0])*v[0]+((C.canonical.y+.5)*P-p[1])*v[1]-p[2]*v[2]}return l.sort((C,P)=>w[C.key]-w[P.key]),l}hasTransition(){if(this._source.hasTransition())return!0;if(Ya(this._source.type))for(const r in this._tiles){const l=this._tiles[r];if(l.fadeEndTime!==void 0&&l.fadeEndTime>=i.q.now())return!0}return!1}setFeatureState(r,l,p){this._state.updateState(r=r||"_geojsonTileLayer",l,p)}removeFeatureState(r,l,p){this._state.removeFeatureState(r=r||"_geojsonTileLayer",l,p)}getFeatureState(r,l){return this._state.getState(r=r||"_geojsonTileLayer",l)}setDependencies(r,l,p){const v=this._tiles[r];v&&v.setDependencies(l,p)}reloadTilesForDependencies(r,l){for(const p in this._tiles)this._tiles[p].hasDependency(r,l)&&this._reloadTile(+p,"reloading");this._cache.filter(p=>!p.hasDependency(r,l))}_preloadTiles(r,l){if(!this._sourceLoaded){const L=()=>{this._sourceLoaded&&(this._source.off("data",L),this._preloadTiles(r,l))};return void this._source.on("data",L)}const p=new Map,v=Array.isArray(r)?r:[r],w=this.map.painter.terrain,C=this.usedForTerrain&&w?w.getScaledDemTileSize():this._source.tileSize;for(const L of v){const z=L.coveringTiles({tileSize:C,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const j of z)p.set(j.key,j);this.usedForTerrain&&L.updateElevation(!1)}const P=Array.from(p.values());i.bt(P,(L,z)=>{const j=new wl(L,this._source.tileSize*L.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(j,H=>{this._source.type==="raster-dem"&&j.dem&&this._backfillDEM(j),z(H,j)})},l)}}function Ka(f,r){const l=Math.abs(2*f.wrap)-+(f.wrap<0),p=Math.abs(2*r.wrap)-+(r.wrap<0);return f.overscaledZ-r.overscaledZ||p-l||r.canonical.y-f.canonical.y||r.canonical.x-f.canonical.x}function Ya(f){return f==="raster"||f==="image"||f==="video"||f==="custom"}function la(f,r){const l=1<<f.z;return[f.x/l+r,(f.x+1)/l+r]}to.maxOverzooming=10,to.maxUnderzooming=3;class xd{constructor(r){this.style=r,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const r=!1,l=!1;for(const p in this.style._mergedLayers){const v=this.style._mergedLayers[p];if(v.type==="fill-extrusion")this.layers.push({layer:v,visible:r,visibilityChanged:l});else if(v.type==="model"){const w=this.style.getLayerSource(v);w&&w.type==="batched-model"&&this.layers.push({layer:v,visible:r,visibilityChanged:l})}}}onNewFrame(r){this.layersGotHidden=!1;for(const l of this.layers){const p=l.layer;let v=!1;p.type==="fill-extrusion"?v=!p.isHidden(r)&&p.paint.get("fill-extrusion-opacity")>0:p.type==="model"&&(v=!p.isHidden(r)&&p.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!v&&l.visible,l.visible=v}}updateZOffset(r,l){this.currentBuildingBuckets=[];for(const v of this.layers){const w=v.layer,C=this.style.getLayerSourceCache(w);let P=1;w.type==="fill-extrusion"&&(P=v.visible?w.paint.get("fill-extrusion-vertical-scale"):0);let L=C?C.getTile(l):null;if(!L&&C&&l.canonical.z>C.getSource().minzoom){let z=l.scaledTo(Math.min(C.getSource().maxzoom,l.overscaledZ-1));for(;z.overscaledZ>=C.getSource().minzoom&&(L=C.getTile(z),!L&&z.overscaledZ!==0);)z=z.scaledTo(z.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:L?L.getBucket(w):null,tileID:L?L.tileID:l,verticalScale:P})}r.hasAnyZOffset=!1;let p=!1;for(let v=0;v<r.symbolInstances.length;v++){const w=r.symbolInstances.get(v),C=w.zOffset,P=this._getHeightAtTileOffset(l,w.tileAnchorX,w.tileAnchorY);w.zOffset=P!==Number.NEGATIVE_INFINITY?P:C,p||C===w.zOffset||(p=!0),r.hasAnyZOffset||w.zOffset===0||(r.hasAnyZOffset=!0)}p&&(r.zOffsetBuffersNeedUpload=!0,r.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(r,l,p,v){let w=l,C=p;if(r.canonical.z!==v.canonical.z){const P=v.canonical,L=1/(1<<r.canonical.z-P.z);w=(l+r.canonical.x*i.aj)*L-P.x*i.aj|0,C=(p+r.canonical.y*i.aj)*L-P.y*i.aj|0}return{tileX:w,tileY:C}}_getHeightAtTileOffset(r,l,p){let v,w;for(let C=0;C<this.layers.length;++C){if(this.layers[C].layer.type!=="fill-extrusion")continue;const{bucket:P,tileID:L,verticalScale:z}=this.currentBuildingBuckets[C];if(!P)continue;const{tileX:j,tileY:H}=this._mapCoordToOverlappingTile(r,l,p,L),$=P.getHeightAtTileCoord(j,H);$&&$.height!==void 0&&($.hidden?v=$.height:w=Math.max($.height*z,w||0))}if(w!==void 0)return w;for(let C=0;C<this.layers.length;++C){const P=this.layers[C];if(P.layer.type!=="model"||!P.visible)continue;const{bucket:L,tileID:z}=this.currentBuildingBuckets[C];if(!L)continue;const{tileX:j,tileY:H}=this._mapCoordToOverlappingTile(r,l,p,z),$=L.getHeightAtTileCoord(j,H);if($&&!$.hidden)return $.height===void 0&&v!==void 0?Math.min($.maxHeight,v)*$.verticalScale:$.height?$.height*$.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function jc(f,r){const l={};for(const p in f)p!=="ref"&&(l[p]=f[p]);return i.bu.forEach(p=>{p in r&&(l[p]=r[p])}),l}function Ja(f){f=f.slice();const r=Object.create(null);for(let l=0;l<f.length;l++)r[f[l].id]=f[l];for(let l=0;l<f.length;l++)"ref"in f[l]&&(f[l]=jc(f[l],r[f[l].ref]));return f}const Br={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport",addIconset:"addIconset",removeIconset:"removeIconset"};function Au(f,r,l){l.push({command:Br.addSource,args:[f,r[f]]})}function Sl(f,r,l){r.push({command:Br.removeSource,args:[f]}),l[f]=!0}function K_(f,r,l,p){Sl(f,l,p),Au(f,r,l)}function nm(f,r,l){let p;for(p in f[l])if(f[l].hasOwnProperty(p)&&p!=="data"&&!i.bv(f[l][p],r[l][p]))return!1;for(p in r[l])if(r[l].hasOwnProperty(p)&&p!=="data"&&!i.bv(f[l][p],r[l][p]))return!1;return!0}function Cl(f,r,l,p,v,w){let C;for(C in r=r||{},f=f||{})f.hasOwnProperty(C)&&(i.bv(f[C],r[C])||l.push({command:w,args:[p,C,r[C],v]}));for(C in r)r.hasOwnProperty(C)&&!f.hasOwnProperty(C)&&(i.bv(f[C],r[C])||l.push({command:w,args:[p,C,r[C],v]}))}function oc(f){return f.id}function bd(f,r){return f[r.id]=r,f}class wd{constructor(r,l){this.reset(r,l)}reset(r,l){this.points=r||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(l||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=i.aD(r,0,1);let l=1,p=this._distances[l];const v=r*this.paddedLength+this.padding;for(;p<v&&l<this._distances.length;)p=this._distances[++l];const w=l-1,C=this._distances[w],P=p-C,L=P>0?(v-C)/P:0;return this.points[w].mult(1-L).add(this.points[l].mult(L))}}class Ru{constructor(r,l,p){const v=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(r/p),this.yCellCount=Math.ceil(l/p);for(let C=0;C<this.xCellCount*this.yCellCount;C++)v.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=l,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/l,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,l,p,v,w){this._forEachCell(l,p,v,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(l),this.bboxes.push(p),this.bboxes.push(v),this.bboxes.push(w)}insertCircle(r,l,p,v){this._forEachCell(l-v,p-v,l+v,p+v,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(l),this.circles.push(p),this.circles.push(v)}_insertBoxCell(r,l,p,v,w,C){this.boxCells[w].push(C)}_insertCircleCell(r,l,p,v,w,C){this.circleCells[w].push(C)}_query(r,l,p,v,w,C){if(p<0||r>this.width||v<0||l>this.height)return!w&&[];const P=[];if(r<=0&&l<=0&&this.width<=p&&this.height<=v){if(w)return!0;for(let L=0;L<this.boxKeys.length;L++)P.push({key:this.boxKeys[L],x1:this.bboxes[4*L],y1:this.bboxes[4*L+1],x2:this.bboxes[4*L+2],y2:this.bboxes[4*L+3]});for(let L=0;L<this.circleKeys.length;L++){const z=this.circles[3*L],j=this.circles[3*L+1],H=this.circles[3*L+2];P.push({key:this.circleKeys[L],x1:z-H,y1:j-H,x2:z+H,y2:j+H})}return C?P.filter(C):P}return this._forEachCell(r,l,p,v,this._queryCell,P,{hitTest:w,seenUids:{box:{},circle:{}}},C),w?P.length>0:P}_queryCircle(r,l,p,v,w){const C=r-p,P=r+p,L=l-p,z=l+p;if(P<0||C>this.width||z<0||L>this.height)return!v&&[];const j=[];return this._forEachCell(C,L,P,z,this._queryCellCircle,j,{hitTest:v,circle:{x:r,y:l,radius:p},seenUids:{box:{},circle:{}}},w),v?j.length>0:j}query(r,l,p,v,w){return this._query(r,l,p,v,!1,w)}hitTest(r,l,p,v,w){return this._query(r,l,p,v,!0,w)}hitTestCircle(r,l,p,v){return this._queryCircle(r,l,p,!0,v)}_queryCell(r,l,p,v,w,C,P,L){const z=P.seenUids,j=this.boxCells[w];if(j!==null){const $=this.bboxes;for(const q of j)if(!z.box[q]){z.box[q]=!0;const re=4*q;if(r<=$[re+2]&&l<=$[re+3]&&p>=$[re+0]&&v>=$[re+1]&&(!L||L(this.boxKeys[q]))){if(P.hitTest)return C.push(!0),!0;C.push({key:this.boxKeys[q],x1:$[re],y1:$[re+1],x2:$[re+2],y2:$[re+3]})}}}const H=this.circleCells[w];if(H!==null){const $=this.circles;for(const q of H)if(!z.circle[q]){z.circle[q]=!0;const re=3*q;if(this._circleAndRectCollide($[re],$[re+1],$[re+2],r,l,p,v)&&(!L||L(this.circleKeys[q]))){if(P.hitTest)return C.push(!0),!0;{const te=$[re],oe=$[re+1],ne=$[re+2];C.push({key:this.circleKeys[q],x1:te-ne,y1:oe-ne,x2:te+ne,y2:oe+ne})}}}}}_queryCellCircle(r,l,p,v,w,C,P,L){const z=P.circle,j=P.seenUids,H=this.boxCells[w];if(H!==null){const q=this.bboxes;for(const re of H)if(!j.box[re]){j.box[re]=!0;const te=4*re;if(this._circleAndRectCollide(z.x,z.y,z.radius,q[te+0],q[te+1],q[te+2],q[te+3])&&(!L||L(this.boxKeys[re])))return C.push(!0),!0}}const $=this.circleCells[w];if($!==null){const q=this.circles;for(const re of $)if(!j.circle[re]){j.circle[re]=!0;const te=3*re;if(this._circlesCollide(q[te],q[te+1],q[te+2],z.x,z.y,z.radius)&&(!L||L(this.circleKeys[re])))return C.push(!0),!0}}}_forEachCell(r,l,p,v,w,C,P,L){const z=this._convertToXCellCoord(r),j=this._convertToYCellCoord(l),H=this._convertToXCellCoord(p),$=this._convertToYCellCoord(v);for(let q=z;q<=H;q++)for(let re=j;re<=$;re++)if(w.call(this,r,l,p,v,this.xCellCount*re+q,C,P,L))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,l,p,v,w,C){const P=v-r,L=w-l,z=p+C;return z*z>P*P+L*L}_circleAndRectCollide(r,l,p,v,w,C,P){const L=(C-v)/2,z=Math.abs(r-(v+L));if(z>L+p)return!1;const j=(P-w)/2,H=Math.abs(l-(w+j));if(H>j+p)return!1;if(z<=L||H<=j)return!0;const $=z-L,q=H-j;return $*$+q*q<=p*p}}const Ca={unknown:0,flipRequired:1,flipNotRequired:2},Bc=Math.tan(85*Math.PI/180);function Sd(f,r,l,p,v,w,C){const P=i.bz();if(l)if(w.name==="globe"){const L=i.bA(v,r);i.az(P,P,L)}else{const L=i.bB([],C);P[0]=L[0],P[1]=L[1],P[4]=L[2],P[5]=L[3],p||i.by(P,P,v.angle)}else i.az(P,v.labelPlaneMatrix,f);return P}function Ff(f,r,l,p,v,w,C){const P=Sd(f,r,l,p,v,w,C);return w.name==="globe"&&l||(P[2]=P[6]=P[10]=P[14]=0),P}function Dh(f,r,l,p,v,w,C){if(l){if(w.name==="globe"){const P=Sd(f,r,l,p,v,w,C);return i.bi(P,P),i.az(P,f,P),P}{const P=i.bw(f),L=i.bx([]);return L[0]=C[0],L[1]=C[1],L[4]=C[2],L[5]=C[3],i.az(P,P,L),p||i.by(P,P,-v.angle),P}}return v.glCoordMatrix}function bo(f,r,l,p){const v=[f,r,l,1];l?i.aA(v,v,p):Lu(v,v,p);const w=v[3];return v[0]/=w,v[1]/=w,v[2]/=w,v}function Tl(f,r){return Math.min(.5+f/r*.5,1.5)}function Nf(f,r){const l=f[0]/f[3],p=f[1]/f[3];return l>=-r[0]&&l<=r[0]&&p>=-r[1]&&p<=r[1]}function El(f,r,l,p,v,w,C,P,L,z){const j=l.transform,H=p?f.textSizeData:f.iconSizeData,$=i.bH(H,l.transform.zoom),q=j.projection.name==="globe",re=[256/l.width*2+1,256/l.height*2+1],te=p?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;te.clear();let oe=null;q&&(oe=p?f.text.globeExtVertexArray:f.icon.globeExtVertexArray);const ne=f.lineVertexArray,ye=p?f.text.placedSymbolArray:f.icon.placedSymbolArray,Se=l.transform.width/l.transform.height;let Te,ke=!1;for(let De=0;De<ye.length;De++){const Me=ye.get(De),{numGlyphs:Pe,writingMode:Oe}=Me;if(Oe!==i.bI.vertical||ke||Te===i.bI.horizontal||(ke=!0),Te=Oe,(Me.hidden||Oe===i.bI.vertical)&&!ke){xr(Pe,te);continue}ke=!1;const Ne=new i.P(Me.tileAnchorX,Me.tileAnchorY);let{x:ht,y:rt,z:Tt}=j.projection.projectTilePoint(Ne.x,Ne.y,z.canonical);if(L){const[pn,bn,rn]=L(Ne);ht+=pn,rt+=bn,Tt+=rn}const It=[ht,rt,Tt,1];if(i.aA(It,It,r),!Nf(It,re)){xr(Pe,te);continue}const Ht=It[3],Qe=Tl(l.transform.getCameraToCenterDistance(j.projection),Ht),dt=i.bJ(H,$,Me),Je=C?dt/Qe:dt*Qe,Dt=bo(ht,rt,Tt,v);if(Dt[3]<=0){xr(Pe,te);continue}let mt={};const Ot=i.al(f.layers[0].layout.get("text-max-angle")),Mt=Math.cos(Ot),Nt=C?null:L,Vt=Go(Me,Je,!1,P,r,v,w,f.glyphOffsetArray,ne,te,oe,Dt,Ne,mt,Se,Nt,j.projection,z,C,Mt);ke=Vt.useVertical,Nt&&Vt.needsFlipping&&(mt={}),(Vt.notEnoughRoom||ke||Vt.needsFlipping&&Go(Me,Je,!0,P,r,v,w,f.glyphOffsetArray,ne,te,oe,Dt,Ne,mt,Se,Nt,j.projection,z,C,Mt).notEnoughRoom)&&xr(Pe,te)}p?(f.text.dynamicLayoutVertexBuffer.updateData(te),oe&&f.text.globeExtVertexBuffer&&f.text.globeExtVertexBuffer.updateData(oe)):(f.icon.dynamicLayoutVertexBuffer.updateData(te),oe&&f.icon.globeExtVertexBuffer&&f.icon.globeExtVertexBuffer.updateData(oe))}function Cd(f,r,l,p,v,w,C,P,L,z,j,H,$,q,re,te,oe){const{lineStartIndex:ne,glyphStartIndex:ye,segment:Se}=P,Te=ye+P.numGlyphs,ke=ne+P.lineLength,De=r.getoffsetX(ye),Me=r.getoffsetX(Te-1),Pe=Ed(f*De,l,p,v,w,C,Se,ne,ke,L,z,j,H,$,!0,q,re,te,oe);if(!Pe)return null;const Oe=Ed(f*Me,l,p,v,w,C,Se,ne,ke,L,z,j,H,$,!0,q,re,te,oe);return Oe?{first:Pe,last:Oe}:null}function Il(f,r,l,p){return f===i.bI.horizontal&&Math.abs(p)>Math.abs(l)?{useVertical:!0}:f===i.bI.vertical?p>0?{needsFlipping:!0}:null:r!==Ca.unknown&&function(v,w){return v===0||Math.abs(w/v)>Bc}(l,p)?r===Ca.flipRequired?{needsFlipping:!0}:null:l<0?{needsFlipping:!0}:null}function Go(f,r,l,p,v,w,C,P,L,z,j,H,$,q,re,te,oe,ne,ye,Se){const Te=r/24,ke=f.lineOffsetX*Te,De=f.lineOffsetY*Te,{lineStartIndex:Me,glyphStartIndex:Pe,numGlyphs:Oe,segment:Ne,writingMode:ht,flipState:rt}=f,Tt=Me+f.lineLength,It=Ht=>{if(j){const[Dt,mt,Ot]=Ht.up,Mt=z.length;i.bK(j,Mt+0,Dt,mt,Ot),i.bK(j,Mt+1,Dt,mt,Ot),i.bK(j,Mt+2,Dt,mt,Ot),i.bK(j,Mt+3,Dt,mt,Ot)}const[Qe,dt,Je]=Ht.point;i.bL(z,Qe,dt,Je,Ht.angle)};if(Oe>1){const Ht=Cd(Te,P,ke,De,l,H,$,f,L,w,q,te,!1,oe,ne,ye,Se);if(!Ht)return{notEnoughRoom:!0};if(p&&!l){let[Qe,dt,Je]=Ht.first.point,[Dt,mt,Ot]=Ht.last.point;[Qe,dt]=bo(Qe,dt,Je,C),[Dt,mt]=bo(Dt,mt,Ot,C);const Mt=Il(ht,rt,(Dt-Qe)*re,mt-dt);if(f.flipState=Mt&&Mt.needsFlipping?Ca.flipRequired:Ca.flipNotRequired,Mt)return Mt}It(Ht.first);for(let Qe=Pe+1;Qe<Pe+Oe-1;Qe++){const dt=Ed(Te*P.getoffsetX(Qe),ke,De,l,H,$,Ne,Me,Tt,L,w,q,te,!1,!1,oe,ne,ye,Se);if(!dt)return z.length-=4*(Qe-Pe),{notEnoughRoom:!0};It(dt)}It(Ht.last)}else{if(p&&!l){const Qe=bo($.x,$.y,0,v),dt=Me+Ne+1,Je=new i.P(L.getx(dt),L.gety(dt)),Dt=bo(Je.x,Je.y,0,v),mt=Dt[3]>0?Dt:Mu($,Je,Qe,1,v,void 0,oe,ne.canonical),Ot=Il(ht,rt,(mt[0]-Qe[0])*re,mt[1]-Qe[1]);if(f.flipState=Ot&&Ot.needsFlipping?Ca.flipRequired:Ca.flipNotRequired,Ot)return Ot}const Ht=Ed(Te*P.getoffsetX(Pe),ke,De,l,H,$,Ne,Me,Tt,L,w,q,te,!1,!1,oe,ne,ye,Se);if(!Ht)return{notEnoughRoom:!0};It(Ht)}return{}}function Td(f,r,l,p,v){const{x:w,y:C,z:P}=p.projectTilePoint(f.x,f.y,r);if(!v)return bo(w,C,P,l);const[L,z,j]=v(f);return bo(w+L,C+z,P+j,l)}function Mu(f,r,l,p,v,w,C,P){const L=Td(f.sub(r)._unit()._add(f),P,v,C,w);return i.at(L,l,L),i.au(L,L),i.bF(L,l,L,p)}function Ed(f,r,l,p,v,w,C,P,L,z,j,H,$,q,re,te,oe,ne,ye){const Se=p?f-r:f+r;let Te=Se>0?1:-1,ke=0;p&&(Te*=-1,ke=Math.PI),Te<0&&(ke+=Math.PI);let De=P+C+(Te>0?0:1)|0,Me=v,Pe=v,Oe=0,Ne=0;const ht=Math.abs(Se),rt=[],Tt=[];let It=w,Ht=It,Qe=i.bC([]);const dt=()=>Mu(Ht,It,Pe,ht-Oe+1,j,$,te,oe.canonical);for(;Oe+Ne<=ht;){if(De+=Te,De<P||De>=L)return null;if(Pe=Me,Ht=It,rt.push(Pe),q&&Tt.push(Ht),It=new i.P(z.getx(De),z.gety(De)),Me=H[De],!Me){const rn=Td(It,oe.canonical,j,te,$);Me=rn[3]>0?H[De]=rn:dt()}Oe+=Ne;const pn=i.at([],Me,Pe),bn=i.bD(Pe,Me);if(l&&bn>0&&Ne>0&&i.bE(Qe,pn)/(Ne*bn)<ye)return null;Ne=bn,Qe=pn}re&&$&&(H[De]&&(Me=dt(),Ne=i.bD(Pe,Me),Qe=i.at([],Me,Pe)),H[De]=Me);const Je=(ht-Oe)/Ne,Dt=It.sub(Ht)._mult(Je)._add(Ht),mt=i.bF([],Pe,Qe,Je);let Ot=[0,0,1],Mt=Qe[0],Nt=Qe[1];if(ne&&(Ot=te.upVector(oe.canonical,Dt.x,Dt.y),Ot[0]!==0||Ot[1]!==0||Ot[2]!==1)){const pn=[Ot[2],0,-Ot[0]],bn=i.bG([],Ot,pn);i.au(pn,pn),i.au(bn,bn),Mt=i.bE(Qe,pn),Nt=i.bE(Qe,bn)}if(l){const pn=i.bG([],Ot,Qe);i.au(pn,pn),i.bF(mt,mt,pn,l*Te)}const Vt=ke+Math.atan2(Nt,Mt);return rt.push(mt),q&&Tt.push(Dt),{point:mt,angle:Vt,path:rt,tilePath:Tt,up:Ot}}function xr(f,r){const l=r.length,p=l+4*f;r.resize(p),r.float32.fill(-1/0,4*l,4*p)}function Lu(f,r,l){const p=r[0],v=r[1];return f[0]=l[0]*p+l[4]*v+l[12],f[1]=l[1]*p+l[5]*v+l[13],f[3]=l[3]*p+l[7]*v+l[15],f}const kn=100;class Id{constructor(r,l,p=new Ru(r.width+200,r.height+200,25),v=new Ru(r.width+200,r.height+200,25)){this.transform=r,this.grid=p,this.ignoredGrid=v,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+kn,this.screenBottomBoundary=r.height+kn,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.fogState=l}placeCollisionBox(r,l,p,v,w,C,P,L){let z=p.projectedAnchorX,j=p.projectedAnchorY,H=p.projectedAnchorZ;const $=p.elevation,q=p.tileID,re=r.getProjection();if($&&q){const[De,Me,Pe]=re.upVector(q.canonical,p.tileAnchorX,p.tileAnchorY),Oe=re.upVectorScale(q.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;z+=De*$*Oe,j+=Me*$*Oe,H+=Pe*$*Oe}const te=this.projectAndGetPerspectiveRatio(P,z,j,H,p.tileID,re.name==="globe"||!!$||this.transform.pitch>0,re),oe=C*te.perspectiveRatio,ne=(p.x1*l+v.x-p.padding)*oe+te.point.x,ye=(p.y1*l+v.y-p.padding)*oe+te.point.y,Se=(p.x2*l+v.x+p.padding)*oe+te.point.x,Te=(p.y2*l+v.y+p.padding)*oe+te.point.y,ke=te.perspectiveRatio<=.55||te.occluded;return!this.isInsideGrid(ne,ye,Se,Te)||!w&&this.grid.hitTest(ne,ye,Se,Te,L)||ke?{box:[],offscreen:!1,occluded:te.occluded}:{box:[ne,ye,Se,Te],offscreen:this.isOffscreen(ne,ye,Se,Te),occluded:!1}}placeCollisionCircles(r,l,p,v,w,C,P,L,z,j,H,$,q,re,te){const oe=[],ne=this.transform.elevation,ye=r.getProjection(),Se=ne?ne.getAtTileOffsetFunc(te,this.transform.center.lat,this.transform.worldSize,ye):null,Te=new i.P(p.tileAnchorX,p.tileAnchorY);let{x:ke,y:De,z:Me}=ye.projectTilePoint(Te.x,Te.y,te.canonical);if(Se){const[Ot,Mt,Nt]=Se(Te);ke+=Ot,De+=Mt,Me+=Nt}const Pe=ye.name==="globe",Oe=this.projectAndGetPerspectiveRatio(P,ke,De,Me,te,Pe||!!ne||this.transform.pitch>0,ye),{perspectiveRatio:Ne}=Oe,ht=(H?C/Ne:C*Ne)/i.bO,rt=bo(ke,De,Me,L),Tt=p.lineOffsetX*ht,It=p.lineOffsetY*ht,Ht=i.al(r.layers[0].layout.get("text-max-angle")),Qe=Math.cos(Ht),dt=Oe.signedDistanceFromCamera>0?Cd(ht,w,Tt,It,!1,rt,Te,p,v,L,{},ne&&!H?Se:null,H&&!!ne,ye,te,H,Qe):null;let Je=!1,Dt=!1,mt=!0;if(dt&&!Oe.occluded){const Ot=.5*q*Ne+re,Mt=new i.P(-100,-100),Nt=new i.P(this.screenRightBoundary,this.screenBottomBoundary),Vt=new wd,{first:pn,last:bn}=dt,rn=pn.path.length;let vn=[];for(let Hn=rn-1;Hn>=1;Hn--)vn.push(pn.path[Hn]);for(let Hn=1;Hn<bn.path.length;Hn++)vn.push(bn.path[Hn]);const dn=2.5*Ot;z&&(vn=vn.map(([Hn,dr,ri],ii)=>(Se&&!Pe&&(ri=Se(ii<rn-1?pn.tilePath[rn-1-ii]:bn.tilePath[ii-rn+2])[2]),bo(Hn,dr,ri,z))),vn.some(Hn=>Hn[3]<=0)&&(vn=[]));let Rn=[];if(vn.length>0){let Hn=1/0,dr=-1/0,ri=1/0,ii=-1/0;for(const tr of vn)Hn=Math.min(Hn,tr[0]),ri=Math.min(ri,tr[1]),dr=Math.max(dr,tr[0]),ii=Math.max(ii,tr[1]);dr>=Mt.x&&Hn<=Nt.x&&ii>=Mt.y&&ri<=Nt.y&&(Rn=[vn.map(tr=>new i.P(tr[0],tr[1]))],(Hn<Mt.x||dr>Nt.x||ri<Mt.y||ii>Nt.y)&&(Rn=i.bM(Rn,Mt.x,Mt.y,Nt.x,Nt.y)))}for(const Hn of Rn){Vt.reset(Hn,.25*Ot);let dr=0;dr=Vt.length<=.5*Ot?1:Math.ceil(Vt.paddedLength/dn)+1;for(let ri=0;ri<dr;ri++){const ii=ri/Math.max(dr-1,1),tr=Vt.lerp(ii),Hi=tr.x+kn,Pi=tr.y+kn;oe.push(Hi,Pi,Ot,0);const Gn=Hi-Ot,Cr=Pi-Ot,Tr=Hi+Ot,si=Pi+Ot;if(mt=mt&&this.isOffscreen(Gn,Cr,Tr,si),Dt=Dt||this.isInsideGrid(Gn,Cr,Tr,si),!l&&this.grid.hitTestCircle(Hi,Pi,Ot,$)&&(Je=!0,!j))return{circles:[],offscreen:!1,collisionDetected:Je,occluded:!1}}}}return{circles:!j&&Je||!Dt?[]:oe,offscreen:mt,collisionDetected:Je,occluded:Oe.occluded}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const l=[];let p=1/0,v=1/0,w=-1/0,C=-1/0;for(const j of r){const H=new i.P(j.x+kn,j.y+kn);p=Math.min(p,H.x),v=Math.min(v,H.y),w=Math.max(w,H.x),C=Math.max(C,H.y),l.push(H)}const P=this.grid.query(p,v,w,C).concat(this.ignoredGrid.query(p,v,w,C)),L={},z={};for(const j of P){const H=j.key;if(L[H.bucketInstanceId]===void 0&&(L[H.bucketInstanceId]={}),L[H.bucketInstanceId][H.featureIndex])continue;const $=[new i.P(j.x1,j.y1),new i.P(j.x2,j.y1),new i.P(j.x2,j.y2),new i.P(j.x1,j.y2)];i.bN(l,$)&&(L[H.bucketInstanceId][H.featureIndex]=!0,z[H.bucketInstanceId]===void 0&&(z[H.bucketInstanceId]=[]),z[H.bucketInstanceId].push(H.featureIndex))}return z}insertCollisionBox(r,l,p,v,w){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:v,collisionGroupID:w},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,l,p,v,w){const C=l?this.ignoredGrid:this.grid,P={bucketInstanceId:p,featureIndex:v,collisionGroupID:w};for(let L=0;L<r.length;L+=4)C.insertCircle(P,r[L],r[L+1],r[L+2])}projectAndGetPerspectiveRatio(r,l,p,v,w,C,P){const L=[l,p,v,1];let z=!1;v||this.transform.pitch>0?(i.aA(L,L,r),this.fogState&&w&&P.name!=="globe"&&(z=function($,q,re,te,oe,ne){const ye=ne.calculateFogTileMatrix(oe),Se=[q,re,te];return i.ad(Se,Se,ye),xn($,i.ae(Se),ne.pitch,ne._fov)}(this.fogState,l,p,v,w.toUnwrapped(),this.transform)>.9)):Lu(L,L,r);const j=L[3];return{point:new i.P((L[0]/j+1)/2*this.transform.width+kn,(-L[1]/j+1)/2*this.transform.height+kn),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(P)/j*.5,1.5),signedDistanceFromCamera:j,occluded:C&&L[2]>j||z}}isOffscreen(r,l,p,v){return p<kn||r>=this.screenRightBoundary||v<kn||l>this.screenBottomBoundary}isInsideGrid(r,l,p,v){return p>=0&&r<this.gridRightBoundary&&v>=0&&l<this.gridBottomBoundary}getViewportMatrix(){const r=i.bx([]);return i.bo(r,r,[-100,-100,0]),r}}function jf(f,r,l){const p=r.createTileMatrix(f,f.worldSize,l.toUnwrapped());return i.az(new Float32Array(16),f.projMatrix,p)}function Pd(f,r,l){if(r.projection.name===l.projection.name)return f.projMatrix;const p=l.clone();return p.setProjection(r.projection),jf(p,r.getProjection(),f)}function Du(f,r,l){return r.name===l.projection.name?f.projMatrix:jf(l,r,f)}class ko{constructor(r,l,p,v){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?l:-l))):v&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class Pl{constructor(r,l,p,v,w,C=!1){this.text=new ko(r?r.text:null,l,p,w),this.icon=new ko(r?r.icon:null,l,v,w),this.clipped=C}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ac{constructor(r,l,p,v=!1){this.text=r,this.icon=l,this.skipFade=p,this.clipped=v}}class Pn{constructor(){this.invProjMatrix=i.bz(),this.viewportMatrix=i.bz(),this.circles=[]}}class ui{constructor(r,l,p,v,w){this.bucketInstanceId=r,this.featureIndex=l,this.sourceLayerIndex=p,this.bucketIndex=v,this.tileID=w}}class ti{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const l=++this.maxGroupID;this.collisionGroups[r]={ID:l,predicate:p=>p.collisionGroupID===l}}return this.collisionGroups[r]}}function wo(f,r,l,p,v){const{horizontalAlign:w,verticalAlign:C}=i.bV(f),P=-(w-.5)*r,L=-(C-.5)*l,z=i.bU(f,p);return new i.P(P+z[0]*v,L+z[1]*v)}function Vc(f,r,l,p,v){const w=new i.P(f,r);return l&&w._rotate(p?v:-v),w}class Jr{constructor(r,l,p,v,w,C){this.transform=r.clone(),this.projection=r.projection.name,this.collisionIndex=new Id(this.transform,w),this.buildingIndex=C,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new ti(p),this.collisionCircleArrays={},this.prevPlacement=v,v&&(v.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,l,p,v,w=1){const C=p.getBucket(l),P=p.latestFeatureIndex;if(!C||!P||l.fqid!==C.layerIds[0])return;const L=C.layers[0].layout,z=C.layers[0].paint,j=p.collisionBoxArray,H=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),$=p.tileSize/i.aj,q=p.tileID.toUnwrapped();this.transform.setProjection(C.projection);const re=(te=p.tileID,oe=C.getProjection(),ne=this.transform,oe.name===this.projection?ne.calculateProjMatrix(te.toUnwrapped()):jf(ne,oe,te));var te,oe,ne;const ye=L.get("text-pitch-alignment")==="map",Se=L.get("text-rotation-alignment")==="map";l.compileFilter(l.options);const Te=l.dynamicFilter(),ke=l.dynamicFilterNeedsFeature(),De=this.transform.calculatePixelsToTileUnitsMatrix(p),Me=Ff(re,p.tileID.canonical,ye,Se,this.transform,C.getProjection(),De);let Pe=null;if(ye){const dt=Dh(re,p.tileID.canonical,ye,Se,this.transform,C.getProjection(),De);Pe=i.az([],this.transform.labelPlaneMatrix,dt)}let Oe=null;Te&&p.latestFeatureIndex&&(Oe={unwrappedTileID:q,dynamicFilter:Te,dynamicFilterNeedsFeature:ke}),this.retainedQueryData[C.bucketInstanceId]=new ui(C.bucketInstanceId,P,C.sourceLayerIndex,C.index,p.tileID);const[Ne,ht]=C.layers[0].layout.get("text-size-scale-range"),rt=i.aD(w,Ne,ht),[Tt,It]=L.get("icon-size-scale-range"),Ht=i.aD(w,Tt,It),Qe={bucket:C,layout:L,paint:z,posMatrix:re,textLabelPlaneMatrix:Me,labelToScreenMatrix:Pe,clippingData:Oe,scale:H,textPixelRatio:$,holdingForFade:p.holdingForFade(),collisionBoxArray:j,partiallyEvaluatedTextSize:i.bH(C.textSizeData,this.transform.zoom,rt),partiallyEvaluatedIconSize:i.bH(C.iconSizeData,this.transform.zoom,Ht),collisionGroup:this.collisionGroups.get(C.sourceID),latestFeatureIndex:p.latestFeatureIndex};if(v)for(const dt of C.sortKeyRanges){const{sortKey:Je,symbolInstanceStart:Dt,symbolInstanceEnd:mt}=dt;r.push({sortKey:Je,symbolInstanceStart:Dt,symbolInstanceEnd:mt,parameters:Qe})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:C.symbolInstances.length,parameters:Qe})}attemptAnchorPlacement(r,l,p,v,w,C,P,L,z,j,H,$,q,re,te,oe,ne,ye){const{textOffset0:Se,textOffset1:Te,crossTileID:ke}=$,De=[Se,Te],Me=wo(r,p,v,De,w),Pe=this.collisionIndex.placeCollisionBox(re,w,l,Vc(Me.x,Me.y,C,P,this.transform.angle),H,L,z,j.predicate);if(oe){const Oe=re.getSymbolInstanceIconSize(ye,this.transform.zoom,$.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(re,Oe,oe,Vc(Me.x,Me.y,C,P,this.transform.angle),H,L,z,j.predicate).box.length===0)return}if(Pe.box.length>0){let Oe;return this.prevPlacement&&this.prevPlacement.variableOffsets[ke]&&this.prevPlacement.placements[ke]&&this.prevPlacement.placements[ke].text&&(Oe=this.prevPlacement.variableOffsets[ke].anchor),this.variableOffsets[ke]={textOffset:De,width:p,height:v,anchor:r,textScale:w,prevAnchor:Oe},this.markUsedJustification(re,r,$,te),re.allowVerticalPlacement&&(this.markUsedOrientation(re,te,$),this.placedOrientations[ke]=te),{shift:Me,placedGlyphBoxes:Pe}}}placeLayerBucketPart(r,l,p,v,w=1){const{bucket:C,layout:P,paint:L,posMatrix:z,textLabelPlaneMatrix:j,labelToScreenMatrix:H,clippingData:$,textPixelRatio:q,holdingForFade:re,collisionBoxArray:te,partiallyEvaluatedTextSize:oe,partiallyEvaluatedIconSize:ne,collisionGroup:ye,latestFeatureIndex:Se}=r.parameters,Te=P.get("text-optional"),ke=P.get("icon-optional"),De=P.get("text-allow-overlap"),Me=P.get("icon-allow-overlap"),Pe=P.get("text-rotation-alignment")==="map",Oe=P.get("text-pitch-alignment")==="map",Ne=L.get("symbol-z-offset"),ht=P.get("symbol-elevation-reference")==="sea",[rt,Tt]=P.get("text-size-scale-range"),[It,Ht]=P.get("icon-size-scale-range"),Qe=i.aD(w,rt,Tt),dt=i.aD(w,It,Ht);this.transform.setProjection(C.projection);let Je=De&&(Me||!C.hasIconData()||ke),Dt=Me&&(De||!C.hasTextData()||Te);const mt=!Ne.isConstant();!C.collisionArrays&&te&&C.deserializeCollisionBoxes(te),p&&v&&C.updateCollisionDebugBuffers(this.transform.zoom,te,Qe,dt);const Ot=(Mt,Nt,Vt)=>{const{crossTileID:pn,numVerticalGlyphVertices:bn}=Mt;let rn=null;if($&&$.dynamicFilterNeedsFeature||mt){const zr=this.retainedQueryData[C.bucketInstanceId];rn=Se.loadFeature({featureIndex:Mt.featureIndex,bucketIndex:zr.bucketIndex,sourceLayerIndex:zr.sourceLayerIndex,layoutVertexArrayOffset:0})}if($&&!(0,$.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},rn,this.retainedQueryData[C.bucketInstanceId].tileID.canonical,new i.P(Mt.tileAnchorX,Mt.tileAnchorY),this.transform.calculateDistanceTileData($.unwrappedTileID)))return this.placements[pn]=new ac(!1,!1,!1,!0),void l.add(pn);const vn=Ne.evaluate(rn,{});if(l.has(pn))return;if(re)return void(this.placements[pn]=new ac(!1,!1,!1));let dn=!1,Rn=!1,Hn=!0,dr=!1,ri=!1,ii=null,tr={box:null,offscreen:null,occluded:null},Hi={box:null},Pi=null,Gn=null,Cr=null,Tr=0,si=0,ys=0;Vt.textFeatureIndex?Tr=Vt.textFeatureIndex:Mt.useRuntimeCollisionCircles&&(Tr=Mt.featureIndex),Vt.verticalTextFeatureIndex&&(si=Vt.verticalTextFeatureIndex);const Gi=zr=>{zr.tileID=this.retainedQueryData[C.bucketInstanceId].tileID;const ai=this.transform.elevation;zr.elevation=ht?vn:vn+(ai?ai.getAtTileOffset(zr.tileID,zr.tileAnchorX,zr.tileAnchorY):0),zr.elevation+=Mt.zOffset},ns=Vt.textBox;if(ns){Gi(ns);const zr=Xr=>{let hi=i.bI.horizontal;if(C.allowVerticalPlacement&&!Xr&&this.prevPlacement){const Fs=this.prevPlacement.placedOrientations[pn];Fs&&(this.placedOrientations[pn]=Fs,hi=Fs,this.markUsedOrientation(C,hi,Mt))}return hi},ai=(Xr,hi)=>{if(C.allowVerticalPlacement&&bn>0&&Vt.verticalTextBox){for(const Fs of C.writingModes)if(Fs===i.bI.vertical?(tr=hi(),Hi=tr):tr=Xr(),tr&&tr.box&&tr.box.length)break}else tr=Xr()};if(P.get("text-variable-anchor")){let Xr=P.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[pn]){const br=this.prevPlacement.variableOffsets[pn];Xr.indexOf(br.anchor)>0&&(Xr=Xr.filter(Ks=>Ks!==br.anchor),Xr.unshift(br.anchor))}const hi=(br,Ks,ls)=>{const oo=C.getSymbolInstanceTextSize(oe,Mt,this.transform.zoom,Nt),ll=(br.x2-br.x1)*oo+2*br.padding,Wl=(br.y2-br.y1)*oo+2*br.padding,Jo=Mt.hasIconTextFit&&!Me?Ks:null;Jo&&Gi(Jo);let Fa={box:[],offscreen:!1,occluded:!1};const Bs=De?2*Xr.length:Xr.length;for(let Na=0;Na<Bs;++Na){const cl=this.attemptAnchorPlacement(Xr[Na%Xr.length],br,ll,Wl,oo,Pe,Oe,q,z,ye,Na>=Xr.length,Mt,Nt,C,ls,Jo,oe,ne);if(cl&&(Fa=cl.placedGlyphBoxes,Fa&&Fa.box&&Fa.box.length)){dn=!0,ii=cl.shift;break}}return Fa};ai(()=>hi(ns,Vt.iconBox,i.bI.horizontal),()=>{const br=Vt.verticalTextBox;return br&&Gi(br),C.allowVerticalPlacement&&!(tr&&tr.box&&tr.box.length)&&bn>0&&br?hi(br,Vt.verticalIconBox,i.bI.vertical):{box:null,offscreen:null,occluded:null}}),tr&&(dn=tr.box,Hn=tr.offscreen,dr=tr.occluded);const Fs=zr(!(!tr||!tr.box));if(!dn&&this.prevPlacement){const br=this.prevPlacement.variableOffsets[pn];br&&(this.variableOffsets[pn]=br,this.markUsedJustification(C,br.anchor,Mt,Fs))}}else{const Xr=(hi,Fs)=>{const br=C.getSymbolInstanceTextSize(oe,Mt,this.transform.zoom,Nt,w),Ks=this.collisionIndex.placeCollisionBox(C,br,hi,new i.P(0,0),De,q,z,ye.predicate);return Ks&&Ks.box&&Ks.box.length&&(this.markUsedOrientation(C,Fs,Mt),this.placedOrientations[pn]=Fs),Ks};ai(()=>Xr(ns,i.bI.horizontal),()=>{const hi=Vt.verticalTextBox;return C.allowVerticalPlacement&&bn>0&&hi?(Gi(hi),Xr(hi,i.bI.vertical)):{box:null,offscreen:null,occluded:null}}),zr(!!(tr&&tr.box&&tr.box.length))}}if(Pi=tr,dn=Pi&&Pi.box&&Pi.box.length>0,Hn=Pi&&Pi.offscreen,dr=Pi&&Pi.occluded,Mt.useRuntimeCollisionCircles){const zr=C.text.placedSymbolArray.get(Mt.centerJustifiedTextSymbolIndex>=0?Mt.centerJustifiedTextSymbolIndex:Mt.verticalPlacedTextSymbolIndex),ai=i.bJ(C.textSizeData,oe,zr),Xr=P.get("text-padding");Gn=this.collisionIndex.placeCollisionCircles(C,De,zr,C.lineVertexArray,C.glyphOffsetArray,ai,z,j,H,p,Oe,ye.predicate,Mt.collisionCircleDiameter*ai/i.bO,Xr,this.retainedQueryData[C.bucketInstanceId].tileID),dn=De||Gn.circles.length>0&&!Gn.collisionDetected,Hn=Hn&&Gn.offscreen,dr=Gn.occluded}if(Vt.iconFeatureIndex&&(ys=Vt.iconFeatureIndex),Vt.iconBox){const zr=ai=>{Gi(ai);const Xr=Mt.hasIconTextFit&&ii?Vc(ii.x,ii.y,Pe,Oe,this.transform.angle):new i.P(0,0),hi=C.getSymbolInstanceIconSize(ne,this.transform.zoom,Mt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(C,hi,ai,Xr,Me,q,z,ye.predicate)};Hi&&Hi.box&&Hi.box.length&&Vt.verticalIconBox?(Cr=zr(Vt.verticalIconBox),Rn=Cr.box.length>0):(Cr=zr(Vt.iconBox),Rn=Cr.box.length>0),Hn=Hn&&Cr.offscreen,ri=Cr.occluded}const Oi=Te||Mt.numHorizontalGlyphVertices===0&&bn===0,nr=ke||Mt.numIconVertices===0;if(Oi||nr?nr?Oi||(Rn=Rn&&dn):dn=Rn&&dn:Rn=dn=Rn&&dn,dn&&Pi&&Pi.box&&this.collisionIndex.insertCollisionBox(Pi.box,P.get("text-ignore-placement"),C.bucketInstanceId,Hi&&Hi.box&&si?si:Tr,ye.ID),Rn&&Cr&&this.collisionIndex.insertCollisionBox(Cr.box,P.get("icon-ignore-placement"),C.bucketInstanceId,ys,ye.ID),Gn&&(dn&&this.collisionIndex.insertCollisionCircles(Gn.circles,P.get("text-ignore-placement"),C.bucketInstanceId,Tr,ye.ID),p)){const zr=C.bucketInstanceId;let ai=this.collisionCircleArrays[zr];ai===void 0&&(ai=this.collisionCircleArrays[zr]=new Pn);for(let Xr=0;Xr<Gn.circles.length;Xr+=4)ai.circles.push(Gn.circles[Xr+0]),ai.circles.push(Gn.circles[Xr+1]),ai.circles.push(Gn.circles[Xr+2]),ai.circles.push(Gn.collisionDetected?1:0)}const Si=C.projection.name!=="globe";Je=Je&&(Si||!dr),Dt=Dt&&(Si||!ri),this.placements[pn]=new ac(dn||Je,Rn||Dt,Hn||C.justReloaded),l.add(pn)};if(C.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(C,this.retainedQueryData[C.bucketInstanceId].tileID),C.elevationType==="road"&&C.updateRoadElevation(),C.updateZOffset(),C.sortFeaturesByY){const Mt=C.getSortedSymbolIndexes(this.transform.angle);for(let Nt=Mt.length-1;Nt>=0;--Nt){const Vt=Mt[Nt];Ot(C.symbolInstances.get(Vt),Vt,C.collisionArrays[Vt])}C.hasAnyZOffset&&i.w(`${C.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(C.hasAnyZOffset){const Mt=C.getSortedIndexesByZOffset();for(let Nt=0;Nt<Mt.length;++Nt){const Vt=Mt[Nt];Ot(C.symbolInstances.get(Vt),Vt,C.collisionArrays[Vt])}}else for(let Mt=r.symbolInstanceStart;Mt<r.symbolInstanceEnd;Mt++)Ot(C.symbolInstances.get(Mt),Mt,C.collisionArrays[Mt]);if(p&&C.bucketInstanceId in this.collisionCircleArrays){const Mt=this.collisionCircleArrays[C.bucketInstanceId];i.bi(Mt.invProjMatrix,z),Mt.viewportMatrix=this.collisionIndex.getViewportMatrix()}C.justReloaded=!1}markUsedJustification(r,l,p,v){const{leftJustifiedTextSymbolIndex:w,centerJustifiedTextSymbolIndex:C,rightJustifiedTextSymbolIndex:P,verticalPlacedTextSymbolIndex:L,crossTileID:z}=p,j=i.bT(l),H=v===i.bI.vertical?L:j==="left"?w:j==="center"?C:j==="right"?P:-1;w>=0&&(r.text.placedSymbolArray.get(w).crossTileID=H>=0&&w!==H?0:z),C>=0&&(r.text.placedSymbolArray.get(C).crossTileID=H>=0&&C!==H?0:z),P>=0&&(r.text.placedSymbolArray.get(P).crossTileID=H>=0&&P!==H?0:z),L>=0&&(r.text.placedSymbolArray.get(L).crossTileID=H>=0&&L!==H?0:z)}markUsedOrientation(r,l,p){const v=l===i.bI.horizontal||l===i.bI.horizontalOnly?l:0,w=l===i.bI.vertical?l:0,{leftJustifiedTextSymbolIndex:C,centerJustifiedTextSymbolIndex:P,rightJustifiedTextSymbolIndex:L,verticalPlacedTextSymbolIndex:z}=p,j=r.text.placedSymbolArray;C>=0&&(j.get(C).placedOrientation=v),P>=0&&(j.get(P).placedOrientation=v),L>=0&&(j.get(L).placedOrientation=v),z>=0&&(j.get(z).placedOrientation=w)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const l=this.prevPlacement;let p=!1;this.prevZoomAdjustment=l?l.zoomAdjustment(this.transform.zoom):0;const v=l?l.symbolFadeChange(r):1,w=l?l.opacities:{},C=l?l.variableOffsets:{},P=l?l.placedOrientations:{};for(const L in this.placements){const z=this.placements[L],j=w[L];j?(this.opacities[L]=new Pl(j,v,z.text,z.icon,null,z.clipped),p=p||z.text!==j.text.placed||z.icon!==j.icon.placed):(this.opacities[L]=new Pl(null,v,z.text,z.icon,z.skipFade,z.clipped),p=p||z.text||z.icon)}for(const L in w){const z=w[L];if(!this.opacities[L]){const j=new Pl(z,v,!1,!1);j.isHidden()||(this.opacities[L]=j,p=p||z.text.placed||z.icon.placed)}}for(const L in C)this.variableOffsets[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.variableOffsets[L]=C[L]);for(const L in P)this.placedOrientations[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.placedOrientations[L]=P[L]);p?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=l?l.lastPlacementChangeTime:r)}updateLayerOpacities(r,l,p,v){const w=new Set;for(const C of l){const P=C.getBucket(r);P&&C.latestFeatureIndex&&r.fqid===P.layerIds[0]&&(this.updateBucketOpacities(P,w,C,C.collisionBoxArray,p,v,C.tileID,r.scope),P.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(P,C.tileID),P.elevationType==="road"&&P.updateRoadElevation(),P.updateZOffset())}}updateBucketOpacities(r,l,p,v,w,C,P,L){r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const z=r.layers[0].layout,j=r.layers[0].paint,H=!!r.layers[0].dynamicFilter(),$=new Pl(null,0,!1,!1,!0),q=z.get("text-allow-overlap"),re=z.get("icon-allow-overlap"),te=z.get("text-variable-anchor"),oe=z.get("text-rotation-alignment")==="map",ne=z.get("text-pitch-alignment")==="map",ye=j.get("symbol-z-offset"),Se=z.get("symbol-elevation-reference")==="sea",Te=!ye.isConstant(),ke=new Pl(null,0,q&&(re||!r.hasIconData()||z.get("icon-optional")),re&&(q||!r.hasTextData()||z.get("text-optional")),!0);!r.collisionArrays&&v&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(v);const De=(Pe,Oe,Ne)=>{for(let ht=0;ht<Oe/4;ht++)Pe.opacityVertexArray.emplaceBack(Ne)};let Me=0;C&&r.updateReplacement(P,C);for(let Pe=0;Pe<r.symbolInstances.length;Pe++){const Oe=r.symbolInstances.get(Pe),{numHorizontalGlyphVertices:Ne,numVerticalGlyphVertices:ht,crossTileID:rt,numIconVertices:Tt,tileAnchorX:It,tileAnchorY:Ht}=Oe;let Qe=null;const dt=this.retainedQueryData[r.bucketInstanceId];Te&&Oe&&dt&&(Qe=p.latestFeatureIndex.loadFeature({featureIndex:Oe.featureIndex,bucketIndex:dt.bucketIndex,sourceLayerIndex:dt.sourceLayerIndex,layoutVertexArrayOffset:0}));const Je=ye.evaluate(Qe,{}),Dt=l.has(rt);let mt=this.opacities[rt];Dt?mt=$:mt||(mt=ke,this.opacities[rt]=mt),l.add(rt);const Ot=Ne>0||ht>0,Mt=Tt>0,Nt=this.placedOrientations[rt],Vt=Nt===i.bI.vertical,pn=Nt===i.bI.horizontal||Nt===i.bI.horizontalOnly;!Ot&&!Mt||mt.isHidden()||Me++;let bn=!1;if((Ot||Mt)&&C)for(const rn of r.activeReplacements){if(i.bP(rn,w,i.bQ.Symbol,L)||rn.min.x>It||It>rn.max.x||rn.min.y>Ht||Ht>rn.max.y)continue;const vn=i.bR(It,Ht,P.canonical,rn.footprintTileId.canonical);if(bn=i.bS(vn,rn.footprint),bn)break}if(Ot){const rn=bn?$c:Uc(mt.text);De(r.text,Ne,Vt?$c:rn),De(r.text,ht,pn?$c:rn);const vn=mt.text.isHidden(),{leftJustifiedTextSymbolIndex:dn,centerJustifiedTextSymbolIndex:Rn,rightJustifiedTextSymbolIndex:Hn,verticalPlacedTextSymbolIndex:dr}=Oe,ri=r.text.placedSymbolArray,ii=vn||Vt?1:0;dn>=0&&(ri.get(dn).hidden=ii),Rn>=0&&(ri.get(Rn).hidden=ii),Hn>=0&&(ri.get(Hn).hidden=ii),dr>=0&&(ri.get(dr).hidden=vn||pn?1:0);const tr=this.variableOffsets[rt];tr&&this.markUsedJustification(r,tr.anchor,Oe,Nt);const Hi=this.placedOrientations[rt];Hi&&(this.markUsedJustification(r,"left",Oe,Hi),this.markUsedOrientation(r,Hi,Oe))}if(Mt){const rn=bn?$c:Uc(mt.icon),{placedIconSymbolIndex:vn,verticalPlacedIconSymbolIndex:dn}=Oe,Rn=r.icon.placedSymbolArray,Hn=mt.icon.isHidden()?1:0;vn>=0&&(De(r.icon,Tt,Vt?$c:rn),Rn.get(vn).hidden=Hn),dn>=0&&(De(r.icon,Oe.numVerticalIconVertices,pn?$c:rn),Rn.get(dn).hidden=Hn)}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const rn=r.collisionArrays[Pe];if(rn){let vn=new i.P(0,0),dn=!0;if(rn.textBox||rn.verticalTextBox){if(te){const Hn=this.variableOffsets[rt];Hn?(vn=wo(Hn.anchor,Hn.width,Hn.height,Hn.textOffset,Hn.textScale),oe&&vn._rotate(ne?this.transform.angle:-this.transform.angle)):dn=!1}H&&(dn=!mt.clipped),rn.textBox&&ku(r.textCollisionBox.collisionVertexArray,mt.text.placed,!dn||Vt,Je,Se,vn.x,vn.y),rn.verticalTextBox&&ku(r.textCollisionBox.collisionVertexArray,mt.text.placed,!dn||pn,Je,Se,vn.x,vn.y)}const Rn=dn&&!!(!pn&&rn.verticalIconBox);rn.iconBox&&ku(r.iconCollisionBox.collisionVertexArray,mt.icon.placed,Rn,Je,Se,Oe.hasIconTextFit?vn.x:0,Oe.hasIconTextFit?vn.y:0),rn.verticalIconBox&&ku(r.iconCollisionBox.collisionVertexArray,mt.icon.placed,!Rn,Je,Se,Oe.hasIconTextFit?vn.x:0,Oe.hasIconTextFit?vn.y:0)}}}if(r.fullyClipped=Me===0,r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.bucketInstanceId in this.collisionCircleArrays){const Pe=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=Pe.invProjMatrix,r.placementViewportMatrix=Pe.viewportMatrix,r.collisionCircleArray=Pe.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,l){const p=this.zoomAtLastRecencyCheck===l?1-this.zoomAdjustment(l):1;return this.zoomAtLastRecencyCheck=l,this.commitTime+this.fadeDuration*p>r}setStale(){this.stale=!0}}function ku(f,r,l,p,v,w,C){f.emplaceBack(r?1:0,l?1:0,w||0,C||0,p,v?1:0),f.emplaceBack(r?1:0,l?1:0,w||0,C||0,p,v?1:0),f.emplaceBack(r?1:0,l?1:0,w||0,C||0,p,v?1:0),f.emplaceBack(r?1:0,l?1:0,w||0,C||0,p,v?1:0)}const kh=Math.pow(2,25),Oh=Math.pow(2,24),So=Math.pow(2,17),Is=Math.pow(2,16),Y_=Math.pow(2,9),zh=Math.pow(2,8),rm=Math.pow(2,1);function Uc(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;const r=f.placed?1:0,l=Math.floor(127*f.opacity);return l*kh+r*Oh+l*So+r*Is+l*Y_+r*zh+l*rm+r}const $c=0;class Bf{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&r.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(r,l,p,v,w,C){const P=this._bucketParts;for(;this._currentTileIndex<r.length;)if(l.getBucketParts(P,v,r[this._currentTileIndex],this._sortAcrossTiles,C),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,P.sort((L,z)=>L.sortKey-z.sortKey));this._currentPartIndex<P.length;){const L=P[this._currentPartIndex];if(l.placeLayerBucketPart(L,this._seenCrossTileIDs,p,L.symbolInstanceStart===0,C),this._currentPartIndex++,w())return!0}return!1}}class Oo{constructor(r,l,p,v,w,C,P,L,z){this.placement=new Jr(r,w,C,P,L,z),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=v,this._done=!1}isDone(){return this._done}continuePlacement(r,l,p,v,w){const C=i.q.now(),P=()=>{const L=i.q.now()-C;return!this._forceFullPlacement&&L>2};for(;this._currentPlacementIndex>=0;){const L=l[r[this._currentPlacementIndex]],z=this.placement.collisionIndex.transform.zoom;if(L.type==="symbol"&&(!L.minzoom||L.minzoom<=z)&&(!L.maxzoom||L.maxzoom>z)){const j=L,H=j.layout.get("symbol-z-elevate"),$=j.layout.get("symbol-sort-key").constantOr(1)!==void 0,q=j.layout.get("symbol-z-order"),re=q==="viewport-y"||q==="auto"&&!(q!=="viewport-y"&&$),te=j.layout.get("text-allow-overlap")||j.layout.get("icon-allow-overlap")||j.layout.get("text-ignore-placement")||j.layout.get("icon-ignore-placement"),oe=re&&te,ne=this._inProgressLayer=this._inProgressLayer||new Bf(j),ye=i.C(L.source,L.scope);if(ne.continuePlacement(H||oe?v[ye]:p[ye],this.placement,this._showCollisionBoxes,L,P,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const Ta=512/i.aj/2;class Wo{constructor(r,l,p){this.tileID=r,this.bucketInstanceId=p,this.index=new i.bW(l.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const v=r.canonical.x*i.aj,w=r.canonical.y*i.aj;for(let C=0;C<l.length;C++){const{key:P,crossTileID:L,tileAnchorX:z,tileAnchorY:j}=l.get(C),H=Math.floor((v+z)*Ta),$=Math.floor((w+j)*Ta);this.index.add(H,$),this.keys.push(P),this.crossTileIDs.push(L)}this.index.finish()}findMatches(r,l,p){const v=this.tileID.canonical.z<l.canonical.z?1:Math.pow(2,this.tileID.canonical.z-l.canonical.z),w=Ta/Math.pow(2,l.canonical.z-this.tileID.canonical.z),C=l.canonical.x*i.aj,P=l.canonical.y*i.aj;for(let L=0;L<r.length;L++){const z=r.get(L);if(z.crossTileID)continue;const{key:j,tileAnchorX:H,tileAnchorY:$}=z,q=Math.floor((C+H)*w),re=Math.floor((P+$)*w),te=this.index.range(q-v,re-v,q+v,re+v).sort((oe,ne)=>oe-ne);for(const oe of te){const ne=this.crossTileIDs[oe];if(this.keys[oe]===j&&!p.has(ne)){p.add(ne),z.crossTileID=ne;break}}}}}class xg{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ad{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const l=Math.round((r-this.lng)/360);if(l!==0)for(const p in this.indexes){const v=this.indexes[p],w={};for(const C in v){const P=v[C];P.tileID=P.tileID.unwrapTo(P.tileID.wrap+l),w[P.tileID.key]=P}this.indexes[p]=w}this.lng=r}addBucket(r,l,p){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===l.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let w=0;w<l.symbolInstances.length;w++)l.symbolInstances.get(w).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]=new Set);const v=this.usedCrossTileIDs[r.overscaledZ];for(const w in this.indexes){const C=this.indexes[w];if(Number(w)>r.overscaledZ)for(const P in C){const L=C[P];L.tileID.isChildOf(r)&&L.findMatches(l.symbolInstances,r,v)}else{const P=C[r.scaledTo(Number(w)).key];P&&P.findMatches(l.symbolInstances,r,v)}}for(let w=0;w<l.symbolInstances.length;w++){const C=l.symbolInstances.get(w);C.crossTileID||(C.crossTileID=p.generate(),v.add(C.crossTileID))}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new Wo(r,l.symbolInstances,l.bucketInstanceId),!0}removeBucketCrossTileIDs(r,l){for(const p of l.crossTileIDs)this.usedCrossTileIDs[r].delete(p)}removeStaleBuckets(r){let l=!1;for(const p in this.indexes){const v=this.indexes[p];for(const w in v)r[v[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,v[w]),delete v[w],l=!0)}return l}}class ks{constructor(){this.layerIndexes={},this.crossTileIDs=new xg,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,l,p,v){let w=this.layerIndexes[r.fqid];w===void 0&&(w=this.layerIndexes[r.fqid]=new Ad);let C=!1;const P={};v.name!=="globe"&&w.handleWrapJump(p);for(const L of l){const z=L.getBucket(r);z&&r.fqid===z.layerIds[0]&&(z.bucketInstanceId||(z.bucketInstanceId=++this.maxBucketInstanceId),w.addBucket(L.tileID,z,this.crossTileIDs)&&(C=!0),P[z.bucketInstanceId]=!0)}return w.removeStaleBuckets(P)&&(C=!0),C}pruneUnusedLayers(r){const l={};r.forEach(p=>{l[p]=!0});for(const p in this.layerIndexes)l[p]||delete this.layerIndexes[p]}}const zo=771;class or{constructor(r,l,p,v){this.blendFunction=r,this.blendColor=l,this.mask=p,this.blendEquation=v}}or.Replace=[1,0,1,0],or.disabled=new or(or.Replace,i.am.transparent,[!1,!1,!1,!1]),or.unblended=new or(or.Replace,i.am.transparent,[!0,!0,!0,!0]),or.alphaBlended=new or([1,zo,1,zo],i.am.transparent,[!0,!0,!0,!0]),or.alphaBlendedNonPremultiplied=new or([770,zo,770,zo],i.am.transparent,[!0,!0,!0,!0]),or.multiply=new or([774,0,774,0],i.am.transparent,[!0,!0,!0,!0]);class gn{constructor(r,l,p){this.func=r,this.mask=l,this.range=p}}gn.ReadOnly=!1,gn.ReadWrite=!0,gn.disabled=new gn(519,gn.ReadOnly,[0,1]);const Ou=7680;class zn{constructor(r,l,p,v,w,C){this.test=r,this.ref=l,this.mask=p,this.fail=v,this.depthFail=w,this.pass=C}}zn.disabled=new zn({func:519,mask:0},0,0,Ou,Ou,Ou);const zu=1029,Fu=2305;class Bn{constructor(r,l,p){this.enable=r,this.mode=l,this.frontFace=p}}function im(f,r){const l=i.c1(f,3);i.c3(f,r),i.c7(f,3,l)}function Ea(f,r){const l=i.bY([]);return i.bZ(l,l,-r),i.b_(l,l,-f),l}function sm(f,r){const l=[f[0],f[1],0],p=[r[0],r[1],0];if(i.ae(l)>=1e-15){const C=i.au([],l);i.b$(p,C,i.bE(p,C)),r[0]=p[0],r[1]=p[1]}const v=i.bG([],r,f);if(i.c0(v)<1e-15)return null;const w=Math.atan2(-v[1],v[0]);return Ea(Math.atan2(Math.sqrt(f[0]*f[0]+f[1]*f[1]),-f[2]),w)}Bn.disabled=new Bn(!1,zu,Fu),Bn.backCCW=new Bn(!0,zu,Fu),Bn.backCW=new Bn(!0,zu,2304),Bn.frontCW=new Bn(!0,1028,2304),Bn.frontCCW=new Bn(!0,1028,Fu);class lc{constructor(r,l){this.position=r,this.orientation=l}get position(){return this._position}set position(r){if(r){const l=r instanceof i.ac?r:new i.ac(r[0],r[1],r[2]);this._renderWorldCopies&&(l.x=i.bX(l.x,0,1)),this._position=l}else this._position=null}lookAtPoint(r,l){if(this.orientation=null,!this.position)return;const p=this.position,v=this._elevation?this._elevation.getAtPointOrZero(i.ac.fromLngLat(r)):0,w=i.ac.fromLngLat(r,v),C=[w.x-p.x,w.y-p.y,w.z-p.z];l||(l=[0,0,1]),l[2]=Math.abs(l[2]),this.orientation=sm(C,l)}setPitchBearing(r,l){this.orientation=Ea(i.al(r),i.al(-l))}}class Co{constructor(r,l){this._transform=i.bx([]),this.orientation=l,this.position=r}get mercatorPosition(){const r=this.position;return new i.ac(r[0],r[1],r[2])}get position(){const r=i.c1(this._transform,3);return[r[0],r[1],r[2]]}set position(r){var l;r&&i.c7(this._transform,3,[(l=r)[0],l[1],l[2],1])}get orientation(){return this._orientation}set orientation(r){this._orientation=r||i.bY([]),r&&im(this._transform,this._orientation)}getPitchBearing(){const r=this.forward(),l=this.right();return{bearing:Math.atan2(-l[1],l[0]),pitch:Math.atan2(Math.sqrt(r[0]*r[0]+r[1]*r[1]),-r[2])}}setPitchBearing(r,l){this._orientation=Ea(r,l),im(this._transform,this._orientation)}forward(){const r=i.c1(this._transform,2);return[-r[0],-r[1],-r[2]]}up(){const r=i.c1(this._transform,1);return[-r[0],-r[1],-r[2]]}right(){const r=i.c1(this._transform,0);return[r[0],r[1],r[2]]}getCameraToWorld(r,l){const p=new Float64Array(16);return i.bi(p,this.getWorldToCamera(r,l)),p}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(r,l,p){const v=this.position;i.b$(v,v,-r);const w=new Float64Array(16);return i.bn(w,[p,p,p]),i.bo(w,w,v),w[10]*=l,w}getWorldToCamera(r,l){const p=new Float64Array(16),v=new Float64Array(4),w=this.position;return i.c2(v,this._orientation),i.b$(w,w,-r),i.c3(p,v),i.bo(p,p,w),p[1]*=-1,p[5]*=-1,p[9]*=-1,p[13]*=-1,p[8]*=l,p[9]*=l,p[10]*=l,p[11]*=l,p}getCameraToClipPerspective(r,l,p,v){const w=new Float64Array(16);return i.c4(w,r,l,p,v),w}getCameraToClipOrthographic(r,l,p,v,w,C){const P=new Float64Array(16);return i.c5(P,r,l,p,v,w,C),P}getDistanceToElevation(r,l=!1){const p=r===0?0:i.c6(r,l?i.aY(this.position[1]):this.position[1]),v=this.forward();return(p-this.position[2])/v[2]}clone(){return new Co([...this.position],[...this.orientation])}}const Fo={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class Rd{constructor(r=0,l=0,p=0,v=0){if(isNaN(r)||r<0||isNaN(l)||l<0||isNaN(p)||p<0||isNaN(v)||v<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=l,this.left=p,this.right=v}interpolate(r,l,p){return l.top!=null&&r.top!=null&&(this.top=i.ai(r.top,l.top,p)),l.bottom!=null&&r.bottom!=null&&(this.bottom=i.ai(r.bottom,l.bottom,p)),l.left!=null&&r.left!=null&&(this.left=i.ai(r.left,l.left,p)),l.right!=null&&r.right!=null&&(this.right=i.ai(r.right,l.right,p)),this}getCenter(r,l){const p=i.aD((this.left+r-this.right)/2,0,r),v=i.aD((this.top+l-this.bottom)/2,0,l);return new i.P(p,v)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new Rd(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const cc=15;class Hc{constructor(r,l,p,v,w,C,P){this.tileSize=512,this._renderWorldCopies=w===void 0||w,this._minZoom=r||0,this._maxZoom=l||22,this._minPitch=p??0,this._maxPitch=v??60,this.setProjection(C),this.setMaxBounds(P),this.width=0,this.height=0,this._center=new i.cd(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Rd,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new Co,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1,this._allowWorldUnderZoom=!1}clone(){const r=new Hc(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection(),this.maxBounds);return r._elevation=this._elevation,r._centerAltitude=this._centerAltitude,r._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,r.tileSize=this.tileSize,r.mercatorFromTransition=this.mercatorFromTransition,r.width=this.width,r.height=this.height,r.cameraElevationReference=this.cameraElevationReference,r._center=this._center,r._setZoom(this.zoom),r._seaLevelZoom=this._seaLevelZoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._nearZ=this._nearZ,r._farZ=this._farZ,r._averageElevation=this._averageElevation,r._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._camera=this._camera.clone(),r._calcMatrices(),r.freezeTileCoverage=this.freezeTileCoverage,r.frustumCorners=this.frustumCorners,r._allowWorldUnderZoom=this._allowWorldUnderZoom,r}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<cc}get elevation(){return this._elevation}set elevation(r){this._elevation!==r&&(this._elevation=r,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(r,l=!1){const p=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||p)&&this._updateCameraOnTerrain(),(r||p)&&this._constrainCamera(l),this._calcMatrices()}getProjection(){return i.aF(this.projection,["name","center","parallels"])}setProjection(r){this.projectionOptions=r||{name:"mercator"};const l=this.projection?this.getProjection():void 0;this.projection=i.ce(this.projectionOptions);const p=this.getProjection(),v=!i.bv(l,p);return v&&this._calcMatrices(),this.mercatorFromTransition=!1,v}setOrthographicProjectionAtLowPitch(r){return this._orthographicProjectionAtLowPitch!==r&&(this._orthographicProjectionAtLowPitch=r,this._calcMatrices(),!0)}setMercatorFromTransition(){const r=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=i.ce({name:"mercator"});const l=r!==this.projection.name;return l&&this._calcMatrices(),l}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get cameraWorldSize(){const r=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(r))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return i.c6(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new i.P(this.width,this.height)}get bearing(){return i.bX(this.rotation,-180,180)}set bearing(r){this.rotation=r}get rotation(){return-this.angle/Math.PI*180}set rotation(r){const l=-r*Math.PI/180;this.angle!==l&&(this._unmodified=!1,this.angle=l,this._calcMatrices(),this.rotationMatrix=i.cf(),i.cg(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const l=i.aD(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==l&&(this._unmodified=!1,this._pitch=l,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=i.al(r),this._calcMatrices())}get fovX(){return this._fov}get fovY(){const r=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/r)}get averageElevation(){return this._averageElevation}set averageElevation(r){this._averageElevation=r,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(r){const l=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==l&&(this._unmodified=!1,this._setZoom(l),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(r){this._zoom=r,this.scale=this.zoomScale(r),this.tileZoom=Math.floor(r),this.zoomFraction=r-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(r){this._tileCoverLift!==r&&(this._tileCoverLift=r)}_updateCameraOnTerrain(){const r=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,l=this.elevation&&r===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||r===Number.NEGATIVE_INFINITY&&(!l||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const p=this._elevation;l||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&p.exaggeration()&&this._centerAltitudeValidForExaggeration!==p.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*p.exaggeration(),this._centerAltitudeValidForExaggeration=p.exaggeration()):(this._centerAltitude=r||0,this._centerAltitudeValidForExaggeration=p.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const r=this._elevation,l=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],p=this.horizonLineFromTop();let v=0,w=0;for(let C=0;C<l.length;C++){const P=new i.P(l[C][0]*this.width,p+l[C][1]*(this.height-p)),L=r.pointCoordinate(P);if(!L)continue;const z=1/Math.hypot(L[0]-this._camera.position[0],L[1]-this._camera.position[1]);v+=L[3]*z,w+=z}return w===0?NaN:v/w}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const r=this._seaLevelZoom,l=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),p=this.pixelsPerMeter/this.worldSize*l,v=this._mercatorZfromZoom(r),w=this._mercatorZfromZoom(this._maxZoom),C=Math.max(v-p,w);this._setZoom(this._zoomFromMercatorZ(C))}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}computeZoomRelativeTo(r){const l=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,r.toAltitude()));let p;p=r.z<this._camera.position[2]?[l.x,l.y,l.z]:[r.x,r.y,r.z];const v=i.ae(i.at([],this._camera.position,p));return i.aD(this._zoomFromMercatorZ(v),this._minZoom,this._maxZoom)}setFreeCameraOptions(r){if(!this.height||!r.position&&!r.orientation)return;this._updateCameraState();let l=!1;if(r.orientation&&!i.ch(r.orientation,this._camera.orientation)&&(l=this._setCameraOrientation(r.orientation)),r.position){const p=[r.position.x,r.position.y,r.position.z];i.ci(p,this._camera.position)||(this._setCameraPosition(p),l=!0)}l&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const r=this._camera.position,l=new lc;return l.position=new i.ac(r[0],r[1],r[2]),l.orientation=this._camera.orientation,l._elevation=this.elevation,l._renderWorldCopies=this.renderWorldCopies,l}_setCameraOrientation(r){if(!i.cj(r))return!1;i.ck(r,r);const l=i.cl([],[0,0,-1],r),p=i.cl([],[0,-1,0],r);if(p[2]<0)return!1;const v=sm(l,p);return!!v&&(this._camera.orientation=v,!0)}_setCameraPosition(r){const l=this.zoomScale(this.minZoom)*this.tileSize,p=this.zoomScale(this.maxZoom)*this.tileSize,v=this.cameraToCenterDistance;r[2]=i.aD(r[2],v/p,v/l),this._camera.position=r}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,l,p){this._unmodified=!1,this._edgeInsets.interpolate(r,l,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const l=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,l)}getVisibleUnwrappedCoordinates(r){const l=[new i.cm(0,r)];if(this.renderWorldCopies){const p=this.pointCoordinate(new i.P(0,0)),v=this.pointCoordinate(new i.P(this.width,0)),w=this.pointCoordinate(new i.P(this.width,this.height)),C=this.pointCoordinate(new i.P(0,this.height)),P=Math.floor(Math.min(p.x,v.x,w.x,C.x)),L=Math.floor(Math.max(p.x,v.x,w.x,C.x)),z=1;for(let j=P-z;j<=L+z;j++)j!==0&&l.push(new i.cm(j,r))}return l}isLODDisabled(r){return(!r||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(r,l,p){let v=[];const w=p!=null,C=!w;if(C&&this.zoom<l||w&&p[0]===0&&p[1]===0)return v;const P=new Set,L=(j,H,$,q,re)=>{const te=i.cK(H,j,$,q,re);P.has(te)||(v.push(new i.aM(j,H,$,q,re)),P.add(te))};for(let j=0;j<r.length;j++){const H=r[j];if(C&&H.canonical.z!==l)continue;const $=H.canonical,q=H.overscaledZ,re=H.wrap,te=1<<$.z,oe=$.x+1<te,ne=$.x>0,ye=$.y+1<te,Se=$.y>0,Te=H.wrap-(ne?0:1),ke=H.wrap+(oe?0:1),De=ne?$.x-1:te-1,Me=oe?$.x+1:0;if(w)p[0]<0?(L(q,ke,$.z,Me,$.y),p[1]<0&&ye&&(L(q,re,$.z,$.x,$.y+1),L(q,ke,$.z,Me,$.y+1)),p[1]>0&&Se&&(L(q,re,$.z,$.x,$.y-1),L(q,ke,$.z,Me,$.y-1))):p[0]>0?(L(q,Te,$.z,De,$.y),p[1]<0&&ye&&(L(q,re,$.z,$.x,$.y+1),L(q,Te,$.z,De,$.y+1)),p[1]>0&&Se&&(L(q,re,$.z,$.x,$.y-1),L(q,Te,$.z,De,$.y-1))):p[1]<0&&ye?L(q,re,$.z,$.x,$.y+1):Se&&L(q,re,$.z,$.x,$.y-1);else{const Pe=H.visibleQuadrants;1&Pe&&(L(q,Te,$.z,De,$.y),Se&&(L(q,re,$.z,$.x,$.y-1),L(q,Te,$.z,De,$.y-1))),2&Pe&&(L(q,ke,$.z,Me,$.y),Se&&(L(q,re,$.z,$.x,$.y-1),L(q,ke,$.z,Me,$.y-1))),4&Pe&&(L(q,Te,$.z,De,$.y),ye&&(L(q,re,$.z,$.x,$.y+1),L(q,Te,$.z,De,$.y+1))),8&Pe&&(L(q,ke,$.z,Me,$.y),ye&&(L(q,re,$.z,$.x,$.y+1),L(q,ke,$.z,Me,$.y+1)))}}const z=[];for(const j of v)v.some(H=>j.isChildOf(H))||z.push(j);if(v=z.filter(j=>!r.some(H=>!!(j.overscaledZ<l&&H.isChildOf(j))||j.equals(H)||j.isChildOf(H))),C){const j=1<<l,H=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),$=[j*H.x,j*H.y],q=4,re=q*q;v=v.filter(te=>{const oe=te.canonical.x+.5-$[0],ne=te.canonical.y+.5-$[1];return oe*oe+ne*ne<re})}return v}coveringTiles(r){let l=this.coveringZoomLevel(r);const p=l,v=this.elevation&&this.elevation.exaggeration(),w=v&&!r.isTerrainDEM,C=this.projection.name==="mercator";if(r.minzoom!==void 0&&l<r.minzoom)return[];r.maxzoom!==void 0&&l>r.maxzoom&&(l=r.maxzoom);const P=this.locationCoordinate(this.center),L=this.center.lat,z=1<<l,j=[z*P.x,z*P.y,0],H=this.projection.name==="globe",$=!H,q=i.cn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,l,$),re=H?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),te=z*i.c6(1,this.center.lat),oe=this._camera.position[2]/i.c6(1,this.center.lat),ne=[z*re.x,z*re.y,oe*($?1:te)],ye=H||v,Se=this.cameraToCenterDistance/r.tileSize*(r.roundZoom?1:.502),Te=this.isLODDisabled(!0)?l:0;let ke;if(this._elevation&&r.isTerrainDEM)ke=1e4*this._elevation.exaggeration();else if(this._elevation){const Je=this._elevation.getMinMaxForVisibleTiles();ke=Je?Je.max:this._centerAltitude}else ke=this._centerAltitude;const De=r.isTerrainDEM?-ke:this._elevation?this._elevation.getMinElevationBelowMSL():0,Me=this.projection.isReprojectedInTileSpace?i.co(this):1,Pe=Je=>{const mt=new i.ac(Je.x+25e-6,Je.y,Je.z),Ot=new i.ac(Je.x,Je.y+25e-6,Je.z),Mt=Je.toLngLat(),Nt=mt.toLngLat(),Vt=Ot.toLngLat(),pn=this.locationCoordinate(Mt),bn=this.locationCoordinate(Nt),rn=this.locationCoordinate(Vt),vn=Math.hypot(bn.x-pn.x,bn.y-pn.y),dn=Math.hypot(rn.x-pn.x,rn.y-pn.y);return Math.sqrt(vn*dn)*Me/25e-6},Oe=Je=>{const Dt=ke,mt=De;return{aabb:i.cr(this,z,0,0,0,Je,mt,Dt,this.projection),zoom:0,x:0,y:0,minZ:mt,maxZ:Dt,wrap:Je,fullyVisible:!1}},Ne=[];let ht=[];const rt=l,Tt=r.reparseOverscaled?p:l,It=(oe-this._centerAltitude)*te,Ht=Je=>{if(!this._elevation||!Je.tileID||!C)return;const Dt=this._elevation.getMinMaxForTile(Je.tileID),mt=Je.aabb;Dt?(mt.min[2]=Dt.min,mt.max[2]=Dt.max,mt.center[2]=(mt.min[2]+mt.max[2])/2):(Je.shouldSplit=dt(Je),Je.shouldSplit||(mt.min[2]=mt.max[2]=mt.center[2]=this._centerAltitude))},Qe=(Je,Dt)=>{if(.707*Dt<Je)return 1;const mt=Dt/Je;return mt/(1.4144271570014144+(Math.pow(1.1,mt-1.4144271570014144+1)-1)/(1.1-1)-1)},dt=Je=>{if(Je.zoom<Te)return!0;if(Je.zoom===rt)return!1;if(Je.shouldSplit!=null)return Je.shouldSplit;const Dt=Je.aabb.distanceX(ne),mt=Je.aabb.distanceY(ne);let Ot=It,Mt=1;if(H){Ot=Je.aabb.distanceZ(ne);const dn=Math.pow(2,Je.zoom),Rn=i.aY((Je.y+1)/dn),Hn=i.aY(Je.y/dn),dr=Math.min(Math.max(L,Rn),Hn),ri=i.cP(dr)/i.cP(L);if(Mt=dr===L?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,ri/this._mercatorScaleRatio),this.zoom<=i.cL&&Je.zoom===rt-1&&ri>=.9)return!0}else if(w&&(Ot=Je.aabb.distanceZ(ne)*te),this.projection.isReprojectedInTileSpace&&p<=5){const dn=Math.pow(2,Je.zoom),Rn=Pe(new i.ac((Je.x+.5)/dn,(Je.y+.5)/dn));Mt=Rn>.85?1:Rn}if(!C){const dn=Math.sqrt(Dt*Dt+mt*mt+Ot*Ot);let Rn=(1<<rt-Je.zoom)*Se*Mt;return Rn*=Qe(Math.max(Ot,It),dn),dn<Rn}let Nt=Number.MAX_VALUE,Vt=0;const pn=Je.aabb.getCorners(),bn=[];for(const dn of pn){i.at(bn,dn,ne),H||(w?bn[2]*=te:bn[2]=It);const Rn=i.bE(bn,this._camera.forward());Rn<Nt&&(Nt=Rn,Vt=Math.abs(bn[2]))}let rn=(1<<rt-Je.zoom)*Se*Mt;if(rn*=Qe(Math.max(Vt,It),Nt),Nt<rn)return!0;const vn=Je.aabb.closestPoint(j);return vn[0]===j[0]&&vn[1]===j[1]};if(this.renderWorldCopies)for(let Je=1;Je<=3;Je++)Ne.push(Oe(-Je)),Ne.push(Oe(Je));for(Ne.push(Oe(0));Ne.length>0;){const Je=Ne.pop(),Dt=Je.x,mt=Je.y;let Ot=Je.fullyVisible;const Mt=()=>this.projection.name==="globe"&&(Je.y===0||Je.y===(1<<Je.zoom)-1);if(!Ot){let Nt=ye?Je.aabb.intersects(q):Je.aabb.intersectsFlat(q);if(Nt===0&&Mt()){const Vt=new i.cp(Je.zoom,Dt,mt);Nt=i.cq(this,z,Vt,!0).intersects(q)}if(Nt===0)continue;Ot=Nt===2}if(Je.zoom!==rt&&dt(Je))for(let Nt=0;Nt<4;Nt++){const Vt=(Dt<<1)+Nt%2,pn=(mt<<1)+(Nt>>1),bn={aabb:C?Je.aabb.quadrant(Nt):i.cr(this,z,Je.zoom+1,Vt,pn,Je.wrap,Je.minZ,Je.maxZ,this.projection),zoom:Je.zoom+1,x:Vt,y:pn,wrap:Je.wrap,fullyVisible:Ot,tileID:void 0,shouldSplit:void 0,minZ:Je.minZ,maxZ:Je.maxZ};w&&!H&&(bn.tileID=new i.aM(Je.zoom+1===rt?Tt:Je.zoom+1,Je.wrap,Je.zoom+1,Vt,pn),Ht(bn)),Ne.push(bn)}else{const Nt=Je.zoom===rt?Tt:Je.zoom;if(r.minzoom&&r.minzoom>Nt)continue;let Vt=0;if(!Ot){let vn=ye?Je.aabb.intersectsPrecise(q):Je.aabb.intersectsPreciseFlat(q);if(vn===0&&Mt()){const dn=new i.cp(Je.zoom,Dt,mt);vn=i.cq(this,z,dn,!0).intersectsPrecise(q)}if(vn===0)continue;if(r.calculateQuadrantVisibility)if(q.containsPoint(Je.aabb.center))Vt=15;else for(let dn=0;dn<4;dn++)Je.aabb.quadrant(dn).intersects(q)!==0&&(Vt|=1<<dn)}const pn=j[0]-(.5+Dt+(Je.wrap<<Je.zoom))*(1<<l-Je.zoom),bn=j[1]-.5-mt,rn=Je.tileID?Je.tileID:new i.aM(Nt,Je.wrap,Je.zoom,Dt,mt);r.calculateQuadrantVisibility&&(rn.visibleQuadrants=Vt),ht.push({tileID:rn,distanceSq:pn*pn+bn*bn})}}if(this.fogCullDistSq){const Je=this.fogCullDistSq,Dt=this.horizonLineFromTop();ht=ht.filter(mt=>{const Ot=[0,0,0,1],Mt=[i.aj,i.aj,0,1],Nt=this.calculateFogTileMatrix(mt.tileID.toUnwrapped());i.aA(Ot,Ot,Nt),i.aA(Mt,Mt,Nt);const Vt=i.cs([],Ot,Mt),pn=i.ct([],Ot,Mt),bn=i.cM(Vt,pn);if(bn===0)return!0;let rn=!1;const vn=this._elevation;if(vn&&bn>Je&&Dt!==0){const dn=this.calculateProjMatrix(mt.tileID.toUnwrapped());let Rn;r.isTerrainDEM||(Rn=vn.getMinMaxForTile(mt.tileID)),Rn||(Rn={min:De,max:ke});const Hn=i.cu(this.rotation),dr=[Hn[0]*i.aj,Hn[1]*i.aj,Rn.max];i.ad(dr,dr,dn),rn=(1-dr[1])*this.height*.5<Dt}return bn<Je||rn})}return ht.sort((Je,Dt)=>Je.distanceSq-Dt.distanceSq).map(Je=>Je.tileID)}resize(r,l){this.width=r,this.height=l,this.pixelsToGLUnits=[2/r,-2/l],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const l=i.aD(r.lat,-i.cv,i.cv),p=this.projection.project(r.lng,l);return new i.P(p.x*this.worldSize,p.y*this.worldSize)}unproject(r){return this.projection.unproject(r.x/this.worldSize,r.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/i.c6(1,this.center.lat)/this.worldSize}setLocationAtPoint(r,l){let p,v;const w=this.centerPoint;if(this.projection.name==="globe"){const P=this.worldSize;p=(l.x-w.x)/P,v=(l.y-w.y)/P}else{const P=this.pointCoordinate(l),L=this.pointCoordinate(w);p=P.x-L.x,v=P.y-L.y}const C=this.locationCoordinate(r);this.setLocation(new i.ac(C.x-p,C.y-v))}setLocation(r){this.center=this.coordinateLocation(r),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(r,l){return this.projection.locationPoint(this,r,l)}locationPoint3D(r,l){return this.projection.locationPoint(this,r,l,!0)}pointLocation(r){return this.coordinateLocation(this.pointCoordinate(r))}pointLocation3D(r,l){return this.coordinateLocation(this.pointCoordinate3D(r,l))}locationCoordinate(r,l){const p=l?i.c6(l,r.lat):void 0,v=this.projection.project(r.lng,r.lat);return new i.ac(v.x,v.y,p)}coordinateLocation(r){return this.projection.unproject(r.x,r.y)}pointRayIntersection(r,l){const p=l??this._centerAltitude,v=[r.x,r.y,0,1],w=[r.x,r.y,1,1];i.aA(v,v,this.pixelMatrixInverse),i.aA(w,w,this.pixelMatrixInverse);const C=w[3];i.cw(v,v,1/v[3]),i.cw(w,w,1/C);const P=v[2],L=w[2];return{p0:v,p1:w,t:P===L?0:(p-P)/(L-P)}}screenPointToMercatorRay(r){const l=[r.x,r.y,0,1],p=[r.x,r.y,1,1];return i.aA(l,l,this.pixelMatrixInverse),i.aA(p,p,this.pixelMatrixInverse),i.cw(l,l,1/l[3]),i.cw(p,p,1/p[3]),l[2]=i.c6(l[2],this._center.lat)*this.worldSize,p[2]=i.c6(p[2],this._center.lat)*this.worldSize,i.cw(l,l,1/this.worldSize),i.cw(p,p,1/this.worldSize),new i.av([l[0],l[1],l[2]],i.au([],i.at([],p,l)))}rayIntersectionCoordinate(r){const{p0:l,p1:p,t:v}=r,w=i.c6(l[2],this._center.lat),C=i.c6(p[2],this._center.lat);return new i.ac(i.ai(l[0],p[0],v)/this.worldSize,i.ai(l[1],p[1],v)/this.worldSize,i.ai(w,C,v))}pointCoordinate(r,l=this._centerAltitude){return this.projection.pointCoordinate(this,r.x,r.y,l)}pointCoordinate3D(r,l){if(!this.elevation)return this.pointCoordinate(r,l);let p=this.projection.pointCoordinate3D(this,r.x,r.y);if(p)return new i.ac(p[0],p[1],p[2]);let v=0,w=this.horizonLineFromTop();if(r.y>w)return this.pointCoordinate(r,l);const C=.02*w,P=r.clone();for(let L=0;L<10&&w-v>C;L++){P.y=i.ai(v,w,.66);const z=this.projection.pointCoordinate3D(this,P.x,P.y);z?(w=P.y,p=z):v=P.y}return p?new i.ac(p[0],p[1],p[2]):this.pointCoordinate(r)}isPointAboveHorizon(r){return this.projection.isPointAboveHorizon(this,r)}isPointOnSurface(r){if(r.y<0||r.y>this.height||r.x<0||r.x>this.width)return!1;if(this.elevation||this.zoom>=i.cx)return!this.isPointAboveHorizon(r);const l=this.pointCoordinate(r);return l.y>=0&&l.y<=1}_coordinatePoint(r,l){const p=l&&this.elevation?this.elevation.getAtPointOrZero(r,this._centerAltitude):this._centerAltitude,v=[r.x*this.worldSize,r.y*this.worldSize,p+r.toAltitude(),1];return i.aA(v,v,this.pixelMatrix),v[3]>0?new i.P(v[0]/v[3],v[1]/v[3]):new i.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:r,left:l}=this._edgeInsets,p=this.height-this._edgeInsets.bottom,v=this.width-this._edgeInsets.right,w=this.pointLocation3D(new i.P(l,r)),C=this.pointLocation3D(new i.P(v,r)),P=this.pointLocation3D(new i.P(v,p)),L=this.pointLocation3D(new i.P(l,p));let z=Math.min(w.lng,C.lng,P.lng,L.lng),j=Math.max(w.lng,C.lng,P.lng,L.lng),H=Math.min(w.lat,C.lat,P.lat,L.lat),$=Math.max(w.lat,C.lat,P.lat,L.lat);const q=Math.pow(2,-this.zoom)/16*270,re=this.projection.name==="globe"?1:4,te=(oe,ne,ye,Se,Te)=>{const ke=(oe+ye)/2,De=(ne+Se)/2,Me=new i.P(ke,De),{lng:Pe,lat:Oe}=this.pointLocation3D(Me),Ne=Math.max(0,z-Pe,H-Oe,Pe-j,Oe-$);z=Math.min(z,Pe),j=Math.max(j,Pe),H=Math.min(H,Oe),$=Math.max($,Oe),(Te<re||Ne>q)&&(te(oe,ne,ke,De,Te+1),te(ke,De,ye,Se,Te+1))};if(te(l,r,v,r,1),te(v,r,v,p,1),te(v,p,l,p,1),te(l,p,l,r,1),this.projection.name==="globe"){const[oe,ne]=i.cy(this);oe?($=90,j=180,z=-180):ne&&(H=-90,j=180,z=-180)}return new i.aG(new i.cd(z,H),new i.cd(j,$))}_getBoundsRectangular(r,l){const{top:p,left:v}=this._edgeInsets,w=this.height-this._edgeInsets.bottom,C=this.width-this._edgeInsets.right,P=new i.P(v,p),L=new i.P(C,p),z=new i.P(C,w),j=new i.P(v,w);let H=this.pointCoordinate(P,r),$=this.pointCoordinate(L,r);const q=this.pointCoordinate(z,l),re=this.pointCoordinate(j,l),te=(oe,ne)=>(ne.y-oe.y)/(ne.x-oe.x);return H.y>1&&$.y>=0?H=new i.ac((1-re.y)/te(re,H)+re.x,1):H.y<0&&$.y<=1&&(H=new i.ac(-re.y/te(re,H)+re.x,0)),$.y>1&&H.y>=0?$=new i.ac((1-q.y)/te(q,$)+q.x,1):$.y<0&&H.y<=1&&($=new i.ac(-q.y/te(q,$)+q.x,0)),new i.aG().extend(this.coordinateLocation(H)).extend(this.coordinateLocation($)).extend(this.coordinateLocation(re)).extend(this.coordinateLocation(q))}_getBoundsRectangularTerrain(){const r=this.elevation;if(!r.visibleDemTiles.length||r.isUsingMockSource())return this._getBoundsRectangular(0,0);const l=r.visibleDemTiles.reduce((p,v)=>{if(v.dem){const w=v.dem.tree;p.min=Math.min(p.min,w.minimums[0]),p.max=Math.max(p.max,w.maximums[0])}return p},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(l.min*r.exaggeration(),l.max*r.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(r=!0){const l=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,p=this.height/2-l*(1-this._horizonShift);return r?Math.max(0,p):p}getMaxBounds(){return this.maxBounds}setMaxBounds(r){this.maxBounds=r,this.minLat=-i.cv,this.maxLat=i.cv,this.minLng=-180,this.maxLng=180,r&&(this.minLat=r.getSouth(),this.maxLat=r.getNorth(),this.minLng=r.getWest(),this.maxLng=r.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=i.ay(this.minLng)*this.tileSize,this.worldMaxX=i.ay(this.maxLng)*this.tileSize,this.worldMinY=i.aH(this.maxLat)*this.tileSize,this.worldMaxY=i.aH(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(r,l){return this.projection.createTileMatrix(this,l,r)}calculateDistanceTileData(r){const l=r.key,p=this._distanceTileDataCache;if(p[l])return p[l];const v=r.canonical,w=1/this.height,C=this.cameraWorldSize,P=C/this.zoomScale(v.z),L=(v.x+Math.pow(2,v.z)*r.wrap)*P,z=v.y*P,j=this.point;j.x*=C/this.worldSize,j.y*=C/this.worldSize;const H=this.angle,$=Math.sin(-H),q=-Math.cos(-H);return p[l]={bearing:[$,q],center:[(j.x-L)*w,(j.y-z)*w],scale:P/i.aj*w},p[l]}calculateFogTileMatrix(r){const l=r.key,p=this._fogTileMatrixCache;if(p[l])return p[l];const v=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,r);return i.az(v,this.worldToFogMatrix,v),p[l]=new Float32Array(v),p[l]}calculateProjMatrix(r,l=!1,p=!1){const v=r.key;let w;if(w=p?this._expandedProjMatrixCache:l?this._alignedProjMatrixCache:this._projMatrixCache,w[v])return w[v];const C=this.calculatePosMatrix(r,this.worldSize);let P;return P=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:p?this.expandedFarZProjMatrix:l?this.alignedProjMatrix:this.projMatrix,i.az(C,P,C),w[v]=new Float32Array(C),w[v]}calculatePixelsToTileUnitsMatrix(r){const l=r.tileID.key,p=this._pixelsToTileUnitsCache;if(p[l])return p[l];const v=i.cz(r,this);return p[l]=v,p[l]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const r=1/this.worldSize,l=i.bn([],[r,r,r]);return i.az(l,l,this.globeMatrix),l}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const r=this._elevation;this._updateCameraState();const l=i.c6(1,this._center.lat)*this.worldSize,p=this._computeCameraPosition(l),v=this._camera.forward(),w=i.c6(1,this._center.lat);p[2]/=w,v[2]/=w,i.au(v,v);const C=r.raycast(p,v,r.exaggeration());if(C){const P=i.bF([],p,v,C),L=new i.ac(P[0],P[1],i.c6(P[2],i.aY(P[1]))),z=(L.z+i.ae([L.x-p[0],L.y-p[1],L.z-p[2]*w]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(z),this._centerAltitude=L.toAltitude(),this._center=this.coordinateLocation(L),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(r=!1){if(!this._elevation)return;const l=this._elevation,p=i.c6(1,this._center.lat)*this.worldSize,v=this._computeCameraPosition(p),w=l.getAtPointOrZero(new i.ac(...v)),C=this.pixelsPerMeter/this.worldSize*w,P=this._minimumHeightOverTerrain(),L=v[2]-C;if(L<=P)if(L<0||r){const z=this.locationCoordinate(this._center,this._centerAltitude),j=[v[0],v[1],z.z-v[2]],H=i.ae(j);j[2]-=(P-L)/this._pixelsPerMercatorPixel;const $=i.ae(j);if($===0)return;i.b$(j,j,H/$*this._pixelsPerMercatorPixel),this._camera.position=[v[0],v[1],z.z*this._pixelsPerMercatorPixel-j[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const r=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||r){const $=this.center;return $.lat=i.aD($.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!r)&&($.lng=i.aD($.lng,this.minLng,this.maxLng)),this.center=$,void(this._constraining=!1)}const l=this._unmodified,{x:p,y:v}=this.point;let w=0,C=p,P=v;const L=this.width/2,z=this.height/2,j=this.worldMinY*this.scale,H=this.worldMaxY*this.scale;if(v-z<j&&(P=j+z),v+z>H&&(P=H-z),H-j<this.height&&(w=Math.max(w,this.height/(H-j)),P=(H+j)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const $=this.worldMinX*this.scale,q=this.worldMaxX*this.scale,re=this.worldSize/2-($+q)/2;C=(p+re+this.worldSize)%this.worldSize-re,C-L<$&&(C=$+L),C+L>q&&(C=q-L),q-$<this.width&&(w=Math.max(w,this.width/(q-$)),C=(q+$)/2)}C===p&&P===v||this._allowWorldUnderZoom||(this.center=this.unproject(new i.P(C,P))),w&&!this._allowWorldUnderZoom&&(this.zoom+=this.scaleZoom(w)),this._constrainCamera(),this._unmodified=l,this._constraining=!1}_minZoomForBounds(){let r=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(r=Math.max(r,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),r}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,l=this.projection.name==="globe",p=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=i.c6(1,this.center.lat)/i.c6(1,i.cN));const v=i.cA(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,v),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const w=this.projection.zAxisUnit==="meters"?p:1,C=this._camera.getWorldToCamera(this.worldSize,w);let P;const L=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(L[8]=2*-r.x/this.width,L[9]=2*r.y/this.height,this.isOrthographic){let Oe=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),Ne=Oe*this.aspect,ht=-Ne,rt=-Oe;Ne-=r.x,ht-=r.x,Oe+=r.y,rt+=r.y,P=this._camera.getCameraToClipOrthographic(ht,Ne,rt,Oe,this._nearZ,this._farZ),((Tt,It,Ht,Qe)=>{for(let dt=0;dt<16;dt++)Tt[dt]=i.ai(It[dt],Ht[dt],Qe)})(P,P,L,i.cO(this.pitch>=cc?1:this.pitch/cc))}else P=L;const z=i.cB([],L,C);let j=i.cB([],P,C);if(this.projection.isReprojectedInTileSpace){const Oe=this.locationCoordinate(this.center),Ne=i.bx([]);i.bo(Ne,Ne,[Oe.x*this.worldSize,Oe.y*this.worldSize,0]),i.az(Ne,Ne,i.cC(this)),i.bo(Ne,Ne,[-Oe.x*this.worldSize,-Oe.y*this.worldSize,0]),i.az(j,j,Ne),i.az(z,z,Ne),this.inverseAdjustmentMatrix=i.cD(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=i.cE([],j,[this.worldSize,this.worldSize,this.worldSize/w,1]),this.projMatrix=j,this.invProjMatrix=i.bi(new Float64Array(16),this.projMatrix),l){const Oe=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);Oe[8]=2*-r.x/this.width,Oe[9]=2*r.y/this.height,this.expandedFarZProjMatrix=i.cB([],Oe,C)}else this.expandedFarZProjMatrix=this.projMatrix;const H=i.bi([],P);this.frustumCorners=i.cF.fromInvProjectionMatrix(H,this.horizonLineFromTop(),this.height),this.cameraFrustum=i.cn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!l);const $=new Float32Array(16);i.bx($),i.cE($,$,[1,-1,1]),i.cG($,$,this._pitch),i.by($,$,this.angle);const q=i.c4(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=i.bw(q);const re=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;q[8]=2*-r.x/this.width,q[9]=2*(r.y+re)/this.height,this.skyboxMatrix=i.az($,q,$);const te=this.point,oe=te.x,ne=te.y,ye=this.width%2/2,Se=this.height%2/2,Te=Math.cos(this.angle),ke=Math.sin(this.angle),De=oe-Math.round(oe)+Te*ye+ke*Se,Me=ne-Math.round(ne)+Te*Se+ke*ye,Pe=new Float64Array(j);if(i.bo(Pe,Pe,[De>.5?De-1:De,Me>.5?Me-1:Me,0]),this.alignedProjMatrix=Pe,j=i.bz(),i.cE(j,j,[this.width/2,-this.height/2,1]),i.bo(j,j,[1,-1,0]),this.labelPlaneMatrix=j,j=i.bz(),i.cE(j,j,[1,-1,1]),i.bo(j,j,[-1,-1,0]),i.cE(j,j,[2/this.width,2/this.height,1]),this.glCoordMatrix=j,this.pixelMatrix=i.az(new Float64Array(16),this.labelPlaneMatrix,z),this._calcFogMatrices(),this._distanceTileDataCache={},j=i.bi(new Float64Array(16),this.pixelMatrix),!j)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=j,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=i.cH(this);const Oe=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=i.ad(Oe,Oe,C),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=j;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const r=this.cameraWorldSizeForFog,l=this.cameraPixelsPerMeter,p=this._camera.position,v=1/this.height/this._pixelsPerMercatorPixel,w=[r,r,l];i.b$(w,w,v),i.b$(p,p,-1),i.cI(p,p,w);const C=i.bz();i.bo(C,C,p),i.cE(C,C,w),this.mercatorFogMatrix=C,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(r,l,v)}_computeCameraPosition(r){const l=(r=r||this.pixelsPerMeter)/this.pixelsPerMeter,p=this._camera.forward(),v=this.point,w=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*l-r/this.worldSize*this._centerAltitude;return[v.x/this.worldSize-p[0]*w,v.y/this.worldSize-p[1]*w,r/this.worldSize*this._centerAltitude-p[2]*w]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(r){const l=this._maxCameraBoundsDistance()*Math.cos(this._pitch),p=this._camera.position[2],v=r[2];let w=1;this.projection.wrap&&(this.center=this.center.wrap()),v>0&&(w=Math.min((l-p)/v,1)),this._camera.position=i.bF([],this._camera.position,r,w),this._updateStateFromCamera()}_updateStateFromCamera(){const r=this._camera.position,l=this._camera.forward(),{pitch:p,bearing:v}=this._camera.getPitchBearing(),w=i.c6(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,C=this._mercatorZfromZoom(this._maxZoom)*Math.cos(i.al(this._maxPitch)),P=Math.max((r[2]-w)/Math.cos(p),C),L=this._zoomFromMercatorZ(P);i.bF(r,r,l,P),this._pitch=i.aD(p,i.al(this.minPitch),i.al(this.maxPitch)),this.angle=i.bX(v,-Math.PI,Math.PI),this._setZoom(i.aD(L,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new i.ac(r[0],r[1],r[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(r){return Math.pow(2,r)*this.tileSize}_mercatorZfromZoom(r){return this.cameraToCenterDistance/this._worldSizeFromZoom(r)}_minimumHeightOverTerrain(){const r=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(r)}_zoomFromMercatorZ(r){return this.scaleZoom(this.cameraToCenterDistance/(r*this.tileSize))}zoomFromMercatorZAdjusted(r){let l=0,p=i.cx,v=0,w=1/0;for(;p-l>1e-6&&p>l;){const C=l+.5*(p-l),P=this.tileSize*Math.pow(2,C),L=this.getCameraToCenterDistance(this.projection,C,P),z=this.scaleZoom(L/(r*this.tileSize)),j=Math.abs(C-z);j<w&&(w=j,v=C),C<z?l=C:p=C}return v}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(i.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(r,l){const p=Math.min(r.x,l.x),v=Math.max(r.x,l.x),w=Math.min(r.y,l.y),C=Math.max(r.y,l.y);if(w<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const P=[new i.P(p,w),new i.P(v,C),new i.P(p,C),new i.P(v,w)],L=this.renderWorldCopies?-3:0,z=this.renderWorldCopies?4:1;for(const j of P){const H=this.pointRayIntersection(j);if(H.t<0)return!0;const $=this.rayIntersectionCoordinate(H);if($.x<L||$.y<0||$.x>z||$.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+i.cJ(this.fovAboveCenter)>88||this.anyCornerOffEdge(new i.P(0,0),new i.P(this.width,this.height))}zoomDeltaToMovement(r,l){const p=i.ae(i.at([],this._camera.position,r)),v=this._zoomFromMercatorZ(p)+l;return p-this._mercatorZfromZoom(v)}getCameraPoint(){if(this.projection.name==="globe"){const r=function([l,p,v],w){const C=[l,p,v,1];i.aA(C,C,w);const P=C[3]=Math.max(C[3],1e-6);return C[0]/=P,C[1]/=P,C[2]/=P,C}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new i.P(r[0],r[1])}{const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.P(0,r))}}getCameraToCenterDistance(r,l=this.zoom,p=this.worldSize){const v=i.cA(r,l,this.width,this.height,1024),w=r.pixelSpaceConversion(this.center.lat,p,v);let C=.5/Math.tan(.5*this._fov)*this.height*w;return this.isOrthographic&&(C=i.ai(1,C,i.cO(this.pitch>=cc?1:this.pitch/cc))),C}getWorldToCameraMatrix(){const r=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&i.az(r,r,this.globeMatrix),r}getFrustum(r){return i.cn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,r,this.projection.zAxisUnit==="meters")}}const Qa=(f,r)=>{if(r>0&&f.terrain&&i.w("Cutoff is currently disabled on terrain"),r<=0||f.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const l=f.transform,p=Math.max(Math.abs(l._zoom-(f.minCutoffZoom-1)),1),v=l.isLODDisabled(!1)?i.af(60,45,l.pitch):i.af(30,15,l.pitch),w=l._farZ-l._nearZ,C=r*l.height,P=((1-(L=v))*l.cameraToCenterDistance+L*(l._farZ+C))*p;var L;return{shouldRenderCutoff:v<1,uniformValues:{u_cutoff_params:[l._nearZ,l._farZ,(P-l._nearZ)/w,(P-C-l._nearZ)/w]}}},Gs={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class Fh{constructor(r,l){this.aabb=r,this.lastCascade=l}}class Gc{add(r,l){const p=this.receivers[r.key];p!==void 0?(p.aabb.min[0]=Math.min(p.aabb.min[0],l.min[0]),p.aabb.min[1]=Math.min(p.aabb.min[1],l.min[1]),p.aabb.min[2]=Math.min(p.aabb.min[2],l.min[2]),p.aabb.max[0]=Math.max(p.aabb.max[0],l.max[0]),p.aabb.max[1]=Math.max(p.aabb.max[1],l.max[1]),p.aabb.max[2]=Math.max(p.aabb.max[2],l.max[2])):this.receivers[r.key]=new Fh(l,null)}clear(){this.receivers={}}get(r){return this.receivers[r.key]}computeRequiredCascades(r,l,p){const v=i.cV.fromPoints(r.points);let w=0;for(const C in this.receivers){const P=this.receivers[C];if(!P||!v.intersectsAabb(P.aabb))continue;P.aabb.min=v.closestPoint(P.aabb.min),P.aabb.max=v.closestPoint(P.aabb.max);const L=P.aabb.getCorners();for(let z=0;z<p.length;z++){let j=!0;for(const H of L){const $=[H[0]*l,H[1]*l,H[2]];if(i.ad($,$,p[z].matrix),$[0]<-1||$[0]>1||$[1]<-1||$[1]>1){j=!1;break}}if(P.lastCascade=z,w=Math.max(w,z),j)break}}return w+1}}class J_{constructor(r){this.painter=r,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new Gc,this._depthMode=new gn(r.context.gl.LEQUAL,gn.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,r.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),r.tp.registerParameter(Gs,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),r.tp.registerParameter(Gs,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),r.tp.registerParameter(Gs,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),r.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const r of this._cascades)r.texture.destroy(),r.framebuffer.destroy();this._cascades=[]}updateShadowParameters(r,l){const p=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!l||!l.properties)return;const v=l.properties.get("shadow-intensity");if(!l.shadowsEnabled()||v<=0||(this._shadowLayerCount=p.style.order.reduce((re,te)=>{const oe=p.style._mergedLayers[te];return re+(oe.hasShadowPass()&&!oe.isHidden(r.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const w=p.context,C=Gs.shadowMapResolution,P=Gs.shadowMapResolution;if(this._cascades.length===0||Gs.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let re=0;re<Gs.cascadeCount;++re){const te=p._shadowMapDebug,oe=w.gl,ne=w.createFramebuffer(C,P,te,"texture"),ye=new i.T(w,{width:C,height:P,data:null},oe.DEPTH_COMPONENT16);if(ne.depthAttachment.set(ye.texture),te){const Se=new i.T(w,{width:C,height:P,data:null},oe.RGBA8);ne.colorAttachment.set(Se.texture)}this._cascades.push({framebuffer:ne,texture:ye,matrix:[],far:0,boundingSphereRadius:0,frustum:new i.cn,scale:0})}}this.shadowDirection=Nh(l);let L=0;if(r.elevation){const re=r.elevation,te=[1e4,-1e4];re.visibleDemTiles.filter(oe=>oe.dem).forEach(oe=>{const ne=oe.dem.tree;te[0]=Math.min(te[0],ne.minimums[0]),te[1]=Math.max(te[1],ne.maximums[0])}),te[0]!==1e4&&(L=(te[1]-te[0])*re.exaggeration())}const z=1.5*r.cameraToCenterDistance,j=3*z,H=new Float64Array(16);for(let re=0;re<this._cascades.length;++re){const te=this._cascades[re];let oe=r.height/50,ne=1;Gs.cascadeCount===1?ne=j:re===0?ne=z:(oe=z,ne=j);const[ye,Se]=Vf(r,this.shadowDirection,oe,ne,Gs.shadowMapResolution,L);te.scale=r.scale,te.matrix=ye,te.boundingSphereRadius=Se,i.bi(H,te.matrix),te.frustum=i.cn.fromInvProjectionMatrix(H,1,0,!0),te.far=ne}const $=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[$].far,this._cascades[$].far],this._uniformValues.u_shadow_intensity=v,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Gs.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Gs.shadowMapResolution,this._uniformValues.u_shadowmap_0=Fo.ShadowMap0,this._uniformValues.u_shadowmap_1=Fo.ShadowMap0+1,this._groundShadowTiles=p.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const q=p.transform.elevation;for(const re of this._groundShadowTiles){let te={min:0,max:0};if(q){const oe=q.getMinMaxForTile(re);oe&&(te=oe)}this.addShadowReceiver(re.toUnwrapped(),te.min,te.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(r){this._enabled=r}drawShadowPass(r,l){if(!this.enabled)return;const p=this.painter,v=p.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(p.transform.getFrustum(0),p.transform.worldSize,this._cascades),v.viewport.set([0,0,Gs.shadowMapResolution,Gs.shadowMapResolution]);for(let w=0;w<this._numCascadesToRender;++w){p.currentShadowCascade=w,v.bindFramebuffer.set(this._cascades[w].framebuffer.framebuffer),v.clear({color:i.am.white,depth:1});for(const C of r.order){const P=r._mergedLayers[C];if(!P.hasShadowPass()||P.isHidden(p.transform.zoom))continue;const L=r.getLayerSourceCache(P),z=L?l[L.id]:void 0;(P.type==="model"||z&&z.length)&&p.renderLayer(p,L,P,z)}}p.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const r=this.painter,l=r.style,p=r.context,v=l.directionalLight,w=l.ambientLight;if(!v||!w)return;const C=[],P=Qa(r,r.longestCutoffRange);P.shouldRenderCutoff&&C.push("RENDER_CUTOFF"),C.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&C.push("NORMAL_OFFSET");const L=Ia(l,v,w),z=new gn(p.gl.LEQUAL,gn.ReadOnly,r.depthRangeFor3D);for(const j of this._groundShadowTiles){const H=j.toUnwrapped(),$=r.isTileAffectedByFog(j),q=r.getOrCreateProgram("groundShadow",{defines:C,overrideFog:$});this.setupShadows(H,q),r.uploadCommonUniforms(p,q,H,null,P);const re={u_matrix:r.transform.calculateProjMatrix(H),u_ground_shadow_factor:L};q.draw(r,p.gl.TRIANGLES,z,zn.disabled,or.multiply,Bn.disabled,re,"ground_shadow",r.tileExtentBuffer,r.quadTriangleIndexBuffer,r.tileExtentSegments,null,r.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?or.unblended:or.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(r){const l=this.painter.transform,p=l.calculatePosMatrix(r,l.worldSize);return i.az(p,this._cascades[this.painter.currentShadowCascade].matrix,p),Float32Array.from(p)}calculateShadowPassMatrixFromMatrix(r){return i.az(r,this._cascades[this.painter.currentShadowCascade].matrix,r),Float32Array.from(r)}setupShadows(r,l,p,v=0){if(!this.enabled)return;const w=this.painter.transform,C=this.painter.context,P=C.gl,L=this._uniformValues,z=new Float64Array(16),j=w.calculatePosMatrix(r,w.worldSize);for(let H=0;H<this._cascades.length;H++)i.az(z,this._cascades[H].matrix,j),L[H===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(z),C.activeTexture.set(P.TEXTURE0+Fo.ShadowMap0+H),this._cascades[H].texture.bind(P.NEAREST,P.CLAMP_TO_EDGE);if(this.useNormalOffset=!!p,this.useNormalOffset){const H=i.cT(r.canonical),$=2/w.tileSize*i.aj/Gs.shadowMapResolution,q=$*this._cascades[0].boundingSphereRadius,re=$*this._cascades[this._cascades.length-1].boundingSphereRadius,te=(p==="vector-tile"?1:3)/Math.pow(2,v-r.canonical.z-(1-w.zoom+Math.floor(w.zoom)));L.u_shadow_normal_offset=[H,q*te,re*te],L.u_shadow_bias=[6e-5,.0012,.012]}else L.u_shadow_bias=[36e-5,.0012,.012];l.setShadowUniformValues(C,L)}setupShadowsFromMatrix(r,l,p=!1){if(!this.enabled)return;const v=this.painter.context,w=v.gl,C=this._uniformValues,P=new Float64Array(16);for(let L=0;L<Gs.cascadeCount;L++)i.az(P,this._cascades[L].matrix,r),C[L===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(P),v.activeTexture.set(w.TEXTURE0+Fo.ShadowMap0+L),this._cascades[L].texture.bind(w.NEAREST,w.CLAMP_TO_EDGE);if(this.useNormalOffset=p,p){const L=Gs.normalOffset;C.u_shadow_normal_offset=[1,L,L],C.u_shadow_bias=[6e-5,.0012,.012]}else C.u_shadow_bias=[36e-5,.0012,.012];l.setShadowUniformValues(v,C)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(r,l,p,v){if(v[2]>=0)return{};const w=function(L,z,j){const H=j/(1<<L.canonical.z);return new i.cV([L.canonical.x*H+L.wrap*j,L.canonical.y*H+L.wrap*j,0],[(L.canonical.x+1)*H+L.wrap*j,(L.canonical.y+1)*H+L.wrap*j,z])}(r,l,p).getCorners(),C=l/-v[2];v[0]<0?(i.cU(w[0],w[0],[v[0]*C,0,0]),i.cU(w[3],w[3],[v[0]*C,0,0])):v[0]>0&&(i.cU(w[1],w[1],[v[0]*C,0,0]),i.cU(w[2],w[2],[v[0]*C,0,0])),v[1]<0?(i.cU(w[0],w[0],[0,v[1]*C,0]),i.cU(w[1],w[1],[0,v[1]*C,0])):v[1]>0&&(i.cU(w[2],w[2],[0,v[1]*C,0]),i.cU(w[3],w[3],[0,v[1]*C,0]));const P={};return P.vertices=w,P.planes=[Al(w[1],w[0],w[4]),Al(w[2],w[1],w[5]),Al(w[3],w[2],w[6]),Al(w[0],w[3],w[7])],P}addShadowReceiver(r,l,p){this._receivers.add(r,i.cV.fromTileIdAndHeight(r,l,p))}getMaxCascadeForTile(r){const l=this._receivers.get(r);return l&&l.lastCascade?l.lastCascade:0}}function Al(f,r,l){const p=i.at([],l,r),v=i.at([],f,r),w=i.bG([],p,v),C=i.ae(w);return C===0?[0,0,1,0]:(i.b$(w,w,1/C),[w[0],w[1],w[2],-i.bE(w,r)])}function Nh(f){const r=f.properties.get("direction"),l=i.cR(r.x,r.y,r.z);l[2]=i.aD(l[2],0,75);const p=i.cW([l[0],l[1],l[2]]);return i.cS(p.x,p.y,p.z)}function Ia(f,r,l){const p=r.properties.get("color-use-theme")==="none",v=r.properties.get("color"),w=r.properties.get("intensity"),C=r.properties.get("direction"),P=[C.x,C.y,C.z],L=l.properties.get("color-use-theme")==="none",z=l.properties.get("color"),j=l.properties.get("intensity"),H=Math.max(i.bE([0,0,1],P),0),$=[0,0,0];i.b$($,z.toRenderColor(L?null:f.getLut(r.scope)).toArray01Linear().slice(0,3),j);const q=[0,0,0];return i.b$(q,v.toRenderColor(p?null:f.getLut(l.scope)).toArray01Linear().slice(0,3),H*w),i.cX([$[0]>0?$[0]/($[0]+q[0]):0,$[1]>0?$[1]/($[1]+q[1]):0,$[2]>0?$[2]/($[2]+q[2]):0])}function Vf(f,r,l,p,v,w){const C=f.zoom,P=f.scale,L=f.worldSize,z=1/L,j=f.aspect,H=Math.sqrt(1+j*j)*Math.tan(.5*f.fovX),$=H*H,q=p-l,re=p+l;let te,oe;$>q/re?(te=p,oe=p*H):(te=.5*re*(1+$),oe=.5*Math.sqrt(q*q+2*(p*p+l*l)*$+re*re*$*$));const ne=f.projection.pixelsPerMeter(f.center.lat,L),ye=f._camera.getCameraToWorldMercator(),Se=[0,0,-te*z];i.ad(Se,Se,ye);let Te=oe*z;const ke=f._edgeInsets;if(!(ke.left===0&&ke.top===0&&ke.right===0&&ke.bottom===0||ke.left===ke.right&&ke.top===ke.bottom)){const Ot=f._camera.getWorldToCamera(f.worldSize,f.projection.zAxisUnit==="meters"?ne:1),Mt=f._camera.getCameraToClipPerspective(f._fov,f.width/f.height,l,p);Mt[8]=2*-f.centerOffset.x/f.width,Mt[9]=2*f.centerOffset.y/f.height;const Nt=new Float64Array(16);i.cB(Nt,Mt,Ot);const Vt=new Float64Array(16);i.bi(Vt,Nt);const pn=i.cn.fromInvProjectionMatrix(Vt,L,C,!0);for(const bn of pn.points){const rn=((De=bn)[0]/=P,De[1]/=P,De[2]=i.c6(De[2],f._center.lat),De);Te=Math.max(Te,i.c0(i.cY([],Se,rn)))}}var De;Te*=v/(v-1);const Me=Math.acos(r[2]),Pe=Math.atan2(-r[0],-r[1]),Oe=new Co;Oe.position=Se,Oe.setPitchBearing(Me,Pe);const Ne=Oe.getWorldToCamera(L,ne),ht=Te*L,rt=Math.min(f._mercatorZfromZoom(17)*L*-2,-2*ht),Tt=Oe.getCameraToClipOrthographic(-ht,ht,-ht,ht,rt,(ht+w*ne)/r[2]),It=new Float64Array(16);i.az(It,Tt,Ne);const Ht=i.cS(Math.floor(1e6*Se[0])/1e6*L,Math.floor(1e6*Se[1])/1e6*L,0),Qe=.5*v,dt=[0,0,0];i.ad(dt,Ht,It),i.b$(dt,dt,Qe);const Je=[Math.floor(dt[0]),Math.floor(dt[1]),Math.floor(dt[2])],Dt=[0,0,0];i.at(Dt,dt,Je),i.b$(Dt,Dt,-1/Qe);const mt=new Float64Array(16);return i.bx(mt),i.bo(mt,mt,Dt),i.az(It,mt,It),[It,ht]}class uc extends i.E{constructor(r){super(),this.requestManager=r,this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}loadModel(r,l){return i.aS(this.requestManager.transformRequest(l,i.R.Model).url).then(p=>{if(!p)return;const v=i.aT(p),w=new i.aU(r,void 0,void 0,v);return w.computeBoundsAndApplyParent(),w}).catch(p=>{if(p&&p.status===404)return null;this.fire(new i.z(new Error(`Could not load model ${r} from ${l}: ${p.message}`)))})}load(r,l,p={forceReload:!1}){this.models[l]||(this.models[l]={});const v=Object.keys(r),w=[],C=[];for(const P of v){const L=r[P];this.hasURLBeenRequested(L)&&!p.forceReload||(this.modelByURL[L]={modelId:P,scope:l},w.push(this.loadModel(P,L)),C.push(P)),this.models[l][P]||(this.models[l][P]={model:null,numReferences:1})}this.numModelsLoading[l]=(this.numModelsLoading[l]||0)+C.length,Promise.allSettled(w).then(P=>{for(let L=0;L<P.length;L++){const{status:z}=P[L];if(z==="rejected")continue;const{value:j}=P[L];this.models[l][C[L]]||(this.models[l][C[L]]={model:null,numReferences:1}),this.models[l][C[L]].model=j}this.numModelsLoading[l]-=C.length,this.fire(new i.A("data",{dataType:"style"}))}).catch(P=>{this.fire(new i.z(new Error(`Could not load models: ${P.message}`)))})}isLoaded(){for(const r in this.numModelsLoading)if(this.numModelsLoading[r]>0)return!1;return!0}hasModel(r,l,p={exactIdMatch:!1}){return!!(p.exactIdMatch?this.getModel(r,l):this.getModelByURL(this.modelUris[l][r]))}getModel(r,l){return this.models[l]||(this.models[l]={}),this.models[l][r]?this.models[l][r].model:void 0}getModelByURL(r){if(!r)return null;const l=this.modelByURL[r];return l?this.models[l.scope][l.modelId].model:null}hasModelBeenAdded(r,l){return this.models[l]&&this.models[l][r]!==void 0}getModelURIs(r){return this.modelUris[r]||{}}addModel(r,l,p){this.models[p]||(this.models[p]={}),this.modelUris[p]||(this.modelUris[p]={});const v=this.requestManager.normalizeModelURL(l);if((this.hasModel(r,p,{exactIdMatch:!0})||this.hasModelBeenAdded(r,p))&&this.modelUris[p][r]===v)this.models[p][r].numReferences++;else if(this.hasURLBeenRequested(v)){const{scope:w,modelId:C}=this.modelByURL[v];this.models[w][C].numReferences++}else this.modelUris[p][r]=v,this.load({[r]:this.modelUris[p][r]},p)}addModelURLs(r,l){this.models[l]||(this.models[l]={}),this.modelUris[l]||(this.modelUris[l]={});const p=this.modelUris[l];for(const v in r)p[v]=this.requestManager.normalizeModelURL(r[v])}reloadModels(r){this.load(this.modelUris[r],r,{forceReload:!0})}addModelsFromBucket(r,l){this.models[l]||(this.models[l]={}),this.modelUris[l]||(this.modelUris[l]={});const p={};for(const v of r)this.hasModel(v,l,{exactIdMatch:!0})||this.hasURLBeenRequested(v)?this.models[l][v].numReferences++:this.modelUris[l][v]&&!this.hasURLBeenRequested(v)?p[v]=this.modelUris[l][v]:!this.hasURLBeenRequested(v)&&i.cZ(v,!1)&&(this.modelUris[l][v]=this.requestManager.normalizeModelURL(v),p[v]=this.modelUris[l][v]);this.load(p,l)}hasURLBeenRequested(r){return this.modelByURL[r]!==void 0}removeModel(r,l,p=!1){if(this.models[l]&&this.models[l][r]&&(this.models[l][r].numReferences--,this.models[l][r].numReferences===0)){const v=this.modelUris[l][r];p||delete this.modelUris[l][r],delete this.modelByURL[v];const w=this.models[l][r].model;if(!w)return;delete this.models[l][r],w.destroy()}}destroy(){for(const r of Object.keys(this.models))for(const l of Object.keys(this.models[r])){const p=this.models[r][l].model;delete this.models[r][l],p&&p.destroy()}this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}listModels(r){return this.models[r]||(this.models[r]={}),Object.keys(this.models[r])}upload(r,l){this.models[l]||(this.models[l]={});for(const p in this.models[l])this.models[l][p].model&&this.models[l][p].model.upload(r.context)}}const bg=new i.a7({data:new i.a8(i.a5.colorTheme.data)}),Q_={"mbx-indoor-active-floorplans":{default:["literal",[]]},"mbx-indoor-underground":{default:["literal",!1]},"mbx-indoor-loaded-levels":{default:["literal",[]]},"mbx-indoor-level-height":{default:["literal",{}]},"mbx-indoor-level-base":{default:["literal",{}]},"mbx-indoor-level-selected":{default:["literal",{}]},"mbx-indoor-level-overlapped":{default:["literal",{}]}};function wg(f){return f=f||{},Object.assign(f,Q_)}class Sg extends i.E{constructor(r){super(),this.mergeFloors=!0,this._scope=void 0,this._queryFeatureSetId=void 0,this._buildingEntryFeatureSetId=void 0,this._selectedFloorplan=void 0,this._indoorData=void 0,this._selectedLevel=void 0,this._floorplanStates={},i.aV(["_onLoad","_onMove","_checkFloorplanVisible"],this),this._map=r,this._checkFloorplanVisible(!0),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=void 0}_onLoad(){this._map.style.forEachFragmentStyle(r=>{r.stylesheet.indoor&&(this._queryFeatureSetId?this.fire(new i.z(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._queryFeatureSetId=r.stylesheet.indoor.floorplanFeaturesetId,this._buildingEntryFeatureSetId=r.stylesheet.indoor.buildingFeaturesetId,this._scope=r.scope))}),this._queryFeatureSetId&&this._buildingEntryFeatureSetId&&this._map.addInteraction("mbx-indoor-buildingclick",{type:"click",target:{featuresetId:this._buildingEntryFeatureSetId,importId:this._scope},handler:r=>(r.feature&&r.feature.properties.floorplan&&this.selectFloorplan(r.feature.properties.floorplan),!0)}),this._checkFloorplanVisible(!0)}_onMove(){this._checkFloorplanVisible(!1)}_checkFloorplanVisible(r){if(!this._queryFeatureSetId||!this._map.isStyleLoaded()||this._map.transform.zoom<13)return;this._indoorData&&!function(C,P){const[L,z]=C,{center:j,radius:H}=P,[$,q]=j,re=Math.abs(L-$);return Math.sqrt((re>180?360-re:re)**2+(z-q)**2)<=H}([this._map.getCenter().lng,this._map.getCenter().lat],this._indoorData.circumCircle)&&(this._indoorData=void 0,this._selectedFloorplan=void 0,this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[]]),this.fire(new i.A("floorplangone")));const l={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},p=new i.P(this._map.transform.width/2,this._map.transform.height/2),v=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],w=this._map.queryRenderedFeatures(r?v:p,l);w.length>0&&(this._selectedFloorplan&&w[0].properties.id===this._selectedFloorplan.properties.id||(this._selectedFloorplan=w[0],this._floorplanSelected(!1)))}_floorplanSelected(r){this._indoorData=JSON.parse(this._selectedFloorplan.properties["indoor-data"]),this._indoorData.id=this._selectedFloorplan.properties.id,this._indoorData.circumCircle=function(w){const[[C,P],[L,z]]=w,j=(L-C+360)%360,H=j>180?360-j:j;return{center:[(C+H/2+360)%360,(P+z)/2],radius:Math.sqrt(H**2+(z-P)**2)/2}}(this._indoorData.extent),this._floorplanStates[this._indoorData.id]||(this._floorplanStates[this._indoorData.id]={});const l=this._floorplanStates[this._indoorData.id].selectedBuilding,p=this._floorplanStates[this._indoorData.id].selectedLevel;let v;if(this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",this._indoorData.floorplanIDs),this._selectedLevel)for(const w of this._indoorData.levels)w.id===this._selectedLevel.id&&(v=w.id);if(this.fire(new i.A("floorplanselected",{buildings:this._indoorData.buildings,levels:this._indoorData.levels,selectedLevelId:v})),l){const w=this._indoorData.buildings.find(C=>C.id===l);this._buildingSelected(w,!1)}else this._indoorData.buildings.length>0&&this._buildingSelected(this._indoorData.buildings[0],!1);if(p){const w=this._indoorData.levels.find(C=>C.id===p);this._updateLevels(w,r)}else r&&this._indoorData["default-levels"].length>0&&this.selectLevel(this._indoorData["default-levels"][0])}_buildingSelected(r,l){l&&r&&r.extent&&this._map.fitBounds(r.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),this._floorplanStates[this._indoorData.id].selectedBuilding=r?r.id:void 0;const p=this._indoorData.levels.filter(v=>r.levels.includes(v.id));this.fire(new i.A("buildingselected",{buildingId:r.id,levels:p}))}_levelSelected(r){if(r==="overview")this._updateLevels(void 0,!0);else{const l=this._indoorData.levels.find(p=>p.id===r);this._updateLevels(l,!0)}this.fire(new i.A("levelselected",{levelId:r==="overview"?void 0:r}))}_updateLevels(r,l){if(!r)return this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",[]]),this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._floorplanStates[this._indoorData.id].selectedLevel=void 0,void(l&&this._indoorData.extent&&this._map.fitBounds(this._indoorData.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}));function p(z){const j=z.indexOf("/floor/");if(j===-1)return z;const H=j+7,$=z.indexOf("/",H);return $===-1?z.slice(H):z.slice(H,$)}this._selectedLevel=r,this._floorplanStates[this._indoorData.id].selectedLevel=r?r.id:void 0;const v=[],w={},C={},P={},L={};for(const z of this._indoorData.levels)if(v.push(z.id),w[z.id]=z.height,C[z.id]=z.base,r){if(this.mergeFloors){const j=p(r.id),H=p(z.id);P[z.id]=H===j?"true":"false"}else P[z.id]=z.id===r.id?"true":"false";L[z.id]=z.base<r.base?"true":"false"}else L[z.id]=!0;if(this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",v]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-height",["literal",w]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-base",["literal",C]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",P]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-overlapped",["literal",L]),r&&(this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!!r.isUnderground),l&&r.extent)){const z=this._map.cameraForBounds(r.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),j=this._map.getZoom(),H=z.zoom?Math.abs(j-z.zoom):0;this._map.fitBounds(r.extent,H>=1?{pitch:this._map.getPitch(),bearing:this._map.getBearing()}:{pitch:this._map.getPitch(),bearing:this._map.getBearing(),zoom:j})}}selectFloorplan(r){const l={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},p=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],v=this._map.queryRenderedFeatures(p,l);if(v.length>0){for(const w of v)if(JSON.parse(w.properties["indoor-data"]).floorplanIDs.includes(r)){this._selectedFloorplan=w,this._floorplanSelected(!0);break}}}selectBuilding(r){const l=this._indoorData.buildings.find(p=>p.id===r);this._buildingSelected(l,!0)}selectLevel(r){this._levelSelected(r)}}function ey(f){if(!f.metadata||!f.metadata.content_area)return;const r=i.q.devicePixelRatio,{left:l,top:p,width:v,height:w}=f.metadata.content_area,C=l*r,P=p*r;return[C,P,C+v*r,P+w*r]}function Uf(f){if(f)return f.map(([r,l])=>[r*i.q.devicePixelRatio,l*i.q.devicePixelRatio])}class Pa{constructor(r,l,p){this.id=r,this.scope=l,this.sourceCache=p,this.pendingRequests=new Set,this.missingRequests=new Set}addPendingRequest(r){this.missingRequests.has(r.name)||this.pendingRequests.has(r.name)||this.pendingRequests.add(r.name)}hasPendingRequests(){return this.pendingRequests.size>0}resolvePendingRequests(){const r=new Map;if(!this.sourceCache.loaded())return r;const l=this.sourceCache.getVisibleCoordinates();if(l.length===0)return r;const p=this.sourceCache.getSource();if(!(p instanceof Eu))return r;const v=l.map(C=>this.sourceCache.getTile(C)),w=p.getImages(v,Array.from(this.pendingRequests));for(const[C,P]of w)r.set(i.I.from({name:C,iconsetId:this.id}),P),this.pendingRequests.delete(C);for(const C of this.pendingRequests)this.missingRequests.add(C);return this.pendingRequests.clear(),r}}const Aa=(f,r)=>Xe(f,r&&r.filter(l=>l.identifier!=="source.canvas")),om=i.aF(Br,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport","addIconset","removeIconset"]),am=i.aF(Br,["setCenter","setZoom","setBearing","setPitch"]),Rl=new Set(["background","sky","slot","custom"]),Md={version:8,layers:[],sources:{}},jh={duration:300,delay:0};class Ra extends i.E{constructor(r,l={}){super(),this.map=r,this.scope=l.scope||"",this.globalId=null,this.fragments=[],this.importDepth=l.importDepth||0,this.importsCache=l.importsCache||new Map,this.resolvedImports=l.resolvedImports||new Set,this.transition=i.l({},jh),this._buildingIndex=new xd(this),this.crossTileSymbolIndex=new ks,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=l.styleChanges||new An,this.dispatcher=l.dispatcher?l.dispatcher:new i.D(i.d0(),this),l.imageManager?this.imageManager=l.imageManager:(this.imageManager=new mn(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.addScope(this.scope),this.glyphManager=l.glyphManager?l.glyphManager:new i.d1(r._requestManager,l.localFontFamily?i.d2.all:l.localIdeographFontFamily?i.d2.ideographs:i.d2.none,l.localFontFamily||l.localIdeographFontFamily),l.modelManager?this.modelManager=l.modelManager:(this.modelManager=new uc(r._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._availableModels={},this._order=[],this._markersNeedUpdate=!1,this.options=l.configOptions?l.configOptions:new Map,this._configDependentLayers=l.configDependentLayers?l.configDependentLayers:new Set,this._config=l.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:l.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=l.initialConfig,this.dispatcher.broadcast("setReferrer",i.d3());const p=this;this._rtlTextPluginCallback=Ra.registerForPluginStateChange(v=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:v.pluginStatus,pluginURL:v.pluginURL},(w,C)=>{if(i.d4(w),C&&C.every(P=>P))for(const P in p._sourceCaches){const L=p._sourceCaches[P],z=L.getSource().type;z!=="vector"&&z!=="geojson"||L.reload()}})}),this.on("data",v=>{if(v.dataType!=="source"||v.sourceDataType!=="metadata")return;const w=this.getOwnSource(v.sourceId);if(w&&w.vectorLayerIds)for(const C in this._layers){const P=this._layers[C];P.source===w.id&&this._validateLayer(P)}})}load(r){return r?(typeof r=="string"?this.loadURL(r):this.loadJSON(r),this):this}_getGlobalId(r){if(!r)return null;if(typeof r=="string"){if(i.f(r))return r;const l=i.d5(r);if(!l.startsWith("http"))try{return new URL(l,location.href).toString()}catch{return l}return l}return`json://${i.d6(JSON.stringify(r))}`}_diffStyle(r,l,p){this.globalId=this._getGlobalId(r);const v=(w,C)=>{try{C(null,this.setState(w,p))}catch(P){C(P,!1)}};if(typeof r=="string"){const w=this.map._requestManager.normalizeStyleURL(r),C=this.map._requestManager.transformRequest(w,i.R.Style);i.n(C,(P,L)=>{P?this.fire(new i.z(P)):L&&v(L,l)})}else typeof r=="object"&&v(r,l)}loadURL(r,l={}){this.fire(new i.A("dataloading",{dataType:"style"}));const p=typeof l.validate=="boolean"?l.validate:!i.f(r);this.globalId=this._getGlobalId(r),r=this.map._requestManager.normalizeStyleURL(r,l.accessToken),this.resolvedImports.add(r);const v=this.importsCache.get(r);if(v)return this._load(v,p);const w=this.map._requestManager.transformRequest(r,i.R.Style);this._request=i.n(w,(C,P)=>{if(this._request=null,C)this.fire(new i.z(C));else if(P)return this.importsCache.set(r,P),this._load(P,p)})}loadJSON(r,l={}){this.fire(new i.A("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(r),this._request=i.q.frame(()=>{this._request=null,this._load(r,l.validate!==!1)})}loadEmpty(){this.fire(new i.A("dataloading",{dataType:"style"})),this._load(Md,!1)}_loadImports(r,l,p){if(this.importDepth>=4)return i.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const v=[];for(const w of r){const C=this._createFragmentStyle(w),P=new Promise(j=>{C.once("style.import.load",j),C.once("error",j)}).then(()=>this.mergeAll());if(v.push(P),this.resolvedImports.has(w.url)){C.loadEmpty();continue}const L=w.data||this.importsCache.get(w.url);L?(C.loadJSON(L,{validate:l}),this._isInternalStyle(L)&&(C.globalId=null)):w.url?C.loadURL(w.url,{validate:l}):C.loadEmpty();const z={style:C,id:w.id,config:w.config};if(p){const j=this.fragments.findIndex(({id:H})=>H===p);this.fragments=this.fragments.slice(0,j).concat(z).concat(this.fragments.slice(j))}else this.fragments.push(z)}return Promise.allSettled(v)}getImportGlobalIds(r=this,l=new Set){for(const p of r.fragments)p.style.globalId&&l.add(p.style.globalId),this.getImportGlobalIds(p.style,l);return[...l.values()]}_createFragmentStyle(r){const l=this.scope?i.C(r.id,this.scope):r.id;let p;const v=this._initialConfig&&this._initialConfig[l];(r.config||v)&&(p=i.l({},r.config,v));const w=new Ra(this.map,{scope:l,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:p,configOptions:this.options,colorThemeOverride:r["color-theme"],configDependentLayers:this._configDependentLayers});return w.setEventedParent(this.map,{style:w}),w}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(r){return this.isRootStyle()&&(r.fragment||!!r.schema&&r.fragment!==!1)}_load(r,l){const p=r.indoor?wg(r.schema):r.schema;if(this._isInternalStyle(r)){const C=i.l({},Md,{imports:[{id:"basemap",data:r,url:""}]});return void this._load(C,l)}if(this.updateConfig(this._config,p),l&&Aa(this,xo(r)))return;this._loaded=!0,this.stylesheet=i.d7(r);const v=()=>{for(const z in r.sources)this.addSource(z,r.sources[z],{validate:!1,isInitialLoad:!0});if(r.iconsets)for(const z in r.iconsets)this.addIconset(z,r.iconsets[z]);r.sprite?this._loadIconset(r.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.setGlyphsUrl(r.glyphs);const C=Ja(this.stylesheet.layers);if(this._order=C.map(z=>z.id),this.stylesheet.light&&i.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const z=this.stylesheet.lights[0];this.light=new pt(z.properties,z.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new pt(this.stylesheet.light)),this._layers={};for(const z of C){const j=i.dc(z,this.scope,this._styleColorTheme.lut,this.options);j.configDependencies.size!==0&&this._configDependentLayers.add(j.fqid),j.setEventedParent(this,{layer:{id:j.id}}),this._layers[j.id]=j;const H=this.getOwnLayerSourceCache(j),$=!!this.directionalLight&&this.directionalLight.shadowsEnabled();H&&j.canCastShadows()&&$&&(H.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.addModelURLs(this.stylesheet.models);const P=this.stylesheet.terrain;P&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(P,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new i.A("data",{dataType:"style"}));const L=this.isRootStyle();r.imports?this._loadImports(r.imports,l).then(()=>{this._reloadImports(),this.fire(new i.A(L?"style.load":"style.import.load"))}).catch(z=>{this.fire(new i.z(new Error("Failed to load imports",z))),this.fire(new i.A(L?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new i.A(L?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const w=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(w){const C=this._evaluateColorThemeData(w);this._loadColorTheme(C).then(()=>{v()}).catch(P=>{i.w(`Couldn't load color theme from the stylesheet: ${P}`),v()})}else this._styleColorTheme.lut=null,v()}isRootStyle(){return this.importDepth===0}mergeAll(){let r,l,p,v,w,C,P,L,z,j;const H={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle($=>{if($.stylesheet){if($.light!=null&&(r=$.light),$.stylesheet.lights)for(const q of $.stylesheet.lights)q.type==="ambient"&&$.ambientLight!=null&&(l=$.ambientLight),q.type==="directional"&&$.directionalLight!=null&&(p=$.directionalLight);v=this._prioritizeTerrain(v,$.terrain,$.stylesheet.terrain),$.stylesheet.fog&&$.fog!=null&&(w=$.fog),$.stylesheet.snow&&$.snow!=null&&(C=$.snow),$.stylesheet.rain&&$.rain!=null&&(P=$.rain),$.stylesheet.camera!=null&&(j=$.stylesheet.camera),$.stylesheet.projection!=null&&(L=$.stylesheet.projection),$.stylesheet.transition!=null&&(z=$.stylesheet.transition),H[$.scope]=$._styleColorTheme}}),this.light=r,this.ambientLight=l,this.directionalLight=p,this.fog=w,this.snow=C,this.rain=P,this._styleColorThemeForScope=H,v===null?delete this.terrain:this.terrain=v,this.camera=j||{"camera-projection":"perspective"},this.projection=L||{name:"mercator"},this.transition=i.l({},jh,z),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(r){const l=p=>{for(const v of p.fragments)l(v.style);r(p)};l(this)}_prioritizeTerrain(r,l,p){const v=r&&r.drapeRenderMode===0;return p===null?l&&l.drapeRenderMode===0?l:v?r:null:l!=null&&(!r||v||l&&l.drapeRenderMode===1)?l:r}mergeTerrain(){let r;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(l=>{r=this._prioritizeTerrain(r,l.terrain,l.stylesheet.terrain)}),r===null?delete this.terrain:this.terrain=r}mergeProjection(){let r;this.forEachFragmentStyle(l=>{l.stylesheet.projection!=null&&(r=l.stylesheet.projection)}),this.projection=r||{name:"mercator"}}mergeSources(){const r={},l={},p={};this.forEachFragmentStyle(v=>{for(const w in v._sourceCaches){const C=i.C(w,v.scope);r[C]=v._sourceCaches[w]}for(const w in v._otherSourceCaches){const C=i.C(w,v.scope);l[C]=v._otherSourceCaches[w]}for(const w in v._symbolSourceCaches){const C=i.C(w,v.scope);p[C]=v._symbolSourceCaches[w]}}),this._mergedSourceCaches=r,this._mergedOtherSourceCaches=l,this._mergedSymbolSourceCaches=p}mergeLayers(){const r={},l=[],p={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(w=>{for(const C of w._order){const P=w._layers[C];if(P.type==="slot"){const L=i.d8(C);if(r[L])continue;r[L]=[]}P.slot&&r[P.slot]?r[P.slot].push(P):l.push(P)}}),this._mergedOrder=[];const v=(w=[])=>{for(const C of w)if(C.type==="slot"){const P=i.d8(C.id);r[P]&&v(r[P]),this._mergedSlots.push(P)}else{const P=i.C(C.id,C.scope);this._mergedOrder.push(P),p[P]=C,C.is3D(!!this.terrain)&&(this._has3DLayers=!0),C.type==="circle"&&(this._hasCircleLayers=!0),C.type==="symbol"&&(this._hasSymbolLayers=!0),C.type==="clip"&&(this._clipLayerPresent=!0)}};v(l),this._mergedOrder.sort((w,C)=>{const P=p[w],L=p[C];return P.hasInitialOcclusionOpacityProperties?L.is3D(!!this.terrain)?1:0:P.is3D(!!this.terrain)&&L.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=p,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(r){return this.stylesheet.camera=i.l({},this.stylesheet.camera,r),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(r){return r.data?function(l,p,v){const w=i.l({},p);for(const P of Object.keys(i.a5.colorTheme))w[P]===void 0&&(w[P]=i.a5.colorTheme[P].default);const C=new i.a6(bg,l,new Map(v));return C.setTransitionOrValue(w,v),C.untransitioned().possiblyEvaluate(new i.aa(0))}(this.scope,r,this.options).get("data"):null}_loadColorTheme(r){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const l=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((p,v)=>{const w="data:image/png;base64,";if(!r||r.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void p();let C=r;C.startsWith(w)||(C=w+C);const P=i.I.from("mapbox-reserved-lut"),L=new Image;L.src=C,L.onerror=()=>{this._styleColorTheme.lutLoading=!1,v(new Error("Failed to load image data"))},L.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==l)return void p();this._styleColorTheme.lutLoading=!1;const{width:z,height:j,data:H}=i.q.getImageData(L);if(j>32)return void v(new Error("The height of the image must be less than or equal to 32 pixels."));if(z!==j*j)return void v(new Error("The width of the image must be equal to the height squared."));this.getImage(P)&&this.removeImage(P),this.addImage(P,{data:new i.r({width:z,height:j},H),pixelRatio:1,sdf:!1,usvg:!1,version:0});const $=this.imageManager.getImage(P,this.scope);$?(this._styleColorTheme.lut={image:$.data,data:r},p()):v(new Error("Missing LUT image."))}})}getLut(r){const l=this._styleColorThemeForScope[r];return l?l.lut:null}setProjection(r){r?this.stylesheet.projection=r:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(r){this._spriteRequest=function(l,p,v){let w,C,P;const L=i.q.devicePixelRatio>1?"@2x":"";let z=i.n(p.transformRequest(p.normalizeSpriteURL(l,L,".json"),i.R.SpriteJSON),($,q)=>{z=null,P||(P=$,w=q,H())}),j=i.o(p.transformRequest(p.normalizeSpriteURL(l,L,".png"),i.R.SpriteImage),($,q)=>{j=null,P||(P=$,C=q,H())});function H(){if(P)v(P);else if(w&&C){const $=i.q.getImageData(C),q={};for(const re in w){const{width:te,height:oe,x:ne,y:ye,sdf:Se,pixelRatio:Te,stretchX:ke,stretchY:De,content:Me}=w[re],Pe=new i.r({width:te,height:oe});i.r.copy($,Pe,{x:ne,y:ye},{x:0,y:0},{width:te,height:oe},null),q[re]={data:Pe,pixelRatio:Te,sdf:Se,stretchX:ke,stretchY:De,content:Me,usvg:!1}}v(null,q)}}return{cancel(){z&&(z.cancel(),z=null),j&&(j.cancel(),j=null)}}}(r,this.map._requestManager,(l,p)=>{if(this._spriteRequest=null,l)this.fire(new i.z(l));else if(p){const v=new Map;for(const w in p)v.set(i.I.from(w),p[w]);this.addImages(v)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.A("data",{dataType:"style"}))})}addIconset(r,l){if(l.type==="sprite")return void this._loadSprite(l.url);const p=this.getOwnSourceCache(l.source);if(!p)return void this.fire(new i.z(new Error(`Source "${l.source}" as specified by iconset "${r}" does not exist and cannot be used as an iconset source`)));const v=p.getSource();if(v.type!=="raster-array")return void this.fire(new i.z(new Error(`Source "${l.source}" as specified by iconset "${r}" is not a "raster-array" source and cannot be used as an iconset source`)));v.partial=!1;const w=new Pa(r,this.scope,p);this.imageManager.addImageProvider(w,this.scope)}removeIconset(r){this.imageManager.removeImageProvider(r,this.scope)}_loadIconset(r){if(!i.f(r)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(r);const l=this.map._spriteFormat==="auto";var p,v;this._spriteRequest=(v=(w,C)=>{if(this._spriteRequest=null,w)l?this._loadSprite(r):this.fire(new i.z(w));else if(C){const P=new Map;for(const L in C)P.set(i.I.from(L),C[L]);this.addImages(P)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.A("data",{dataType:"style"}))},i.br((p=this.map._requestManager).transformRequest(p.normalizeIconsetURL(r),i.R.Iconset),(w,C)=>{if(w)return void v(w);const P={},L=i.c_(new i.bq(C));for(const z of L.icons){const j={version:1,pixelRatio:i.q.devicePixelRatio,content:ey(z),stretchX:z.metadata?Uf(z.metadata.stretch_x_areas):void 0,stretchY:z.metadata?Uf(z.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:z};P[z.name]=j}v(null,P)}))}_validateLayer(r){const l=this.getOwnSource(r.source);if(!l)return;const p=r.sourceLayer;p&&(l.type==="geojson"||l.vectorLayerIds&&l.vectorLayerIds.indexOf(p)===-1)&&this.fire(new i.z(new Error(`Source layer "${p}" does not exist on source "${l.id}" as specified by style layer "${r.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const r in this._sourceCaches)if(!this._sourceCaches[r].loaded())return!1;if(!this.imageManager.isLoaded()||this.imageManager.hasPatternsInFlight()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:r}of this.fragments)if(!r.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((r,l)=>{const p=this.fragments[l];return p&&p.style&&(r.data=p.style.serialize()),r})}_serializeSources(){const r={};for(const l in this._sourceCaches){const p=this._sourceCaches[l].getSource();r[p.id]||(r[p.id]=p.serialize())}return r}_serializeLayers(r){const l=[];for(const p of r){const v=this._layers[p];v&&v.type!=="custom"&&l.push(v.serialize())}return l}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const r in this._sourceCaches)if(this._sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(r){return r?this.order:this._mergedOrder}isLayerDraped(r){return!!this.terrain&&r.isDraped(this.getLayerSourceCache(r))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(r){const l=this.getOwnLayer(r);if(l)return l;this.fire(new i.z(new Error(`The layer '${r}' does not exist in the map's style.`)))}_checkSource(r){const l=this.getOwnSource(r);if(l)return l;this.fire(new i.z(new Error(`The source '${r}' does not exist in the map's style.`)))}precompilePrograms(r,l){const p=this.map.painter;if(p)for(let v=r.minzoom||0;v<(r.maxzoom||25.5);v++){const w=r.getProgramIds();if(w)for(const C of w){const P=r.getDefaultProgramParams(C,l.zoom,this._styleColorTheme.lut);P&&(p.style=this,this.fog&&(p._fogVisible=!0,P.overrideFog=!0,p.getOrCreateProgram(C,P)),p._fogVisible=!1,P.overrideFog=!1,p.getOrCreateProgram(C,P),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(P.overrideRtt=!0,p.getOrCreateProgram(C,P)))}}}update(r){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(r),this.directionalLight&&this.directionalLight.recalculate(r);const l=this.calculateLightsBrightness();r.brightness=l||0,l!==this._brightness&&(this._brightness=l,this.dispatcher.broadcast("setBrightness",l));const p=this._changes.isDirty();let v=!1;if(this._changes.isDirty()){const P=this._changes.getLayerUpdatesByScope();for(const L in P){const{updatedIds:z,removedIds:j}=P[L];(z||j)&&(this._updateWorkerLayers(L,z,j),v=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(r),this.light&&this.light.updateTransitions(r),this.ambientLight&&this.ambientLight.updateTransitions(r),this.directionalLight&&this.directionalLight.updateTransitions(r),this.fog&&this.fog.updateTransitions(r),this.snow&&this.snow.updateTransitions(r),this.rain&&this.rain.updateTransitions(r),this._changes.reset()}const w={};for(const P in this._mergedSourceCaches){const L=this._mergedSourceCaches[P];w[P]=L.used,L.used=!1,L.tileCoverLift=0}for(const P of this._mergedOrder){const L=this._mergedLayers[P];if(L.recalculate(r,this._availableImages),!L.isHidden(r.zoom)){const z=this.getLayerSourceCache(L);z&&(z.used=!0,z.tileCoverLift=Math.max(z.tileCoverLift,L.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(L,r)}):this.precompilePrograms(L,r))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&v&&this.mergeLayers();const C=this.imageManager.getPendingImageProviders();for(const P of C)P.sourceCache.used=!0;for(const P in w){const L=this._mergedSourceCaches[P];w[P]!==L.used&&L.getSource().fire(new i.A("data",{sourceDataType:"visibility",dataType:"source",sourceId:L.getSource().id}))}this.light&&this.light.recalculate(r),this.terrain&&this.terrain.recalculate(r),this.fog&&this.fog.recalculate(r),this.snow&&this.snow.recalculate(r),this.rain&&this.rain.recalculate(r),this.z=r.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),this.imageManager.clearUpdatedImages(this.scope),p&&this.fire(new i.A("data",{dataType:"style"}))}updateImageProviders(){const r=this.imageManager.getPendingImageProviders();for(const l of r){const p=l.resolvePendingRequests(),v=this.getFragmentStyle(l.scope);v&&v.addImages(p)}}_updateTilesForChangedImages(){const r={};for(const l in this._mergedSourceCaches){const p=this._mergedSourceCaches[l].getSource().scope;r[p]=r[p]||this._changes.getUpdatedImages(p),r[p].length!==0&&this._mergedSourceCaches[l].reloadTilesForDependencies(["icons","patterns"],r[p])}for(const l in r)this._changes.resetUpdatedImages(l)}_updateWorkerLayers(r,l,p){const v=this.getFragmentStyle(r);v&&this.dispatcher.broadcast("updateLayers",{layers:l?v._serializeLayers(l):[],scope:r,removedIds:p||[],options:v.options})}setState(r,l){if(this._checkLoaded(),Aa(this,xo(r)))return!1;(r=i.d7(r)).layers=Ja(r.layers);const p=function(C,P){if(!C)return[{command:Br.setStyle,args:[P]}];let L=[];try{if(!i.bv(C.version,P.version))return[{command:Br.setStyle,args:[P]}];if(i.bv(C.center,P.center)||L.push({command:Br.setCenter,args:[P.center]}),i.bv(C.zoom,P.zoom)||L.push({command:Br.setZoom,args:[P.zoom]}),i.bv(C.bearing,P.bearing)||L.push({command:Br.setBearing,args:[P.bearing]}),i.bv(C.pitch,P.pitch)||L.push({command:Br.setPitch,args:[P.pitch]}),i.bv(C.sprite,P.sprite)||L.push({command:Br.setSprite,args:[P.sprite]}),i.bv(C.glyphs,P.glyphs)||L.push({command:Br.setGlyphs,args:[P.glyphs]}),i.bv(C.imports,P.imports)||function(q=[],re=[],te){re=re||[];const oe=(q=q||[]).map(oc),ne=re.map(oc),ye=q.reduce(bd,{}),Se=re.reduce(bd,{}),Te=oe.slice();let ke,De,Me,Pe;for(ke=0,De=0;ke<oe.length;ke++)Me=oe[ke],Se.hasOwnProperty(Me)?De++:(te.push({command:Br.removeImport,args:[Me]}),Te.splice(Te.indexOf(Me,De),1));for(ke=0,De=0;ke<ne.length;ke++)Me=ne[ne.length-1-ke],Te[Te.length-1-ke]!==Me&&(ye.hasOwnProperty(Me)?(te.push({command:Br.removeImport,args:[Me]}),Te.splice(Te.lastIndexOf(Me,Te.length-De),1)):De++,Pe=Te[Te.length-ke],te.push({command:Br.addImport,args:[Se[Me],Pe]}),Te.splice(Te.length-ke,0,Me));for(const Oe of re){const Ne=ye[Oe.id];Ne&&!i.bv(Ne,Oe)&&te.push({command:Br.updateImport,args:[Oe.id,Oe]})}}(C.imports,P.imports,L),i.bv(C.transition,P.transition)||L.push({command:Br.setTransition,args:[P.transition]}),i.bv(C.light,P.light)||L.push({command:Br.setLight,args:[P.light]}),i.bv(C.fog,P.fog)||L.push({command:Br.setFog,args:[P.fog]}),i.bv(C.snow,P.snow)||L.push({command:Br.setSnow,args:[P.snow]}),i.bv(C.rain,P.rain)||L.push({command:Br.setRain,args:[P.rain]}),i.bv(C.projection,P.projection)||L.push({command:Br.setProjection,args:[P.projection]}),i.bv(C.lights,P.lights)||L.push({command:Br.setLights,args:[P.lights]}),i.bv(C.camera,P.camera)||L.push({command:Br.setCamera,args:[P.camera]}),i.bv(C.iconsets,P.iconsets)||function(q,re,te){let oe;for(oe in re=re||{},q=q||{})q.hasOwnProperty(oe)&&(re.hasOwnProperty(oe)||te.push({command:Br.removeIconset,args:[oe]}));for(oe in re){if(!re.hasOwnProperty(oe))continue;const ne=re[oe];q.hasOwnProperty(oe)?i.bv(q[oe],ne)||(te.push({command:Br.removeIconset,args:[oe]}),te.push({command:Br.addIconset,args:[oe,ne]})):te.push({command:Br.addIconset,args:[oe,ne]})}}(C.iconsets,P.iconsets,L),!i.bv(C["color-theme"],P["color-theme"]))return[{command:Br.setStyle,args:[P]}];const z={},j=[];(function(q,re,te,oe){let ne;for(ne in re=re||{},q=q||{})q.hasOwnProperty(ne)&&(re.hasOwnProperty(ne)||Sl(ne,te,oe));for(ne in re){if(!re.hasOwnProperty(ne))continue;const ye=re[ne];q.hasOwnProperty(ne)?i.bv(q[ne],ye)||(q[ne].type==="geojson"&&ye.type==="geojson"&&nm(q,re,ne)?te.push({command:Br.setGeoJSONSourceData,args:[ne,ye.data]}):K_(ne,re,te,oe)):Au(ne,re,te)}})(C.sources,P.sources,j,z);const H=[];C.layers&&C.layers.forEach(q=>{q.source&&z[q.source]?L.push({command:Br.removeLayer,args:[q.id]}):H.push(q)});let $=C.terrain;$&&z[$.source]&&(L.push({command:Br.setTerrain,args:[void 0]}),$=void 0),L=L.concat(j),i.bv($,P.terrain)||L.push({command:Br.setTerrain,args:[P.terrain]}),function(q,re,te){re=re||[];const oe=(q=q||[]).map(oc),ne=re.map(oc),ye=q.reduce(bd,{}),Se=re.reduce(bd,{}),Te=oe.slice(),ke=Object.create(null);let De,Me,Pe,Oe,Ne,ht,rt;for(De=0,Me=0;De<oe.length;De++)Pe=oe[De],Se.hasOwnProperty(Pe)?Me++:(te.push({command:Br.removeLayer,args:[Pe]}),Te.splice(Te.indexOf(Pe,Me),1));for(De=0,Me=0;De<ne.length;De++)Pe=ne[ne.length-1-De],Te[Te.length-1-De]!==Pe&&(ye.hasOwnProperty(Pe)?(te.push({command:Br.removeLayer,args:[Pe]}),Te.splice(Te.lastIndexOf(Pe,Te.length-Me),1)):Me++,ht=Te[Te.length-De],te.push({command:Br.addLayer,args:[Se[Pe],ht]}),Te.splice(Te.length-De,0,Pe),ke[Pe]=!0);for(De=0;De<ne.length;De++)if(Pe=ne[De],Oe=ye[Pe],Ne=Se[Pe],!ke[Pe]&&!i.bv(Oe,Ne))if(i.bv(Oe.source,Ne.source)&&i.bv(Oe["source-layer"],Ne["source-layer"])&&i.bv(Oe.type,Ne.type)){for(rt in Cl(Oe.layout,Ne.layout,te,Pe,null,Br.setLayoutProperty),Cl(Oe.paint,Ne.paint,te,Pe,null,Br.setPaintProperty),i.bv(Oe.slot,Ne.slot)||te.push({command:Br.setSlot,args:[Pe,Ne.slot]}),i.bv(Oe.filter,Ne.filter)||te.push({command:Br.setFilter,args:[Pe,Ne.filter]}),i.bv(Oe.minzoom,Ne.minzoom)&&i.bv(Oe.maxzoom,Ne.maxzoom)||te.push({command:Br.setLayerZoomRange,args:[Pe,Ne.minzoom,Ne.maxzoom]}),Oe)Oe.hasOwnProperty(rt)&&rt!=="layout"&&rt!=="paint"&&rt!=="filter"&&rt!=="metadata"&&rt!=="minzoom"&&rt!=="maxzoom"&&rt!=="slot"&&(rt.indexOf("paint.")===0?Cl(Oe[rt],Ne[rt],te,Pe,rt.slice(6),Br.setPaintProperty):i.bv(Oe[rt],Ne[rt])||te.push({command:Br.setLayerProperty,args:[Pe,rt,Ne[rt]]}));for(rt in Ne)Ne.hasOwnProperty(rt)&&!Oe.hasOwnProperty(rt)&&rt!=="layout"&&rt!=="paint"&&rt!=="filter"&&rt!=="metadata"&&rt!=="minzoom"&&rt!=="maxzoom"&&rt!=="slot"&&(rt.indexOf("paint.")===0?Cl(Oe[rt],Ne[rt],te,Pe,rt.slice(6),Br.setPaintProperty):i.bv(Oe[rt],Ne[rt])||te.push({command:Br.setLayerProperty,args:[Pe,rt,Ne[rt]]}))}else te.push({command:Br.removeLayer,args:[Pe]}),ht=Te[Te.lastIndexOf(Pe)+1],te.push({command:Br.addLayer,args:[Ne,ht]})}(H,P.layers,L)}catch(z){console.warn("Unable to compute style diff:",z),L=[{command:Br.setStyle,args:[P]}]}return L}(this.serialize(),r).filter(C=>!(C.command in am));if(p.length===0)return!1;const v=p.filter(C=>!(C.command in om));if(v.length>0)throw new Error(`Unimplemented: ${v.map(C=>C.command).join(", ")}.`);const w=[];return p.forEach(C=>{w.push(this[C.command](...C.args))}),l&&Promise.all(w).then(l).catch(l),this.stylesheet=r,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}_updateWorkerImages(){this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages})}_updateWorkerModels(){this._availableModels=this.modelManager.getModelURIs(this.scope),this.dispatcher.broadcast("setModels",{scope:this.scope,models:this._availableModels})}addImages(r){for(const[l,p]of r.entries()){if(this.getImage(l))return this.fire(new i.z(new Error(`An image with the name "${l.name}" already exists.`)));this.imageManager.addImage(l,this.scope,p),this._changes.updateImage(l,this.scope)}return this._updateWorkerImages(),this.fire(new i.A("data",{dataType:"style"})),this}addImage(r,l){return this.getImage(r)?this.fire(new i.z(new Error(`An image with the name "${r.name}" already exists.`))):(this.imageManager.addImage(r,this.scope,l),this._changes.updateImage(r,this.scope),this._updateWorkerImages(),this.fire(new i.A("data",{dataType:"style"})),this)}updateImage(r,l,p=!1){this.imageManager.updateImage(r,this.scope,l),p&&(this._changes.updateImage(r,this.scope),this._updateWorkerImages(),this.fire(new i.A("data",{dataType:"style"})))}getImage(r){return this.imageManager.getImage(r,this.scope)}removeImage(r){return this.getImage(r)?(this.imageManager.removeImage(r,this.scope),this._changes.updateImage(r,this.scope),this._updateWorkerImages(),this.fire(new i.A("data",{dataType:"style"})),this):this.fire(new i.z(new Error("No image with this name exists.")))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModelURLs(r){return this.modelManager.addModelURLs(r,this.scope),this._updateWorkerModels(),this.fire(new i.A("data",{dataType:"style"})),this}addModel(r,l,p={}){return this._checkLoaded(),this._validate(Ve,`models.${r}`,l,null,p)||(this.modelManager.addModel(r,l,this.scope),this.fire(new i.A("data",{dataType:"style"}))),this}hasModel(r){return this.modelManager.hasModel(r,this.scope)}removeModel(r){return this.hasModel(r)?(this.modelManager.removeModel(r,this.scope),this.fire(new i.A("data",{dataType:"style"})),this):this.fire(new i.z(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(r,l,p={}){if(this._checkLoaded(),this.getOwnSource(r)!==void 0)throw new Error(`There is already a source with ID "${r}".`);if(!l.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(l).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(_l,`sources.${r}`,l,null,p))return;this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);const v=rc(r,l,this.dispatcher,this);v.scope=this.scope,v.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(v.id),source:v.serialize(),sourceId:v.id}));const w=C=>{const P=(C?"symbol:":"other:")+v.id,L=i.C(P,this.scope),z=this._sourceCaches[P]=new to(L,v,C);(C?this._symbolSourceCaches:this._otherSourceCaches)[v.id]=z,z.onAdd(this.map)};w(!1),l.type!=="vector"&&l.type!=="geojson"||w(!0),v.onAdd&&v.onAdd(this.map),p.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(r){this._checkLoaded();const l=this.getOwnSource(r);if(!l)throw new Error("There is no source with this ID");for(const v in this._layers)if(this._layers[v].source===r)return this.fire(new i.z(new Error(`Source "${r}" cannot be removed while layer "${v}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===r)return this.fire(new i.z(new Error(`Source "${r}" cannot be removed while terrain is using it.`)));if(this.stylesheet.iconsets){const v=Object.entries(this.stylesheet.iconsets).find(([w,C])=>C.type==="source"&&C.source===r);if(v)return this.fire(new i.z(new Error(`Source "${r}" cannot be removed while iconset "${v[0]}" is using it.`)))}const p=this.getOwnSourceCaches(r);for(const v of p){const w=i.d8(v.id);delete this._sourceCaches[w],this._changes.discardSourceCacheUpdate(v.id),v.fire(new i.A("data",{sourceDataType:"metadata",dataType:"source",sourceId:v.getSource().id})),v.setEventedParent(null),v.clearTiles()}return delete this._otherSourceCaches[r],delete this._symbolSourceCaches[r],this.mergeSources(),l.setEventedParent(null),l.onRemove&&l.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(r,l){this._checkLoaded(),this.getOwnSource(r).setData(l),this._changes.setDirty()}getOwnSource(r){const l=this.getOwnSourceCache(r);return l&&l.getSource()}getOwnSources(){const r=[];for(const l in this._otherSourceCaches){const p=this.getOwnSourceCache(l);p&&r.push(p.getSource())}return r}areTilesLoaded(){const r=this._mergedSourceCaches;for(const l in r){const p=r[l]._tiles;for(const v in p){const w=p[v];if(w.state!=="loaded"&&w.state!=="errored")return!1}}return!0}setLights(r){if(this._checkLoaded(),!r)return delete this.ambientLight,void delete this.directionalLight;const l=this._getTransitionParameters();for(const v of r){if(this._validate(_d,"lights",v))return;switch(v.type){case"ambient":if(this.ambientLight){const w=this.ambientLight;w.set(v),w.updateTransitions(l)}else this.ambientLight=new Qi(v,gi||(gi=new i.a7({color:new i.a8(i.a5.properties_light_ambient.color),"color-use-theme":new i.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a8(i.a5.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const w=this.directionalLight;w.set(v),w.updateTransitions(l)}else this.directionalLight=new Qi(v,Hr||(Hr=new i.a7({direction:new i.an(i.a5.properties_light_directional.direction),color:new i.a8(i.a5.properties_light_directional.color),"color-use-theme":new i.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a8(i.a5.properties_light_directional.intensity),"cast-shadows":new i.a8(i.a5.properties_light_directional["cast-shadows"]),"shadow-quality":new i.a8(i.a5.properties_light_directional["shadow-quality"]),"shadow-intensity":new i.a8(i.a5.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const p=new i.aa(this.z||0,l);this.ambientLight&&this.ambientLight.recalculate(p),this.directionalLight&&this.directionalLight.recalculate(p),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const r=this.directionalLight,l=this.ambientLight;if(!r||!l)return;const p=$=>.2126*($[0]<=.03928?$[0]/12.92:Math.pow(($[0]+.055)/1.055,2.4))+.7152*($[1]<=.03928?$[1]/12.92:Math.pow(($[1]+.055)/1.055,2.4))+.0722*($[2]<=.03928?$[2]/12.92:Math.pow(($[2]+.055)/1.055,2.4)),v=r.properties.get("color").toRenderColor(null).toArray01(),w=r.properties.get("intensity"),C=r.properties.get("direction"),P=1-i.cR(C.x,C.y,C.z)[2]/90,L=p(v)*w*P,z=l.properties.get("color").toRenderColor(null).toArray01(),j=l.properties.get("intensity"),H=p(z)*j;return Number(((L+H)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const r=[];return this.directionalLight&&r.push(this.directionalLight.get()),this.ambientLight&&r.push(this.ambientLight.get()),r}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(r){if(r==null||r===""&&this.isRootStyle())return this;if(i.d9(r)){const l=i.da(r),p=this.fragments.find(({id:w})=>w===l);if(!p)return;const v=i.d8(r);return p.style.getFragmentStyle(v)}{const l=this.fragments.find(({id:p})=>p===r);return l?l.style:void 0}}setFeaturesetSelectors(r){if(!r)return;const l={},p=(v,w="")=>`${v}::${w}`;this._featuresetSelectors={};for(const v in r){const w=this._featuresetSelectors[v]=[];for(const C of r[v].selectors){if(C.featureNamespace){const L=this.getOwnLayer(C.layer);if(!L){i.w(`Layer is undefined for selector: ${C.layer}`);continue}const z=p(L.source,L.sourceLayer);if(z in l&&l[z]!==C.featureNamespace){i.w(`"featureNamespace ${C.featureNamespace} of featureset ${v}'s selector is not associated to the same source, skip this selector`);continue}l[z]=C.featureNamespace}let P;if(C.properties)for(const L in C.properties){const z=i.X(C.properties[L]);z.result==="success"&&(P=P||{},P[L]=z.value)}w.push({layerId:C.layer,namespace:C.featureNamespace,properties:P,uniqueFeatureID:C._uniqueFeatureID})}}}getFeaturesetDescriptors(r){const l=this.getFragmentStyle(r);if(!l||!l.stylesheet.featuresets)return[];const p=[];for(const v in l.stylesheet.featuresets)p.push({featuresetId:v,importId:l.scope?l.scope:void 0});return p}getFeaturesetLayers(r,l){const p=this.getFragmentStyle(l),v=p.stylesheet.featuresets;if(!v||!v[r])return this.fire(new i.z(new Error(`The featureset '${r}' does not exist in the map's style and cannot be queried.`))),[];const w=[];for(const C of v[r].selectors){const P=p.getOwnLayer(C.layer);P&&w.push(P)}return w}getConfigProperty(r,l){const p=this.getFragmentStyle(r);if(!p)return null;const v=i.C(l,p.scope),w=p.options.get(v),C=w?w.value||w.default:null;return C?C.serialize():null}setConfigProperty(r,l,p){const v=this.getFragmentStyle(r);if(!v)return;const w=v.stylesheet.indoor?wg(v.stylesheet.schema):v.stylesheet.schema;if(!w||!w[l])return;const C=i.X(p);if(C.result!=="success")return void Aa(this,C.value);const P=C.value.expression,L=i.C(l,v.scope),z=v.options.get(L);if(!z)return;let j;const{minValue:H,maxValue:$,stepValue:q,type:re,values:te}=w[l],oe=i.X(w[l].default);oe.result==="success"&&(j=oe.value.expression),j?(this.options.set(L,Object.assign({},z,{value:P,default:j,minValue:H,maxValue:$,stepValue:q,type:re,values:te})),this.updateConfigDependencies(l)):this.fire(new i.z(new Error(`No schema defined for the config option "${l}" in the "${r}" fragment.`)))}getConfig(r){const l=this.getFragmentStyle(r);if(!l)return null;const p=l.stylesheet.schema;if(!p)return null;const v={};for(const w in p){const C=i.C(w,l.scope),P=l.options.get(C),L=P?P.value||P.default:null;v[w]=L?L.serialize():null}return v}setConfig(r,l){const p=this.getFragmentStyle(r);p&&(p.updateConfig(l,p.stylesheet.schema),this.updateConfigDependencies())}getSchema(r){const l=this.getFragmentStyle(r);return l?l.stylesheet.schema:null}setSchema(r,l){const p=this.getFragmentStyle(r);p&&(p.stylesheet.schema=l,p.updateConfig(p._config,l),this.updateConfigDependencies())}updateConfig(r,l){if(this._config=r,r||l)if(l)for(const p in l){let v,w;const C=i.X(l[p].default);if(C.result==="success"&&(v=C.value.expression),r&&r[p]!==void 0){const $=i.X(r[p]);$.result==="success"&&(w=$.value.expression)}const{minValue:P,maxValue:L,stepValue:z,type:j,values:H}=l[p];if(v){const $=i.C(p,this.scope);this.options.set($,{default:v,value:w,minValue:P,maxValue:L,stepValue:z,type:j,values:H})}else this.fire(new i.z(new Error(`No schema defined for config option "${p}".`)))}else this.fire(new i.z(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(r){for(const l of this._configDependentLayers){const p=this.getLayer(l);if(p){if(r&&!p.configDependencies.has(r))continue;p.possiblyEvaluateVisibility(),this._updateLayer(p)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(l=>{const p=l._styleColorTheme.colorThemeOverride?l._styleColorTheme.colorThemeOverride:l._styleColorTheme.colorTheme;if(p){const v=l._evaluateColorThemeData(p);(!l._styleColorTheme.lut&&v!==""||l._styleColorTheme.lut&&v!==l._styleColorTheme.lut.data)&&l.setColorTheme(p)}}),this._changes.setDirty()}addLayer(r,l,p={}){this._checkLoaded();const v=r.id;if(this._layers[v])return void this.fire(new i.z(new Error(`Layer with id "${v}" already exists on this map`)));let w;if(r.type==="custom"){if(Aa(this,i.db(r)))return;w=i.dc(r,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof r.source=="object"&&(this.addSource(v,r.source),r=i.d7(r),r=i.l(r,{source:v})),this._validate(ie,`layers.${v}`,r,{arrayIndex:-1},p))return;w=i.dc(r,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(w),w.setEventedParent(this,{layer:{id:v}})}w.configDependencies.size!==0&&this._configDependentLayers.add(w.fqid);let C=this._order.length;if(l){const j=this._order.indexOf(l);if(j===-1)return void this.fire(new i.z(new Error(`Layer with id "${l}" does not exist on this map.`)));w.slot===this._layers[l].slot?C=j:i.w(`Layer with id "${l}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(C,0,v),this._layerOrderChanged=!0,this._layers[v]=w;const P=this.getOwnLayerSourceCache(w),L=!!this.directionalLight&&this.directionalLight.shadowsEnabled();P&&w.canCastShadows()&&L&&(P.castsShadows=!0);const z=this._changes.getRemovedLayer(w);if(z&&w.source&&P&&w.type!=="custom"){this._changes.discardLayerRemoval(w);const j=i.C(w.source,w.scope);z.type!==w.type?this._changes.updateSourceCache(j,"clear"):(this._changes.updateSourceCache(j,"reload"),P.pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map),w.scope=this.scope,this.mergeLayers()}moveLayer(r,l){this._checkLoaded();const p=this._checkLayer(r);if(!p||r===l)return;const v=this._order.indexOf(r);this._order.splice(v,1);let w=this._order.length;if(l){const C=this._order.indexOf(l);if(C===-1)return void this.fire(new i.z(new Error(`Layer with id "${l}" does not exist on this map.`)));p.slot===this._layers[l].slot?w=C:i.w(`Layer with id "${l}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(w,0,r),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(r){this._checkLoaded();const l=this._checkLayer(r);if(!l)return;l.setEventedParent(null);const p=this._order.indexOf(r);this._order.splice(p,1),delete this._layers[r],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(l.fqid),this._changes.removeLayer(l);const v=this.getOwnLayerSourceCache(l);if(v&&v.castsShadows){let w=!1;for(const C in this._layers)if(this._layers[C].source===l.source&&this._layers[C].canCastShadows()){w=!0;break}v.castsShadows=w}l.onRemove&&l.onRemove(this.map),this.mergeLayers()}getOwnLayer(r){return this._layers[r]}hasLayer(r){return r in this._mergedLayers}hasLayerType(r){for(const l in this._layers)if(this._layers[l].type===r)return!0;return!1}setLayerZoomRange(r,l,p){this._checkLoaded();const v=this._checkLayer(r);v&&(v.minzoom===l&&v.maxzoom===p||(l!=null&&(v.minzoom=l),p!=null&&(v.maxzoom=p),this._updateLayer(v)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(r,l){this._checkLoaded();const p=this._checkLayer(r);p&&p.slot!==l&&(p.slot=l,this._updateLayer(p))}setFilter(r,l,p={}){this._checkLoaded();const v=this._checkLayer(r);if(v&&!i.bv(v.filter,l))return l==null?(v.filter=void 0,void this._updateLayer(v)):void(this._validate(me,`layers.${v.id}.filter`,l,{layerType:v.type},p)||(v.filter=i.d7(l),this._updateLayer(v)))}getFilter(r){const l=this._checkLayer(r);if(l)return i.d7(l.filter)}setLayoutProperty(r,l,p,v={}){this._checkLoaded();const w=this._checkLayer(r);if(w&&!i.bv(w.getLayoutProperty(l),p)){if(p!=null&&(!v||v.validate!==!1)&&Aa(w,Be.call(xo,{key:`layers.${r}.layout.${l}`,layerType:w.type,objectKey:l,value:p,styleSpec:i.a5,style:{glyphs:!0,sprite:!0}})))return;w.setLayoutProperty(l,p),w.configDependencies.size!==0&&this._configDependentLayers.add(w.fqid),this._updateLayer(w)}}getLayoutProperty(r,l){const p=this._checkLayer(r);if(p)return p.getLayoutProperty(l)}setPaintProperty(r,l,p,v={}){this._checkLoaded();const w=this._checkLayer(r);if(!w||i.bv(w.getPaintProperty(l),p)||p!=null&&(!v||v.validate!==!1)&&Aa(w,Le.call(xo,{key:`layers.${r}.paint.${l}`,layerType:w.type,objectKey:l,value:p,styleSpec:i.a5})))return;const C=w.setPaintProperty(l,p);w.configDependencies.size!==0&&this._configDependentLayers.add(w.fqid),C&&this._updateLayer(w),this._changes.updatePaintProperties(w)}getPaintProperty(r,l){const p=this._checkLayer(r);if(p)return p.getPaintProperty(l)}setFeatureState(r,l){if(this._checkLoaded(),"target"in r){if("featuresetId"in r.target){const{featuresetId:L,importId:z}=r.target,j=this.getFragmentStyle(z),H=j.getFeaturesetLayers(L);for(const{source:$,sourceLayer:q}of H)j.setFeatureState({id:r.id,source:$,sourceLayer:q},l)}else if("layerId"in r.target){const{layerId:L}=r.target,z=this.getLayer(L);this.setFeatureState({id:r.id,source:z.source,sourceLayer:z.sourceLayer},l)}return}const p=r.source,v=r.sourceLayer,w=this._checkSource(p);if(!w)return;const C=w.type;if(C==="geojson"&&v)return void this.fire(new i.z(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(C==="vector"&&!v)return void this.fire(new i.z(new Error("The sourceLayer parameter must be provided for vector source types.")));r.id===void 0&&this.fire(new i.z(new Error("The feature id parameter must be provided.")));const P=this.getOwnSourceCaches(p);for(const L of P)L.setFeatureState(v,r.id,l)}removeFeatureState(r,l){if(this._checkLoaded(),"target"in r){if("featuresetId"in r.target){const{featuresetId:L,importId:z}=r.target,j=this.getFragmentStyle(z),H=j.getFeaturesetLayers(L);for(const{source:$,sourceLayer:q}of H)j.removeFeatureState({id:r.id,source:$,sourceLayer:q},l)}else if("layerId"in r.target){const{layerId:L}=r.target,z=this.getLayer(L);this.removeFeatureState({id:r.id,source:z.source,sourceLayer:z.sourceLayer},l)}return}const p=r.source,v=this._checkSource(p);if(!v)return;const w=v.type,C=w==="vector"?r.sourceLayer:void 0;if(w==="vector"&&!C)return void this.fire(new i.z(new Error("The sourceLayer parameter must be provided for vector source types.")));if(l&&typeof r.id!="string"&&typeof r.id!="number")return void this.fire(new i.z(new Error("A feature id is required to remove its specific state property.")));const P=this.getOwnSourceCaches(p);for(const L of P)L.removeFeatureState(C,r.id,l)}getFeatureState(r){if(this._checkLoaded(),"target"in r){let w;if("featuresetId"in r.target){const{featuresetId:C,importId:P}=r.target,L=this.getFragmentStyle(P),z=L.getFeaturesetLayers(C);for(const{source:j,sourceLayer:H}of z){const $=L.getFeatureState({id:r.id,source:j,sourceLayer:H});if($&&!w)w=$;else if(!i.bv(w,$))return void this.fire(new i.z(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in r.target){const{layerId:C}=r.target,P=this.getLayer(C);w=this.getFeatureState({id:r.id,source:P.source,sourceLayer:P.sourceLayer})}return w}const l=r.source,p=r.sourceLayer,v=this._checkSource(l);if(v){if(v.type!=="vector"||p)return r.id===void 0&&this.fire(new i.z(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(l)[0].getFeatureState(p,r.id);this.fire(new i.z(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(r){return this.stylesheet.transition=i.l({},this.stylesheet.transition,r),this.transition=this.stylesheet.transition,this}getTransition(){return i.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const r=this.getTerrain(),l=r&&this.terrain&&this.terrain.scope===this.scope?r:this.stylesheet.terrain;return i.dd({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,iconsets:this.stylesheet.iconsets,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:l,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},p=>p!==void 0)}_updateFilteredLayers(r){for(const l of Object.values(this._mergedLayers))r(l)&&this._updateLayer(l)}_updateLayer(r){this._changes.updateLayer(r);const l=this.getLayerSourceCache(r),p=i.C(r.source,r.scope),v=this._changes.getUpdatedSourceCaches();r.source&&!v[p]&&l&&l.getSource().type!=="raster"&&(this._changes.updateSourceCache(p,"reload"),l.pause()),r.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(r){const l=P=>this._mergedLayers[P].is3D(!!this.terrain),p=this.order,v={},w=[];for(let P=p.length-1;P>=0;P--){const L=p[P];if(l(L)){v[L]=P;for(const z of r){const j=z[L];if(j)for(const H of j)w.push(H)}}}w.sort((P,L)=>L.intersectionZ-P.intersectionZ);const C=[];for(let P=p.length-1;P>=0;P--){const L=p[P];if(l(L))for(let z=w.length-1;z>=0;z--){const j=w[z].feature;if(j.layer&&v[j.layer.id]<P)break;C.push(j),w.pop()}else for(const z of r){const j=z[L];if(j)for(const H of j)C.push(H.feature)}}return C}queryRenderedFeatures(r,l,p){let v;l&&!Array.isArray(l)&&l.filter&&(this._validate(me,"queryRenderedFeatures.filter",l.filter,null,l),v=i.b3(l.filter));const w={},C=j=>{if(Rl.has(j.type))return;const H=this.getOwnLayerSourceCache(j),$=w[H.id]=w[H.id]||{sourceCache:H,layers:{},has3DLayers:!1};j.is3D(!!this.terrain)&&($.has3DLayers=!0),$.layers[j.fqid]=$.layers[j.fqid]||{styleLayer:j,targets:[]},$.layers[j.fqid].targets.push({filter:v})};if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new i.z(new Error("parameters.layers must be an Array."))),[];for(const j of l.layers){const H=this._layers[j];if(!H)return this.fire(new i.z(new Error(`The layer '${j}' does not exist in the map's style and cannot be queried for features.`))),[];C(H)}}else for(const j in this._layers)C(this._layers[j]);const P=this._queryRenderedFeatures(r,w,p),L=this._flattenAndSortRenderedFeatures(P),z=[];for(const j of L)i.de(j.layer.id)===this.scope&&z.push(j);return z}queryRenderedFeatureset(r,l,p){let v;l&&!Array.isArray(l)&&l.filter&&(this._validate(me,"queryRenderedFeatures.filter",l.filter,null,l),v=i.b3(l.filter));const w="mock",C=[];if(l&&l.target)C.push(Object.assign({},l,{targetId:w,filter:v}));else{const j=this.getFeaturesetDescriptors();for(const H of j)C.push({targetId:w,filter:v,target:H});for(const{style:H}of this.fragments){const $=H.getFeaturesetDescriptors();for(const q of $)C.push({targetId:w,filter:v,target:q})}}const P=this.queryRenderedTargets(r,C,p),L=[],z=new Set;for(const j of P)for(const H of j.variants[w])ic(H,j,z)||L.push(new i.df(j,H));return L}queryRenderedTargets(r,l,p){const v={},w=(P,L,z,j)=>{const H=v[L.id]=v[L.id]||{sourceCache:L,layers:{},has3DLayers:!1};if(H.layers[P.fqid]=H.layers[P.fqid]||{styleLayer:P,targets:[]},P.is3D(!!this.terrain)&&(H.has3DLayers=!0),!j)return z.uniqueFeatureID=!1,void H.layers[P.fqid].targets.push(z);H.layers[P.fqid].targets.push(Object.assign({},z,{namespace:j.namespace,properties:j.properties,uniqueFeatureID:j.uniqueFeatureID}))};for(const P of l)if("featuresetId"in P.target){const{featuresetId:L,importId:z}=P.target,j=this.getFragmentStyle(z);if(!j||!j._featuresetSelectors)continue;const H=j._featuresetSelectors[L];if(!H){this.fire(new i.z(new Error(`The featureset '${L}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const $ of H){const q=j.getOwnLayer($.layerId);q&&!Rl.has(q.type)&&w(q,j.getOwnLayerSourceCache(q),P,$)}}else if("layerId"in P.target){const{layerId:L}=P.target,z=this.getLayer(L);if(!z||Rl.has(z.type))continue;w(z,this.getLayerSourceCache(z),P)}const C=this._queryRenderedFeatures(r,v,p);return this._flattenAndSortRenderedFeatures(C)}_queryRenderedFeatures(r,l,p){const v=[],w=!!this.map._showQueryGeometry,C=bs.createFromScreenPoints(r,p);for(const P in l){const L=bl(C,l[P],this._availableImages,p,w);Object.keys(L).length&&v.push(L)}if(this.placement)for(const P in l){if(!l[P].sourceCache._onlySymbols)continue;const L=Mh(C.screenGeometry,l[P],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData);Object.keys(L).length&&v.push(L)}return v}querySourceFeatures(r,l){const p=l&&l.filter;p&&this._validate(me,"querySourceFeatures.filter",p,null,l);let v=[];const w=this.getOwnSourceCaches(r);for(const C of w)v=v.concat(tm(C,l));return v}addSourceType(r,l,p){return Ra.getSourceType(r)?p(new Error(`A source type called "${r}" already exists.`)):(Ra.setSourceType(r,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:l.workerSourceURL},p):p(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(r,l,p={}){this._checkLoaded();const v=this.light.getLight();let w=!1;for(const P in r)if(!i.bv(r[P],v[P])){w=!0;break}if(!w)return;const C=this._getTransitionParameters();this.light.setLight(r,l,p),this.light.updateTransitions(C)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=i.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&i.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(r,l=1){if(this._checkLoaded(),!r)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),l===0&&delete this.terrain,r===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let p=r;const v=r.source==null;if(l===1){if(this.disableElevatedTerrain)return;if(typeof p.source=="object"){const P="terrain-dem-src";this.addSource(P,p.source),p=i.d7(p),p=i.l(p,{source:P})}const w=i.l({},p),C={};if(this.terrain&&v){w.source=this.terrain.get().source;const P=this.terrain?this.getFragmentStyle(this.terrain.scope):null;P&&(C.style=P.serialize())}if(this._validate(Qt,"terrain",w,C))return}if(!this.terrain||this.terrain.scope!==this.scope&&!v||this.terrain&&l!==this.terrain.drapeRenderMode){if(!p)return;this._createTerrain(p,l),this.fire(new i.A("data",{dataType:"style"}))}else{const w=this.terrain,C=w.get();for(const P of Object.keys(i.a5.terrain))!p.hasOwnProperty(P)&&i.a5.terrain[P].default&&(p[P]=i.a5.terrain[P].default);for(const P in r)if(!i.bv(r[P],C[P])){w.set(r,this.options),this.stylesheet.terrain=r;const L=this._getTransitionParameters({duration:0});w.updateTransitions(L),this.fire(new i.A("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(r){const l=this.fog=new pr(r,this.map.transform,this.scope,this.options);this.stylesheet.fog=l.get();const p=this._getTransitionParameters({duration:0});l.updateTransitions(p)}_createSnow(r){const l=this.snow=new vr(r,this.map.transform,this.scope,this.options);this.stylesheet.snow=l.get();const p=this._getTransitionParameters({duration:0});l.updateTransitions(p)}_createRain(r){const l=this.rain=new xi(r,this.map.transform,this.scope,this.options);this.stylesheet.rain=l.get();const p=this._getTransitionParameters({duration:0});l.updateTransitions(p)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const r of this.map._markers)r._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(r){if(this._checkLoaded(),!r)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const l=this.fog;if(!i.bv(l.get(),r)){l.set(r,this.options),this.stylesheet.fog=l.get();const p=this._getTransitionParameters({duration:0});l.updateTransitions(p)}}else this._createFog(r);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(r){if(this._checkLoaded(),!r)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const l=this.snow;if(!i.bv(l.get(),r)){l.set(r,this.options),this.stylesheet.snow=l.get();const p=this._getTransitionParameters({duration:0});l.updateTransitions(p)}}else this._createSnow(r);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(r){if(this._checkLoaded(),!r)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const l=this.rain;if(!i.bv(l.get(),r)){l.set(r,this.options),this.stylesheet.rain=l.get();const p=this._getTransitionParameters({duration:0});l.updateTransitions(p)}}else this._createRain(r);this._markersNeedUpdate=!0}_reloadColorTheme(){const r=()=>{for(const v in this._layers)this._layers[v].lut=this._styleColorTheme.lut;for(const v in this._sourceCaches)this._sourceCaches[v].clearTiles()},l=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!l)return this._styleColorTheme.lut=null,void r();const p=this._evaluateColorThemeData(l);this._loadColorTheme(p).then(()=>{this.fire(new i.A("colorthemeset")),r()}).catch(v=>{i.w(`Couldn't set color theme: ${v}`)})}setColorTheme(r){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&i.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=r,this._reloadColorTheme()}setImportColorTheme(r,l){const p=this.getFragmentStyle(r);p&&(p._styleColorTheme.colorThemeOverride=l,p._reloadColorTheme())}_getTransitionParameters(r){return{now:i.q.now(),transition:i.l(this.transition,r)}}updateDrapeFirstLayers(){if(!this.terrain)return;const r=[],l=[];for(const p of this._mergedOrder)this.isLayerDraped(this._mergedLayers[p])?r.push(p):l.push(p);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...r),this._drapedFirstOrder.push(...l)}_createTerrain(r,l){const p=this.terrain=new Lt(r,l,this.scope,this.options);l===1&&(this.stylesheet.terrain=r),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const v=this._getTransitionParameters({duration:0});p.updateTransitions(v)}_force3DLayerUpdate(){for(const r in this._layers){const l=this._layers[r];l.type==="fill-extrusion"&&this._updateLayer(l)}}_forceSymbolLayerUpdate(){for(const r in this._layers){const l=this._layers[r];l.type==="symbol"&&this._updateLayer(l)}}_validate(r,l,p,v,w={}){if(w&&w.validate===!1)return!1;const C=i.l({},this.serialize());return Aa(this,r.call(xo,i.l({key:l,style:C,value:p,styleSpec:i.a5},v)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.dg.off("pluginStateChange",this._rtlTextPluginCallback);for(const r in this._mergedLayers)this._mergedLayers[r].setEventedParent(null);for(const r in this._mergedSourceCaches)this._mergedSourceCaches[r].clearTiles(),this._mergedSourceCaches[r].setEventedParent(null);this.imageManager.removeScope(this.scope),this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.modelManager.destroy(),this.dispatcher.remove())}clearSource(r){const l=this.getSourceCaches(r);for(const p of l)p.clearTiles()}clearSources(){for(const r in this._mergedSourceCaches)this._mergedSourceCaches[r].clearTiles()}reloadSource(r){const l=this.getSourceCaches(r);for(const p of l)p.resume(),p.reload()}reloadSources(){for(const r of this.getSources())r.reload&&r.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle(r=>{r.modelManager.reloadModels(r.scope)})}updateSources(r){let l;this.directionalLight&&(l=Nh(this.directionalLight));const p=new Set;for(const v in this._mergedLayers){const w=this._mergedLayers[v];w.hasElevation()&&!p.has(w.source)&&p.add(w.source)}for(const v in this._mergedSourceCaches){const w=this._mergedSourceCaches[v],C=p.has(w._source.id);w.update(r,void 0,void 0,l,C)}}_generateCollisionBoxes(){for(const r in this._sourceCaches){const l=this._sourceCaches[r];l.resume(),l.reload()}}_updatePlacement(r,l,p,v,w,C,P=!1){let L=!1,z=!1;const j={},H={};for(const $ of this._mergedOrder){const q=this._mergedLayers[$];if(q.type!=="symbol")continue;const re=i.C(q.source,q.scope);let te=j[re];if(!te){const ne=this.getLayerSourceCache(q);if(!ne)continue;const ye=ne.getRenderableIds(!0).map(Se=>ne.getTileByID(Se));H[re]=ye.slice(),te=j[re]=ye.sort((Se,Te)=>Te.tileID.overscaledZ-Se.tileID.overscaledZ||(Se.tileID.isLessThan(Te.tileID)?-1:1))}const oe=this.crossTileSymbolIndex.addLayer(q,te,l.center.lng,l.projection);L=L||oe}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),P=P||this._layerOrderChanged||v===0,this._layerOrderChanged&&this.fire(new i.A("neworder")),(P||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.q.now(),l.zoom))&&(this.pauseablePlacement=new Oo(l,this._mergedOrder,P,p,v,w,this.placement,this.fog&&l.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,j,H,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.q.now()),z=!0),L&&this.pauseablePlacement.placement.setStale()),z||L){this._buildingIndex.onNewFrame(l.zoom);for(let $=0;$<this._mergedOrder.length;$++){const q=this._mergedLayers[this._mergedOrder[$]];if(q.type!=="symbol")continue;const re=this.isLayerClipped(q);this.placement.updateLayerOpacities(q,j[i.C(q.source,q.scope)],$,re?C:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.q.now())}}_releaseSymbolFadeTiles(){for(const r in this._sourceCaches)this._sourceCaches[r].releaseSymbolFadeTiles()}addImport(r,l){this._checkLoaded();const p=this.stylesheet.imports=this.stylesheet.imports||[];if(p.findIndex(({id:w})=>w===r.id)!==-1)return void this.fire(new i.z(new Error(`Import with id '${r.id}' already exists in the map's style.`)));if(!l)return p.push(r),this._loadImports([r],!0);const v=p.findIndex(({id:w})=>w===l);return v===-1&&this.fire(new i.z(new Error(`Import with id "${l}" does not exist on this map.`))),this.stylesheet.imports=p.slice(0,v).concat(r).concat(p.slice(v)),this._loadImports([r],!0,l)}updateImport(r,l){this._checkLoaded();const p=this.stylesheet.imports||[],v=this.getImportIndex(r);return v===-1?this:typeof l=="string"?(this.setImportUrl(r,l),this):(l.url&&l.url!==p[v].url&&this.setImportUrl(r,l.url),i.bv(l.config,p[v].config)||this.setImportConfig(r,l.config,l.data.schema),i.bv(l.data,p[v].data)||this.setImportData(r,l.data),this)}moveImport(r,l){this._checkLoaded();let p=this.stylesheet.imports||[];const v=this.getImportIndex(r);if(v===-1)return this;const w=this.getImportIndex(l);if(w===-1)return this;const C=p[v],P=this.fragments[v];return p=p.filter(({id:L})=>L!==r),this.fragments=this.fragments.filter(({id:L})=>L!==r),this.stylesheet.imports=p.slice(0,w).concat(C).concat(p.slice(w)),this.fragments=this.fragments.slice(0,w).concat(P).concat(this.fragments.slice(w)),this.mergeLayers(),this}setImportUrl(r,l){this._checkLoaded();const p=this.stylesheet.imports||[],v=this.getImportIndex(r);if(v===-1)return this;p[v].url=l;const w=this.fragments[v];return w.style=this._createFragmentStyle(p[v]),w.style.on("style.import.load",()=>this.mergeAll()),w.style.loadURL(l),this}setImportData(r,l){this._checkLoaded();const p=this.getImportIndex(r),v=this.stylesheet.imports||[];return p===-1?this:l?(this.fragments[p].style.setState(l),this._reloadImports(),this):(delete v[p].data,this.setImportUrl(r,v[p].url))}setImportConfig(r,l,p){this._checkLoaded();const v=this.getImportIndex(r),w=this.stylesheet.imports||[];if(v===-1)return this;l?w[v].config=l:delete w[v].config;const C=this.fragments[v];p&&C.style.stylesheet&&(C.style.stylesheet.schema=p);const P=C.style.stylesheet&&C.style.stylesheet.schema;return C.config=l,C.style.updateConfig(l,P),this.updateConfigDependencies(),this}removeImport(r){this._checkLoaded();const l=this.stylesheet.imports||[],p=this.getImportIndex(r);p!==-1&&(l.splice(p,1),this.fragments[p].style._remove(),this.fragments.splice(p,1),this._reloadImports())}getImportIndex(r){const l=(this.stylesheet.imports||[]).findIndex(p=>p.id===r);return l===-1&&this.fire(new i.z(new Error(`Import '${r}' does not exist in the map's style and cannot be updated.`))),l}getLayer(r){return this._mergedLayers[r]}getSources(){const r=[];for(const l in this._mergedOtherSourceCaches){const p=this._mergedOtherSourceCaches[l];p&&r.push(p.getSource())}return r}getSource(r,l){const p=this.getSourceCache(r,l);return p&&p.getSource()}getLayerSource(r){const l=this.getLayerSourceCache(r);return l&&l.getSource()}getSourceCache(r,l){const p=i.C(r,l);return this._mergedOtherSourceCaches[p]}getLayerSourceCache(r){const l=i.C(r.source,r.scope);return r.type==="symbol"?this._mergedSymbolSourceCaches[l]:this._mergedOtherSourceCaches[l]}getSourceCaches(r){if(r==null)return Object.values(this._mergedSourceCaches);const l=[];return this._mergedOtherSourceCaches[r]&&l.push(this._mergedOtherSourceCaches[r]),this._mergedSymbolSourceCaches[r]&&l.push(this._mergedSymbolSourceCaches[r]),l}updateSourceCaches(){const r=this._changes.getUpdatedSourceCaches();for(const l in r){const p=r[l];p==="reload"?this.reloadSource(l):p==="clear"&&this.clearSource(l)}}updateLayers(r){const l=this._changes.getUpdatedPaintProperties();for(const p of l){const v=this.getLayer(p);v&&v.updateTransitions(r)}}getGlyphsUrl(){return this.stylesheet.glyphs}setGlyphsUrl(r){this.stylesheet.glyphs=r,this.glyphManager.setURL(r,this.scope)}getImages(r,l,p){this.imageManager.getImages(l.images,l.scope,p),this._updateTilesForChangedImages();const v=C=>{if(C){const P=l.images.map(L=>i.I.toString(L));C.setDependencies(l.tileID.key,l.type,P)}},w=i.C(l.source,l.scope);v(this._mergedOtherSourceCaches[w]),v(this._mergedSymbolSourceCaches[w])}rasterizeImages(r,l,p){this.imageManager.rasterizeImages(l,p)}getGlyphs(r,l,p){this.glyphManager.getGlyphs(l.stacks,l.scope,p)}getResource(r,l,p){return i.dh(l,p)}getOwnSourceCache(r){return this._otherSourceCaches[r]}getOwnLayerSourceCache(r){return r.type==="symbol"?this._symbolSourceCaches[r.source]:this._otherSourceCaches[r.source]}getOwnSourceCaches(r){const l=[];return this._otherSourceCaches[r]&&l.push(this._otherSourceCaches[r]),this._symbolSourceCaches[r]&&l.push(this._symbolSourceCaches[r]),l}_isSourceCacheLoaded(r){const l=this.getOwnSourceCaches(r);return l.length===0?(this.fire(new i.z(new Error(`There is no source with ID '${r}'`))),!1):l.every(p=>p.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(r,l){if(!this._clipLayerPresent&&r.type!=="fill-extrusion")return!1;const p=r.type==="fill-extrusion"&&r.sourceLayer==="building";if(r.is3D(!!this.terrain)){if(p||l&&l.type==="batched-model"||r.type==="model")return!0}else if(r.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(r=>{r.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Ra.getSourceType=function(f){return Rh[f]},Ra.setSourceType=function(f,r){Rh[f]=r},Ra.registerForPluginStateChange=i.c$;var Ld=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,el=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,Bh=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,Wc="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",qo=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,Vh=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,en=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,qc=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,Dd=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,Uh=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,kd=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return clamp(mix(lerpx.x,lerpx.y,f.y),0.0,1.0);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz/=light_view_pos0.w;vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return clamp(mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth)),0.0,1.0);
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const Zc=[];ua(Ld,Zc),ua(Bh,Zc),ua(el,Zc);const ca={"_prelude_fog.vertex.glsl":Vh,"_prelude_terrain.vertex.glsl":qo,"_prelude_shadow.vertex.glsl":Uh,"_prelude_fog.fragment.glsl":en,"_prelude_shadow.fragment.glsl":kd,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":qc,"_prelude_raster_particle.glsl":Dd},Nu={};Ar("",qo),Ar(en,Vh),Ar(kd,Uh),Ar(qc,""),Ar(Dd,"");const dc=Ar(el,Bh),Od=Ld;var Xc={background:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),building:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in highp vec3 v_normal;in highp float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
uniform lowp float u_opacity;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 apply_lighting_linear(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return color*(ambient_contrib+directional_contrib);}void main() {vec4 color=vec4(v_color.rgb,1.0);vec3 normal=normalize(v_normal);vec3 xy_flipped_normal=vec3(-normal.xy,normal.z);float shadowed_lighting_factor=0.0;
#ifdef RENDER_SHADOWS
shadowed_lighting_factor=shadowed_light_factor_normal(xy_flipped_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
shadowed_lighting_factor=dot(normal,u_lighting_directional_dir);
#endif
color.rgb=apply_lighting_linear(color.rgb,xy_flipped_normal,shadowed_lighting_factor);color.rgb=mix(color.rgb,v_color.rgb,v_color.a);color*=u_opacity;
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,v_height));
#endif
#ifdef RENDER_CUTOFF
color*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_height);
#endif
glFragColor=vec4(linearTosRGB(color.rgb),color.a);
#ifdef DEBUG_SHOW_NORMALS
color.rgb=xy_flipped_normal*0.5+vec3(0.5,0.5,0.5);color.a=1.0;glFragColor=color;
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;in vec3 a_normal_3f;out vec4 v_color;out highp vec3 v_normal;out highp float v_height;uniform mat4 u_matrix;uniform mat4 u_normal_matrix;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
vec4 color_emissive=decode_color(part_color_emissive);v_color=vec4(sRGBToLinear(color_emissive.rgb),color_emissive.a);v_normal=vec3(u_normal_matrix*vec4(a_normal_3f,0.0));vec3 pos=a_pos_3f;v_height=pos.z;gl_Position=u_matrix*vec4(pos,1.0);
#ifdef RENDER_SHADOWS
vec3 shadow_pos=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset_model(v_normal);shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1.0);v_depth_shadows=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),buildingDepth:Ar(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,"in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;void main() {gl_Position=u_matrix*vec4(a_pos_3f,1.0);v_depth=gl_Position.z/gl_Position.w;}"),circle:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Ar("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Ar(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Ar(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Ar("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Ar("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Ar("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),elevatedStructuresDepth:Ar(`void main() {
#ifndef DEPTH_TEXTURE
glFragColor=vec4(0.);
#endif
}`,"in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform float u_depth_bias;void main() {gl_Position=u_matrix*vec4(a_pos,a_height,1);gl_Position.z=gl_Position.z+u_depth_bias;}"),elevatedStructuresDepthReconstruct:Ar(`#ifdef DEPTH_RECONSTRUCTION
in float v_height;
#endif
void main() {
#ifdef DEPTH_RECONSTRUCTION
if (v_height >=0.0)
discard;
#endif
glFragColor=vec4(1.0,0.0,0.0,1.0);}`,`in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform vec3 u_camera_pos;uniform highp float u_depth_bias;uniform lowp float u_height_scale;uniform lowp float u_reset_depth;
#ifdef DEPTH_RECONSTRUCTION
out float v_height;
#endif
void main() {vec3 vpos=vec3(a_pos,a_height*u_height_scale);
#ifdef DEPTH_RECONSTRUCTION
if (u_camera_pos.z > vpos.z) {vpos-=(u_camera_pos-vpos)*(vpos.z/(u_camera_pos.z-vpos.z));}v_height=a_height;
#endif
gl_Position=u_matrix*vec4(vpos,1);gl_Position.z=u_reset_depth==1.0 ? gl_Position.w : gl_Position.z+u_depth_bias;}`),elevatedStructures:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in vec3 v_normal;in float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;
#endif
void main() {vec3 color=vec3(241.0/255.0,236.0/255.0,225.0/255.0);
#ifdef LIGHTING_3D_MODE
vec3 normal=normalize(v_normal);
#ifdef RENDER_SHADOWS
float shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#else
color=apply_lighting(color,normal);
#endif
if (v_height < 0.0) {float penetration=max(v_height+7.5,0.0);float occlusion=1.0-1.0/PI*acos(1.0-penetration/4.0);color=color*(1.0-pow(occlusion,2.0)*0.3);}
#endif
#ifdef FOG
color=fog_apply(color,v_fog_pos);
#endif
vec4 out_color=vec4(color,1.0);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_height);
#endif
glFragColor=out_color;HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;in float a_height;in vec3 a_pos_normal_3;uniform mat4 u_matrix;out vec3 v_normal;out float v_height;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {v_normal=a_pos_normal_3/16384.0;v_height=a_height;vec3 pos=vec3(a_pos,a_height);gl_Position=u_matrix*vec4(pos,1);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(v_normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fill:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:Ar(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Ar(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Ar(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Ar(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float epsilon=0.0001;float extrude_length_without_perspective=max(length(dist),epsilon);float extrude_length_with_perspective=max(length(projected_extrude_xy/gl_Position.w*u_units_to_pixels),epsilon);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;
#ifdef LINE_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LINE_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl*texel_size-texel_size,pattern_b_br*texel_size+texel_size,vec2(x,y));vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);color=color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:Ar("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:Ar("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Ar(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:Ar(`#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#else
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
in highp float v_z_offset;
#endif
#endif
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(abs(v_z_offset) > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#endif
#endif
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef ELEVATED_ROADS
in vec3 a_x_axis;in vec3 a_y_axis;uniform float u_normal_scale;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#else
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
out highp float v_z_offset;
#endif
#endif
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+z_offset : 0.0;
#else
z+=u_pitch_with_map ? z_offset : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
#ifdef ELEVATED_ROADS
vec3 xAxis=vec3(a_x_axis.xy,a_x_axis.z*u_normal_scale);vec3 yAxis=vec3(a_y_axis.xy,a_y_axis.z*u_normal_scale);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
pos=vec3(projected_pos.xy/projected_pos.w+offset,z);
#endif
#endif
gl_Position=mix(u_coord_matrix*vec4(pos,1.0),AWAY,hidden);float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
vec4 shd_pos=u_inv_matrix*vec4(pos,1.0);vec3 shd_pos0=shd_pos.xyz;vec3 shd_pos1=shd_pos.xyz;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#else
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
v_z_offset=e;
#endif
#endif
#endif
}`),terrainRaster:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:Ar("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Ar(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Wc),skyboxGradient:Ar(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Wc),skyboxCapture:Ar(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Ar(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Ar(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Ar(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Ar(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:Ar("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:Ar("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:Ar("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:Ar("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function ua(f,r){const l=f.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let p of l)if(p=p.trim(),p[0]==="#"&&p.includes("if")&&!p.includes("endif")){p=p.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const v=p.split(" ");for(const w of v)r.includes(w)||r.push(w)}}function Ar(f,r){const l=/#include\s+"([^"]+)"/g,p=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let v=r.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);v&&(v=v.map(z=>{const j=z.split(" ");return j[j.length-1]}),v=[...new Set(v)]);const w={},C=[],P=[];if(f=f.replace(l,(z,j)=>(P.push(j),"")),(r=r.replace(l,(z,j)=>(C.push(j),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let L=[...Zc];ua(f,L),ua(r,L);for(const z of[...C,...P])ca[z]||console.error(`Undefined include: ${z}`),Nu[z]||(Nu[z]=[],ua(ca[z],Nu[z])),L=[...L,...Nu[z]];return{fragmentSource:f=f.replace(p,(z,j,H,$,q)=>(w[q]=!0,j==="define"?`
#ifndef HAS_UNIFORM_u_${q}
in ${H} ${$} ${q};
#else
uniform ${H} ${$} u_${q};
#endif
`:j==="initialize"?`
#ifdef HAS_UNIFORM_u_${q}
    ${H} ${$} ${q} = u_${q};
#endif
`:j==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${q}
    in ${H} ${$} ${q};
#endif
`:j==="initialize-attribute"?"":void 0)),vertexSource:r=r.replace(p,(z,j,H,$,q)=>{const re=$==="float"?"vec2":$,te=q.match(/color/)?"color":re;return j==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${q}
in ${H} ${$} a_${q};
#endif
`:w[q]?j==="define"?`
#ifndef HAS_UNIFORM_u_${q}
uniform lowp float u_${q}_t;
in ${H} ${re} a_${q};
out ${H} ${$} ${q};
#else
uniform ${H} ${$} u_${q};
#endif
`:j==="initialize"?te==="vec4"?`
#ifndef HAS_UNIFORM_u_${q}
    ${q} = a_${q};
#else
    ${H} ${$} ${q} = u_${q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${q}
    ${q} = unpack_mix_${te}(a_${q}, u_${q}_t);
#else
    ${H} ${$} ${q} = u_${q};
#endif
`:j==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${q}
    in ${H} ${$} a_${q};
    out ${H} ${$} ${q};
#endif
`:j==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${q}
    ${q} = a_${q};
#endif
`:void 0:j==="define"?`
#ifndef HAS_UNIFORM_u_${q}
uniform lowp float u_${q}_t;
in ${H} ${re} a_${q};
#else
uniform ${H} ${$} u_${q};
#endif
`:j==="define-instanced"?te==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${q}0;
in vec4 a_${q}1;
in vec4 a_${q}2;
in vec4 a_${q}3;
#else
uniform ${H} ${$} u_${q};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${H} ${re} a_${q};
#else
uniform ${H} ${$} u_${q};
#endif
`:j==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${q}
    ${H} ${$} ${q} = a_${q};
#endif
`:te==="vec4"?`
#ifndef HAS_UNIFORM_u_${q}
    ${H} ${$} ${q} = a_${q};
#else
    ${H} ${$} ${q} = u_${q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${q}
    ${H} ${$} ${q} = unpack_mix_${te}(a_${q}, u_${q}_t);
#else
    ${H} ${$} ${q} = u_${q};
#endif
`}),staticAttributes:v,usedDefines:L,vertexIncludes:C,fragmentIncludes:P}}class $h{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(r,l,p,v,w,C,P,L){this.context=r;let z=this.boundPaintVertexBuffers.length!==v.length;for(let H=0;!z&&H<v.length;H++)this.boundPaintVertexBuffers[H]!==v[H]&&(z=!0);let j=this.boundDynamicVertexBuffers.length!==P.length;for(let H=0;!j&&H<P.length;H++)this.boundDynamicVertexBuffers[H]!==P[H]&&(j=!0);if(!this.vao||this.boundProgram!==l||this.boundLayoutVertexBuffer!==p||z||j||this.boundIndexBuffer!==w||this.boundVertexOffset!==C)this.freshBind(l,p,v,w,C,P,L);else{r.bindVertexArrayOES.set(this.vao);for(const H of P)H&&(H.bind(),L&&H.instanceCount&&H.setVertexAttribDivisor(r.gl,l,L));w&&w.dynamicDraw&&w.bind()}}freshBind(r,l,p,v,w,C,P){const L=r.numAttributes,z=this.context,j=z.gl;this.vao&&this.destroy(),this.vao=z.gl.createVertexArray(),z.bindVertexArrayOES.set(this.vao),this.boundProgram=r,this.boundLayoutVertexBuffer=l,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=v,this.boundVertexOffset=w,this.boundDynamicVertexBuffers=C,l.enableAttributes(j,r),l.bind(),l.setVertexAttribPointers(j,r,w);for(const H of p)H.enableAttributes(j,r),H.bind(),H.setVertexAttribPointers(j,r,w);for(const H of C)H&&(H.enableAttributes(j,r),H.bind(),H.setVertexAttribPointers(j,r,w),P&&H.instanceCount&&H.setVertexAttribDivisor(j,r,P));v&&v.bind(),z.currentNumAttributes=L}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function ty(f,r){const l=Math.pow(2,r.canonical.z),p=r.canonical.y;return[new i.ac(0,p/l).toLngLat().lat,new i.ac(0,(p+1)/l).toLngLat().lat]}function Cg(f,r,l,p,v,w,C){const P=f.context,L=P.gl,z=l.hillshadeFBO;if(!z)return;f.prepareDrawTile();const j=f.isTileAffectedByFog(r),H=f.getOrCreateProgram("hillshade",{overrideFog:j});P.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,z.colorAttachment.get());const $=((oe,ne,ye,Se)=>{const Te=ye.paint.get("hillshade-shadow-color"),ke=ye.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",De=ye.paint.get("hillshade-highlight-color"),Me=ye.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",Pe=ye.paint.get("hillshade-accent-color"),Oe=ye.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",Ne=ye.paint.get("hillshade-emissive-strength");let ht=i.al(ye.paint.get("hillshade-illumination-direction"));if(ye.paint.get("hillshade-illumination-anchor")==="viewport")ht-=oe.transform.angle;else if(oe.style&&oe.style.enable3dLights()&&oe.style.directionalLight){const Tt=oe.style.directionalLight.properties.get("direction"),It=i.cR(Tt.x,Tt.y,Tt.z);ht=i.al(It[1])}const rt=!oe.options.moving;return{u_matrix:Se||oe.transform.calculateProjMatrix(ne.tileID.toUnwrapped(),rt),u_image:0,u_latrange:ty(0,ne.tileID),u_light:[ye.paint.get("hillshade-exaggeration"),ht],u_shadow:Te.toRenderColor(ke?null:ye.lut),u_highlight:De.toRenderColor(Me?null:ye.lut),u_emissive_strength:Ne,u_accent:Pe.toRenderColor(Oe?null:ye.lut)}})(f,l,p,f.terrain?r.projMatrix:null);f.uploadCommonUniforms(P,H,r.toUnwrapped());const{tileBoundsBuffer:q,tileBoundsIndexBuffer:re,tileBoundsSegments:te}=f.getTileBoundsBuffers(l);H.draw(f,L.TRIANGLES,v,w,C,Bn.disabled,$,p.id,q,re,te)}function ju(f,r,l){if(!r.needsDEMTextureUpload)return;const p=f.context,v=p.gl;p.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||f.getTileTexture(l.stride);const w=l.getPixels();r.demTexture?r.demTexture.update(w,{premultiply:!1}):r.demTexture=new i.T(p,w,v.R32F,{premultiply:!1}),r.needsDEMTextureUpload=!1}function lm(f,r,l){const p=f.context,v=p.gl;if(!r.dem)return;const w=r.dem;if(p.activeTexture.set(v.TEXTURE1),ju(f,r,w),!r.demTexture)return;r.demTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE);const C=w.dim;p.activeTexture.set(v.TEXTURE0);let P=r.hillshadeFBO;if(!P){const $=new i.T(p,{width:C,height:C,data:null},v.RGBA8);$.bind(v.LINEAR,v.CLAMP_TO_EDGE),P=r.hillshadeFBO=p.createFramebuffer(C,C,!0,"renderbuffer"),P.colorAttachment.set($.texture)}p.bindFramebuffer.set(P.framebuffer),p.viewport.set([0,0,C,C]);const{tileBoundsBuffer:L,tileBoundsIndexBuffer:z,tileBoundsSegments:j}=f.getMercatorTileBoundsBuffers(),H=[];f.linearFloatFilteringSupported()&&H.push("TERRAIN_DEM_FLOAT_FORMAT"),f.getOrCreateProgram("hillshadePrepare",{defines:H}).draw(f,v.TRIANGLES,gn.disabled,zn.disabled,or.unblended,Bn.disabled,(($,q)=>{const re=q.stride,te=i.bz();return i.c5(te,0,i.aj,-i.aj,0,0,1),i.bo(te,te,[0,-i.aj,0]),{u_matrix:te,u_image:1,u_dimension:[re,re],u_zoom:$.overscaledZ}})(r.tileID,w),l.id,L,z,j),r.needsHillshadePrepare=!1}class Ui{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Tg extends Ui{getDefault(){return i.am.transparent}set(r){const l=this.current;(r.r!==l.r||r.g!==l.g||r.b!==l.b||r.a!==l.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class ws extends Ui{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class cm extends Ui{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class Hh extends Ui{getDefault(){return[!0,!0,!0,!0]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Gh extends Ui{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class Wh extends Ui{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class um extends Ui{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const l=this.current;(r.func!==l.func||r.ref!==l.ref||r.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class zd extends Ui{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class Fd extends Ui{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=r,this.dirty=!1}}class hc extends Ui{getDefault(){return[0,1]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class $f extends Ui{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=r,this.dirty=!1}}class Bu extends Ui{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class dm extends Ui{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.BLEND):l.disable(l.BLEND),this.current=r,this.dirty=!1}}class hm extends Ui{getDefault(){const r=this.gl;return[r.ONE,r.ZERO,r.ONE,r.ZERO]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.blendFuncSeparate(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class fc extends Ui{getDefault(){return i.am.transparent}set(r){const l=this.current;(r.r!==l.r||r.g!==l.g||r.b!==l.b||r.a!==l.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Kc extends Ui{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(r,r),this.current=r,this.dirty=!1)}}class Nd extends Ui{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;r?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=r,this.dirty=!1}}class jd extends Ui{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class Yc extends Ui{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}let Bd=class extends Ui{getDefault(){return null}set(f){(f!==this.current||this.dirty)&&(this.gl.useProgram(f),this.current=f,this.dirty=!1)}};class fm extends Ui{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class pm extends Ui{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const l=this.current;(r[0]!==l[0]||r[1]!==l[1]||r[2]!==l[2]||r[3]!==l[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class mm extends Ui{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class Hf extends Ui{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Vu extends Ui{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindTexture(l.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class pc extends Ui{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class gm extends Ui{getDefault(){return null}set(r){const l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class Uu extends Ui{getDefault(){return null}set(r){this.gl&&(r!==this.current||this.dirty)&&(this.gl.bindVertexArray(r),this.current=r,this.dirty=!1)}}class Zo extends Ui{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class Vd extends Ui{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class mc extends Ui{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class qh extends Ui{constructor(r,l){super(r),this.context=r,this.parent=l}getDefault(){return null}}class ny extends qh{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class Gf extends qh{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,this.attachment(),l.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class gc extends qh{attachment(){return this.gl.DEPTH_ATTACHMENT}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,this.attachment(),l.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class $u extends Gf{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const Jc=(f,r,l)=>({u_matrix:f,u_image0:0,u_skirt_height:r,u_ground_shadow_factor:l}),Ud=(f,r,l,p,v,w,C,P,L,z,j,H,$,q,re,te)=>({u_proj_matrix:Float32Array.from(f),u_globe_matrix:r,u_normalize_matrix:Float32Array.from(p),u_merc_matrix:l,u_zoom_transition:v,u_merc_center:w,u_image0:0,u_frustum_tl:C,u_frustum_tr:P,u_frustum_br:L,u_frustum_bl:z,u_globe_pos:j,u_globe_radius:H,u_viewport:$,u_grid_matrix:te?Float32Array.from(te):new Float32Array(9),u_skirt_height:q,u_far_z_cutoff:re});function Zh(f,r){return f!=null&&r!=null&&!(!f.hasData()||!r.hasData())&&f.demTexture!=null&&r.demTexture!=null&&f.tileID.key!==r.tileID.key}const tl=new class{constructor(){this.operations={}}newMorphing(f,r,l,p,v){if(f in this.operations){const w=this.operations[f];w.to.tileID.key!==l.tileID.key&&(w.queued=l)}else this.operations[f]={startTime:p,phase:0,duration:v,from:r,to:l,queued:null}}getMorphValuesForProxy(f){if(!(f in this.operations))return null;const r=this.operations[f];return{from:r.from,to:r.to,phase:r.phase}}update(f){for(const r in this.operations){const l=this.operations[r];for(l.phase=(f-l.startTime)/l.duration;l.phase>=1||!this._validOp(l);)if(!this._nextOp(l,f)){delete this.operations[r];break}}}_nextOp(f,r){return!!f.queued&&(f.from=f.to,f.to=f.queued,f.queued=null,f.phase=0,f.startTime=r,!0)}_validOp(f){return f.from.hasData()&&f.to.hasData()}},da={0:null,1:"TERRAIN_VERTEX_MORPHING"};function es(f,r,l){if(r===0)return 0;const p=r<1&&l===514?.25/r:1;return 6*Math.pow(1.5,22-f)*Math.max(r,1)*p}function ds(f,r){const l=1<<f.z;return!r&&(f.x===0||f.x===l-1)||f.y===0||f.y===l-1}const Os=f=>({u_matrix:f});function Ws(f,r,l,p,v){if(v>0){const w=i.q.now(),C=(w-f.timeAdded)/v,P=r?(w-r.timeAdded)/v:-1,L=l.getSource(),z=p.coveringZoomLevel({tileSize:L.tileSize,roundZoom:L.roundZoom}),j=!r||Math.abs(r.tileID.overscaledZ-z)>Math.abs(f.tileID.overscaledZ-z),H=j&&f.refreshedUponExpiration?1:i.aD(j?C:1-P,0,1);return f.refreshedUponExpiration&&C>=1&&(f.refreshedUponExpiration=!1),r?{opacity:1,mix:1-H}:{opacity:H,mix:0}}return{opacity:1,mix:0}}class To extends to{constructor(r){const l={type:"raster-dem",maxzoom:r.transform.maxZoom},p=new i.D(i.d0(),null),v=rc("mock-dem",l,p,r.style);super("mock-dem",v,!1),v.setEventedParent(this),this._sourceLoaded=!0}_loadTile(r,l){r.state="loaded",l(null)}}class Ml extends to{constructor(r){const l=rc("proxy",{type:"geojson",maxzoom:r.transform.maxZoom},new i.D(i.d0(),null),r.style);super("proxy",l,!1),l.setEventedParent(this),this.map=this.getSource().map=r,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(r,l,p){if(r.freezeTileCoverage)return;this.transform=r;const v=r.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((w,C)=>{if(w[C.key]="",!this._tiles[C.key]){const P=new wl(C,this._source.tileSize*C.overscaleFactor(),r.tileZoom);P.state="loaded",this._tiles[C.key]=P}return w},{});for(const w in this._tiles)w in v||(this.freeFBO(w),this._tiles[w].unloadVectorData(),delete this._tiles[w])}freeFBO(r){const l=this.proxyCachedFBO[r];if(l!==void 0){const p=Object.values(l);this.renderCachePool.push(...p),delete this.proxyCachedFBO[r]}}deallocRenderCache(){this.renderCache.forEach(r=>r.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class _c extends i.aM{constructor(r,l,p){super(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y),this.proxyTileKey=l,this.projMatrix=p}}class Eo extends i.dt{constructor(r,l){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},r.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),r.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),r.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=r,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[p,v,w]=function(L){const z=new i.ba,j=new i.a_,H=131;z.reserve(17161),j.reserve(33800);const $=i.aj/128,q=i.aj+$/2,re=q+$;for(let oe=-$;oe<re;oe+=$)for(let ne=-$;ne<re;ne+=$){const ye=ne<0||ne>q||oe<0||oe>q?24575:0,Se=i.aD(Math.round(ne),0,i.aj),Te=i.aD(Math.round(oe),0,i.aj);z.emplaceBack(Se+ye,Te)}const te=(oe,ne)=>{const ye=ne*H+oe;j.emplaceBack(ye+1,ye,ye+H),j.emplaceBack(ye+H,ye+H+1,ye+1)};for(let oe=1;oe<129;oe++)for(let ne=1;ne<129;ne++)te(ne,oe);return[0,129].forEach(oe=>{for(let ne=0;ne<130;ne++)te(ne,oe),te(oe,ne)}),[z,j,32768]}(),C=r.context;this.gridBuffer=C.createVertexBuffer(p,i.bc.members),this.gridIndexBuffer=C.createIndexBuffer(v),this.gridSegments=i.bd.simpleSegment(0,0,p.length,v.length),this.gridNoSkirtSegments=i.bd.simpleSegment(0,0,p.length,w),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Ml(l.map),this.orthoMatrix=i.bz(),i.c5(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,i.aj,0,i.aj,0,1);const P=C.gl;this._overlapStencilMode=new zn({func:P.GEQUAL,mask:255},0,255,P.KEEP,P.KEEP,P.REPLACE),this._previousZoom=r.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=l,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new To(l.map),this._pendingGroundEffectLayers=[]}set style(r){r.on("data",this._onStyleDataEvent.bind(this)),this._style=r,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(r,l,p){if(r&&r.terrain){this._style!==r&&(this.style=r,this._evaluationZoom=void 0);const v=r.terrain.properties,w=r.terrain.drapeRenderMode===0,C=r.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=i.q.now();const P=r.terrain&&r.terrain.scope,L=v.get("source"),z=w?this._mockSourceCache:r.getSourceCache(L,P);if(!z)return void i.w(`Couldn't find terrain source "${L}".`);if(this.sourceCache=z,this._attenuationRange=r.terrain.getAttenuationRange(),this._exaggeration=C?this.calculateExaggeration(l):v.get("exaggeration"),!l.projection.requiresDraping&&C&&this._exaggeration===0)return void this._disable();this.enabled=!0;const j=()=>{this.sourceCache.used&&i.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const H=this.getScaledDemTileSize();this.sourceCache.update(l,H,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,j(),this._initializing=!0),j(),l.updateElevation(!0,p),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(l),this._emptyDEMTextureDirty=!0,this._previousZoom=l.zoom}else this._disable()}calculateExaggeration(r){if(this._attenuationRange&&r.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(r.zoom);const l=this._previousCameraAltitude,p=r.getFreeCameraOptions().position.z/r.pixelsPerMeter*r.worldSize;this._previousCameraAltitude=p;const v=l!=null?p-l:Number.MAX_VALUE;if(Math.abs(v)<2)return this._exaggeration;const w=r.zoom,C=this._style.terrain;if(!this._previousUpdateTimestamp)return C.getExaggeration(w);let P=w-this._previousZoom;const L=this._previousUpdateTimestamp;let z=w;this._evaluationZoom!=null&&(z=this._evaluationZoom,Math.abs(w-z)>.5&&(P=.5*(w-z+P)),P*v<0&&(z+=P)),this._evaluationZoom=z;const j=C.getExaggeration(z),H=j===C.getExaggeration(Math.max(0,z-.1));if(H&&Math.abs(j-this._exaggeration)<.01)return j;let $=Math.min(.1,.00375*(this._updateTimestamp-L));return(H||j<.1||Math.abs(P)<1e-4)&&($=Math.min(.2,4*$)),i.ai(this._exaggeration,j,$)}resetTileLookupCache(r){this._findCoveringTileCache[r]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(r){r.coord&&r.dataType==="source"?this._clearRenderCacheForTile(r.sourceCacheId,r.coord):r.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const r in this._style._mergedSourceCaches)this._style._mergedSourceCaches[r].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(r=>r.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const r=2*this.proxySourceCache.getSource().tileSize;return[r,r]}set useVertexMorphing(r){this._useVertexMorphing=r}updateTileBinding(r){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const l=this.proxySourceCache,p=this.painter.transform;this._initializing&&(this._initializing=p._centerAltitude===0&&this.getAtPointOrZero(i.ac.fromLngLat(p.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const v=this.proxyCoords=l.getIds().map(L=>{const z=l.getTileByID(L).tileID;return z.projMatrix=p.calculateProjMatrix(z.toUnwrapped()),z});(function(L,z){const j=z.transform.pointCoordinate(z.transform.getCameraPoint()),H=new i.P(j.x,j.y);L.sort(($,q)=>{if(q.overscaledZ-$.overscaledZ)return q.overscaledZ-$.overscaledZ;const re=new i.P($.canonical.x+(1<<$.canonical.z)*$.wrap,$.canonical.y),te=new i.P(q.canonical.x+(1<<q.canonical.z)*q.wrap,q.canonical.y),oe=H.mult(1<<$.canonical.z);return oe.x-=.5,oe.y-=.5,oe.distSqr(re)-oe.distSqr(te)})})(v,this.painter);const w=this.proxyToSource||{};this.proxyToSource={},v.forEach(L=>{this.proxyToSource[L.key]={}}),this.terrainTileForTile={};const C=this._style._mergedSourceCaches;for(const L in C){const z=C[L];if(!z.used||(z!==this.sourceCache&&this.resetTileLookupCache(z.id),this._setupProxiedCoordsForOrtho(z,r[L],w),z.usedForTerrain))continue;const j=r[L];z.getSource().reparseOverscaled&&this._assignTerrainTiles(j)}this.proxiedCoords[l.id]=v.map(L=>new _c(L,L.key,this.orthoMatrix)),this._assignTerrainTiles(v),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(w),this.renderingToTexture=!1;const P={};this._visibleDemTiles=[];for(const L of this.proxyCoords){const z=this.terrainTileForTile[L.key];if(!z)continue;const j=z.tileID.key;j in P||(this._visibleDemTiles.push(z),P[j]=j)}}_assignTerrainTiles(r){this._initializing||r.forEach(l=>{if(this.terrainTileForTile[l.key])return;const p=this._findTileCoveringTileID(l,this.sourceCache);p&&(this.terrainTileForTile[l.key]=p)})}_prepareDEMTextures(){const r=this.painter.context,l=r.gl;for(const p in this.terrainTileForTile){const v=this.terrainTileForTile[p],w=v.dem;!w||v.demTexture&&!v.needsDEMTextureUpload||(r.activeTexture.set(l.TEXTURE1),ju(this.painter,v,w))}}_prepareDemTileUniforms(r,l,p,v){if(!l||l.demTexture==null)return!1;const w=r.tileID.canonical,C=Math.pow(2,l.tileID.canonical.z-w.z),P=v||"";return p[`u_dem_tl${P}`]=[w.x*C%1,w.y*C%1],p[`u_dem_scale${P}`]=C,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let r=0;const l=this._visibleDemTiles.reduce((p,v)=>{if(!v.dem)return p;const w=v.dem.tree.minimums[0];return w>0&&r++,p+w},0);return r?l/r:0}_updateEmptyDEMTexture(){const r=this.painter.context,l=r.gl;r.activeTexture.set(l.TEXTURE2);const p=this._getLoadedAreaMinimum(),v=new i.du({width:1,height:1},new Float32Array([p]));this._emptyDEMTextureDirty=!1;let w=this._emptyDEMTexture;return w?w.update(v,{premultiply:!1}):w=this._emptyDEMTexture=new i.T(r,v,l.R32F,{premultiply:!1}),w}setupElevationDraw(r,l,p){const v=this.painter.context,w=v.gl,C={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};C.u_exaggeration=this.exaggeration();let P=null,L=null,z=1;if(p&&p.morphing&&this._useVertexMorphing){const q=p.morphing.srcDemTile,re=p.morphing.dstDemTile;z=p.morphing.phase,q&&re&&(this._prepareDemTileUniforms(r,q,C,"_prev")&&(L=q),this._prepareDemTileUniforms(r,re,C)&&(P=re))}const j=q=>q&&q.demTexture&&this.painter.linearFloatFilteringSupported()?w.LINEAR:w.NEAREST;let H=null;var $;if(this.enabled?L&&P?(H=P.demTexture,v.activeTexture.set(w.TEXTURE4),L.demTexture.bind(j(L),w.CLAMP_TO_EDGE),C.u_dem_lerp=z):(P=this.terrainTileForTile[r.tileID.key],H=this._prepareDemTileUniforms(r,P,C)?P.demTexture:this.emptyDEMTexture):H=this.emptyDEMTexture,v.activeTexture.set(w.TEXTURE2),H&&(C.u_dem_size=($=H).size[0]===1?1:$.size[0]-2,H.bind(j(P),w.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(p&&p.useDepthForOcclusion,l,C),p&&p.useMeterToDem&&P){const q=(1<<P.tileID.canonical.z)*i.c6(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;C.u_meter_to_dem=q}if(p&&p.labelPlaneMatrixInv&&(C.u_label_plane_matrix_inv=p.labelPlaneMatrixInv),l.setTerrainUniformValues(v,C),this.painter.transform.projection.name==="globe"){const q=this.globeUniformValues(this.painter.transform,r.tileID.canonical,p&&p.useDenormalizedUpVectorScale);l.setGlobeUniformValues(v,q)}}globeUniformValues(r,l,p){const v=r.projection;return{u_tile_tl_up:v.upVector(l,0,0),u_tile_tr_up:v.upVector(l,i.aj,0),u_tile_br_up:v.upVector(l,i.aj,i.aj),u_tile_bl_up:v.upVector(l,0,i.aj),u_tile_up_scale:p?i.dv(1):v.upVectorScale(l,r.center.lat,r.worldSize).metersToTile}}renderToBackBuffer(r){const l=this.painter,p=this.painter.context;r.length!==0&&(p.bindFramebuffer.set(null),p.viewport.set([0,0,l.width,l.height]),l.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(v,w,C,P,L){if(v.transform.projection.name==="globe")(function(z,j,H,$,q){const re=z.context,te=re.gl;let oe,ne;const ye=z.transform,Se=i.dl(z,re,ye),Te=(Tt,It)=>{if(ne===It)return;const Ht=[da[It],"PROJECTION_GLOBE_VIEW"];Se&&Ht.push("CUSTOM_ANTIALIASING");const Qe=z.isTileAffectedByFog(Tt);oe=z.getOrCreateProgram("globeRaster",{defines:Ht,overrideFog:Qe}),ne=It},ke=z.colorModeForRenderPass(),De=new gn(te.LEQUAL,gn.ReadWrite,z.depthRangeFor3D);tl.update(q);const Me=i.dm(ye),Pe=[i.ay(ye.center.lng),i.aH(ye.center.lat)],Oe=z.globeSharedBuffers,Ne=[ye.width*i.q.devicePixelRatio,ye.height*i.q.devicePixelRatio],ht=Float32Array.from(ye.globeMatrix),rt={useDenormalizedUpVectorScale:!0};{const Tt=z.transform,It=es(Tt.zoom,j.exaggeration(),j.sourceCache._source.tileSize);ne=-1;const Ht=te.TRIANGLES;for(const Qe of $){const dt=H.getTile(Qe),Je=zn.disabled,Dt=j.prevTerrainTileForTile[Qe.key],mt=j.terrainTileForTile[Qe.key];Zh(Dt,mt)&&tl.newMorphing(Qe.key,Dt,mt,q,250),re.activeTexture.set(te.TEXTURE0),dt.texture&&dt.texture.bind(te.LINEAR,te.CLAMP_TO_EDGE);const Ot=tl.getMorphValuesForProxy(Qe.key),Mt=Ot?1:0;Ot&&i.L(rt,{morphing:{srcDemTile:Ot.from,dstDemTile:Ot.to,phase:i.dk(Ot.phase)}});const Nt=i.dn(Qe.canonical),Vt=i.dp(Nt.getCenter().lat),pn=i.dq(Qe.canonical,Nt,Vt,Tt.worldSize/Tt._pixelsPerMercatorPixel),bn=i.bh(i.dr(Qe.canonical)),rn=Ud(Tt.expandedFarZProjMatrix,ht,Me,bn,i.ah(Tt.zoom),Pe,Tt.frustumCorners.TL,Tt.frustumCorners.TR,Tt.frustumCorners.BR,Tt.frustumCorners.BL,Tt.globeCenterInViewSpace,Tt.globeRadius,Ne,It,Tt._farZ,pn);if(Te(Qe,Mt),oe&&(j.setupElevationDraw(dt,oe,rt),z.uploadCommonUniforms(re,oe,Qe.toUnwrapped()),Oe)){const[vn,dn,Rn]=Oe.getGridBuffers(Vt,It!==0);oe.draw(z,Ht,De,Je,ke,Bn.backCCW,rn,"globe_raster",vn,dn,Rn)}}}if(Oe&&(z.renderDefaultNorthPole||z.renderDefaultSouthPole)){const Tt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Se&&Tt.push("CUSTOM_ANTIALIASING"),oe=z.getOrCreateProgram("globeRaster",{defines:Tt});for(const It of $){const{x:Ht,y:Qe,z:dt}=It.canonical,Je=Qe===0,Dt=Qe===(1<<dt)-1,[mt,Ot,Mt,Nt]=Oe.getPoleBuffers(dt,!1);if(Nt&&(Je||Dt)){const Vt=H.getTile(It);re.activeTexture.set(te.TEXTURE0),Vt.texture&&Vt.texture.bind(te.LINEAR,te.CLAMP_TO_EDGE);let pn=i.ds(dt,Ht,ye);const bn=i.bh(i.dr(It.canonical)),rn=(vn,dn)=>vn.draw(z,te.TRIANGLES,De,zn.disabled,ke,Bn.disabled,Ud(ye.expandedFarZProjMatrix,pn,pn,bn,0,Pe,ye.frustumCorners.TL,ye.frustumCorners.TR,ye.frustumCorners.BR,ye.frustumCorners.BL,ye.globeCenterInViewSpace,ye.globeRadius,Ne,0,ye._farZ),"globe_pole_raster",dn,Mt,Nt);j.setupElevationDraw(Vt,oe,rt),z.uploadCommonUniforms(re,oe,It.toUnwrapped()),Je&&z.renderDefaultNorthPole&&rn(oe,mt),Dt&&z.renderDefaultSouthPole&&(pn=i.cE(i.bz(),pn,[1,-1,1]),rn(oe,Ot))}}}})(v,w,C,P,L);else{const z=v.context,j=z.gl;let H,$;const q=v.shadowRenderer,re=Qa(v,v.longestCutoffRange),te=ke=>{if($===ke)return;const De=[];De.push(da[ke]),re.shouldRenderCutoff&&De.push("RENDER_CUTOFF"),q&&(De.push("RENDER_SHADOWS","DEPTH_TEXTURE"),q.useNormalOffset&&De.push("NORMAL_OFFSET")),H=v.getOrCreateProgram("terrainRaster",{defines:De}),$=ke},oe=v.colorModeForRenderPass(),ne=new gn(j.LEQUAL,gn.ReadWrite,v.depthRangeFor3D);tl.update(L);const ye=v.transform,Se=es(ye.zoom,w.exaggeration(),w.sourceCache._source.tileSize);let Te=[0,0,0];if(q){const ke=v.style.directionalLight,De=v.style.ambientLight;ke&&De&&(Te=Ia(v.style,ke,De))}{$=-1;const ke=j.TRIANGLES,[De,Me]=[w.gridIndexBuffer,w.gridSegments];for(const Pe of P){const Oe=C.getTile(Pe),Ne=zn.disabled,ht=w.prevTerrainTileForTile[Pe.key],rt=w.terrainTileForTile[Pe.key];Zh(ht,rt)&&tl.newMorphing(Pe.key,ht,rt,L,250),z.activeTexture.set(j.TEXTURE0),Oe.texture&&Oe.texture.bind(j.LINEAR,j.CLAMP_TO_EDGE);const Tt=tl.getMorphValuesForProxy(Pe.key),It=Tt?1:0;let Ht;Tt&&(Ht={morphing:{srcDemTile:Tt.from,dstDemTile:Tt.to,phase:i.dk(Tt.phase)}});const Qe=Jc(Pe.projMatrix,ds(Pe.canonical,ye.renderWorldCopies)?Se/10:Se,Te);if(te(It),!H)continue;w.setupElevationDraw(Oe,H,Ht);const dt=Pe.toUnwrapped();q&&q.setupShadows(dt,H),v.uploadCommonUniforms(z,H,dt,null,re),H.draw(v,ke,ne,Ne,oe,Bn.backCCW,Qe,"terrain_raster",w.gridBuffer,De,Me)}}}}(l,this,this.proxySourceCache,r,this._updateTimestamp),this.renderingToTexture=!0,l.gpuTimingDeferredRenderEnd(),r.splice(0,r.length))}renderBatch(r){if(this._drapedRenderBatches.length===0)return r+1;this.renderingToTexture=!0;const l=this.painter,p=this.painter.context,v=this.proxySourceCache,w=this.proxiedCoords[v.id],C=this._drapedRenderBatches.shift(),P=l.style.order,L=[];let z=0;for(const j of w){const H=v.getTileByID(j.proxyTileKey),$=v.proxyCachedFBO[j.key]?v.proxyCachedFBO[j.key][r]:void 0,q=$!==void 0?v.renderCache[$]:this.pool[z++],re=$!==void 0;if(H.texture=q.tex,re&&!q.dirty){L.push(H.tileID);continue}let te;p.bindFramebuffer.set(q.fb.framebuffer),this.renderedToTile=!1,q.dirty&&(p.clear({color:i.am.transparent,stencil:0}),q.dirty=!1);for(let oe=C.start;oe<=C.end;++oe){const ne=l.style._mergedLayers[P[oe]];if(ne.isHidden(l.transform.zoom))continue;const ye=l.style.getLayerSourceCache(ne),Se=ye?this.proxyToSource[j.key][ye.id]:[j];if(!Se)continue;const Te=Se;p.viewport.set([0,0,q.fb.width,q.fb.height]),te!==(ye?ye.id:null)&&(this._setupStencil(q,Se,ne,ye),te=ye?ye.id:null),l.renderLayer(l,ye,ne,Te)}if(this._drapedRenderBatches.length===0)for(const oe of this._pendingGroundEffectLayers){const ne=l.style._mergedLayers[P[oe]];if(ne.isHidden(l.transform.zoom))continue;const ye=l.style.getLayerSourceCache(ne),Se=ye?this.proxyToSource[j.key][ye.id]:[j];if(!Se)continue;const Te=Se;p.viewport.set([0,0,q.fb.width,q.fb.height]),te!==(ye?ye.id:null)&&(this._setupStencil(q,Se,ne,ye),te=ye?ye.id:null),l.renderLayer(l,ye,ne,Te)}this.renderedToTile?(q.dirty=!0,L.push(H.tileID)):re||--z,z===5&&(z=0,this.renderToBackBuffer(L))}return this.renderToBackBuffer(L),this.renderingToTexture=!1,p.bindFramebuffer.set(null),p.viewport.set([0,0,l.width,l.height]),C.end+1}postRender(){}isLayerOrderingCorrect(r){const l=r.order.length;let p=-1,v=l;for(let w=0;w<l;++w)this._style.isLayerDraped(r._mergedLayers[r.order[w]])?p=Math.max(p,w):v=Math.min(v,w);return v>p}getMinElevationBelowMSL(){let r=0;return this._visibleDemTiles.filter(l=>l.dem).forEach(l=>{r=Math.min(r,l.dem.tree.minimums[0])}),r===0?r:(r-30)*this._exaggeration}raycast(r,l,p){if(!this._visibleDemTiles)return null;const v=this._visibleDemTiles.filter(w=>w.dem).map(w=>{const C=w.tileID,P=1<<C.overscaledZ,{x:L,y:z}=C.canonical,j=L/P,H=(L+1)/P,$=z/P,q=(z+1)/P;return{minx:j,miny:$,maxx:H,maxy:q,t:w.dem.tree.raycastRoot(j,$,H,q,r,l,p),tile:w}});v.sort((w,C)=>(w.t!==null?w.t:Number.MAX_VALUE)-(C.t!==null?C.t:Number.MAX_VALUE));for(const w of v){if(w.t==null)return null;const C=w.tile.dem.tree.raycast(w.minx,w.miny,w.maxx,w.maxy,r,l,p);if(C!=null)return C}return null}_createFBO(){const r=this.painter.context,l=r.gl,p=this.drapeBufferSize;r.activeTexture.set(l.TEXTURE0);const v=new i.T(r,{width:p[0],height:p[1],data:null},l.RGBA8);v.bind(l.LINEAR,l.CLAMP_TO_EDGE);const w=r.createFramebuffer(p[0],p[1],!0,null);return w.colorAttachment.set(v.texture),w.depthAttachment=new $u(r,w.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=r.createRenderbuffer(r.gl.DEPTH_STENCIL,p[0],p[1]),this._stencilRef=0,w.depthAttachment.set(this._sharedDepthStencil),r.clear({stencil:0})):w.depthAttachment.set(this._sharedDepthStencil),r.extTextureFilterAnisotropic&&l.texParameterf(l.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax),{fb:w,tex:v,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const r in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[r].hasTransition())return!0;return this._style.order.some(r=>{const l=this._style._mergedLayers[r],p=l.isHidden(this.painter.transform.zoom);return l.type==="hillshade"||l.type==="custom"?!p&&l.shouldRedrape():!p&&l.hasTransition()})}_clearLineLayersFromRenderCache(){let r=!1;for(const p of this._style.getSources())if(p instanceof os){r=!0;break}if(!r)return;const l={};for(let p=0;p<this._style.order.length;++p){const v=this._style._mergedLayers[this._style.order[p]],w=this._style.getLayerSourceCache(v);if(w&&!l[w.id]&&!v.isHidden(this.painter.transform.zoom)&&v.type==="line"&&v.widthExpression()instanceof i.ab){l[w.id]=!0;for(const C of this.proxyCoords){const P=this.proxyToSource[C.key][w.id];if(P)for(const L of P)this._clearRenderCacheForTile(w.id,L)}}}}_clearRasterLayersFromRenderCache(){let r=!1;for(const p in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[p]._source instanceof xl){r=!0;break}if(!r)return;const l={};for(let p=0;p<this._style.order.length;++p){const v=this._style._mergedLayers[this._style.order[p]],w=this._style.getLayerSourceCache(v);if(!w||l[w.id]||v.isHidden(this.painter.transform.zoom)||v.type!=="raster")continue;const C=v.paint.get("raster-fade-duration");for(const P of this.proxyCoords){const L=this.proxyToSource[P.key][w.id];if(L)for(const z of L){const j=Ws(w.getTile(z),w.findLoadedParent(z,0),w,this.painter.transform,C);(j.opacity!==1||j.mix!==0)&&this._clearRenderCacheForTile(w.id,z)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const r=this._style.order,l=r.length;if(l===0)return;const p=[];this._pendingGroundEffectLayers=[];let v,w=0,C=this._style._mergedLayers[r[w]];for(;!this._style.isLayerDraped(C)&&C.isHidden(this.painter.transform.zoom)&&++w<l;)C=this._style._mergedLayers[r[w]];for(;w<l;++w){const P=this._style._mergedLayers[r[w]];P.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(P)?v===void 0&&(v=w):(P.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(w),v!==void 0&&(p.push({start:v,end:w-1}),v=void 0)))}if(v!==void 0&&p.push({start:v,end:w-1}),p.length!==0){const P=p[p.length-1];this._pendingGroundEffectLayers.every(L=>L>P.end)||i.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=p}_setupRenderCache(r){const l=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,l.renderCache.length>l.renderCachePool.length){const C=Object.values(l.proxyCachedFBO);l.proxyCachedFBO={};for(let P=0;P<C.length;++P){const L=Object.values(C[P]);l.renderCachePool.push(...L)}}return}this._clearRasterLayersFromRenderCache();const p=this.proxyCoords,v=this._tilesDirty;for(let C=p.length-1;C>=0;C--){const P=p[C];if(l.getTileByID(P.key),l.proxyCachedFBO[P.key]!==void 0){const L=r[P.key],z=this.proxyToSource[P.key];let j=0;for(const H in z){const $=z[H],q=L[H];if(!q||q.length!==$.length||$.some((re,te)=>re!==q[te]||v[H]&&v[H].hasOwnProperty(re.key))){j=-1;break}++j}for(const H in l.proxyCachedFBO[P.key])l.renderCache[l.proxyCachedFBO[P.key][H]].dirty=j<0||j!==Object.values(L).length}}const w=[...this._drapedRenderBatches];w.sort((C,P)=>P.end-P.start-(C.end-C.start));for(const C of w)for(const P of p){if(l.proxyCachedFBO[P.key])continue;let L=l.renderCachePool.pop();L===void 0&&l.renderCache.length<50&&(L=l.renderCache.length,l.renderCache.push(this._createFBO())),L!==void 0&&(l.proxyCachedFBO[P.key]={},l.proxyCachedFBO[P.key][C.start]=L,l.renderCache[L].dirty=!0)}this._tilesDirty={}}_setupStencil(r,l,p,v){if(!v||!this._sourceTilesOverlap[v.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const w=this.painter.context,C=w.gl;if(l.length<=1)return void(this._overlapStencilType=!1);let P;if(p.isTileClipped())P=l.length,this._overlapStencilMode.test={func:C.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(l[0].overscaledZ>l[l.length-1].overscaledZ))return void(this._overlapStencilType=!1);P=1,this._overlapStencilMode.test={func:C.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+P>255&&(w.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=P,this._overlapStencilMode.ref=this._stencilRef,p.isTileClipped()&&this._renderTileClippingMasks(l,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(r){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[r.key]),this._overlapStencilMode):zn.disabled}_renderTileClippingMasks(r,l){const p=this.painter,v=this.painter.context,w=v.gl;p._tileClippingMaskIDs={},v.setColorMode(or.disabled),v.setDepthMode(gn.disabled);const C=p.getOrCreateProgram("clippingMask");for(const P of r){const L=p._tileClippingMaskIDs[P.key]=--l;C.draw(p,w.TRIANGLES,gn.disabled,new zn({func:w.ALWAYS,mask:0},L,255,w.KEEP,w.KEEP,w.REPLACE),or.disabled,Bn.disabled,Os(P.projMatrix),"$clipping",p.tileExtentBuffer,p.quadTriangleIndexBuffer,p.tileExtentSegments)}}pointCoordinate(r){const l=this.painter.transform;if(r.x<0||r.x>l.width||r.y<0||r.y>l.height)return null;const p=[r.x,r.y,1,1];i.aA(p,p,l.pixelMatrixInverse),i.cw(p,p,1/p[3]),p[0]/=l.worldSize,p[1]/=l.worldSize;const v=l._camera.position,w=i.c6(1,l.center.lat),C=[v[0],v[1],v[2]/w,0],P=i.cY([],p.slice(0,3),C);i.au(P,P);const L=this.raycast(C,P,this._exaggeration);return L!==null&&L?(i.bF(C,C,P,L),C[3]=C[2],C[2]*=w,C):null}_setupProxiedCoordsForOrtho(r,l,p){if(r.getSource()instanceof i.aP)return this._setupProxiedCoordsForImageSource(r,l,p);this._findCoveringTileCache[r.id]=this._findCoveringTileCache[r.id]||{};const v=this.proxiedCoords[r.id]=[],w=this.proxyCoords;for(let L=0;L<w.length;L++){const z=w[L],j=this._findTileCoveringTileID(z,r);if(j){const H=this._createProxiedId(z,j,p[z.key]&&p[z.key][r.id]);v.push(H),this.proxyToSource[z.key][r.id]=[H]}}let C=!1;const P=new Set;for(let L=0;L<l.length;L++){const z=r.getTile(l[L]);if(!z||!z.hasData())continue;const j=this._findTileCoveringTileID(z.tileID,this.proxySourceCache);if(j&&j.tileID.canonical.z!==z.tileID.canonical.z){const H=this.proxyToSource[j.tileID.key][r.id],$=this._createProxiedId(j.tileID,z,p[j.tileID.key]&&p[j.tileID.key][r.id]);H?H.splice(H.length-1,0,$):this.proxyToSource[j.tileID.key][r.id]=[$];const q=this.proxyToSource[j.tileID.key][r.id];P.has(q)||P.add(q),v.push($),C=!0}}if(this._sourceTilesOverlap[r.id]=C,C&&this._debugParams.sortTilesHiZFirst)for(const L of P)L.sort((z,j)=>j.overscaledZ-z.overscaledZ)}_setupProxiedCoordsForImageSource(r,l,p){if(!r.getSource().loaded())return;const v=this.proxiedCoords[r.id]=[],w=this.proxyCoords,C=r.getSource(),P=C.tileID;if(!P)return;const L=new i.P(P.x,P.y)._div(1<<P.z),z=C.coordinates.map(i.ac.fromLngLat).reduce((H,$)=>(H.min.x=Math.min(H.min.x,$.x-L.x),H.min.y=Math.min(H.min.y,$.y-L.y),H.max.x=Math.max(H.max.x,$.x-L.x),H.max.y=Math.max(H.max.y,$.y-L.y),H),{min:new i.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new i.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),j=(H,$)=>{const q=H.wrap+H.canonical.x/(1<<H.canonical.z),re=H.canonical.y/(1<<H.canonical.z),te=i.aj/(1<<H.canonical.z),oe=$.wrap+$.canonical.x/(1<<$.canonical.z),ne=$.canonical.y/(1<<$.canonical.z);return q+te<oe+z.min.x||q>oe+z.max.x||re+te<ne+z.min.y||re>ne+z.max.y};for(let H=0;H<w.length;H++){const $=w[H];for(let q=0;q<l.length;q++){const re=r.getTile(l[q]);if(!re||!re.hasData()||j($,re.tileID))continue;const te=this._createProxiedId($,re,p[$.key]&&p[$.key][r.id]),oe=this.proxyToSource[$.key][r.id];oe?oe.push(te):this.proxyToSource[$.key][r.id]=[te],v.push(te)}}}_createProxiedId(r,l,p){let v=this.orthoMatrix;if(p){const w=p.find(C=>C.key===l.tileID.key);if(w)return w}if(l.tileID.key!==r.key){const w=r.canonical.z-l.tileID.canonical.z;let C,P,L;v=i.bz();const z=l.tileID.wrap-r.wrap<<r.overscaledZ;w>0?(C=i.aj>>w,P=C*((l.tileID.canonical.x<<w)-r.canonical.x+z),L=C*((l.tileID.canonical.y<<w)-r.canonical.y)):(C=i.aj<<-w,P=i.aj*(l.tileID.canonical.x-(r.canonical.x+z<<-w)),L=i.aj*(l.tileID.canonical.y-(r.canonical.y<<-w))),i.c5(v,0,C,0,C,0,1),i.bo(v,v,[P,L,0])}return new _c(l.tileID,r.key,v)}_findTileCoveringTileID(r,l){let p=l.getTile(r);if(p&&p.hasData())return p;const v=this._findCoveringTileCache[l.id],w=v[r.key];if(p=w?l.getTileByID(w):null,p&&p.hasData()||w===null)return p;let C=p?p.tileID:r,P=C.overscaledZ;const L=l.getSource().minzoom,z=[];if(!w){const H=l.getSource().maxzoom;if(r.canonical.z>=H){const $=r.canonical.z-H;l.getSource().reparseOverscaled?(P=Math.max(r.canonical.z+2,l.transform.tileZoom),C=new i.aM(P,r.wrap,H,r.canonical.x>>$,r.canonical.y>>$)):$!==0&&(P=H,C=new i.aM(P,r.wrap,H,r.canonical.x>>$,r.canonical.y>>$))}C.key!==r.key&&(z.push(C.key),p=l.getTile(C))}const j=H=>{z.forEach($=>{v[$]=H}),z.length=0};for(P-=1;P>=L&&(!p||!p.hasData());P--){p&&j(p.tileID.key);const H=C.calculateScaledKey(P);if(p=l.getTileByID(H),p&&p.hasData())break;const $=v[H];if($===null)break;$===void 0?z.push(H):p=l.getTileByID($)}return j(p?p.tileID.key:null),p&&p.hasData()?p:null}findDEMTileFor(r){return this.enabled?this._findTileCoveringTileID(r,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(r,l){let p=this._tilesDirty[r];p||(p=this._tilesDirty[r]={}),p[l.key]=!0}}function $d(f,r,l){const p=function(P,L,z){const j=i.bE(L,P),H=i.bE(z,[.2126,.7152,.0722]),$=(re,te,oe)=>(1-oe)*re+oe*te,q=$(1-.3*Math.min(H,1),1,Math.min(j+1,1));return $(.92,1,Math.asin(i.aD(L[2],-1,1))/Math.PI+.5)*q}(f,[0,0,1],r),v=[0,0,0];i.b$(v,l.slice(0,3),p);const w=[0,0,0];i.b$(w,r.slice(0,3),f[2]);const C=[0,0,0];return i.cU(C,v,w),i.cX(C)}const Xh=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],Wf=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","elevatedStructures","model","symbol"];class Hu{static cacheKey(r,l,p,v){let w=`${l}${v?v.cacheKey:""}`;for(const C of p)r.usedDefines.includes(C)&&(w+=`/${C}`);return w}constructor(r,l,p,v,w,C){const P=r.gl;this.program=P.createProgram(),this.configuration=v,this.name=l,this.fixedDefines=[...C];const L=v?v.getBinderAttributes():[],z=(p.staticAttributes||[]).concat(L);let j=v?v.defines():[];j=j.concat(C.map(oe=>`#define ${oe}`));const H=`#version 300 es
`;let $=H+j.concat("precision mediump float;",Od,dc.fragmentSource).join(`
`);for(const oe of p.fragmentIncludes)$+=`
${ca[oe]}`;$+=`
${p.fragmentSource}`;let q=H+j.concat("precision highp float;",Od,dc.vertexSource).join(`
`);for(const oe of p.vertexIncludes)q+=`
${ca[oe]}`;this.forceManualRenderingForInstanceIDShaders=r.forceManualRenderingForInstanceIDShaders&&p.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(q+=`
uniform int u_instanceID;
`),q+=`
${p.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(q=q.replaceAll("gl_InstanceID","u_instanceID"));const re=P.createShader(P.FRAGMENT_SHADER);if(P.isContextLost())return void(this.failedToCreate=!0);P.shaderSource(re,$),P.compileShader(re),P.attachShader(this.program,re);const te=P.createShader(P.VERTEX_SHADER);if(P.isContextLost())this.failedToCreate=!0;else{P.shaderSource(te,q),P.compileShader(te),P.attachShader(this.program,te),this.attributes={},this.numAttributes=z.length;for(let oe=0;oe<this.numAttributes;oe++)if(z[oe]){const ne=z[oe].startsWith("a_")?z[oe]:`a_${z[oe]}`;P.bindAttribLocation(this.program,oe,ne),this.attributes[ne]=oe}P.linkProgram(this.program),P.deleteShader(te),P.deleteShader(re),this.fixedUniforms=w(r),this.binderUniforms=v?v.getUniforms(r):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(oe=>({u_instanceID:new i.cc(oe)}))(r)),(C.includes("TERRAIN")||l.indexOf("symbol")!==-1||l.indexOf("circle")!==-1)&&(this.terrainUniforms=(oe=>({u_dem:new i.cc(oe),u_dem_prev:new i.cc(oe),u_dem_tl:new i.c9(oe),u_dem_scale:new i.cb(oe),u_dem_tl_prev:new i.c9(oe),u_dem_scale_prev:new i.cb(oe),u_dem_size:new i.cb(oe),u_dem_lerp:new i.cb(oe),u_exaggeration:new i.cb(oe),u_depth:new i.cc(oe),u_depth_size_inv:new i.c9(oe),u_depth_range_unpack:new i.c9(oe),u_occluder_half_size:new i.cb(oe),u_occlusion_depth_offset:new i.cb(oe),u_meter_to_dem:new i.cb(oe),u_label_plane_matrix_inv:new i.c8(oe)}))(r)),C.includes("GLOBE")&&(this.globeUniforms=(oe=>({u_tile_tl_up:new i.ca(oe),u_tile_tr_up:new i.ca(oe),u_tile_br_up:new i.ca(oe),u_tile_bl_up:new i.ca(oe),u_tile_up_scale:new i.cb(oe)}))(r)),C.includes("FOG")&&(this.fogUniforms=(oe=>({u_fog_matrix:new i.c8(oe),u_fog_range:new i.c9(oe),u_fog_color:new i.cQ(oe),u_fog_horizon_blend:new i.cb(oe),u_fog_vertical_limit:new i.c9(oe),u_fog_temporal_offset:new i.cb(oe),u_frustum_tl:new i.ca(oe),u_frustum_tr:new i.ca(oe),u_frustum_br:new i.ca(oe),u_frustum_bl:new i.ca(oe),u_globe_pos:new i.ca(oe),u_globe_radius:new i.cb(oe),u_globe_transition:new i.cb(oe),u_is_globe:new i.cc(oe),u_viewport:new i.c9(oe)}))(r)),C.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(oe=>({u_cutoff_params:new i.cQ(oe)}))(r)),C.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(oe=>({u_lighting_ambient_color:new i.ca(oe),u_lighting_directional_dir:new i.ca(oe),u_lighting_directional_color:new i.ca(oe),u_ground_radiance:new i.ca(oe)}))(r)),C.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(oe=>({u_light_matrix_0:new i.c8(oe),u_light_matrix_1:new i.c8(oe),u_fade_range:new i.c9(oe),u_shadow_normal_offset:new i.ca(oe),u_shadow_intensity:new i.cb(oe),u_shadow_texel_size:new i.cb(oe),u_shadow_map_resolution:new i.cb(oe),u_shadow_direction:new i.ca(oe),u_shadow_bias:new i.ca(oe),u_shadowmap_0:new i.cc(oe),u_shadowmap_1:new i.cc(oe)}))(r))}}setTerrainUniformValues(r,l){if(!this.terrainUniforms)return;const p=this.terrainUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const v in l)p[v]&&p[v].set(this.program,v,l[v])}}setGlobeUniformValues(r,l){if(!this.globeUniforms)return;const p=this.globeUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const v in l)p[v]&&p[v].set(this.program,v,l[v])}}setFogUniformValues(r,l){if(!this.fogUniforms)return;const p=this.fogUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const v in l)p[v].set(this.program,v,l[v])}}setCutoffUniformValues(r,l){if(!this.cutoffUniforms)return;const p=this.cutoffUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const v in l)p[v].set(this.program,v,l[v])}}setLightsUniformValues(r,l){if(!this.lightsUniforms)return;const p=this.lightsUniforms;if(!this.failedToCreate){r.program.set(this.program);for(const v in l)p[v].set(this.program,v,l[v])}}setShadowUniformValues(r,l){if(this.failedToCreate||!this.shadowUniforms)return;const p=this.shadowUniforms;r.program.set(this.program);for(const v in l)p[v].set(this.program,v,l[v])}_drawDebugWireframe(r,l,p,v,w,C,P,L,z,j){const H=r.options.wireframe;if(H.terrain===!1&&H.layers2D===!1&&H.layers3D===!1)return;const $=r.context;if(!(!(!H.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!H.layers2D||r._terrain&&r._terrain.renderingToTexture||!Xh.includes(this.name))||!(!H.layers3D||!Wf.includes(this.name))))return;const q=$.gl,re=r.wireframeDebugCache.getLinesFromTrianglesBuffer(r.frameCounter,w,$);if(!re)return;const te=[...this.fixedDefines];te.push("DEBUG_WIREFRAME");const oe=r.getOrCreateProgram(this.name,{config:this.configuration,defines:te});$.program.set(oe.program);const ne=(Te,ke,De)=>{if(ke[Te]&&De[Te])for(const Me in ke[Te])De[Te][Me]&&De[Te][Me].set(De.program,Me,ke[Te][Me].current)};z&&z.setUniforms(oe.program,$,oe.binderUniforms,P,{zoom:L}),ne("fixedUniforms",this,oe),ne("terrainUniforms",this,oe),ne("globeUniforms",this,oe),ne("fogUniforms",this,oe),ne("lightsUniforms",this,oe),ne("shadowUniforms",this,oe),re.bind(),$.setColorMode(new or([q.ONE,q.ONE_MINUS_SRC_ALPHA,q.ZERO,q.ONE],i.am.transparent,[!0,!0,!0,!1])),$.setDepthMode(new gn(l.func===q.LESS?q.LEQUAL:l.func,gn.ReadOnly,l.range)),$.setStencilMode(zn.disabled);const ye=3*C.primitiveLength*2,Se=3*C.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const Te=j||1;for(let ke=0;ke<Te;++ke)oe.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",ke),q.drawElements(q.LINES,ye,q.UNSIGNED_SHORT,Se)}else j&&j>1?q.drawElementsInstanced(q.LINES,ye,q.UNSIGNED_SHORT,Se,j):q.drawElements(q.LINES,ye,q.UNSIGNED_SHORT,Se);w.bind(),$.program.set(this.program),$.setDepthMode(l),$.setStencilMode(p),$.setColorMode(v)}checkUniforms(r,l,p){if(this.fixedDefines.includes(l)){for(const v of Object.keys(p))if(!p[v].initialized)throw new Error(`Program '${this.name}', from draw '${r}': uniform ${v} not set but required by ${l} being defined`)}}draw(r,l,p,v,w,C,P,L,z,j,H,$,q,re,te,oe){const ne=r.context,ye=ne.gl;if(this.failedToCreate)return;ne.program.set(this.program),ne.setDepthMode(p),ne.setStencilMode(v),ne.setColorMode(w),ne.setCullFace(C);for(const ke of Object.keys(this.fixedUniforms))this.fixedUniforms[ke].set(this.program,ke,P[ke]);re&&re.setUniforms(this.program,ne,this.binderUniforms,$,{zoom:q});const Se={[ye.POINTS]:1,[ye.LINES]:2,[ye.TRIANGLES]:3,[ye.LINE_STRIP]:1}[l];this.checkUniforms(L,"RENDER_SHADOWS",this.shadowUniforms);const Te=oe&&oe>0?1:void 0;for(const ke of H.get()){const De=ke.vaos||(ke.vaos={});if((De[L]||(De[L]=new $h)).bind(ne,this,z,re?re.getPaintVertexBuffers():[],j,ke.vertexOffset,te||[],Te),this.forceManualRenderingForInstanceIDShaders){const Me=oe||1;for(let Pe=0;Pe<Me;++Pe)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Pe),j?ye.drawElements(l,ke.primitiveLength*Se,ye.UNSIGNED_SHORT,ke.primitiveOffset*Se*2):ye.drawArrays(l,ke.vertexOffset,ke.vertexLength)}else oe&&oe>1?ye.drawElementsInstanced(l,ke.primitiveLength*Se,ye.UNSIGNED_SHORT,ke.primitiveOffset*Se*2,oe):j?ye.drawElements(l,ke.primitiveLength*Se,ye.UNSIGNED_SHORT,ke.primitiveOffset*Se*2):ye.drawArrays(l,ke.vertexOffset,ke.vertexLength);l===ye.TRIANGLES&&j&&this._drawDebugWireframe(r,p,v,w,j,ke,$,q,re,oe)}}}function Hd(f,r,l=0){const p=Math.pow(2,r.tileID.overscaledZ),v=r.tileSize*Math.pow(2,f.transform.tileZoom)/p,w=v*(r.tileID.canonical.x+r.tileID.wrap*p),C=v*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture?r.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/i.aw(r,1,f.transform.tileZoom),u_pixel_coord_upper:[w>>16,C>>16],u_pixel_coord_lower:[65535&w,65535&C],u_pattern_transition:l}}const ha={terrain:0,flat:1},Kh=i.bz(),yc=(f,r,l,p,v,w,C,P,L,z,j,H,$,q,re,te,oe,ne)=>{const ye=r.style.light,Se=ye.properties.get("position"),Te=[Se.x,Se.y,Se.z],ke=i.dx();ye.properties.get("anchor")==="viewport"&&(i.dy(ke,-r.transform.angle),i.dz(Te,Te,ke));const De=ye.properties.get("color"),Me=r.transform,Pe={u_matrix:f,u_lightpos:Te,u_lightintensity:ye.properties.get("intensity"),u_lightcolor:[De.r,De.g,De.b],u_vertical_gradient:+l,u_opacity:p,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Kh,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:ha[z],u_base_type:ha[j],u_ao:v,u_edge_radius:w,u_width_scale:C,u_flood_light_color:re,u_vertical_scale:te,u_flood_light_intensity:oe,u_ground_shadow_factor:ne};return Me.projection.name==="globe"&&(Pe.u_tile_id=[P.canonical.x,P.canonical.y,1<<P.canonical.z],Pe.u_zoom_transition=H,Pe.u_inv_rot_matrix=q,Pe.u_merc_center=$,Pe.u_up_dir=Me.projection.upVector(new i.cp(0,0,0),$[0]*i.aj,$[1]*i.aj),Pe.u_height_lift=L),Pe},Eg=(f,r,l,p,v,w)=>({u_matrix:f,u_edge_radius:r,u_width_scale:l,u_vertical_scale:p,u_height_type:ha[v],u_base_type:ha[w]}),ry=(f,r,l,p,v,w,C,P,L,z,j,H,$,q,re,te,oe,ne)=>{const ye=yc(f,r,l,p,v,w,C,P,z,j,H,$,q,re,te,oe,1,[0,0,0]),Se={u_height_factor:-Math.pow(2,P.overscaledZ)/L.tileSize/8};return i.l(ye,Hd(r,L,ne),Se)},vc=(f,r,l)=>({u_matrix:f,u_emissive_strength:r,u_ground_shadow_factor:l}),Gu=(f,r,l,p,v,w=0)=>i.l(vc(f,r,v),Hd(l,p,w)),Gd=(f,r,l,p)=>({u_matrix:f,u_world:l,u_emissive_strength:r,u_ground_shadow_factor:p}),qf=(f,r,l,p,v,w,C=0)=>i.l(Gu(f,r,l,p,w,C),{u_world:v}),Wd=(f,r)=>({u_matrix:f,u_ground_shadow_factor:r}),No=(f,r,l,p,v)=>({u_matrix:f,u_camera_pos:[r[0],r[1],r[2]],u_depth_bias:l,u_height_scale:p,u_reset_depth:v}),fa=(f,r,l,p)=>{const v=i.aj/l.tileSize;return{u_matrix:f,u_camera_to_center_distance:r.getCameraToCenterDistance(p),u_extrude_scale:[r.pixelsToGLUnits[0]/v,r.pixelsToGLUnits[1]/v]}},pa=(f,r,l=1)=>({u_matrix:f,u_color:r.toRenderColor(null),u_overlay:0,u_overlay_scale:l}),Ll=i.bz(),Dl=(f,r,l,p,v,w,C)=>{const P=f.transform,L=P.projection.name==="globe",z=L?i.dA(P.zoom,r.canonical)*P._pixelsPerMercatorPixel:i.aw(l,1,w),j={u_matrix:r.projMatrix,u_extrude_scale:z,u_intensity:C,u_inv_rot_matrix:Ll,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(L){j.u_inv_rot_matrix=p,j.u_merc_center=v,j.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],j.u_zoom_transition=i.ah(P.zoom);const H=v[0]*i.aj,$=v[1]*i.aj;j.u_up_dir=P.projection.upVector(new i.cp(0,0,0),H,$)}return j};function xc(f,[r,l,p,v],[w,C]){if(w===C)return[0,0,0,0];const P=255*(f-1)/(f*(C-w));return[r*P,l*P,p*P,v*P]}function Yh(f,r,[l,p]){return l===p?0:.5/f+(r-l)*(f-1)/(f*(p-l))}const kl=(f,r,l,p,v,w,C,P,L,z,j,H,$,q,re,te,oe,ne,ye,Se,Te)=>({u_matrix:f,u_normalize_matrix:r,u_globe_matrix:l,u_merc_matrix:p,u_grid_matrix:v,u_tl_parent:w,u_scale_parent:z,u_fade_t:j.mix,u_opacity:j.opacity*H.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:H.paint.get("raster-brightness-min"),u_brightness_high:H.paint.get("raster-brightness-max"),u_saturation_factor:i.dB(H.paint.get("raster-saturation")),u_contrast_factor:i.dC(H.paint.get("raster-contrast")),u_spin_weights:Zf(H.paint.get("raster-hue-rotate")),u_perspective_transform:$,u_raster_elevation:q,u_zoom_transition:C,u_merc_center:P,u_cutoff_params:L,u_colorization_mix:xc(i.dD,te,ne),u_colorization_offset:Yh(i.dD,oe,ne),u_color_ramp:re,u_texture_offset:[Se/(ye+2*Se),ye/(ye+2*Se)],u_texture_res:[ye+2*Se,ye+2*Se],u_emissive_strength:Te});function Zf(f){f*=Math.PI/180;const r=Math.sin(f),l=Math.cos(f);return[(2*l+1)/3,(-Math.sqrt(3)*r-l+1)/3,(Math.sqrt(3)*r-l+1)/3]}const Ss=.05,Xo=(f,r,l,p,v,w,C,P,L,z,j,H)=>({u_matrix:f,u_normalize_matrix:r,u_globe_matrix:l,u_merc_matrix:p,u_grid_matrix:v,u_tl_parent:w,u_scale_parent:z,u_fade_t:j.mix,u_opacity:j.opacity,u_image0:0,u_image1:1,u_raster_elevation:H,u_zoom_transition:C,u_merc_center:P,u_cutoff_params:L}),hs=(f,r,l,p,v,w,C,P,L,z)=>({u_particle_texture:f,u_particle_texture_side_len:r,u_tile_offset:l,u_velocity:p,u_color_ramp:w,u_velocity_res:v,u_max_speed:C,u_uv_offset:P,u_data_scale:[255*L[0],255*L[1]],u_data_offset:z,u_particle_pos_scale:1.1,u_particle_pos_offset:[Ss,Ss]}),Ma=(f,r,l,p,v,w,C,P,L,z)=>({u_particle_texture:f,u_particle_texture_side_len:r,u_velocity:l,u_velocity_res:p,u_max_speed:v,u_speed_factor:w,u_reset_rate:C,u_rand_seed:Math.random(),u_uv_offset:P,u_data_scale:[255*L[0],255*L[1]],u_data_offset:z,u_particle_pos_scale:1.1,u_particle_pos_offset:[Ss,Ss]}),Xf=i.bz(),Jh=(f,r,l,p,v,w,C,P,L,z,j,H,$,q,re,te,oe,ne,ye,Se,Te,ke,De)=>{const Me=v.transform,Pe={u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:Me.getCameraToCenterDistance(ye),u_rotate_symbol:+l,u_aspect_ratio:Me.width/Me.height,u_fade_change:v.options.fadeDuration?v.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:C,u_coord_matrix:P,u_is_text:+z,u_elevation_from_sea:L?1:0,u_pitch_with_map:+p,u_texsize:j,u_texsize_icon:H,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Xf,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Xf,u_up_vector:[0,-1,0],u_color_adj_mat:Te,u_icon_transition:ke||0,u_gamma_scale:p?v.transform.getCameraToCenterDistance(ye)*Math.cos(v.terrain?0:v.transform._pitch):1,u_device_pixel_ratio:i.q.devicePixelRatio,u_is_halo:1,u_scale_factor:De||1,u_ground_shadow_factor:Se,u_inv_matrix:i.bi(i.bz(),C)};return ye.name==="globe"&&(Pe.u_tile_id=[q.canonical.x,q.canonical.y,1<<q.canonical.z],Pe.u_zoom_transition=re,Pe.u_inv_rot_matrix=oe,Pe.u_merc_center=te,Pe.u_camera_forward=Me._camera.forward(),Pe.u_ecef_origin=i.dE(Me.globeMatrix,q.toUnwrapped()),Pe.u_tile_matrix=Float32Array.from(Me.globeMatrix),Pe.u_up_vector=ne),Pe},qd=(f,r,l,p)=>({u_matrix:f,u_emissive_strength:r,u_opacity:l,u_color:p}),Kf=(f,r,l,p,v,w,C,P,L)=>i.l(function(z,j,H,$,q,re){const{width:te,height:oe}=$.imageManager.getPixelSize(j),ne=Math.pow(2,re.tileID.overscaledZ),ye=re.tileSize*Math.pow(2,$.transform.tileZoom)/ne,Se=ye*(re.tileID.canonical.x+re.tileID.wrap*ne),Te=ye*re.tileID.canonical.y;return{u_image:0,u_pattern_tl:H.tl,u_pattern_br:H.br,u_texsize:[te,oe],u_pattern_size:H.displaySize,u_pattern_units_to_pixels:q?[$.transform.width,-1*$.transform.height]:[1/i.aw(re,1,$.transform.tileZoom),1/i.aw(re,1,$.transform.tileZoom)],u_pixel_coord_upper:[Se>>16,Te>>16],u_pixel_coord_lower:[65535&Se,65535&Te]}}(0,w,C,p,P,L),{u_matrix:f,u_emissive_strength:r,u_opacity:l}),Qh=new Float32Array(i.bx([])),Ol=(f,r,l,p,v,w,C,P,L,z,j,H,$,q=[0,0,0],re)=>{const te=v.style.light,oe=te.properties.get("position"),ne=[-oe.x,-oe.y,oe.z],ye=i.dx();te.properties.get("anchor")==="viewport"&&(i.dy(ye,-v.transform.angle),i.dz(ne,ne,ye));const Se=j.alphaMode==="MASK",Te=te.properties.get("color").toRenderColor(null),ke=$.paint.get("model-ambient-occlusion-intensity"),De=$.paint.get("model-color").constantOr(i.am.white).toRenderColor(null),Me=$.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:f,u_lighting_matrix:r,u_normal_matrix:l,u_node_matrix:p||Qh,u_lightpos:ne,u_lightintensity:te.properties.get("intensity"),u_lightcolor:[Te.r,Te.g,Te.b],u_camera_pos:q,u_opacity:w,u_baseTextureIsAlpha:0,u_alphaMask:+Se,u_alphaCutoff:j.alphaCutoff,u_baseColorFactor:[C.r,C.g,C.b,C.a],u_emissiveFactor:[P[0],P[1],P[2],1],u_metallicFactor:L,u_roughnessFactor:z,u_baseColorTexture:Fo.BaseColor,u_metallicRoughnessTexture:Fo.MetallicRoughness,u_normalTexture:Fo.Normal,u_occlusionTexture:Fo.Occlusion,u_emissionTexture:Fo.Emission,u_lutTexture:Fo.LUT,u_color_mix:[De.r,De.g,De.b,Me],u_aoIntensity:ke,u_emissive_strength:H,u_occlusionTextureTransform:re||[0,0,0,0]}},_m=(f,r=Qh,l=Qh)=>({u_matrix:f,u_instance:r,u_node_matrix:l}),Zd={fillExtrusion:f=>({u_matrix:new i.c8(f),u_lightpos:new i.ca(f),u_lightintensity:new i.cb(f),u_lightcolor:new i.ca(f),u_vertical_gradient:new i.cb(f),u_opacity:new i.cb(f),u_edge_radius:new i.cb(f),u_width_scale:new i.cb(f),u_ao:new i.c9(f),u_height_type:new i.cc(f),u_base_type:new i.cc(f),u_tile_id:new i.ca(f),u_zoom_transition:new i.cb(f),u_inv_rot_matrix:new i.c8(f),u_merc_center:new i.c9(f),u_up_dir:new i.ca(f),u_height_lift:new i.cb(f),u_flood_light_color:new i.ca(f),u_vertical_scale:new i.cb(f),u_flood_light_intensity:new i.cb(f),u_ground_shadow_factor:new i.ca(f)}),fillExtrusionDepth:f=>({u_matrix:new i.c8(f),u_edge_radius:new i.cb(f),u_width_scale:new i.cb(f),u_vertical_scale:new i.cb(f),u_height_type:new i.cc(f),u_base_type:new i.cc(f)}),fillExtrusionPattern:f=>({u_matrix:new i.c8(f),u_lightpos:new i.ca(f),u_lightintensity:new i.cb(f),u_lightcolor:new i.ca(f),u_vertical_gradient:new i.cb(f),u_height_factor:new i.cb(f),u_edge_radius:new i.cb(f),u_width_scale:new i.cb(f),u_ao:new i.c9(f),u_height_type:new i.cc(f),u_base_type:new i.cc(f),u_tile_id:new i.ca(f),u_zoom_transition:new i.cb(f),u_inv_rot_matrix:new i.c8(f),u_merc_center:new i.c9(f),u_up_dir:new i.ca(f),u_height_lift:new i.cb(f),u_image:new i.cc(f),u_texsize:new i.c9(f),u_pixel_coord_upper:new i.c9(f),u_pixel_coord_lower:new i.c9(f),u_tile_units_to_pixels:new i.cb(f),u_opacity:new i.cb(f),u_pattern_transition:new i.cb(f)}),fillExtrusionGroundEffect:f=>({u_matrix:new i.c8(f),u_opacity:new i.cb(f),u_ao_pass:new i.cb(f),u_meter_to_tile:new i.cb(f),u_ao:new i.c9(f),u_flood_light_intensity:new i.cb(f),u_flood_light_color:new i.ca(f),u_attenuation:new i.cb(f),u_edge_radius:new i.cb(f),u_fb:new i.cc(f),u_fb_size:new i.cb(f),u_dynamic_offset:new i.cb(f)}),fill:f=>({u_matrix:new i.c8(f),u_emissive_strength:new i.cb(f),u_ground_shadow_factor:new i.ca(f)}),fillPattern:f=>({u_matrix:new i.c8(f),u_emissive_strength:new i.cb(f),u_image:new i.cc(f),u_texsize:new i.c9(f),u_pixel_coord_upper:new i.c9(f),u_pixel_coord_lower:new i.c9(f),u_tile_units_to_pixels:new i.cb(f),u_ground_shadow_factor:new i.ca(f),u_pattern_transition:new i.cb(f)}),fillOutline:f=>({u_matrix:new i.c8(f),u_emissive_strength:new i.cb(f),u_world:new i.c9(f),u_ground_shadow_factor:new i.ca(f)}),fillOutlinePattern:f=>({u_matrix:new i.c8(f),u_emissive_strength:new i.cb(f),u_world:new i.c9(f),u_image:new i.cc(f),u_texsize:new i.c9(f),u_pixel_coord_upper:new i.c9(f),u_pixel_coord_lower:new i.c9(f),u_tile_units_to_pixels:new i.cb(f),u_ground_shadow_factor:new i.ca(f),u_pattern_transition:new i.cb(f)}),building:f=>({u_matrix:new i.c8(f),u_normal_matrix:new i.c8(f),u_opacity:new i.cb(f)}),buildingDepth:f=>({u_matrix:new i.c8(f)}),elevatedStructuresDepth:f=>({u_matrix:new i.c8(f),u_depth_bias:new i.cb(f)}),elevatedStructures:f=>({u_matrix:new i.c8(f),u_ground_shadow_factor:new i.ca(f)}),elevatedStructuresDepthReconstruct:f=>({u_matrix:new i.c8(f),u_camera_pos:new i.ca(f),u_depth_bias:new i.cb(f),u_height_scale:new i.cb(f),u_reset_depth:new i.cb(f)}),circle:i.dF,collisionBox:f=>({u_matrix:new i.c8(f),u_camera_to_center_distance:new i.cb(f),u_extrude_scale:new i.c9(f)}),collisionCircle:f=>({u_matrix:new i.c8(f),u_inv_matrix:new i.c8(f),u_camera_to_center_distance:new i.cb(f),u_viewport_size:new i.c9(f)}),debug:f=>({u_color:new i.di(f),u_matrix:new i.c8(f),u_overlay:new i.cc(f),u_overlay_scale:new i.cb(f)}),clippingMask:f=>({u_matrix:new i.c8(f)}),heatmap:f=>({u_extrude_scale:new i.cb(f),u_intensity:new i.cb(f),u_matrix:new i.c8(f),u_inv_rot_matrix:new i.c8(f),u_merc_center:new i.c9(f),u_tile_id:new i.ca(f),u_zoom_transition:new i.cb(f),u_up_dir:new i.ca(f)}),heatmapTexture:f=>({u_image:new i.cc(f),u_color_ramp:new i.cc(f),u_opacity:new i.cb(f)}),hillshade:f=>({u_matrix:new i.c8(f),u_image:new i.cc(f),u_latrange:new i.c9(f),u_light:new i.c9(f),u_shadow:new i.di(f),u_highlight:new i.di(f),u_emissive_strength:new i.cb(f),u_accent:new i.di(f)}),hillshadePrepare:f=>({u_matrix:new i.c8(f),u_image:new i.cc(f),u_dimension:new i.c9(f),u_zoom:new i.cb(f)}),line:i.dG,linePattern:i.dH,raster:f=>({u_matrix:new i.c8(f),u_normalize_matrix:new i.c8(f),u_globe_matrix:new i.c8(f),u_merc_matrix:new i.c8(f),u_grid_matrix:new i.dj(f),u_tl_parent:new i.c9(f),u_scale_parent:new i.cb(f),u_fade_t:new i.cb(f),u_opacity:new i.cb(f),u_image0:new i.cc(f),u_image1:new i.cc(f),u_brightness_low:new i.cb(f),u_brightness_high:new i.cb(f),u_saturation_factor:new i.cb(f),u_contrast_factor:new i.cb(f),u_spin_weights:new i.ca(f),u_perspective_transform:new i.c9(f),u_raster_elevation:new i.cb(f),u_zoom_transition:new i.cb(f),u_merc_center:new i.c9(f),u_cutoff_params:new i.cQ(f),u_colorization_mix:new i.cQ(f),u_colorization_offset:new i.cb(f),u_color_ramp:new i.cc(f),u_texture_offset:new i.c9(f),u_texture_res:new i.c9(f),u_emissive_strength:new i.cb(f)}),rasterParticle:f=>({u_matrix:new i.c8(f),u_normalize_matrix:new i.c8(f),u_globe_matrix:new i.c8(f),u_merc_matrix:new i.c8(f),u_grid_matrix:new i.dj(f),u_tl_parent:new i.c9(f),u_scale_parent:new i.cb(f),u_fade_t:new i.cb(f),u_opacity:new i.cb(f),u_image0:new i.cc(f),u_image1:new i.cc(f),u_raster_elevation:new i.cb(f),u_zoom_transition:new i.cb(f),u_merc_center:new i.c9(f),u_cutoff_params:new i.cQ(f)}),rasterParticleTexture:f=>({u_texture:new i.cc(f),u_opacity:new i.cb(f)}),rasterParticleDraw:f=>({u_particle_texture:new i.cc(f),u_particle_texture_side_len:new i.cb(f),u_tile_offset:new i.c9(f),u_velocity:new i.cc(f),u_color_ramp:new i.cc(f),u_velocity_res:new i.c9(f),u_max_speed:new i.cb(f),u_uv_offset:new i.c9(f),u_data_scale:new i.c9(f),u_data_offset:new i.cb(f),u_particle_pos_scale:new i.cb(f),u_particle_pos_offset:new i.c9(f)}),rasterParticleUpdate:f=>({u_particle_texture:new i.cc(f),u_particle_texture_side_len:new i.cb(f),u_velocity:new i.cc(f),u_velocity_res:new i.c9(f),u_max_speed:new i.cb(f),u_speed_factor:new i.cb(f),u_reset_rate:new i.cb(f),u_rand_seed:new i.cb(f),u_uv_offset:new i.c9(f),u_data_scale:new i.c9(f),u_data_offset:new i.cb(f),u_particle_pos_scale:new i.cb(f),u_particle_pos_offset:new i.c9(f)}),symbol:f=>({u_is_size_zoom_constant:new i.cc(f),u_is_size_feature_constant:new i.cc(f),u_size_t:new i.cb(f),u_size:new i.cb(f),u_camera_to_center_distance:new i.cb(f),u_rotate_symbol:new i.cc(f),u_aspect_ratio:new i.cb(f),u_fade_change:new i.cb(f),u_matrix:new i.c8(f),u_label_plane_matrix:new i.c8(f),u_coord_matrix:new i.c8(f),u_is_text:new i.cc(f),u_elevation_from_sea:new i.cc(f),u_pitch_with_map:new i.cc(f),u_texsize:new i.c9(f),u_texsize_icon:new i.c9(f),u_texture:new i.cc(f),u_texture_icon:new i.cc(f),u_gamma_scale:new i.cb(f),u_device_pixel_ratio:new i.cb(f),u_tile_id:new i.ca(f),u_zoom_transition:new i.cb(f),u_inv_rot_matrix:new i.c8(f),u_merc_center:new i.c9(f),u_camera_forward:new i.ca(f),u_tile_matrix:new i.c8(f),u_up_vector:new i.ca(f),u_ecef_origin:new i.ca(f),u_is_halo:new i.cc(f),u_icon_transition:new i.cb(f),u_color_adj_mat:new i.c8(f),u_scale_factor:new i.cb(f),u_ground_shadow_factor:new i.ca(f),u_inv_matrix:new i.c8(f)}),background:f=>({u_matrix:new i.c8(f),u_emissive_strength:new i.cb(f),u_opacity:new i.cb(f),u_color:new i.di(f)}),backgroundPattern:f=>({u_matrix:new i.c8(f),u_emissive_strength:new i.cb(f),u_opacity:new i.cb(f),u_image:new i.cc(f),u_pattern_tl:new i.c9(f),u_pattern_br:new i.c9(f),u_texsize:new i.c9(f),u_pattern_size:new i.c9(f),u_pixel_coord_upper:new i.c9(f),u_pixel_coord_lower:new i.c9(f),u_pattern_units_to_pixels:new i.c9(f)}),terrainRaster:f=>({u_matrix:new i.c8(f),u_image0:new i.cc(f),u_skirt_height:new i.cb(f),u_ground_shadow_factor:new i.ca(f)}),skybox:f=>({u_matrix:new i.c8(f),u_sun_direction:new i.ca(f),u_cubemap:new i.cc(f),u_opacity:new i.cb(f),u_temporal_offset:new i.cb(f)}),skyboxGradient:f=>({u_matrix:new i.c8(f),u_color_ramp:new i.cc(f),u_center_direction:new i.ca(f),u_radius:new i.cb(f),u_opacity:new i.cb(f),u_temporal_offset:new i.cb(f)}),skyboxCapture:f=>({u_matrix_3f:new i.dj(f),u_sun_direction:new i.ca(f),u_sun_intensity:new i.cb(f),u_color_tint_r:new i.cQ(f),u_color_tint_m:new i.cQ(f),u_luminance:new i.cb(f)}),globeRaster:f=>({u_proj_matrix:new i.c8(f),u_globe_matrix:new i.c8(f),u_normalize_matrix:new i.c8(f),u_merc_matrix:new i.c8(f),u_zoom_transition:new i.cb(f),u_merc_center:new i.c9(f),u_image0:new i.cc(f),u_grid_matrix:new i.dj(f),u_skirt_height:new i.cb(f),u_far_z_cutoff:new i.cb(f),u_frustum_tl:new i.ca(f),u_frustum_tr:new i.ca(f),u_frustum_br:new i.ca(f),u_frustum_bl:new i.ca(f),u_globe_pos:new i.ca(f),u_globe_radius:new i.cb(f),u_viewport:new i.c9(f)}),globeAtmosphere:f=>({u_frustum_tl:new i.ca(f),u_frustum_tr:new i.ca(f),u_frustum_br:new i.ca(f),u_frustum_bl:new i.ca(f),u_horizon:new i.cb(f),u_transition:new i.cb(f),u_fadeout_range:new i.cb(f),u_color:new i.cQ(f),u_high_color:new i.cQ(f),u_space_color:new i.cQ(f),u_temporal_offset:new i.cb(f),u_horizon_angle:new i.cb(f)}),model:f=>({u_matrix:new i.c8(f),u_lighting_matrix:new i.c8(f),u_normal_matrix:new i.c8(f),u_node_matrix:new i.c8(f),u_lightpos:new i.ca(f),u_lightintensity:new i.cb(f),u_lightcolor:new i.ca(f),u_camera_pos:new i.ca(f),u_opacity:new i.cb(f),u_baseColorFactor:new i.cQ(f),u_emissiveFactor:new i.cQ(f),u_metallicFactor:new i.cb(f),u_roughnessFactor:new i.cb(f),u_baseTextureIsAlpha:new i.cc(f),u_alphaMask:new i.cc(f),u_alphaCutoff:new i.cb(f),u_baseColorTexture:new i.cc(f),u_metallicRoughnessTexture:new i.cc(f),u_normalTexture:new i.cc(f),u_occlusionTexture:new i.cc(f),u_emissionTexture:new i.cc(f),u_lutTexture:new i.cc(f),u_color_mix:new i.cQ(f),u_aoIntensity:new i.cb(f),u_emissive_strength:new i.cb(f),u_occlusionTextureTransform:new i.cQ(f)}),modelDepth:f=>({u_matrix:new i.c8(f),u_instance:new i.c8(f),u_node_matrix:new i.c8(f)}),groundShadow:f=>({u_matrix:new i.c8(f),u_ground_shadow_factor:new i.ca(f)}),stars:f=>({u_matrix:new i.c8(f),u_up:new i.ca(f),u_right:new i.ca(f),u_intensity_multiplier:new i.cb(f)}),snowParticle:f=>({u_modelview:new i.c8(f),u_projection:new i.c8(f),u_time:new i.cb(f),u_cam_pos:new i.ca(f),u_velocityConeAperture:new i.cb(f),u_velocity:new i.cb(f),u_horizontalOscillationRadius:new i.cb(f),u_horizontalOscillationRate:new i.cb(f),u_boxSize:new i.cb(f),u_billboardSize:new i.cb(f),u_simpleShapeParameters:new i.c9(f),u_screenSize:new i.c9(f),u_thinningCenterPos:new i.c9(f),u_thinningShape:new i.ca(f),u_thinningAffectedRatio:new i.cb(f),u_thinningParticleOffset:new i.cb(f),u_particleColor:new i.cQ(f),u_direction:new i.ca(f)}),rainParticle:f=>({u_modelview:new i.c8(f),u_projection:new i.c8(f),u_time:new i.cb(f),u_cam_pos:new i.ca(f),u_texScreen:new i.cc(f),u_velocityConeAperture:new i.cb(f),u_velocity:new i.cb(f),u_boxSize:new i.cb(f),u_rainDropletSize:new i.c9(f),u_distortionStrength:new i.cb(f),u_rainDirection:new i.ca(f),u_color:new i.cQ(f),u_screenSize:new i.c9(f),u_thinningCenterPos:new i.c9(f),u_thinningShape:new i.ca(f),u_thinningAffectedRatio:new i.cb(f),u_thinningParticleOffset:new i.cb(f),u_shapeDirectionalPower:new i.cb(f),u_shapeNormalPower:new i.cb(f),u_mode:new i.cb(f)}),vignette:f=>({u_vignetteShape:new i.ca(f),u_vignetteColor:new i.cQ(f)}),occlusion:f=>({u_matrix:new i.c8(f),u_anchorPos:new i.ca(f),u_screenSizePx:new i.c9(f),u_occluderSizePx:new i.c9(f),u_color:new i.cQ(f)})};class nl{constructor(r,l,p,v){this.id=nl.uniqueIdxCounter,nl.uniqueIdxCounter++,this.context=r;const w=r.gl;this.buffer=w.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),w.bufferData(w.ELEMENT_ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||v||l.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){this.id=nl.uniqueIdxCounter,nl.uniqueIdxCounter++;const l=this.context.gl;this.context.unbindVAO(),this.bind(),l.bufferSubData(l.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}nl.uniqueIdxCounter=0;const iy={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Wu{constructor(r,l,p,v,w,C){this.length=l.length,this.attributes=p,this.itemSize=l.bytesPerElement,this.dynamicDraw=v,this.instanceCount=C,this.context=r;const P=r.gl;this.buffer=P.createBuffer(),r.bindVertexBuffer.set(this.buffer),P.bufferData(P.ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?P.DYNAMIC_DRAW:P.STATIC_DRAW),this.dynamicDraw||w||l.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){const l=this.context.gl;this.bind(),l.bufferSubData(l.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,l){for(let p=0;p<this.attributes.length;p++){const v=l.attributes[this.attributes[p].name];v!==void 0&&r.enableVertexAttribArray(v)}}setVertexAttribPointers(r,l,p){for(let v=0;v<this.attributes.length;v++){const w=this.attributes[v],C=l.attributes[w.name];C!==void 0&&r.vertexAttribPointer(C,w.components,r[iy[w.type]],!1,this.itemSize,w.offset+this.itemSize*(p||0))}}setVertexAttribDivisor(r,l,p){for(let v=0;v<this.attributes.length;v++){const w=l.attributes[this.attributes[v].name];w!==void 0&&this.instanceCount&&this.instanceCount>0&&r.vertexAttribDivisor(w,p)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class qu{constructor(r,l,p,v,w){this.context=r,this.width=l,this.height=p;const C=this.framebuffer=r.gl.createFramebuffer();v&&(this.colorAttachment=new ny(r,C)),w&&(this.depthAttachmentType=w,this.depthAttachment=w==="renderbuffer"?new Gf(r,C):new gc(r,C))}destroy(){const r=this.context.gl;if(this.colorAttachment){const l=this.colorAttachment.get();l&&r.deleteTexture(l)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const l=this.depthAttachment.get();l&&r.deleteRenderbuffer(l)}else{const l=this.depthAttachment.get();l&&r.deleteTexture(l)}r.deleteFramebuffer(this.framebuffer)}}class Zu{constructor(r,l){this.gl=r,this.clearColor=new Tg(this),this.clearDepth=new ws(this),this.clearStencil=new cm(this),this.colorMask=new Hh(this),this.depthMask=new Gh(this),this.stencilMask=new Wh(this),this.stencilFunc=new um(this),this.stencilOp=new zd(this),this.stencilTest=new Fd(this),this.depthRange=new hc(this),this.depthTest=new $f(this),this.depthFunc=new Bu(this),this.blend=new dm(this),this.blendFunc=new hm(this),this.blendColor=new fc(this),this.blendEquation=new Kc(this),this.cullFace=new Nd(this),this.cullFaceSide=new jd(this),this.frontFace=new Yc(this),this.program=new Bd(this),this.activeTexture=new fm(this),this.viewport=new pm(this),this.bindFramebuffer=new mm(this),this.bindRenderbuffer=new Hf(this),this.bindTexture=new Vu(this),this.bindVertexBuffer=new pc(this),this.bindElementBuffer=new gm(this),this.bindVertexArrayOES=new Uu(this),this.pixelStoreUnpack=new Zo(this),this.pixelStoreUnpackPremultiplyAlpha=new Vd(this),this.pixelStoreUnpackFlipY=new mc(this),this.options=l?Object.assign({},l):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=r.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=r.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=r.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=l&&!!l.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=r.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),this.maxPointSize=r.getParameter(r.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,l,p){return new nl(this,r,l,p)}createVertexBuffer(r,l,p,v,w){return new Wu(this,r,l,p,v,w)}createRenderbuffer(r,l,p){const v=this.gl,w=v.createRenderbuffer();return this.bindRenderbuffer.set(w),v.renderbufferStorage(v.RENDERBUFFER,r,l,p),this.bindRenderbuffer.set(null),w}createFramebuffer(r,l,p,v){return new qu(this,r,l,p,v)}clear({color:r,depth:l,stencil:p,colorMask:v}){const w=this.gl;let C=0;r&&(C|=w.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set(v||[!0,!0,!0,!0])),l!==void 0&&(C|=w.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(l),this.depthMask.set(!0)),p!==void 0&&(C|=w.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),w.clear(C)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){i.bv(r.blendFunction,or.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor),r.blendEquation?this.blendEquation.set(r.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(r.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let Qc;function rl(f,r,l,p,v,w,C){const P=f.context,L=P.gl,z=f.transform,j=f.getOrCreateProgram("collisionBox"),H=[];let $=0,q=0;for(let Te=0;Te<p.length;Te++){const ke=p[Te],De=r.getTile(ke),Me=De.getBucket(l);if(!Me)continue;const Pe=Pd(ke,Me,z);let Oe=Pe;v[0]===0&&v[1]===0||(Oe=f.translatePosMatrix(Pe,De,v,w));const Ne=C?Me.textCollisionBox:Me.iconCollisionBox,ht=Me.collisionCircleArray;if(ht.length>0){const rt=i.bz(),Tt=Oe;i.cB(rt,Me.placementInvProjMatrix,z.glCoordMatrix),i.cB(rt,rt,Me.placementViewportMatrix),H.push({circleArray:ht,circleOffset:q,transform:Tt,invTransform:rt,projection:Me.getProjection()}),$+=ht.length/4,q=$}Ne&&(f.terrain&&f.terrain.setupElevationDraw(De,j),j.draw(f,L.LINES,gn.disabled,zn.disabled,f.colorModeForRenderPass(),Bn.disabled,fa(Oe,z,De,Me.getProjection()),l.id,Ne.layoutVertexBuffer,Ne.indexBuffer,Ne.segments,null,z.zoom,null,[Ne.collisionVertexBuffer,Ne.collisionVertexBufferExt]))}if(!C||!H.length)return;const re=f.getOrCreateProgram("collisionCircle"),te=new i.dI;te.resize(4*$),te._trim();let oe=0;for(const Te of H)for(let ke=0;ke<Te.circleArray.length/4;ke++){const De=4*ke,Me=Te.circleArray[De+0],Pe=Te.circleArray[De+1],Oe=Te.circleArray[De+2],Ne=Te.circleArray[De+3];te.emplace(oe++,Me,Pe,Oe,Ne,0),te.emplace(oe++,Me,Pe,Oe,Ne,1),te.emplace(oe++,Me,Pe,Oe,Ne,2),te.emplace(oe++,Me,Pe,Oe,Ne,3)}(!Qc||Qc.length<2*$)&&(Qc=function(Te){const ke=2*Te,De=new i.a_;De.resize(ke),De._trim();for(let Me=0;Me<ke;Me++){const Pe=6*Me;De.uint16[Pe+0]=4*Me+0,De.uint16[Pe+1]=4*Me+1,De.uint16[Pe+2]=4*Me+2,De.uint16[Pe+3]=4*Me+2,De.uint16[Pe+4]=4*Me+3,De.uint16[Pe+5]=4*Me+0}return De}($));const ne=P.createIndexBuffer(Qc,!0),ye=P.createVertexBuffer(te,i.dJ.members,!0);for(const Te of H){const ke={u_matrix:Te.transform,u_inv_matrix:Te.invTransform,u_camera_to_center_distance:(Se=z).getCameraToCenterDistance(Te.projection),u_viewport_size:[Se.width,Se.height]};re.draw(f,L.TRIANGLES,gn.disabled,zn.disabled,f.colorModeForRenderPass(),Bn.disabled,ke,l.id,ye,ne,i.bd.simpleSegment(0,2*Te.circleOffset,Te.circleArray.length,Te.circleArray.length/2),null,z.zoom)}var Se;ye.destroy(),ne.destroy()}const Xd=i.bz();function eu(f){const r=f._camera.getWorldToCamera(f.worldSize,1),l=i.az([],r,f.globeMatrix);i.bi(l,l);const p=[0,0,0],v=[0,1,0,0];return i.aA(v,v,l),p[0]=v[0],p[1]=v[1],p[2]=v[2],i.au(p,p),p}function Xu({width:f,height:r,anchor:l,textOffset:p,textScale:v},w){const{horizontalAlign:C,verticalAlign:P}=i.bV(l),L=-(C-.5)*f,z=-(P-.5)*r,j=i.bU(l,p);return new i.P((L/v+j[0])*w,(z/v+j[1])*w)}function tu(f,r,l,p,v,w,C,P,L,z){const j=f.text.placedSymbolArray,H=f.text.dynamicLayoutVertexArray,$=f.icon.dynamicLayoutVertexArray,q={},re=f.getProjection(),te=Du(C,re,v),oe=v.elevation,ne=re.upVectorScale(C.canonical,v.center.lat,v.worldSize).metersToTile;H.clear();for(let ye=0;ye<j.length;ye++){const Se=j.get(ye),{tileAnchorX:Te,tileAnchorY:ke,numGlyphs:De}=Se,Me=Se.hidden||!Se.crossTileID||f.allowVerticalPlacement&&!Se.placedOrientation?null:p[Se.crossTileID];if(Me){let Pe=0,Oe=0,Ne=0;if(oe){const Dt=oe?oe.getAtTileOffset(C,Te,ke):0,[mt,Ot,Mt]=re.upVector(C.canonical,Te,ke);Pe=Dt*mt*ne,Oe=Dt*Ot*ne,Ne=Dt*Mt*ne}let[ht,rt,Tt,It]=bo(Se.projectedAnchorX+Pe,Se.projectedAnchorY+Oe,Se.projectedAnchorZ+Ne,l?te:w);const Ht=Tl(v.getCameraToCenterDistance(re),It);let Qe=i.bJ(f.textSizeData,L,Se)*Ht/i.bO;l&&(Qe*=f.tilePixelRatio/P);const dt=Xu(Me,Qe);l?({x:ht,y:rt,z:Tt}=re.projectTilePoint(Te+dt.x,ke+dt.y,C.canonical),[ht,rt,Tt]=bo(ht+Pe,rt+Oe,Tt+Ne,w)):(r&&dt._rotate(-v.angle),ht+=dt.x,rt+=dt.y,Tt=0);const Je=f.allowVerticalPlacement&&Se.placedOrientation===i.bI.vertical?Math.PI/2:0;for(let Dt=0;Dt<De;Dt++)i.bL(H,ht,rt,Tt,Je);z&&Se.associatedIconIndex>=0&&(q[Se.associatedIconIndex]={x:ht,y:rt,z:Tt,angle:Je})}else xr(De,H)}if(z){$.clear();const ye=f.icon.placedSymbolArray;for(let Se=0;Se<ye.length;Se++){const Te=ye.get(Se),{numGlyphs:ke}=Te,De=q[Se];if(Te.hidden||!De)xr(ke,$);else{const{x:Me,y:Pe,z:Oe,angle:Ne}=De;for(let ht=0;ht<ke;ht++)i.bL($,Me,Pe,Oe,Ne)}}f.icon.dynamicLayoutVertexBuffer.updateData($)}f.text.dynamicLayoutVertexBuffer.updateData(H)}function Kd(f,r,l,p,v,w,C={}){const P=l.paint.get("icon-translate"),L=l.paint.get("text-translate"),z=l.paint.get("icon-translate-anchor"),j=l.paint.get("text-translate-anchor"),H=l.layout.get("icon-rotation-alignment"),$=l.layout.get("text-rotation-alignment"),q=l.layout.get("icon-pitch-alignment"),re=l.layout.get("text-pitch-alignment"),te=l.layout.get("icon-keep-upright"),oe=l.layout.get("text-keep-upright"),ne=l.paint.get("icon-color-saturation"),ye=l.paint.get("icon-color-contrast"),Se=l.paint.get("icon-color-brightness-min"),Te=l.paint.get("icon-color-brightness-max"),ke=l.layout.get("symbol-elevation-reference")==="sea",De=f.context,Me=De.gl,Pe=f.transform,Oe=H==="map",Ne=$==="map",ht=q==="map",rt=re==="map",Tt=l.layout.get("symbol-sort-key").constantOr(1)!==void 0;let It=!1;const Ht=f.depthModeForSublayer(0,gn.ReadOnly),Qe=new gn(f.context.gl.LEQUAL,gn.ReadOnly,f.depthRangeFor3D),dt=[i.ay(Pe.center.lng),i.aH(Pe.center.lat)],Je=l.layout.get("text-variable-anchor"),Dt=Pe.projection.name==="globe",mt=[],Ot=[0,-1,0];for(const Mt of p){const Nt=r.getTile(Mt),Vt=Nt.getBucket(l);if(!Vt||Vt.projection.name==="mercator"&&Dt||Vt.fullyClipped)continue;const pn=Vt.projection.name==="globe",bn=pn?i.ah(Pe.zoom):0,rn=Du(Mt,Vt.getProjection(),Pe),vn=Pe.calculatePixelsToTileUnitsMatrix(Nt),dn=Je&&Vt.hasTextData(),Rn=Vt.hasIconTextFit()&&dn&&Vt.hasIconData(),Hn=Vt.elevationType==="road"?Qe:Ht,dr=Vt.getProjection().createInversionMatrix(Pe,Mt.canonical),ri=f.shadowRenderer,ii=Vt.elevationType==="road"&&!!ri&&ri.enabled;let tr=[0,0,0];if(ii){const Oi=f.style.directionalLight,nr=f.style.ambientLight;Oi&&nr&&(tr=Ia(f.style,Oi,nr))}const Hi=Oi=>{Pe.depthOcclusionForSymbolsAndCircles&&(l.hasInitialOcclusionOpacityProperties||f.terrain)&&(Oi.push("DEPTH_D24"),Oi.push("DEPTH_OCCLUSION"))},Pi=()=>{const Oi=Oe&&l.layout.get("symbol-placement")!=="point",nr=[];Hi(nr);const Si=Oi||Rn,zr=l.paint.get("icon-image-cross-fade");f.terrainRenderModeElevated()&&ht&&nr.push("PITCH_WITH_MAP_TERRAIN"),pn&&(nr.push("PROJECTION_GLOBE_VIEW"),Si&&nr.push("PROJECTED_POS_ON_VIEWPORT")),zr>0&&nr.push("ICON_TRANSITION"),Vt.icon.zOffsetVertexBuffer&&nr.push("Z_OFFSET"),ne===0&&ye===0&&Se===0&&Te===1||nr.push("COLOR_ADJUSTMENT"),Vt.sdfIcons&&nr.push("RENDER_SDF"),ii&&nr.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET");const ai=Vt.icon.programConfigurations.get(l.id),Xr=f.getOrCreateProgram("symbol",{config:ai,defines:nr}),hi=Nt.imageAtlasTexture?Nt.imageAtlasTexture.size:[0,0],Fs=Vt.iconSizeData,br=i.bH(Fs,Pe.zoom),Ks=ht||Pe.pitch!==0,ls=Sd(rn,Nt.tileID.canonical,ht,Oe,Pe,Vt.getProjection(),vn),oo=Dh(rn,Nt.tileID.canonical,ht,Oe,Pe,Vt.getProjection(),vn),ll=f.translatePosMatrix(oo,Nt,P,z,!0),Wl=f.translatePosMatrix(rn,Nt,P,z),Jo=Si?Xd:ls,Fa=Oe&&!ht&&!Oi;let Bs=Ot;!Dt&&!Pe.mercatorFromTransition||Oe||(Bs=eu(Pe));const Na=pn?Bs:Ot,cl=l.getColorAdjustmentMatrix(ne,ye,Se,Te),va=Jh(Fs.kind,br,Fa,ht,f,Wl,Jo,ll,ke,!1,hi,[0,0],!0,Mt,bn,dt,dr,Na,Vt.getProjection(),tr,cl,zr),ql=Nt.imageAtlasTexture?Nt.imageAtlasTexture:null,Zl=l.layout.get("icon-size").constantOr(0)!==1||Vt.iconsNeedLinear,sd=Vt.sdfIcons||f.options.rotating||f.options.zooming||Zl||Ks?Me.LINEAR:Me.NEAREST,ah=Vt.sdfIcons&&l.paint.get("icon-halo-width").constantOr(1)!==0,od=f.terrain&&ht&&Oi?i.bi(i.bz(),ls):Xd;if(Oi&&Vt.icon){const Ai=Pe.elevation,hu=Ai?Ai.getAtTileOffsetFunc(Mt,Pe.center.lat,Pe.worldSize,Vt.getProjection()):null,Rm=Ff(rn,Nt.tileID.canonical,ht,Oe,Pe,Vt.getProjection(),vn);El(Vt,rn,f,!1,Rm,oo,ht,te,hu,Mt)}return{program:Xr,buffers:Vt.icon,uniformValues:va,atlasTexture:ql,atlasTextureIcon:null,atlasInterpolation:sd,atlasInterpolationIcon:null,isSDF:Vt.sdfIcons,hasHalo:ah,depthMode:Hn,tile:Nt,renderWithShadows:ii,labelPlaneMatrixInv:od}},Gn=()=>{const Oi=Ne&&l.layout.get("symbol-placement")!=="point",nr=[],Si=Oi||Je||Rn;f.terrainRenderModeElevated()&&rt&&nr.push("PITCH_WITH_MAP_TERRAIN"),pn&&(nr.push("PROJECTION_GLOBE_VIEW"),Si&&nr.push("PROJECTED_POS_ON_VIEWPORT")),Vt.text.zOffsetVertexBuffer&&nr.push("Z_OFFSET"),Vt.iconsInText&&nr.push("RENDER_TEXT_AND_SYMBOL"),nr.push("RENDER_SDF"),ii&&nr.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Hi(nr);const zr=Vt.text.programConfigurations.get(l.id),ai=f.getOrCreateProgram("symbol",{config:zr,defines:nr});let Xr,hi=[0,0],Fs=null;const br=Vt.textSizeData;Vt.iconsInText&&(hi=Nt.imageAtlasTexture?Nt.imageAtlasTexture.size:[0,0],Fs=Nt.imageAtlasTexture?Nt.imageAtlasTexture:null,Xr=rt||Pe.pitch!==0||f.options.rotating||f.options.zooming||br.kind==="composite"||br.kind==="camera"?Me.LINEAR:Me.NEAREST);const Ks=Nt.glyphAtlasTexture?Nt.glyphAtlasTexture.size:[0,0],ls=l.layout.get("text-size-scale-range"),oo=i.aD(f.scaleFactor,ls[0],ls[1]),ll=i.bH(br,Pe.zoom,oo),Wl=Sd(rn,Nt.tileID.canonical,rt,Ne,Pe,Vt.getProjection(),vn),Jo=Dh(rn,Nt.tileID.canonical,rt,Ne,Pe,Vt.getProjection(),vn),Fa=f.translatePosMatrix(Jo,Nt,L,j,!0),Bs=f.translatePosMatrix(rn,Nt,L,j),Na=Si?Xd:Wl,cl=Ne&&!rt&&!Oi;let va=Ot;!Dt&&!Pe.mercatorFromTransition||Ne||(va=eu(Pe));const ql=Jh(br.kind,ll,cl,rt,f,Bs,Na,Fa,ke,!0,Ks,hi,!0,Mt,bn,dt,dr,pn?va:Ot,Vt.getProjection(),tr,null,null,oo),Zl=Nt.glyphAtlasTexture?Nt.glyphAtlasTexture:null,sd=Me.LINEAR,ah=l.paint.get("text-halo-width").constantOr(1)!==0,od=f.terrain&&rt&&Oi?i.bi(i.bz(),Wl):Xd;if(Oi&&Vt.text){const Ai=Pe.elevation,hu=Ai?Ai.getAtTileOffsetFunc(Mt,Pe.center.lat,Pe.worldSize,Vt.getProjection()):null,Rm=Ff(rn,Nt.tileID.canonical,rt,Ne,Pe,Vt.getProjection(),vn);El(Vt,rn,f,!0,Rm,Jo,rt,oe,hu,Mt)}return{program:ai,buffers:Vt.text,uniformValues:ql,atlasTexture:Zl,atlasTextureIcon:Fs,atlasInterpolation:sd,atlasInterpolationIcon:Xr,isSDF:!0,hasHalo:ah,depthMode:Hn,tile:Nt,renderWithShadows:ii,labelPlaneMatrixInv:od}},Cr=Vt.icon.segments.get().length,Tr=Vt.text.segments.get().length,si=Cr&&!C.onlyText?Pi():null,ys=Tr&&!C.onlyIcons?Gn():null,Gi=l.paint.get("icon-opacity").constantOr(1),ns=l.paint.get("text-opacity").constantOr(1);if(Tt&&Vt.canOverlap){It=!0;const Oi=Gi&&!C.onlyText?Vt.icon.segments.get():[],nr=ns&&!C.onlyIcons?Vt.text.segments.get():[];for(const Si of Oi)mt.push({segments:new i.bd([Si]),sortKey:Si.sortKey,state:si});for(const Si of nr)mt.push({segments:new i.bd([Si]),sortKey:Si.sortKey,state:ys})}else C.onlyText||mt.push({segments:Gi?Vt.icon.segments:new i.bd([]),sortKey:0,state:si}),C.onlyIcons||mt.push({segments:ns?Vt.text.segments:new i.bd([]),sortKey:0,state:ys})}It&&mt.sort((Mt,Nt)=>Mt.sortKey-Nt.sortKey);for(const Mt of mt){const Nt=Mt.state;if(Nt)if(f.terrain?f.terrain.setupElevationDraw(Nt.tile,Nt.program,{useDepthForOcclusion:Pe.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:Nt.labelPlaneMatrixInv}):f.setupDepthForOcclusion(Pe.depthOcclusionForSymbolsAndCircles,Nt.program),De.activeTexture.set(Me.TEXTURE0),Nt.atlasTexture&&Nt.atlasTexture.bind(Nt.atlasInterpolation,Me.CLAMP_TO_EDGE,!0),Nt.atlasTextureIcon&&(De.activeTexture.set(Me.TEXTURE1),Nt.atlasTextureIcon&&Nt.atlasTextureIcon.bind(Nt.atlasInterpolationIcon,Me.CLAMP_TO_EDGE,!0)),Nt.renderWithShadows&&f.shadowRenderer.setupShadows(Nt.tile.tileID.toUnwrapped(),Nt.program,"vector-tile",Nt.tile.tileID.overscaledZ),f.uploadCommonLightUniforms(f.context,Nt.program),Nt.hasHalo){const Vt=Nt.uniformValues;Vt.u_is_halo=1,ef(Nt.buffers,Mt.segments,l,f,Nt.program,Nt.depthMode,v,w,Vt,2),Vt.u_is_halo=0}else{if(Nt.isSDF){const Vt=Nt.uniformValues;Nt.hasHalo&&(Vt.u_is_halo=1,ef(Nt.buffers,Mt.segments,l,f,Nt.program,Nt.depthMode,v,w,Vt,1)),Vt.u_is_halo=0}ef(Nt.buffers,Mt.segments,l,f,Nt.program,Nt.depthMode,v,w,Nt.uniformValues,1)}}}function ef(f,r,l,p,v,w,C,P,L,z){const j=[f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer,f.iconTransitioningVertexBuffer,f.globeExtVertexBuffer,f.zOffsetVertexBuffer];v.draw(p,p.context.gl.TRIANGLES,w,C,P,Bn.disabled,L,l.id,f.layoutVertexBuffer,f.indexBuffer,r,l.paint,p.transform.zoom,f.programConfigurations.get(l.id),j,z)}function nu(f,r){const l=1<<f.canonical.z,p=(r.x*l-f.canonical.x-f.wrap*l)*i.aj,v=(r.y*l-f.canonical.y)*i.aj,w=i.dS(r.z,r.y);return i.cS(p,v,w)}function Ku(f,r,l,p,v){if(!l.layout||l.layout.get("fill-elevation-reference")==="none")return;const w=f.context.gl,C=new gn(f.context.gl.LEQUAL,gn.ReadWrite,f.depthRangeFor3D),P=new gn(f.context.gl.GREATER,gn.ReadWrite,f.depthRangeFor3D),L=function(q){const re=i.cJ(q.pitch);let te=.01;return q.isOrthographic&&(te=i.ai(1e-4,te,i.cO(re>=cc?1:re/cc))),2*te}(f.transform),z=f.transform.getFreeCameraOptions().position,j="elevatedStructuresDepthReconstruct",H=f.getOrCreateProgram(j,{defines:["DEPTH_RECONSTRUCTION"]}),$=f.getOrCreateProgram(j);for(const q of p){const re=r.getTile(q),te=re.getBucket(l);if(!te)continue;const oe=te.elevatedStructures;if(!oe)continue;const ne=te.elevationBufferData.heightRange,ye=nu(q.toUnwrapped(),z),Se=f.translatePosMatrix(q.projMatrix,re,l.paint.get("fill-translate"),l.paint.get("fill-translate-anchor"));let Te,ke,De,Me;if(v==="initialize"){if(!ne||ne.min>=1||oe.depthSegments.segments[0].primitiveLength===0)continue;Te=No(Se,ye,L,1,0),ke=C,De=oe.depthSegments,Me=H}else if(v==="reset"){if(!ne||ne.min>=0||oe.maskSegments.segments[0].primitiveLength===0)continue;Te=No(Se,ye,0,0,1),ke=P,De=oe.maskSegments,Me=H}else if(v==="geometry"){if(oe.depthSegments.segments[0].primitiveLength===0)continue;Te=No(Se,ye,L,1,0),ke=C,De=oe.depthSegments,Me=$}Me.draw(f,w.TRIANGLES,ke,zn.disabled,or.disabled,Bn.disabled,Te,l.id,oe.vertexBuffer,oe.indexBuffer,De,l.paint,f.transform.zoom)}}function un(f,r,l){const{painter:p,sourceCache:v,layer:w,coords:C,colorMode:P,elevationType:L,terrainEnabled:z,pass:j}=f,H=p.context.gl,$=w.paint.get("fill-pattern"),q=w.paint.get("fill-pattern-cross-fade"),re=$.constantOr(null);let te=L;L!=="road"||r&&!z||(te="none");const oe=te==="road",ne=f.painter.shadowRenderer,ye=oe&&!!ne&&ne.enabled,Se=new gn(p.context.gl.LEQUAL,gn.ReadOnly,p.depthRangeFor3D);let Te=[0,0,0];if(ye){const Me=p.style.directionalLight,Pe=p.style.ambientLight;Me&&Pe&&(Te=Ia(p.style,Me,Pe))}const ke=$&&$.constantOr(1),De=(Me,Pe)=>{let Oe,Ne,ht,rt,Tt;Pe?(Oe=ke&&!w.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ht=H.LINES):(Oe=ke?"fillPattern":"fill",ht=H.TRIANGLES);for(const It of C){const Ht=v.getTile(It);if(ke&&!Ht.patternsLoaded())continue;const Qe=Ht.getBucket(w);if(!Qe)continue;const dt=r?Qe.elevationBufferData:Qe.bufferData;if(dt.isEmpty())continue;p.prepareDrawTile();const Je=dt.programConfigurations.get(w.id),Dt=p.isTileAffectedByFog(It),mt=[],Ot=[];oe&&(mt.push("ELEVATED_ROADS"),Ot.push(dt.elevatedLayoutVertexBuffer)),ye&&mt.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),ke&&(p.context.activeTexture.set(H.TEXTURE0),Ht.imageAtlasTexture&&Ht.imageAtlasTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),Je.updatePaintBuffers());let Mt=!1;if(re&&Ht.imageAtlas){const rn=Ht.imageAtlas,vn=i.dN.from(re),dn=vn.getPrimary().scaleSelf(i.q.devicePixelRatio).toString(),Rn=vn.getSecondary(),Hn=rn.patternPositions.get(dn),dr=Rn?rn.patternPositions.get(Rn.scaleSelf(i.q.devicePixelRatio).toString()):null;Mt=!!Hn&&!!dr,Hn&&Je.setConstantPatternPositions(Hn,dr)}q>0&&(Mt||Je.getPatternTransitionVertexBuffer("fill-pattern"))&&mt.push("FILL_PATTERN_TRANSITION");const Nt=p.getOrCreateProgram(Oe,{config:Je,overrideFog:Dt,defines:mt}),Vt=p.translatePosMatrix(It.projMatrix,Ht,w.paint.get("fill-translate"),w.paint.get("fill-translate-anchor"));ye&&ne.setupShadows(Ht.tileID.toUnwrapped(),Nt,"vector-tile",Ht.tileID.overscaledZ);const pn=w.paint.get("fill-emissive-strength");if(Pe){rt=dt.lineIndexBuffer,Tt=dt.lineSegments;const rn=p.terrain&&p.terrain.renderingToTexture?p.terrain.drapeBufferSize:[H.drawingBufferWidth,H.drawingBufferHeight];Ne=Oe==="fillOutlinePattern"&&ke?qf(Vt,pn,p,Ht,rn,Te,q):Gd(Vt,pn,rn,Te)}else rt=dt.indexBuffer,Tt=dt.triangleSegments,Ne=ke?Gu(Vt,pn,p,Ht,Te,q):vc(Vt,pn,Te);p.uploadCommonUniforms(p.context,Nt,It.toUnwrapped());let bn=Me;(L==="road"&&!z||L==="offset")&&(bn=Se),Nt.draw(p,ht,bn,l||p.stencilModeForClipping(It),P,Bn.disabled,Ne,w.id,dt.layoutVertexBuffer,rt,Tt,w.paint,p.transform.zoom,Je,Ot)}};p.renderPass===j&&De(p.depthModeForSublayer(1,p.renderPass==="opaque"?gn.ReadWrite:gn.ReadOnly),!1),te==="none"&&p.renderPass==="translucent"&&w.paint.get("fill-antialias")&&De(p.depthModeForSublayer(w.getPaintProperty("fill-outline-color")?2:0,gn.ReadOnly),!0)}function jo(f,r,l,p,v,w,C,P){l.resetLayerRenderingStats(f);const L=f.context,z=L.gl,j=f.transform,H=l.paint.get("fill-extrusion-pattern"),$=l.paint.get("fill-extrusion-pattern-cross-fade"),q=H.constantOr(null),re=H.constantOr(1),te=l.paint.get("fill-extrusion-opacity"),oe=f.style.enable3dLights(),ne=l.paint.get(oe&&!re?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),ye=[l.paint.get("fill-extrusion-ambient-occlusion-intensity"),ne],Se=l.layout.get("fill-extrusion-edge-radius"),Te=Se>0&&!l.paint.get("fill-extrusion-rounded-roof"),ke=Te?0:Se,De=j.projection.name==="globe"?i.dT():0,Me=j.projection.name==="globe",Pe=Me?i.ah(j.zoom):0,Oe=[i.ay(j.center.lng),i.aH(j.center.lat)],Ne=l.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",ht=l.paint.get("fill-extrusion-flood-light-color").toRenderColor(Ne?null:l.lut).toArray01().slice(0,3),rt=l.paint.get("fill-extrusion-flood-light-intensity"),Tt=l.paint.get("fill-extrusion-vertical-scale"),It=l.paint.get("fill-extrusion-line-width").constantOr(1)!==0,Ht=l.paint.get("fill-extrusion-height-alignment"),Qe=l.paint.get("fill-extrusion-base-alignment"),dt=Qa(f,l.paint.get("fill-extrusion-cutoff-fade-range")),Je=[];let Dt;Me&&Je.push("PROJECTION_GLOBE_VIEW"),ye[0]>0&&Je.push("FAUX_AO"),Te&&Je.push("ZERO_ROOF_RADIUS"),P&&Je.push("HAS_CENTROID"),rt>0&&Je.push("FLOOD_LIGHT"),dt.shouldRenderCutoff&&Je.push("RENDER_CUTOFF"),It&&Je.push("RENDER_WALL_MODE");const mt=f.renderPass==="shadow",Ot=f.shadowRenderer,Mt=mt&&!!Ot,Nt=mt?Bn.disabled:Bn.backCCW;f.shadowRenderer&&(f.shadowRenderer.useNormalOffset=!0);let Vt=[0,0,0];if(Ot){const rn=f.style.directionalLight,vn=f.style.ambientLight;rn&&vn&&(Vt=Ia(f.style,rn,vn)),mt||(Je.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Ot.useNormalOffset&&Je.push("NORMAL_OFFSET")),Dt=Je.concat(["SHADOWS_SINGLE_CASCADE"])}const pn=Mt?"fillExtrusionDepth":re?"fillExtrusionPattern":"fillExtrusion",bn=l.getLayerRenderingStats();for(const rn of p){const vn=r.getTile(rn),dn=vn.getBucket(l);if(!dn||dn.projection.name!==j.projection.name)continue;let Rn=!1;Ot&&(Rn=Ot.getMaxCascadeForTile(rn.toUnwrapped())===0);const Hn=f.isTileAffectedByFog(rn),dr=dn.programConfigurations.get(l.id);let ri=!1;if(q&&vn.imageAtlas){const Tr=vn.imageAtlas,si=i.dN.from(q),ys=si.getPrimary().scaleSelf(i.q.devicePixelRatio).toString(),Gi=si.getSecondary(),ns=Tr.patternPositions.get(ys),Oi=Gi?Tr.patternPositions.get(Gi.scaleSelf(i.q.devicePixelRatio).toString()):null;ri=!!ns&&!!Oi,ns&&dr.setConstantPatternPositions(ns,Oi)}$>0&&(ri||dr.getPatternTransitionVertexBuffer("fill-extrusion-pattern"))&&Je.push("FILL_EXTRUSION_PATTERN_TRANSITION");const ii=f.getOrCreateProgram(pn,{config:dr,defines:Rn?Dt:Je,overrideFog:Hn});if(f.terrain&&f.terrain.setupElevationDraw(vn,ii,{useMeterToDem:!0}),!dn.centroidVertexBuffer){const Tr=ii.attributes.a_centroid_pos;Tr!==void 0&&z.vertexAttrib2f(Tr,0,0)}!mt&&Ot&&Ot.setupShadows(vn.tileID.toUnwrapped(),ii,"vector-tile",vn.tileID.overscaledZ),re&&(f.context.activeTexture.set(z.TEXTURE0),vn.imageAtlasTexture&&vn.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),dr.updatePaintBuffers());const tr=l.paint.get("fill-extrusion-vertical-gradient"),Hi=1/dn.tileToMeter;let Pi;if(mt&&Ot){if(ym(vn.tileID,dn,f))continue;const Tr=Ot.calculateShadowPassMatrixFromTile(vn.tileID.toUnwrapped());Pi=Eg(Tr,ke,Hi,Tt,Ht,Qe)}else{const Tr=f.translatePosMatrix(rn.expandedProjMatrix,vn,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),si=j.projection.createInversionMatrix(j,rn.canonical);Pi=re?ry(Tr,f,tr,te,ye,ke,Hi,rn,vn,De,Ht,Qe,Pe,Oe,si,ht,Tt,$):yc(Tr,f,tr,te,ye,ke,Hi,rn,De,Ht,Qe,Pe,Oe,si,ht,Tt,rt,Vt)}f.uploadCommonUniforms(L,ii,rn.toUnwrapped(),null,dt);let Gn=dn.segments;if(j.projection.name==="mercator"&&!mt&&(Gn=dn.getVisibleSegments(vn.tileID,f.terrain,f.transform.getFrustum(0)),!Gn.get().length))continue;if(bn)if(mt)for(const Tr of Gn.get())bn.numRenderedVerticesInShadowPass+=Tr.primitiveLength;else for(const Tr of Gn.get())bn.numRenderedVerticesInTransparentPass+=Tr.primitiveLength;const Cr=[];(f.terrain||P)&&Cr.push(dn.centroidVertexBuffer),Me&&Cr.push(dn.layoutVertexExtBuffer),It&&Cr.push(dn.wallVertexBuffer),ii.draw(f,L.gl.TRIANGLES,v,w,C,Nt,Pi,l.id,dn.layoutVertexBuffer,dn.indexBuffer,Gn,l.paint,f.transform.zoom,dr,Cr)}f.shadowRenderer&&(f.shadowRenderer.useNormalOffset=!1)}function ma(f,r,l,p,v,w,C,P,L,z,j,H,$,q,re,te,oe,ne,ye){const Se=f.context,Te=Se.gl,ke=f.transform,De=f.transform.zoom,Me=[],Pe=Qa(f,l.paint.get("fill-extrusion-cutoff-fade-range"));z==="clear"?(Me.push("CLEAR_SUBPASS"),ye&&(Me.push("CLEAR_FROM_TEXTURE"),Se.activeTexture.set(Te.TEXTURE0),ye.bind(Te.LINEAR,Te.CLAMP_TO_EDGE))):z==="sdf"&&Me.push("SDF_SUBPASS"),oe&&Me.push("HAS_CENTROID"),Pe.shouldRenderCutoff&&Me.push("RENDER_CUTOFF");const Oe=l.layout.get("fill-extrusion-edge-radius"),Ne=(ht,rt,Tt,It,Ht)=>{const Qe=rt.programConfigurations.get(l.id),dt=f.isTileAffectedByFog(ht),Je=f.getOrCreateProgram("fillExtrusionGroundEffect",{config:Qe,defines:Me,overrideFog:dt}),Dt=((Ot,Mt,Nt,Vt,pn,bn,rn,vn,dn,Rn,Hn)=>({u_matrix:Mt,u_opacity:Nt,u_ao_pass:Vt?1:0,u_meter_to_tile:pn,u_ao:bn,u_flood_light_intensity:rn,u_flood_light_color:vn,u_attenuation:dn,u_edge_radius:Rn,u_fb:0,u_fb_size:Hn,u_dynamic_offset:1}))(0,It,j,L,Ht,[H,$*Ht],q,re,te,De>=17?0:Oe*Ht,ye?ye.size[0]:0),mt=[];oe&&mt.push(rt.hiddenByLandmarkVertexBuffer),f.uploadCommonUniforms(Se,Je,ht.toUnwrapped(),null,Pe),Je.draw(f,Se.gl.TRIANGLES,v,w,C,P,Dt,l.id,rt.vertexBuffer,rt.indexBuffer,Tt,l.paint,De,Qe,mt)};for(const ht of p){const rt=r.getTile(ht),Tt=rt.getBucket(l);if(!Tt||Tt.projection.name!==ke.projection.name||!Tt.groundEffect||Tt.groundEffect&&!Tt.groundEffect.hasData())continue;const It=Tt.groundEffect,Ht=1/Tt.tileToMeter;{const Qe=f.translatePosMatrix(ht.projMatrix,rt,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),dt=It.getDefaultSegment();Ne(ht,It,dt,Qe,Ht)}if(ne)for(let Qe=0;Qe<4;Qe++){const dt=i.dU[Qe](ht),Je=r.getTile(dt);if(!Je)continue;const Dt=Je.getBucket(l);if(!Dt||Dt.projection.name!==ke.projection.name||!Dt.groundEffect||Dt.groundEffect&&!Dt.groundEffect.hasData())continue;const mt=Dt.groundEffect;let Ot,Mt;Qe===0?(Ot=[-i.aj,0,0],Mt=1):Qe===1?(Ot=[i.aj,0,0],Mt=0):Qe===2?(Ot=[0,-i.aj,0],Mt=3):(Ot=[0,i.aj,0],Mt=2);const Nt=mt.regionSegments[Mt];if(!Nt)continue;const Vt=new Float32Array(16);i.bo(Vt,ht.projMatrix,Ot),Ne(ht,mt,Nt,f.translatePosMatrix(Vt,rt,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),Ht)}}}function zl(f,r,l,p,v,w,C){p.centroidVertexArray.length===0&&p.createCentroidsBuffer();const P=w?w.findDEMTileFor(l):null;if(!(P&&P.dem||C))return;w&&P&&P.dem&&p.selfDEMTileTimestamp!==P.dem._timestamp&&(p.borderDoneWithNeighborZ=[-1,-1,-1,-1],p.selfDEMTileTimestamp=P.dem._timestamp);const L=ne=>new i.P(Math.ceil((ne+i.dX)*i.dY),0),z=ne=>{const ye=r.getSource().minzoom,Se=ke=>{const De=r.getTileByID(ke);if(De&&De.hasData())return De.getBucket(v)},Te=[0,-1,1];for(const ke of Te){if(ne.overscaledZ+ke<ye)continue;const De=Se(ne.calculateScaledKey(ne.overscaledZ+ke));if(De)return De}},j=[0,0,0],H=(ne,ye)=>(j[0]=Math.min(ne.min.y,ye.min.y),j[1]=Math.max(ne.max.y,ye.max.y),j[2]=i.aj-ye.min.x>ne.max.x?ye.min.x-i.aj:ne.max.x,j),$=(ne,ye)=>(j[0]=Math.min(ne.min.x,ye.min.x),j[1]=Math.max(ne.max.x,ye.max.x),j[2]=i.aj-ye.min.y>ne.max.y?ye.min.y-i.aj:ne.max.y,j),q=[(ne,ye)=>H(ne,ye),(ne,ye)=>H(ye,ne),(ne,ye)=>$(ne,ye),(ne,ye)=>$(ye,ne)],re=(ne,ye,Se,Te,ke,De,Me)=>{if(!w)return 0;const Pe=[[De?Se:ne,De?ne:Se,0],[De?Se:ye,De?ye:Se,0]],Oe=Me<0?i.aj+Me:Me,Ne=[De?Oe:(ne+ye)/2,De?(ne+ye)/2:Oe,0];return Se===0&&Me<0||Se!==0&&Me>0?w.getForTilePoints(ke,[Ne],!0,Te):Pe.push(Ne),w.getForTilePoints(l,Pe,!0,P),Math.max(Pe[0][2],Pe[1][2],Ne[2])/w.exaggeration()};for(let ne=0;ne<4;ne++){const ye=p.borderFeatureIndices[ne];if(ye.length===0)continue;const Se=i.dU[ne](l),Te=z(Se);if(!(Te&&Te instanceof i.dV))continue;const ke=w?w.findDEMTileFor(Se):null;if(!(ke&&ke.dem||C)||(w&&ke&&ke.dem&&p.borderDEMTileTimestamp[ne]!==ke.dem._timestamp&&(p.borderDoneWithNeighborZ[ne]=-1,p.borderDEMTileTimestamp[ne]=ke.dem._timestamp),p.borderDoneWithNeighborZ[ne]===Te.canonical.z))continue;Te.centroidVertexArray.length===0&&Te.createCentroidsBuffer();const De=(ne<2?1:5)-ne,Me=Te.borderDoneWithNeighborZ[De]!==p.canonical.z,Pe=Te.borderFeatureIndices[De];let Oe=0;if(p.canonical.z!==Te.canonical.z){for(const Ne of ye)p.showCentroid(p.featuresOnBorder[Ne]);if(Me)for(const Ne of Pe)Te.showCentroid(Te.featuresOnBorder[Ne]);p.borderDoneWithNeighborZ[ne]=Te.canonical.z,Te.borderDoneWithNeighborZ[De]=p.canonical.z}for(const Ne of ye){const ht=p.featuresOnBorder[Ne],rt=p.centroidData[ht.centroidDataIndex],Tt=ht.borders[ne];let It;for(;Oe<Pe.length;){It=Te.featuresOnBorder[Pe[Oe]];const Ht=It.borders[De];if(Ht[1]>Tt[0]+3||Ht[0]>Tt[0]-3)break;Te.showCentroid(It),Oe++}if(It&&Oe<Pe.length){const Ht=Oe;let Qe=0;for(;!(It.borders[De][0]>Tt[1]-3)&&(Qe++,++Oe!==Pe.length);)It=Te.featuresOnBorder[Pe[Oe]];It=Te.featuresOnBorder[Pe[Ht]];let dt=!1;if(Qe>=1){const mt=It.borders[De];Math.abs(Tt[0]-mt[0])<3&&Math.abs(Tt[1]-mt[1])<3&&(Qe=1,dt=!0,Oe=Ht+1)}else if(Qe===0){p.showCentroid(ht);continue}const Je=Te.centroidData[It.centroidDataIndex];C&&dt&&(((te=rt).flags|(oe=Je).flags)&i.dW?(te.flags|=i.dW,oe.flags|=i.dW):(te.flags&=~i.dW,oe.flags&=~i.dW));const Dt=ht.intersectsCount()>1||It.intersectsCount()>1;if(Qe>1)Oe=Ht,rt.centroidXY=Je.centroidXY=new i.P(0,0);else if(ke&&ke.dem&&!Dt){const mt=q[ne](rt,Je),Ot=ne%2?i.aj-1:0,Mt=re(mt[0],Math.min(i.aj-1,mt[1]),Ot,ke,Se,ne<2,mt[2]);rt.centroidXY=Je.centroidXY=L(Mt)}else Dt?rt.centroidXY=Je.centroidXY=new i.P(0,0):(rt.centroidXY=p.encodeBorderCentroid(ht),Je.centroidXY=Te.encodeBorderCentroid(It));p.writeCentroidToBuffer(rt),Te.writeCentroidToBuffer(Je)}else p.showCentroid(ht)}p.borderDoneWithNeighborZ[ne]=Te.canonical.z,Te.borderDoneWithNeighborZ[De]=p.canonical.z}var te,oe;(p.needsCentroidUpdate||!p.centroidVertexBuffer&&p.centroidVertexArray.length!==0)&&p.uploadCentroid(f)}const bc=[1,0,0],Ln=[0,1,0],Fl=[0,0,1];function ym(f,r,l){const p=l.transform,v=l.shadowRenderer;if(!v)return!0;const w=f.toUnwrapped(),C=p.tileSize*v._cascades[l.currentShadowCascade].scale;let P=r.maxHeight;if(p.elevation){const te=p.elevation.getMinMaxForTile(f);te&&(P+=te.max)}const L=[...v.shadowDirection];L[2]=-L[2];const z=v.computeSimplifiedTileShadowVolume(w,P,C,L);if(!z)return!1;const j=[bc,Ln,Fl,L,[L[0],0,L[2]],[0,L[1],L[2]]],H=p.projection.name==="globe",$=p.scaleZoom(C),q=i.cn.fromInvProjectionMatrix(p.invProjMatrix,p.worldSize,$,!H),re=v.getCurrentCascadeFrustum();return q.intersectsPrecise(z.vertices,z.planes,j)===0||re.intersectsPrecise(z.vertices,z.planes,j)===0}function vm(f){return[f[0]*i.dZ,f[1]*i.dZ,f[2]*i.dZ,0]}function ga(f,r,l,p,v,w,C,P,L){const z=p.getSource(),j=l.globeSharedBuffers;if(!j)return;let H,$,q;if(r&&(H=p.getTile(r)),z instanceof i.aP?($=z.texture,q=i.ds(0,0,l.transform)):H&&r&&($=H.texture,q=i.ds(r.canonical.z,r.canonical.x,l.transform)),!$||!q)return;f||(q=i.cE(i.bz(),q,[1,-1,1]));const re=l.context,te=re.gl,oe=v.paint.get("raster-resampling")==="nearest"?te.NEAREST:te.LINEAR,ne=l.colorModeForDrapableLayerRenderPass(w),ye=C.defines;ye.push("GLOBE_POLES");const Se=new gn(te.LEQUAL,gn.ReadWrite,l.depthRangeFor3D),Te=Float32Array.from(l.transform.expandedFarZProjMatrix),ke=Float32Array.from(i.bh(i.dr(new i.cp(0,0,0))));l.terrain&&l.terrain.prepareDrawTile(),re.activeTexture.set(te.TEXTURE0),$.bind(oe,te.CLAMP_TO_EDGE),re.activeTexture.set(te.TEXTURE1),$.bind(oe,te.CLAMP_TO_EDGE),"useMipmap"in $&&re.extTextureFilterAnisotropic&&l.transform.pitch>20&&te.texParameterf(te.TEXTURE_2D,re.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,re.extTextureFilterAnisotropicMax);const[De,Me,Pe,Oe]=r?j.getPoleBuffers(r.canonical.z,!1):j.getPoleBuffers(0,!0),Ne=v.paint.get("raster-elevation");let ht;f?(ht=De,l.renderDefaultNorthPole=Ne!==0):(ht=Me,l.renderDefaultSouthPole=Ne!==0);const rt=vm(C.mix),Tt=((Ht,Qe,dt,Je,Dt,mt,Ot,Mt,Nt,Vt,pn,bn,rn)=>kl(Ht,Qe,dt,new Float32Array(16),new Float32Array(9),[0,0],Je,[0,0],[0,0,0,0],1,{opacity:1,mix:0},mt,[0,0],Mt,2,Vt,pn,bn,1,0,rn))(Te,ke,q,i.ah(l.transform.zoom),0,v,0,Ne,0,rt,C.offset,C.range,w),It=l.getOrCreateProgram("raster",{defines:ye});l.uploadCommonUniforms(re,It,null),It.draw(l,te.TRIANGLES,Se,L,ne,P,Tt,v.id,ht,Pe,Oe)}function wc(f){const r=f._nearZ,l=f.projection.farthestPixelDistance(f),p=l-r,v=.2*f.height,w=r+v;return[r,l,(w-v-r)/p,(w-r)/p]}function Yf(f,r,l,p){if(f)return r instanceof Eu&&f instanceof vd?r.getTextureDescriptor(f,l,!0):{texture:f.texture,mix:vm(p.mix),offset:p.offset,buffer:0,tileSize:1}}var xm=i.d_([{name:"a_index",type:"Int16",components:1}]);class Jf{constructor(r,l,p,v){const w={width:p[0],height:p[1],data:null},C=r.gl;this.targetColorTexture=new i.T(r,w,C.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new i.T(r,w,C.RGBA8,{useMipmap:!1}),this.context=r,this.updateParticleTexture(l,v),this.lastInvalidatedAt=0}updateParticleTexture(r,l){if(this.particleTextureDimension===l.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const p=this.context.gl,v=l.width*l.height;this.particleTexture0=new i.T(this.context,l,p.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new i.T(this.context,l,p.RGBA8,{premultiply:!1,useMipmap:!1});const w=new i.d$;w.reserve(v);for(let C=0;C<v;C++)w.emplaceBack(C);this.particleIndexBuffer=this.context.createVertexBuffer(w,xm.members,!0),this.particleSegment=i.bd.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=l.width}update(r){return!(this.lastInvalidatedAt<r&&(this.lastInvalidatedAt=i.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function Ig(f,r,l){if(!f)return null;const p=r.getTextureDescriptor(f,l,!0);if(!p)return null;let{texture:v,mix:w,offset:C,tileSize:P,buffer:L,format:z}=p;if(!v||!z)return null;let j=!1;return z==="uint32"&&(j=!0,w[3]=0,w=xc(i.e0,w,[0,l.paint.get("raster-particle-max-speed")]),C=Yh(i.e0,C,[0,l.paint.get("raster-particle-max-speed")])),{texture:v,textureOffset:[L/(P+2*L),P/(P+2*L)],tileSize:P,scalarData:j,scale:w,offset:C,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[z]]}}function Yu(f){const r=f._nearZ,l=f.projection.farthestPixelDistance(f),p=l-r,v=.2*f.height,w=r+v;return[r,l,(w-v-r)/p,(w-r)/p]}const La=new i.am(1,0,0,1),Ju=new i.am(0,1,0,1),Qu=new i.am(0,0,1,1),qs=new i.am(1,0,1,1),Nl=new i.am(0,1,1,1);function Da(f,r,l,p,v,w,C){const P=f.context,L=f.transform,z=P.gl,j=L.projection.name==="globe",H=j?["PROJECTION_GLOBE_VIEW"]:[];let $=i.bw(l.projMatrix);if(j&&i.ah(L.zoom)>0){const rt=i.bg(l.canonical,L),Tt=i.e1(rt);$=i.az(new Float32Array(16),L.globeMatrix,Tt),i.az($,L.projMatrix,$)}const q=i.bz();q[12]+=2*v/(i.q.devicePixelRatio*L.width),q[13]+=2*w/(i.q.devicePixelRatio*L.height),i.az($,q,$);const re=f.getOrCreateProgram("debug",{defines:H}),te=r.getTileByID(l.key);f.terrain&&f.terrain.setupElevationDraw(te,re);const oe=gn.disabled,ne=zn.disabled,ye=f.colorModeForRenderPass(),Se="$debug";P.activeTexture.set(z.TEXTURE0),f.emptyTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),j?te._makeGlobeTileDebugBuffers(f.context,L):te._makeDebugTileBoundsBuffers(f.context,L.projection);const Te=te._tileDebugBuffer||f.debugBuffer,ke=te._tileDebugIndexBuffer||f.debugIndexBuffer,De=te._tileDebugSegments||f.debugSegments;if(re.draw(f,z.LINE_STRIP,oe,ne,ye,Bn.disabled,pa($,p),Se,Te,ke,De,null,null,null,[te._globeTileDebugBorderBuffer]),C){const rt=te.latestRawTileData,Tt=Math.floor((rt&&rt.byteLength||0)/1024);let It=l.canonical.toString();l.overscaledZ!==l.canonical.z&&(It+=` => ${l.overscaledZ}`),It+=` ${te.state}`,It+=` ${Tt}kb`,function(Ht,Qe){Ht.initDebugOverlayCanvas();const dt=Ht.debugOverlayCanvas,Je=Ht.context.gl,Dt=Ht.debugOverlayCanvas.getContext("2d");Dt.clearRect(0,0,dt.width,dt.height),Dt.shadowColor="white",Dt.shadowBlur=2,Dt.lineWidth=1.5,Dt.strokeStyle="white",Dt.textBaseline="top",Dt.font="bold 36px Open Sans, sans-serif",Dt.fillText(Qe,5,5),Dt.strokeText(Qe,5,5),Ht.debugOverlayTexture.update(dt),Ht.debugOverlayTexture.bind(Je.LINEAR,Je.CLAMP_TO_EDGE)}(f,It)}const Me=r.getTile(l).tileSize,Pe=512/Math.min(Me,512)*(l.overscaledZ/L.zoom)*.5,Oe=te._tileDebugTextBuffer||f.debugBuffer,Ne=te._tileDebugTextIndexBuffer||f.quadTriangleIndexBuffer,ht=te._tileDebugTextSegments||f.debugSegments;re.draw(f,z.TRIANGLES,oe,ne,or.alphaBlended,Bn.disabled,pa($,i.am.transparent,Pe),Se,Oe,Ne,ht,null,null,null,[te._globeTileDebugTextBuffer])}function tf(f,r,l,p){as(f,0,r+l/2,f.transform.width,l,p)}function Yd(f,r,l,p){as(f,r-l/2,0,l,f.transform.height,p)}function as(f,r,l,p,v,w){const C=f.context,P=C.gl;P.enable(P.SCISSOR_TEST),P.scissor(r*i.q.devicePixelRatio,l*i.q.devicePixelRatio,p*i.q.devicePixelRatio,v*i.q.devicePixelRatio),C.clear({color:w}),P.disable(P.SCISSOR_TEST)}const nf=i.d_([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:ea}=nf;function ni(f,r,l,p){f.emplaceBack(r,l,p)}class ru{constructor(r){this.vertexArray=new i.e2,this.indices=new i.a_,ni(this.vertexArray,-1,-1,1),ni(this.vertexArray,1,-1,1),ni(this.vertexArray,-1,1,1),ni(this.vertexArray,1,1,1),ni(this.vertexArray,-1,-1,-1),ni(this.vertexArray,1,-1,-1),ni(this.vertexArray,-1,1,-1),ni(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=r.createVertexBuffer(this.vertexArray,ea),this.indexBuffer=r.createIndexBuffer(this.indices),this.segment=i.bd.simpleSegment(0,0,36,12)}}function jl(f,r,l,p,v,w){const C=f.context.gl,P=r.paint.get("sky-atmosphere-color"),L=r.paint.get("sky-atmosphere-halo-color"),z=r.paint.get("sky-atmosphere-sun-intensity"),j=((H,$,q,re,te)=>({u_matrix_3f:H,u_sun_direction:$,u_sun_intensity:q,u_color_tint_r:[re.r,re.g,re.b,re.a],u_color_tint_m:[te.r,te.g,te.b,te.a],u_luminance:5e-5}))(i.e4(i.dx(),p),v,z,P,L);C.framebufferTexture2D(C.FRAMEBUFFER,C.COLOR_ATTACHMENT0,C.TEXTURE_CUBE_MAP_POSITIVE_X+w,r.skyboxTexture,0),l.draw(f,C.TRIANGLES,gn.disabled,zn.disabled,or.unblended,Bn.frontCW,j,"skyboxCapture",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}const iu=i.d_([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Ps{constructor(r){const l=new i.e5;l.emplaceBack(-1,1,1,0,0),l.emplaceBack(1,1,1,1,0),l.emplaceBack(1,-1,1,1,1),l.emplaceBack(-1,-1,1,0,1);const p=new i.a_;p.emplaceBack(0,1,2),p.emplaceBack(2,3,0),this.vertexBuffer=r.createVertexBuffer(l,iu.members),this.indexBuffer=r.createIndexBuffer(p),this.segments=i.bd.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Zs=i.d_([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class fo{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class Sc{constructor(r){this.colorModeAlphaBlendedWriteRGB=new or([1,zo,1,zo],i.am.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new or([1,0,1,0],i.am.transparent,[!1,!1,!1,!0]),this.params=new fo,this.updateNeeded=!0,r.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),r.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),r.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),r.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(r){const l=r.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new Ps(l);const p=this.params.sizeRange,v=this.params.intensityRange,w=function(j){const H=i.ea(30),$=[];for(let q=0;q<j;++q){const re=2*Math.PI*H(),te=Math.acos(1-2*H())-.5*Math.PI;$.push(i.cS(Math.cos(te)*Math.cos(re),Math.cos(te)*Math.sin(re),Math.sin(te)))}return $}(this.params.starsCount),C=i.ea(300),P=new i.e6,L=new i.a_;let z=0;for(let j=0;j<w.length;++j){const H=i.b$([],w[j],200),$=Math.max(0,1+.01*p*(1*C()-.5)),q=Math.max(0,1+.01*v*(1*C()-.5));P.emplaceBack(H[0],H[1],H[2],-1,-1,$,q),P.emplaceBack(H[0],H[1],H[2],1,-1,$,q),P.emplaceBack(H[0],H[1],H[2],1,1,$,q),P.emplaceBack(H[0],H[1],H[2],-1,1,$,q),L.emplaceBack(z+0,z+1,z+2),L.emplaceBack(z+0,z+2,z+3),z+=4}this.starsVx=l.createVertexBuffer(P,Zs.members),this.starsIdx=l.createIndexBuffer(L),this.starsSegments=i.bd.simpleSegment(0,0,P.length,L.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(r,l){const p=r.context,v=p.gl,w=r.transform,C=new gn(v.LEQUAL,gn.ReadOnly,[0,1]),P=i.ah(w.zoom),L=r.style.getLut(l.scope),z=l.properties.get("color-use-theme")==="none",j=l.properties.get("color").toRenderColor(z?null:L).toArray01(),H=l.properties.get("high-color-use-theme")==="none",$=l.properties.get("high-color").toRenderColor(H?null:L).toArray01(),q=l.properties.get("space-color-use-theme")==="none",re=l.properties.get("space-color").toRenderColor(q?null:L).toArray01PremultipliedAlpha(),te=5e-4,oe=i.e7(l.properties.get("horizon-blend"),0,1,te,.25),ne=i.dl(r,p,w)&&oe===te?w.worldSize/(2*Math.PI*1.025)-1:w.globeRadius,ye=r.frameCounter/1e3%1,Se=i.ae(w.globeCenterInViewSpace),Te=Math.sqrt(Math.pow(Se,2)-Math.pow(ne,2)),ke=Math.acos(Te/Se),De=Me=>{const Pe=w.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Me&&Pe.push("ALPHA_PASS");const Oe=r.getOrCreateProgram("globeAtmosphere",{defines:Pe}),Ne=((rt,Tt,It,Ht,Qe,dt,Je,Dt,mt,Ot,Mt,Nt)=>({u_frustum_tl:rt,u_frustum_tr:Tt,u_frustum_br:It,u_frustum_bl:Ht,u_horizon:Qe,u_transition:dt,u_fadeout_range:Je,u_color:Dt,u_high_color:mt,u_space_color:Ot,u_temporal_offset:Mt,u_horizon_angle:Nt}))(w.frustumCorners.TL,w.frustumCorners.TR,w.frustumCorners.BR,w.frustumCorners.BL,w.frustumCorners.horizon,P,oe,j,$,re,ye,ke);r.uploadCommonUniforms(p,Oe);const ht=this.atmosphereBuffer;ht&&Oe.draw(r,v.TRIANGLES,C,zn.disabled,Me?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Bn.backCW,Ne,Me?"atmosphere_glow_alpha":"atmosphere_glow",ht.vertexBuffer,ht.indexBuffer,ht.segments)};De(!1),De(!0)}drawStars(r,l){const p=i.aD(l.properties.get("star-intensity"),0,1);if(p===0)return;const v=r.context,w=v.gl,C=r.transform,P=r.getOrCreateProgram("stars"),L=i.bY([]);i.b_(L,L,-C._pitch),i.bZ(L,L,-C.angle),i.b_(L,L,i.al(C._center.lat)),i.e8(L,L,-i.al(C._center.lng));const z=i.c3(new Float32Array(16),L),j=i.az([],C.starsProjMatrix,z),H=i.e4([],z),$=i.e9([],H),q=[0,1,0];i.dz(q,q,$),i.b$(q,q,this.params.sizeMultiplier);const re=[1,0,0];i.dz(re,re,$),i.b$(re,re,this.params.sizeMultiplier);const te=(oe=q,ne=re,ye=p,{u_matrix:Float32Array.from(j),u_up:oe,u_right:ne,u_intensity_multiplier:ye});var oe,ne,ye;r.uploadCommonUniforms(v,P),this.starsVx&&this.starsIdx&&P.draw(r,w.TRIANGLES,gn.disabled,zn.disabled,this.colorModeAlphaBlendedWriteRGB,Bn.disabled,te,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function il(f,r){const l=[...f],p=r.cameraWorldSizeForFog/r.worldSize,v=i.bx([]);return i.cE(v,v,[p,p,1]),i.az(l,v,l),i.az(l,r.worldToFogMatrix,l),l}function Xt(f,r,l,p,v){const w=l.material,C=p.context,{baseColorTexture:P,metallicRoughnessTexture:L}=w.pbrMetallicRoughness,{normalTexture:z,occlusionTexture:j,emissionTexture:H}=w;function $(re,te,oe){if(re&&(f.push(te),C.activeTexture.set(C.gl.TEXTURE0+oe),re.gfxTexture)){const{minFilter:ne,magFilter:ye,wrapS:Se,wrapT:Te}=re.sampler;re.gfxTexture.bindExtraParam(ne,ye,Se,Te)}}$(P,"HAS_TEXTURE_u_baseColorTexture",Fo.BaseColor),$(L,"HAS_TEXTURE_u_metallicRoughnessTexture",Fo.MetallicRoughness),$(z,"HAS_TEXTURE_u_normalTexture",Fo.Normal),$(j,"HAS_TEXTURE_u_occlusionTexture",Fo.Occlusion),$(H,"HAS_TEXTURE_u_emissionTexture",Fo.Emission),v&&(v.texture||(v.texture=new i.ed(p.context,v.image,[v.image.height,v.image.height,v.image.height],C.gl.RGBA8)),C.activeTexture.set(C.gl.TEXTURE0+Fo.LUT),v.texture&&v.texture.bind(C.gl.LINEAR,C.gl.CLAMP_TO_EDGE),f.push("APPLY_LUT_ON_GPU")),l.texcoordBuffer&&(f.push("HAS_ATTRIBUTE_a_uv_2f"),r.push(l.texcoordBuffer)),l.colorBuffer&&(f.push(l.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),r.push(l.colorBuffer)),l.normalBuffer&&(f.push("HAS_ATTRIBUTE_a_normal_3f"),r.push(l.normalBuffer)),l.pbrBuffer&&(f.push("HAS_ATTRIBUTE_a_pbr"),f.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),r.push(l.pbrBuffer)),w.alphaMode!=="OPAQUE"&&w.alphaMode!=="MASK"||f.push("UNPREMULT_TEXTURE_IN_SHADER"),w.defined||f.push("DIFFUSE_SHADED");const q=p.shadowRenderer;q&&(f.push("RENDER_SHADOWS","DEPTH_TEXTURE"),q.useNormalOffset&&f.push("NORMAL_OFFSET"))}function fn(f,r,l,p,v,w){const C=l.paint.get("model-opacity").constantOr(1),P=r.context,L=new gn(r.context.gl.LEQUAL,gn.ReadWrite,r.depthRangeFor3D),z=r.transform,j=f.mesh,H=j.material,$=H.pbrMetallicRoughness,q=r.style.fog;let re;re=r.transform.projection.zAxisUnit==="pixels"?[...f.nodeModelMatrix]:i.az([],p.zScaleMatrix,f.nodeModelMatrix),i.az(re,p.negCameraPosMatrix,re);const te=i.bi([],re);i.ee(te,te);const oe=l.paint.get("model-color-use-theme").constantOr("default")==="none",ne=l.paint.get("model-emissive-strength").constantOr(0),ye=Ol(new Float32Array(f.worldViewProjection),new Float32Array(re),new Float32Array(te),null,r,C,$.baseColorFactor.toRenderColor(null),H.emissiveFactor,$.metallicFactor,$.roughnessFactor,H,ne,l),Se={defines:[]},Te=[],ke=r.shadowRenderer;ke&&(ke.useNormalOffset=!1),Xt(Se.defines,Te,j,r,oe?null:l.lut);let De=null;if(q){const Oe=il(f.nodeModelMatrix,r.transform);if(De=new Float32Array(Oe),z.projection.name!=="globe"){const Ne=j.aabb.min,ht=j.aabb.max,[rt,Tt]=q.getOpacityForBounds(Oe,Ne[0],Ne[1],ht[0],ht[1]);Se.overrideFog=rt>=ln||Tt>=ln}}const Me=Qa(r,l.paint.get("model-cutoff-fade-range"));Me.shouldRenderCutoff&&Se.defines.push("RENDER_CUTOFF");const Pe=r.getOrCreateProgram("model",Se);r.uploadCommonUniforms(P,Pe,null,De,Me),r.renderPass!=="shadow"&&ke&&ke.setupShadowsFromMatrix(f.nodeModelMatrix,Pe),Pe.draw(r,P.gl.TRIANGLES,L,v,w,j.material.doubleSided?Bn.disabled:Bn.backCCW,ye,l.id,j.vertexBuffer,j.indexBuffer,j.segments,l.paint,r.transform.zoom,void 0,Te)}function zs(f,r,l,p,v,w,C){let P;P=f.projection.name==="globe"?i.ef(l,f):[...l],i.az(P,P,r.matrix);const L=i.az([],p,P);if(r.meshes)for(const z of r.meshes){if(z.material.alphaMode!=="BLEND"){C.push({mesh:z,depth:0,modelIndex:v,worldViewProjection:L,nodeModelMatrix:P});continue}const j=i.ad([],z.centroid,L);!f.isOrthographic&&j[2]<=0||w.push({mesh:z,depth:j[2],modelIndex:v,worldViewProjection:L,nodeModelMatrix:P})}if(r.children)for(const z of r.children)zs(f,z,l,p,v,w,C)}function $i(f,r,l,p){const v=l.shadowRenderer;if(!v)return;const w=v.getShadowPassDepthMode(),C=v.getShadowPassColorMode(),P=v.calculateShadowPassMatrixFromMatrix(r),L=_m(P);l.getOrCreateProgram("modelDepth",{defines:l._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(l,l.context.gl.TRIANGLES,w,zn.disabled,C,Bn.backCCW,L,p.id,f.vertexBuffer,f.indexBuffer,f.segments,p.paint,l.transform.zoom,void 0,void 0)}function ut(f,r,l){const p=r.updateZoomBasedPaintProperties(),v=function(w,C,P){let L,z,j,H=w.terrain?w.terrain.exaggeration():0;if(w.terrain&&H>0){const $=w.terrain,q=$.findDEMTileFor(P);q&&q.dem?L=i.el.create($,P,q):H=0}if(H===0&&(C.terrainElevationMin=0,C.terrainElevationMax=0),H===C.validForExaggeration&&(H===0||L&&L._demTile&&L._demTile.tileID===C.validForDEMTile.id&&L._dem._timestamp===C.validForDEMTile.timestamp))return!1;for(const $ in C.instancesPerModel){const q=C.instancesPerModel[$];for(let re=0;re<q.instancedDataArray.length;++re){const te=(L?H*L.getElevationAt(0|q.instancedDataArray.float32[16*re],0|q.instancedDataArray.float32[16*re+1],!0,!0):0)+q.instancesEvaluatedElevation[re];q.instancedDataArray.float32[16*re+6]=te,z=z?Math.min(C.terrainElevationMin,te):te,j=j?Math.max(C.terrainElevationMax,te):te}}return C.terrainElevationMin=z||0,C.terrainElevationMax=j||0,C.validForExaggeration=H,C.validForDEMTile=L&&L._demTile?{id:L._demTile.tileID,timestamp:L._dem._timestamp}:{id:void 0,timestamp:0},!0}(f,r,l);(p||v)&&(r.uploaded=!1,r.upload(f.context))}const _a={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new i.cV([0,0,0],[i.aj,i.aj,0])};function ya(f,r){const l=1<<f.canonical.z,p=r.getFreeCameraOptions().position,v=r.elevation,w=f.canonical.x/l,C=(f.canonical.x+1)/l,P=f.canonical.y/l,L=(f.canonical.y+1)/l;let z=r._centerAltitude;if(v){const q=v.getMinMaxForTile(f);q&&q.max>z&&(z=q.max)}const j=i.aD(p.x,w,C)-p.x,H=i.aD(p.y,P,L)-p.y,$=i.c6(z,r.center.lat)-p.z;return r._zoomFromMercatorZ(Math.sqrt(j*j+H*H+$*$))}function Ko(f,r,l,p,v,w,C){const P=f.context,L=f.renderPass==="shadow",z=f.shadowRenderer,j=L&&z?z.getShadowPassDepthMode():new gn(P.gl.LEQUAL,gn.ReadWrite,f.depthRangeFor3D),H=f.isTileAffectedByFog(w);if(l.meshes)for(const $ of l.meshes){const q=["MODEL_POSITION_ON_GPU"],re=[];let te,oe,ne;p.instancedDataArray.length>20&&q.push("INSTANCED_ARRAYS");const ye=Qa(f,r.paint.get("model-cutoff-fade-range"));if(ye.shouldRenderCutoff&&q.push("RENDER_CUTOFF"),L&&z)te=f.getOrCreateProgram("modelDepth",{defines:q}),oe=_m(C.shadowTileMatrix,C.shadowTileMatrix,Float32Array.from(l.matrix)),ne=z.getShadowPassColorMode();else{Xt(q,re,$,f,r.paint.get("model-color-use-theme").constantOr("default")==="none"?null:r.lut),te=f.getOrCreateProgram("model",{defines:q,overrideFog:H});const Te=$.material,ke=Te.pbrMetallicRoughness,De=r.paint.get("model-opacity").constantOr(1),Me=r.paint.get("model-emissive-strength").constantOr(0);oe=Ol(w.expandedProjMatrix,Float32Array.from(l.matrix),new Float32Array(16),null,f,De,ke.baseColorFactor.toRenderColor(null),Te.emissiveFactor,ke.metallicFactor,ke.roughnessFactor,Te,Me,r,v),z&&(C.shadowUniformsInitialized?te.setShadowUniformValues(P,z.getShadowUniformValues()):(z.setupShadows(w.toUnwrapped(),te,"model-tile",w.overscaledZ),C.shadowUniformsInitialized=!0)),ne=ye.shouldRenderCutoff||De<1||Te.alphaMode!=="OPAQUE"?or.alphaBlended:or.unblended}f.uploadCommonUniforms(P,te,w.toUnwrapped(),null,ye);const Se=$.material.doubleSided?Bn.disabled:Bn.backCCW;if(p.instancedDataArray.length>20)re.push(p.instancedDataBuffer),te.draw(f,P.gl.TRIANGLES,j,zn.disabled,ne,Se,oe,r.id,$.vertexBuffer,$.indexBuffer,$.segments,r.paint,f.transform.zoom,void 0,re,p.instancedDataArray.length);else{const Te=L?"u_instance":"u_normal_matrix";for(let ke=0;ke<p.instancedDataArray.length;++ke)oe[Te]=new Float32Array(p.instancedDataArray.arrayBuffer,64*ke,16),te.draw(f,P.gl.TRIANGLES,j,zn.disabled,ne,Se,oe,r.id,$.vertexBuffer,$.indexBuffer,$.segments,r.paint,f.transform.zoom,void 0,re)}}if(l.children)for(const $ of l.children)Ko(f,r,$,p,v,w,C)}const ed=[1,-1,1];function Qf(f,r,l,p){if(!l.modelManager)return!0;const v=l.modelManager;if(!l.shadowRenderer)return!0;const w=l.shadowRenderer,C=r.aabb;let P=!0,L=f.maxHeight;if(L===0){let j=0;for(const H in f.instancesPerModel){const $=v.getModel(H,p);$?j=Math.max(j,Math.max(Math.max($.aabb.max[0],$.aabb.max[1]),$.aabb.max[2])):P=!1}L=f.maxScale*j*1.41+f.maxVerticalOffset,P&&(f.maxHeight=L)}C.max[2]=L,C.min[2]+=f.terrainElevationMin,C.max[2]+=f.terrainElevationMax,i.ad(C.min,C.min,r.tileMatrix),i.ad(C.max,C.max,r.tileMatrix);const z=C.intersects(w.getCurrentCascadeFrustum());return l.currentShadowCascade===0&&(f.isInsideFirstShadowMapFrustum=z===2),z===0}function ep(f,r){const l=f.uniformValues.u_cutoff_params[0],p=f.uniformValues.u_cutoff_params[1],v=f.uniformValues.u_cutoff_params[2],w=f.uniformValues.u_cutoff_params[3];return p===l||w===v?1:i.aD(((r-l)/(p-l)-v)/(w-v),0,1)}function td(f,r,l,p){if(r.pitch<20)return 1;const v=r.getWorldToCameraMatrix();i.az(v,v,f);const w=i.ei(l.min[0],l.min[1],l.min[2],1);let C=i.aA(i.ej(),w,v),P=C,L=C;w[1]=l.max[1],C=i.aA(i.ej(),w,v),P=C[1]<P[1]?C:P,L=C[1]>L[1]?C:L,w[0]=l.max[0],C=i.aA(i.ej(),w,v),P=C[1]<P[1]?C:P,L=C[1]>L[1]?C:L,w[1]=l.min[1],C=i.aA(i.ej(),w,v),P=C[1]<P[1]?C:P,L=C[1]>L[1]?C:L;const z=i.aD(p[0],0,1),j=100*r.pixelsPerMeter*i.aD(p[1],0,1),H=i.aD(p[2],0,1),$=i.ek(i.ej(),P,L,z),q=Math.tan(.5*r.fovX),re=-$[2]*q;if(j===0)return $[1]<-Math.abs(re)?H:1;const te=(-Math.abs(re)-$[1])/j,oe=(ye,Se,Te)=>(1-Te)*ye+Te*Se,ne=i.aD(oe(1,H,te),H,1);return oe(1,ne,i.aD((r.pitch-20)/20,0,1))}class Pg{}class Ag{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(r,l,p){{const H=this._storage.get(l.id);if(H)return H.lastUsedFrameIdx=r,H.buf}const v=p.gl,w=v.getBufferParameter(v.ELEMENT_ARRAY_BUFFER,v.BUFFER_SIZE),C=new ArrayBuffer(w),P=new Int16Array(C);v.getBufferSubData(v.ELEMENT_ARRAY_BUFFER,0,new Int16Array(C));const L=new i.en;for(let H=0;H<w/2;H+=3){const $=P[H],q=P[H+1],re=P[H+2];L.emplaceBack($,q),L.emplaceBack(q,re),L.emplaceBack(re,$)}const z=p.bindVertexArrayOES.current,j=new Pg;return j.buf=new nl(p,L),j.lastUsedFrameIdx=r,this._storage.set(l.id,j),p.bindVertexArrayOES.set(z),j.buf}update(r){for(const[l,p]of this._storage)r-p.lastUsedFrameIdx>30&&(p.buf.destroy(),this._storage.delete(l))}destroy(){for(const[r,l]of this._storage)l.buf.destroy(),this._storage.delete(r)}}class bm{constructor(r){this.occluderSize=30,this.depthOffset=-1e-4,r.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),r.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const rf=i.d_([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class tp{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class np{constructor(r,l){this.revealStart=11,this.revealRange=2,r.registerParameter(this,[...l,"Reveal"],"revealStart",{min:0,max:17,step:.05}),r.registerParameter(this,[...l,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const wm=i.d_([{type:"Float32",name:"a_pos_2f",components:2}]);class su{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(r,l){const p=r.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const C=new i.eo,P=new i.a_;C.emplaceBack(-1,-1),C.emplaceBack(1,-1),C.emplaceBack(1,1),C.emplaceBack(-1,1),P.emplaceBack(0,1,2),P.emplaceBack(0,2,3),this.vignetteVx=r.context.createVertexBuffer(C,wm.members),this.vignetteIdx=r.context.createIndexBuffer(P)}const v=i.bd.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){r.uploadCommonUniforms(r.context,p);const C={u_vignetteShape:(w={vignetteShape:[l.start,l.range,Math.pow(10,l.fadePower)],vignetteColor:[l.color.r,l.color.g,l.color.b,l.color.a*l.strength]}).vignetteShape,u_vignetteColor:w.vignetteColor};p.draw(r,r.context.gl.TRIANGLES,gn.disabled,zn.disabled,or.alphaBlended,Bn.disabled,C,"vignette",this.vignetteVx,this.vignetteIdx,v)}var w}}class Jd{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(r,l){const p=r.getFreeCameraOptions().position,v=p.toAltitude(),w=p.toLngLat(),C=i.al(w.lng),P=i.al(w.lat),L=r.pixelsPerMeter/l,z=C*i.eq,j=i.eq*Math.log(Math.tan(Math.PI/4+P/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const H=-this._offsetYPrev+j,$=-this._elevationPrev+v;this._accumulatedOffsetX+=(-this._offsetXPrev+z)*L,this._accumulatedOffsetY+=H*L,this._accumulatedElevation+=$*L,this._offsetXPrev=z,this._offsetYPrev=j,this._elevationPrev=v}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function Bl(f,r){return[-(f[0]-Math.floor(f[0]/r)*r),-(f[1]-Math.floor(f[1]/r)*r),-(f[2]-Math.floor(f[2]/r)*r)]}function Qd(f){const r=i.ea(1323123451230),l=[];for(let p=0;p<f;++p){const v=2*r()-1,w=2*r()-1,C=2*r()-1;l.push(i.cS(v,w,C))}return l}function Cc(f,r,l,p,v){const w=i.aD((v-l)/(p-l),0,1);return(1-w)*f+w*r}class po{constructor(r){this._movement=new Jd,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new su,this._ppmScaleFactor=r}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(r,l){const p=r.transform;this._movement.update(p,this._ppmScaleFactor);const v=p.starsProjMatrix,w=i.bY([]);i.b_(w,w,i.al(90)-p._pitch),i.bZ(w,w,-p.angle);const C=i.c3(new Float32Array(16),w),P=i.ep(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),L=i.ee([],P),z=i.az([],L,C),j=Date.now()/1e3;return this._accumulatedTimeFromStart+=(j-this._prevTime)*l,this._prevTime=j,{projectionMatrix:v,modelviewMatrix:z}}}class Rg extends po{constructor(r){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new np(r.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(r){const l=r.context;if(!this.particlesVx){const p=Qd(this.particlesCount),v=new i.er,w=new i.a_;let C=0;const P=i.ea(1323123451230);for(let L=0;L<p.length;++L){const z=p[L],j=[2*P()-1,P(),P(),P()];v.emplaceBack(z[0],z[1],z[2],-1,-1,...j),v.emplaceBack(z[0],z[1],z[2],1,-1,...j),v.emplaceBack(z[0],z[1],z[2],1,1,...j),v.emplaceBack(z[0],z[1],z[2],-1,1,...j),w.emplaceBack(C+0,C+1,C+2),w.emplaceBack(C+0,C+2,C+3),C+=4}this.particlesVx=l.createVertexBuffer(v,rf.members),this.particlesIdx=l.createIndexBuffer(w)}}draw(r){if(!this._params.overrideStyleParameters&&!r.style.rain)return;const l=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},p=r.transform.zoom;if(l.revealStart>p)return;const v=Cc(0,1,l.revealStart,l.revealStart+l.revealRange,p);if(!this.particlesVx||!this.particlesIdx)return;const w=structuredClone(this._params);let C=[-w.direction.x,w.direction.y,-100];i.au(C,C);const P=structuredClone(this._vignetteParams);P.strength*=v,w.overrideStyleParameters||(w.intensity=r.style.rain.state.density,w.timeFactor=r.style.rain.state.intensity,w.color=structuredClone(r.style.rain.state.color),C=structuredClone(r.style.rain.state.direction),w.screenThinning.intensity=r.style.rain.state.centerThinning,w.dropletSizeX=r.style.rain.state.dropletSize[0],w.dropletSizeYScale=r.style.rain.state.dropletSize[1]/r.style.rain.state.dropletSize[0],w.distortionStrength=100*r.style.rain.state.distortionStrength,P.strength=1,P.color=structuredClone(r.style.rain.state.vignetteColor));const L=this.updateOnRender(r,w.timeFactor),z=r.context,j=z.gl,H=r.transform;this.screenTexture&&this.screenTexture.size[0]===r.width&&this.screenTexture.size[1]===r.height||(this.screenTexture=new i.T(z,{width:r.width,height:r.height,data:null},j.RGBA8)),w.distortionStrength>0&&(z.activeTexture.set(j.TEXTURE0),this.screenTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),j.copyTexSubImage2D(j.TEXTURE_2D,0,0,0,0,0,r.width,r.height));const $=r.getOrCreateProgram("rainParticle");r.uploadCommonUniforms(z,$),z.activeTexture.set(j.TEXTURE0),this.screenTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE);const q=[w.color.r,w.color.g,w.color.b,w.color.a],re=(te,oe)=>{const ne=Bl(this._movement.getPosition(),te),ye=w.dropletSizeX,Se=w.dropletSizeX*w.dropletSizeYScale,Te=r.width/2,ke=r.height/2,De=Cc(0,w.screenThinning.start,0,1,w.screenThinning.intensity),Me=Cc(.001,w.screenThinning.range,0,1,w.screenThinning.intensity),Pe=Cc(0,w.screenThinning.particleOffset,0,1,w.screenThinning.intensity),Oe=(Ne={modelview:L.modelviewMatrix,projection:L.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:ne,velocityConeAperture:w.velocityConeAperture,velocity:w.velocity,boxSize:te,rainDropletSize:[ye,Se],distortionStrength:w.distortionStrength,rainDirection:C,color:q,screenSize:[H.width,H.height],thinningCenterPos:[Te,ke],thinningShape:[De,Me,Math.pow(10,w.screenThinning.fadePower)],thinningAffectedRatio:w.screenThinning.affectedRatio,thinningParticleOffset:Pe,shapeDirectionalPower:w.shapeDirPower,shapeNormalPower:w.shapeNormalPower,mode:oe?0:1},{u_modelview:Float32Array.from(Ne.modelview),u_projection:Float32Array.from(Ne.projection),u_time:Ne.time,u_cam_pos:Ne.camPos,u_texScreen:0,u_velocityConeAperture:Ne.velocityConeAperture,u_velocity:Ne.velocity,u_boxSize:Ne.boxSize,u_rainDropletSize:Ne.rainDropletSize,u_distortionStrength:Ne.distortionStrength,u_rainDirection:Ne.rainDirection,u_color:Ne.color,u_screenSize:Ne.screenSize,u_thinningCenterPos:Ne.thinningCenterPos,u_thinningShape:Ne.thinningShape,u_thinningAffectedRatio:Ne.thinningAffectedRatio,u_thinningParticleOffset:Ne.thinningParticleOffset,u_shapeDirectionalPower:Ne.shapeDirectionalPower,u_shapeNormalPower:Ne.shapeNormalPower,u_mode:Ne.mode});var Ne;const ht=Math.round(w.intensity*this.particlesCount),rt=i.bd.simpleSegment(0,0,4*ht,2*ht);$.draw(r,j.TRIANGLES,gn.disabled,zn.disabled,or.alphaBlended,Bn.disabled,Oe,"rain_particles",this.particlesVx,this.particlesIdx,rt)};w.distortionStrength>0&&re(w.boxSize,!0),re(w.boxSize,!1),this._vignette.draw(r,P)}}const eh=i.d_([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class Ii extends po{constructor(r){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new np(r.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(r){const l=r.context;if(!this.particlesVx){const p=Qd(this.particlesCount),v=new i.es,w=new i.a_;let C=0;const P=i.ea(1323123451230);for(let L=0;L<p.length;++L){const z=p[L],j=P(),H=P(),$=P(),q=[L/p.length,j,H,$],re=[P(),P()];v.emplaceBack(z[0],z[1],z[2],-1,-1,...q,...re),v.emplaceBack(z[0],z[1],z[2],1,-1,...q,...re),v.emplaceBack(z[0],z[1],z[2],1,1,...q,...re),v.emplaceBack(z[0],z[1],z[2],-1,1,...q,...re),w.emplaceBack(C+0,C+1,C+2),w.emplaceBack(C+0,C+2,C+3),C+=4}this.particlesVx=l.createVertexBuffer(v,eh.members),this.particlesIdx=l.createIndexBuffer(w)}}draw(r){if(!this._params.overrideStyleParameters&&!r.style.snow)return;const l=structuredClone(this._params);let p=[-l.direction.x,l.direction.y,-100];i.au(p,p);const v=structuredClone(this._vignetteParams),w=l.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},C=r.transform.zoom;if(w.revealStart>C)return;const P=Cc(0,1,w.revealStart,w.revealStart+w.revealRange,C);v.strength*=P,l.overrideStyleParameters||(l.intensity=r.style.snow.state.density,l.timeFactor=r.style.snow.state.intensity,l.color=structuredClone(r.style.snow.state.color),p=structuredClone(r.style.snow.state.direction),l.screenThinning.intensity=r.style.snow.state.centerThinning,l.billboardSize=2.79*r.style.snow.state.flakeSize,v.strength=1,v.color=structuredClone(r.style.snow.state.vignetteColor));const L=this.updateOnRender(r,l.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const z=r.context,j=z.gl,H=r.transform,$=r.getOrCreateProgram("snowParticle");r.uploadCommonUniforms(z,$),((q,re,te)=>{const oe=Bl(this._movement.getPosition(),q),ne=H.width/2,ye=H.height/2,Se=Cc(0,te.screenThinning.start,0,1,te.screenThinning.intensity),Te=Cc(.001,te.screenThinning.range,0,1,te.screenThinning.intensity),ke=Cc(0,te.screenThinning.particleOffset,0,1,te.screenThinning.intensity),De=(Me={modelview:L.modelviewMatrix,projection:L.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:oe,velocityConeAperture:te.velocityConeAperture,velocity:te.velocity,horizontalOscillationRadius:te.horizontalOscillationRadius,horizontalOscillationRate:te.horizontalOscillationRate,boxSize:q,billboardSize:1*te.billboardSize,simpleShapeParameters:[te.shapeFadeStart,te.shapeFadePower],screenSize:[H.width,H.height],thinningCenterPos:[ne,ye],thinningShape:[Se,Te,Math.pow(10,te.screenThinning.fadePower)],thinningAffectedRatio:te.screenThinning.affectedRatio,thinningParticleOffset:ke,color:[te.color.r,te.color.g,te.color.b,te.color.a],direction:p},{u_modelview:Float32Array.from(Me.modelview),u_projection:Float32Array.from(Me.projection),u_time:Me.time,u_cam_pos:Me.camPos,u_velocityConeAperture:Me.velocityConeAperture,u_velocity:Me.velocity,u_horizontalOscillationRadius:Me.horizontalOscillationRadius,u_horizontalOscillationRate:Me.horizontalOscillationRate,u_boxSize:Me.boxSize,u_billboardSize:Me.billboardSize,u_simpleShapeParameters:Me.simpleShapeParameters,u_screenSize:Me.screenSize,u_thinningCenterPos:Me.thinningCenterPos,u_thinningShape:Me.thinningShape,u_thinningAffectedRatio:Me.thinningAffectedRatio,u_thinningParticleOffset:Me.thinningParticleOffset,u_particleColor:Me.color,u_direction:Me.direction});var Me;const Pe=Math.round(te.intensity*this.particlesCount),Oe=i.bd.simpleSegment(0,0,4*Pe,2*Pe);this.particlesVx&&this.particlesIdx&&$.draw(r,j.TRIANGLES,gn.disabled,zn.disabled,or.alphaBlended,Bn.disabled,De,"snow_particles",this.particlesVx,this.particlesIdx,Oe)})(l.boxSize,0,l),this._vignette.draw(r,v)}}const Vr={symbol:function(f,r,l,p,v){if(f.renderPass!=="translucent")return;const w=zn.disabled,C=f.colorModeForRenderPass(),P=l.layout.get("text-variable-anchor"),L=l.layout.get("text-size-scale-range"),z=i.aD(f.scaleFactor,L[0],L[1]);P&&function($,q,re,te,oe,ne,ye,Se){const Te=q.transform,ke=oe==="map",De=ne==="map";for(const Me of $){const Pe=te.getTile(Me),Oe=Pe.getBucket(re);if(!Oe||!Oe.text||!Oe.text.segments.get().length)continue;const Ne=i.bH(Oe.textSizeData,Te.zoom,Se),ht=Du(Me,Oe.getProjection(),Te),rt=Te.calculatePixelsToTileUnitsMatrix(Pe),Tt=Sd(ht,Pe.tileID.canonical,De,ke,Te,Oe.getProjection(),rt),It=Oe.hasIconTextFit()&&Oe.hasIconData();Ne&&tu(Oe,ke,De,ye,Te,Tt,Me,Math.pow(2,Te.zoom-Pe.tileID.overscaledZ),Ne,It)}}(p,f,l,r,l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),v,z);const j=l.paint.get("icon-opacity").constantOr(1)!==0,H=l.paint.get("text-opacity").constantOr(1)!==0;l.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(j||H)?Kd(f,r,l,p,w,C):(j&&Kd(f,r,l,p,w,C,{onlyIcons:!0}),H&&Kd(f,r,l,p,w,C,{onlyText:!0})),r.map.showCollisionBoxes&&(rl(f,r,l,p,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),!0),rl(f,r,l,p,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),!1))},circle:function(f,r,l,p){if(f.renderPass!=="translucent")return;const v=l.paint.get("circle-opacity"),w=l.paint.get("circle-stroke-width"),C=l.paint.get("circle-stroke-opacity"),P=l.layout.get("circle-sort-key").constantOr(1)!==void 0,L=l.paint.get("circle-emissive-strength");if(v.constantOr(1)===0&&(w.constantOr(1)===0||C.constantOr(1)===0))return;const z=f.context,j=z.gl,H=f.transform,$=f.depthModeForSublayer(0,gn.ReadOnly),q=zn.disabled,re=f.colorModeForDrapableLayerRenderPass(L),te=H.projection.name==="globe",oe=[i.ay(H.center.lng),i.aH(H.center.lat)],ne=[];for(let Se=0;Se<p.length;Se++){const Te=p[Se],ke=r.getTile(Te),De=ke.getBucket(l);if(!De||De.projection.name!==H.projection.name)continue;const Me=De.programConfigurations.get(l.id),Pe=i.dK(l),Oe=f.isTileAffectedByFog(Te);te&&Pe.push("PROJECTION_GLOBE_VIEW"),Pe.push("DEPTH_D24"),f.terrain&&H.depthOcclusionForSymbolsAndCircles&&Pe.push("DEPTH_OCCLUSION");const Ne=f.getOrCreateProgram("circle",{config:Me,defines:Pe,overrideFog:Oe}),ht=De.layoutVertexBuffer,rt=De.globeExtVertexBuffer,Tt=De.indexBuffer,It=H.projection.createInversionMatrix(H,Te.canonical),Ht={programConfiguration:Me,program:Ne,layoutVertexBuffer:ht,globeExtVertexBuffer:rt,indexBuffer:Tt,uniformValues:i.dL(f,Te,ke,It,oe,l),tile:ke};if(P){const Qe=De.segments.get();for(const dt of Qe)ne.push({segments:new i.bd([dt]),sortKey:dt.sortKey,state:Ht})}else ne.push({segments:De.segments,sortKey:0,state:Ht})}P&&ne.sort((Se,Te)=>Se.sortKey-Te.sortKey);const ye={useDepthForOcclusion:H.depthOcclusionForSymbolsAndCircles};for(const Se of ne){const{programConfiguration:Te,program:ke,layoutVertexBuffer:De,globeExtVertexBuffer:Me,indexBuffer:Pe,uniformValues:Oe,tile:Ne}=Se.state,ht=Se.segments;f.terrain&&f.terrain.setupElevationDraw(Ne,ke,ye),f.uploadCommonUniforms(z,ke,Ne.tileID.toUnwrapped()),ke.draw(f,j.TRIANGLES,$,q,re,Bn.disabled,Oe,l.id,De,Pe,ht,l.paint,H.zoom,Te,[Me])}},heatmap:function(f,r,l,p){if(l.paint.get("heatmap-opacity")!==0)if(f.renderPass==="offscreen"){const v=f.context,w=v.gl,C=zn.disabled,P=new or([w.ONE,w.ONE,w.ONE,w.ONE],i.am.transparent,[!0,!0,!0,!0]);(function(q,re,te,oe){const ne=q.gl,ye=re.width*oe,Se=re.height*oe;q.activeTexture.set(ne.TEXTURE1),q.viewport.set([0,0,ye,Se]);let Te=te.heatmapFbo;if(!Te||Te&&(Te.width!==ye||Te.height!==Se)){Te&&Te.destroy();const ke=ne.createTexture();ne.bindTexture(ne.TEXTURE_2D,ke),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_WRAP_S,ne.CLAMP_TO_EDGE),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_WRAP_T,ne.CLAMP_TO_EDGE),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_MIN_FILTER,ne.LINEAR),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_MAG_FILTER,ne.LINEAR),Te=te.heatmapFbo=q.createFramebuffer(ye,Se,!0,null),function(De,Me,Pe,Oe,Ne,ht){const rt=De.gl;rt.texImage2D(rt.TEXTURE_2D,0,De.extRenderToTextureHalfFloat?rt.RGBA16F:rt.RGBA,Ne,ht,0,rt.RGBA,De.extRenderToTextureHalfFloat?rt.HALF_FLOAT:rt.UNSIGNED_BYTE,null),Oe.colorAttachment.set(Pe)}(q,0,ke,Te,ye,Se)}else ne.bindTexture(ne.TEXTURE_2D,Te.colorAttachment.get()),q.bindFramebuffer.set(Te.framebuffer)})(v,f,l,f.transform.projection.name==="globe"?.5:.25),v.clear({color:i.am.transparent});const L=f.transform,z=L.projection.name==="globe",j=z?["PROJECTION_GLOBE_VIEW"]:[],H=z?Bn.frontCCW:Bn.disabled,$=[i.ay(L.center.lng),i.aH(L.center.lat)];for(let q=0;q<p.length;q++){const re=p[q];if(r.hasRenderableParent(re))continue;const te=r.getTile(re),oe=te.getBucket(l);if(!oe||oe.projection.name!==L.projection.name)continue;const ne=f.isTileAffectedByFog(re),ye=oe.programConfigurations.get(l.id),Se=f.getOrCreateProgram("heatmap",{config:ye,defines:j,overrideFog:ne}),{zoom:Te}=f.transform;f.terrain&&f.terrain.setupElevationDraw(te,Se),f.uploadCommonUniforms(v,Se,re.toUnwrapped());const ke=L.projection.createInversionMatrix(L,re.canonical);Se.draw(f,w.TRIANGLES,gn.disabled,C,P,H,Dl(f,re,te,ke,$,Te,l.paint.get("heatmap-intensity")),l.id,oe.layoutVertexBuffer,oe.indexBuffer,oe.segments,l.paint,f.transform.zoom,ye,z?[oe.globeExtVertexBuffer]:null)}v.viewport.set([0,0,f.width,f.height])}else f.renderPass==="translucent"&&(f.context.setColorMode(f.colorModeForRenderPass()),function(v,w){const C=v.context,P=C.gl,L=w.heatmapFbo;if(!L)return;C.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,L.colorAttachment.get()),C.activeTexture.set(P.TEXTURE1);let z=w.colorRampTexture;z||(z=w.colorRampTexture=new i.T(C,w.colorRamp,P.RGBA8)),z.bind(P.LINEAR,P.CLAMP_TO_EDGE),v.getOrCreateProgram("heatmapTexture").draw(v,P.TRIANGLES,gn.disabled,zn.disabled,v.colorModeForRenderPass(),Bn.disabled,((j,H,$,q)=>({u_image:0,u_color_ramp:1,u_opacity:H.paint.get("heatmap-opacity")}))(0,w),w.id,v.viewportBuffer,v.quadTriangleIndexBuffer,v.viewportSegments,w.paint,v.transform.zoom)}(f,l))},line:function(f,r,l,p){if(f.renderPass!=="translucent")return;const v=l.paint.get("line-opacity"),w=l.paint.get("line-width");if(v.constantOr(1)===0||w.constantOr(1)===0)return;const C=l.paint.get("line-emissive-strength"),P=l.paint.get("line-occlusion-opacity"),L=l.layout.get("line-elevation-reference"),z=l.layout.get("line-width-unit")==="meters",j=L==="sea",H=!(!f.terrain||!f.terrain.enabled),$=f.context,q=$.gl;if(l.hasElevatedBuckets&&f.transform.projection.name==="globe")return;const re=l.layout.get("line-cross-slope"),te=re!==void 0,oe=re<1,ne=f.colorModeForDrapableLayerRenderPass(C),ye=f.terrain&&f.terrain.renderingToTexture,Se=ye?1:i.q.devicePixelRatio,Te=l.paint.get("line-dasharray"),ke=Te.constantOr(1),De=l.layout.get("line-cap"),Me=Te.constantOr(null),Pe=De.constantOr(null),Oe=l.paint.get("line-pattern"),Ne=Oe.constantOr(1),ht=l.paint.get("line-pattern-cross-fade"),rt=Oe.constantOr(null),Tt=l.paint.get("line-opacity").constantOr(1);let It=!Ne&&Tt!==1||f.depthOcclusion&&P>0&&P<1;const Ht=l.paint.get("line-gradient"),Qe=Ne?"linePattern":"line",dt=i.dM(l);let Je;if(ye&&f.terrain&&f.terrain.clipOrMaskOverlapStencilType()&&(It=!1),P!==0&&f.depthOcclusion){const Mt=l.paint._values["line-opacity"];Mt&&Mt.value&&Mt.value.kind==="constant"?Je=Mt.value:i.w(`Occlusion opacity for layer ${l.id} is supported only when line-opacity isn't data-driven.`)}w.value.kind!=="constant"&&w.value.isLineProgressConstant===!1&&dt.push("VARIABLE_LINE_WIDTH");const Dt=(Mt,Nt,Vt,pn,bn,rn)=>{for(const vn of Mt){const dn=r.getTile(vn);if(Ne&&!dn.patternsLoaded())continue;const Rn=dn.getBucket(l);if(!Rn||Rn.elevationType!=="none"&&!bn||Rn.elevationType==="none"&&bn)continue;f.prepareDrawTile();const Hn=[...Nt],dr=f.shadowRenderer,ri=Rn.elevationType==="road"&&!!dr&&dr.enabled;let ii=[0,0,0];if(ri){const nr=f.style.directionalLight,Si=f.style.ambientLight;nr&&Si&&(ii=Ia(f.style,nr,Si)),Hn.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET")}const tr=Rn.programConfigurations.get(l.id);let Hi=!1;if(rt&&dn.imageAtlas){const nr=i.dN.from(rt),Si=nr.getPrimary().scaleSelf(Se).toString(),zr=dn.imageAtlas.patternPositions.get(Si),ai=nr.getSecondary(),Xr=ai?dn.imageAtlas.patternPositions.get(ai.scaleSelf(Se).toString()):null;Hi=!!zr&&!!Xr,zr&&tr.setConstantPatternPositions(zr,Xr)}ht>0&&(Hi||tr.getPatternTransitionVertexBuffer("line-pattern"))&&Hn.push("LINE_PATTERN_TRANSITION");const Pi=f.isTileAffectedByFog(vn),Gn=f.getOrCreateProgram(Qe,{config:tr,defines:Hn,overrideFog:Pi,overrideRtt:!bn&&void 0});if(!Ne&&Me&&Pe&&dn.lineAtlas){const nr=dn.lineAtlas.getDash(Me,Pe);nr&&tr.setConstantPatternPositions(nr)}ri&&dr.setupShadows(dn.tileID.toUnwrapped(),Gn,"vector-tile",dn.tileID.overscaledZ);let[Cr,Tr]=l.paint.get("line-trim-offset");(Pe==="round"||Pe==="square")&&Cr!==Tr&&(Cr===0&&(Cr-=1),Tr===1&&(Tr+=1));const si=ye?vn.projMatrix:null,ys=z?1/Rn.tileToMeter/i.aw(dn,1,f.transform.zoom):1,Gi=z?1/Rn.tileToMeter/i.aw(dn,1,Math.floor(f.transform.zoom)):1,ns=Ne?i.dO(f,dn,l,si,Se,ys,Gi,[Cr,Tr],ii,ht):i.dP(f,dn,l,si,Rn.lineClipsArray.length,Se,ys,Gi,[Cr,Tr],ii);if(Ht){const nr=Rn.gradients[l.id];let Si=nr.texture;if(l.gradientVersion!==nr.version){let zr=256;if(l.stepInterpolant){const ai=r.getSource().maxzoom,Xr=vn.canonical.z===ai?Math.ceil(1<<f.transform.maxZoom-vn.canonical.z):1;zr=i.aD(i.dQ(Rn.maxLineLength/i.aj*1024*Xr),256,$.maxTextureSize)}nr.gradient=i.dR({expression:l.gradientExpression(),evaluationKey:"lineProgress",resolution:zr,image:nr.gradient||void 0,clips:Rn.lineClipsArray}),nr.texture?nr.texture.update(nr.gradient):nr.texture=new i.T($,nr.gradient,q.RGBA8),nr.version=l.gradientVersion,Si=nr.texture}$.activeTexture.set(q.TEXTURE1),Si.bind(l.stepInterpolant?q.NEAREST:q.LINEAR,q.CLAMP_TO_EDGE)}ke&&($.activeTexture.set(q.TEXTURE0),dn.lineAtlasTexture&&dn.lineAtlasTexture.bind(q.LINEAR,q.REPEAT),tr.updatePaintBuffers()),Ne&&($.activeTexture.set(q.TEXTURE0),dn.imageAtlasTexture&&dn.imageAtlasTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE),tr.updatePaintBuffers()),bn&&!j&&f.terrain.setupElevationDraw(dn,Gn),f.uploadCommonUniforms($,Gn,vn.toUnwrapped());const Oi=nr=>{Je!=null&&(Je.value=Tt*P),Gn.draw(f,q.TRIANGLES,Vt,nr,ne,Bn.disabled,ns,l.id,Rn.layoutVertexBuffer,Rn.indexBuffer,Rn.segments,l.paint,f.transform.zoom,tr,[Rn.layoutVertexBuffer2,Rn.patternVertexBuffer,Rn.zOffsetVertexBuffer]),Je!=null&&(Je.value=Tt)};if(It&&!bn){const nr=f.stencilModeForClipping(vn).ref;nr===0&&ye&&$.clear({stencil:0});const Si={func:q.EQUAL,mask:255};ns.u_alpha_discard_threshold=.8,Oi(new zn(Si,nr,255,q.KEEP,q.KEEP,q.INVERT)),ns.u_alpha_discard_threshold=0,Oi(new zn(Si,nr,255,q.KEEP,q.KEEP,q.KEEP))}else ns.u_alpha_discard_threshold=It&&bn&&rn?.8:0,Oi(bn?pn:f.stencilModeForClipping(vn))}};let mt=f.depthModeForSublayer(0,gn.ReadOnly);const Ot=new gn(f.depthOcclusion?q.GREATER:q.LEQUAL,gn.ReadOnly,f.depthRangeFor3D);if(l.hasNonElevatedBuckets){const Mt=!ye&&f.terrain;P!==0&&Mt?i.w(`Occlusion opacity for layer ${l.id} is supported on terrain only if the layer has line-z-offset enabled.`):Mt?i.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${l.id}.`):Dt(p,dt,mt,zn.disabled,!1,!0)}if(l.hasElevatedBuckets){L==="hd-road-markup"?H||(mt=Ot,dt.push("ELEVATED_ROADS")):(dt.push("ELEVATED"),mt=Ot,te&&dt.push(oe?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),j&&dt.push("ELEVATION_REFERENCE_SEA"));const Mt=It?f.stencilModeFor3D():zn.disabled;f.forceTerrainMode=!0,Dt(p,dt,mt,Mt,!0,!0),It&&Dt(p,dt,mt,Mt,!0,!1),f.forceTerrainMode=!1}It&&(f.resetStencilClippingMasks(),ye&&$.clear({stencil:0})),P===0||f.depthOcclusion||ye||f.layersWithOcclusionOpacity.push(f.currentLayer)},fill:function(f,r,l,p){const v=l.paint.get("fill-color"),w=l.paint.get("fill-opacity");if(w.constantOr(1)===0)return;const C=l.paint.get("fill-emissive-strength"),P=f.colorModeForDrapableLayerRenderPass(C),L=l.paint.get("fill-pattern"),z=f.opaquePassEnabledForLayer()&&!L.constantOr(1)&&v.constantOr(i.am.transparent).a===1&&w.constantOr(0)===1?"opaque":"translucent";let j="none";l.layout.get("fill-elevation-reference")!=="none"?j="road":l.paint.get("fill-z-offset").constantOr(1)!==0&&(j="offset");const H=!(!f.terrain||!f.terrain.enabled),$={painter:f,sourceCache:r,layer:l,coords:p,colorMode:P,elevationType:j,terrainEnabled:H,pass:z};if(f.renderPass!=="shadow")if(j!=="offset"){if(un($,!1),j==="road"){const q=!H&&f.renderPass==="translucent";q&&Ku(f,r,l,p,"geometry"),un($,!0,zn.disabled),q&&function(re){const{painter:te,sourceCache:oe,layer:ne,coords:ye,colorMode:Se}=re,Te=te.context.gl,ke=re.painter.shadowRenderer,De=!!ke&&ke.enabled,Me=new gn(te.context.gl.LEQUAL,gn.ReadOnly,te.depthRangeFor3D);let Pe=[0,0,0];if(De){const Oe=te.style.directionalLight,Ne=te.style.ambientLight;Oe&&Ne&&(Pe=Ia(te.style,Oe,Ne))}for(const Oe of ye){const Ne=oe.getTile(Oe),ht=Ne.getBucket(ne);if(!ht)continue;const rt=ht.elevatedStructures;if(!rt||!rt.renderableSegments||rt.renderableSegments.segments[0].primitiveLength===0)continue;te.prepareDrawTile();const Tt=ht.bufferData.programConfigurations.get(ne.id),It=te.isTileAffectedByFog(Oe),Ht=[];De&&Ht.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET");const Qe=te.getOrCreateProgram("elevatedStructures",{config:Tt,overrideFog:It,defines:Ht}),dt=te.translatePosMatrix(Oe.projMatrix,Ne,ne.paint.get("fill-translate"),ne.paint.get("fill-translate-anchor"));De&&ke.setupShadows(Ne.tileID.toUnwrapped(),Qe,"vector-tile",Ne.tileID.overscaledZ);const Je=Wd(dt,Pe);te.uploadCommonUniforms(te.context,Qe,Oe.toUnwrapped()),Qe.draw(te,Te.TRIANGLES,Me,zn.disabled,Se,Bn.backCCW,Je,ne.id,rt.vertexBuffer,rt.indexBuffer,rt.renderableSegments,ne.paint,te.transform.zoom,Tt,[rt.vertexBufferNormal])}}($)}}else un($,!1,f.stencilModeFor3D());else f.shadowRenderer&&j==="road"&&!H&&function(q){const{painter:re,sourceCache:te,layer:oe,coords:ne}=q,ye=re.context.gl,Se=q.painter.shadowRenderer;for(const Te of ne){const ke=te.getTile(Te),De=ke.getBucket(oe);if(!De)continue;const Me=De.elevatedStructures;if(!Me||!Me.shadowCasterSegments||Me.shadowCasterSegments.segments[0].primitiveLength===0)continue;re.prepareDrawTile();const Pe=De.bufferData.programConfigurations.get(oe.id),Oe=re.isTileAffectedByFog(Te),Ne=re.getOrCreateProgram("elevatedStructuresDepth",{config:Pe,overrideFog:Oe}),ht=Se.calculateShadowPassMatrixFromTile(ke.tileID.toUnwrapped());re.uploadCommonUniforms(re.context,Ne,Te.toUnwrapped());const rt={u_matrix:ht,u_depth_bias:.001};Ne.draw(re,ye.TRIANGLES,Se.getShadowPassDepthMode(),zn.disabled,Se.getShadowPassColorMode(),Bn.disabled,rt,oe.id,Me.vertexBuffer,Me.indexBuffer,Me.shadowCasterSegments,oe.paint,re.transform.zoom,Pe)}}($)},"fill-extrusion":function(f,r,l,p){const v=l.paint.get("fill-extrusion-opacity"),w=f.context,C=w.gl,P=f.terrain,L=P&&P.renderingToTexture;if(v===0)return;const z=f.conflationActive&&f.style.isLayerClipped(l,r.getSource()),j=f.style.order.indexOf(l.fqid);if(z&&function(H,$,q,re,te){for(const oe of re){const ne=$.getTile(oe).getBucket(q);ne&&(ne.updateReplacement(oe,H.replacementSource,te),ne.uploadCentroid(H.context))}}(f,r,l,p,j),P||z)for(const H of p){const $=r.getTile(H).getBucket(l);$&&zl(f.context,r,H,$,l,P,z)}if(f.renderPass==="shadow"&&f.shadowRenderer){const H=f.shadowRenderer;if(P&&v<.65&&l._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof i.ab)return;const $=H.getShadowPassDepthMode(),q=H.getShadowPassColorMode();jo(f,r,l,p,$,zn.disabled,q,z)}else if(f.renderPass==="translucent"){const H=!l.paint.get("fill-extrusion-pattern").constantOr(1),$=l.paint.get("fill-extrusion-color").constantOr(i.am.white);if(!L&&$.a!==0){const q=new gn(f.context.gl.LEQUAL,gn.ReadWrite,f.depthRangeFor3D);v===1&&H?jo(f,r,l,p,q,zn.disabled,or.unblended,z):(jo(f,r,l,p,q,zn.disabled,or.disabled,z),jo(f,r,l,p,q,f.stencilModeFor3D(),f.colorModeForRenderPass(),z),f.resetStencilClippingMasks())}if(f.style.enable3dLights()&&H&&(!P&&f.transform.projection.name!=="globe"||L)){const q=l.paint.get("fill-extrusion-opacity"),re=l.paint.get("fill-extrusion-ambient-occlusion-intensity"),te=l.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),oe=l.paint.get("fill-extrusion-flood-light-intensity"),ne=l.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",ye=l.paint.get("fill-extrusion-flood-light-color").toRenderColor(ne?null:l.lut).toArray01().slice(0,3),Se=re>0&&te>0,Te=oe>0,ke=(Me,Pe,Oe)=>(1-Oe)*Me+Oe*Pe,De=Me=>{const Pe=f.depthModeForSublayer(1,gn.ReadOnly,C.LEQUAL,!0),Oe=l.paint.get(Me?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Ne=ke(.1,3,Oe),ht=f._showOverdrawInspector;if(!ht){const rt=new zn({func:C.ALWAYS,mask:255},255,255,C.KEEP,C.KEEP,C.REPLACE),Tt=new or([C.ONE,C.ONE,C.ONE,C.ONE],i.am.transparent,[!1,!1,!1,!0],C.MIN);ma(f,r,l,p,Pe,rt,Tt,Bn.disabled,Me,"sdf",q,re,te,oe,ye,Ne,z,!1)}{const rt=ht?zn.disabled:new zn({func:C.EQUAL,mask:255},255,255,C.KEEP,C.DECR,C.DECR),Tt=ht?f.colorModeForRenderPass():new or([C.ONE_MINUS_DST_ALPHA,C.DST_ALPHA,C.ONE,C.ONE],i.am.transparent,[!0,!0,!0,!0]);ma(f,r,l,p,Pe,rt,Tt,Bn.disabled,Me,"color",q,re,te,oe,ye,Ne,z,!1)}};if(L){const Me=(Pe,Oe,Ne)=>{const ht=f.depthModeForSublayer(1,gn.ReadOnly,C.LEQUAL,!1),rt=l.paint.get(Pe?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Tt=ke(.1,3,rt);{const It=new or([C.ONE,C.ONE,C.ONE,C.ONE],i.am.transparent,[!1,!1,!1,!0]);ma(f,r,l,p,ht,zn.disabled,It,Bn.disabled,Pe,"clear",q,re,te,oe,ye,Tt,z,Oe)}{const It=new zn({func:C.ALWAYS,mask:255},255,255,C.KEEP,C.KEEP,C.REPLACE),Ht=new or([C.ONE,C.ONE,C.ONE,C.ONE],i.am.transparent,[!1,!1,!1,!0],C.MIN);ma(f,r,l,p,ht,It,Ht,Bn.disabled,Pe,"sdf",q,re,te,oe,ye,Tt,z,Oe)}{const It=Pe?C.ZERO:C.ONE_MINUS_DST_ALPHA,Ht=new zn({func:C.EQUAL,mask:255},255,255,C.KEEP,C.DECR,C.DECR),Qe=new or([It,C.DST_ALPHA,C.ONE_MINUS_DST_ALPHA,C.ZERO],i.am.transparent,[!0,!0,!0,!0]);ma(f,r,l,p,ht,Ht,Qe,Bn.disabled,Pe,"color",q,re,te,oe,ye,Tt,z,Oe)}{const It=new or([C.ONE,C.ONE,C.ONE,Pe?C.ZERO:C.ONE],i.am.transparent,[!1,!1,!1,!0],Pe?C.FUNC_ADD:C.MAX);ma(f,r,l,p,ht,zn.disabled,It,Bn.disabled,Pe,"clear",q,re,te,oe,ye,Tt,z,Oe,Ne)}};if(Se||Te){let Pe;if(f.prepareDrawTile(),P){const Oe=P.drapeBufferSize[0],Ne=P.drapeBufferSize[1];Pe=P.framebufferCopyTexture,Pe&&(!Pe||Pe.size[0]===Oe&&Pe.size[1]===Ne)||(Pe&&Pe.destroy(),Pe=P.framebufferCopyTexture=new i.T(w,new i.r({width:Oe,height:Ne}),C.RGBA8)),Pe.bind(C.LINEAR,C.CLAMP_TO_EDGE),C.copyTexSubImage2D(C.TEXTURE_2D,0,0,0,0,0,Oe,Ne)}Se&&Me(!0,!1,Pe),Te&&Me(!1,!0,Pe)}}else Se&&De(!0),Te&&De(!1),(Se||Te)&&f.resetStencilClippingMasks()}}},hillshade:function(f,r,l,p){if(f.renderPass!=="offscreen"&&f.renderPass!=="translucent"||f.style.disableElevatedTerrain)return;const v=f.context,w=f.terrain&&f.terrain.renderingToTexture,[C,P]=f.renderPass!=="translucent"||w?[{},p]:f.stencilConfigForOverlap(p);for(const L of P){const z=r.getTile(L);if(z.needsHillshadePrepare&&f.renderPass==="offscreen")lm(f,z,l);else if(f.renderPass==="translucent"){const j=f.depthModeForSublayer(0,gn.ReadOnly),H=l.paint.get("hillshade-emissive-strength"),$=f.colorModeForDrapableLayerRenderPass(H),q=w&&f.terrain?f.terrain.stencilModeForRTTOverlap(L):C[L.overscaledZ];Cg(f,L,z,l,j,q,$)}}v.viewport.set([0,0,f.width,f.height]),f.resetStencilClippingMasks()},raster:function(f,r,l,p,v,w){if(f.renderPass!=="translucent"||l.paint.get("raster-opacity")===0)return;const C=f.transform.projection.name==="globe",P=l.paint.get("raster-elevation")!==0,L=P&&C;if(f.renderElevatedRasterBackface&&!L)return;const z=f.context,j=z.gl,H=r.getSource(),$=function(De,Me,Pe,Oe){const Ne=Me.paint.get("raster-color"),ht=De.type==="raster-array",rt=[],Tt=Me.paint.get("raster-resampling"),It=Me.paint.get("raster-color-mix");let Ht=Me.paint.get("raster-color-range");const Qe=[It[0],It[1],It[2],0],dt=It[3];let Je=Tt==="nearest"?Oe.NEAREST:Oe.LINEAR;if(ht&&(rt.push("RASTER_ARRAY"),Ne||rt.push("RASTER_COLOR"),Tt==="linear"&&rt.push("RASTER_ARRAY_LINEAR"),Je=Oe.NEAREST,!Ht&&De.rasterLayers)){const Dt=De.rasterLayers.find(({id:mt})=>mt===Me.sourceLayer);Dt&&Dt.fields&&Dt.fields.range&&(Ht=Dt.fields.range)}if(Ht=Ht||[0,1],Ne){rt.push("RASTER_COLOR"),Pe.activeTexture.set(Oe.TEXTURE2),Me.updateColorRamp(Ht);let Dt=Me.colorRampTexture;Dt||(Dt=Me.colorRampTexture=new i.T(Pe,Me.colorRamp,Oe.RGBA8)),Dt.bind(Oe.LINEAR,Oe.CLAMP_TO_EDGE)}return{mix:Qe,range:Ht,offset:dt,defines:rt,resampling:Je}}(H,l,z,j);if(H instanceof i.aP&&!p.length&&!C)return;const q=l.paint.get("raster-emissive-strength"),re=f.colorModeForDrapableLayerRenderPass(q),te=f.terrain&&f.terrain.renderingToTexture,oe=!f.options.moving,ne=l.paint.get("raster-resampling")==="nearest"?j.NEAREST:j.LINEAR;if(H instanceof i.aP&&!p.length&&(H.onNorthPole||H.onSouthPole)){const De=P?f.stencilModeFor3D():zn.disabled;return void ga(!!H.onNorthPole,null,f,r,l,q,$,Bn.disabled,De)}if(!p.length)return;const[ye,Se]=H instanceof i.aP||te?[{},p]:f.stencilConfigForOverlap(p),Te=Se[Se.length-1].overscaledZ;L&&$.defines.push("PROJECTION_GLOBE_VIEW"),P&&$.defines.push("RENDER_CUTOFF");const ke=(De,Me,Pe)=>{for(const Oe of De){const Ne=Oe.toUnwrapped(),ht=r.getTile(Oe);if(te&&(!ht||!ht.hasData()))continue;z.activeTexture.set(j.TEXTURE0);const rt=Yf(ht,H,l,$);if(!rt||!rt.texture)continue;const{texture:Tt,mix:It,offset:Ht,tileSize:Qe,buffer:dt}=rt;let Je,Dt;te?(Je=gn.disabled,Dt=Oe.projMatrix):P?(Je=new gn(j.LEQUAL,gn.ReadWrite,f.depthRangeFor3D),Dt=C?Float32Array.from(f.transform.expandedFarZProjMatrix):f.transform.calculateProjMatrix(Ne,oe)):(Je=f.depthModeForSublayer(Oe.overscaledZ-Te,l.paint.get("raster-opacity")===1?gn.ReadWrite:gn.ReadOnly,j.LESS),Dt=f.transform.calculateProjMatrix(Ne,oe));const mt=f.terrain&&te?f.terrain.stencilModeForRTTOverlap(Oe):ye[Oe.overscaledZ],Ot=w?0:l.paint.get("raster-fade-duration");ht.registerFadeDuration(Ot);const Mt=r.findLoadedParent(Oe,0),Nt=Ws(ht,Mt,r,f.transform,Ot);let Vt,pn;f.terrain&&f.terrain.prepareDrawTile(),z.activeTexture.set(j.TEXTURE0),Tt.bind(ne,j.CLAMP_TO_EDGE),z.activeTexture.set(j.TEXTURE1),Mt?(Mt.texture&&Mt.texture.bind(ne,j.CLAMP_TO_EDGE),Vt=Math.pow(2,Mt.tileID.overscaledZ-ht.tileID.overscaledZ),pn=[ht.tileID.canonical.x*Vt%1,ht.tileID.canonical.y*Vt%1]):Tt.bind(ne,j.CLAMP_TO_EDGE),"useMipmap"in Tt&&z.extTextureFilterAnisotropic&&f.transform.pitch>20&&j.texParameterf(j.TEXTURE_2D,z.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,z.extTextureFilterAnisotropicMax);const bn=f.transform;let rn;const vn=P?wc(bn):[0,0,0,0];let dn,Rn,Hn,dr,ri,ii=0;if(L&&H instanceof i.aP&&H.coordinates.length>3)dn=Float32Array.from(i.bh(i.dr(new i.cp(0,0,0)))),Rn=Float32Array.from(bn.globeMatrix),Hn=Float32Array.from(i.dm(bn)),dr=[i.ay(bn.center.lng),i.aH(bn.center.lat)],rn=H.elevatedGlobePerspectiveTransform,ri=H.elevatedGlobeGridMatrix||new Float32Array(9);else if(L){const Gn=i.dn(Oe.canonical);ii=i.dp(Gn.getCenter().lat),dn=Float32Array.from(i.bh(i.dr(Oe.canonical))),Rn=Float32Array.from(bn.globeMatrix),Hn=Float32Array.from(i.dm(bn)),dr=[i.ay(bn.center.lng),i.aH(bn.center.lat)],rn=[0,0],ri=Float32Array.from(i.dq(Oe.canonical,Gn,ii,bn.worldSize/bn._pixelsPerMercatorPixel))}else rn=H instanceof i.aP?H.perspectiveTransform:[0,0],dn=new Float32Array(16),Rn=new Float32Array(9),Hn=new Float32Array(16),dr=[0,0],ri=new Float32Array(9);const tr=kl(Dt,dn,Rn,Hn,ri,pn||[0,0],i.ah(f.transform.zoom),dr,vn,Vt||1,Nt,l,rn,P?l.paint.get("raster-elevation"):0,2,It,Ht,$.range,Qe,dt,q),Hi=f.isTileAffectedByFog(Oe),Pi=f.getOrCreateProgram("raster",{defines:$.defines,overrideFog:Hi});if(f.uploadCommonUniforms(z,Pi,Ne),H instanceof i.aP){const Gn=H.elevatedGlobeVertexBuffer,Cr=H.elevatedGlobeIndexBuffer;if(te||!C)H.boundsBuffer&&H.boundsSegments&&Pi.draw(f,j.TRIANGLES,Je,zn.disabled,re,Bn.disabled,tr,l.id,H.boundsBuffer,f.quadTriangleIndexBuffer,H.boundsSegments);else if(Gn&&Cr){const Tr=bn.zoom<=i.cL?H.elevatedGlobeSegments:H.getSegmentsForLongitude(bn.center.lng);Tr&&Pi.draw(f,j.TRIANGLES,Je,zn.disabled,re,Me,tr,l.id,Gn,Cr,Tr)}}else if(L){Je=new gn(j.LEQUAL,gn.ReadOnly,f.depthRangeFor3D);const Gn=f.globeSharedBuffers;if(Gn){const[Cr,Tr,si]=Gn.getGridBuffers(ii,!1);Pi.draw(f,j.TRIANGLES,Je,Pe||mt,f.colorModeForRenderPass(),Me,tr,l.id,Cr,Tr,si)}}else{const{tileBoundsBuffer:Gn,tileBoundsIndexBuffer:Cr,tileBoundsSegments:Tr}=f.getTileBoundsBuffers(ht);Pi.draw(f,j.TRIANGLES,Je,mt,re,Bn.disabled,tr,l.id,Gn,Cr,Tr)}}if(!(H instanceof i.aP)&&L)for(const Oe of De){const Ne=Oe.canonical.y===(1<<Oe.canonical.z)-1;Oe.canonical.y===0&&ga(!0,Oe,f,r,l,q,$,Me,Pe||zn.disabled),Ne&&ga(!1,Oe,f,r,l,q,$,Me===Bn.frontCW?Bn.backCW:Bn.frontCW,Pe||zn.disabled)}};L?ke(Se,f.renderElevatedRasterBackface?Bn.backCW:Bn.frontCW,f.stencilModeFor3D()):ke(Se,Bn.disabled,void 0),f.resetStencilClippingMasks()},"raster-particle":function(f,r,l,p,v,w){f.renderPass==="offscreen"&&function(C,P,L,z){if(!z.length)return;const j=C.context,H=j.gl,$=P.getSource();if(!($ instanceof Eu))return;const q=Math.ceil(Math.sqrt(L.paint.get("raster-particle-count")));let re=L.particlePositionRGBAImage;if(!re||re.width!==q){const Se=function(Te){const ke=Te*Te,De=new Uint8Array(4*ke),Me=function(Oe){return Oe|=0,Oe=Math.imul(2747636419^Oe,2654435769),Oe=Math.imul(Oe^Oe>>>16,2654435769),((Oe=Math.imul(Oe^Oe>>>16,2654435769))>>>0)/4294967296},Pe=1/1.1;for(let Oe=0;Oe<ke;Oe++){const Ne=Pe*(Me(2*Oe+0)+Ss),ht=Pe*(Me(2*Oe+1)+Ss),rt=255*Ne%1,Tt=255*ht%1,It=rt,Ht=ht-Tt/255,Qe=Tt;De[4*Oe+0]=255*(Ne-rt/255),De[4*Oe+1]=255*It,De[4*Oe+2]=255*Ht,De[4*Oe+3]=255*Qe}return De}(q);re=L.particlePositionRGBAImage=new i.r({width:q,height:q},Se)}let te=L.particleFramebuffer;te?te.width!==q&&(te.destroy(),te=L.particleFramebuffer=j.createFramebuffer(q,q,!0,null)):te=L.particleFramebuffer=j.createFramebuffer(q,q,!0,null);const oe=[];for(const Se of z){const Te=P.getTile(Se);if(!(Te instanceof vd))continue;const ke=Ig(Te,$,L);if(!ke)continue;const De=[Te.tileSize,Te.tileSize];let Me=L.tileFramebuffer;Me||(Me=L.tileFramebuffer=j.createFramebuffer(De[0],De[1],!0,null));let Pe=Te.rasterParticleState;Pe||(Pe=Te.rasterParticleState=new Jf(j,Se,De,re));const Oe=Pe.update(L.lastInvalidatedAt);Pe.particleTextureDimension!==q&&Pe.updateParticleTexture(Se,re);const Ne=Pe.targetColorTexture;Pe.targetColorTexture=Pe.backgroundColorTexture,Pe.backgroundColorTexture=Ne;const ht=Pe.particleTexture0;Pe.particleTexture0=Pe.particleTexture1,Pe.particleTexture1=ht,oe.push([Se,ke,Pe,Oe])}if(oe.length===0)return;const ne=i.q.now(),ye=L.previousDrawTimestamp?.001*(ne-L.previousDrawTimestamp):.0167;if(L.previousDrawTimestamp=ne,L.hasColorMap()){j.activeTexture.set(H.TEXTURE0+2);let Se=L.colorRampTexture;Se||(Se=L.colorRampTexture=new i.T(j,L.colorRamp,H.RGBA8)),Se.bind(H.LINEAR,H.CLAMP_TO_EDGE)}j.bindFramebuffer.set(L.tileFramebuffer.framebuffer),function(Se,Te,ke){const De=Se.context,Me=De.gl,Pe=Te.tileFramebuffer;De.activeTexture.set(Me.TEXTURE0);const Oe={u_texture:0,u_opacity:1.05*(ht=Te.paint.get("raster-particle-fade-opacity-factor"))/(ht+.05)},Ne=Se.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var ht;for(const rt of ke){const[,,Tt,It]=rt;Pe.colorAttachment.set(Tt.targetColorTexture.texture),De.viewport.set([0,0,Pe.width,Pe.height]),De.clear({color:i.am.transparent}),It&&(Tt.backgroundColorTexture.bind(Me.NEAREST,Me.CLAMP_TO_EDGE),Ne.draw(Se,Me.TRIANGLES,gn.disabled,zn.disabled,or.alphaBlended,Bn.disabled,Oe,Te.id,Se.viewportBuffer,Se.quadTriangleIndexBuffer,Se.viewportSegments))}}(C,L,oe),function(Se,Te,ke,De){const Me=Se.context,Pe=Me.gl,Oe=ke.tileFramebuffer,Ne=Se.transform.projection.name==="globe",ht=ke.paint.get("raster-particle-max-speed");for(const rt of De){const[Tt,It,Ht]=rt;Me.activeTexture.set(Pe.TEXTURE0+0),It.texture.bind(Pe.LINEAR,Pe.CLAMP_TO_EDGE),Oe.colorAttachment.set(Ht.targetColorTexture.texture);const Qe=Se.getOrCreateProgram("rasterParticleDraw",{defines:It.defines,overrideFog:!1});Me.activeTexture.set(Pe.TEXTURE0+1);const dt=It.scalarData?[]:[0,1,2,3].map(mt=>i.dU[mt](Tt));dt.push(Tt);const Je=Tt.canonical.x,Dt=Tt.canonical.y;for(const mt of dt){const Ot=Te.getTile(Ne?mt.wrapped():mt);if(!Ot)continue;const Mt=Ot.rasterParticleState;if(!Mt)continue;const Nt=mt.canonical.x+(1<<mt.canonical.z)*(mt.wrap-Tt.wrap),Vt=mt.canonical.y;Mt.particleTexture0.bind(Pe.NEAREST,Pe.CLAMP_TO_EDGE);const pn=hs(1,Mt.particleTexture0.size[0],[Nt-Je,Vt-Dt],0,It.texture.size,2,ht,It.textureOffset,It.scale,It.offset);Qe.draw(Se,Pe.POINTS,gn.disabled,zn.disabled,or.alphaBlended,Bn.disabled,pn,ke.id,Mt.particleIndexBuffer,void 0,Mt.particleSegment)}}}(C,P,L,oe),j.bindFramebuffer.set(L.particleFramebuffer.framebuffer),function(Se,Te,ke,De){const Me=Se.context,Pe=Me.gl,Oe=Te.paint.get("raster-particle-max-speed"),Ne=De*Te.paint.get("raster-particle-speed-factor")*.15,ht=function(Tt){return Math.pow(Tt,6)}(.01+1*Te.paint.get("raster-particle-reset-rate-factor")),rt=Te.particleFramebuffer;Me.viewport.set([0,0,rt.width,rt.height]);for(const Tt of ke){const[,It,Ht]=Tt;Me.activeTexture.set(Pe.TEXTURE0+0),It.texture.bind(Pe.LINEAR,Pe.CLAMP_TO_EDGE),Me.activeTexture.set(Pe.TEXTURE0+1);const Qe=Ht.particleTexture0;Qe.bind(Pe.NEAREST,Pe.CLAMP_TO_EDGE);const dt=Ma(1,Qe.size[0],0,It.texture.size,Oe,Ne,ht,It.textureOffset,It.scale,It.offset);rt.colorAttachment.set(Ht.particleTexture1.texture),Me.clear({color:i.am.transparent}),Se.getOrCreateProgram("rasterParticleUpdate",{defines:It.defines}).draw(Se,Pe.TRIANGLES,gn.disabled,zn.disabled,or.unblended,Bn.disabled,dt,Te.id,Se.viewportBuffer,Se.quadTriangleIndexBuffer,Se.viewportSegments)}}(C,L,oe,ye)}(f,r,l,p),f.renderPass==="translucent"&&(function(C,P,L,z,j){const H=C.context,$=H.gl,q=P.getSource().tileSize,re=5*(1-i.af(i.cx,i.cx+1,C.transform.zoom))*q+L.paint.get("raster-particle-elevation"),te=!C.options.moving,oe=C.transform.projection.name==="globe";if(!z.length)return;const[ne,ye]=C.stencilConfigForOverlap(z),Se=[];oe&&Se.push("PROJECTION_GLOBE_VIEW");const Te=C.stencilModeFor3D();for(const ke of ye){const De=ke.toUnwrapped(),Me=P.getTile(ke);if(!Me.rasterParticleState)continue;const Pe=Me.rasterParticleState,Oe=100;Me.registerFadeDuration(Oe);const Ne=P.findLoadedParent(ke,0),ht=Ws(Me,Ne,P,C.transform,Oe);let rt,Tt;C.terrain&&C.terrain.prepareDrawTile(),H.activeTexture.set($.TEXTURE0),Pe.targetColorTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),H.activeTexture.set($.TEXTURE1),Ne&&Ne.rasterParticleState?(Ne.rasterParticleState.targetColorTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),rt=Math.pow(2,Ne.tileID.overscaledZ-Me.tileID.overscaledZ),Tt=[Me.tileID.canonical.x*rt%1,Me.tileID.canonical.y*rt%1]):Pe.targetColorTexture.bind($.LINEAR,$.CLAMP_TO_EDGE);const It=oe?Float32Array.from(C.transform.expandedFarZProjMatrix):C.transform.calculateProjMatrix(De,te),Ht=C.transform,Qe=Yu(Ht),dt=i.dn(ke.canonical),Je=i.dp(dt.getCenter().lat);let Dt,mt,Ot,Mt,Nt;oe?(Dt=Float32Array.from(i.bh(i.dr(ke.canonical))),mt=Float32Array.from(Ht.globeMatrix),Ot=Float32Array.from(i.dm(Ht)),Mt=[i.ay(Ht.center.lng),i.aH(Ht.center.lat)],Nt=Float32Array.from(i.dq(ke.canonical,dt,Je,Ht.worldSize/Ht._pixelsPerMercatorPixel))):(Dt=new Float32Array(16),mt=new Float32Array(9),Ot=new Float32Array(16),Mt=[0,0],Nt=new Float32Array(9));const Vt=Xo(It,Dt,mt,Ot,Nt,Tt||[0,0],i.ah(C.transform.zoom),Mt,Qe,rt||1,ht,re),pn=C.isTileAffectedByFog(ke),bn=C.getOrCreateProgram("rasterParticle",{defines:Se,overrideFog:pn});if(C.uploadCommonUniforms(H,bn,De),oe){const rn=new gn($.LEQUAL,gn.ReadOnly,C.depthRangeFor3D),vn=0,dn=C.globeSharedBuffers;if(dn){const[Rn,Hn,dr]=dn.getGridBuffers(Je,vn!==0);bn.draw(C,$.TRIANGLES,rn,Te,or.alphaBlended,C.renderElevatedRasterBackface?Bn.frontCCW:Bn.backCCW,Vt,L.id,Rn,Hn,dr)}}else{const rn=C.depthModeForSublayer(0,gn.ReadOnly),vn=ne[ke.overscaledZ],{tileBoundsBuffer:dn,tileBoundsIndexBuffer:Rn,tileBoundsSegments:Hn}=C.getTileBoundsBuffers(Me);bn.draw(C,$.TRIANGLES,rn,vn,or.alphaBlended,Bn.disabled,Vt,L.id,dn,Rn,Hn)}}C.resetStencilClippingMasks()}(f,r,l,p),f.style.map.triggerRepaint())},background:function(f,r,l,p){const v=l.paint.get("background-color"),w=l.paint.get("background-color-use-theme").constantOr("default")==="none",C=l.paint.get("background-opacity"),P=l.paint.get("background-emissive-strength"),L=l.paint.get("background-pitch-alignment")==="viewport";if(C===0)return;const z=f.context,j=z.gl,H=f.transform,$=H.tileSize,q=l.paint.get("background-pattern");let re;if(q!==void 0&&(q===null||(re=f.imageManager.getPattern(i.I.from(q.toString()),l.scope,f.style.getLut(l.scope)),!re)))return;const te=!q&&v.a===1&&C===1&&f.opaquePassEnabledForLayer()?"opaque":"translucent";if(f.renderPass!==te)return;const oe=zn.disabled,ne=f.depthModeForSublayer(0,te==="opaque"?gn.ReadWrite:gn.ReadOnly),ye=f.colorModeForDrapableLayerRenderPass(P),Se=q?"backgroundPattern":"background";let Te,ke=p;if(ke||(Te=f.getBackgroundTiles(),ke=Object.values(Te).map(De=>De.tileID)),q&&(z.activeTexture.set(j.TEXTURE0),f.imageManager.bind(f.context,l.scope)),L){const De=f.getOrCreateProgram(Se,{overrideFog:!1,overrideRtt:!0}),Me=new Float32Array(i.bx([])),Pe=new i.aM(0,0,0,0,0),Oe=q?Kf(Me,P,C,f,0,l.scope,re,L,{tileID:Pe,tileSize:$}):qd(Me,P,C,v.toRenderColor(w?null:l.lut));De.draw(f,j.TRIANGLES,ne,oe,ye,Bn.disabled,Oe,l.id,f.viewportBuffer,f.quadTriangleIndexBuffer,f.viewportSegments)}else for(const De of ke){const Me=f.isTileAffectedByFog(De),Pe=f.getOrCreateProgram(Se,{overrideFog:Me}),Oe=De.toUnwrapped(),Ne=p?De.projMatrix:f.transform.calculateProjMatrix(Oe);f.prepareDrawTile();const ht=r?r.getTile(De):Te?Te[De.key]:new wl(De,$,H.zoom,f),rt=q?Kf(Ne,P,C,f,0,l.scope,re,L,{tileID:De,tileSize:$}):qd(Ne,P,C,v.toRenderColor(w?null:l.lut));f.uploadCommonUniforms(z,Pe,Oe);const{tileBoundsBuffer:Tt,tileBoundsIndexBuffer:It,tileBoundsSegments:Ht}=f.getTileBoundsBuffers(ht);Pe.draw(f,j.TRIANGLES,ne,oe,ye,Bn.disabled,rt,l.id,Tt,It,Ht)}},sky:function(f,r,l){const p=f._atmosphere?i.ah(f.transform.zoom):1,v=l.paint.get("sky-opacity")*p;if(v===0)return;const w=f.context,C=l.paint.get("sky-type"),P=new gn(w.gl.LEQUAL,gn.ReadOnly,[0,1]),L=f.frameCounter/1e3%1;C==="atmosphere"?f.renderPass==="offscreen"?l.needsSkyboxCapture(f)&&(function(z,j,H,$){const q=z.context,re=q.gl;let te=j.skyboxFbo;if(!te){te=j.skyboxFbo=q.createFramebuffer(32,32,!0,null),j.skyboxGeometry=new ru(q),j.skyboxTexture=q.gl.createTexture(),re.bindTexture(re.TEXTURE_CUBE_MAP,j.skyboxTexture),re.texParameteri(re.TEXTURE_CUBE_MAP,re.TEXTURE_WRAP_S,re.CLAMP_TO_EDGE),re.texParameteri(re.TEXTURE_CUBE_MAP,re.TEXTURE_WRAP_T,re.CLAMP_TO_EDGE),re.texParameteri(re.TEXTURE_CUBE_MAP,re.TEXTURE_MIN_FILTER,re.LINEAR),re.texParameteri(re.TEXTURE_CUBE_MAP,re.TEXTURE_MAG_FILTER,re.LINEAR);for(let Se=0;Se<6;++Se)re.texImage2D(re.TEXTURE_CUBE_MAP_POSITIVE_X+Se,0,re.RGBA,32,32,0,re.RGBA,re.UNSIGNED_BYTE,null)}q.bindFramebuffer.set(te.framebuffer),q.viewport.set([0,0,32,32]);const oe=j.getCenter(z,!0),ne=z.getOrCreateProgram("skyboxCapture"),ye=new Float64Array(16);i.bx(ye),i.e3(ye,ye,.5*-Math.PI),jl(z,j,ne,ye,oe,0),i.bx(ye),i.e3(ye,ye,.5*Math.PI),jl(z,j,ne,ye,oe,1),i.bx(ye),i.cG(ye,ye,.5*-Math.PI),jl(z,j,ne,ye,oe,2),i.bx(ye),i.cG(ye,ye,.5*Math.PI),jl(z,j,ne,ye,oe,3),i.bx(ye),jl(z,j,ne,ye,oe,4),i.bx(ye),i.e3(ye,ye,Math.PI),jl(z,j,ne,ye,oe,5),q.viewport.set([0,0,z.width,z.height])}(f,l),l.markSkyboxValid(f)):f.renderPass==="sky"&&function(z,j,H,$,q){const re=z.context,te=re.gl,oe=z.transform,ne=z.getOrCreateProgram("skybox");re.activeTexture.set(te.TEXTURE0),te.bindTexture(te.TEXTURE_CUBE_MAP,j.skyboxTexture);const ye=((Se,Te,ke,De,Me)=>({u_matrix:Se,u_sun_direction:Te,u_cubemap:0,u_opacity:De,u_temporal_offset:Me}))(oe.skyboxMatrix,j.getCenter(z,!1),0,$,q);z.uploadCommonUniforms(re,ne),ne.draw(z,te.TRIANGLES,H,zn.disabled,z.colorModeForRenderPass(),Bn.backCW,ye,"skybox",j.skyboxGeometry.vertexBuffer,j.skyboxGeometry.indexBuffer,j.skyboxGeometry.segment)}(f,l,P,v,L):C==="gradient"&&f.renderPass==="sky"&&function(z,j,H,$,q){const re=z.context,te=re.gl,oe=z.transform,ne=z.getOrCreateProgram("skyboxGradient");j.skyboxGeometry||(j.skyboxGeometry=new ru(re)),re.activeTexture.set(te.TEXTURE0);let ye=j.colorRampTexture;ye||(ye=j.colorRampTexture=new i.T(re,j.colorRamp,te.RGBA8)),ye.bind(te.LINEAR,te.CLAMP_TO_EDGE);const Se=((Te,ke,De,Me,Pe)=>({u_matrix:Te,u_color_ramp:0,u_center_direction:ke,u_radius:i.al(De),u_opacity:Me,u_temporal_offset:Pe}))(oe.skyboxMatrix,j.getCenter(z,!1),j.paint.get("sky-gradient-radius"),$,q);z.uploadCommonUniforms(re,ne),ne.draw(z,te.TRIANGLES,H,zn.disabled,z.colorModeForRenderPass(),Bn.backCW,Se,"skyboxGradient",j.skyboxGeometry.vertexBuffer,j.skyboxGeometry.indexBuffer,j.skyboxGeometry.segment)}(f,l,P,v,L)},debug:function(f,r,l,p,v,w){for(let C=0;C<l.length;C++)if(v){const z=new i.am(p.r*.8,p.g*.8,p.b*.8,1);Da(f,r,l[C],p,-1,-1,w),Da(f,r,l[C],p,-1,1,w),Da(f,r,l[C],p,1,1,w),Da(f,r,l[C],p,1,-1,w),Da(f,r,l[C],z,0,0,w)}else Da(f,r,l[C],p,0,0,w)},custom:function(f,r,l,p){const v=f.context,w=l.implementation;if(!f.transform.projection.unsupportedLayers||!f.transform.projection.unsupportedLayers.includes("custom")||f.terrain&&(f.terrain.renderingToTexture||f.renderPass==="offscreen")&&l.isDraped(r)){if(f.renderPass==="offscreen"){const C=w.prerender;if(C){if(f.setCustomLayerDefaults(),v.setColorMode(f.colorModeForRenderPass()),f.transform.projection.name==="globe"){const P=f.transform.pointMerc;C.call(w,v.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),i.ah(f.transform.zoom),[P.x,P.y],f.transform.pixelsPerMeterRatio)}else C.call(w,v.gl,f.transform.customLayerMatrix());v.setDirty(),f.setBaseState()}}else if(f.renderPass==="translucent"){if(f.terrain&&f.terrain.renderingToTexture){const P=w.renderToTile;if(P){const L=p[0].canonical,z={x:L.x+p[0].wrap*(w.wrapTileId?0:1<<L.z),y:L.y,z:L.z};v.setDepthMode(gn.disabled),v.setStencilMode(zn.disabled),v.setColorMode(f.colorModeForRenderPass()),f.setCustomLayerDefaults(),P.call(w,v.gl,z),v.setDirty(),f.setBaseState()}return}f.setCustomLayerDefaults(),v.setColorMode(f.colorModeForRenderPass()),v.setStencilMode(zn.disabled);const C=w.renderingMode==="3d"?new gn(f.context.gl.LEQUAL,gn.ReadWrite,f.depthRangeFor3D):f.depthModeForSublayer(0,gn.ReadOnly);if(v.setDepthMode(C),f.transform.projection.name==="globe"){const P=f.transform.pointMerc;w.render(v.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),i.ah(f.transform.zoom),[P.x,P.y],f.transform.pixelsPerMeterRatio)}else w.render(v.gl,f.transform.customLayerMatrix());v.setDirty(),f.setBaseState(),v.bindFramebuffer.set(null)}}else i.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(f,r,l,p){if(f.renderPass==="opaque")return;const v=l.paint.get("model-opacity").constantOr(1);if(v===0)return;const w=l.paint.get("model-cast-shadows");if(f.renderPass==="shadow"&&(!w||f.terrain&&v<.65&&l._transitionablePaint._values["model-opacity"].value.expression instanceof i.ab))return;const C=f.shadowRenderer,P=l.paint.get("model-receive-shadows");C&&(C.useNormalOffset=!0,P||(C.enabled=!1));const L=()=>{C&&(C.useNormalOffset=!0,P||(C.enabled=!0))},z=r.getSource();if(f.renderPass==="light-beam"&&z.type!=="batched-model")return;if(z.type==="vector"||z.type==="geojson")return function(ne,ye,Se,Te,ke){const De=ne.transform;if(De.projection.name!=="mercator")return void i.w(`Drawing 3D models for ${De.projection.name} projection is not yet implemented`);const Me=De.getFreeCameraOptions().position;if(!ne.modelManager)return;const Pe=ne.modelManager;Se.modelManager=Pe;const Oe=ne.shadowRenderer;if(!Se._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const Ne=Se._unevaluatedLayout._values["model-id"],ht=Object.assign({},Se.layout.get("model-id").parameters),rt=ne.style.order.indexOf(Se.fqid);for(const Tt of Te){const It=ye.getTile(Tt).getBucket(Se);if(!It||It.projection.name!==De.projection.name)continue;const Ht=It.getModelUris();Ht&&!It.modelsRequested&&(Pe.addModelsFromBucket(Ht,ke),It.modelsRequested=!0);const Qe=ya(Tt,De);ht.zoom=Qe;const dt=Ne.possiblyEvaluate(ht);if(ut(ne,It,Tt),_a.shadowUniformsInitialized=!1,_a.useSingleShadowCascade=!!Oe&&Oe.getMaxCascadeForTile(Tt.toUnwrapped())===0,ne.renderPass==="shadow"&&Oe){if(ne.currentShadowCascade===1&&It.isInsideFirstShadowMapFrustum)continue;const mt=De.calculatePosMatrix(Tt.toUnwrapped(),De.worldSize);if(_a.tileMatrix.set(mt),_a.shadowTileMatrix=Float32Array.from(Oe.calculateShadowPassMatrixFromMatrix(mt)),_a.aabb.min.fill(0),_a.aabb.max[0]=_a.aabb.max[1]=i.aj,_a.aabb.max[2]=0,Qf(It,_a,ne,Se.scope))continue}const Je=1<<Tt.canonical.z,Dt=[((Me.x-Tt.wrap)*Je-Tt.canonical.x)*i.aj,(Me.y*Je-Tt.canonical.y)*i.aj,Me.z*Je*i.aj];ne.conflationActive&&Object.keys(It.instancesPerModel).length>0&&ne.style.isLayerClipped(Se,ye.getSource())&&It.updateReplacement(Tt,ne.replacementSource,rt,ke)&&(It.uploaded=!1,It.upload(ne.context));for(let mt in It.instancesPerModel){const Ot=It.instancesPerModel[mt];Ot.features.length>0&&(mt=dt.evaluate(Ot.features[0].feature,{}));const Mt=Pe.getModel(mt,ke);if(Mt||Pe.hasURLBeenRequested(mt)||It.modelUris.includes(mt)||(It.modelUris.push(mt),It.modelsRequested=!1),Mt&&Mt.uploaded)for(const Nt of Mt.nodes)Ko(ne,Se,Nt,Ot,Dt,Tt,_a)}}}(f,r,l,p,z.type==="vector"?l.scope:""),void L();if(!z.loaded())return;if(z.type==="batched-model")return function(ne,ye,Se,Te){Se.resetLayerRenderingStats(ne);const ke=ne.context,De=ne.transform,Me=ne.style.fog,Pe=ne.shadowRenderer;if(De.projection.name!=="mercator")return void i.w(`Drawing 3D landmark models for ${De.projection.name} projection is not yet implemented`);const Oe=ne.transform.getFreeCameraOptions().position,Ne=i.b$([],[Oe.x,Oe.y,Oe.z],ne.transform.worldSize),ht=i.eb([],Ne),rt=i.bx([]),Tt=i.ec(De.center.lat,De.zoom),It=i.bn([],[1,1,1/Tt]);i.bo(rt,rt,ht);const Ht=Se.paint.get("model-opacity").constantOr(1),Qe=new gn(ke.gl.LEQUAL,gn.ReadWrite,ne.depthRangeFor3D),dt=new gn(ke.gl.LEQUAL,gn.ReadOnly,ne.depthRangeFor3D),Je=new i.cV([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),Dt=ne.renderPass==="shadow",mt=Dt&&Pe?Pe.getCurrentCascadeFrustum():De.getFrustum(De.scaleZoom(De.worldSize)),Ot=Se.paint.get("model-front-cutoff"),Mt=Ot[2]<1,Nt=Qa(ne,Se.paint.get("model-cutoff-fade-range")),Vt=Se.getLayerRenderingStats();(function(pn,bn,rn,vn){const dn=pn.terrain?pn.terrain.exaggeration():0,Rn=pn.transform.zoom;for(const Hn of vn){const dr=bn.getTile(Hn).getBucket(rn);dr&&(dr.setFilter(rn.filter),pn.conflationActive&&dr.updateReplacement(Hn,pn.replacementSource),dr.evaluateScale(pn,rn),pn.terrain&&dn>0&&dr.elevationUpdate(pn.terrain,dn,Hn,rn.source),dr.needsReEvaluation(pn,Rn,rn)&&dr.evaluate(rn))}})(ne,ye,Se,Te),function(){let pn,bn,rn;Mt?(pn=Te.length-1,bn=-1,rn=-1):(pn=0,bn=Te.length,rn=1);const vn=new Float64Array(16),dn=i.eg(),Rn=new i.P(0,0);for(let Hn=pn;Hn!==bn;Hn+=rn){const dr=Te[Hn],ri=ye.getTile(dr).getBucket(Se);if(!ri||!ri.uploaded)continue;let ii=!1;Pe&&(ii=Pe.getMaxCascadeForTile(dr.toUnwrapped())===0);const tr=De.calculatePosMatrix(dr.toUnwrapped(),De.worldSize),Hi=ri.modelTraits;!Dt&&Mt&&(i.bi(vn,tr),i.ad(dn,Ne,vn),Rn.x=dn[0],Rn.y=dn[1]);const Pi=[];ri.setFilter(Se.filter);for(const Gn of ri.getNodesInfo()){if(Gn.hiddenByReplacement||!Gn.node.meshes)continue;const Cr=Gn.node;let Tr=0;ne.terrain&&Cr.elevation&&(Tr=Cr.elevation*ne.terrain.exaggeration());const si=(()=>{const hi=Gn.aabb;return Je.min=[...hi.min],Je.max=[...hi.max],Je.min[2]+=Tr,Je.max[2]+=Tr,i.ad(Je.min,Je.min,tr),i.ad(Je.max,Je.max,tr),Je})(),ys=Gn.evaluatedScale;if(ys[0]<=1&&ys[1]<=1&&ys[2]<=1&&si.intersects(mt)===0)continue;if(!Dt&&Mt){const hi=.16666666666666666;Gn.cameraCollisionOpacity=Ne[0]>si.min[0]&&Ne[0]<si.max[0]&&Ne[1]>si.min[1]&&Ne[1]<si.max[1]&&Ne[2]*Tt<si.max[2]&&Cr.footprint&&i.bS(Rn,Cr.footprint)?Math.max(Gn.cameraCollisionOpacity-hi,0):Math.min(1,Gn.cameraCollisionOpacity+hi)}const Gi=[...tr],ns=Cr.anchor?Cr.anchor[0]:0,Oi=Cr.anchor?Cr.anchor[1]:0;i.bo(Gi,Gi,[ns*(ys[0]-1),Oi*(ys[1]-1),Tr]),i.ci(ys,i.eh)||i.cE(Gi,Gi,ys);const nr=i.az([],Gi,Cr.matrix),Si=i.az([],De.expandedFarZProjMatrix,nr),zr=i.az([],De.expandedFarZProjMatrix,Gi),ai=i.aA([],[ns,Oi,Tr,1],Si)[2];Cr.hidden=!1;let Xr=Ht;Dt||(Mt&&(Xr*=Gn.cameraCollisionOpacity,Xr*=td(Gi,De,Gn.aabb,Ot)),Xr*=ep(Nt,ai)),Xr!==0?Pi.push({nodeInfo:Gn,depth:ai,opacity:Xr,wvpForNode:Si,wvpForTile:zr,nodeModelMatrix:nr,tileModelMatrix:Gi}):Cr.hidden=!0}Dt||Pi.sort((Gn,Cr)=>!Mt||Gn.opacity===1&&Cr.opacity===1?Gn.depth<Cr.depth?-1:1:Gn.opacity===1?-1:Cr.opacity===1?1:Gn.depth>Cr.depth?-1:1);for(const Gn of Pi){const Cr=Gn.nodeInfo,Tr=Cr.node;let si=i.az([],It,Gn.tileModelMatrix);i.az(si,rt,si);const ys=i.bi([],si);i.ee(ys,ys),i.cE(ys,ys,ed),si=i.az(si,si,Tr.matrix);const Gi=ne.renderPass==="light-beam",ns=Se.paint.get("model-color-use-theme").constantOr("default")==="none",Oi=Hi&i.em.HasMapboxMeshFeatures,nr=Oi?0:Cr.evaluatedRMEA[0][2];for(let Si=0;Si<Tr.meshes.length;++Si){const zr=Tr.meshes[Si],ai=Si===Tr.lightMeshIndex;let Xr=Gn.wvpForNode;if(ai){if(!Gi&&!ne.terrain&&ne.shadowRenderer){ne.currentLayer<ne.firstLightBeamLayer&&(ne.firstLightBeamLayer=ne.currentLayer);continue}Xr=Gn.wvpForTile}else if(Gi)continue;const hi={defines:[]},Fs=[];if(!Dt&&Pe&&(Pe.useNormalOffset=!!zr.normalBuffer),Xt(hi.defines,Fs,zr,ne,ns?null:Se.lut),Oi||hi.defines.push("DIFFUSE_SHADED"),ii&&hi.defines.push("SHADOWS_SINGLE_CASCADE"),Vt&&(Dt?Vt.numRenderedVerticesInShadowPass+=zr.vertexArray.length:Vt.numRenderedVerticesInTransparentPass+=zr.vertexArray.length),Dt){$i(zr,Gn.nodeModelMatrix,ne,Se);continue}let br=null;if(Me){const Jo=il(Gn.nodeModelMatrix,ne.transform);if(br=new Float32Array(Jo),De.projection.name!=="globe"){const Fa=zr.aabb.min,Bs=zr.aabb.max,[Na,cl]=Me.getOpacityForBounds(Jo,Fa[0],Fa[1],Bs[0],Bs[1]);hi.overrideFog=Na>=ln||cl>=ln}}const Ks=zr.material;let ls;Ks.occlusionTexture&&Ks.occlusionTexture.offsetScale&&(ls=Ks.occlusionTexture.offsetScale,hi.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const oo=ne.getOrCreateProgram("model",hi);!Dt&&Pe&&Pe.setupShadowsFromMatrix(Gn.tileModelMatrix,oo,Pe.useNormalOffset),ne.uploadCommonUniforms(ke,oo,null,br);const ll=Ks.pbrMetallicRoughness;ll.metallicFactor=.9,ll.roughnessFactor=.5;const Wl=Ol(new Float32Array(Xr),new Float32Array(si),new Float32Array(ys),new Float32Array(Tr.matrix),ne,Gn.opacity,ll.baseColorFactor.toRenderColor(null),Ks.emissiveFactor,ll.metallicFactor,ll.roughnessFactor,Ks,nr,Se,[0,0,0],ls);!ai&&(Cr.hasTranslucentParts||Gn.opacity<1)&&oo.draw(ne,ke.gl.TRIANGLES,Qe,zn.disabled,or.disabled,Bn.backCCW,Wl,Se.id,zr.vertexBuffer,zr.indexBuffer,zr.segments,Se.paint,ne.transform.zoom,void 0,Fs),oo.draw(ne,ke.gl.TRIANGLES,ai?dt:Qe,zn.disabled,ai||Gn.opacity<1||Cr.hasTranslucentParts?or.alphaBlended:or.unblended,Bn.backCCW,Wl,Se.id,zr.vertexBuffer,zr.indexBuffer,zr.segments,Se.paint,ne.transform.zoom,void 0,Fs)}}}}()}(f,r,l,p),void L();if(z.type!=="model")return;const j=z.getModels(),H=[],$=f.transform.getFreeCameraOptions().position,q=i.b$([],[$.x,$.y,$.z],f.transform.worldSize);i.eb(q,q);const re=[],te=[];let oe=0;for(const ne of j){const ye=l.paint.get("model-rotation").constantOr(null),Se=l.paint.get("model-scale").constantOr(null),Te=l.paint.get("model-translation").constantOr(null);ne.computeModelMatrix(f,ye,Se,Te,!0,!0,!1);const ke=i.bx([]),De=i.ec(ne.position.lat,f.transform.zoom),Me=i.bn([],[1,1,1/De]);i.bo(ke,ke,q),H.push({zScaleMatrix:Me,negCameraPosMatrix:ke});for(const Pe of ne.nodes)zs(f.transform,Pe,ne.matrix,f.transform.expandedFarZProjMatrix,oe,re,te);oe++}if(re.sort((ne,ye)=>ye.depth-ne.depth),f.renderPass!=="shadow"){if(v===1)for(const ne of te)fn(ne,f,l,H[ne.modelIndex],zn.disabled,f.colorModeForRenderPass());else{for(const ne of te)fn(ne,f,l,H[ne.modelIndex],zn.disabled,or.disabled);for(const ne of te)fn(ne,f,l,H[ne.modelIndex],f.stencilModeFor3D(),f.colorModeForRenderPass());f.resetStencilClippingMasks()}for(const ne of re)fn(ne,f,l,H[ne.modelIndex],zn.disabled,f.colorModeForRenderPass());L()}else{for(const ne of te)$i(ne.mesh,ne.nodeModelMatrix,f,l);for(const ne of re)$i(ne.mesh,ne.nodeModelMatrix,f,l);L()}}},sf={line:function(f,r,l){if(f.hasElevatedBuckets=!1,f.hasNonElevatedBuckets=!1,f._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||f._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(r){const p=r.getVisibleCoordinates();for(const v of p){const w=r.getTile(v).getBucket(f);if(w&&(w.elevationType!=="none"?f.hasElevatedBuckets=!0:f.hasNonElevatedBuckets=!0,f.hasElevatedBuckets&&f.hasNonElevatedBuckets))break}}}else f.hasNonElevatedBuckets=!0},model:function(f,r,l){const p=r.getSource();if(!p.loaded())return;if(p.type==="vector"||p.type==="geojson")return void(l.modelManager&&l.modelManager.upload(l,p.type==="vector"?f.scope:""));if(p.type==="batched-model"||p.type!=="model")return;const v=p.getModels();for(const w of v)w.upload(l.context)},raster:function(f,r,l){const p=r.getSource();if(!(p instanceof Eu&&p.loaded()))return;const v=f.sourceLayer||p.rasterLayerIds&&p.rasterLayerIds[0];if(!v)return;const w=f.paint.get("raster-array-band")||p.getInitialBand(v);if(w==null)return;const C=r.getIds().map(P=>r.getTileByID(P));for(const P of C)P.updateNeeded(v,w)&&p.prepareTile(P,v,w)},"raster-particle":function(f,r,l){const p=r.getSource();if(!(p instanceof Eu&&p.loaded()))return;const v=f.sourceLayer||p.rasterLayerIds&&p.rasterLayerIds[0];if(!v)return;const w=f.paint.get("raster-particle-array-band")||p.getInitialBand(v);if(w==null)return;const C=r.getIds().map(P=>r.getTileByID(P));for(const P of C)P.updateNeeded(v,w)&&p.prepareTile(P,v,w)}},Vl={fill:Ku};class of{constructor(r,l,p,v,w){this.context=new Zu(r,l),this.transform=p,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=w,this._timeStamp=i.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const C=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const L of C)this._debugParams.enabledLayers[L]=!0;w.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),w.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),w.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),w.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),w.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),w.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const L of C)w.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],L);this.occlusionParams=new bm(w),this.setup(),this.numSublayers=to.maxUnderzooming+to.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new i.et,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new J_(this),this._wireframeDebugCache=new Ag,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const P=new i.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new i.T(this.context,P,r.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=v}updateTerrain(r,l){const p=!!r&&!!r.terrain&&this.transform.projection.supportsTerrain;if(!(p||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Eo(this,r));const v=this._terrain;this.transform.elevation=p?v:null,v.update(r,this.transform,l),this.transform.elevation&&!v.enabled&&(this.transform.elevation=null)}_updateFog(r){const l=r.fog;if(!l||this.transform.projection.name==="globe"||l.getOpacity(this.transform.pitch)<1||l.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[p,v]=l.getFovAdjustedRange(this.transform._fov);if(p>v)return void(this.transform.fogCullDistSq=null);const w=p+.78*(v-p);this.transform.fogCullDistSq=w*w}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(r){r&&!this._terrain&&(this._terrain=new Eo(this,this.style)),this._forceTerrainMode=r}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(r,l){if(this.width=r*i.q.devicePixelRatio,this.height=l*i.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style.order)this.style._mergedLayers[p].resize()}setup(){const r=this.context,l=new i.ba;l.emplaceBack(0,0),l.emplaceBack(i.aj,0),l.emplaceBack(0,i.aj),l.emplaceBack(i.aj,i.aj),this.tileExtentBuffer=r.createVertexBuffer(l,i.bc.members),this.tileExtentSegments=i.bd.simpleSegment(0,0,4,2);const p=new i.ba;p.emplaceBack(0,0),p.emplaceBack(i.aj,0),p.emplaceBack(0,i.aj),p.emplaceBack(i.aj,i.aj),this.debugBuffer=r.createVertexBuffer(p,i.bc.members),this.debugSegments=i.bd.simpleSegment(0,0,4,5);const v=new i.ba;v.emplaceBack(-1,-1),v.emplaceBack(1,-1),v.emplaceBack(-1,1),v.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(v,i.bc.members),this.viewportSegments=i.bd.simpleSegment(0,0,4,2);const w=new i.aZ;w.emplaceBack(0,0,0,0),w.emplaceBack(i.aj,0,i.aj,0),w.emplaceBack(0,i.aj,0,i.aj),w.emplaceBack(i.aj,i.aj,i.aj,i.aj),this.mercatorBoundsBuffer=r.createVertexBuffer(w,i.bf.members),this.mercatorBoundsSegments=i.bd.simpleSegment(0,0,4,2);const C=new i.a_;C.emplaceBack(0,1,2),C.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(C);const P=new i.bb;for(const z of[0,1,3,2,0])P.emplaceBack(z);this.debugIndexBuffer=r.createIndexBuffer(P),this.emptyTexture=new i.T(r,new i.r({width:1,height:1},Uint8Array.of(0,0,0,0)),r.gl.RGBA8),this.identityMat=i.bz();const L=this.context.gl;this.stencilClearMode=new zn({func:L.ALWAYS,mask:0},0,255,L.ZERO,L.ZERO,L.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(r){return r._makeTileBoundsBuffers(this.context,this.transform.projection),r._tileBoundsBuffer?{tileBoundsBuffer:r._tileBoundsBuffer,tileBoundsIndexBuffer:r._tileBoundsIndexBuffer,tileBoundsSegments:r._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const r=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,r.TRIANGLES,gn.disabled,this.stencilClearMode,or.disabled,Bn.disabled,Os(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(r,l,p){if(!l||this.currentStencilSource===l.id||!r.isTileClipped()||!p||p.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let P=!1;for(const L of p)if(this._tileClippingMaskIDs[L.key]===void 0){P=!0;break}if(!P)return}this.currentStencilSource=l.id;const v=this.context,w=v.gl;this.nextStencilID+p.length>256&&this.clearStencil(),v.setColorMode(or.disabled),v.setDepthMode(gn.disabled);const C=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const P of p){const L=l.getTile(P),z=this._tileClippingMaskIDs[P.key]=this.nextStencilID++,{tileBoundsBuffer:j,tileBoundsIndexBuffer:H,tileBoundsSegments:$}=this.getTileBoundsBuffers(L);C.draw(this,w.TRIANGLES,gn.disabled,new zn({func:w.ALWAYS,mask:0},z,255,w.KEEP,w.KEEP,w.REPLACE),or.disabled,Bn.disabled,Os(P.projMatrix),"$clipping",j,H,$)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,l=this.context.gl;return new zn({func:l.NOTEQUAL,mask:255},r,255,l.KEEP,l.KEEP,l.REPLACE)}stencilModeForClipping(r){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(r);const l=this.context.gl;return new zn({func:l.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,l.KEEP,l.KEEP,l.REPLACE)}stencilConfigForOverlap(r){const l=this.context.gl,p=r.sort((C,P)=>P.overscaledZ-C.overscaledZ),v=p[p.length-1].overscaledZ,w=p[0].overscaledZ-v+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();const C={};for(let P=0;P<w;P++)C[P+v]=new zn({func:l.GEQUAL,mask:255},P+this.nextStencilID,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID+=w,[C,p]}return[{[v]:zn.disabled},p]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new or([r.CONSTANT_COLOR,r.ONE,r.CONSTANT_COLOR,r.ONE],new i.am(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?or.unblended:or.alphaBlended}colorModeForDrapableLayerRenderPass(r){const l=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new or([l.ONE,l.ONE_MINUS_SRC_ALPHA,l.CONSTANT_ALPHA,l.ONE_MINUS_SRC_ALPHA],new i.am(0,0,0,r===void 0?0:r),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(r,l,p,v=!1){if(this.depthOcclusion)return new gn(this.context.gl.GREATER,gn.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!v)return gn.disabled;const w=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new gn(p||this.context.gl.LEQUAL,l,[w,w])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const r=this.context.gl,l=Math.ceil(this.width),p=Math.ceil(this.height),v=this.context.bindFramebuffer.get(),w=r.getParameter(r.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===l&&this.depthFBO.height===p||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),l!==0&&p!==0&&(this.depthFBO=new qu(this.context,l,p,!1,"texture"),this.depthTexture=new i.T(this.context,{width:l,height:p,data:null},r.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(v),r.bindTexture(r.TEXTURE_2D,w),this.depthFBO&&(r.bindFramebuffer(r.READ_FRAMEBUFFER,null),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),r.blitFramebuffer(0,0,l,p,0,0,l,p,r.DEPTH_BUFFER_BIT,r.NEAREST),r.bindFramebuffer(r.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((r,l)=>r+l/this._fpsHistory.length,0))}render(r,l){const p=i.q.now();this._dt=p-this._timeStamp,this._timeStamp=p,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=r.map.repaint,this.style=r,this.options=l;const v=this.style._mergedLayers,w=!(!this.terrain||!this.terrain.enabled),C=()=>this.style._getOrder(w).filter(Qe=>{const dt=v[Qe];return!(dt.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[dt.type]});let P=C(),L=!1,z=!1;for(const Qe of P){const dt=v[Qe];dt.type==="circle"&&(L=!0),dt.type==="symbol"&&(dt.hasInitialOcclusionOpacityProperties?z=!0:L=!0)}let j=P.map(Qe=>v[Qe]);const H=this.style._mergedSourceCaches;this.imageManager=r.imageManager,this.modelManager=r.modelManager,this.symbolFadeChange=r.placement.symbolFadeChange(i.q.now()),this.imageManager.beginFrame();let $=0,q=!1;for(const Qe in H){const dt=H[Qe];dt.used&&(dt.prepare(this.context),dt.getSource().usedInConflation&&++$)}let re=!1;for(const Qe of j)Qe.isHidden(this.transform.zoom)||(Qe.type==="clip"&&(re=!0),this.prepareLayer(Qe));const te={},oe={},ne={},ye={},Se={};for(const Qe in H){const dt=H[Qe];te[Qe]=dt.getVisibleCoordinates(),oe[Qe]=te[Qe].slice().reverse(),ne[Qe]=dt.getVisibleCoordinates(!0).reverse(),ye[Qe]=dt.getShadowCasterCoordinates(),Se[Qe]=dt.sortCoordinatesByDistance(te[Qe])}const Te=Qe=>{const dt=this.style.getLayerSourceCache(Qe);return dt&&dt.used?dt.getSource():null};if($||re||this._clippingActiveLastFrame){const Qe=[],dt=[];let Je=0;for(const Dt of j)this.isSourceForClippingOrConflation(Dt,Te(Dt))&&(Qe.push(Dt),dt.push(Je)),Je++;if(Qe&&(re||Qe.length>1)||this._clippingActiveLastFrame){re=!1;const Dt=[];for(let mt=0;mt<Qe.length;mt++){const Ot=Qe[mt],Mt=dt[mt],Nt=this.style.getLayerSourceCache(Ot);if(!Nt||!Nt.used||!Nt.getSource().usedInConflation&&Ot.type!=="clip")continue;let Vt=i.ev,pn=i.bQ.None;const bn=[];let rn=!0;if(Ot.type==="clip"){Vt=Mt;for(const vn of Ot.layout.get("clip-layer-types"))pn|=vn==="model"?i.bQ.Model:vn==="symbol"?i.bQ.Symbol:i.bQ.FillExtrusion;for(const vn of Ot.layout.get("clip-layer-scope"))bn.push(vn);Ot.isHidden(this.transform.zoom)?rn=!1:re=!0}rn&&Dt.push({layer:Ot.fqid,cache:Nt,order:Vt,clipMask:pn,clipScope:bn})}this.replacementSource.setSources(Dt),q=!0}}this._clippingActiveLastFrame=re,q||this.replacementSource.clear(),this.conflationActive=q,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let Qe=0;Qe<j.length;Qe++){const dt=j[Qe],Je=dt.cutoffRange();if(this.longestCutoffRange=Math.max(Je,this.longestCutoffRange),Je>0){const Dt=Te(dt);Dt&&(this.minCutoffZoom=Math.max(Dt.minzoom,this.minCutoffZoom)),dt.minzoom&&(this.minCutoffZoom=Math.max(dt.minzoom,this.minCutoffZoom))}dt.is3D(w)&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=Qe),this._lastOcclusionLayer=Qe)}const ke=this.style&&this.style.fog;ke?(this._fogVisible=ke.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=ke.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(ne),this.opaquePassCutoff=0,P=C(),j=P.map(Qe=>v[Qe]));const De=this._shadowRenderer;if(De){De.updateShadowParameters(this.transform,this.style.directionalLight);for(const Qe in H)for(const dt of te[Qe]){let Je={min:0,max:0};this.terrain&&(Je=this.terrain.getMinMaxForTile(dt)||Je),De.addShadowReceiver(dt.toUnwrapped(),Je.min,Je.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new i.eu(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new Sc(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const Me=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),Pe=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(Me&&!this._snow&&(this._snow=new Ii(this)),!Me&&this._snow&&(this._snow.destroy(),delete this._snow),Pe&&!this._rain&&(this._rain=new Rg(this)),!Pe&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),!Nn.has(this.context.gl))return;this.renderPass="offscreen";for(const Qe of j){const dt=r.getLayerSourceCache(Qe);if(!Qe.hasOffscreenPass()||Qe.isHidden(this.transform.zoom))continue;const Je=dt?oe[dt.id]:void 0;(Qe.type==="custom"||Qe.type==="raster"||Qe.type==="raster-particle"||Qe.isSky()||Je&&Je.length)&&this.renderLayer(this,dt,Qe,Je)}this.depthRangeFor3D=[0,1-(j.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,ye)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const Oe=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Ne=(()=>{if(l.showOverdrawInspector)return i.am.black;const Qe=this.style.fog;if(Qe&&this.transform.projection.supportsFog){const dt=this.style.getLut(Qe.scope);if(!Oe){const Je=Qe.properties.get("color-use-theme")==="none",Dt=Qe.properties.get("color").toRenderColor(Je?null:dt).toArray01();return new i.am(...Dt)}if(Oe){const Je=Qe.properties.get("space-color-use-theme")==="none",Dt=Qe.properties.get("space-color").toRenderColor(Je?null:dt).toArray01();return new i.am(...Dt)}}return i.am.transparent})();if(this.context.clear({color:Ne,depth:1}),this.clearStencil(),this._showOverdrawInspector=l.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Oe&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=P.length-1;this.currentLayer>=0;this.currentLayer--){const Qe=j[this.currentLayer],dt=r.getLayerSourceCache(Qe);if(Qe.isSky())continue;const Je=dt?(Qe.is3D(w)?Se:oe)[dt.id]:void 0;this._renderTileClippingMasks(Qe,dt,Je),this.renderLayer(this,dt,Qe,Je)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Oe&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||i.ah(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<P.length;this.currentLayer++){const Qe=j[this.currentLayer],dt=r.getLayerSourceCache(Qe);Qe.isSky()&&this.renderLayer(this,dt,Qe,dt?oe[dt.id]:void 0)}function ht(Qe,dt){let Je;return dt&&(Je=(Qe.type==="symbol"?ne:Qe.is3D(w)?Se:oe)[dt.id]),Je}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<P.length;){const Qe=j[this.currentLayer];if(Qe.type==="raster"||Qe.type==="raster-particle"){const dt=r.getLayerSourceCache(Qe);this.renderLayer(this,dt,Qe,ht(Qe,dt))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let rt=0;De&&(rt=De.getShadowCastingLayerCount());let Tt=!1,It=-1;for(let Qe=0;Qe<P.length;++Qe){const dt=j[Qe];dt.isHidden(this.transform.zoom)||dt.is3D(w)&&(It=Qe)}z&&It===-1&&(L=!0);let Ht=!1;for(;this.currentLayer<P.length;){const Qe=j[this.currentLayer],dt=r.getLayerSourceCache(Qe);if(Qe.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(Qe)){if(Qe.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(!Ht&&Qe.is3D(w)&&!w){const Je=this.currentLayer,Dt=mt=>{for(this.currentLayer=0;this.currentLayer<j.length;this.currentLayer++){const Ot=j[this.currentLayer];if(Vl[Ot.type]){const Mt=this.style.getLayerSourceCache(Ot);Vl[Ot.type](this,Mt,Ot,ht(Ot,Mt),mt)}}};Dt("initialize"),Dt("reset"),this.currentLayer=Je,Ht=!0}if(L&&!Tt&&this.terrain&&!this.transform.isOrthographic&&(Tt=!0,this.blitDepth()),z&&It!==-1&&this.currentLayer===It+1&&!this.transform.isOrthographic&&this.blitDepth(),this.terrain||this._renderTileClippingMasks(Qe,dt,dt?te[dt.id]:void 0),this.renderLayer(this,dt,Qe,ht(Qe,dt)),!this.terrain&&De&&rt>0&&Qe.hasShadowPass()&&--rt==0&&(De.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const Je=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Je;this.currentLayer++){const Dt=j[this.currentLayer];if(!Dt.hasLightBeamPass())continue;const mt=r.getLayerSourceCache(Dt);this.renderLayer(this,mt,Dt,mt?oe[mt.id]:void 0)}this.currentLayer=Je,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const Je=this.currentLayer;this.depthOcclusion=!0;for(const Dt of this.layersWithOcclusionOpacity){this.currentLayer=Dt;const mt=j[this.currentLayer],Ot=r.getLayerSourceCache(mt),Mt=Ot?oe[Ot.id]:void 0;this.terrain||this._renderTileClippingMasks(mt,Ot,Ot?te[Ot.id]:void 0),this.renderLayer(this,Ot,mt,Mt)}this.depthOcclusion=!1,this.currentLayer=Je,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let Qe=null;j.forEach(dt=>{const Je=r.getLayerSourceCache(dt);Je&&!dt.isHidden(this.transform.zoom)&&Je.getVisibleCoordinates().length&&(!Qe||Qe.getSource().maxzoom<Je.getSource().maxzoom)&&(Qe=Je)}),Qe&&this.options.showTileBoundaries&&Vr.debug(this,Qe,Qe.getVisibleCoordinates(),i.am.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Vr.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new i.am(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(Qe){const dt=Qe.transform.padding;tf(Qe,Qe.transform.height-(dt.top||0),3,La),tf(Qe,dt.bottom||0,3,Ju),Yd(Qe,dt.left||0,3,Qu),Yd(Qe,Qe.transform.width-(dt.right||0),3,qs);const Je=Qe.transform.centerPoint;(function(Dt,mt,Ot,Mt){as(Dt,mt-1,Ot-10,2,20,Mt),as(Dt,mt-10,Ot-1,20,2,Mt)})(Qe,Je.x,Qe.transform.height-Je.y,Nl)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),q||(this.conflationActive=!1)}prepareLayer(r){this.gpuTimingStart(r);const{unsupportedLayers:l}=this.transform.projection,p=!l||!l.includes(r.type);if(sf[r.type]&&(p||this.terrain&&r.type==="custom")){const v=this.style.getLayerSourceCache(r);sf[r.type](r,v,this)}this.gpuTimingEnd()}renderLayer(r,l,p,v){p.isHidden(this.transform.zoom)||(p.type==="background"||p.type==="sky"||p.type==="custom"||p.type==="model"||p.type==="raster"||p.type==="raster-particle"||v&&v.length)&&(this.id=p.id,this.gpuTimingStart(p),r.transform.projection.unsupportedLayers&&r.transform.projection.unsupportedLayers.includes(p.type)&&(!r.terrain||p.type!=="custom")||p.type==="clip"||Vr[p.type](r,l,p,v,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(r){if(!this.options.gpuTiming)return;const l=this.context.extTimerQuery,p=this.context.gl;let v=this.gpuTimers[r.id];v||(v=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:p.createQuery()}),v.calls++,p.beginQuery(l.TIME_ELAPSED_EXT,v.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const r=this.context.extTimerQuery,l=this.context.gl,p=l.createQuery();this.deferredRenderGpuTimeQueries.push(p),l.beginQuery(r.TIME_ELAPSED_EXT,p)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const r=this.gpuTimers;return this.gpuTimers={},r}collectDeferredRenderGpuQueries(){const r=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],r}queryGpuTimers(r){const l={};for(const p in r){const v=r[p],w=this.context.extTimerQuery,C=w.getQueryParameter(v.query,this.context.gl.QUERY_RESULT)/1e6;w.deleteQueryEXT(v.query),l[p]=C}return l}queryGpuTimeDeferredRender(r){if(!this.options.gpuTimingDeferredRender)return 0;const l=this.context.gl;let p=0;for(const v of r)p+=l.getQueryParameter(v,l.QUERY_RESULT)/1e6,l.deleteQuery(v);return p}translatePosMatrix(r,l,p,v,w){if(!p[0]&&!p[1])return r;const C=w?v==="map"?this.transform.angle:0:v==="viewport"?-this.transform.angle:0;if(C){const z=Math.sin(C),j=Math.cos(C);p=[p[0]*j-p[1]*z,p[0]*z+p[1]*j]}const P=[w?p[0]:i.aw(l,p[0],this.transform.zoom),w?p[1]:i.aw(l,p[1],this.transform.zoom),0],L=new Float32Array(16);return i.bo(L,r,P),L}saveTileTexture(r){const l=r.size[0],p=this._tileTextures[l];p?p.push(r):this._tileTextures[l]=[r]}getTileTexture(r){const l=this._tileTextures[r];return l&&l.length>0?l.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(r,l,p){const v=p===void 0?this.terrain&&this.terrain.renderingToTexture:p,w=[];return this.style&&this.style.enable3dLights()&&(r==="globeRaster"||r==="terrainRaster"?(w.push("LIGHTING_3D_MODE"),w.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):v||w.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||w.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(w.push("TERRAIN"),this.linearFloatFilteringSupported()&&w.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&w.push("GLOBE"),!this._fogVisible||v||l!==void 0&&!l||w.push("FOG","FOG_DITHERING"),v&&w.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&w.push("OVERDRAW_INSPECTOR"),w}getOrCreateProgram(r,l){this.cache=this.cache||{};const p=l&&l.defines||[],v=l&&l.config,w=this.currentGlobalDefines(r,l&&l.overrideFog,l&&l.overrideRtt).concat(p),C=Hu.cacheKey(Xc[r],r,w,v);return this.cache[C]||(this.cache[C]=new Hu(this.context,r,Xc[r],v,Zd[r],w)),this.cache[C]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(r,l){if(this.style.enable3dLights()){const p=this.style.directionalLight,v=this.style.ambientLight;if(p&&v){const w=((C,P,L)=>{const z=C.properties.get("direction"),j=C.properties.get("color-use-theme")==="none",H=C.properties.get("color").toRenderColor(j?null:L.getLut(C.scope)).toArray01(),$=C.properties.get("intensity"),q=P.properties.get("color-use-theme")==="none",re=P.properties.get("color").toRenderColor(q?null:L.getLut(P.scope)).toArray01(),te=P.properties.get("intensity"),oe=[z.x,z.y,z.z],ne=i.dw(re,te),ye=i.dw(H,$);return{u_lighting_ambient_color:ne,u_lighting_directional_dir:oe,u_lighting_directional_color:ye,u_ground_radiance:$d(oe,ye,ne)}})(p,v,this.style);l.setLightsUniformValues(r,w)}}}uploadCommonUniforms(r,l,p,v,w){if(this.uploadCommonLightUniforms(r,l),this.terrain&&this.terrain.renderingToTexture)return;const C=this.style.fog;if(C){const P=C.getOpacity(this.transform.pitch),L=((z,j,H,$,q,re,te,oe,ne,ye,Se,Te)=>{const ke=z.transform,De=j.properties.get("color-use-theme")==="none",Me=j.properties.get("color").toRenderColor(De?null:z.style.getLut(j.scope)).toArray01();Me[3]=$;const Pe=z.frameCounter/1e3%1,[Oe,Ne]=j.properties.get("vertical-range");return{u_fog_matrix:H?ke.calculateFogTileMatrix(H):Te||z.identityMat,u_fog_range:j.getFovAdjustedRange(ke._fov),u_fog_color:Me,u_fog_horizon_blend:j.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Oe,Ne),Ne],u_fog_temporal_offset:Pe,u_frustum_tl:q,u_frustum_tr:re,u_frustum_br:te,u_frustum_bl:oe,u_globe_pos:ne,u_globe_radius:ye,u_viewport:Se,u_globe_transition:i.ah(ke.zoom),u_is_globe:+(ke.projection.name==="globe")}})(this,C,p,P,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*i.q.devicePixelRatio,this.transform.height*i.q.devicePixelRatio],v);l.setFogUniformValues(r,L)}w&&l.setCutoffUniformValues(r,w.uniformValues)}setTileLoadedFlag(r){this.tileLoaded=r}saveCanvasCopy(){const r=this.canvasCopy();r&&(this.frameCopies.push(r),this.tileLoaded=!1)}canvasCopy(){const r=this.context.gl,l=r.createTexture();return r.bindTexture(r.TEXTURE_2D,l),r.copyTexImage2D(r.TEXTURE_2D,0,r.RGBA,0,0,r.drawingBufferWidth,r.drawingBufferHeight,0),l}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const r=this.style&&this.style.fog;return!!r&&r.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const r=this._backgroundTiles,l=this._backgroundTiles={},p=this.transform.coveringTiles({tileSize:512});for(const v of p)l[v.key]=r[v.key]||new wl(v,512,this.transform.tileZoom,this);return l}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(r,l){return!(!r.is3D(!(!this.terrain||!this.terrain.enabled))||r.type!=="clip"&&(r.minzoom&&r.minzoom>this.transform.zoom||(this.style._clipLayerPresent||r.sourceLayer!=="building")&&(!l||l.type!=="batched-model")))}isTileAffectedByFog(r){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let l=this._cachedTileFogOpacities[r.key];return l||(this._cachedTileFogOpacities[r.key]=l=this.style.fog.getOpacityForTile(r)),l[0]>=ln||l[1]>=ln}setupDepthForOcclusion(r,l,p){const v=this.context,w=v.gl,C=!!p;var P;p||(p={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),v.activeTexture.set(w.TEXTURE3),r&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),p.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],p.u_depth_range_unpack=[2/((P=this.depthRangeFor3D)[1]-P[0]),-1-2*P[0]/(P[1]-P[0])],p.u_occluder_half_size=.5*this.occlusionParams.occluderSize,p.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),v.activeTexture.set(w.TEXTURE0),C||l.setTerrainUniformValues(v,p)}}function ou(f,r){let l=!1,p=null;const v=()=>{p=null,l&&(f(),p=setTimeout(v,r),l=!1)};return()=>(l=!0,p||v(),p)}class th{constructor(r){this._hashName=r&&encodeURIComponent(r),i.aV(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=ou(this._updateHashUnthrottled.bind(this),300)}addTo(r){return this._map=r,window.addEventListener("hashchange",this._onHashChange,!1),r.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const r=this._map;if(!r)return"";const l=af(r);if(this._hashName){const p=this._hashName;let v=!1;const w=location.hash.slice(1).split("&").map(C=>{const P=C.split("=")[0];return P===p?(v=!0,`${P}=${l}`):C}).filter(C=>C);return v||w.push(`${p}=${l}`),`#${w.join("&")}`}return`#${l}`}_getCurrentHash(){const r=location.hash.replace("#","");if(this._hashName){let l;return r.split("&").map(p=>p.split("=")).forEach(p=>{p[0]===this._hashName&&(l=p)}),(l&&l[1]||"").split("/")}return r.split("/")}_onHashChange(){const r=this._map;if(!r)return!1;const l=this._getCurrentHash();if(l.length>=3&&!l.some(p=>isNaN(Number(p)))){const p=r.dragRotate.isEnabled()&&r.touchZoomRotate.isEnabled()?+(l[3]||0):r.getBearing();return r.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:p,pitch:+(l[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function af(f,r){const l=f.getCenter(),p=Math.round(100*f.getZoom())/100,v=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,v),C=Math.round(l.lng*w)/w,P=Math.round(l.lat*w)/w,L=f.getBearing(),z=f.getPitch();let j=r?`/${C}/${P}/${p}`:`${p}/${P}/${C}`;return(L||z)&&(j+="/"+Math.round(10*L)/10),z&&(j+=`/${Math.round(z)}`),j}const nh={linearity:.3,easing:i.ew(0,0,.3,1)},Sm=i.l({deceleration:2500,maxSpeed:1400},nh),rp=i.l({deceleration:20,maxSpeed:1400},nh),sl=i.l({deceleration:1e3,maxSpeed:360},nh),Ul=i.l({deceleration:1e3,maxSpeed:90},nh);class nd{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.q.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,l=i.q.now();for(;r.length>0&&l-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const l={zoom:0,bearing:0,pitch:0,pan:new i.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:w}of this._inertiaBuffer)l.zoom+=w.zoomDelta||0,l.bearing+=w.bearingDelta||0,l.pitch+=w.pitchDelta||0,w.panDelta&&l.pan._add(w.panDelta),w.around&&(l.around=w.around),w.pinchAround&&(l.pinchAround=w.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,v={};if(l.pan.mag()){const w=rh(l.pan.mag(),p,i.l({},Sm,r||{}));v.offset=l.pan.mult(w.amount/l.pan.mag()),v.center=this._map.transform.center,rd(v,w)}if(l.zoom){const w=rh(l.zoom,p,rp);v.zoom=this._map.transform.zoom+w.amount,rd(v,w)}if(l.bearing){const w=rh(l.bearing,p,sl);v.bearing=this._map.transform.bearing+i.aD(w.amount,-179,179),rd(v,w)}if(l.pitch){const w=rh(l.pitch,p,Ul);v.pitch=this._map.transform.pitch+w.amount,rd(v,w)}if(v.zoom||v.bearing){const w=l.pinchAround===void 0?l.around:l.pinchAround;v.around=w?this._map.unproject(w):this._map.getCenter()}return this.clear(),v.noMoveStart=!0,v}}function rd(f,r){(!f.duration||f.duration<r.duration)&&(f.duration=r.duration,f.easing=r.easing)}function rh(f,r,l){const{maxSpeed:p,linearity:v,deceleration:w}=l,C=i.aD(f*v/(r/1e3),-p,p),P=Math.abs(C)/(w*v);return{easing:l.easing,duration:1e3*P,amount:C*(P/2)}}class Yo extends i.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l,p,v={}){const w=_e(l.getCanvasContainer(),p),C=l.unproject(w);super(r,i.l({point:w,lngLat:C,originalEvent:p},v)),this._defaultPrevented=!1,this.target=l}}class Xs extends i.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l,p){const v=r==="touchend"?p.changedTouches:p.touches,w=Ce(l.getCanvasContainer(),v),C=w.map(L=>l.unproject(L)),P=w.reduce((L,z,j,H)=>L.add(z.div(H.length)),new i.P(0,0));super(r,{points:w,point:P,lngLats:C,lngLat:l.unproject(P),originalEvent:p}),this._defaultPrevented=!1}}class lf extends i.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,l){super("wheel",{originalEvent:l}),this._defaultPrevented=!1}}class ol{constructor(r,l){this._map=r,this._clickTolerance=l.clickTolerance}reset(){this._mousedownPos=void 0}wheel(r){return this._firePreventable(new lf(this._map,r))}mousedown(r,l){return this._mousedownPos=l,this._firePreventable(new Yo(r.type,this._map,r))}mouseup(r){this._map.fire(new Yo(r.type,this._map,r))}preclick(r){const l=i.l({},r);l.type="preclick",this._map.fire(new Yo(l.type,this._map,l))}click(r,l){this._mousedownPos&&this._mousedownPos.dist(l)>=this._clickTolerance||(this.preclick(r),this._map.fire(new Yo(r.type,this._map,r)))}dblclick(r){return this._firePreventable(new Yo(r.type,this._map,r))}mouseover(r){this._map.fire(new Yo(r.type,this._map,r))}mouseout(r){this._map.fire(new Yo(r.type,this._map,r))}touchstart(r){return this._firePreventable(new Xs(r.type,this._map,r))}touchmove(r){this._map.fire(new Xs(r.type,this._map,r))}touchend(r){this._map.fire(new Xs(r.type,this._map,r))}touchcancel(r){this._map.fire(new Xs(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ip{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(r){this._map.fire(new Yo(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Yo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._map.fire(new Yo(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class cf{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=l.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,l){this.isEnabled()&&r.shiftKey&&r.button===0&&(pe(),this._startPos=this._lastPos=l,this._active=!0)}mousemoveWindow(r,l){if(!this._active)return;const p=l,v=this._startPos,w=this._lastPos;if(!v||!w||w.equals(p)||!this._box&&p.dist(v)<this._clickTolerance)return;this._lastPos=p,this._box||(this._box=Z("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));const C=Math.min(v.x,p.x),P=Math.max(v.x,p.x),L=Math.min(v.y,p.y),z=Math.max(v.y,p.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${C}px,${L}px)`,this._box.style.width=P-C+"px",this._box.style.height=z-L+"px")})}mouseupWindow(r,l){if(!this._active)return;const p=this._startPos,v=l;if(p&&r.button===0){if(this.reset(),fe(),p.x!==v.x||p.y!==v.y)return this._map.fire(new i.A("boxzoomend",{originalEvent:r})),{cameraAnimation:w=>w.fitScreenCoordinates(p,v,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",r)}}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),he(),delete this._startPos,delete this._lastPos}_fireEvent(r,l){return this._map.fire(new i.A(r,{originalEvent:l}))}}function ih(f,r){const l={};for(let p=0;p<f.length;p++)l[f[p].identifier]=r[p];return l}class uf{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(r,l,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=r.timeStamp),p.length===this.numTouches&&(this.centroid=function(v){const w=new i.P(0,0);for(const C of v)w._add(C);return w.div(v.length)}(l),this.touches=ih(p,l)))}touchmove(r,l,p){if(this.aborted||!this.centroid)return;const v=ih(p,l);for(const w in this.touches){const C=v[w];(!C||C.dist(this.touches[w])>30)&&(this.aborted=!0)}}touchend(r,l,p){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const v=!this.aborted&&this.centroid;if(this.reset(),v)return v}}}class gs{constructor(r){this.singleTap=new uf(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(r,l,p){this.singleTap.touchstart(r,l,p)}touchmove(r,l,p){this.singleTap.touchmove(r,l,p)}touchend(r,l,p){const v=this.singleTap.touchend(r,l,p);if(v){const w=r.timeStamp-this.lastTime<500,C=!this.lastTap||this.lastTap.dist(v)<30;if(w&&C||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=v,this.count===this.numTaps)return this.reset(),v}}}class df{constructor(){this._zoomIn=new gs({numTouches:1,numTaps:2}),this._zoomOut=new gs({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,l,p){this._zoomIn.touchstart(r,l,p),this._zoomOut.touchstart(r,l,p)}touchmove(r,l,p){this._zoomIn.touchmove(r,l,p),this._zoomOut.touchmove(r,l,p)}touchend(r,l,p){const v=this._zoomIn.touchend(r,l,p),w=this._zoomOut.touchend(r,l,p);return v?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:C.getZoom()+1,around:C.unproject(v)},{originalEvent:r})}):w?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:C.getZoom()-1,around:C.unproject(w)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const hf={0:1,2:2},au={Control:"ctrlKey",Alt:"altKey",Shift:"shiftKey",Meta:"metaKey"};class sh{constructor(r){this.reset(),this._clickTolerance=r.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(r,l){return!1}_move(r,l){return{}}mousedown(r,l){if(this._lastPoint)return;const p=je(r);this._correctButton(r,p)&&(this._lastPoint=l,this._eventButton=p)}mousemoveWindow(r,l){const p=this._lastPoint;if(p){if(r.preventDefault(),this._eventButton!=null&&function(v,w){const C=hf[w];return v.buttons===void 0||(v.buttons&C)!==C}(r,this._eventButton))this.reset();else if(this._moved||!(l.dist(p)<this._clickTolerance))return this._moved=!0,this._lastPoint=l,this._move(p,l)}}mouseupWindow(r){this._lastPoint&&je(r)===this._eventButton&&(this._moved&&fe(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class sp extends sh{mousedown(r,l){super.mousedown(r,l),this._lastPoint&&(this._active=!0)}_correctButton(r,l){return l===0&&!r.ctrlKey}_move(r,l){return{around:l,panDelta:l.sub(r)}}}class ff extends sh{constructor(r){super(r),this._pitchRotateKey=r.pitchRotateKey?au[r.pitchRotateKey]:void 0}_correctButton(r,l){return this._pitchRotateKey?l===0&&r[this._pitchRotateKey]:l===0&&r.ctrlKey||l===2}_move(r,l){const p=.8*(l.x-r.x);if(p)return this._active=!0,{bearingDelta:p}}contextmenu(r){this._pitchRotateKey||r.preventDefault()}}class lu extends sh{constructor(r){super(r),this._pitchRotateKey=r.pitchRotateKey?au[r.pitchRotateKey]:void 0}_correctButton(r,l){return this._pitchRotateKey?l===0&&r[this._pitchRotateKey]:l===0&&r.ctrlKey||l===2}_move(r,l){const p=-.5*(l.y-r.y);if(p)return this._active=!0,{pitchDelta:p}}contextmenu(r){this._pitchRotateKey||r.preventDefault()}}class op{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._minTouches=1,this._clickTolerance=l.clickTolerance||1,this.reset(),i.aV(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new i.P(0,0)}touchstart(r,l,p){return this._calculateTransform(r,l,p)}touchmove(r,l,p){if(this._active&&!(p.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(p.length===1&&!i.ex())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return r.cancelable&&r.preventDefault(),this._calculateTransform(r,l,p)}}touchend(r,l,p){this._calculateTransform(r,l,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,l,p){p.length>0&&(this._active=!0);const v=ih(p,l),w=new i.P(0,0),C=new i.P(0,0);let P=0;for(const z in v){const j=v[z],H=this._touches[z];H&&(w._add(j),C._add(j.sub(H)),P++,v[z]=j)}if(this._touches=v,P<this._minTouches||!C.mag())return;const L=C.div(P);return this._sum._add(L),this._sum.mag()<this._clickTolerance?void 0:{around:w.div(P),panDelta:L}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Z("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class pf{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(r){}_move(r,l,p){return{}}touchstart(r,l,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([l[0],l[1]]))}touchmove(r,l,p){const v=this._firstTwoTouches;if(!v)return;r.preventDefault();const[w,C]=v,P=no(p,l,w),L=no(p,l,C);if(!P||!L)return;const z=this._aroundCenter?null:P.add(L).div(2);return this._move([P,L],z,r)}touchend(r,l,p){if(!this._firstTwoTouches)return;const[v,w]=this._firstTwoTouches,C=no(p,l,v),P=no(p,l,w);C&&P||(this._active&&fe(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function no(f,r,l){for(let p=0;p<f.length;p++)if(f[p].identifier===l)return r[p]}function ro(f,r){return Math.log(f/r)/Math.LN2}class ap extends pf{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,l){const p=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(ro(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ro(this._distance,p),pinchAround:l}}}function mf(f,r){return 180*f.angleWith(r)/Math.PI}class Cm extends pf{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,l){const p=this._vector;if(this._vector=r[0].sub(r[1]),p&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:mf(this._vector,p),pinchAround:l}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const l=25/(Math.PI*this._minDiameter)*360,p=this._startVector;if(!p)return!1;const v=mf(r,p);return Math.abs(v)<l}}function gf(f){return Math.abs(f.y)>Math.abs(f.x)}class Tm extends pf{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(r){this._lastPoints=r,gf(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,l,p){const v=this._lastPoints;if(!v)return;const w=r[0].sub(v[0]),C=r[1].sub(v[1]);return this._map._cooperativeGestures&&!i.ex()&&p.touches.length<3||(this._valid=this.gestureBeginsVertically(w,C,p.timeStamp),!this._valid)?void 0:(this._lastPoints=r,this._active=!0,{pitchDelta:(w.y+C.y)/2*-.5})}gestureBeginsVertically(r,l,p){if(this._valid!==void 0)return this._valid;const v=r.mag()>=2,w=l.mag()>=2;if(!v&&!w)return;if(!v||!w)return this._firstMove==null&&(this._firstMove=p),p-this._firstMove<100&&void 0;const C=r.y>0==l.y>0;return gf(r)&&gf(l)&&C}}const lp={panStep:100,bearingStep:15,pitchStep:10};class Em{constructor(){const r=lp;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let l=0,p=0,v=0,w=0,C=0;switch(r.keyCode){case 61:case 107:case 171:case 187:l=1;break;case 189:case 109:case 173:l=-1;break;case 37:r.shiftKey?p=-1:(r.preventDefault(),w=-1);break;case 39:r.shiftKey?p=1:(r.preventDefault(),w=1);break;case 38:r.shiftKey?v=1:(r.preventDefault(),C=-1);break;case 40:r.shiftKey?v=-1:(r.preventDefault(),C=1);break;default:return}return this._rotationDisabled&&(p=0,v=0),{cameraAnimation:P=>{const L=P.getZoom();P.easeTo({duration:300,easeId:"keyboardHandler",easing:cp,zoom:l?Math.round(L)+l*(r.shiftKey?2:1):L,bearing:P.getBearing()+p*this._bearingStep,pitch:P.getPitch()+v*this._pitchStep,offset:[-w*this._panStep,-C*this._panStep],center:P.getCenter()},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function cp(f){return f*(2-f)}const up=4.000244140625,Im=1/450;class dp{constructor(r,l){this._map=r,this._el=r.getCanvasContainer(),this._handler=l,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Im,i.aV(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(r.ctrlKey||r.metaKey||this.isZooming()||i.ex()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let l=r.deltaMode===WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const p=i.q.now(),v=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,l!==0&&l%up==0?this._type="wheel":l!==0&&Math.abs(l)<4?this._type="trackpad":v>400?(this._type=null,this._lastValue=l,this._timeout=window.setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(v*l)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,l+=this._lastValue)),r.shiftKey&&l&&(l/=4),this._type&&(this._lastWheelEvent=r,this._delta-=l,this._active||this._start(r)),r.preventDefault()}_onTimeout(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const l=_e(this._el,r);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:l,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._map.transform;this._type==="wheel"&&r.projection.wrap&&(r._center.lng>=180||r._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const l=()=>r._terrainEnabled()&&this._aroundCoord?r.computeZoomRelativeTo(this._aroundCoord):r.zoom;if(this._delta!==0){const z=this._type==="wheel"&&Math.abs(this._delta)>up?this._wheelZoomRate:this._defaultZoomRate;let j=2/(1+Math.exp(-Math.abs(this._delta*z)));this._delta<0&&j!==0&&(j=1/j);const H=l(),$=Math.pow(2,H),q=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):$;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(q*j))),this._type==="wheel"&&(this._startZoom=H,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const p=typeof this._targetZoom=="number"?this._targetZoom:l(),v=this._startZoom,w=this._easing;let C,P=!1;if(this._type==="wheel"&&v&&w){const z=Math.min((i.q.now()-this._lastWheelEventTime)/200,1),j=w(z);C=i.ai(v,p,j),z<1?this._frameId||(this._frameId=!0):P=!0}else C=p,P=!0;this._active=!0,P&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let L=C-l();return L*this._lastDelta<0&&(L=0),{noInertia:!0,needsRenderFrame:!P,zoomDelta:L,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let l=i.ey;if(this._prevEase){const p=this._prevEase,v=(i.q.now()-p.start)/p.duration,w=p.easing(v+.01)-p.easing(v),C=.27/Math.sqrt(w*w+1e-4)*.01,P=Math.sqrt(.0729-C*C);l=i.ew(C,P,.25,1)}return this._prevEase={start:i.q.now(),duration:r,easing:l},l}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Z("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class hp{constructor(r,l){this._clickZoom=r,this._tapZoom=l}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Pm{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(r,l){return r.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:p.getZoom()+(r.shiftKey?-1:1),around:p.unproject(l)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fp{constructor(){this._tap=new gs({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(r,l,p){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?p.length>0&&(this._swipePoint=l[0],this._swipeTouch=p[0].identifier):this._tap.touchstart(r,l,p))}touchmove(r,l,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const v=l[0],w=v.y-this._swipePoint.y;return this._swipePoint=v,r.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(r,l,p)}touchend(r,l,p){this._tapTime?this._swipePoint&&p.length===0&&this.reset():this._tap.touchend(r,l,p)&&(this._tapTime=r.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _f{constructor(r,l,p){this._el=r,this._mousePan=l,this._touchPan=p}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class sy{constructor(r,l,p){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=l,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Mg{constructor(r,l,p,v){this._el=r,this._touchZoom=l,this._touchRotate=p,this._tapDragZoom=v,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ki=f=>f.zoom||f.drag||f.pitch||f.rotate;class Am extends i.A{}class pp{constructor(){this.constants=[1,1,.01],this.radius=0}setup(r,l){const p=i.at([],l,r);this.radius=i.ae(p[2]<0?i.eA([],p,this.constants):[p[0],p[1],0])}projectRay(r){i.eA(r,r,this.constants),i.au(r,r),i.eB(r,r,this.constants);const l=i.b$([],r,this.radius);if(l[2]>0){const p=i.b$([],[0,0,1],i.bE(l,[0,0,1])),v=i.b$([],i.au([],[l[0],l[1],0]),this.radius),w=i.cU([],l,i.b$([],i.at([],i.cU([],v,p),l),2));l[0]=w[0],l[1]=w[1]}return l}}function ta(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta}class oy{constructor(r,l){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new nd(r),this._bearingSnap=l.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new pp,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(l),i.aV(["handleEvent","handleWindowEvent"],this);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(const[v,w,C]of this._listeners){const P=v===document?this.handleWindowEvent:this.handleEvent;v.addEventListener(w,P,C)}}destroy(){for(const[r,l,p]of this._listeners){const v=r===document?this.handleWindowEvent:this.handleEvent;r.removeEventListener(l,v,p)}}_addDefaultHandlers(r){const l=this._map,p=l.getCanvasContainer();this._add("mapEvent",new ol(l,r));const v=l.boxZoom=new cf(l,r);this._add("boxZoom",v);const w=new df,C=new Pm;l.doubleClickZoom=new hp(C,w),this._add("tapZoom",w),this._add("clickZoom",C);const P=new fp;this._add("tapDragZoom",P);const L=l.touchPitch=new Tm(l);this._add("touchPitch",L);const z=new ff(r),j=new lu(r);l.dragRotate=new sy(r,z,j),this._add("mouseRotate",z,["mousePitch"]),this._add("mousePitch",j,["mouseRotate"]);const H=new sp(r),$=new op(l,r);l.dragPan=new _f(p,H,$),this._add("mousePan",H),this._add("touchPan",$,["touchZoom","touchRotate"]);const q=new Cm,re=new ap;l.touchZoomRotate=new Mg(p,re,q,P),this._add("touchRotate",q,["touchPan","touchZoom"]),this._add("touchZoom",re,["touchPan","touchRotate"]),this._add("blockableMapEvent",new ip(l));const te=l.scrollZoom=new dp(l,this);this._add("scrollZoom",te,["mousePan"]);const oe=l.keyboard=new Em;this._add("keyboard",oe);for(const ne of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])r.interactive&&r[ne]&&l[ne].enable(r[ne])}_add(r,l,p){this._handlers.push({handlerName:r,handler:l,allowed:p}),this._handlersById[r]=l}stop(r){if(!this._updatingCamera){for(const{handler:l}of this._handlers)l.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ki(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(r,l,p){for(const v in r)if(v!==p&&(!l||l.indexOf(v)<0))return!0;return!1}handleWindowEvent(r){this.handleEvent(r,`${r.type}Window`)}_getMapTouches(r){const l=[];for(const p of r)this._el.contains(p.target)&&l.push(p);return l}handleEvent(r,l){this._updatingCamera=!0;const p=r.type==="renderFrame",v=p?void 0:r,w={needsRenderFrame:!1},C={},P={},L=r.touches?this._getMapTouches(r.touches):void 0,z=L?Ce(this._el,L):p?void 0:_e(this._el,r);for(const{handlerName:$,handler:q,allowed:re}of this._handlers){if(!q.isEnabled())continue;let te;this._blockedByActive(P,re,$)?q.reset():q[l||r.type]&&(te=q[l||r.type](r,z,L),this.mergeHandlerResult(w,C,te,$,v),te&&te.needsRenderFrame&&this._triggerRenderFrame()),(te||q.isActive())&&(P[$]=q)}const j={};for(const $ in this._previousActiveHandlers)P[$]||(j[$]=v);this._previousActiveHandlers=P,(Object.keys(j).length||ta(w))&&(this._changes.push([w,C,j]),this._triggerRenderFrame()),(Object.keys(P).length||ta(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:H}=w;H&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],H(this._map))}mergeHandlerResult(r,l,p,v,w){if(!p)return;i.l(r,p);const C={handlerName:v,originalEvent:p.originalEvent||w};p.zoomDelta!==void 0&&(l.zoom=C),p.panDelta!==void 0&&(l.drag=C),p.pitchDelta!==void 0&&(l.pitch=C),p.bearingDelta!==void 0&&(l.rotate=C)}_applyChanges(){const r={},l={},p={};for(const[v,w,C]of this._changes)v.panDelta&&(r.panDelta=(r.panDelta||new i.P(0,0))._add(v.panDelta)),v.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+v.zoomDelta),v.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+v.bearingDelta),v.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+v.pitchDelta),v.around!==void 0&&(r.around=v.around),v.aroundCoord!==void 0&&(r.aroundCoord=v.aroundCoord),v.pinchAround!==void 0&&(r.pinchAround=v.pinchAround),v.noInertia&&(r.noInertia=v.noInertia),i.l(l,w),i.l(p,C);this._updateMapTransform(r,l,p),this._changes=[]}_updateMapTransform(r,l,p){const v=this._map,w=v.transform,C=ye=>[ye.x,ye.y,ye.z];if((ye=>{const Se=this._eventsInProgress.drag;return Se&&!this._handlersById[Se.handlerName].isActive()})()&&!ta(r)){const ye=w.zoom;w.cameraElevationReference="sea",this._originalZoom!=null&&w._orthographicProjectionAtLowPitch&&w.projection.name!=="globe"&&w.pitch===0?(w.cameraElevationReference="ground",w.zoom=this._originalZoom):(w.recenterOnTerrain(),w.cameraElevationReference="ground"),ye!==w.zoom&&this._map._update(!0)}if(w._isCameraConstrained&&v._stop(!0),!ta(r))return void this._fireEvents(l,p,!0);let{panDelta:P,zoomDelta:L,bearingDelta:z,pitchDelta:j,around:H,aroundCoord:$,pinchAround:q}=r;w._isCameraConstrained&&(L>0&&(L=0),w._isCameraConstrained=!1),q!==void 0&&(H=q),(L||(ye=>l[ye]&&!this._eventsInProgress[ye])("drag"))&&H&&(this._dragOrigin=C(w.pointCoordinate3D(H)),this._originalZoom=w.zoom,this._trackingEllipsoid.setup(w._camera.position,this._dragOrigin)),w.cameraElevationReference="sea",v._stop(!0),H=H||v.transform.centerPoint,z&&(w.bearing+=z),j&&(w.pitch+=j),w._updateCameraState();const re=[0,0,0];if(P)if(w.projection.name==="mercator"){const ye=this._trackingEllipsoid.projectRay(w.screenPointToMercatorRay(H).dir),Se=this._trackingEllipsoid.projectRay(w.screenPointToMercatorRay(H.sub(P)).dir);re[0]=Se[0]-ye[0],re[1]=Se[1]-ye[1]}else{const ye=w.pointCoordinate(H);if(w.projection.name==="globe"){P=P.rotate(-w.angle);const Se=w._pixelsPerMercatorPixel/w.worldSize;re[0]=-P.x*i.ez(i.aY(ye.y))*Se,re[1]=-P.y*i.ez(w.center.lat)*Se}else{const Se=w.pointCoordinate(H.sub(P));ye&&Se&&(re[0]=Se.x-ye.x,re[1]=Se.y-ye.y)}}const te=w.zoom,oe=[0,0,0];if(L){const ye=C($||w.pointCoordinate3D(H)),Se={dir:i.au([],i.at([],ye,w._camera.position))};if(Se.dir[2]<0){const Te=w.zoomDeltaToMovement(ye,L);i.b$(oe,Se.dir,Te)}}const ne=i.cU(re,re,oe);w._translateCameraConstrained(ne),L&&Math.abs(w.zoom-te)>1e-4&&w.recenterOnTerrain(),w.cameraElevationReference="ground",this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(l,p,!0)}_fireEvents(r,l,p){const v=ki(this._eventsInProgress),w=ki(r),C={};for(const j in r){const{originalEvent:H}=r[j];this._eventsInProgress[j]||(C[`${j}start`]=H),this._eventsInProgress[j]=r[j]}!v&&w&&this._fireEvent("movestart",w.originalEvent);for(const j in C)this._fireEvent(j,C[j]);w&&this._fireEvent("move",w.originalEvent);for(const j in r){const{originalEvent:H}=r[j];this._fireEvent(j,H)}const P={};let L;for(const j in this._eventsInProgress){const{handlerName:H,originalEvent:$}=this._eventsInProgress[j];this._handlersById[H].isActive()||(delete this._eventsInProgress[j],L=l[H]||$,P[`${j}end`]=L)}for(const j in P)this._fireEvent(j,P[j]);const z=ki(this._eventsInProgress);if(p&&(v||w)&&!z){this._updatingCamera=!0;const j=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),H=$=>$!==0&&-this._bearingSnap<$&&$<this._bearingSnap;j?(H(j.bearing||this._map.getBearing())&&(j.bearing=0),this._map.easeTo(j,{originalEvent:L})):(this._map.fire(new i.A("moveend",{originalEvent:L})),H(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,l){this._map.fire(new i.A(r,l?{originalEvent:l}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{this._frameId=void 0,this.handleEvent(new Am("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const id="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class mp extends i.E{constructor(r,l){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=l.bearingSnap,this._respectPrefersReducedMotion=l.respectPrefersReducedMotion!==!1,i.aV(["_renderFrameCallback"],this)}getCenter(){return new i.cd(this.transform.center.lng,this.transform.center.lat)}setCenter(r,l){return this.jumpTo({center:r},l)}panBy(r,l,p){return r=i.P.convert(r).mult(-1),this.panTo(this.transform.center,i.l({offset:r},l),p)}panTo(r,l,p){return this.easeTo(i.l({center:r},l),p)}getZoom(){return this.transform.zoom}setZoom(r,l){return this.jumpTo({zoom:r},l),this}zoomTo(r,l,p){return this.easeTo(i.l({zoom:r},l),p)}zoomIn(r,l){return this.zoomTo(this.getZoom()+1,r,l),this}zoomOut(r,l){return this.zoomTo(this.getZoom()-1,r,l),this}getBearing(){return this.transform.bearing}setBearing(r,l){return this.jumpTo({bearing:r},l),this}getPadding(){return this.transform.padding}setPadding(r,l){return this.jumpTo({padding:r},l),this}rotateTo(r,l,p){return this.easeTo(i.l({bearing:r},l),p)}resetNorth(r,l){return this.rotateTo(0,i.l({duration:1e3},r),l),this}resetNorthPitch(r,l){return this.easeTo(i.l({bearing:0,pitch:0,duration:1e3},r),l),this}snapToNorth(r,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,l):this}getPitch(){return this.transform.pitch}setPitch(r,l){return this.jumpTo({pitch:r},l),this}cameraForBounds(r,l){r=i.aG.convert(r);const p=l&&l.bearing||0,v=l&&l.pitch||0,w=r.getNorthWest(),C=r.getSouthEast();return this._cameraForBounds(this.transform,w,C,p,v,l)}_extendPadding(r){const l={top:0,right:0,bottom:0,left:0};return r==null?i.l({},l,this.transform.padding):typeof r=="number"?{top:r,bottom:r,right:r,left:r}:i.l({},l,r)}_extendCameraOptions(r){return(r=i.l({offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding=this._extendPadding(r.padding),r}_minimumAABBFrustumDistance(r,l){const p=l.max[0]-l.min[0],v=l.max[1]-l.min[1];return p/v>r.aspect?p/(2*Math.tan(.5*r.fovX)*r.aspect):v/(2*Math.tan(.5*r.fovY)*r.aspect)}_cameraForBoundsOnGlobe(r,l,p,v,w,C){const P=r.clone(),L=this._extendCameraOptions(C);P.bearing=v,P.pitch=w;const z=i.cd.convert(l),j=i.cd.convert(p),H=.5*(z.lat+j.lat),$=.5*(z.lng+j.lng),q=i.eC(H,$),re=i.au([],q),te=i.au([],i.bG([],re,[0,1,0])),oe=i.bG([],te,re),ne=[te[0],te[1],te[2],0,oe[0],oe[1],oe[2],0,re[0],re[1],re[2],0,0,0,0,1],ye=[q,i.eC(z.lat,z.lng),i.eC(j.lat,z.lng),i.eC(j.lat,j.lng),i.eC(z.lat,j.lng),i.eC(H,z.lng),i.eC(H,j.lng),i.eC(z.lat,$),i.eC(j.lat,$)];let Se=i.cV.fromPoints(ye.map(mt=>[i.bE(te,mt),i.bE(oe,mt),i.bE(re,mt)]));const Te=i.ad([],Se.center,ne);i.eD(Te)===0&&i.eE(Te,0,0,1),i.au(Te,Te),i.b$(Te,Te,i.aE),P.center=i.eF(Te);const ke=P.getWorldToCameraMatrix(),De=i.bi(new Float64Array(16),ke);Se=i.cV.applyTransform(Se,i.az([],ke,ne));const Me=this._extendAABB(Se,P,L,v);if(!Me)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Se=Me,i.ad(Te,Te,ke);const Pe=.5*(Se.max[2]-Se.min[2]),Oe=this._minimumAABBFrustumDistance(P,Se),Ne=i.b$([],[0,0,1],Pe),ht=i.cU(Ne,Te,Ne),rt=Oe+(P.pitch===0?0:i.bD(Te,ht)),Tt=P.globeCenterInViewSpace,It=i.at([],Te,[Tt[0],Tt[1],Tt[2]]);i.au(It,It),i.b$(It,It,rt);const Ht=i.cU([],Te,It);i.ad(Ht,Ht,De);const Qe=i.eq/i.aE,dt=i.ae(Ht),Je=i.c6(Math.max(dt*Qe-i.eq,Number.EPSILON),0),Dt=Math.min(P.zoomFromMercatorZAdjusted(Je),L.maxZoom);return Dt>.5*(i.cL+i.cx)?(P.setProjection({name:"mercator"}),P.zoom=Dt,this._cameraForBounds(P,l,p,v,w,C)):{center:P.center,zoom:Dt,bearing:v,pitch:w}}_extendAABB(r,l,p,v){const w=.5*((p.padding.left||0)+(p.padding.right||0)),C=.5*((p.padding.top||0)+(p.padding.bottom||0)),P=C,L=w,z=w,j=C,H=l.width-(L+z),$=l.height-(P+j),q=i.at([],r.max,r.min),re=Math.min(H/q[0],$/q[1]),te=Math.min(l.scaleZoom(l.scale*re),p.maxZoom);if(isNaN(te))return null;const oe=l.scale/l.zoomScale(te),ne=new i.cV([r.min[0]-L*oe,r.min[1]-j*oe,r.min[2]],[r.max[0]+z*oe,r.max[1]+P*oe,r.max[2]]),ye=(typeof p.offset.x=="number"&&typeof p.offset.y=="number"?new i.P(p.offset.x,p.offset.y):i.P.convert(p.offset)).rotate(-i.al(v));return ne.center[0]-=ye.x*oe,ne.center[1]+=ye.y*oe,ne}queryTerrainElevation(r,l){const p=this.transform.elevation;return p?(l=i.l({},{exaggerated:!0},l),p.getAtPoint(i.ac.fromLngLat(r),null,l.exaggerated)):null}_cameraForBounds(r,l,p,v,w,C){if(r.projection.name==="globe")return this._cameraForBoundsOnGlobe(r,l,p,v,w,C);const P=r.clone(),L=this._extendCameraOptions(C);P.bearing=v,P.pitch=w;const z=i.cd.convert(l),j=i.cd.convert(p),H=new i.cd(z.lng,j.lat),$=new i.cd(j.lng,z.lat),q=P.project(z),re=P.project(j),te=this.queryTerrainElevation(z),oe=this.queryTerrainElevation(j),ne=this.queryTerrainElevation(H),ye=this.queryTerrainElevation($),Se=[[q.x,q.y,Math.min(te||0,oe||0,ne||0,ye||0)],[re.x,re.y,Math.max(te||0,oe||0,ne||0,ye||0)]];let Te=i.cV.fromPoints(Se);const ke=P.getWorldToCameraMatrix(),De=i.bi(new Float64Array(16),ke);Te=i.cV.applyTransform(Te,ke);const Me=this._extendAABB(Te,P,L,v);if(!Me)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Te=Me;const Pe=.5*i.at([],Te.max,Te.min)[2],Oe=this._minimumAABBFrustumDistance(P,Te),Ne=[0,0,1,0];i.aA(Ne,Ne,ke),i.eG(Ne,Ne);const ht=i.b$([],Ne,Oe+Pe),rt=i.cU([],Te.center,ht);i.ad(Te.center,Te.center,De),i.ad(rt,rt,De);const Tt=P.unproject(new i.P(Te.center[0],Te.center[1])),It=i.eH(P.projection,Tt),Ht=Math.pow(2,It),Qe=Math.min(P._zoomFromMercatorZ(rt[2]*P.pixelsPerMeter*Ht/P.worldSize),L.maxZoom);return P.mercatorFromTransition&&Qe<.5*(i.cL+i.cx)?(P.setProjection({name:"globe"}),P.zoom=Qe,this._cameraForBounds(P,l,p,v,w,C)):{center:Tt,zoom:Qe,bearing:v,pitch:w}}fitBounds(r,l,p){const v=this.cameraForBounds(r,l);return this._fitInternal(v,l,p)}fitScreenCoordinates(r,l,p,v,w){const C=i.P.convert(r),P=i.P.convert(l),L=new i.P(Math.min(C.x,P.x),Math.min(C.y,P.y)),z=new i.P(Math.max(C.x,P.x),Math.max(C.y,P.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(C,P))return this;const j=this.transform.pointLocation3D(L),H=this.transform.pointLocation3D(z),$=this.transform.pointLocation3D(new i.P(L.x,z.y)),q=this.transform.pointLocation3D(new i.P(z.x,L.y)),re=[Math.min(j.lng,H.lng,$.lng,q.lng),Math.min(j.lat,H.lat,$.lat,q.lat)],te=[Math.max(j.lng,H.lng,$.lng,q.lng),Math.max(j.lat,H.lat,$.lat,q.lat)],oe=v&&v.pitch?v.pitch:this.getPitch(),ne=this._cameraForBounds(this.transform,re,te,p,oe,v);return this._fitInternal(ne,v,w)}_fitInternal(r,l,p){return r?(l=i.l(r,l)).linear?this.easeTo(l,p):this.flyTo(l,p):this}jumpTo(r,l){this.stop();const p=r.preloadOnly?this.transform.clone():this.transform;let v=!1,w=!1,C=!1;"zoom"in r&&p.zoom!==+r.zoom&&(v=!0,p.zoom=+r.zoom),r.center!==void 0&&(p.center=i.cd.convert(r.center)),"bearing"in r&&p.bearing!==+r.bearing&&(w=!0,p.bearing=+r.bearing),"pitch"in r&&p.pitch!==+r.pitch&&(C=!0,p.pitch=+r.pitch);const P=typeof r.padding=="number"?this._extendPadding(r.padding):r.padding;if(r.padding!=null&&!p.isPaddingEqual(P))if(r.retainPadding===!1){const L=p.clone();L.padding=P,p.setLocationAtPoint(p.center,L.centerPoint)}else p.padding=P;return r.preloadOnly?(this._preloadTiles(p),this):(this.fire(new i.A("movestart",l)).fire(new i.A("move",l)),v&&this.fire(new i.A("zoomstart",l)).fire(new i.A("zoom",l)).fire(new i.A("zoomend",l)),w&&this.fire(new i.A("rotatestart",l)).fire(new i.A("rotate",l)).fire(new i.A("rotateend",l)),C&&this.fire(new i.A("pitchstart",l)).fire(new i.A("pitch",l)).fire(new i.A("pitchend",l)),this.fire(new i.A("moveend",l)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||i.w(id),this.transform.getFreeCameraOptions()}setFreeCameraOptions(r,l){const p=this.transform;if(!p.projection.supportsFreeCamera)return i.w(id),this;this.stop();const v=p.zoom,w=p.pitch,C=p.bearing;p.setFreeCameraOptions(r);const P=v!==p.zoom,L=w!==p.pitch,z=C!==p.bearing;return this.fire(new i.A("movestart",l)).fire(new i.A("move",l)),P&&this.fire(new i.A("zoomstart",l)).fire(new i.A("zoom",l)).fire(new i.A("zoomend",l)),z&&this.fire(new i.A("rotatestart",l)).fire(new i.A("rotate",l)).fire(new i.A("rotateend",l)),L&&this.fire(new i.A("pitchstart",l)).fire(new i.A("pitch",l)).fire(new i.A("pitchend",l)),this.fire(new i.A("moveend",l)),this}easeTo(r,l){this._stop(!1,r.easeId),((r=i.l({offset:[0,0],duration:500,easing:i.ey},r)).animate===!1||this._prefersReducedMotion(r))&&(r.duration=0);const p=this.transform,v=this.getZoom(),w=this.getBearing(),C=this.getPitch(),P=this.getPadding(),L="zoom"in r?+r.zoom:v,z="bearing"in r?this._normalizeBearing(r.bearing,w):w,j="pitch"in r?+r.pitch:C,H=this._extendPadding(r.padding),$=i.P.convert(r.offset);let q,re,te;if(p.projection.name==="globe"){const Ne=i.ac.fromLngLat(p.center),ht=$.rotate(-p.angle);Ne.x+=ht.x/p.worldSize,Ne.y+=ht.y/p.worldSize;const rt=Ne.toLngLat(),Tt=i.cd.convert(r.center||rt);this._normalizeCenter(Tt),q=p.centerPoint.add(ht),re=new i.P(Ne.x,Ne.y).mult(p.worldSize),te=new i.P(i.ay(Tt.lng),i.aH(Tt.lat)).mult(p.worldSize).sub(re)}else{q=p.centerPoint.add($);const Ne=p.pointLocation(q),ht=i.cd.convert(r.center||Ne);this._normalizeCenter(ht),re=p.project(Ne),te=p.project(ht).sub(re)}const oe=p.zoomScale(L-v);let ne,ye;r.around&&(ne=i.cd.convert(r.around),ye=p.locationPoint(ne));const Se=this._zooming||L!==v,Te=this._rotating||w!==z,ke=this._pitching||j!==C,De=!p.isPaddingEqual(H),Me=r.retainPadding===!1?p.clone():p,Pe=Ne=>ht=>{if(Se&&(Ne.zoom=i.ai(v,L,ht)),Te&&(Ne.bearing=i.ai(w,z,ht)),ke&&(Ne.pitch=i.ai(C,j,ht)),De&&(Me.interpolatePadding(P,H,ht),q=Me.centerPoint.add($)),ne)Ne.setLocationAtPoint(ne,ye);else{const rt=Ne.zoomScale(Ne.zoom-v),Tt=L>v?Math.min(2,oe):Math.max(.5,oe),It=Math.pow(Tt,1-ht),Ht=Ne.unproject(re.add(te.mult(ht*It)).mult(rt));Ne.setLocationAtPoint(Ne.renderWorldCopies?Ht.wrap():Ht,q)}return r.preloadOnly||this._fireMoveEvents(l),Ne};if(r.preloadOnly){const Ne=this._emulate(Pe,r.duration,p);return this._preloadTiles(Ne),this}const Oe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Se,this._rotating=Te,this._pitching=ke,this._padding=De,this._easeId=r.easeId,this._prepareEase(l,r.noMoveStart,Oe),this._ease(Pe(p),Ne=>{p.cameraElevationReference==="sea"&&p.recenterOnTerrain(),this._afterEase(l,Ne)},r),this}_prepareEase(r,l,p={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),l||p.moving||this.fire(new i.A("movestart",r)),this._zooming&&!p.zooming&&this.fire(new i.A("zoomstart",r)),this._rotating&&!p.rotating&&this.fire(new i.A("rotatestart",r)),this._pitching&&!p.pitching&&this.fire(new i.A("pitchstart",r))}_fireMoveEvents(r){this.fire(new i.A("move",r)),this._zooming&&this.fire(new i.A("zoom",r)),this._rotating&&this.fire(new i.A("rotate",r)),this._pitching&&this.fire(new i.A("pitch",r))}_afterEase(r,l){if(this._easeId&&l&&this._easeId===l)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const p=this._zooming,v=this._rotating,w=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new i.A("zoomend",r)),v&&this.fire(new i.A("rotateend",r)),w&&this.fire(new i.A("pitchend",r)),this.fire(new i.A("moveend",r))}flyTo(r,l){if(this._prefersReducedMotion(r)){const mt=i.aF(r,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(mt,l)}this.stop(),r=i.l({offset:[0,0],speed:1.2,curve:1.42,easing:i.ey},r);const p=this.transform,v=this.getZoom(),w=this.getBearing(),C=this.getPitch(),P=this.getPadding(),L="zoom"in r?i.aD(+r.zoom,p.minZoom,p.maxZoom):v,z="bearing"in r?this._normalizeBearing(r.bearing,w):w,j="pitch"in r?+r.pitch:C,H=this._extendPadding(r.padding),$=p.zoomScale(L-v),q=i.P.convert(r.offset);let re=p.centerPoint.add(q);const te=p.pointLocation(re),oe=i.cd.convert(r.center||te);this._normalizeCenter(oe);const ne=p.project(te),ye=p.project(oe).sub(ne);let Se=r.curve;const Te=Math.max(p.width,p.height),ke=Te/$,De=ye.mag();if("minZoom"in r){const mt=i.aD(Math.min(r.minZoom,v,L),p.minZoom,p.maxZoom),Ot=Te/p.zoomScale(mt-v);Se=Math.sqrt(Ot/De*2)}const Me=Se*Se;function Pe(mt){const Ot=(ke*ke-Te*Te+(mt?-1:1)*Me*Me*De*De)/(2*(mt?ke:Te)*Me*De);return Math.log(Math.sqrt(Ot*Ot+1)-Ot)}function Oe(mt){return(Math.exp(mt)-Math.exp(-mt))/2}function Ne(mt){return(Math.exp(mt)+Math.exp(-mt))/2}const ht=Pe(0);let rt=function(mt){return Ne(ht)/Ne(ht+Se*mt)},Tt=function(mt){return Te*((Ne(ht)*(Oe(Ot=ht+Se*mt)/Ne(Ot))-Oe(ht))/Me)/De;var Ot},It=(Pe(1)-ht)/Se;if(Math.abs(De)<1e-6||!isFinite(It)){if(Math.abs(Te-ke)<1e-6)return this.easeTo(r,l);const mt=ke<Te?-1:1;It=Math.abs(Math.log(ke/Te))/Se,Tt=function(){return 0},rt=function(Ot){return Math.exp(mt*Se*Ot)}}r.duration="duration"in r?+r.duration:1e3*It/("screenSpeed"in r?+r.screenSpeed/Se:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0);const Ht=w!==z,Qe=j!==C,dt=!p.isPaddingEqual(H),Je=r.retainPadding===!1?p.clone():p,Dt=mt=>Ot=>{const Mt=Ot*It,Nt=1/rt(Mt);mt.zoom=Ot===1?L:v+mt.scaleZoom(Nt),Ht&&(mt.bearing=i.ai(w,z,Ot)),Qe&&(mt.pitch=i.ai(C,j,Ot)),dt&&(Je.interpolatePadding(P,H,Ot),re=Je.centerPoint.add(q));const Vt=Ot===1?oe:mt.unproject(ne.add(ye.mult(Tt(Mt))).mult(Nt));return mt.setLocationAtPoint(mt.renderWorldCopies?Vt.wrap():Vt,re),mt._updateCameraOnTerrain(),r.preloadOnly||this._fireMoveEvents(l),mt};if(r.preloadOnly){const mt=this._emulate(Dt,r.duration,p);return this._preloadTiles(mt),this}return this._zooming=!0,this._rotating=Ht,this._pitching=Qe,this._padding=dt,this._prepareEase(l,!1),this._ease(Dt(p),()=>this._afterEase(l),r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(r){}_cancelRenderFrame(r){}_stop(r,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const p=this._onEaseEnd;this._onEaseEnd=void 0,p.call(this,l)}if(!r){const p=this.handlers;p&&p.stop(!1)}return this}_ease(r,l,p){p.animate===!1||p.duration===0?(r(1),l()):(this._easeStart=i.q.now(),this._easeOptions=p,this._onEaseFrame=r,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const r=Math.min((i.q.now()-this._easeStart)/this._easeOptions.duration,1),l=this._onEaseFrame;l&&l(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,l){r=i.bX(r,-180,180);const p=Math.abs(r-l);return Math.abs(r-360-l)<p&&(r-=360),Math.abs(r+360-l)<p&&(r+=360),r}_normalizeCenter(r){const l=this.transform;if(l.maxBounds||l.projection.name!=="globe"&&!l.renderWorldCopies)return;const p=r.lng-l.center.lng;r.lng+=p>180?-360:p<-180?360:0}_prefersReducedMotion(r){return this._respectPrefersReducedMotion&&i.q.prefersReducedMotion&&!(r&&r.essential)}_emulate(r,l,p){const v=Math.ceil(15*l/1e3),w=[],C=r(p.clone());for(let P=0;P<=v;P++){const L=C(P/v);w.push(L.clone())}return w}_preloadTiles(r,l){}}class yf{constructor(r={}){this.options=r,i.aV(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(r){const l=this.options&&this.options.compact,p=r._getUIString("AttributionControl.ToggleAttribution");this._map=r,this._container=Z("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Z("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",p);const v=Z("span","mapboxgl-ctrl-icon",this._compactButton);return v.setAttribute("aria-hidden","true"),v.setAttribute("title",p),this._innerContainer=Z("div","mapboxgl-ctrl-attrib-inner",this._container),l&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),l===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let r=this._editLink;r||(r=this._editLink=this._container.querySelector(".mapbox-improve-map"));const l=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||i.e.ACCESS_TOKEN}];if(r){const p=l.reduce((v,w,C)=>(w.value&&(v+=`${w.key}=${w.value}${C<l.length-1?"&":""}`),v),"?");r.href=`${i.e.FEEDBACK_URL}/${p}#${af(this._map,!0)}`,r.rel="noopener nofollow"}}_updateData(r){!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let r=[];if(this._map.style.stylesheet){const v=this._map.style.stylesheet;this.styleOwner=v.owner,this.styleId=v.id}const l=this._map.style._mergedSourceCaches;for(const v in l){const w=l[v];if(w.used){const C=w.getSource();C.attribution&&r.indexOf(C.attribution)<0&&r.push(C.attribution)}}r.sort((v,w)=>v.length-w.length),r=r.filter((v,w)=>{for(let C=w+1;C<r.length;C++)if(r[C].indexOf(v)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=[...this.options.customAttribution,...r]:r.unshift(this.options.customAttribution));const p=r.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,r.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class oh{constructor(){i.aV(["_updateLogo","_updateCompact"],this)}onAdd(r){this._map=r,this._container=Z("div","mapboxgl-ctrl");const l=Z("a","mapboxgl-ctrl-logo");return l.target="_blank",l.rel="noopener nofollow",l.href="https://www.mapbox.com/",l.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),l.setAttribute("rel","noopener nofollow"),this._container.appendChild(l),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(r){r&&r.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const r=this._map.style._sourceCaches;if(Object.entries(r).length===0)return!0;for(const l in r){const p=r[l].getSource();if(p.hasOwnProperty("mapbox_logo")&&!p.mapbox_logo)return!1}return!0}_updateCompact(){const r=this._container.children;if(r.length){const l=r[0];this._map.getCanvasContainer().offsetWidth<250?l.classList.add("mapboxgl-compact"):l.classList.remove("mapboxgl-compact")}}}class na{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const l=++this._id;return this._queue.push({callback:r,id:l,cancelled:!1}),l}remove(r){const l=this._currentlyRunning,p=l?this._queue.concat(l):this._queue;for(const v of p)if(v.id===r)return void(v.cancelled=!0)}run(r=0){const l=this._currentlyRunning=this._queue;this._queue=[];for(const p of l)if(!p.cancelled&&(p.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class io{constructor(r){this.jumpTo(r)}getValue(r){if(r<=this._startTime)return this._start;if(r>=this._endTime)return this._end;const l=i.dk((r-this._startTime)/(this._endTime-this._startTime));return this._start*(1-l)+this._end*l}isEasing(r){return r>=this._startTime&&r<=this._endTime}jumpTo(r){this._startTime=-1/0,this._endTime=-1/0,this._start=r,this._end=r}easeTo(r,l,p){this._start=this.getValue(l),this._end=r,this._startTime=l,this._endTime=l+p}}const _s={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class al extends i.A{constructor(r,l,p,v){const{point:w,lngLat:C,originalEvent:P,target:L}=r;super(r.type,{point:w,lngLat:C,originalEvent:P,target:L}),this.preventDefault=()=>{r.preventDefault()},this.id=l,this.interaction=p,this.feature=v}}class cu{constructor(r){this.map=r,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(r,l){if(this.typeById.has(r))throw new Error(`Interaction id "${r}" already exists.`);const p=l.filter;let v=l.type;p&&this.filters.set(r,i.b3(p)),v==="mouseover"&&(v="mouseenter"),v==="mouseout"&&(v="mouseleave");const w=this.interactionsByType.get(v)||new Map;v==="mouseenter"||v==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(r,l)):w.size===0&&this.map.on(v,this.handleType),w.size===0&&this.interactionsByType.set(v,w),w.set(r,l),this.typeById.set(r,v)}get(r){const l=this.typeById.get(r);if(!l)return;const p=this.interactionsByType.get(l);return p?p.get(r):void 0}remove(r){const l=this.typeById.get(r);if(!l)return;this.typeById.delete(r),this.filters.delete(r);const p=this.interactionsByType.get(l);p&&(p.delete(r),l==="mouseenter"||l==="mouseleave"?(this.delegatedInteractions.delete(r),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):p.size===0&&this.map.off(l,this.handleType))}queryTargets(r,l){const p=[];for(const[v,w]of l)w.target&&p.push({targetId:v,target:w.target,filter:this.filters.get(v)});return this.map.style.queryRenderedTargets(r,p,this.map.transform)}handleMove(r){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const l=this.queryTargets(r.point,Array.from(this.delegatedInteractions).reverse());l.length&&(r.type="mouseenter",this.handleType(r,l));const p=new Map;for(const[v,{feature:w}]of this.prevHoveredFeatures)this.hoveredFeatures.has(v)||p.set(w.id,w);p.size&&(r.type="mouseleave",this.handleType(r,Array.from(p.values())))}handleOut(r){const l=Array.from(this.hoveredFeatures.values()).map(({feature:p})=>p);l.length&&(r.type="mouseleave",this.handleType(r,l)),this.hoveredFeatures.clear()}handleType(r,l){const p=Array.from(this.interactionsByType.get(r.type)).reverse(),v=!!l;l=l||this.queryTargets(r.point,p);const w=r.type==="mouseenter";let C=!1;const P=new Set;for(const L of l){for(const[z,j]of p){if(!j.target)continue;const H=L.variants?L.variants[z]:null;if(H){for(const $ of H){if(ic($,L,P,z))continue;const q=new i.df(L,$),re=Iu($,L,z);v&&(q.state=this.map.getFeatureState(q));const te=w?this.prevHoveredFeatures.get(re):null,oe=new al(r,z,j,q),ne=te?te.stop:j.handler(oe);if(w&&this.hoveredFeatures.set(re,{feature:L,stop:ne}),ne!==!1){C=!0;break}}if(C)break}}if(C)break}if(!C)for(const[L,z]of p){const{handler:j,target:H}=z;if(!H&&j(new al(r,L,z,null))!==!1)break}}}function so(f,r){if(Array.isArray(f)&&Array.isArray(r)){const l=new Set(f),p=new Set(r);return l.size===p.size&&f.every(v=>p.has(v))}return i.bv(f,r)}const Lg={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},er={showCompass:!0,showZoom:!0,visualizePitch:!1};class $l{constructor(r,l,p=!1){this._clickTolerance=10,this.element=l,this.mouseRotate=new ff({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,p&&(this.mousePitch=new lu({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),i.aV(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),l.addEventListener("mousedown",this.mousedown),l.addEventListener("touchstart",this.touchstart,{passive:!1}),l.addEventListener("touchmove",this.touchmove),l.addEventListener("touchend",this.touchend),l.addEventListener("touchcancel",this.reset)}down(r,l){this.mouseRotate.mousedown(r,l),this.mousePitch&&this.mousePitch.mousedown(r,l),pe()}move(r,l){const p=this.map,v=this.mouseRotate.mousemoveWindow(r,l),w=v&&v.bearingDelta;if(w&&p.setBearing(p.getBearing()+w),this.mousePitch){const C=this.mousePitch.mousemoveWindow(r,l),P=C&&C.pitchDelta;P&&p.setPitch(p.getPitch()+P)}}off(){const r=this.element;r.removeEventListener("mousedown",this.mousedown),r.removeEventListener("touchstart",this.touchstart),r.removeEventListener("touchmove",this.touchmove),r.removeEventListener("touchend",this.touchend),r.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){he(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(r){this.down(i.l({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),_e(this.element,r)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(r){this.move(r,_e(this.element,r))}mouseup(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()}touchstart(r){r.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Ce(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>r.preventDefault()},this._startPos))}touchmove(r){r.targetTouches.length!==1?this.reset():(this._lastPos=Ce(this.element,r.targetTouches)[0],this.move({preventDefault:()=>r.preventDefault()},this._lastPos))}touchend(r){r.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function gp(f,r,l){if(f=new i.cd(f.lng,f.lat),r){const p=new i.cd(f.lng-360,f.lat),v=new i.cd(f.lng+360,f.lat),w=360*Math.ceil(Math.abs(f.lng-l.center.lng)/360),C=l.locationPoint3D(f).distSqr(r),P=r.x<0||r.y<0||r.x>l.width||r.y>l.height;l.locationPoint3D(p).distSqr(r)<C&&(P||Math.abs(p.lng-l.center.lng)<w)?f=p:l.locationPoint3D(v).distSqr(r)<C&&(P||Math.abs(v.lng-l.center.lng)<w)&&(f=v)}for(;Math.abs(f.lng-l.center.lng)>180;){const p=l.locationPoint3D(f);if(p.x>=0&&p.y>=0&&p.x<=l.width&&p.y<=l.height)break;f.lng>l.center.lng?f.lng-=360:f.lng+=360}return f}const _p={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},ka={rotation:0,rotationAlignment:"auto",pitchAlignment:"auto",occludedOpacity:.2,altitude:0};class Tc extends i.E{constructor(r,l){super(),(r instanceof HTMLElement||l)&&(r=i.l({element:r},l)),i.aV(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this);const{anchor:p="center",color:v="#3FB1CE",scale:w=1,draggable:C=!1,clickTolerance:P=0,rotation:L=ka.rotation,rotationAlignment:z=ka.rotationAlignment,pitchAlignment:j=ka.pitchAlignment,occludedOpacity:H=ka.occludedOpacity,altitude:$=ka.altitude}=r||{};this._anchor=p,this._color=v,this._scale=w,this._draggable=C,this._clickTolerance=P,this._rotation=L,this._rotationAlignment=z,this._pitchAlignment=j,this._occludedOpacity=H,this._altitude=$,this._state="inactive",this._isDragging=!1,this._updateMoving=()=>this._update(!0),r&&r.element?(this._element=r.element,this._offset=i.P.convert(r&&r.offset||[0,0])):(this._defaultMarker=!0,this._element=this._createDefaultMarker(),this._offset=i.P.convert(r&&r.offset||[0,-14])),this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",te=>{te.preventDefault()}),this._element.addEventListener("mousedown",te=>{te.preventDefault()});const q=this._element.classList;for(const te in _p)q.remove(`mapboxgl-marker-anchor-${te}`);q.add(`mapboxgl-marker-anchor-${this._anchor}`);const re=r&&r.className?r.className.trim().split(/\s+/):[];q.add(...re),this._popup=null}_createDefaultMarker(){const r=Z("div"),l=J("svg",{display:"block",height:41*this._scale+"px",width:27*this._scale+"px",viewBox:"0 0 27 41"},r);if(this._altitude===0){const p=J("radialGradient",{id:"shadowGradient"},J("defs",{},l));J("stop",{offset:"10%","stop-opacity":.4},p),J("stop",{offset:"100%","stop-opacity":.05},p),J("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},l)}return J("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},l),J("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},l),J("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},l),r}addTo(r){return r===this._map||(this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._updateMoving),r.on("moveend",this._update),r.on("remove",this._clearFadeTimer),r._addMarker(this),this.setDraggable(this._draggable),this._update(),r.on("click",this._onMapClick)),this}remove(){const r=this._map;return r&&(r.off("click",this._onMapClick),r.off("move",this._updateMoving),r.off("moveend",this._update),r.off("mousedown",this._addDragHandler),r.off("touchstart",this._addDragHandler),r.off("mouseup",this._onUp),r.off("touchend",this._onUp),r.off("mousemove",this._onMove),r.off("touchmove",this._onMove),r.off("remove",this._clearFadeTimer),r._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=i.cd.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}setAltitude(r){return r===this._altitude||(this._defaultMarker&&(this._altitude===0&&r!==0||this._altitude!==0&&r===0)&&(this._element=this._createDefaultMarker()),this._altitude=r||ka.altitude,this._update()),this}getAltitude(){return this._altitude}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const v=Math.sqrt(Math.pow(13.5,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[v,-1*(38.1-13.5+v)],"bottom-right":[-v,-1*(38.1-13.5+v)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,r._marker=this,r._altitude=this._altitude,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(r){const l=r.code,p=r.charCode||r.keyCode;l!=="Space"&&l!=="Enter"&&p!==32&&p!==13||this.togglePopup()}_onMapClick(r){const l=r.originalEvent.target,p=this._element;this._popup&&(l===p||p.contains(l))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?(r.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(r.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const r=this._map,l=this._pos;if(!r||!l)return!1;const p=r.unproject(l,this._altitude),v=r.getFreeCameraOptions();if(!v.position)return!1;const w=v.position.toLngLat();return w.distanceTo(p)<.9*w.distanceTo(this._lngLat)}_evaluateOpacity(){const r=this._map;if(!r)return;const l=this._pos;if(!l||l.x<0||l.x>r.transform.width||l.y<0||l.y>r.transform.height)return void this._clearFadeTimer();const p=r.unproject(l,this._altitude);let v;r._showingGlobe()&&i.eK(r.transform,this._lngLat)?v=0:(v=1-r._queryFogOpacity(p),r.transform._terrainEnabled()&&r.getTerrain()&&this._behindTerrain()&&(v*=this._occludedOpacity)),this._element.style.opacity=`${v}`,this._element.style.pointerEvents=v>0?"auto":"none",this._popup&&this._popup._setOpacity(v),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const r=this._pos;if(!r||!this._map)return;const l=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${r.x}px,${r.y}px)
            ${_p[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${l.x}px,${l.y}px)
        `}_calculateXYTransform(){const r=this._pos,l=this._map,p=this.getPitchAlignment();if(!l||!r||p!=="map")return"";if(!l._showingGlobe()){const L=l.getPitch();return L?`rotateX(${L}deg)`:""}const v=i.cJ(i.eL(l.transform,this._lngLat)),w=r.sub(i.eM(l.transform)),C=Math.abs(w.x)+Math.abs(w.y);if(C===0)return"";const P=v/C;return`rotateX(${-w.y*P}deg) rotateY(${w.x*P}deg)`}_calculateZTransform(){const r=this._pos,l=this._map;if(!l||!r)return"";let p=0;const v=this.getRotationAlignment();if(v==="map")if(l._showingGlobe()){const w=l.project(new i.cd(this._lngLat.lng,this._lngLat.lat+.001),this._altitude),C=l.project(new i.cd(this._lngLat.lng,this._lngLat.lat-.001),this._altitude).sub(w);p=i.cJ(Math.atan2(C.y,C.x))-90}else p=-l.getBearing();else if(v==="horizon"){const w=i.af(4,6,l.getZoom()),C=i.eM(l.transform);C.y+=w*l.transform.height;const P=r.sub(C),L=i.cJ(Math.atan2(P.y,P.x));p=(L>90?L-270:L+90)*(1-w)}return p+=this._rotation,p?`rotateZ(${p}deg)`:""}_update(r){cancelAnimationFrame(this._updateFrameId);const l=this._map;l&&(l.transform.renderWorldCopies&&(this._lngLat=gp(this._lngLat,this._pos,l.transform)),this._pos=l.project(this._lngLat,this._altitude),r===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),l._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(l._showingGlobe()||l.getTerrain()||l.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(r){return this._offset=i.P.convert(r),this._update(),this}addClassName(r){return this._element.classList.add(r),this}removeClassName(r){return this._element.classList.remove(r),this}toggleClassName(r){return this._element.classList.toggle(r)}_onMove(r){const l=this._map;if(!l)return;const p=this._pointerdownPos,v=this._positionDelta;if(p&&v){if(!this._isDragging){const w=this._clickTolerance||l._clickTolerance;if(r.point.dist(p)<w)return;this._isDragging=!0}this._pos=r.point.sub(v),this._lngLat=l.unproject(this._pos,this._altitude),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.A("dragstart"))),this.fire(new i.A("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const r=this._map;r&&(r.off("mousemove",this._onMove),r.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new i.A("dragend")),this._state="inactive"}_addDragHandler(r){const l=this._map,p=this._pos;l&&p&&this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(p),this._pointerdownPos=r.point,this._state="pending",l.on("mousemove",this._onMove),l.on("touchmove",this._onMove),l.once("mouseup",this._onUp),l.once("touchend",this._onUp))}setDraggable(r){this._draggable=!!r;const l=this._map;return l&&(r?(l.on("mousedown",this._addDragHandler),l.on("touchstart",this._addDragHandler)):(l.off("mousedown",this._addDragHandler),l.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||ka.rotation,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||ka.rotationAlignment,this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r||ka.pitchAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(r){return this._occludedOpacity=r||ka.occludedOpacity,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const uu={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},du={maxWidth:100,unit:"metric"},Hl={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Oa={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",altitude:0},za=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Gl(f=new i.P(0,0),r="bottom"){if(typeof f=="number"){const l=Math.round(Math.sqrt(.5*Math.pow(f,2)));switch(r){case"top":return new i.P(0,f);case"top-left":return new i.P(l,l);case"top-right":return new i.P(-l,l);case"bottom":return new i.P(0,-f);case"bottom-left":return new i.P(l,-l);case"bottom-right":return new i.P(-l,-l);case"left":return new i.P(f,0);case"right":return new i.P(-f,0)}return new i.P(0,0)}return f instanceof i.P||Array.isArray(f)?i.P.convert(f):i.P.convert(f[r]||[0,0])}return{version:I,supported:X.supported,setRTLTextPlugin:i.eN,getRTLTextPluginStatus:i.eO,Map:class extends mp{constructor(f){k.mark(R.create);const r=f;if((f=i.l({},Lg,f)).minZoom!=null&&f.maxZoom!=null&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(f.minPitch!=null&&f.maxPitch!=null&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(f.minPitch!=null&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(f.maxPitch!=null&&f.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(f.antialias&&i.eI(window)&&(f.antialias=!1,i.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Hc(f.minZoom,f.maxZoom,f.minPitch,f.maxPitch,f.renderWorldCopies,null,null),f),this._repaint=!!f.repaint,this._interactive=f.interactive,this._minTileCacheSize=f.minTileCacheSize,this._maxTileCacheSize=f.maxTileCacheSize,this._failIfMajorPerformanceCaveat=f.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=f.preserveDrawingBuffer,this._antialias=f.antialias,this._trackResize=f.trackResize,this._bearingSnap=f.bearingSnap,this._refreshExpiredTiles=f.refreshExpiredTiles,this._fadeDuration=f.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=f.crossSourceCollisions,this._collectResourceTiming=f.collectResourceTiming,this._language=this._parseLanguage(f.language),this._worldview=f.worldview,this._renderTaskQueue=new na,this._domRenderTaskQueue=new na,this._controls=[],this._markers=[],this._popups=[],this._mapId=i.a$(),this._locale=i.l({},_s,f.locale),this._clickTolerance=f.clickTolerance,this._cooperativeGestures=f.cooperativeGestures,this._performanceMetricsCollection=f.performanceMetricsCollection,this._tessellationStep=f.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=f.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new io(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=f.scaleFactor,this._requestManager=new Ue(f.transformRequest,f.accessToken,f.testMode),this._silenceAuthErrors=!!f.testMode,this._contextCreateOptions=f.contextCreateOptions?Object.assign({},f.contextCreateOptions):{},typeof f.container=="string"){const l=document.getElementById(f.container);if(!l)throw new Error(`Container '${f.container.toString()}' not found.`);this._container=l}else{if(!(f.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(this._container.childNodes.length>0&&i.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),f.maxBounds&&this.setMaxBounds(f.maxBounds),this._spriteFormat=f.spriteFormat,i.aV(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new tp),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new oy(this,f),this._localFontFamily=f.localFontFamily,this._localIdeographFontFamily=f.localIdeographFontFamily,(f.style||!f.testMode)&&this.setStyle(f.style||i.e.DEFAULT_STYLE,{config:f.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),f.projection&&this.setProjection(f.projection),this.indoor=new Sg(this),f.hash&&(this._hash=new th(typeof f.hash=="string"&&f.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){r.center==null&&r.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch});const l=f.bounds;l&&(this.resize(),this.fitBounds(l,i.l({},f.fitBoundsOptions,{duration:0})))}this.resize(),f.attributionControl&&this.addControl(new yf({customAttribution:f.customAttribution})),this._logoControl=new oh,this.addControl(this._logoControl,f.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",l=>{this._update(l.dataType==="style"),this.fire(new i.A(`${l.dataType}data`,l))}),this.on("dataloading",l=>{this.fire(new i.A(`${l.dataType}dataloading`,l))}),this._interactions=new cu(this)}_getMapId(){return this._mapId}addControl(f,r){if(r===void 0&&(r=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new i.z(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const l=f.onAdd(this);this._controls.push(f);const p=this._controlPositions[r];return r.indexOf("bottom")!==-1?p.insertBefore(l,p.firstChild):p.appendChild(l),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new i.z(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(f);return r>-1&&this._controls.splice(r,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(f){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const r=!this._moving;return r&&this.fire(new i.A("movestart",f)).fire(new i.A("move",f)),this.fire(new i.A("resize",f)),r&&this.fire(new i.A("moveend",f)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(f){return this.transform.setMaxBounds(i.aG.convert(f)),this._update()}setMinZoom(f){if((f=f??-2)>=-2&&f<=this.transform.maxZoom)return this.transform.minZoom=f,this._update(),this.getZoom()<f?this.setZoom(f):this.fire(new i.A("zoomstart")).fire(new i.A("zoom")).fire(new i.A("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f??22)>=this.transform.minZoom)return this.transform.maxZoom=f,this._update(),this.getZoom()>f?this.setZoom(f):this.fire(new i.A("zoomstart")).fire(new i.A("zoom")).fire(new i.A("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.minPitch=f,this._update(),this.getPitch()<f?this.setPitch(f):this.fire(new i.A("pitchstart")).fire(new i.A("pitch")).fire(new i.A("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(f>=this.transform.minPitch)return this.transform.maxPitch=f,this._update(),this.getPitch()>f?this.setPitch(f):this.fire(new i.A("pitchstart")).fire(new i.A("pitch")).fire(new i.A("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(f){return this._scaleFactor=f,this.painter.scaleFactor=f,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(r=>r.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.renderWorldCopies=f,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(f){return f==="auto"?navigator.language:Array.isArray(f)?f.length===0?void 0:f.map(r=>r==="auto"?navigator.language:r):f}setLanguage(f){const r=this._parseLanguage(f);if(!this.style||r===this._language)return this;this._language=r,this.style.reloadSources();for(const l of this._controls)l._setLanguage&&l._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(f){return this.style&&f!==this._worldview?(this._worldview=f,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(f){return this._lazyInitEmptyStyle(),f?typeof f=="string"&&(f={name:f}):f=null,this._useExplicitProjection=!!f,this._prioritizeAndUpdateProjection(f,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const f=this.transform,r=f.projection.name;let l;r==="globe"&&f.zoom>=i.cx?(f.setMercatorFromTransition(),l=!0):r==="mercator"&&f.zoom<i.cx&&(f.setProjection({name:"globe"}),l=!0),l&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(f,r){return this._updateProjection(f||r||{name:"mercator"})}_updateProjection(f){let r;return r=f.name==="globe"&&this.transform.zoom>=i.cx?this.transform.setMercatorFromTransition():this.transform.setProjection(f),this.style.applyProjectionUpdate(),r&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(f,r){return this.transform.locationPoint3D(i.cd.convert(f),r)}unproject(f,r){return this.transform.pointLocation3D(i.P.convert(f),r)}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(f,r,l){const p=v=>{let w=[];if(Array.isArray(r)){const C=r.filter(P=>this.getLayer(P));w=C.length?this.queryRenderedFeatures(v,{layers:C}):[]}else w=this.queryRenderedFeatures(v,{target:r});return w};if(f==="mouseenter"||f==="mouseover"){let v=!1;return{listener:l,targets:r,delegates:{mousemove:C=>{const P=p(C.point);P.length?v||(v=!0,l.call(this,new Yo(f,this,C.originalEvent,{features:P}))):v=!1},mouseout:()=>{v=!1}}}}if(f==="mouseleave"||f==="mouseout"){let v=!1;return{listener:l,targets:r,delegates:{mousemove:P=>{p(P.point).length?v=!0:v&&(v=!1,l.call(this,new Yo(f,this,P.originalEvent)))},mouseout:P=>{v&&(v=!1,l.call(this,new Yo(f,this,P.originalEvent)))}}}}{const v=w=>{const C=p(w.point);C.length&&(w.features=C,l.call(this,w),delete w.features)};return{listener:l,targets:r,delegates:{[f]:v}}}}on(f,r,l){if(typeof r=="function"||l===void 0)return super.on(f,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const p=this._createDelegatedListener(f,r,l);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(p);for(const v in p.delegates)this.on(v,p.delegates[v]);return this}once(f,r,l){if(typeof r=="function"||l===void 0)return super.once(f,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const p=this._createDelegatedListener(f,r,l);for(const v in p.delegates)this.once(v,p.delegates[v]);return this}off(f,r,l){if(typeof r=="function"||l===void 0)return super.off(f,r);if(typeof r=="string"&&(r=[r]),!this._areTargetsValid(r))return this;const p=this._delegatedListeners?this._delegatedListeners[f]:void 0;return p&&(v=>{for(let w=0;w<v.length;w++){const C=v[w];if(C.listener===l&&so(C.targets,r)){for(const P in C.delegates)this.off(P,C.delegates[P]);return v.splice(w,1),this}}})(p),this}queryRenderedFeatures(f,r){if(!this.style)return[];if(f===void 0||f instanceof i.P||Array.isArray(f)||r!==void 0||(r=f,f=void 0),f=f||[[0,0],[this.transform.width,this.transform.height]],!r){const w=this.style.queryRenderedFeatures(f,void 0,this.transform),C=this.style.queryRenderedFeatureset(f,void 0,this.transform);return w.concat(C)}let l=!0;if(r.target&&(l=this._isTargetValid(r.target),l&&!r.layers))return this.style.queryRenderedFeatureset(f,r,this.transform);let p=!0;if(r.layers&&Array.isArray(r.layers)){for(const w of r.layers)if(!this._isValidId(w)){p=!1;break}if(p&&!r.target)return this.style.queryRenderedFeatures(f,r,this.transform)}let v=[];return p&&(v=v.concat(this.style.queryRenderedFeatures(f,r,this.transform))),l&&(v=v.concat(this.style.queryRenderedFeatureset(f,r,this.transform))),v}querySourceFeatures(f,r){return!f||typeof f=="string"&&!this._isValidId(f)?[]:this.style.querySourceFeatures(f,r)}isPointOnSurface(f){const{name:r}=this.transform.projection;return r!=="globe"&&r!=="mercator"&&i.w(`${r} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(i.P.convert(f))}addInteraction(f,r){return this._interactions.add(f,r),this}removeInteraction(f){return this._interactions.remove(f),this}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(f){return this._cooperativeGestures=f,this}setStyle(f,r){return r=i.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},r),this.style&&f&&r.diff!==!1&&r.localFontFamily===this._localFontFamily&&r.localIdeographFontFamily===this._localIdeographFontFamily&&!r.config?(this.style._diffStyle(f,(l,p)=>{if(l){const v=typeof l=="string"?l:l instanceof Error?l.message:l.error;i.w(`Unable to perform style diff: ${v}. Rebuilding the style from scratch.`),this._updateStyle(f,r)}else p&&this._update(!0)},()=>this._postStyleLoadEvent()),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._localFontFamily=r.localFontFamily,this._updateStyle(f,r))}_getUIString(f){const r=this._locale[f];if(r==null)throw new Error(`Missing UI string '${f}'`);return r}_updateStyle(f,r){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),f){const l=i.l({},r);r&&r.config&&(l.initialConfig=r.config,delete l.config),this.style=new Ra(this,l).load(f),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Ra(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(i.w("There is no style added to the map."),!1)}_isValidId(f){return f==null?(this.fire(new i.z(new Error("IDs can't be empty."))),!1):!i.d9(f)||(this.fire(new i.z(new Error(`IDs can't contain special symbols: "${f}".`))),!1)}_isTargetValid(f){return"featuresetId"in f?this._isValidId("importId"in f?f.importId:f.featuresetId):"layerId"in f&&this._isValidId(f.layerId)}_areTargetsValid(f){if(Array.isArray(f)){for(const r of f)if(!this._isValidId(r))return!1;return!0}return this._isTargetValid(f)}addSource(f,r){return this._isValidId(f)?(this._lazyInitEmptyStyle(),this.style.addSource(f,r),this._update(!0)):this}isSourceLoaded(f){return!!this._isValidId(f)&&!!this.style&&this.style._isSourceCacheLoaded(f)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(f,r,l){this._lazyInitEmptyStyle(),this.style.addSourceType(f,r,l)}removeSource(f){return this._isValidId(f)?(this.style.removeSource(f),this._updateTerrain(),this._update(!0)):this}getSource(f){return this._isValidId(f)?this.style.getOwnSource(f):null}addImage(f,r,{pixelRatio:l=1,sdf:p=!1,stretchX:v,stretchY:w,content:C}={}){this._lazyInitEmptyStyle();const P=i.I.from(f);if(r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap){const{width:L,height:z,data:j}=i.q.getImageData(r);this.style.addImage(P,{data:new i.r({width:L,height:z},j),pixelRatio:l,stretchX:v,stretchY:w,content:C,sdf:p,version:0,usvg:!1})}else if(r.width===void 0||r.height===void 0)this.fire(new i.z(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:L,height:z}=r,j=r;this.style.addImage(P,{data:new i.r({width:L,height:z},new Uint8Array(j.data)),pixelRatio:l,stretchX:v,stretchY:w,content:C,sdf:p,usvg:!1,version:0,userImage:j}),j.onAdd&&j.onAdd(this,f)}}updateImage(f,r){this._lazyInitEmptyStyle();const l=i.I.from(f),p=this.style.getImage(l);if(!p)return void this.fire(new i.z(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const v=r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap?i.q.getImageData(r):r,{width:w,height:C,data:P}=v;if(w===void 0||C===void 0)return void this.fire(new i.z(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(w!==(p.usvg?p.icon.usvg_tree.width:p.data.width)||C!==(p.usvg?p.icon.usvg_tree.height:p.data.height))return void this.fire(new i.z(new Error(`The width and height of the updated image (${w}, ${C})
                must be that same as the previous version of the image
                (${p.data.width}, ${p.data.height})`)));const L=!(r instanceof HTMLImageElement||ImageBitmap&&r instanceof ImageBitmap);let z=!1;p.usvg?(p.data=new i.r({width:w,height:C},new Uint8Array(P)),p.usvg=!1,p.icon=void 0,z=!0):p.data.replace(P,L),this.style.updateImage(l,p,z)}hasImage(f){return f?!!this.style&&!!this.style.getImage(i.I.from(f)):(this.fire(new i.z(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(i.I.from(f))}loadImage(f,r){i.o(this._requestManager.transformRequest(f,i.R.Image),(l,p)=>{r(l,p instanceof HTMLImageElement?i.q.getImageData(p):p)})}listImages(){return this.style.listImages().map(f=>f.name)}addModel(f,r){this._lazyInitEmptyStyle(),this.style.addModel(f,r)}hasModel(f){return f?this.style.hasModel(f):(this.fire(new i.z(new Error("Missing required model id"))),!1)}removeModel(f){this.style.removeModel(f)}listModels(){return this.style.listModels()}addLayer(f,r){return this._isValidId(f.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(f,r),this._update(!0)):this}getSlot(f){const r=this.getLayer(f);return r&&r.slot||null}setSlot(f,r){return this.style.setSlot(f,r),this.style.mergeLayers(),this._update(!0)}addImport(f,r){return this.style.addImport(f,r).catch(l=>this.fire(new i.z(new Error("Failed to add import",l)))),this}updateImport(f,r){return typeof r!="string"&&r.id!==f?(this.removeImport(f),this.addImport(r)):(this.style.updateImport(f,r),this._update(!0))}removeImport(f){return this.style.removeImport(f),this}moveImport(f,r){return this.style.moveImport(f,r),this._update(!0)}moveLayer(f,r){return this._isValidId(f)?(this.style.moveLayer(f,r),this._update(!0)):this}removeLayer(f){return this._isValidId(f)?(this.style.removeLayer(f),this._update(!0)):this}getLayer(f){if(!this._isValidId(f))return null;const r=this.style.getOwnLayer(f);return r?r.type==="custom"?r.implementation:r.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(f,r,l){return this._isValidId(f)?(this.style.setLayerZoomRange(f,r,l),this._update(!0)):this}setFilter(f,r,l={}){return this._isValidId(f)?(this.style.setFilter(f,r,l),this._update(!0)):this}getFilter(f){return this._isValidId(f)?this.style.getFilter(f):null}setPaintProperty(f,r,l,p={}){return this._isValidId(f)?(this.style.setPaintProperty(f,r,l,p),this._update(!0)):this}getPaintProperty(f,r){return this._isValidId(f)?this.style.getPaintProperty(f,r):null}setLayoutProperty(f,r,l,p={}){return this._isValidId(f)?(this.style.setLayoutProperty(f,r,l,p),this._update(!0)):this}getLayoutProperty(f,r){return this._isValidId(f)?this.style.getLayoutProperty(f,r):null}getGlyphsUrl(){return this.style.getGlyphsUrl()}setGlyphsUrl(f){return this.style.setGlyphsUrl(f),this._update(!0)}getSchema(f){return this.style.getSchema(f)}setSchema(f,r){return this.style.setSchema(f,r),this._update(!0)}getConfig(f){return this.style.getConfig(f)}setConfig(f,r){return this.style.setConfig(f,r),this._update(!0)}getConfigProperty(f,r){return this.style.getConfigProperty(f,r)}setConfigProperty(f,r,l){return this.style.setConfigProperty(f,r,l),this._update(!0)}getFeaturesetDescriptors(f){return this.style.getFeaturesetDescriptors(f)}setLights(f){if(this._lazyInitEmptyStyle(),f&&f.length===1&&f[0].type==="flat"){const r=f[0];r.properties?this.style.setFlatLight(r.properties,r.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(f),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const f=this.style.getLights()||[];return f.length===0&&f.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),f}setLight(f,r={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:f}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(f){return this._lazyInitEmptyStyle(),!f&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(f),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(f){return this._lazyInitEmptyStyle(),this.style.setFog(f),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(f){return this._lazyInitEmptyStyle(),this.style.setSnow(f),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(f){return this._lazyInitEmptyStyle(),this.style.setRain(f),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(f){return this._lazyInitEmptyStyle(),this.style.setColorTheme(f),this._update(!0)}setImportColorTheme(f,r){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(f,r),this._update(!0)}setCamera(f){return this.style.setCamera(f),this._triggerCameraUpdate(f)}_triggerCameraUpdate(f){return this._update(this.transform.setOrthographicProjectionAtLowPitch(f["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(f){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(i.cd.convert(f),this.transform):0}setFeatureState(f,r){return f.source&&!this._isValidId(f.source)?this:(this.style.setFeatureState(f,r),this._update())}removeFeatureState(f,r){return f.source&&!this._isValidId(f.source)?this:(this.style.removeFeatureState(f,r),this._update())}getFeatureState(f){return f.source&&!this._isValidId(f.source)?null:this.style.getFeatureState(f)}_updateContainerDimensions(){if(!this._container)return;const f=this._container.getBoundingClientRect().width||400,r=this._container.getBoundingClientRect().height||300;let l,p,v,w=this._container;for(;w&&(!p||!v);){const C=window.getComputedStyle(w).transform;C&&C!=="none"&&(l=C.match(/matrix.*\((.+)\)/)[1].split(", "),l[0]&&l[0]!=="0"&&l[0]!=="1"&&(p=l[0]),l[3]&&l[3]!=="0"&&l[3]!=="1"&&(v=l[3])),w=w.parentElement}this._containerWidth=p?Math.abs(f/p):f,this._containerHeight=v?Math.abs(r/v):r}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&i.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const f=this._container;f.classList.add("mapboxgl-map"),(this._missingCSSCanary=Z("div","mapboxgl-canary",f)).style.visibility="hidden",this._detectMissingCSS();const r=this._canvasContainer=Z("div","mapboxgl-canvas-container",f);this._canvas=Z("canvas","mapboxgl-canvas",r),this._interactive&&(r.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const l=this._controlContainer=Z("div","mapboxgl-control-container",f),p=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(v=>{p[v]=Z("div",`mapboxgl-ctrl-${v}`,l)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,r){const l=i.q.devicePixelRatio||1;this._canvas.width=l*Math.ceil(f),this._canvas.height=l*Math.ceil(r),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${r}px`}_addMarker(f){this._markers.push(f)}_removeMarker(f){const r=this._markers.indexOf(f);r!==-1&&this._markers.splice(r,1)}_addPopup(f){this._popups.push(f)}_removePopup(f){const r=this._popups.indexOf(f);r!==-1&&this._popups.splice(r,1)}_setupPainter(){const f=i.l({},X.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl2",f);r?(Vn(r,!0),this.painter=new of(r,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp),this.on("data",l=>{l.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),i.m.testSupport(r)):this.fire(new i.z(new Error("Failed to initialize WebGL")))}_contextLost(f){f.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.A("webglcontextlost",{originalEvent:f}))}_contextRestored(f){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style&&(this.style.reloadModels(),this.style.clearSources()),this._update(),this.fire(new i.A("webglcontextrestored",{originalEvent:f}))}_onMapScroll(f){if(f.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(f){return this.style?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_requestDomTask(f){!this.loaded()||this.loaded()&&!this.isMoving()?f():this._domRenderTaskQueue.add(f)}_render(f){let r;this.fire(new i.A("renderstart")),++this._frameId;const l=this.painter.context.extTimerQuery,p=i.q.now(),v=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(r=v.createQuery(),v.beginQuery(l.TIME_ELAPSED_EXT,r)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(f),this._domRenderTaskQueue.run(f),this._removed)return;this._updateProjectionTransition();const w=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const z=this.transform.zoom,j=this.transform.pitch,H=i.q.now(),$=new i.aa(z,{now:H,fadeDuration:w,pitch:j,transition:this.style.transition});this.style.update($)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let C=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),C=this._updateAverageElevation(p),this.style.updateSources(this.transform),this.style.updateImageProviders(),this.isMoving()||this._forceMarkerAndPopupUpdate()):C=this._updateAverageElevation(p);const P=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,w,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),P&&(this._placementDirty=P.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:w,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new i.A("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,k.mark(R.load),this.fire(new i.A("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&this.style.imageManager.hasPatternsInFlight()&&(this._styleDirty=!0),this.style&&!this.style.modelManager.isLoaded()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),r){const z=i.q.now()-p;v.endQuery(l.TIME_ELAPSED_EXT),setTimeout(()=>{const j=v.getQueryParameter(r,v.QUERY_RESULT)/1e6;v.deleteQuery(r),this.fire(new i.A("gpu-timing-frame",{cpuTime:z,gpuTime:j}))},50)}if(this.listens("gpu-timing-layer")){const z=this.painter.collectGpuTimers();setTimeout(()=>{const j=this.painter.queryGpuTimers(z);this.fire(new i.A("gpu-timing-layer",{layerTimes:j}))},50)}if(this.listens("gpu-timing-deferred-render")){const z=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const j=this.painter.queryGpuTimeDeferredRender(z);this.fire(new i.A("gpu-timing-deferred-render",{gpuTime:j}))},50)}const L=this._sourcesDirty||this._styleDirty||this._placementDirty||C;if(L||this._repaint)this.triggerRepaint();else{const z=this.idle();if(z&&(C=this._updateAverageElevation(p,!0)),C)this.triggerRepaint();else if(this._triggerFrame(!1),z&&(this.fire(new i.A("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const j=this._calculateSpeedIndex();this.fire(new i.A("speedindexcompleted",{speedIndex:j})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||L||(this._fullyLoaded=!0,k.mark(R.fullLoad),this._performanceMetricsCollection&&hn(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(f){for(const r of this._markers)f&&!this.getRenderWorldCopies()&&(r._lngLat=r._lngLat.wrap()),r._update();for(const r of this._popups)!f||this.getRenderWorldCopies()||r._trackPointer||(r._lngLat=r._lngLat.wrap()),r._update()}_updateAverageElevation(f,r=!1){const l=v=>(this.transform.averageElevation=v,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&l(0);const p=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(p||(r||f-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(f)){const v=this.transform.averageElevation;let w=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(w)?w=0:this._averageElevationLastSampledAt=f;const C=Math.abs(v-w);if(C>1){if(this._isInitialLoad||p)return this._averageElevation.jumpTo(w),l(w);this._averageElevation.easeTo(w,f,300)}else if(C>1e-4)return this._averageElevation.jumpTo(w),l(w)}return!!this._averageElevation.isEasing(f)&&l(this._averageElevation.getValue(f))}_authenticate(){cr(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,f=>{if(f&&(f.message===_t||f.status===401)){const r=this.painter.context.gl;Vn(r,!1),this._logoControl instanceof oh&&this._logoControl._updateLogo(),r&&r.clear(r.DEPTH_BUFFER_BIT|r.COLOR_BUFFER_BIT|r.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new i.z(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),Ct(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&st(this._requestManager._customAccessToken,{map:this,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const f=this._isDragging();this.painter.updateTerrain(this.style,f)}_calculateSpeedIndex(){const f=this.painter.canvasCopy(),r=this.painter.getCanvasCopiesAndTimestamps();r.timeStamps.push(performance.now());const l=this.painter.context.gl,p=l.createFramebuffer();function v(w){l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,w,0);const C=new Uint8Array(l.drawingBufferWidth*l.drawingBufferHeight*4);return l.readPixels(0,0,l.drawingBufferWidth,l.drawingBufferHeight,l.RGBA,l.UNSIGNED_BYTE,C),C}return l.bindFramebuffer(l.FRAMEBUFFER,p),this._canvasPixelComparison(v(f),r.canvasCopies.map(v),r.timeStamps)}_canvasPixelComparison(f,r,l){let p=l[1]-l[0];const v=f.length/4;for(let w=0;w<r.length;w++){const C=r[w];let P=0;for(let L=0;L<C.length;L+=4)C[L]===f[L]&&C[L+1]===f[L+1]&&C[L+2]===f[L+2]&&C[L+3]===f[L+3]&&(P+=1);p+=(l[w+2]-l[w+1])*(1-P/v)}return p}remove(){this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const f=this.painter.context.gl.getExtension("WEBGL_lose_context");f&&f.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),Nn.delete(this.painter.context.gl),cn.remove(),At.remove(),this._removed=!0,this.fire(new i.A("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(f){this._renderNextFrame=this._renderNextFrame||f,this.style&&!this._frame&&(this._frame=i.q.frame(r=>{const l=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,l&&this._render(r)}))}_preloadTiles(f){const r=this.style?this.style.getSourceCaches():[];return i.bt(r,(l,p)=>l._preloadTiles(f,p),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(f){this._trackResize&&this.resize({originalEvent:f})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(f){this._showParseStatus!==f&&(this._showParseStatus=f,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(f){this._showTerrainWireframe!==f&&(this._showTerrainWireframe=f,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(f){this._showLayers2DWireframe!==f&&(this._showLayers2DWireframe=f,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(f){this._showLayers3DWireframe!==f&&(this._showLayers3DWireframe=f,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(f){this._speedIndexTiming!==f&&(this._speedIndexTiming=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,this._tp.refreshUI(),f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(f){this._showTileAABBs!==f&&(this._showTileAABBs=f,this._tp.refreshUI(),f&&this._update())}_setCacheLimits(f,r){i.eJ(f,r)}get version(){return I}},NavigationControl:class{constructor(f={}){this.options=i.l({},er,f),this._container=Z("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(i.aV(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",r=>{this._map&&this._map.zoomIn({},{originalEvent:r})}),Z("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",r=>{this._map&&this._map.zoomOut({},{originalEvent:r})}),Z("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(i.aV(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",r=>{const l=this._map;l&&(this.options.visualizePitch?l.resetNorthPitch({},{originalEvent:r}):l.resetNorth({},{originalEvent:r}))}),this._compassIcon=Z("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const f=this._map;if(!f)return;const r=f.getZoom(),l=r===f.getMaxZoom(),p=r===f.getMinZoom();this._zoomInButton.disabled=l,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",l.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())}_rotateCompassArrow(){const f=this._map;if(!f)return;const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(f.transform.pitch*(Math.PI/180)),.5)}) rotateX(${f.transform.pitch}deg) rotateZ(${f.transform.angle*(180/Math.PI)}deg)`:`rotate(${f.transform.angle*(180/Math.PI)}deg)`;f._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=r)})}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),f.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&f.on("pitch",this._rotateCompassArrow),f.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new $l(f,this._compass,this.options.visualizePitch)),this._container}onRemove(){const f=this._map;f&&(this._container.remove(),this.options.showZoom&&f.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&f.off("pitch",this._rotateCompassArrow),f.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(f,r){const l=Z("button",f,this._container);return l.type="button",l.addEventListener("click",r),l}_setButtonTitle(f,r){if(!this._map)return;const l=this._map._getUIString(`NavigationControl.${r}`);f.setAttribute("aria-label",l),f.firstElementChild&&f.firstElementChild.setAttribute("title",l)}},GeolocateControl:class extends i.E{constructor(f={}){super();const r=navigator.geolocation;this.options=i.l({geolocation:r},uu,f),i.aV(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=ou(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(f){return this._map=f,this._container=Z("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(f){const r=(l=!!this.options.geolocation)=>{this._supportsGeolocation=l,f(l)};this._supportsGeolocation!==void 0?f(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(l=>r(l.state!=="denied")).catch(()=>r()):r()}_isOutOfMapMaxBounds(f){const r=this._map.getMaxBounds(),l=f.coords;return!!r&&(l.longitude<r.getWest()||l.longitude>r.getEast()||l.latitude<r.getSouth()||l.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(f){if(this._map){if(this._isOutOfMapMaxBounds(f))return this._setErrorState(),this.fire(new i.A("outofmaxbounds",f)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=f,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(f),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(f),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.A("geolocate",f)),this._finish()}}_updateCamera(f){const r=new i.cd(f.coords.longitude,f.coords.latitude),l=f.coords.accuracy,p=this._map.getBearing(),v=i.l({bearing:p},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(l),v,{geolocateSource:!0})}_updateMarker(f){if(f){const r=new i.cd(f.coords.longitude,f.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=f.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const f=this._map.transform,r=i.c6(1,f._center.lat)*f.worldSize,l=Math.ceil(2*this._accuracy*r);this._circleElement.style.width=`${l}px`,this._circleElement.style.height=`${l}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(f){if(this._map){if(this.options.trackUserLocation)if(f.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(f.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.A("error",f)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(f){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=Z("button","mapboxgl-ctrl-geolocate",this._container),Z("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",f===!1){i.w("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",r),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Z("div","mapboxgl-user-location"),this._dotElement.appendChild(Z("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Z("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Tc({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Z("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Tc({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new i.A("trackuserlocationend")))})}}_onDeviceOrientation(f){this._userLocationDotMarker&&(f.webkitCompassHeading?this._heading=f.webkitCompassHeading:f.absolute===!0&&(this._heading=-1*f.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return i.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.A("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.A("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.A("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(f={maximumAge:6e5,timeout:0},this._noTimeout=!0):(f=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,f),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const f=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(r=>{r==="granted"&&f()}).catch(console.error):f()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:yf,ScaleControl:class{constructor(f={}){this.options=i.l({},du,f),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),i.aV(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const f=this.options.maxWidth||100,r=this._map,l=r._containerHeight/2,p=r._containerWidth/2-f/2,v=r.unproject([p,l]),w=r.unproject([p+f,l]),C=v.distanceTo(w);if(this.options.unit==="imperial"){const P=3.2808*C;P>5280?this._setScale(f,P/5280,"mile"):this._setScale(f,P,"foot")}else this.options.unit==="nautical"?this._setScale(f,C/1852,"nautical-mile"):C>=1e3?this._setScale(f,C/1e3,"kilometer"):this._setScale(f,C,"meter")}_setScale(f,r,l){this._map._requestDomTask(()=>{const p=function(w){const C=Math.pow(10,`${Math.floor(w)}`.length-1);let P=w/C;return P=P>=10?10:P>=5?5:P>=3?3:P>=2?2:P>=1?1:function(L){const z=Math.pow(10,Math.ceil(-Math.log(L)/Math.LN10));return Math.round(L*z)/z}(P),C*P}(r),v=p/r;this._container.innerHTML=this._isNumberFormatSupported&&l!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:l}).format(p):`${p}&nbsp;${Hl[l]}`,this._container.style.width=f*v+"px"})}onAdd(f){return this._map=f,this._language=f.getLanguage(),this._container=Z("div","mapboxgl-ctrl mapboxgl-ctrl-scale",f.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(f){this._language=f,this._update()}setUnit(f){this.options.unit=f,this._update()}},FullscreenControl:class{constructor(f={}){this._fullscreen=!1,f&&f.container&&(f.container instanceof HTMLElement?this._container=f.container:i.w("Full screen control 'container' must be a DOM element.")),i.aV(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=Z("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const f=this._fullscreenButton=Z("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Z("span","mapboxgl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",f)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends i.E{constructor(f){super(),this.options=i.l(Object.create(Oa),f),this._altitude=this.options.altitude,i.aV(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(f&&f.className?f.className.trim().split(/\s+/):[])}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&f.on("preclick",this._onClose),this.options.closeOnMove&&f.on("move",this._onClose),f.on("remove",this.remove),this._update(),f._addPopup(this),this._focusFirstElement(),this._trackPointer?(f.on("mousemove",this._onMouseEvent),f.on("mouseup",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")):f.on("move",this._update),this.fire(new i.A("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const f=this._map;return f&&(f.off("move",this._update),f.off("move",this._onClose),f.off("preclick",this._onClose),f.off("click",this._onClose),f.off("remove",this.remove),f.off("mousemove",this._onMouseEvent),f.off("mouseup",this._onMouseEvent),f.off("drag",this._onMouseEvent),f._canvasContainer&&f._canvasContainer.classList.remove("mapboxgl-track-pointer"),f._removePopup(this),this._map=void 0),this.fire(new i.A("close")),this}getLngLat(){return this._lngLat}setLngLat(f){this._lngLat=i.cd.convert(f),this._pos=null,this._trackPointer=!1,this._update();const r=this._map;return r&&(r.on("move",this._update),r.off("mousemove",this._onMouseEvent),r._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}getAltitude(){return this._altitude}setAltitude(f){return this._altitude=f,this._update(),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const f=this._map;return f&&(f.off("move",this._update),f.on("mousemove",this._onMouseEvent),f.on("drag",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(document.createTextNode(f))}setHTML(f){const r=document.createDocumentFragment(),l=document.createElement("body");let p;for(l.innerHTML=f;p=l.firstChild,p;)r.appendChild(p);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){let r=this._content;if(r)for(;r.hasChildNodes();)r.firstChild&&r.removeChild(r.firstChild);else r=this._content=Z("div","mapboxgl-popup-content",this._container||void 0);if(r.appendChild(f),this.options.closeButton){const l=this._closeButton=Z("button","mapboxgl-popup-close-button",r);l.type="button",l.setAttribute("aria-label","Close popup"),l.innerHTML='<span aria-hidden="true">&#215;</span>',l.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(f){return this._classList.add(f),this._updateClassList(),this}removeClassName(f){return this._classList.delete(f),this._updateClassList(),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){let r;return this._classList.delete(f)?r=!1:(this._classList.add(f),r=!0),this._updateClassList(),r}_onMouseEvent(f){this._update(f.point)}_getAnchor(f){if(this.options.anchor)return this.options.anchor;const r=this._map,l=this._container,p=this._pos;if(!r||!l||!p)return"bottom";const v=l.offsetWidth,w=l.offsetHeight,C=p.x<v/2,P=p.x>r.transform.width-v/2;if(p.y+f<w)return C?"top-left":P?"top-right":"top";if(p.y>r.transform.height-w){if(C)return"bottom-left";if(P)return"bottom-right"}return C?"left":P?"right":"bottom"}_updateClassList(){const f=this._container;if(!f)return;const r=[...this._classList];r.push("mapboxgl-popup"),this._anchor&&r.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&r.push("mapboxgl-popup-track-pointer"),f.className=r.join(" ")}_update(f){const r=this._map,l=this._content;if(!r||!this._lngLat&&!this._trackPointer||!l)return;let p=this._container;if(p||(p=this._container=Z("div","mapboxgl-popup",r.getContainer()),this._tip=Z("div","mapboxgl-popup-tip",p),p.appendChild(l)),this.options.maxWidth&&p.style.maxWidth!==this.options.maxWidth&&(p.style.maxWidth=this.options.maxWidth),r.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=gp(this._lngLat,this._pos,r.transform)),!this._trackPointer||f){const v=this._pos=this._trackPointer&&f instanceof i.P?f:r.project(this._lngLat,this._altitude),w=Gl(this.options.offset),C=this._anchor=this._getAnchor(w.y),P=Gl(this.options.offset,C),L=v.add(P).round();r._requestDomTask(()=>{this._container&&C&&(this._container.style.transform=`${_p[C]} translate(${L.x}px,${L.y}px)`)})}if(!this._marker&&r._showingGlobe()){const v=i.eK(r.transform,this._lngLat)?0:1;this._setOpacity(v)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(za);f&&f.focus()}_onClose(){this.remove()}_setOpacity(f){this._container&&(this._container.style.opacity=`${f}`),this._content&&(this._content.style.pointerEvents=f?"auto":"none")}},Marker:Tc,Style:Ra,LngLat:i.cd,LngLatBounds:i.aG,Point:i.P,MercatorCoordinate:i.ac,FreeCameraOptions:lc,Evented:i.E,config:i.e,prewarm:i.eP,clearPrewarmedResources:i.eQ,get accessToken(){return i.e.ACCESS_TOKEN},set accessToken(f){i.e.ACCESS_TOKEN=f},get baseApiUrl(){return i.e.API_URL},set baseApiUrl(f){i.e.API_URL=f},get workerCount(){return i.eR.workerCount},set workerCount(f){i.eR.workerCount=f},get maxParallelImageRequests(){return i.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(f){i.e.MAX_PARALLEL_IMAGE_REQUESTS=f},clearStorage(f){i.eS(f)},get workerUrl(){return i.eT.workerUrl},set workerUrl(f){i.eT.workerUrl=f},get workerClass(){return i.eT.workerClass},set workerClass(f){i.eT.workerClass=f},get workerParams(){return i.eT.workerParams},set workerParams(f){i.eT.workerParams=f},get dracoUrl(){return i.eU()},set dracoUrl(f){i.eV(f)},get meshoptUrl(){return i.eW()},set meshoptUrl(f){i.eX(f)},setNow:i.q.setNow,restoreNow:i.q.restoreNow}});var x=d;return x})}(C0)),C0.exports}var VZ=BZ();const mh=mg(VZ),U_=async(e,n)=>{try{const o=await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${e},${n}.json?access_token=${mh.accessToken}`);if(!o.ok)throw new Error("Erreur lors de la rcupration de l'adresse");const c=await o.json();if(c.features&&c.features.length>0){const d=c.features[0];let y=d.place_name||"",x="",i="";if(d.context)for(const I of d.context)I.id.startsWith("place")?x=I.text:I.id.startsWith("postcode")&&(i=I.text);return{address:y,city:x,postalCode:i}}return null}catch(o){throw console.error("Erreur de gocodage inverse:",o),o}},UZ=async e=>{try{const n=await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(e)}.json?access_token=${mh.accessToken}&limit=1&language=fr&country=be`);if(!n.ok)throw new Error("Erreur lors du gocodage de l'adresse");const o=await n.json();if(o.features&&o.features.length>0){const c=o.features[0],[d,y]=c.center;let x="",i="";if(c.context)for(const I of c.context)I.id.startsWith("place")?x=I.text:I.id.startsWith("postcode")&&(i=I.text);return{address:c.place_name,city:x,postalCode:i,latitude:y,longitude:d}}return null}catch(n){throw console.error("Erreur de gocodage direct:",n),n}};mh.accessToken="pk.eyJ1IjoiYmlidXB0bWMiLCJhIjoiY203aml3emgwMDNkczJtc2IyNWN6d3R6ayJ9.IaKOc6xB22IkBr710VV-ng";const $Z=({value:e,onChange:n,onLocationSelect:o,placeholder:c})=>{const{t:d}=Rs(),y=c||d("map.addressPlaceholder","Entrez une adresse"),[x,i]=V.useState([]),[I,R]=V.useState(!1),[k,N]=V.useState(!1),U=V.useRef(null),K=V.useRef(null);V.useEffect(()=>{const de=ue=>{U.current&&!U.current.contains(ue.target)&&K.current&&!K.current.contains(ue.target)&&N(!1)};return document.addEventListener("mousedown",de),()=>{document.removeEventListener("mousedown",de)}},[]);const X=async de=>{if(!de||de.length<3){i([]);return}R(!0);try{const ue=`https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(de)}.json`,pe=new URLSearchParams({access_token:"pk.eyJ1IjoiYmlidXB0bWMiLCJhIjoiY203aml3emgwMDNkczJtc2IyNWN6d3R6ayJ9.IaKOc6xB22IkBr710VV-ng",types:"address,place",limit:5,language:"fr",country:"be"}),xe=await(await fetch(`${ue}?${pe}`)).json();xe.features&&(i(xe.features),N(!0))}catch(ue){console.error("Erreur lors de la rcupration des suggestions:",ue)}finally{R(!1)}},Z=async de=>{const ue=de.target.value;if(ue&&(!x.length||!x.some(pe=>pe.place_name===ue)))try{const pe=await UZ(ue);pe&&o&&o(pe)}catch{}},J=de=>{const ue=de.target.value;n(ue),window.addressTimeout&&clearTimeout(window.addressTimeout),window.addressTimeout=setTimeout(()=>{X(ue)},300)},le=de=>{const{place_name:ue,center:pe}=de,[he,xe]=pe;let fe=ue,_e="",Ce="";if(de.context){const je=de.context.find(lt=>lt.id.startsWith("postcode")),He=de.context.find(lt=>lt.id.startsWith("place"));Ce=je?je.text:"",_e=He?He.text:""}n(ue),o&&o({address:fe,city:_e,postalCode:Ce,latitude:xe,longitude:he}),N(!1)};return T.jsxs("div",{className:"position-relative",children:[T.jsxs("div",{className:"input-group",children:[T.jsx("span",{className:"input-group-text",children:T.jsx(zc,{})}),T.jsx(ot.Control,{ref:K,type:"text",value:e,onChange:J,placeholder:y,onFocus:()=>e&&x.length>0&&N(!0),onBlur:Z,autoComplete:"off"})]}),k&&x.length>0&&T.jsx(hd,{ref:U,className:"position-absolute w-100 shadow-sm",style:{maxHeight:"250px",overflowY:"auto",zIndex:1e3},children:x.map(de=>T.jsx(hd.Item,{action:!0,onClick:()=>le(de),className:"py-2",children:T.jsxs("div",{className:"d-flex align-items-center",children:[T.jsx(zc,{className:"me-2 text-primary"}),T.jsx("div",{children:T.jsx("div",{children:de.place_name})})]})},de.id))}),I&&T.jsx("div",{className:"position-absolute end-0 top-0 mt-2 me-2",children:T.jsx("div",{className:"spinner-border spinner-border-sm text-primary",role:"status",children:T.jsx("span",{className:"visually-hidden",children:d("map.loading","Chargement...")})})})]})};mh.accessToken="pk.eyJ1IjoiYmlidXB0bWMiLCJhIjoiY203aml3emgwMDNkczJtc2IyNWN6d3R6ayJ9.IaKOc6xB22IkBr710VV-ng";const Xv=({location:e,onLocationChange:n,onAddressChange:o,isLocating:c,geoError:d,onGeoErrorDismiss:y,onRequestCurrentLocation:x,mapHeight:i="300px",markers:I=[],showSearch:R=!0,fitBoundsToMarkers:k=!0,disableMapClick:N=!1,mapRef:U=null})=>{const{t:K}=Rs(),X=V.useRef(null),Z=V.useRef(null),J=V.useRef(null),le=V.useRef([]),[de,ue]=V.useState((e==null?void 0:e.address)||""),pe=V.useCallback((xe,fe)=>{if(!X.current||Z.current)return;const _e=xe||4.3517,Ce=fe||50.8503;Z.current=new mh.Map({container:X.current,style:"mapbox://styles/mapbox/streets-v11",center:[_e,Ce],zoom:11,maxZoom:16,minZoom:8,attributionControl:!1,preserveDrawingBuffer:!1,localIdeographFontFamily:"'Noto Sans', 'Noto Sans CJK SC', sans-serif",fadeDuration:0,trackResize:!1}),Z.current.on("styleimagemissing",je=>{const He=document.createElement("canvas");He.width=20,He.height=20;const lt=He.getContext("2d");lt.beginPath(),lt.arc(10,10,8,0,2*Math.PI),lt.fillStyle="#ffcc00",lt.fill(),lt.strokeStyle="#333",lt.lineWidth=1,lt.stroke(),Z.current.addImage(je.id,{width:20,height:20,data:new Uint8Array(lt.getImageData(0,0,20,20).data.buffer)})}),Z.current.addControl(new mh.NavigationControl({showCompass:!1,showZoom:!0}),"top-right"),n&&!N&&(J.current=new mh.Marker({draggable:!0}).setLngLat([_e,Ce]).addTo(Z.current),J.current.on("dragend",()=>{const je=J.current.getLngLat();n(je.lng,je.lat)}),Z.current.on("click",je=>{(!je.features||!je.features.length)&&(J.current.setLngLat([je.lngLat.lng,je.lngLat.lat]),n(je.lngLat.lng,je.lngLat.lat))})),Z.current.on("load",()=>{Z.current.resize()}),U&&(U.current=Z.current)},[n,N,U]);V.useEffect(()=>(e.longitude&&e.latitude?Z.current?Z.current.setCenter([e.longitude,e.latitude]):pe(e.longitude,e.latitude):Z.current||pe(2.3488,48.8534),()=>{Z.current&&(le.current.forEach(xe=>xe.remove()),le.current=[],Z.current.remove(),Z.current=null)}),[]),V.useEffect(()=>{Z.current&&(e!=null&&e.longitude)&&(e!=null&&e.latitude)&&(Z.current.setCenter([e.longitude,e.latitude]),J.current&&J.current.setLngLat([e.longitude,e.latitude]))},[e==null?void 0:e.longitude,e==null?void 0:e.latitude]),V.useEffect(()=>{(e==null?void 0:e.address)!==de&&ue((e==null?void 0:e.address)||"")},[e==null?void 0:e.address,de]);const he=xe=>{xe.longitude&&xe.latitude&&n(xe.longitude,xe.latitude),o&&o({address:xe.address,city:xe.city,postalCode:xe.postalCode})};return V.useEffect(()=>{if(Z.current&&(le.current.forEach(xe=>xe.remove()),le.current=[],I.length>0)){const xe=()=>{const _e=document.createElement("div");return _e.className="cat-marker",_e.style.width="30px",_e.style.height="30px",_e.style.backgroundColor="white",_e.style.borderRadius="50%",_e.style.display="flex",_e.style.justifyContent="center",_e.style.alignItems="center",_e.style.fontSize="18px",_e.style.boxShadow="0 2px 6px rgba(0,0,0,0.3)",_e.style.cursor="pointer",_e.innerHTML="",_e},fe=new mh.LngLatBounds;I.forEach(_e=>{if(_e.longitude&&_e.latitude){fe.extend([_e.longitude,_e.latitude]);const Ce=new mh.Marker({element:xe()}).setLngLat([_e.longitude,_e.latitude]).addTo(Z.current);_e.popupContent&&Ce.setPopup(new mh.Popup({offset:25}).setHTML(_e.popupContent)),le.current.push(Ce)}}),k&&fe.isEmpty()===!1&&Z.current.fitBounds(fe,{padding:50})}},[I,k]),T.jsxs("div",{className:"map-component",children:[R&&T.jsx(vi,{className:"mb-3",children:T.jsx(Un,{children:T.jsx($Z,{value:de,onChange:xe=>{ue(xe),o&&o({address:xe})},onLocationSelect:he,placeholder:K("map.searchPlaceholder","Rechercher une adresse...")})})}),T.jsxs("div",{className:"position-relative mb-2",children:[T.jsx("div",{ref:X,className:"map-container rounded",style:{height:i,width:"100%"}}),c&&T.jsxs("div",{className:"position-absolute top-50 start-50 translate-middle bg-white p-2 rounded shadow",children:[T.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),K("map.locating","Localisation en cours...")]}),x&&T.jsxs(Qn,{variant:"primary",size:"sm",className:"position-absolute bottom-0 end-0 m-2",onClick:x,children:[T.jsx(zc,{className:"me-1"})," ",K("map.myPosition","Ma position")]})]}),d&&T.jsx(mi,{variant:"warning",className:"mt-2",onClose:y,dismissible:!0,children:d}),R&&T.jsx("p",{className:"text-muted mt-2",children:T.jsx("small",{children:K("map.help","Recherchez une adresse ou cliquez sur la carte pour dfinir la localisation")})})]})},V1=()=>{const[e,n]=V.useState(!1),[o,c]=V.useState(null),d=V.useRef(!0);return V.useEffect(()=>(d.current=!0,()=>{d.current=!1}),[]),{getCurrentPosition:V.useCallback(()=>(n(!0),c(null),new Promise((x,i)=>{if(!navigator.geolocation){const I=new Error("La golocalisation n'est pas prise en charge par votre navigateur");d.current&&(c(I.message),n(!1)),i(I);return}navigator.geolocation.getCurrentPosition(I=>{d.current&&n(!1),x({latitude:I.coords.latitude,longitude:I.coords.longitude})},I=>{let R="Erreur de golocalisation";I.code===1&&(R="Permission de golocalisation refuse"),I.code===2&&(R="Position non disponible"),I.code===3&&(R="Dlai d'attente expir"),d.current&&(c(R),n(!1)),i(I)},{enableHighAccuracy:!0,timeout:5e3,maximumAge:0})})),[]),isLocating:e,geoError:o,setGeoError:c}},z4=e=>{let n=e.replace(/[^\d+]/g,"");if(n.startsWith("+")){if(n.length>3){let o="+"+n.substring(1,3);return n.length>5&&(o+=" "+n.substring(3,6)),n.length>7&&(o+=" "+n.substring(6,8)),n.length>9&&(o+=" "+n.substring(8,10)),n.length>10&&(o+=" "+n.substring(10)),o}return n}else return n.length>4&&(n=n.substring(0,4)+" "+n.substring(4)),n.length>7&&(n=n.substring(0,7)+" "+n.substring(7)),n.length>10&&(n=n.substring(0,10)+" "+n.substring(10)),n},_S=e=>{const n=/^(\+\d{1,3}[- ]?)?\d{1,4}[- ]?\d{1,4}[- ]?\d{1,4}[- ]?\d{1,4}$/;return e?n.test(e)?{isValid:!0,errorMessage:""}:{isValid:!1,errorMessage:"Le format du numro de tlphone n'est pas valide"}:{isValid:!0,errorMessage:""}},$_=()=>{const e=ml(),[n,o]=V.useState(null),[c,d]=V.useState(!0),[y,x]=V.useState(null),i=V.useCallback((I,R)=>{if(!I||!R)return R;const k=I.find(N=>N.value===R);return k?k.label:R},[]);return V.useEffect(()=>{(async()=>{try{d(!0);const R=await e.get("enums/all");o(R),x(null)}catch(R){x(R.message||"Erreur lors du chargement des numrations"),o(null)}finally{d(!1)}})()},[e]),{enums:n,loading:c,error:y,getEnumLabel:i}},HZ=()=>{const{t:e}=Rs(),n=Cu(),o=ml(),{enums:c,loading:d,error:y}=$_(),[x,i]=V.useState({userName:"bibu",email:"bibu@gmail.com",password:"Patamon10#",matchingPassword:"Patamon10#",firstName:"Anais",lastName:"Motquin",birthDay:"",phone:"0493 96 33 75",gender:"FEMME",location:{address:"",city:"",postalCode:"",latitude:null,longitude:null}}),[I,R]=V.useState(!0),[k,N]=V.useState(!1),[U,K]=V.useState(!1),[X,Z]=V.useState(""),[J,le]=V.useState(!1),[de,ue]=V.useState(!1),[pe,he]=V.useState(""),[xe,fe]=V.useState(""),[_e,Ce]=V.useState(""),[je,He]=V.useState(null),lt=new Date().toISOString().split("T")[0],_t=At=>{const Ct=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/;return At?Ct.test(At)?(he(""),!0):(he("L'adresse email n'est pas valide"),!1):(he("L'adresse email est requise"),!1)},Ue=At=>{const Ct=z4(At.target.value);i(Bt=>({...Bt,phone:Ct}));const{isValid:We,errorMessage:st}=_S(Ct);Ce(st)},{getCurrentPosition:Ge,isLocating:at,geoError:yt,setGeoError:tt}=V1(),Rt=V.useCallback(async(At,Ct)=>{try{const We=await U_(At,Ct);i(st=>({...st,longitude:At,latitude:Ct,address:(We==null?void 0:We.address)||"",city:(We==null?void 0:We.city)||"",postalCode:(We==null?void 0:We.postalCode)||""}))}catch(We){console.error("Erreur lors de la rcupration de l'adresse:",We),He("Erreur lors de la rcupration de l'adresse")}},[]);V.useEffect(()=>{Ge().then(At=>{Rt(At.longitude,At.latitude)}).catch(At=>{console.log("Utilisation de la position par dfaut:",At.message)})},[Ge,Rt]);const ct=()=>{Ge().then(At=>{Rt(At.longitude,At.latitude)})},ze=At=>{const{name:Ct,value:We}=At.target;if(Ct==="phone"?Ue(At):i({...x,[Ct]:We}),Ct==="email"&&_t(We),Ct==="birthDay")if(We){const st=new Date(We),Bt=new Date;if(Bt.setHours(0,0,0,0),st>Bt)fe("La date de naissance ne peut pas tre dans le futur");else{fe("");const hn=We.split("T")[0];i(cn=>({...cn,birthDay:hn}));return}}else fe("");R(!0),N(!1),K(!1),Z("")},Ye=At=>{if(At.preventDefault(),!_t(x.email)||xe||!_S(x.phone))return;if(x.password!==x.matchingPassword){R(!1);return}if(!/(?=^.{8,}$)((?=.*\d)|(?=.*\W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$/.test(x.password)){K(!0);return}o.post("/auth/signup",x).then(We=>{console.log("Rponse de l'API :",We);const st=We.token;st?(sessionStorage.setItem("token",st),N(!0),setTimeout(()=>{n("/login")},2e3)):Z("Token non trouv dans la rponse de l'API")}).catch(We=>{var Bt,hn;console.error("Erreur lors de l'inscription :",We);const st=(hn=(Bt=We.response)==null?void 0:Bt.data)==null?void 0:hn.message;Z(st==="Email already exists"?"Cette adresse email est dj utilise":st==="Username already exists"?"Ce nom d'utilisateur est dj utilis":st==="Phone number already exists"?"Ce numro de tlphone est dj utilis":st||"Une erreur inattendue s'est produite. Veuillez ressayer plus tard.")})};return T.jsx(Ro,{className:"py-5",children:T.jsx(vi,{className:"justify-content-center",children:T.jsx(Un,{md:8,children:T.jsx(Za.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:T.jsx(yn,{className:"shadow-sm",children:T.jsxs(yn.Body,{className:"p-4",children:[T.jsxs("div",{className:"text-center mb-4",children:[T.jsx("h2",{children:"Inscription"}),T.jsx("p",{className:"text-muted",children:"Rejoignez la communaut WhiskerQuest"})]}),X&&T.jsx(mi,{variant:"danger",className:"mb-4",children:X}),k&&T.jsx(mi,{variant:"success",className:"mb-4",children:"Inscription russie ! Redirection vers la page de connexion..."}),T.jsxs(ot,{onSubmit:Ye,children:[T.jsx(yn,{className:"mb-4",children:T.jsxs(yn.Body,{children:[T.jsx("h5",{className:"mb-3",children:"Informations de connexion"}),T.jsxs(ot.Group,{className:"mb-3",children:[T.jsxs(ot.Label,{children:[T.jsx(Gp,{className:"me-2"}),"Nom d'utilisateur"]}),T.jsx(ot.Control,{type:"text",name:"userName",value:x.userName,onChange:ze,placeholder:"Choisissez un nom d'utilisateur",required:!0})]}),T.jsxs(ot.Group,{className:"mb-3",children:[T.jsxs(ot.Label,{children:[T.jsx(cg,{className:"me-2"}),"Email"]}),T.jsx(ot.Control,{type:"email",name:"email",value:x.email,onChange:ze,placeholder:"Entrez votre email",required:!0,isInvalid:!!pe}),pe&&T.jsx(ot.Control.Feedback,{type:"invalid",children:pe})]}),T.jsxs(vi,{children:[T.jsx(Un,{md:6,children:T.jsxs(ot.Group,{className:"mb-3",children:[T.jsxs(ot.Label,{children:[T.jsx(S_,{className:"me-2"}),"Mot de passe"]}),T.jsxs(V2,{children:[T.jsx(ot.Control,{type:J?"text":"password",name:"password",value:x.password,onChange:ze,placeholder:"Crez votre mot de passe",required:!0,isInvalid:!I||U}),T.jsx(Qn,{variant:"outline-secondary",onClick:()=>le(!J),style:{borderColor:!I||U?"#dc3545":""},children:J?T.jsx(Vp,{}):T.jsx(Up,{})}),T.jsx(ot.Control.Feedback,{type:"invalid",children:U&&"Le mot de passe doit contenir au moins 8 caractres, une majuscule, une minuscule et un chiffre ou caractre spcial."})]})]})}),T.jsx(Un,{md:6,children:T.jsxs(ot.Group,{className:"mb-3",children:[T.jsxs(ot.Label,{children:[T.jsx(S_,{className:"me-2"}),"Confirmer"]}),T.jsxs(V2,{children:[T.jsx(ot.Control,{type:de?"text":"password",name:"matchingPassword",value:x.matchingPassword,onChange:ze,placeholder:"Confirmez le mot de passe",required:!0,isInvalid:!I}),T.jsx(Qn,{variant:"outline-secondary",onClick:()=>ue(!de),style:{borderColor:I?"":"#dc3545"},children:de?T.jsx(Vp,{}):T.jsx(Up,{})}),!I&&T.jsx(ot.Control.Feedback,{type:"invalid",children:"Les mots de passe ne correspondent pas"})]})]})})]})]})}),T.jsx(yn,{className:"mb-4",children:T.jsxs(yn.Body,{children:[T.jsx("h5",{className:"mb-3",children:"Informations personnelles"}),T.jsxs(vi,{children:[T.jsx(Un,{md:6,children:T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:"Prnom"}),T.jsx(ot.Control,{type:"text",name:"firstName",value:x.firstName,onChange:ze,placeholder:"Votre prnom",required:!0})]})}),T.jsx(Un,{md:6,children:T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:"Nom"}),T.jsx(ot.Control,{type:"text",name:"lastName",value:x.lastName,onChange:ze,placeholder:"Votre nom",required:!0})]})})]}),T.jsxs(vi,{children:[T.jsx(Un,{md:6,children:T.jsxs(ot.Group,{className:"mb-3",children:[T.jsxs(ot.Label,{children:[T.jsx(b7,{className:"me-2"}),"Date de naissance"]}),T.jsx(ot.Control,{type:"date",name:"birthDay",value:x.birthDay,onChange:ze,max:lt,isInvalid:!!xe,required:!0}),xe&&T.jsx(ot.Control.Feedback,{type:"invalid",children:xe})]})}),T.jsx(Un,{md:6,children:T.jsxs(ot.Group,{className:"mb-3",children:[T.jsxs(ot.Label,{children:[T.jsx(YO,{className:"me-2"}),"Genre"]}),T.jsxs(ot.Select,{name:"gender",value:x.gender,onChange:ze,required:!0,disabled:d||y,children:[T.jsx("option",{value:"",children:"Slectionnez le genre"}),c&&c.gender.map(At=>T.jsx("option",{value:At.value,children:At.label},At.value))]}),y&&T.jsx("div",{className:"text-danger",children:"Erreur lors du chargement des genres"})]})})]}),T.jsxs(ot.Group,{className:"mb-3",children:[T.jsxs(ot.Label,{children:[T.jsx(O1,{className:"me-2"}),e("register.phoneLabel","Tlphone")]}),T.jsx(ot.Control,{type:"tel",name:"phone",value:x.phone,onChange:ze,placeholder:e("register.phonePlaceholder","Votre numro de tlphone (ex: 0493 96 33 75)"),isInvalid:!!_e}),_e&&T.jsx(ot.Control.Feedback,{type:"invalid",children:e("register.phoneInvalid",_e)})]})]})}),T.jsx(yn,{className:"mb-4",children:T.jsxs(yn.Body,{children:[T.jsx("h5",{className:"mb-3",children:e("register.addressTitle","Adresse")}),T.jsx(Xv,{location:{address:x.address,city:x.city,postalCode:x.postalCode,latitude:x.latitude,longitude:x.longitude},onLocationChange:(At,Ct)=>Rt(At,Ct),onAddressChange:At=>{i({...x,address:At.address,city:At.city,postalCode:At.postalCode})},isLocating:at,geoError:yt,onGeoErrorDismiss:()=>tt(""),onRequestCurrentLocation:ct,mapHeight:"300px"})]})}),T.jsx(ot.Group,{className:"mb-4",children:T.jsx(ot.Check,{required:!0,label:e("register.terms","J'accepte les termes et conditions"),feedback:e("register.termsFeedback","Vous devez accepter avant de soumettre."),feedbackType:"invalid"})}),T.jsx("div",{className:"d-grid gap-2",children:T.jsx(Qn,{variant:"light",type:"submit",size:"lg",style:YC,children:e("register.submit","S'inscrire")})})]}),T.jsx("div",{className:"text-center mt-4",children:T.jsxs("p",{className:"text-muted",children:[e("register.alreadyMember","Dj membre ?")," ",T.jsx(co,{to:"/login",className:"text-primary",children:e("register.login","Se connecter")})]})})]})})})})})})};function ug(e){"@babel/helpers - typeof";return ug=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},ug(e)}function GZ(e,n){if(ug(e)!="object"||!e)return e;var o=e[Symbol.toPrimitive];if(o!==void 0){var c=o.call(e,n);if(ug(c)!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function F4(e){var n=GZ(e,"string");return ug(n)=="symbol"?n:n+""}function iv(e,n,o){return(n=F4(n))in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function VM(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);n&&(c=c.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),o.push.apply(o,c)}return o}function Wr(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{};n%2?VM(Object(o),!0).forEach(function(c){iv(e,c,o[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):VM(Object(o)).forEach(function(c){Object.defineProperty(e,c,Object.getOwnPropertyDescriptor(o,c))})}return e}function WZ(e){if(Array.isArray(e))return e}function qZ(e,n){var o=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(o!=null){var c,d,y,x,i=[],I=!0,R=!1;try{if(y=(o=o.call(e)).next,n===0){if(Object(o)!==o)return;I=!1}else for(;!(I=(c=y.call(o)).done)&&(i.push(c.value),i.length!==n);I=!0);}catch(k){R=!0,d=k}finally{try{if(!I&&o.return!=null&&(x=o.return(),Object(x)!==x))return}finally{if(R)throw d}}return i}}function yS(e,n){(n==null||n>e.length)&&(n=e.length);for(var o=0,c=Array(n);o<n;o++)c[o]=e[o];return c}function N4(e,n){if(e){if(typeof e=="string")return yS(e,n);var o={}.toString.call(e).slice(8,-1);return o==="Object"&&e.constructor&&(o=e.constructor.name),o==="Map"||o==="Set"?Array.from(e):o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?yS(e,n):void 0}}function ZZ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ef(e,n){return WZ(e)||qZ(e,n)||N4(e,n)||ZZ()}function Df(e,n){if(e==null)return{};var o,c,d=jr(e,n);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(c=0;c<y.length;c++)o=y[c],n.indexOf(o)===-1&&{}.propertyIsEnumerable.call(e,o)&&(d[o]=e[o])}return d}var XZ=["defaultInputValue","defaultMenuIsOpen","defaultValue","inputValue","menuIsOpen","onChange","onInputChange","onMenuClose","onMenuOpen","value"];function KZ(e){var n=e.defaultInputValue,o=n===void 0?"":n,c=e.defaultMenuIsOpen,d=c===void 0?!1:c,y=e.defaultValue,x=y===void 0?null:y,i=e.inputValue,I=e.menuIsOpen,R=e.onChange,k=e.onInputChange,N=e.onMenuClose,U=e.onMenuOpen,K=e.value,X=Df(e,XZ),Z=V.useState(i!==void 0?i:o),J=Ef(Z,2),le=J[0],de=J[1],ue=V.useState(I!==void 0?I:d),pe=Ef(ue,2),he=pe[0],xe=pe[1],fe=V.useState(K!==void 0?K:x),_e=Ef(fe,2),Ce=_e[0],je=_e[1],He=V.useCallback(function(tt,Rt){typeof R=="function"&&R(tt,Rt),je(tt)},[R]),lt=V.useCallback(function(tt,Rt){var ct;typeof k=="function"&&(ct=k(tt,Rt)),de(ct!==void 0?ct:tt)},[k]),_t=V.useCallback(function(){typeof U=="function"&&U(),xe(!0)},[U]),Ue=V.useCallback(function(){typeof N=="function"&&N(),xe(!1)},[N]),Ge=i!==void 0?i:le,at=I!==void 0?I:he,yt=K!==void 0?K:Ce;return Wr(Wr({},X),{},{inputValue:Ge,menuIsOpen:at,onChange:He,onInputChange:lt,onMenuClose:Ue,onMenuOpen:_t,value:yt})}function YZ(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function UM(e,n){for(var o=0;o<n.length;o++){var c=n[o];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(e,F4(c.key),c)}}function JZ(e,n,o){return n&&UM(e.prototype,n),o&&UM(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function QZ(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&L0(e,n)}function Y0(e){return Y0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Y0(e)}function j4(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(j4=function(){return!!e})()}function B4(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eX(e,n){if(n&&(ug(n)=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return B4(e)}function tX(e){var n=j4();return function(){var o,c=Y0(e);if(n){var d=Y0(this).constructor;o=Reflect.construct(c,arguments,d)}else o=c.apply(this,arguments);return eX(this,o)}}function nX(e){if(Array.isArray(e))return yS(e)}function rX(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function iX(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JC(e){return nX(e)||rX(e)||N4(e)||iX()}function sX(e){if(e.sheet)return e.sheet;for(var n=0;n<document.styleSheets.length;n++)if(document.styleSheets[n].ownerNode===e)return document.styleSheets[n]}function oX(e){var n=document.createElement("style");return n.setAttribute("data-emotion",e.key),e.nonce!==void 0&&n.setAttribute("nonce",e.nonce),n.appendChild(document.createTextNode("")),n.setAttribute("data-s",""),n}var aX=function(){function e(o){var c=this;this._insertTag=function(d){var y;c.tags.length===0?c.insertionPoint?y=c.insertionPoint.nextSibling:c.prepend?y=c.container.firstChild:y=c.before:y=c.tags[c.tags.length-1].nextSibling,c.container.insertBefore(d,y),c.tags.push(d)},this.isSpeedy=o.speedy===void 0?!0:o.speedy,this.tags=[],this.ctr=0,this.nonce=o.nonce,this.key=o.key,this.container=o.container,this.prepend=o.prepend,this.insertionPoint=o.insertionPoint,this.before=null}var n=e.prototype;return n.hydrate=function(c){c.forEach(this._insertTag)},n.insert=function(c){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(oX(this));var d=this.tags[this.tags.length-1];if(this.isSpeedy){var y=sX(d);try{y.insertRule(c,y.cssRules.length)}catch{}}else d.appendChild(document.createTextNode(c));this.ctr++},n.flush=function(){this.tags.forEach(function(c){var d;return(d=c.parentNode)==null?void 0:d.removeChild(c)}),this.tags=[],this.ctr=0},e}(),Va="-ms-",J0="-moz-",fs="-webkit-",V4="comm",QC="rule",eT="decl",lX="@import",U4="@keyframes",cX="@layer",uX=Math.abs,U1=String.fromCharCode,dX=Object.assign;function hX(e,n){return ba(e,0)^45?(((n<<2^ba(e,0))<<2^ba(e,1))<<2^ba(e,2))<<2^ba(e,3):0}function $4(e){return e.trim()}function fX(e,n){return(e=n.exec(e))?e[0]:e}function ps(e,n,o){return e.replace(n,o)}function vS(e,n){return e.indexOf(n)}function ba(e,n){return e.charCodeAt(n)|0}function Pv(e,n,o){return e.slice(n,o)}function gh(e){return e.length}function tT(e){return e.length}function l0(e,n){return n.push(e),e}function pX(e,n){return e.map(n).join("")}var $1=1,I_=1,H4=0,nc=0,$o=0,H_="";function H1(e,n,o,c,d,y,x){return{value:e,root:n,parent:o,type:c,props:d,children:y,line:$1,column:I_,length:x,return:""}}function Wy(e,n){return dX(H1("",null,null,"",null,null,0),e,{length:-e.length},n)}function mX(){return $o}function gX(){return $o=nc>0?ba(H_,--nc):0,I_--,$o===10&&(I_=1,$1--),$o}function Lc(){return $o=nc<H4?ba(H_,nc++):0,I_++,$o===10&&(I_=1,$1++),$o}function Th(){return ba(H_,nc)}function T0(){return nc}function Kv(e,n){return Pv(H_,e,n)}function Av(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function G4(e){return $1=I_=1,H4=gh(H_=e),nc=0,[]}function W4(e){return H_="",e}function E0(e){return $4(Kv(nc-1,xS(e===91?e+2:e===40?e+1:e)))}function _X(e){for(;($o=Th())&&$o<33;)Lc();return Av(e)>2||Av($o)>3?"":" "}function yX(e,n){for(;--n&&Lc()&&!($o<48||$o>102||$o>57&&$o<65||$o>70&&$o<97););return Kv(e,T0()+(n<6&&Th()==32&&Lc()==32))}function xS(e){for(;Lc();)switch($o){case e:return nc;case 34:case 39:e!==34&&e!==39&&xS($o);break;case 40:e===41&&xS(e);break;case 92:Lc();break}return nc}function vX(e,n){for(;Lc()&&e+$o!==57;)if(e+$o===84&&Th()===47)break;return"/*"+Kv(n,nc-1)+"*"+U1(e===47?e:Lc())}function xX(e){for(;!Av(Th());)Lc();return Kv(e,nc)}function bX(e){return W4(I0("",null,null,null,[""],e=G4(e),0,[0],e))}function I0(e,n,o,c,d,y,x,i,I){for(var R=0,k=0,N=x,U=0,K=0,X=0,Z=1,J=1,le=1,de=0,ue="",pe=d,he=y,xe=c,fe=ue;J;)switch(X=de,de=Lc()){case 40:if(X!=108&&ba(fe,N-1)==58){vS(fe+=ps(E0(de),"&","&\f"),"&\f")!=-1&&(le=-1);break}case 34:case 39:case 91:fe+=E0(de);break;case 9:case 10:case 13:case 32:fe+=_X(X);break;case 92:fe+=yX(T0()-1,7);continue;case 47:switch(Th()){case 42:case 47:l0(wX(vX(Lc(),T0()),n,o),I);break;default:fe+="/"}break;case 123*Z:i[R++]=gh(fe)*le;case 125*Z:case 59:case 0:switch(de){case 0:case 125:J=0;case 59+k:le==-1&&(fe=ps(fe,/\f/g,"")),K>0&&gh(fe)-N&&l0(K>32?HM(fe+";",c,o,N-1):HM(ps(fe," ","")+";",c,o,N-2),I);break;case 59:fe+=";";default:if(l0(xe=$M(fe,n,o,R,k,d,i,ue,pe=[],he=[],N),y),de===123)if(k===0)I0(fe,n,xe,xe,pe,y,N,i,he);else switch(U===99&&ba(fe,3)===110?100:U){case 100:case 108:case 109:case 115:I0(e,xe,xe,c&&l0($M(e,xe,xe,0,0,d,i,ue,d,pe=[],N),he),d,he,N,i,c?pe:he);break;default:I0(fe,xe,xe,xe,[""],he,0,i,he)}}R=k=K=0,Z=le=1,ue=fe="",N=x;break;case 58:N=1+gh(fe),K=X;default:if(Z<1){if(de==123)--Z;else if(de==125&&Z++==0&&gX()==125)continue}switch(fe+=U1(de),de*Z){case 38:le=k>0?1:(fe+="\f",-1);break;case 44:i[R++]=(gh(fe)-1)*le,le=1;break;case 64:Th()===45&&(fe+=E0(Lc())),U=Th(),k=N=gh(ue=fe+=xX(T0())),de++;break;case 45:X===45&&gh(fe)==2&&(Z=0)}}return y}function $M(e,n,o,c,d,y,x,i,I,R,k){for(var N=d-1,U=d===0?y:[""],K=tT(U),X=0,Z=0,J=0;X<c;++X)for(var le=0,de=Pv(e,N+1,N=uX(Z=x[X])),ue=e;le<K;++le)(ue=$4(Z>0?U[le]+" "+de:ps(de,/&\f/g,U[le])))&&(I[J++]=ue);return H1(e,n,o,d===0?QC:i,I,R,k)}function wX(e,n,o){return H1(e,n,o,V4,U1(mX()),Pv(e,2,-2),0)}function HM(e,n,o,c){return H1(e,n,o,eT,Pv(e,0,c),Pv(e,c+1,-1),c)}function p_(e,n){for(var o="",c=tT(e),d=0;d<c;d++)o+=n(e[d],d,e,n)||"";return o}function SX(e,n,o,c){switch(e.type){case cX:if(e.children.length)break;case lX:case eT:return e.return=e.return||e.value;case V4:return"";case U4:return e.return=e.value+"{"+p_(e.children,c)+"}";case QC:e.value=e.props.join(",")}return gh(o=p_(e.children,c))?e.return=e.value+"{"+o+"}":""}function CX(e){var n=tT(e);return function(o,c,d,y){for(var x="",i=0;i<n;i++)x+=e[i](o,c,d,y)||"";return x}}function TX(e){return function(n){n.root||(n=n.return)&&e(n)}}function q4(e){var n=Object.create(null);return function(o){return n[o]===void 0&&(n[o]=e(o)),n[o]}}var EX=function(n,o,c){for(var d=0,y=0;d=y,y=Th(),d===38&&y===12&&(o[c]=1),!Av(y);)Lc();return Kv(n,nc)},IX=function(n,o){var c=-1,d=44;do switch(Av(d)){case 0:d===38&&Th()===12&&(o[c]=1),n[c]+=EX(nc-1,o,c);break;case 2:n[c]+=E0(d);break;case 4:if(d===44){n[++c]=Th()===58?"&\f":"",o[c]=n[c].length;break}default:n[c]+=U1(d)}while(d=Lc());return n},PX=function(n,o){return W4(IX(G4(n),o))},GM=new WeakMap,AX=function(n){if(!(n.type!=="rule"||!n.parent||n.length<1)){for(var o=n.value,c=n.parent,d=n.column===c.column&&n.line===c.line;c.type!=="rule";)if(c=c.parent,!c)return;if(!(n.props.length===1&&o.charCodeAt(0)!==58&&!GM.get(c))&&!d){GM.set(n,!0);for(var y=[],x=PX(o,y),i=c.props,I=0,R=0;I<x.length;I++)for(var k=0;k<i.length;k++,R++)n.props[R]=y[I]?x[I].replace(/&\f/g,i[k]):i[k]+" "+x[I]}}},RX=function(n){if(n.type==="decl"){var o=n.value;o.charCodeAt(0)===108&&o.charCodeAt(2)===98&&(n.return="",n.value="")}};function Z4(e,n){switch(hX(e,n)){case 5103:return fs+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return fs+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return fs+e+J0+e+Va+e+e;case 6828:case 4268:return fs+e+Va+e+e;case 6165:return fs+e+Va+"flex-"+e+e;case 5187:return fs+e+ps(e,/(\w+).+(:[^]+)/,fs+"box-$1$2"+Va+"flex-$1$2")+e;case 5443:return fs+e+Va+"flex-item-"+ps(e,/flex-|-self/,"")+e;case 4675:return fs+e+Va+"flex-line-pack"+ps(e,/align-content|flex-|-self/,"")+e;case 5548:return fs+e+Va+ps(e,"shrink","negative")+e;case 5292:return fs+e+Va+ps(e,"basis","preferred-size")+e;case 6060:return fs+"box-"+ps(e,"-grow","")+fs+e+Va+ps(e,"grow","positive")+e;case 4554:return fs+ps(e,/([^-])(transform)/g,"$1"+fs+"$2")+e;case 6187:return ps(ps(ps(e,/(zoom-|grab)/,fs+"$1"),/(image-set)/,fs+"$1"),e,"")+e;case 5495:case 3959:return ps(e,/(image-set\([^]*)/,fs+"$1$`$1");case 4968:return ps(ps(e,/(.+:)(flex-)?(.*)/,fs+"box-pack:$3"+Va+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+fs+e+e;case 4095:case 3583:case 4068:case 2532:return ps(e,/(.+)-inline(.+)/,fs+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(gh(e)-1-n>6)switch(ba(e,n+1)){case 109:if(ba(e,n+4)!==45)break;case 102:return ps(e,/(.+:)(.+)-([^]+)/,"$1"+fs+"$2-$3$1"+J0+(ba(e,n+3)==108?"$3":"$2-$3"))+e;case 115:return~vS(e,"stretch")?Z4(ps(e,"stretch","fill-available"),n)+e:e}break;case 4949:if(ba(e,n+1)!==115)break;case 6444:switch(ba(e,gh(e)-3-(~vS(e,"!important")&&10))){case 107:return ps(e,":",":"+fs)+e;case 101:return ps(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+fs+(ba(e,14)===45?"inline-":"")+"box$3$1"+fs+"$2$3$1"+Va+"$2box$3")+e}break;case 5936:switch(ba(e,n+11)){case 114:return fs+e+Va+ps(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return fs+e+Va+ps(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return fs+e+Va+ps(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return fs+e+Va+e+e}return e}var MX=function(n,o,c,d){if(n.length>-1&&!n.return)switch(n.type){case eT:n.return=Z4(n.value,n.length);break;case U4:return p_([Wy(n,{value:ps(n.value,"@","@"+fs)})],d);case QC:if(n.length)return pX(n.props,function(y){switch(fX(y,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return p_([Wy(n,{props:[ps(y,/:(read-\w+)/,":"+J0+"$1")]})],d);case"::placeholder":return p_([Wy(n,{props:[ps(y,/:(plac\w+)/,":"+fs+"input-$1")]}),Wy(n,{props:[ps(y,/:(plac\w+)/,":"+J0+"$1")]}),Wy(n,{props:[ps(y,/:(plac\w+)/,Va+"input-$1")]})],d)}return""})}},LX=[MX],X4=function(n){var o=n.key;if(o==="css"){var c=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(c,function(Z){var J=Z.getAttribute("data-emotion");J.indexOf(" ")!==-1&&(document.head.appendChild(Z),Z.setAttribute("data-s",""))})}var d=n.stylisPlugins||LX,y={},x,i=[];x=n.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+o+' "]'),function(Z){for(var J=Z.getAttribute("data-emotion").split(" "),le=1;le<J.length;le++)y[J[le]]=!0;i.push(Z)});var I,R=[AX,RX];{var k,N=[SX,TX(function(Z){k.insert(Z)})],U=CX(R.concat(d,N)),K=function(J){return p_(bX(J),U)};I=function(J,le,de,ue){k=de,K(J?J+"{"+le.styles+"}":le.styles),ue&&(X.inserted[le.name]=!0)}}var X={key:o,sheet:new aX({key:o,container:x,nonce:n.nonce,speedy:n.speedy,prepend:n.prepend,insertionPoint:n.insertionPoint}),nonce:n.nonce,inserted:y,registered:{},insert:I};return X.sheet.hydrate(i),X},s2={exports:{}},vs={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WM;function DX(){if(WM)return vs;WM=1;var e=typeof Symbol=="function"&&Symbol.for,n=e?Symbol.for("react.element"):60103,o=e?Symbol.for("react.portal"):60106,c=e?Symbol.for("react.fragment"):60107,d=e?Symbol.for("react.strict_mode"):60108,y=e?Symbol.for("react.profiler"):60114,x=e?Symbol.for("react.provider"):60109,i=e?Symbol.for("react.context"):60110,I=e?Symbol.for("react.async_mode"):60111,R=e?Symbol.for("react.concurrent_mode"):60111,k=e?Symbol.for("react.forward_ref"):60112,N=e?Symbol.for("react.suspense"):60113,U=e?Symbol.for("react.suspense_list"):60120,K=e?Symbol.for("react.memo"):60115,X=e?Symbol.for("react.lazy"):60116,Z=e?Symbol.for("react.block"):60121,J=e?Symbol.for("react.fundamental"):60117,le=e?Symbol.for("react.responder"):60118,de=e?Symbol.for("react.scope"):60119;function ue(he){if(typeof he=="object"&&he!==null){var xe=he.$$typeof;switch(xe){case n:switch(he=he.type,he){case I:case R:case c:case y:case d:case N:return he;default:switch(he=he&&he.$$typeof,he){case i:case k:case X:case K:case x:return he;default:return xe}}case o:return xe}}}function pe(he){return ue(he)===R}return vs.AsyncMode=I,vs.ConcurrentMode=R,vs.ContextConsumer=i,vs.ContextProvider=x,vs.Element=n,vs.ForwardRef=k,vs.Fragment=c,vs.Lazy=X,vs.Memo=K,vs.Portal=o,vs.Profiler=y,vs.StrictMode=d,vs.Suspense=N,vs.isAsyncMode=function(he){return pe(he)||ue(he)===I},vs.isConcurrentMode=pe,vs.isContextConsumer=function(he){return ue(he)===i},vs.isContextProvider=function(he){return ue(he)===x},vs.isElement=function(he){return typeof he=="object"&&he!==null&&he.$$typeof===n},vs.isForwardRef=function(he){return ue(he)===k},vs.isFragment=function(he){return ue(he)===c},vs.isLazy=function(he){return ue(he)===X},vs.isMemo=function(he){return ue(he)===K},vs.isPortal=function(he){return ue(he)===o},vs.isProfiler=function(he){return ue(he)===y},vs.isStrictMode=function(he){return ue(he)===d},vs.isSuspense=function(he){return ue(he)===N},vs.isValidElementType=function(he){return typeof he=="string"||typeof he=="function"||he===c||he===R||he===y||he===d||he===N||he===U||typeof he=="object"&&he!==null&&(he.$$typeof===X||he.$$typeof===K||he.$$typeof===x||he.$$typeof===i||he.$$typeof===k||he.$$typeof===J||he.$$typeof===le||he.$$typeof===de||he.$$typeof===Z)},vs.typeOf=ue,vs}var qM;function kX(){return qM||(qM=1,s2.exports=DX()),s2.exports}var o2,ZM;function OX(){if(ZM)return o2;ZM=1;var e=kX(),n={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},c={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},d={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},y={};y[e.ForwardRef]=c,y[e.Memo]=d;function x(X){return e.isMemo(X)?d:y[X.$$typeof]||n}var i=Object.defineProperty,I=Object.getOwnPropertyNames,R=Object.getOwnPropertySymbols,k=Object.getOwnPropertyDescriptor,N=Object.getPrototypeOf,U=Object.prototype;function K(X,Z,J){if(typeof Z!="string"){if(U){var le=N(Z);le&&le!==U&&K(X,le,J)}var de=I(Z);R&&(de=de.concat(R(Z)));for(var ue=x(X),pe=x(Z),he=0;he<de.length;++he){var xe=de[he];if(!o[xe]&&!(J&&J[xe])&&!(pe&&pe[xe])&&!(ue&&ue[xe])){var fe=k(Z,xe);try{i(X,xe,fe)}catch{}}}}return X}return o2=K,o2}OX();var zX=!0;function K4(e,n,o){var c="";return o.split(" ").forEach(function(d){e[d]!==void 0?n.push(e[d]+";"):d&&(c+=d+" ")}),c}var nT=function(n,o,c){var d=n.key+"-"+o.name;(c===!1||zX===!1)&&n.registered[d]===void 0&&(n.registered[d]=o.styles)},rT=function(n,o,c){nT(n,o,c);var d=n.key+"-"+o.name;if(n.inserted[o.name]===void 0){var y=o;do n.insert(o===y?"."+d:"",y,n.sheet,!0),y=y.next;while(y!==void 0)}};function FX(e){for(var n=0,o,c=0,d=e.length;d>=4;++c,d-=4)o=e.charCodeAt(c)&255|(e.charCodeAt(++c)&255)<<8|(e.charCodeAt(++c)&255)<<16|(e.charCodeAt(++c)&255)<<24,o=(o&65535)*1540483477+((o>>>16)*59797<<16),o^=o>>>24,n=(o&65535)*1540483477+((o>>>16)*59797<<16)^(n&65535)*1540483477+((n>>>16)*59797<<16);switch(d){case 3:n^=(e.charCodeAt(c+2)&255)<<16;case 2:n^=(e.charCodeAt(c+1)&255)<<8;case 1:n^=e.charCodeAt(c)&255,n=(n&65535)*1540483477+((n>>>16)*59797<<16)}return n^=n>>>13,n=(n&65535)*1540483477+((n>>>16)*59797<<16),((n^n>>>15)>>>0).toString(36)}var NX={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},jX=/[A-Z]|^ms/g,BX=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Y4=function(n){return n.charCodeAt(1)===45},XM=function(n){return n!=null&&typeof n!="boolean"},a2=q4(function(e){return Y4(e)?e:e.replace(jX,"-$&").toLowerCase()}),KM=function(n,o){switch(n){case"animation":case"animationName":if(typeof o=="string")return o.replace(BX,function(c,d,y){return _h={name:d,styles:y,next:_h},d})}return NX[n]!==1&&!Y4(n)&&typeof o=="number"&&o!==0?o+"px":o};function Rv(e,n,o){if(o==null)return"";var c=o;if(c.__emotion_styles!==void 0)return c;switch(typeof o){case"boolean":return"";case"object":{var d=o;if(d.anim===1)return _h={name:d.name,styles:d.styles,next:_h},d.name;var y=o;if(y.styles!==void 0){var x=y.next;if(x!==void 0)for(;x!==void 0;)_h={name:x.name,styles:x.styles,next:_h},x=x.next;var i=y.styles+";";return i}return VX(e,n,o)}case"function":{if(e!==void 0){var I=_h,R=o(e);return _h=I,Rv(e,n,R)}break}}var k=o;if(n==null)return k;var N=n[k];return N!==void 0?N:k}function VX(e,n,o){var c="";if(Array.isArray(o))for(var d=0;d<o.length;d++)c+=Rv(e,n,o[d])+";";else for(var y in o){var x=o[y];if(typeof x!="object"){var i=x;n!=null&&n[i]!==void 0?c+=y+"{"+n[i]+"}":XM(i)&&(c+=a2(y)+":"+KM(y,i)+";")}else if(Array.isArray(x)&&typeof x[0]=="string"&&(n==null||n[x[0]]===void 0))for(var I=0;I<x.length;I++)XM(x[I])&&(c+=a2(y)+":"+KM(y,x[I])+";");else{var R=Rv(e,n,x);switch(y){case"animation":case"animationName":{c+=a2(y)+":"+R+";";break}default:c+=y+"{"+R+"}"}}}return c}var YM=/label:\s*([^\s;{]+)\s*(;|$)/g,_h;function G1(e,n,o){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var c=!0,d="";_h=void 0;var y=e[0];if(y==null||y.raw===void 0)c=!1,d+=Rv(o,n,y);else{var x=y;d+=x[0]}for(var i=1;i<e.length;i++)if(d+=Rv(o,n,e[i]),c){var I=y;d+=I[i]}YM.lastIndex=0;for(var R="",k;(k=YM.exec(d))!==null;)R+="-"+k[1];var N=FX(d)+R;return{name:N,styles:d,next:_h}}var UX=function(n){return n()},J4=R0.useInsertionEffect?R0.useInsertionEffect:!1,Q4=J4||UX,JM=J4||V.useLayoutEffect,eF=V.createContext(typeof HTMLElement<"u"?X4({key:"css"}):null),$X=eF.Provider,iT=function(n){return V.forwardRef(function(o,c){var d=V.useContext(eF);return n(o,d,c)})},Yv=V.createContext({}),sT={}.hasOwnProperty,bS="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",HX=function(n,o){var c={};for(var d in o)sT.call(o,d)&&(c[d]=o[d]);return c[bS]=n,c},GX=function(n){var o=n.cache,c=n.serialized,d=n.isStringTag;return nT(o,c,d),Q4(function(){return rT(o,c,d)}),null},WX=iT(function(e,n,o){var c=e.css;typeof c=="string"&&n.registered[c]!==void 0&&(c=n.registered[c]);var d=e[bS],y=[c],x="";typeof e.className=="string"?x=K4(n.registered,y,e.className):e.className!=null&&(x=e.className+" ");var i=G1(y,void 0,V.useContext(Yv));x+=n.key+"-"+i.name;var I={};for(var R in e)sT.call(e,R)&&R!=="css"&&R!==bS&&(I[R]=e[R]);return I.className=x,o&&(I.ref=o),V.createElement(V.Fragment,null,V.createElement(GX,{cache:n,serialized:i,isStringTag:typeof d=="string"}),V.createElement(d,I))}),qX=WX,Nr=function(n,o){var c=arguments;if(o==null||!sT.call(o,"css"))return V.createElement.apply(void 0,c);var d=c.length,y=new Array(d);y[0]=qX,y[1]=HX(n,o);for(var x=2;x<d;x++)y[x]=c[x];return V.createElement.apply(null,y)};(function(e){var n;n||(n=e.JSX||(e.JSX={}))})(Nr||(Nr={}));var ZX=iT(function(e,n){var o=e.styles,c=G1([o],void 0,V.useContext(Yv)),d=V.useRef();return JM(function(){var y=n.key+"-global",x=new n.sheet.constructor({key:y,nonce:n.sheet.nonce,container:n.sheet.container,speedy:n.sheet.isSpeedy}),i=!1,I=document.querySelector('style[data-emotion="'+y+" "+c.name+'"]');return n.sheet.tags.length&&(x.before=n.sheet.tags[0]),I!==null&&(i=!0,I.setAttribute("data-emotion",y),x.hydrate([I])),d.current=[x,i],function(){x.flush()}},[n]),JM(function(){var y=d.current,x=y[0],i=y[1];if(i){y[1]=!1;return}if(c.next!==void 0&&rT(n,c.next,!0),x.tags.length){var I=x.tags[x.tags.length-1].nextElementSibling;x.before=I,x.flush()}n.insert("",c,x,!1)},[n,c.name]),null});function G_(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return G1(n)}function vg(){var e=G_.apply(void 0,arguments),n="animation-"+e.name;return{name:n,styles:"@keyframes "+n+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}function XX(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}const KX=Math.min,YX=Math.max,Q0=Math.round,c0=Math.floor,e1=e=>({x:e,y:e});function JX(e){const{x:n,y:o,width:c,height:d}=e;return{width:c,height:d,top:o,left:n,right:n+c,bottom:o+d,x:n,y:o}}function W1(){return typeof window<"u"}function tF(e){return rF(e)?(e.nodeName||"").toLowerCase():"#document"}function Mf(e){var n;return(e==null||(n=e.ownerDocument)==null?void 0:n.defaultView)||window}function nF(e){var n;return(n=(rF(e)?e.ownerDocument:e.document)||window.document)==null?void 0:n.documentElement}function rF(e){return W1()?e instanceof Node||e instanceof Mf(e).Node:!1}function QX(e){return W1()?e instanceof Element||e instanceof Mf(e).Element:!1}function oT(e){return W1()?e instanceof HTMLElement||e instanceof Mf(e).HTMLElement:!1}function QM(e){return!W1()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Mf(e).ShadowRoot}function iF(e){const{overflow:n,overflowX:o,overflowY:c,display:d}=aT(e);return/auto|scroll|overlay|hidden|clip/.test(n+c+o)&&!["inline","contents"].includes(d)}function eK(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function tK(e){return["html","body","#document"].includes(tF(e))}function aT(e){return Mf(e).getComputedStyle(e)}function nK(e){if(tF(e)==="html")return e;const n=e.assignedSlot||e.parentNode||QM(e)&&e.host||nF(e);return QM(n)?n.host:n}function sF(e){const n=nK(e);return tK(n)?e.ownerDocument?e.ownerDocument.body:e.body:oT(n)&&iF(n)?n:sF(n)}function t1(e,n,o){var c;n===void 0&&(n=[]),o===void 0&&(o=!0);const d=sF(e),y=d===((c=e.ownerDocument)==null?void 0:c.body),x=Mf(d);if(y){const i=wS(x);return n.concat(x,x.visualViewport||[],iF(d)?d:[],i&&o?t1(i):[])}return n.concat(d,t1(d,[],o))}function wS(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function rK(e){const n=aT(e);let o=parseFloat(n.width)||0,c=parseFloat(n.height)||0;const d=oT(e),y=d?e.offsetWidth:o,x=d?e.offsetHeight:c,i=Q0(o)!==y||Q0(c)!==x;return i&&(o=y,c=x),{width:o,height:c,$:i}}function lT(e){return QX(e)?e:e.contextElement}function e3(e){const n=lT(e);if(!oT(n))return e1(1);const o=n.getBoundingClientRect(),{width:c,height:d,$:y}=rK(n);let x=(y?Q0(o.width):o.width)/c,i=(y?Q0(o.height):o.height)/d;return(!x||!Number.isFinite(x))&&(x=1),(!i||!Number.isFinite(i))&&(i=1),{x,y:i}}const iK=e1(0);function sK(e){const n=Mf(e);return!eK()||!n.visualViewport?iK:{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}}function oK(e,n,o){return!1}function t3(e,n,o,c){n===void 0&&(n=!1);const d=e.getBoundingClientRect(),y=lT(e);let x=e1(1);n&&(x=e3(e));const i=oK()?sK(y):e1(0);let I=(d.left+i.x)/x.x,R=(d.top+i.y)/x.y,k=d.width/x.x,N=d.height/x.y;if(y){const U=Mf(y),K=c;let X=U,Z=wS(X);for(;Z&&c&&K!==X;){const J=e3(Z),le=Z.getBoundingClientRect(),de=aT(Z),ue=le.left+(Z.clientLeft+parseFloat(de.paddingLeft))*J.x,pe=le.top+(Z.clientTop+parseFloat(de.paddingTop))*J.y;I*=J.x,R*=J.y,k*=J.x,N*=J.y,I+=ue,R+=pe,X=Mf(Z),Z=wS(X)}}return JX({width:k,height:N,x:I,y:R})}function oF(e,n){return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height}function aK(e,n){let o=null,c;const d=nF(e);function y(){var i;clearTimeout(c),(i=o)==null||i.disconnect(),o=null}function x(i,I){i===void 0&&(i=!1),I===void 0&&(I=1),y();const R=e.getBoundingClientRect(),{left:k,top:N,width:U,height:K}=R;if(i||n(),!U||!K)return;const X=c0(N),Z=c0(d.clientWidth-(k+U)),J=c0(d.clientHeight-(N+K)),le=c0(k),ue={rootMargin:-X+"px "+-Z+"px "+-J+"px "+-le+"px",threshold:YX(0,KX(1,I))||1};let pe=!0;function he(xe){const fe=xe[0].intersectionRatio;if(fe!==I){if(!pe)return x();fe?x(!1,fe):c=setTimeout(()=>{x(!1,1e-7)},1e3)}fe===1&&!oF(R,e.getBoundingClientRect())&&x(),pe=!1}try{o=new IntersectionObserver(he,{...ue,root:d.ownerDocument})}catch{o=new IntersectionObserver(he,ue)}o.observe(e)}return x(!0),y}function lK(e,n,o,c){c===void 0&&(c={});const{ancestorScroll:d=!0,ancestorResize:y=!0,elementResize:x=typeof ResizeObserver=="function",layoutShift:i=typeof IntersectionObserver=="function",animationFrame:I=!1}=c,R=lT(e),k=d||y?[...R?t1(R):[],...t1(n)]:[];k.forEach(le=>{d&&le.addEventListener("scroll",o,{passive:!0}),y&&le.addEventListener("resize",o)});const N=R&&i?aK(R,o):null;let U=-1,K=null;x&&(K=new ResizeObserver(le=>{let[de]=le;de&&de.target===R&&K&&(K.unobserve(n),cancelAnimationFrame(U),U=requestAnimationFrame(()=>{var ue;(ue=K)==null||ue.observe(n)})),o()}),R&&!I&&K.observe(R),K.observe(n));let X,Z=I?t3(e):null;I&&J();function J(){const le=t3(e);Z&&!oF(Z,le)&&o(),Z=le,X=requestAnimationFrame(J)}return o(),()=>{var le;k.forEach(de=>{d&&de.removeEventListener("scroll",o),y&&de.removeEventListener("resize",o)}),N==null||N(),(le=K)==null||le.disconnect(),K=null,I&&cancelAnimationFrame(X)}}var SS=V.useLayoutEffect,cK=["className","clearValue","cx","getStyles","getClassNames","getValue","hasValue","isMulti","isRtl","options","selectOption","selectProps","setValue","theme"],n1=function(){};function uK(e,n){return n?n[0]==="-"?e+n:e+"__"+n:e}function dK(e,n){for(var o=arguments.length,c=new Array(o>2?o-2:0),d=2;d<o;d++)c[d-2]=arguments[d];var y=[].concat(c);if(n&&e)for(var x in n)n.hasOwnProperty(x)&&n[x]&&y.push("".concat(uK(e,x)));return y.filter(function(i){return i}).map(function(i){return String(i).trim()}).join(" ")}var n3=function(n){return xK(n)?n.filter(Boolean):ug(n)==="object"&&n!==null?[n]:[]},aF=function(n){n.className,n.clearValue,n.cx,n.getStyles,n.getClassNames,n.getValue,n.hasValue,n.isMulti,n.isRtl,n.options,n.selectOption,n.selectProps,n.setValue,n.theme;var o=Df(n,cK);return Wr({},o)},vo=function(n,o,c){var d=n.cx,y=n.getStyles,x=n.getClassNames,i=n.className;return{css:y(o,n),className:d(c??{},x(o,n),i)}};function q1(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function hK(e){return q1(e)?window.innerHeight:e.clientHeight}function lF(e){return q1(e)?window.pageYOffset:e.scrollTop}function r1(e,n){if(q1(e)){window.scrollTo(0,n);return}e.scrollTop=n}function fK(e){var n=getComputedStyle(e),o=n.position==="absolute",c=/(auto|scroll)/;if(n.position==="fixed")return document.documentElement;for(var d=e;d=d.parentElement;)if(n=getComputedStyle(d),!(o&&n.position==="static")&&c.test(n.overflow+n.overflowY+n.overflowX))return d;return document.documentElement}function pK(e,n,o,c){return o*((e=e/c-1)*e*e+1)+n}function u0(e,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:200,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:n1,d=lF(e),y=n-d,x=10,i=0;function I(){i+=x;var R=pK(i,d,y,o);r1(e,R),i<o?window.requestAnimationFrame(I):c(e)}I()}function r3(e,n){var o=e.getBoundingClientRect(),c=n.getBoundingClientRect(),d=n.offsetHeight/3;c.bottom+d>o.bottom?r1(e,Math.min(n.offsetTop+n.clientHeight-e.offsetHeight+d,e.scrollHeight)):c.top-d<o.top&&r1(e,Math.max(n.offsetTop-d,0))}function mK(e){var n=e.getBoundingClientRect();return{bottom:n.bottom,height:n.height,left:n.left,right:n.right,top:n.top,width:n.width}}function i3(){try{return document.createEvent("TouchEvent"),!0}catch{return!1}}function gK(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch{return!1}}var cF=!1,_K={get passive(){return cF=!0}},d0=typeof window<"u"?window:{};d0.addEventListener&&d0.removeEventListener&&(d0.addEventListener("p",n1,_K),d0.removeEventListener("p",n1,!1));var yK=cF;function vK(e){return e!=null}function xK(e){return Array.isArray(e)}function h0(e,n,o){return e?n:o}var bK=function(n){for(var o=arguments.length,c=new Array(o>1?o-1:0),d=1;d<o;d++)c[d-1]=arguments[d];var y=Object.entries(n).filter(function(x){var i=Ef(x,1),I=i[0];return!c.includes(I)});return y.reduce(function(x,i){var I=Ef(i,2),R=I[0],k=I[1];return x[R]=k,x},{})},wK=["children","innerProps"],SK=["children","innerProps"];function CK(e){var n=e.maxHeight,o=e.menuEl,c=e.minHeight,d=e.placement,y=e.shouldScroll,x=e.isFixedPosition,i=e.controlHeight,I=fK(o),R={placement:"bottom",maxHeight:n};if(!o||!o.offsetParent)return R;var k=I.getBoundingClientRect(),N=k.height,U=o.getBoundingClientRect(),K=U.bottom,X=U.height,Z=U.top,J=o.offsetParent.getBoundingClientRect(),le=J.top,de=x?window.innerHeight:hK(I),ue=lF(I),pe=parseInt(getComputedStyle(o).marginBottom,10),he=parseInt(getComputedStyle(o).marginTop,10),xe=le-he,fe=de-Z,_e=xe+ue,Ce=N-ue-Z,je=K-de+ue+pe,He=ue+Z-he,lt=160;switch(d){case"auto":case"bottom":if(fe>=X)return{placement:"bottom",maxHeight:n};if(Ce>=X&&!x)return y&&u0(I,je,lt),{placement:"bottom",maxHeight:n};if(!x&&Ce>=c||x&&fe>=c){y&&u0(I,je,lt);var _t=x?fe-pe:Ce-pe;return{placement:"bottom",maxHeight:_t}}if(d==="auto"||x){var Ue=n,Ge=x?xe:_e;return Ge>=c&&(Ue=Math.min(Ge-pe-i,n)),{placement:"top",maxHeight:Ue}}if(d==="bottom")return y&&r1(I,je),{placement:"bottom",maxHeight:n};break;case"top":if(xe>=X)return{placement:"top",maxHeight:n};if(_e>=X&&!x)return y&&u0(I,He,lt),{placement:"top",maxHeight:n};if(!x&&_e>=c||x&&xe>=c){var at=n;return(!x&&_e>=c||x&&xe>=c)&&(at=x?xe-he:_e-he),y&&u0(I,He,lt),{placement:"top",maxHeight:at}}return{placement:"bottom",maxHeight:n};default:throw new Error('Invalid placement provided "'.concat(d,'".'))}return R}function TK(e){var n={bottom:"top",top:"bottom"};return e?n[e]:"bottom"}var uF=function(n){return n==="auto"?"bottom":n},EK=function(n,o){var c,d=n.placement,y=n.theme,x=y.borderRadius,i=y.spacing,I=y.colors;return Wr((c={label:"menu"},iv(c,TK(d),"100%"),iv(c,"position","absolute"),iv(c,"width","100%"),iv(c,"zIndex",1),c),o?{}:{backgroundColor:I.neutral0,borderRadius:x,boxShadow:"0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)",marginBottom:i.menuGutter,marginTop:i.menuGutter})},dF=V.createContext(null),IK=function(n){var o=n.children,c=n.minMenuHeight,d=n.maxMenuHeight,y=n.menuPlacement,x=n.menuPosition,i=n.menuShouldScrollIntoView,I=n.theme,R=V.useContext(dF)||{},k=R.setPortalPlacement,N=V.useRef(null),U=V.useState(d),K=Ef(U,2),X=K[0],Z=K[1],J=V.useState(null),le=Ef(J,2),de=le[0],ue=le[1],pe=I.spacing.controlHeight;return SS(function(){var he=N.current;if(he){var xe=x==="fixed",fe=i&&!xe,_e=CK({maxHeight:d,menuEl:he,minHeight:c,placement:y,shouldScroll:fe,isFixedPosition:xe,controlHeight:pe});Z(_e.maxHeight),ue(_e.placement),k==null||k(_e.placement)}},[d,y,x,i,c,k,pe]),o({ref:N,placerProps:Wr(Wr({},n),{},{placement:de||uF(y),maxHeight:X})})},PK=function(n){var o=n.children,c=n.innerRef,d=n.innerProps;return Nr("div",nt({},vo(n,"menu",{menu:!0}),{ref:c},d),o)},AK=PK,RK=function(n,o){var c=n.maxHeight,d=n.theme.spacing.baseUnit;return Wr({maxHeight:c,overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},o?{}:{paddingBottom:d,paddingTop:d})},MK=function(n){var o=n.children,c=n.innerProps,d=n.innerRef,y=n.isMulti;return Nr("div",nt({},vo(n,"menuList",{"menu-list":!0,"menu-list--is-multi":y}),{ref:d},c),o)},hF=function(n,o){var c=n.theme,d=c.spacing.baseUnit,y=c.colors;return Wr({textAlign:"center"},o?{}:{color:y.neutral40,padding:"".concat(d*2,"px ").concat(d*3,"px")})},LK=hF,DK=hF,kK=function(n){var o=n.children,c=o===void 0?"No options":o,d=n.innerProps,y=Df(n,wK);return Nr("div",nt({},vo(Wr(Wr({},y),{},{children:c,innerProps:d}),"noOptionsMessage",{"menu-notice":!0,"menu-notice--no-options":!0}),d),c)},OK=function(n){var o=n.children,c=o===void 0?"Loading...":o,d=n.innerProps,y=Df(n,SK);return Nr("div",nt({},vo(Wr(Wr({},y),{},{children:c,innerProps:d}),"loadingMessage",{"menu-notice":!0,"menu-notice--loading":!0}),d),c)},zK=function(n){var o=n.rect,c=n.offset,d=n.position;return{left:o.left,position:d,top:c,width:o.width,zIndex:1}},FK=function(n){var o=n.appendTo,c=n.children,d=n.controlElement,y=n.innerProps,x=n.menuPlacement,i=n.menuPosition,I=V.useRef(null),R=V.useRef(null),k=V.useState(uF(x)),N=Ef(k,2),U=N[0],K=N[1],X=V.useMemo(function(){return{setPortalPlacement:K}},[]),Z=V.useState(null),J=Ef(Z,2),le=J[0],de=J[1],ue=V.useCallback(function(){if(d){var fe=mK(d),_e=i==="fixed"?0:window.pageYOffset,Ce=fe[U]+_e;(Ce!==(le==null?void 0:le.offset)||fe.left!==(le==null?void 0:le.rect.left)||fe.width!==(le==null?void 0:le.rect.width))&&de({offset:Ce,rect:fe})}},[d,i,U,le==null?void 0:le.offset,le==null?void 0:le.rect.left,le==null?void 0:le.rect.width]);SS(function(){ue()},[ue]);var pe=V.useCallback(function(){typeof R.current=="function"&&(R.current(),R.current=null),d&&I.current&&(R.current=lK(d,I.current,ue,{elementResize:"ResizeObserver"in window}))},[d,ue]);SS(function(){pe()},[pe]);var he=V.useCallback(function(fe){I.current=fe,pe()},[pe]);if(!o&&i!=="fixed"||!le)return null;var xe=Nr("div",nt({ref:he},vo(Wr(Wr({},n),{},{offset:le.offset,position:i,rect:le.rect}),"menuPortal",{"menu-portal":!0}),y),c);return Nr(dF.Provider,{value:X},o?BS.createPortal(xe,o):xe)},NK=function(n){var o=n.isDisabled,c=n.isRtl;return{label:"container",direction:c?"rtl":void 0,pointerEvents:o?"none":void 0,position:"relative"}},jK=function(n){var o=n.children,c=n.innerProps,d=n.isDisabled,y=n.isRtl;return Nr("div",nt({},vo(n,"container",{"--is-disabled":d,"--is-rtl":y}),c),o)},BK=function(n,o){var c=n.theme.spacing,d=n.isMulti,y=n.hasValue,x=n.selectProps.controlShouldRenderValue;return Wr({alignItems:"center",display:d&&y&&x?"flex":"grid",flex:1,flexWrap:"wrap",WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"},o?{}:{padding:"".concat(c.baseUnit/2,"px ").concat(c.baseUnit*2,"px")})},VK=function(n){var o=n.children,c=n.innerProps,d=n.isMulti,y=n.hasValue;return Nr("div",nt({},vo(n,"valueContainer",{"value-container":!0,"value-container--is-multi":d,"value-container--has-value":y}),c),o)},UK=function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},$K=function(n){var o=n.children,c=n.innerProps;return Nr("div",nt({},vo(n,"indicatorsContainer",{indicators:!0}),c),o)},s3,HK=["size"],GK=["innerProps","isRtl","size"],WK={name:"8mmkcg",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0"},fF=function(n){var o=n.size,c=Df(n,HK);return Nr("svg",nt({height:o,width:o,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:WK},c))},cT=function(n){return Nr(fF,nt({size:20},n),Nr("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},pF=function(n){return Nr(fF,nt({size:20},n),Nr("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},mF=function(n,o){var c=n.isFocused,d=n.theme,y=d.spacing.baseUnit,x=d.colors;return Wr({label:"indicatorContainer",display:"flex",transition:"color 150ms"},o?{}:{color:c?x.neutral60:x.neutral20,padding:y*2,":hover":{color:c?x.neutral80:x.neutral40}})},qK=mF,ZK=function(n){var o=n.children,c=n.innerProps;return Nr("div",nt({},vo(n,"dropdownIndicator",{indicator:!0,"dropdown-indicator":!0}),c),o||Nr(pF,null))},XK=mF,KK=function(n){var o=n.children,c=n.innerProps;return Nr("div",nt({},vo(n,"clearIndicator",{indicator:!0,"clear-indicator":!0}),c),o||Nr(cT,null))},YK=function(n,o){var c=n.isDisabled,d=n.theme,y=d.spacing.baseUnit,x=d.colors;return Wr({label:"indicatorSeparator",alignSelf:"stretch",width:1},o?{}:{backgroundColor:c?x.neutral10:x.neutral20,marginBottom:y*2,marginTop:y*2})},JK=function(n){var o=n.innerProps;return Nr("span",nt({},o,vo(n,"indicatorSeparator",{"indicator-separator":!0})))},QK=vg(s3||(s3=XX([`
  0%, 80%, 100% { opacity: 0; }
  40% { opacity: 1; }
`]))),eY=function(n,o){var c=n.isFocused,d=n.size,y=n.theme,x=y.colors,i=y.spacing.baseUnit;return Wr({label:"loadingIndicator",display:"flex",transition:"color 150ms",alignSelf:"center",fontSize:d,lineHeight:1,marginRight:d,textAlign:"center",verticalAlign:"middle"},o?{}:{color:c?x.neutral60:x.neutral20,padding:i*2})},l2=function(n){var o=n.delay,c=n.offset;return Nr("span",{css:G_({animation:"".concat(QK," 1s ease-in-out ").concat(o,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:c?"1em":void 0,height:"1em",verticalAlign:"top",width:"1em"},"","")})},tY=function(n){var o=n.innerProps,c=n.isRtl,d=n.size,y=d===void 0?4:d,x=Df(n,GK);return Nr("div",nt({},vo(Wr(Wr({},x),{},{innerProps:o,isRtl:c,size:y}),"loadingIndicator",{indicator:!0,"loading-indicator":!0}),o),Nr(l2,{delay:0,offset:c}),Nr(l2,{delay:160,offset:!0}),Nr(l2,{delay:320,offset:!c}))},nY=function(n,o){var c=n.isDisabled,d=n.isFocused,y=n.theme,x=y.colors,i=y.borderRadius,I=y.spacing;return Wr({label:"control",alignItems:"center",cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:I.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms"},o?{}:{backgroundColor:c?x.neutral5:x.neutral0,borderColor:c?x.neutral10:d?x.primary:x.neutral20,borderRadius:i,borderStyle:"solid",borderWidth:1,boxShadow:d?"0 0 0 1px ".concat(x.primary):void 0,"&:hover":{borderColor:d?x.primary:x.neutral30}})},rY=function(n){var o=n.children,c=n.isDisabled,d=n.isFocused,y=n.innerRef,x=n.innerProps,i=n.menuIsOpen;return Nr("div",nt({ref:y},vo(n,"control",{control:!0,"control--is-disabled":c,"control--is-focused":d,"control--menu-is-open":i}),x,{"aria-disabled":c||void 0}),o)},iY=rY,sY=["data"],oY=function(n,o){var c=n.theme.spacing;return o?{}:{paddingBottom:c.baseUnit*2,paddingTop:c.baseUnit*2}},aY=function(n){var o=n.children,c=n.cx,d=n.getStyles,y=n.getClassNames,x=n.Heading,i=n.headingProps,I=n.innerProps,R=n.label,k=n.theme,N=n.selectProps;return Nr("div",nt({},vo(n,"group",{group:!0}),I),Nr(x,nt({},i,{selectProps:N,theme:k,getStyles:d,getClassNames:y,cx:c}),R),Nr("div",null,o))},lY=function(n,o){var c=n.theme,d=c.colors,y=c.spacing;return Wr({label:"group",cursor:"default",display:"block"},o?{}:{color:d.neutral40,fontSize:"75%",fontWeight:500,marginBottom:"0.25em",paddingLeft:y.baseUnit*3,paddingRight:y.baseUnit*3,textTransform:"uppercase"})},cY=function(n){var o=aF(n);o.data;var c=Df(o,sY);return Nr("div",nt({},vo(n,"groupHeading",{"group-heading":!0}),c))},uY=aY,dY=["innerRef","isDisabled","isHidden","inputClassName"],hY=function(n,o){var c=n.isDisabled,d=n.value,y=n.theme,x=y.spacing,i=y.colors;return Wr(Wr({visibility:c?"hidden":"visible",transform:d?"translateZ(0)":""},fY),o?{}:{margin:x.baseUnit/2,paddingBottom:x.baseUnit/2,paddingTop:x.baseUnit/2,color:i.neutral80})},gF={gridArea:"1 / 2",font:"inherit",minWidth:"2px",border:0,margin:0,outline:0,padding:0},fY={flex:"1 1 auto",display:"inline-grid",gridArea:"1 / 1 / 2 / 3",gridTemplateColumns:"0 min-content","&:after":Wr({content:'attr(data-value) " "',visibility:"hidden",whiteSpace:"pre"},gF)},pY=function(n){return Wr({label:"input",color:"inherit",background:0,opacity:n?0:1,width:"100%"},gF)},mY=function(n){var o=n.cx,c=n.value,d=aF(n),y=d.innerRef,x=d.isDisabled,i=d.isHidden,I=d.inputClassName,R=Df(d,dY);return Nr("div",nt({},vo(n,"input",{"input-container":!0}),{"data-value":c||""}),Nr("input",nt({className:o({input:!0},I),ref:y,style:pY(i),disabled:x},R)))},gY=mY,_Y=function(n,o){var c=n.theme,d=c.spacing,y=c.borderRadius,x=c.colors;return Wr({label:"multiValue",display:"flex",minWidth:0},o?{}:{backgroundColor:x.neutral10,borderRadius:y/2,margin:d.baseUnit/2})},yY=function(n,o){var c=n.theme,d=c.borderRadius,y=c.colors,x=n.cropWithEllipsis;return Wr({overflow:"hidden",textOverflow:x||x===void 0?"ellipsis":void 0,whiteSpace:"nowrap"},o?{}:{borderRadius:d/2,color:y.neutral80,fontSize:"85%",padding:3,paddingLeft:6})},vY=function(n,o){var c=n.theme,d=c.spacing,y=c.borderRadius,x=c.colors,i=n.isFocused;return Wr({alignItems:"center",display:"flex"},o?{}:{borderRadius:y/2,backgroundColor:i?x.dangerLight:void 0,paddingLeft:d.baseUnit,paddingRight:d.baseUnit,":hover":{backgroundColor:x.dangerLight,color:x.danger}})},_F=function(n){var o=n.children,c=n.innerProps;return Nr("div",c,o)},xY=_F,bY=_F;function wY(e){var n=e.children,o=e.innerProps;return Nr("div",nt({role:"button"},o),n||Nr(cT,{size:14}))}var SY=function(n){var o=n.children,c=n.components,d=n.data,y=n.innerProps,x=n.isDisabled,i=n.removeProps,I=n.selectProps,R=c.Container,k=c.Label,N=c.Remove;return Nr(R,{data:d,innerProps:Wr(Wr({},vo(n,"multiValue",{"multi-value":!0,"multi-value--is-disabled":x})),y),selectProps:I},Nr(k,{data:d,innerProps:Wr({},vo(n,"multiValueLabel",{"multi-value__label":!0})),selectProps:I},o),Nr(N,{data:d,innerProps:Wr(Wr({},vo(n,"multiValueRemove",{"multi-value__remove":!0})),{},{"aria-label":"Remove ".concat(o||"option")},i),selectProps:I}))},CY=SY,TY=function(n,o){var c=n.isDisabled,d=n.isFocused,y=n.isSelected,x=n.theme,i=x.spacing,I=x.colors;return Wr({label:"option",cursor:"default",display:"block",fontSize:"inherit",width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)"},o?{}:{backgroundColor:y?I.primary:d?I.primary25:"transparent",color:c?I.neutral20:y?I.neutral0:"inherit",padding:"".concat(i.baseUnit*2,"px ").concat(i.baseUnit*3,"px"),":active":{backgroundColor:c?void 0:y?I.primary:I.primary50}})},EY=function(n){var o=n.children,c=n.isDisabled,d=n.isFocused,y=n.isSelected,x=n.innerRef,i=n.innerProps;return Nr("div",nt({},vo(n,"option",{option:!0,"option--is-disabled":c,"option--is-focused":d,"option--is-selected":y}),{ref:x,"aria-disabled":c},i),o)},IY=EY,PY=function(n,o){var c=n.theme,d=c.spacing,y=c.colors;return Wr({label:"placeholder",gridArea:"1 / 1 / 2 / 3"},o?{}:{color:y.neutral50,marginLeft:d.baseUnit/2,marginRight:d.baseUnit/2})},AY=function(n){var o=n.children,c=n.innerProps;return Nr("div",nt({},vo(n,"placeholder",{placeholder:!0}),c),o)},RY=AY,MY=function(n,o){var c=n.isDisabled,d=n.theme,y=d.spacing,x=d.colors;return Wr({label:"singleValue",gridArea:"1 / 1 / 2 / 3",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},o?{}:{color:c?x.neutral40:x.neutral80,marginLeft:y.baseUnit/2,marginRight:y.baseUnit/2})},LY=function(n){var o=n.children,c=n.isDisabled,d=n.innerProps;return Nr("div",nt({},vo(n,"singleValue",{"single-value":!0,"single-value--is-disabled":c}),d),o)},DY=LY,kY={ClearIndicator:KK,Control:iY,DropdownIndicator:ZK,DownChevron:pF,CrossIcon:cT,Group:uY,GroupHeading:cY,IndicatorsContainer:$K,IndicatorSeparator:JK,Input:gY,LoadingIndicator:tY,Menu:AK,MenuList:MK,MenuPortal:FK,LoadingMessage:OK,NoOptionsMessage:kK,MultiValue:CY,MultiValueContainer:xY,MultiValueLabel:bY,MultiValueRemove:wY,Option:IY,Placeholder:RY,SelectContainer:jK,SingleValue:DY,ValueContainer:VK},OY=function(n){return Wr(Wr({},kY),n.components)},o3=Number.isNaN||function(n){return typeof n=="number"&&n!==n};function zY(e,n){return!!(e===n||o3(e)&&o3(n))}function FY(e,n){if(e.length!==n.length)return!1;for(var o=0;o<e.length;o++)if(!zY(e[o],n[o]))return!1;return!0}function NY(e,n){n===void 0&&(n=FY);var o=null;function c(){for(var d=[],y=0;y<arguments.length;y++)d[y]=arguments[y];if(o&&o.lastThis===this&&n(d,o.lastArgs))return o.lastResult;var x=e.apply(this,d);return o={lastResult:x,lastArgs:d,lastThis:this},x}return c.clear=function(){o=null},c}var jY={name:"7pg0cj-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap"},BY=function(n){return Nr("span",nt({css:jY},n))},a3=BY,VY={guidance:function(n){var o=n.isSearchable,c=n.isMulti,d=n.tabSelectsValue,y=n.context,x=n.isInitialFocus;switch(y){case"menu":return"Use Up and Down to choose options, press Enter to select the currently focused option, press Escape to exit the menu".concat(d?", press Tab to select the option and exit the menu":"",".");case"input":return x?"".concat(n["aria-label"]||"Select"," is focused ").concat(o?",type to refine list":"",", press Down to open the menu, ").concat(c?" press left to focus selected values":""):"";case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value";default:return""}},onChange:function(n){var o=n.action,c=n.label,d=c===void 0?"":c,y=n.labels,x=n.isDisabled;switch(o){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(d,", deselected.");case"clear":return"All selected options have been cleared.";case"initial-input-focus":return"option".concat(y.length>1?"s":""," ").concat(y.join(","),", selected.");case"select-option":return x?"option ".concat(d," is disabled. Select another option."):"option ".concat(d,", selected.");default:return""}},onFocus:function(n){var o=n.context,c=n.focused,d=n.options,y=n.label,x=y===void 0?"":y,i=n.selectValue,I=n.isDisabled,R=n.isSelected,k=n.isAppleDevice,N=function(Z,J){return Z&&Z.length?"".concat(Z.indexOf(J)+1," of ").concat(Z.length):""};if(o==="value"&&i)return"value ".concat(x," focused, ").concat(N(i,c),".");if(o==="menu"&&k){var U=I?" disabled":"",K="".concat(R?" selected":"").concat(U);return"".concat(x).concat(K,", ").concat(N(d,c),".")}return""},onFilter:function(n){var o=n.inputValue,c=n.resultsMessage;return"".concat(c).concat(o?" for search term "+o:"",".")}},UY=function(n){var o=n.ariaSelection,c=n.focusedOption,d=n.focusedValue,y=n.focusableOptions,x=n.isFocused,i=n.selectValue,I=n.selectProps,R=n.id,k=n.isAppleDevice,N=I.ariaLiveMessages,U=I.getOptionLabel,K=I.inputValue,X=I.isMulti,Z=I.isOptionDisabled,J=I.isSearchable,le=I.menuIsOpen,de=I.options,ue=I.screenReaderStatus,pe=I.tabSelectsValue,he=I.isLoading,xe=I["aria-label"],fe=I["aria-live"],_e=V.useMemo(function(){return Wr(Wr({},VY),N||{})},[N]),Ce=V.useMemo(function(){var Ge="";if(o&&_e.onChange){var at=o.option,yt=o.options,tt=o.removedValue,Rt=o.removedValues,ct=o.value,ze=function(hn){return Array.isArray(hn)?null:hn},Ye=tt||at||ze(ct),At=Ye?U(Ye):"",Ct=yt||Rt||void 0,We=Ct?Ct.map(U):[],st=Wr({isDisabled:Ye&&Z(Ye,i),label:At,labels:We},o);Ge=_e.onChange(st)}return Ge},[o,_e,Z,i,U]),je=V.useMemo(function(){var Ge="",at=c||d,yt=!!(c&&i&&i.includes(c));if(at&&_e.onFocus){var tt={focused:at,label:U(at),isDisabled:Z(at,i),isSelected:yt,options:y,context:at===c?"menu":"value",selectValue:i,isAppleDevice:k};Ge=_e.onFocus(tt)}return Ge},[c,d,U,Z,_e,y,i,k]),He=V.useMemo(function(){var Ge="";if(le&&de.length&&!he&&_e.onFilter){var at=ue({count:y.length});Ge=_e.onFilter({inputValue:K,resultsMessage:at})}return Ge},[y,K,le,_e,de,ue,he]),lt=(o==null?void 0:o.action)==="initial-input-focus",_t=V.useMemo(function(){var Ge="";if(_e.guidance){var at=d?"value":le?"menu":"input";Ge=_e.guidance({"aria-label":xe,context:at,isDisabled:c&&Z(c,i),isMulti:X,isSearchable:J,tabSelectsValue:pe,isInitialFocus:lt})}return Ge},[xe,c,d,X,Z,J,le,_e,i,pe,lt]),Ue=Nr(V.Fragment,null,Nr("span",{id:"aria-selection"},Ce),Nr("span",{id:"aria-focused"},je),Nr("span",{id:"aria-results"},He),Nr("span",{id:"aria-guidance"},_t));return Nr(V.Fragment,null,Nr(a3,{id:R},lt&&Ue),Nr(a3,{"aria-live":fe,"aria-atomic":"false","aria-relevant":"additions text",role:"log"},x&&!lt&&Ue))},$Y=UY,CS=[{base:"A",letters:"A"},{base:"AA",letters:""},{base:"AE",letters:""},{base:"AO",letters:""},{base:"AU",letters:""},{base:"AV",letters:""},{base:"AY",letters:""},{base:"B",letters:"B"},{base:"C",letters:"C"},{base:"D",letters:"D"},{base:"DZ",letters:""},{base:"Dz",letters:""},{base:"E",letters:"E"},{base:"F",letters:"F"},{base:"G",letters:"G"},{base:"H",letters:"H"},{base:"I",letters:"I"},{base:"J",letters:"J"},{base:"K",letters:"K"},{base:"L",letters:"L"},{base:"LJ",letters:""},{base:"Lj",letters:""},{base:"M",letters:"M"},{base:"N",letters:"N"},{base:"NJ",letters:""},{base:"Nj",letters:""},{base:"O",letters:"O"},{base:"OI",letters:""},{base:"OO",letters:""},{base:"OU",letters:""},{base:"P",letters:"P"},{base:"Q",letters:"Q"},{base:"R",letters:"R"},{base:"S",letters:"S"},{base:"T",letters:"T"},{base:"TZ",letters:""},{base:"U",letters:"U"},{base:"V",letters:"V"},{base:"VY",letters:""},{base:"W",letters:"W"},{base:"X",letters:"X"},{base:"Y",letters:"Y"},{base:"Z",letters:"Z"},{base:"a",letters:"a"},{base:"aa",letters:""},{base:"ae",letters:""},{base:"ao",letters:""},{base:"au",letters:""},{base:"av",letters:""},{base:"ay",letters:""},{base:"b",letters:"b"},{base:"c",letters:"c"},{base:"d",letters:"d"},{base:"dz",letters:""},{base:"e",letters:"e"},{base:"f",letters:"f"},{base:"g",letters:"g"},{base:"h",letters:"h"},{base:"hv",letters:""},{base:"i",letters:"i"},{base:"j",letters:"j"},{base:"k",letters:"k"},{base:"l",letters:"l"},{base:"lj",letters:""},{base:"m",letters:"m"},{base:"n",letters:"n"},{base:"nj",letters:""},{base:"o",letters:"o"},{base:"oi",letters:""},{base:"ou",letters:""},{base:"oo",letters:""},{base:"p",letters:"p"},{base:"q",letters:"q"},{base:"r",letters:"r"},{base:"s",letters:"s"},{base:"t",letters:"t"},{base:"tz",letters:""},{base:"u",letters:"u"},{base:"v",letters:"v"},{base:"vy",letters:""},{base:"w",letters:"w"},{base:"x",letters:"x"},{base:"y",letters:"y"},{base:"z",letters:"z"}],HY=new RegExp("["+CS.map(function(e){return e.letters}).join("")+"]","g"),yF={};for(var c2=0;c2<CS.length;c2++)for(var u2=CS[c2],d2=0;d2<u2.letters.length;d2++)yF[u2.letters[d2]]=u2.base;var vF=function(n){return n.replace(HY,function(o){return yF[o]})},GY=NY(vF),l3=function(n){return n.replace(/^\s+|\s+$/g,"")},WY=function(n){return"".concat(n.label," ").concat(n.value)},qY=function(n){return function(o,c){if(o.data.__isNew__)return!0;var d=Wr({ignoreCase:!0,ignoreAccents:!0,stringify:WY,trim:!0,matchFrom:"any"},n),y=d.ignoreCase,x=d.ignoreAccents,i=d.stringify,I=d.trim,R=d.matchFrom,k=I?l3(c):c,N=I?l3(i(o)):i(o);return y&&(k=k.toLowerCase(),N=N.toLowerCase()),x&&(k=GY(k),N=vF(N)),R==="start"?N.substr(0,k.length)===k:N.indexOf(k)>-1}},ZY=["innerRef"];function XY(e){var n=e.innerRef,o=Df(e,ZY),c=bK(o,"onExited","in","enter","exit","appear");return Nr("input",nt({ref:n},c,{css:G_({label:"dummyInput",background:0,border:0,caretColor:"transparent",fontSize:"inherit",gridArea:"1 / 1 / 2 / 3",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(.01)"},"","")}))}var KY=function(n){n.cancelable&&n.preventDefault(),n.stopPropagation()};function YY(e){var n=e.isEnabled,o=e.onBottomArrive,c=e.onBottomLeave,d=e.onTopArrive,y=e.onTopLeave,x=V.useRef(!1),i=V.useRef(!1),I=V.useRef(0),R=V.useRef(null),k=V.useCallback(function(J,le){if(R.current!==null){var de=R.current,ue=de.scrollTop,pe=de.scrollHeight,he=de.clientHeight,xe=R.current,fe=le>0,_e=pe-he-ue,Ce=!1;_e>le&&x.current&&(c&&c(J),x.current=!1),fe&&i.current&&(y&&y(J),i.current=!1),fe&&le>_e?(o&&!x.current&&o(J),xe.scrollTop=pe,Ce=!0,x.current=!0):!fe&&-le>ue&&(d&&!i.current&&d(J),xe.scrollTop=0,Ce=!0,i.current=!0),Ce&&KY(J)}},[o,c,d,y]),N=V.useCallback(function(J){k(J,J.deltaY)},[k]),U=V.useCallback(function(J){I.current=J.changedTouches[0].clientY},[]),K=V.useCallback(function(J){var le=I.current-J.changedTouches[0].clientY;k(J,le)},[k]),X=V.useCallback(function(J){if(J){var le=yK?{passive:!1}:!1;J.addEventListener("wheel",N,le),J.addEventListener("touchstart",U,le),J.addEventListener("touchmove",K,le)}},[K,U,N]),Z=V.useCallback(function(J){J&&(J.removeEventListener("wheel",N,!1),J.removeEventListener("touchstart",U,!1),J.removeEventListener("touchmove",K,!1))},[K,U,N]);return V.useEffect(function(){if(n){var J=R.current;return X(J),function(){Z(J)}}},[n,X,Z]),function(J){R.current=J}}var c3=["boxSizing","height","overflow","paddingRight","position"],u3={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function d3(e){e.cancelable&&e.preventDefault()}function h3(e){e.stopPropagation()}function f3(){var e=this.scrollTop,n=this.scrollHeight,o=e+this.offsetHeight;e===0?this.scrollTop=1:o===n&&(this.scrollTop=e-1)}function p3(){return"ontouchstart"in window||navigator.maxTouchPoints}var m3=!!(typeof window<"u"&&window.document&&window.document.createElement),qy=0,Xg={capture:!1,passive:!1};function JY(e){var n=e.isEnabled,o=e.accountForScrollbars,c=o===void 0?!0:o,d=V.useRef({}),y=V.useRef(null),x=V.useCallback(function(I){if(m3){var R=document.body,k=R&&R.style;if(c&&c3.forEach(function(X){var Z=k&&k[X];d.current[X]=Z}),c&&qy<1){var N=parseInt(d.current.paddingRight,10)||0,U=document.body?document.body.clientWidth:0,K=window.innerWidth-U+N||0;Object.keys(u3).forEach(function(X){var Z=u3[X];k&&(k[X]=Z)}),k&&(k.paddingRight="".concat(K,"px"))}R&&p3()&&(R.addEventListener("touchmove",d3,Xg),I&&(I.addEventListener("touchstart",f3,Xg),I.addEventListener("touchmove",h3,Xg))),qy+=1}},[c]),i=V.useCallback(function(I){if(m3){var R=document.body,k=R&&R.style;qy=Math.max(qy-1,0),c&&qy<1&&c3.forEach(function(N){var U=d.current[N];k&&(k[N]=U)}),R&&p3()&&(R.removeEventListener("touchmove",d3,Xg),I&&(I.removeEventListener("touchstart",f3,Xg),I.removeEventListener("touchmove",h3,Xg)))}},[c]);return V.useEffect(function(){if(n){var I=y.current;return x(I),function(){i(I)}}},[n,x,i]),function(I){y.current=I}}var QY=function(n){var o=n.target;return o.ownerDocument.activeElement&&o.ownerDocument.activeElement.blur()},eJ={name:"1kfdb0e",styles:"position:fixed;left:0;bottom:0;right:0;top:0"};function tJ(e){var n=e.children,o=e.lockEnabled,c=e.captureEnabled,d=c===void 0?!0:c,y=e.onBottomArrive,x=e.onBottomLeave,i=e.onTopArrive,I=e.onTopLeave,R=YY({isEnabled:d,onBottomArrive:y,onBottomLeave:x,onTopArrive:i,onTopLeave:I}),k=JY({isEnabled:o}),N=function(K){R(K),k(K)};return Nr(V.Fragment,null,o&&Nr("div",{onClick:QY,css:eJ}),n(N))}var nJ={name:"1a0ro4n-requiredInput",styles:"label:requiredInput;opacity:0;pointer-events:none;position:absolute;bottom:0;left:0;right:0;width:100%"},rJ=function(n){var o=n.name,c=n.onFocus;return Nr("input",{required:!0,name:o,tabIndex:-1,"aria-hidden":"true",onFocus:c,css:nJ,value:"",onChange:function(){}})},iJ=rJ;function uT(e){var n;return typeof window<"u"&&window.navigator!=null?e.test(((n=window.navigator.userAgentData)===null||n===void 0?void 0:n.platform)||window.navigator.platform):!1}function sJ(){return uT(/^iPhone/i)}function xF(){return uT(/^Mac/i)}function oJ(){return uT(/^iPad/i)||xF()&&navigator.maxTouchPoints>1}function aJ(){return sJ()||oJ()}function lJ(){return xF()||aJ()}var cJ=function(n){return n.label},uJ=function(n){return n.label},dJ=function(n){return n.value},hJ=function(n){return!!n.isDisabled},fJ={clearIndicator:XK,container:NK,control:nY,dropdownIndicator:qK,group:oY,groupHeading:lY,indicatorsContainer:UK,indicatorSeparator:YK,input:hY,loadingIndicator:eY,loadingMessage:DK,menu:EK,menuList:RK,menuPortal:zK,multiValue:_Y,multiValueLabel:yY,multiValueRemove:vY,noOptionsMessage:LK,option:TY,placeholder:PY,singleValue:MY,valueContainer:BK},pJ={primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},mJ=4,bF=4,gJ=38,_J=bF*2,yJ={baseUnit:bF,controlHeight:gJ,menuGutter:_J},h2={borderRadius:mJ,colors:pJ,spacing:yJ},vJ={"aria-live":"polite",backspaceRemovesValue:!0,blurInputOnSelect:i3(),captureMenuScroll:!i3(),classNames:{},closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:qY(),formatGroupLabel:cJ,getOptionLabel:uJ,getOptionValue:dJ,isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:hJ,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!gK(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(n){var o=n.count;return"".concat(o," result").concat(o!==1?"s":""," available")},styles:{},tabIndex:0,tabSelectsValue:!0,unstyled:!1};function g3(e,n,o,c){var d=CF(e,n,o),y=TF(e,n,o),x=SF(e,n),i=i1(e,n);return{type:"option",data:n,isDisabled:d,isSelected:y,label:x,value:i,index:c}}function P0(e,n){return e.options.map(function(o,c){if("options"in o){var d=o.options.map(function(x,i){return g3(e,x,n,i)}).filter(function(x){return y3(e,x)});return d.length>0?{type:"group",data:o,options:d,index:c}:void 0}var y=g3(e,o,n,c);return y3(e,y)?y:void 0}).filter(vK)}function wF(e){return e.reduce(function(n,o){return o.type==="group"?n.push.apply(n,JC(o.options.map(function(c){return c.data}))):n.push(o.data),n},[])}function _3(e,n){return e.reduce(function(o,c){return c.type==="group"?o.push.apply(o,JC(c.options.map(function(d){return{data:d.data,id:"".concat(n,"-").concat(c.index,"-").concat(d.index)}}))):o.push({data:c.data,id:"".concat(n,"-").concat(c.index)}),o},[])}function xJ(e,n){return wF(P0(e,n))}function y3(e,n){var o=e.inputValue,c=o===void 0?"":o,d=n.data,y=n.isSelected,x=n.label,i=n.value;return(!IF(e)||!y)&&EF(e,{label:x,value:i,data:d},c)}function bJ(e,n){var o=e.focusedValue,c=e.selectValue,d=c.indexOf(o);if(d>-1){var y=n.indexOf(o);if(y>-1)return o;if(d<n.length)return n[d]}return null}function wJ(e,n){var o=e.focusedOption;return o&&n.indexOf(o)>-1?o:n[0]}var f2=function(n,o){var c,d=(c=n.find(function(y){return y.data===o}))===null||c===void 0?void 0:c.id;return d||null},SF=function(n,o){return n.getOptionLabel(o)},i1=function(n,o){return n.getOptionValue(o)};function CF(e,n,o){return typeof e.isOptionDisabled=="function"?e.isOptionDisabled(n,o):!1}function TF(e,n,o){if(o.indexOf(n)>-1)return!0;if(typeof e.isOptionSelected=="function")return e.isOptionSelected(n,o);var c=i1(e,n);return o.some(function(d){return i1(e,d)===c})}function EF(e,n,o){return e.filterOption?e.filterOption(n,o):!0}var IF=function(n){var o=n.hideSelectedOptions,c=n.isMulti;return o===void 0?c:o},SJ=1,PF=function(e){QZ(o,e);var n=tX(o);function o(c){var d;if(YZ(this,o),d=n.call(this,c),d.state={ariaSelection:null,focusedOption:null,focusedOptionId:null,focusableOptionsWithIds:[],focusedValue:null,inputIsHidden:!1,isFocused:!1,selectValue:[],clearFocusValueOnUpdate:!1,prevWasFocused:!1,inputIsHiddenAfterUpdate:void 0,prevProps:void 0,instancePrefix:""},d.blockOptionHover=!1,d.isComposing=!1,d.commonProps=void 0,d.initialTouchX=0,d.initialTouchY=0,d.openAfterFocus=!1,d.scrollToFocusedOptionOnUpdate=!1,d.userIsDragging=void 0,d.isAppleDevice=lJ(),d.controlRef=null,d.getControlRef=function(I){d.controlRef=I},d.focusedOptionRef=null,d.getFocusedOptionRef=function(I){d.focusedOptionRef=I},d.menuListRef=null,d.getMenuListRef=function(I){d.menuListRef=I},d.inputRef=null,d.getInputRef=function(I){d.inputRef=I},d.focus=d.focusInput,d.blur=d.blurInput,d.onChange=function(I,R){var k=d.props,N=k.onChange,U=k.name;R.name=U,d.ariaOnChange(I,R),N(I,R)},d.setValue=function(I,R,k){var N=d.props,U=N.closeMenuOnSelect,K=N.isMulti,X=N.inputValue;d.onInputChange("",{action:"set-value",prevInputValue:X}),U&&(d.setState({inputIsHiddenAfterUpdate:!K}),d.onMenuClose()),d.setState({clearFocusValueOnUpdate:!0}),d.onChange(I,{action:R,option:k})},d.selectOption=function(I){var R=d.props,k=R.blurInputOnSelect,N=R.isMulti,U=R.name,K=d.state.selectValue,X=N&&d.isOptionSelected(I,K),Z=d.isOptionDisabled(I,K);if(X){var J=d.getOptionValue(I);d.setValue(K.filter(function(le){return d.getOptionValue(le)!==J}),"deselect-option",I)}else if(!Z)N?d.setValue([].concat(JC(K),[I]),"select-option",I):d.setValue(I,"select-option");else{d.ariaOnChange(I,{action:"select-option",option:I,name:U});return}k&&d.blurInput()},d.removeValue=function(I){var R=d.props.isMulti,k=d.state.selectValue,N=d.getOptionValue(I),U=k.filter(function(X){return d.getOptionValue(X)!==N}),K=h0(R,U,U[0]||null);d.onChange(K,{action:"remove-value",removedValue:I}),d.focusInput()},d.clearValue=function(){var I=d.state.selectValue;d.onChange(h0(d.props.isMulti,[],null),{action:"clear",removedValues:I})},d.popValue=function(){var I=d.props.isMulti,R=d.state.selectValue,k=R[R.length-1],N=R.slice(0,R.length-1),U=h0(I,N,N[0]||null);k&&d.onChange(U,{action:"pop-value",removedValue:k})},d.getFocusedOptionId=function(I){return f2(d.state.focusableOptionsWithIds,I)},d.getFocusableOptionsWithIds=function(){return _3(P0(d.props,d.state.selectValue),d.getElementId("option"))},d.getValue=function(){return d.state.selectValue},d.cx=function(){for(var I=arguments.length,R=new Array(I),k=0;k<I;k++)R[k]=arguments[k];return dK.apply(void 0,[d.props.classNamePrefix].concat(R))},d.getOptionLabel=function(I){return SF(d.props,I)},d.getOptionValue=function(I){return i1(d.props,I)},d.getStyles=function(I,R){var k=d.props.unstyled,N=fJ[I](R,k);N.boxSizing="border-box";var U=d.props.styles[I];return U?U(N,R):N},d.getClassNames=function(I,R){var k,N;return(k=(N=d.props.classNames)[I])===null||k===void 0?void 0:k.call(N,R)},d.getElementId=function(I){return"".concat(d.state.instancePrefix,"-").concat(I)},d.getComponents=function(){return OY(d.props)},d.buildCategorizedOptions=function(){return P0(d.props,d.state.selectValue)},d.getCategorizedOptions=function(){return d.props.menuIsOpen?d.buildCategorizedOptions():[]},d.buildFocusableOptions=function(){return wF(d.buildCategorizedOptions())},d.getFocusableOptions=function(){return d.props.menuIsOpen?d.buildFocusableOptions():[]},d.ariaOnChange=function(I,R){d.setState({ariaSelection:Wr({value:I},R)})},d.onMenuMouseDown=function(I){I.button===0&&(I.stopPropagation(),I.preventDefault(),d.focusInput())},d.onMenuMouseMove=function(I){d.blockOptionHover=!1},d.onControlMouseDown=function(I){if(!I.defaultPrevented){var R=d.props.openMenuOnClick;d.state.isFocused?d.props.menuIsOpen?I.target.tagName!=="INPUT"&&I.target.tagName!=="TEXTAREA"&&d.onMenuClose():R&&d.openMenu("first"):(R&&(d.openAfterFocus=!0),d.focusInput()),I.target.tagName!=="INPUT"&&I.target.tagName!=="TEXTAREA"&&I.preventDefault()}},d.onDropdownIndicatorMouseDown=function(I){if(!(I&&I.type==="mousedown"&&I.button!==0)&&!d.props.isDisabled){var R=d.props,k=R.isMulti,N=R.menuIsOpen;d.focusInput(),N?(d.setState({inputIsHiddenAfterUpdate:!k}),d.onMenuClose()):d.openMenu("first"),I.preventDefault()}},d.onClearIndicatorMouseDown=function(I){I&&I.type==="mousedown"&&I.button!==0||(d.clearValue(),I.preventDefault(),d.openAfterFocus=!1,I.type==="touchend"?d.focusInput():setTimeout(function(){return d.focusInput()}))},d.onScroll=function(I){typeof d.props.closeMenuOnScroll=="boolean"?I.target instanceof HTMLElement&&q1(I.target)&&d.props.onMenuClose():typeof d.props.closeMenuOnScroll=="function"&&d.props.closeMenuOnScroll(I)&&d.props.onMenuClose()},d.onCompositionStart=function(){d.isComposing=!0},d.onCompositionEnd=function(){d.isComposing=!1},d.onTouchStart=function(I){var R=I.touches,k=R&&R.item(0);k&&(d.initialTouchX=k.clientX,d.initialTouchY=k.clientY,d.userIsDragging=!1)},d.onTouchMove=function(I){var R=I.touches,k=R&&R.item(0);if(k){var N=Math.abs(k.clientX-d.initialTouchX),U=Math.abs(k.clientY-d.initialTouchY),K=5;d.userIsDragging=N>K||U>K}},d.onTouchEnd=function(I){d.userIsDragging||(d.controlRef&&!d.controlRef.contains(I.target)&&d.menuListRef&&!d.menuListRef.contains(I.target)&&d.blurInput(),d.initialTouchX=0,d.initialTouchY=0)},d.onControlTouchEnd=function(I){d.userIsDragging||d.onControlMouseDown(I)},d.onClearIndicatorTouchEnd=function(I){d.userIsDragging||d.onClearIndicatorMouseDown(I)},d.onDropdownIndicatorTouchEnd=function(I){d.userIsDragging||d.onDropdownIndicatorMouseDown(I)},d.handleInputChange=function(I){var R=d.props.inputValue,k=I.currentTarget.value;d.setState({inputIsHiddenAfterUpdate:!1}),d.onInputChange(k,{action:"input-change",prevInputValue:R}),d.props.menuIsOpen||d.onMenuOpen()},d.onInputFocus=function(I){d.props.onFocus&&d.props.onFocus(I),d.setState({inputIsHiddenAfterUpdate:!1,isFocused:!0}),(d.openAfterFocus||d.props.openMenuOnFocus)&&d.openMenu("first"),d.openAfterFocus=!1},d.onInputBlur=function(I){var R=d.props.inputValue;if(d.menuListRef&&d.menuListRef.contains(document.activeElement)){d.inputRef.focus();return}d.props.onBlur&&d.props.onBlur(I),d.onInputChange("",{action:"input-blur",prevInputValue:R}),d.onMenuClose(),d.setState({focusedValue:null,isFocused:!1})},d.onOptionHover=function(I){if(!(d.blockOptionHover||d.state.focusedOption===I)){var R=d.getFocusableOptions(),k=R.indexOf(I);d.setState({focusedOption:I,focusedOptionId:k>-1?d.getFocusedOptionId(I):null})}},d.shouldHideSelectedOptions=function(){return IF(d.props)},d.onValueInputFocus=function(I){I.preventDefault(),I.stopPropagation(),d.focus()},d.onKeyDown=function(I){var R=d.props,k=R.isMulti,N=R.backspaceRemovesValue,U=R.escapeClearsValue,K=R.inputValue,X=R.isClearable,Z=R.isDisabled,J=R.menuIsOpen,le=R.onKeyDown,de=R.tabSelectsValue,ue=R.openMenuOnFocus,pe=d.state,he=pe.focusedOption,xe=pe.focusedValue,fe=pe.selectValue;if(!Z&&!(typeof le=="function"&&(le(I),I.defaultPrevented))){switch(d.blockOptionHover=!0,I.key){case"ArrowLeft":if(!k||K)return;d.focusValue("previous");break;case"ArrowRight":if(!k||K)return;d.focusValue("next");break;case"Delete":case"Backspace":if(K)return;if(xe)d.removeValue(xe);else{if(!N)return;k?d.popValue():X&&d.clearValue()}break;case"Tab":if(d.isComposing||I.shiftKey||!J||!de||!he||ue&&d.isOptionSelected(he,fe))return;d.selectOption(he);break;case"Enter":if(I.keyCode===229)break;if(J){if(!he||d.isComposing)return;d.selectOption(he);break}return;case"Escape":J?(d.setState({inputIsHiddenAfterUpdate:!1}),d.onInputChange("",{action:"menu-close",prevInputValue:K}),d.onMenuClose()):X&&U&&d.clearValue();break;case" ":if(K)return;if(!J){d.openMenu("first");break}if(!he)return;d.selectOption(he);break;case"ArrowUp":J?d.focusOption("up"):d.openMenu("last");break;case"ArrowDown":J?d.focusOption("down"):d.openMenu("first");break;case"PageUp":if(!J)return;d.focusOption("pageup");break;case"PageDown":if(!J)return;d.focusOption("pagedown");break;case"Home":if(!J)return;d.focusOption("first");break;case"End":if(!J)return;d.focusOption("last");break;default:return}I.preventDefault()}},d.state.instancePrefix="react-select-"+(d.props.instanceId||++SJ),d.state.selectValue=n3(c.value),c.menuIsOpen&&d.state.selectValue.length){var y=d.getFocusableOptionsWithIds(),x=d.buildFocusableOptions(),i=x.indexOf(d.state.selectValue[0]);d.state.focusableOptionsWithIds=y,d.state.focusedOption=x[i],d.state.focusedOptionId=f2(y,x[i])}return d}return JZ(o,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput(),this.props.menuIsOpen&&this.state.focusedOption&&this.menuListRef&&this.focusedOptionRef&&r3(this.menuListRef,this.focusedOptionRef)}},{key:"componentDidUpdate",value:function(d){var y=this.props,x=y.isDisabled,i=y.menuIsOpen,I=this.state.isFocused;(I&&!x&&d.isDisabled||I&&i&&!d.menuIsOpen)&&this.focusInput(),I&&x&&!d.isDisabled?this.setState({isFocused:!1},this.onMenuClose):!I&&!x&&d.isDisabled&&this.inputRef===document.activeElement&&this.setState({isFocused:!0}),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(r3(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){this.onInputChange("",{action:"menu-close",prevInputValue:this.props.inputValue}),this.props.onMenuClose()}},{key:"onInputChange",value:function(d,y){this.props.onInputChange(d,y)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(d){var y=this,x=this.state,i=x.selectValue,I=x.isFocused,R=this.buildFocusableOptions(),k=d==="first"?0:R.length-1;if(!this.props.isMulti){var N=R.indexOf(i[0]);N>-1&&(k=N)}this.scrollToFocusedOptionOnUpdate=!(I&&this.menuListRef),this.setState({inputIsHiddenAfterUpdate:!1,focusedValue:null,focusedOption:R[k],focusedOptionId:this.getFocusedOptionId(R[k])},function(){return y.onMenuOpen()})}},{key:"focusValue",value:function(d){var y=this.state,x=y.selectValue,i=y.focusedValue;if(this.props.isMulti){this.setState({focusedOption:null});var I=x.indexOf(i);i||(I=-1);var R=x.length-1,k=-1;if(x.length){switch(d){case"previous":I===0?k=0:I===-1?k=R:k=I-1;break;case"next":I>-1&&I<R&&(k=I+1);break}this.setState({inputIsHidden:k!==-1,focusedValue:x[k]})}}}},{key:"focusOption",value:function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"first",y=this.props.pageSize,x=this.state.focusedOption,i=this.getFocusableOptions();if(i.length){var I=0,R=i.indexOf(x);x||(R=-1),d==="up"?I=R>0?R-1:i.length-1:d==="down"?I=(R+1)%i.length:d==="pageup"?(I=R-y,I<0&&(I=0)):d==="pagedown"?(I=R+y,I>i.length-1&&(I=i.length-1)):d==="last"&&(I=i.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:i[I],focusedValue:null,focusedOptionId:this.getFocusedOptionId(i[I])})}}},{key:"getTheme",value:function(){return this.props.theme?typeof this.props.theme=="function"?this.props.theme(h2):Wr(Wr({},h2),this.props.theme):h2}},{key:"getCommonProps",value:function(){var d=this.clearValue,y=this.cx,x=this.getStyles,i=this.getClassNames,I=this.getValue,R=this.selectOption,k=this.setValue,N=this.props,U=N.isMulti,K=N.isRtl,X=N.options,Z=this.hasValue();return{clearValue:d,cx:y,getStyles:x,getClassNames:i,getValue:I,hasValue:Z,isMulti:U,isRtl:K,options:X,selectOption:R,selectProps:N,setValue:k,theme:this.getTheme()}}},{key:"hasValue",value:function(){var d=this.state.selectValue;return d.length>0}},{key:"hasOptions",value:function(){return!!this.getFocusableOptions().length}},{key:"isClearable",value:function(){var d=this.props,y=d.isClearable,x=d.isMulti;return y===void 0?x:y}},{key:"isOptionDisabled",value:function(d,y){return CF(this.props,d,y)}},{key:"isOptionSelected",value:function(d,y){return TF(this.props,d,y)}},{key:"filterOption",value:function(d,y){return EF(this.props,d,y)}},{key:"formatOptionLabel",value:function(d,y){if(typeof this.props.formatOptionLabel=="function"){var x=this.props.inputValue,i=this.state.selectValue;return this.props.formatOptionLabel(d,{context:y,inputValue:x,selectValue:i})}else return this.getOptionLabel(d)}},{key:"formatGroupLabel",value:function(d){return this.props.formatGroupLabel(d)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"renderInput",value:function(){var d=this.props,y=d.isDisabled,x=d.isSearchable,i=d.inputId,I=d.inputValue,R=d.tabIndex,k=d.form,N=d.menuIsOpen,U=d.required,K=this.getComponents(),X=K.Input,Z=this.state,J=Z.inputIsHidden,le=Z.ariaSelection,de=this.commonProps,ue=i||this.getElementId("input"),pe=Wr(Wr(Wr({"aria-autocomplete":"list","aria-expanded":N,"aria-haspopup":!0,"aria-errormessage":this.props["aria-errormessage"],"aria-invalid":this.props["aria-invalid"],"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-required":U,role:"combobox","aria-activedescendant":this.isAppleDevice?void 0:this.state.focusedOptionId||""},N&&{"aria-controls":this.getElementId("listbox")}),!x&&{"aria-readonly":!0}),this.hasValue()?(le==null?void 0:le.action)==="initial-input-focus"&&{"aria-describedby":this.getElementId("live-region")}:{"aria-describedby":this.getElementId("placeholder")});return x?V.createElement(X,nt({},de,{autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",id:ue,innerRef:this.getInputRef,isDisabled:y,isHidden:J,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,spellCheck:"false",tabIndex:R,form:k,type:"text",value:I},pe)):V.createElement(XY,nt({id:ue,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:n1,onFocus:this.onInputFocus,disabled:y,tabIndex:R,inputMode:"none",form:k,value:""},pe))}},{key:"renderPlaceholderOrValue",value:function(){var d=this,y=this.getComponents(),x=y.MultiValue,i=y.MultiValueContainer,I=y.MultiValueLabel,R=y.MultiValueRemove,k=y.SingleValue,N=y.Placeholder,U=this.commonProps,K=this.props,X=K.controlShouldRenderValue,Z=K.isDisabled,J=K.isMulti,le=K.inputValue,de=K.placeholder,ue=this.state,pe=ue.selectValue,he=ue.focusedValue,xe=ue.isFocused;if(!this.hasValue()||!X)return le?null:V.createElement(N,nt({},U,{key:"placeholder",isDisabled:Z,isFocused:xe,innerProps:{id:this.getElementId("placeholder")}}),de);if(J)return pe.map(function(_e,Ce){var je=_e===he,He="".concat(d.getOptionLabel(_e),"-").concat(d.getOptionValue(_e));return V.createElement(x,nt({},U,{components:{Container:i,Label:I,Remove:R},isFocused:je,isDisabled:Z,key:He,index:Ce,removeProps:{onClick:function(){return d.removeValue(_e)},onTouchEnd:function(){return d.removeValue(_e)},onMouseDown:function(_t){_t.preventDefault()}},data:_e}),d.formatOptionLabel(_e,"value"))});if(le)return null;var fe=pe[0];return V.createElement(k,nt({},U,{data:fe,isDisabled:Z}),this.formatOptionLabel(fe,"value"))}},{key:"renderClearIndicator",value:function(){var d=this.getComponents(),y=d.ClearIndicator,x=this.commonProps,i=this.props,I=i.isDisabled,R=i.isLoading,k=this.state.isFocused;if(!this.isClearable()||!y||I||!this.hasValue()||R)return null;var N={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return V.createElement(y,nt({},x,{innerProps:N,isFocused:k}))}},{key:"renderLoadingIndicator",value:function(){var d=this.getComponents(),y=d.LoadingIndicator,x=this.commonProps,i=this.props,I=i.isDisabled,R=i.isLoading,k=this.state.isFocused;if(!y||!R)return null;var N={"aria-hidden":"true"};return V.createElement(y,nt({},x,{innerProps:N,isDisabled:I,isFocused:k}))}},{key:"renderIndicatorSeparator",value:function(){var d=this.getComponents(),y=d.DropdownIndicator,x=d.IndicatorSeparator;if(!y||!x)return null;var i=this.commonProps,I=this.props.isDisabled,R=this.state.isFocused;return V.createElement(x,nt({},i,{isDisabled:I,isFocused:R}))}},{key:"renderDropdownIndicator",value:function(){var d=this.getComponents(),y=d.DropdownIndicator;if(!y)return null;var x=this.commonProps,i=this.props.isDisabled,I=this.state.isFocused,R={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return V.createElement(y,nt({},x,{innerProps:R,isDisabled:i,isFocused:I}))}},{key:"renderMenu",value:function(){var d=this,y=this.getComponents(),x=y.Group,i=y.GroupHeading,I=y.Menu,R=y.MenuList,k=y.MenuPortal,N=y.LoadingMessage,U=y.NoOptionsMessage,K=y.Option,X=this.commonProps,Z=this.state.focusedOption,J=this.props,le=J.captureMenuScroll,de=J.inputValue,ue=J.isLoading,pe=J.loadingMessage,he=J.minMenuHeight,xe=J.maxMenuHeight,fe=J.menuIsOpen,_e=J.menuPlacement,Ce=J.menuPosition,je=J.menuPortalTarget,He=J.menuShouldBlockScroll,lt=J.menuShouldScrollIntoView,_t=J.noOptionsMessage,Ue=J.onMenuScrollToTop,Ge=J.onMenuScrollToBottom;if(!fe)return null;var at=function(At,Ct){var We=At.type,st=At.data,Bt=At.isDisabled,hn=At.isSelected,cn=At.label,cr=At.value,Nn=Z===st,Vn=Bt?void 0:function(){return d.onOptionHover(st)},An=Bt?void 0:function(){return d.selectOption(st)},Zt="".concat(d.getElementId("option"),"-").concat(Ct),mn={id:Zt,onClick:An,onMouseMove:Vn,onMouseOver:Vn,tabIndex:-1,role:"option","aria-selected":d.isAppleDevice?void 0:hn};return V.createElement(K,nt({},X,{innerProps:mn,data:st,isDisabled:Bt,isSelected:hn,key:Zt,label:cn,type:We,value:cr,isFocused:Nn,innerRef:Nn?d.getFocusedOptionRef:void 0}),d.formatOptionLabel(At.data,"menu"))},yt;if(this.hasOptions())yt=this.getCategorizedOptions().map(function(Ye){if(Ye.type==="group"){var At=Ye.data,Ct=Ye.options,We=Ye.index,st="".concat(d.getElementId("group"),"-").concat(We),Bt="".concat(st,"-heading");return V.createElement(x,nt({},X,{key:st,data:At,options:Ct,Heading:i,headingProps:{id:Bt,data:Ye.data},label:d.formatGroupLabel(Ye.data)}),Ye.options.map(function(hn){return at(hn,"".concat(We,"-").concat(hn.index))}))}else if(Ye.type==="option")return at(Ye,"".concat(Ye.index))});else if(ue){var tt=pe({inputValue:de});if(tt===null)return null;yt=V.createElement(N,X,tt)}else{var Rt=_t({inputValue:de});if(Rt===null)return null;yt=V.createElement(U,X,Rt)}var ct={minMenuHeight:he,maxMenuHeight:xe,menuPlacement:_e,menuPosition:Ce,menuShouldScrollIntoView:lt},ze=V.createElement(IK,nt({},X,ct),function(Ye){var At=Ye.ref,Ct=Ye.placerProps,We=Ct.placement,st=Ct.maxHeight;return V.createElement(I,nt({},X,ct,{innerRef:At,innerProps:{onMouseDown:d.onMenuMouseDown,onMouseMove:d.onMenuMouseMove},isLoading:ue,placement:We}),V.createElement(tJ,{captureEnabled:le,onTopArrive:Ue,onBottomArrive:Ge,lockEnabled:He},function(Bt){return V.createElement(R,nt({},X,{innerRef:function(cn){d.getMenuListRef(cn),Bt(cn)},innerProps:{role:"listbox","aria-multiselectable":X.isMulti,id:d.getElementId("listbox")},isLoading:ue,maxHeight:st,focusedOption:Z}),yt)}))});return je||Ce==="fixed"?V.createElement(k,nt({},X,{appendTo:je,controlElement:this.controlRef,menuPlacement:_e,menuPosition:Ce}),ze):ze}},{key:"renderFormField",value:function(){var d=this,y=this.props,x=y.delimiter,i=y.isDisabled,I=y.isMulti,R=y.name,k=y.required,N=this.state.selectValue;if(k&&!this.hasValue()&&!i)return V.createElement(iJ,{name:R,onFocus:this.onValueInputFocus});if(!(!R||i))if(I)if(x){var U=N.map(function(Z){return d.getOptionValue(Z)}).join(x);return V.createElement("input",{name:R,type:"hidden",value:U})}else{var K=N.length>0?N.map(function(Z,J){return V.createElement("input",{key:"i-".concat(J),name:R,type:"hidden",value:d.getOptionValue(Z)})}):V.createElement("input",{name:R,type:"hidden",value:""});return V.createElement("div",null,K)}else{var X=N[0]?this.getOptionValue(N[0]):"";return V.createElement("input",{name:R,type:"hidden",value:X})}}},{key:"renderLiveRegion",value:function(){var d=this.commonProps,y=this.state,x=y.ariaSelection,i=y.focusedOption,I=y.focusedValue,R=y.isFocused,k=y.selectValue,N=this.getFocusableOptions();return V.createElement($Y,nt({},d,{id:this.getElementId("live-region"),ariaSelection:x,focusedOption:i,focusedValue:I,isFocused:R,selectValue:k,focusableOptions:N,isAppleDevice:this.isAppleDevice}))}},{key:"render",value:function(){var d=this.getComponents(),y=d.Control,x=d.IndicatorsContainer,i=d.SelectContainer,I=d.ValueContainer,R=this.props,k=R.className,N=R.id,U=R.isDisabled,K=R.menuIsOpen,X=this.state.isFocused,Z=this.commonProps=this.getCommonProps();return V.createElement(i,nt({},Z,{className:k,innerProps:{id:N,onKeyDown:this.onKeyDown},isDisabled:U,isFocused:X}),this.renderLiveRegion(),V.createElement(y,nt({},Z,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:U,isFocused:X,menuIsOpen:K}),V.createElement(I,nt({},Z,{isDisabled:U}),this.renderPlaceholderOrValue(),this.renderInput()),V.createElement(x,nt({},Z,{isDisabled:U}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}],[{key:"getDerivedStateFromProps",value:function(d,y){var x=y.prevProps,i=y.clearFocusValueOnUpdate,I=y.inputIsHiddenAfterUpdate,R=y.ariaSelection,k=y.isFocused,N=y.prevWasFocused,U=y.instancePrefix,K=d.options,X=d.value,Z=d.menuIsOpen,J=d.inputValue,le=d.isMulti,de=n3(X),ue={};if(x&&(X!==x.value||K!==x.options||Z!==x.menuIsOpen||J!==x.inputValue)){var pe=Z?xJ(d,de):[],he=Z?_3(P0(d,de),"".concat(U,"-option")):[],xe=i?bJ(y,de):null,fe=wJ(y,pe),_e=f2(he,fe);ue={selectValue:de,focusedOption:fe,focusedOptionId:_e,focusableOptionsWithIds:he,focusedValue:xe,clearFocusValueOnUpdate:!1}}var Ce=I!=null&&d!==x?{inputIsHidden:I,inputIsHiddenAfterUpdate:void 0}:{},je=R,He=k&&N;return k&&!He&&(je={value:h0(le,de,de[0]||null),options:de,action:"initial-input-focus"},He=!N),(R==null?void 0:R.action)==="initial-input-focus"&&(je=null),Wr(Wr(Wr({},ue),Ce),{},{prevProps:d,ariaSelection:je,prevWasFocused:He})}}]),o}(V.Component);PF.defaultProps=vJ;var CJ=V.forwardRef(function(e,n){var o=KZ(e);return V.createElement(PF,nt({ref:n},o))}),A0=CJ;const TJ=e=>{if(!e)return"";if(typeof e=="object"&&e!==null)if(e.value)e=e.value;else return"";return typeof e!="string"?String(e):e.split("_").map(n=>n.charAt(0).toUpperCase()+n.slice(1).toLowerCase()).join(" ")},Wa=(e,n="")=>e?e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toUpperCase().replace(/\s+/g,"_"):n,p2=e=>{if(!e||typeof e!="string")return null;try{const n=new Date(e);return n.getFullYear()+"-"+String(n.getMonth()+1).padStart(2,"0")+"-"+String(n.getDate()).padStart(2,"0")+" "+String(n.getHours()).padStart(2,"0")+":"+String(n.getMinutes()).padStart(2,"0")+":"+String(n.getSeconds()).padStart(2,"0")+"."+String(n.getMilliseconds()).padStart(3,"0")}catch(n){return console.error("Erreur lors du formatage de la date:",n),null}},AF=V.createContext(),EJ=({children:e})=>{const n=ml(),[o,c]=V.useState([]),[d,y]=V.useState([]),[x,i]=V.useState([]),[I,R]=V.useState([]),[k,N]=V.useState(!0),[U,K]=V.useState(!0),[X,Z]=V.useState({}),[J,le]=V.useState({}),[de,ue]=V.useState({breed:"",color:"",eyeColor:"",postalCode:"",location:{latitude:"",longitude:"",radius:10,address:""}}),pe=V.useCallback((ze,Ye,At,Ct)=>{if(!ze||!Ye||!At||!Ct)return 1/0;const We=6371,st=(At-ze)*Math.PI/180,Bt=(Ct-Ye)*Math.PI/180,hn=Math.sin(st/2)*Math.sin(st/2)+Math.cos(ze*Math.PI/180)*Math.cos(At*Math.PI/180)*Math.sin(Bt/2)*Math.sin(Bt/2),cn=2*Math.atan2(Math.sqrt(hn),Math.sqrt(1-hn));return We*cn},[]),he=async(ze,Ye)=>{try{const Ct=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${ze}&lon=${Ye}&zoom=18&addressdetails=1`)).json();return Ct&&Ct.address?{address:[Ct.address.road,Ct.address.house_number].filter(Boolean).join(" "),city:Ct.address.city||Ct.address.town||Ct.address.village||"",postalCode:Ct.address.postcode||"",latitude:ze,longitude:Ye}:null}catch(At){return console.error("Erreur lors de la rcupration de l'adresse:",At),null}},xe=async()=>new Promise((ze,Ye)=>{if(!navigator.geolocation){Ye(new Error("La golocalisation n'est pas prise en charge par votre navigateur."));return}navigator.geolocation.getCurrentPosition(async At=>{const{latitude:Ct,longitude:We}=At.coords,st=await he(Ct,We);st?(ue(Bt=>({...Bt,postalCode:"",location:{...Bt.location,latitude:Ct,longitude:We,address:st.address,city:st.city,postalCode:st.postalCode}})),ze(st)):(ue(Bt=>({...Bt,postalCode:"",location:{...Bt.location,latitude:Ct,longitude:We,address:"Position actuelle"}})),ze({latitude:Ct,longitude:We,address:"Position actuelle"}))},At=>{console.error("Erreur de golocalisation:",At),Ye(At)})}),fe=(ze,Ye)=>{ue(ze==="postalCode"?At=>({...At,postalCode:Ye,location:{...At.location,latitude:"",longitude:"",address:"",city:"",postalCode:""}}):ze==="radius"?At=>({...At,location:{...At.location,radius:Ye}}):At=>({...At,[ze]:Ye}))},_e=()=>{ue({breed:"",color:"",eyeColor:"",postalCode:"",location:{latitude:"",longitude:"",radius:10,address:""}}),i(o),R(d)},Ce=()=>{ue(ze=>({...ze,location:{...ze.location,latitude:"",longitude:"",address:"",city:"",postalCode:""}}))},je=V.useCallback(()=>{if(!o||o.length===0)return;let ze=[...o];de.breed&&(ze=ze.filter(Ye=>Ye.cat.breed===de.breed)),de.color&&(ze=ze.filter(Ye=>Ye.cat.color===de.color)),de.eyeColor&&(ze=ze.filter(Ye=>Ye.cat.eyeColor===de.eyeColor)),de.postalCode&&(ze=ze.filter(Ye=>Ye.location&&Ye.location.postalCode&&Ye.location.postalCode.includes(de.postalCode))),de.location.latitude&&de.location.longitude&&(ze=ze.filter(Ye=>!Ye.location||!Ye.location.latitude||!Ye.location.longitude?!1:pe(de.location.latitude,de.location.longitude,Ye.location.latitude,Ye.location.longitude)<=de.location.radius)),i(ze)},[o,de,pe]),He=V.useCallback(()=>{if(!d||d.length===0)return;let ze=[...d];de.breed&&(ze=ze.filter(Ye=>Ye.cat.breed===de.breed)),de.color&&(ze=ze.filter(Ye=>Ye.cat.color===de.color)),de.eyeColor&&(ze=ze.filter(Ye=>Ye.cat.eyeColor===de.eyeColor)),de.postalCode&&(ze=ze.filter(Ye=>Ye.location&&Ye.location.postalCode&&Ye.location.postalCode.includes(de.postalCode))),de.location.latitude&&de.location.longitude&&(ze=ze.filter(Ye=>!Ye.location||!Ye.location.latitude||!Ye.location.longitude?!1:pe(de.location.latitude,de.location.longitude,Ye.location.latitude,Ye.location.longitude)<=de.location.radius)),R(ze)},[d,de,pe]),lt=V.useCallback(async()=>{try{N(!0);const Ye=(await n.get("cat/findFoundCat")||[]).sort((At,Ct)=>new Date(Ct.reportDate)-new Date(At.reportDate));c(Ye),i(Ye),N(!1)}catch(ze){console.error("Erreur lors de la rcupration des chats trouvs:",ze),c([]),i([]),N(!1)}},[n]),_t=V.useCallback(async()=>{try{K(!0);const Ye=(await n.get("cat/findLostCat")||[]).sort((At,Ct)=>new Date(Ct.reportDate)-new Date(At.reportDate));y(Ye),R(Ye),K(!1)}catch(ze){console.error("Erreur lors de la rcupration des chats perdus:",ze),y([]),R([]),K(!1)}},[n]),Ue=V.useCallback(async()=>{if(o.length===0||o.every(Ct=>typeof X[Ct.cat.catId]<"u"))return;const Ye={...X},At=o.filter(Ct=>typeof X[Ct.cat.catId]>"u");for(const Ct of At){const We=Ct.cat.catId;le(st=>({...st,[We]:!0}));try{const st=await n.get(`/cat/potentialLostCats/${We}`);Ye[We]=st?st.length:0}catch(st){console.error(`Erreur lors de la rcupration des correspondances pour le chat ${We}:`,st),Ye[We]=0}finally{le(st=>({...st,[We]:!1}))}}Z(Ye)},[o,n,X]),Ge=V.useCallback(async()=>{if(d.length===0||d.every(Ct=>typeof X[Ct.cat.catId]<"u"))return;const Ye={...X},At=d.filter(Ct=>typeof X[Ct.cat.catId]>"u");for(const Ct of At){const We=Ct.cat.catId;le(st=>({...st,[We]:!0}));try{const st=await n.get(`/cat/potentialFoundCats/${We}`);Ye[We]=st?st.length:0}catch(st){console.error(`Erreur lors de la rcupration des correspondances pour le chat ${We}:`,st),Ye[We]=0}finally{le(st=>({...st,[We]:!1}))}}Z(Ye)},[d,n,X]),at=ze=>{if(!ze)return"Inconnu";const Ye=new Date(ze),At=new Date;let Ct=At.getFullYear()-Ye.getFullYear();const We=At.getMonth()-Ye.getMonth();return(We<0||We===0&&At.getDate()<Ye.getDate())&&Ct--,Ct<1?`${At.getMonth()-Ye.getMonth()+(At.getFullYear()-Ye.getFullYear())*12} mois`:`${Ct} an${Ct>1?"s":""}`},yt=ze=>TJ(ze),tt=V.useCallback(async ze=>{try{return await n.get(`/cat/potentialLostCats/${ze}`)||[]}catch(Ye){return console.error("Erreur lors de la recherche des correspondances:",Ye),[]}},[n]),Rt=V.useCallback(async ze=>{try{return await n.get(`/cat/potentialFoundCats/${ze}`)||[]}catch(Ye){return console.error("Erreur lors de la recherche des chats trouvs correspondants:",Ye),[]}},[n]),ct=V.useCallback(async()=>{try{await lt(),await _t(),await Ue(),await Ge()}catch(ze){console.error("Erreur lors du rafrachissement des listes:",ze)}},[lt,_t,Ue,Ge]);return T.jsx(AF.Provider,{value:{foundCats:o,lostCats:d,filteredFoundCats:x,filteredLostCats:I,loadingFound:k,loadingLost:U,filters:de,matchCounts:X,loadingMatches:J,fetchFoundCats:lt,fetchLostCats:_t,handleFilterChange:fe,resetFilters:_e,useCurrentLocation:xe,clearCurrentLocation:Ce,applyFiltersToFoundCats:je,applyFiltersToLostCats:He,calculateDistance:pe,getAddressFromCoordinates:he,fetchFoundMatchCounts:Ue,fetchLostMatchCounts:Ge,calculateAge:at,formatValue:yt,findPotentialLostCats:tt,findPotentialFoundCats:Rt,refreshCatLists:ct},children:e})},kf=()=>{const e=V.useContext(AF);if(!e)throw new Error("useCatSearch must be used within a CatSearchProvider");return e},dT=({onImageUploaded:e,initialImage:n=null,maxSize:o=5,allowedTypes:c=["image/jpeg","image/png","image/gif","image/webp"],multiple:d=!1,maxImages:y=5,onUploadStatusChange:x=null})=>{const{t:i}=Rs(),I=ml(),[R,k]=V.useState(()=>n?Array.isArray(n)?n:[n]:[]),[N,U]=V.useState(!1),[K,X]=V.useState(null),[Z,J]=V.useState(0),[le,de]=V.useState(()=>n?Array.isArray(n)?n:[n]:[]),ue=_e=>{if(!c.includes(_e.type))return{isValid:!1,errorMessage:i("upload.unsupportedFileType","Type de fichier non support. Formats accepts: {{formats}}",{formats:c.map(je=>je.split("/")[1]).join(", ")})};const Ce=_e.size/(1024*1024);return Ce>o?{isValid:!1,errorMessage:i("upload.fileTooLarge","Fichier trop volumineux ({{size}} Mo). Taille maximale: {{maxSize}} Mo",{size:Ce.toFixed(2),maxSize:o})}:{isValid:!0}},pe=_e=>{const Ce=_e.match(/upload\/(?:v\d+\/)?([^\.]+)\./);return Ce?Ce[1]:null},he=async _e=>{var He,lt,_t;const Ce=d?Array.from(_e.target.files):[_e.target.files[0]];if(!Ce.length)return;if(d&&R.length+Ce.length>y){X(i("upload.tooManyImages","Vous ne pouvez pas tlcharger plus de {{maxImages}} images.",{maxImages:y}));return}for(const Ue of Ce){const{isValid:Ge,errorMessage:at}=ue(Ue);if(!Ge){X(at);return}}const je=[...R];for(const Ue of Ce){const Ge=new FileReader;Ge.onload=()=>{je.push(Ge.result),k([...je])},Ge.readAsDataURL(Ue)}U(!0),x&&x(!0),X(null),J(0);try{const Ue=[...le];for(let Ge=0;Ge<Ce.length;Ge++){const at=Ce[Ge],yt=new FormData;yt.append("file",at);const tt=await I.post("/media/upload",yt,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:Rt=>{const ct=Math.round(Rt.loaded*100/Rt.total);J(ct)}});Ue.push(tt),console.log(`Upload russi (${Ge+1}/${Ce.length}):`,tt)}de(Ue),e(d?Ue:Ue[Ue.length-1]),U(!1),x&&x(!1)}catch(Ue){console.error("Upload error:",Ue),console.log("Error details:",{message:Ue.message,response:Ue.response,status:(He=Ue.response)==null?void 0:He.status,data:(lt=Ue.response)==null?void 0:lt.data});let Ge=i("upload.uploadFailed","chec du tlchargement de l'image. Veuillez ressayer.");(_t=Ue.response)!=null&&_t.data?Ge=typeof Ue.response.data=="string"?Ue.response.data:JSON.stringify(Ue.response.data):Ue.message&&(Ge=Ue.message),X(Ge),U(!1),x&&x(!1)}},xe=async _e=>{const Ce=le[_e],je=pe(Ce);if(je)try{await I.delete(`/media/delete?publicId=${je}`)}catch{X("Erreur lors de la suppression de l'image sur le serveur.");return}const He=[...R],lt=[...le];He.splice(_e,1),lt.splice(_e,1),k(He),de(lt),e(d?lt:lt.length>0?lt[0]:null),X(null)},fe=()=>{X(null)};return T.jsxs("div",{className:"image-uploader",children:[R.length>0?T.jsxs("div",{className:"mb-3",children:[T.jsxs("div",{className:"d-flex flex-wrap gap-2",children:[R.map((_e,Ce)=>T.jsxs("div",{className:"position-relative",style:{width:d?"120px":"100%"},children:[T.jsx("img",{src:_e,alt:i("upload.preview","Aperu {{number}}",{number:Ce+1}),className:"img-fluid rounded",style:{height:d?"120px":"200px",width:d?"120px":"100%",objectFit:"cover"}}),T.jsx(Qn,{variant:"outline-danger",size:"sm",className:"position-absolute top-0 end-0 m-1",onClick:()=>xe(Ce),disabled:N,children:T.jsx(KO,{size:12})})]},Ce)),d&&R.length<y&&!N&&T.jsx("label",{className:"d-flex justify-content-center align-items-center rounded border border-dashed",style:{width:"120px",height:"120px",cursor:"pointer"},htmlFor:"file-upload",children:T.jsx(xR,{size:24})})]}),d&&T.jsx("small",{className:"text-muted d-block mt-2",children:i("upload.imageCount","{{current}} sur {{max}} images",{current:R.length,max:y})})]}):T.jsxs("div",{className:"text-center p-4 bg-light rounded mb-3",style:{cursor:"pointer"},onClick:()=>document.getElementById("file-upload").click(),children:[T.jsx(xR,{size:24,className:"mb-2"}),T.jsx("p",{className:"mb-0",children:i("upload.clickToAdd","Cliquez pour {{action}}",{action:d?i("upload.addPhotos","ajouter des photos"):i("upload.addPhoto","ajouter une photo")})}),T.jsxs("small",{className:"text-muted d-block mt-2",children:[i("upload.acceptedFormats","Formats accepts: {{formats}}",{formats:c.map(_e=>_e.split("/")[1]).join(", ")}),T.jsx("br",{}),i("upload.maxSize","Taille max: {{size}} Mo",{size:o})," ",d&&i("upload.maxImages","({{max}} images maximum)",{max:y})]})]}),N&&T.jsxs("div",{className:"mt-2",children:[T.jsxs("div",{className:"d-flex align-items-center",children:[T.jsx(xu,{animation:"border",size:"sm",className:"me-2"}),T.jsx("span",{children:i("upload.uploading","Tlchargement en cours... {{progress}}%",{progress:Z})})]}),T.jsx("div",{className:"progress mt-1",style:{height:"5px"},children:T.jsx("div",{className:"progress-bar",role:"progressbar",style:{width:`${Z}%`},"aria-valuenow":Z,"aria-valuemin":"0","aria-valuemax":"100"})})]}),K&&T.jsx(mi,{variant:"danger",className:"mt-2 p-2 small",dismissible:!0,onClose:fe,children:T.jsxs("div",{className:"d-flex align-items-center",children:[T.jsx(qO,{className:"me-2"}),K]})}),T.jsx(ot.Control,{id:"file-upload",type:"file",accept:c.join(","),onChange:he,className:"d-none",disabled:N||d&&R.length>=y,multiple:d})]})};function Zy(e,n,o){var c,d;e(`Erreur ${n} : `+(((d=(c=o==null?void 0:o.response)==null?void 0:c.data)==null?void 0:d.message)||(o==null?void 0:o.message)||"Erreur inconnue"),"error")}function IJ(e,n){return{catId:e.catId,name:e.name,breed:n(e.breed,""),color:n(e.color,""),dateOfBirth:e.dateOfBirth,imageCatData:e.imageCatData,gender:e.gender,chipNumber:e.chipNumber,furType:n(e.furType,""),eyeColor:n(e.eyeColor,"")}}function v3(e){return e===""||e===void 0||e===null?null:e===!0||e==="true"?!0:e===!1||e==="false"?!1:null}function x3(e,n,o){return{catId:e.catId||n.catId,name:e.name||n.name,color:o(e.color,n.color),eyeColor:o(e.eyeColor,n.eyeColor),breed:o(e.breed,n.breed),dateOfBirth:e.dateOfBirth||n.dateOfBirth,imageCatData:e.imageCatData||n.imageCatData,gender:e.gender||n.gender,chipNumber:e.chipNumber||n.chipNumber,furType:o(e.furType,n.furType),imageUrls:e.imageUrls||n.imageUrls,comment:e.hasOwnProperty("comment")?e.comment:n.comment,vaccinated:e.hasOwnProperty("vaccinated")?v3(e.vaccinated):n.vaccinated,sterilized:e.hasOwnProperty("sterilized")?v3(e.sterilized):n.sterilized}}const RF=V.createContext(),PJ=({children:e})=>{const n=ml(),{isLoggedIn:o}=Ih(),[c,d]=V.useState([]),[y,x]=V.useState([]),[i,I]=V.useState(!0),{showNotification:R}=gC(),[k,N]=V.useState(null),U=V.useRef(!1),K=V.useCallback(async()=>{var _e,Ce;try{const je=await n.get("users/me");je&&je.address&&N({address:je.address.address||"",city:je.address.city||"",postalCode:je.address.postalCode||"",latitude:je.address.latitude||null,longitude:je.address.longitude||null})}catch(je){R("Erreur lors de la rcupration de l'adresse utilisateur : "+(((Ce=(_e=je==null?void 0:je.response)==null?void 0:_e.data)==null?void 0:Ce.message)||(je==null?void 0:je.message)||"Erreur inconnue"),"error")}},[n]),X=V.useCallback(async()=>{try{if(!o)return;I(!0);try{const _e=await n.get("cat/reportedCats");d(_e||[])}catch{d([])}try{const _e=await n.get("cat/ownedCats");x(_e||[])}catch{x([])}await K(),I(!1),U.current=!0}catch(_e){Zy(R,"lors de la rcupration des chats",_e),I(!1)}},[n,o,K]);V.useEffect(()=>{o&&sessionStorage.getItem("token")?X():(d([]),x([]),U.current=!1)},[o,X]);const Z=async _e=>{var Ce,je;try{const He=c.find(_t=>_t.catStatusId===_e);if(!He)throw new Error("Chat signal introuvable");const lt=He.cat.catId;return await n.delete(`/cat/delete?id=${lt}`),d(_t=>_t.filter(Ue=>Ue.cat.catId!==lt)),R("Le chat a t supprim avec succs !","success"),!0}catch(He){return R("Erreur lors de la suppression du chat signal : "+(((je=(Ce=He==null?void 0:He.response)==null?void 0:Ce.data)==null?void 0:je.message)||(He==null?void 0:He.message)||"Erreur inconnue"),"error"),!1}},J=async(_e,Ce)=>{var je,He,lt,_t,Ue,Ge,at,yt,tt,Rt;try{const ct=c.find(cr=>cr.catStatusId===_e);if(!ct)throw new Error("Chat non trouv");const ze=x3(Ce,ct.cat,Wa),Ye=Ce.statusCat||ct.statusCat,At=Ye==="OWN"&&ct.statusCat!=="OWN";let Ct;At&&k?Ct={...k}:Ct={latitude:((je=Ce.location)==null?void 0:je.latitude)||((He=ct.location)==null?void 0:He.latitude),longitude:((lt=Ce.location)==null?void 0:lt.longitude)||((_t=ct.location)==null?void 0:_t.longitude),address:((Ue=Ce.location)==null?void 0:Ue.address)||((Ge=ct.location)==null?void 0:Ge.address),city:((at=Ce.location)==null?void 0:at.city)||((yt=ct.location)==null?void 0:yt.city),postalCode:((tt=Ce.location)==null?void 0:tt.postalCode)||((Rt=ct.location)==null?void 0:Rt.postalCode)};const st=p2(new Date().toISOString()),Bt={catStatusId:_e,statusCat:Ye,reportDate:st,location:Ct,cat:{catId:ct.cat.catId}},hn=Ce.statusCat&&Ce.statusCat!==ct.statusCat;await n.put("/cat/update",ze);let cn=null;if(hn&&(cn=await n.put("/cat/updateStatus",Bt)),At){d(Nn=>Nn.filter(Vn=>Vn.catStatusId!==_e));const cr={catStatusId:cn&&cn.catStatusId||_e,statusCat:"OWN",reportDate:st,location:Ct,cat:ze};x(Nn=>[...Nn,cr])}else d(cr=>cr.map(Nn=>Nn.catStatusId===_e?{...Nn,statusCat:Ye,reportDate:st,location:Ct,cat:ze}:Nn));return R("Le chat a t mis  jour avec succs !","success"),!0}catch(ct){return Zy(R,"lors de la mise  jour du chat signal",ct),!1}},le=async(_e,Ce)=>{var je,He,lt,_t,Ue;try{const Ge=y.find(ze=>ze.cat.catId===_e);if(!Ge)throw new Error("Chat non trouv");const at=x3(Ce,Ge.cat,Wa),tt=p2(new Date().toISOString()),Rt=Ce.statusCat&&Ce.statusCat!==Ge.statusCat,ct={catStatusId:Ge.catStatusId,statusCat:Ce.statusCat||Ge.statusCat,reportDate:tt,location:{latitude:(k==null?void 0:k.latitude)||((je=Ge.location)==null?void 0:je.latitude),longitude:(k==null?void 0:k.longitude)||((He=Ge.location)==null?void 0:He.longitude),address:(k==null?void 0:k.address)||((lt=Ge.location)==null?void 0:lt.address),city:(k==null?void 0:k.city)||((_t=Ge.location)==null?void 0:_t.city),postalCode:(k==null?void 0:k.postalCode)||((Ue=Ge.location)==null?void 0:Ue.postalCode)},cat:{catId:_e}};return await n.put("/cat/update",at),Rt&&await n.put("/cat/updateStatus",ct),x(ze=>ze.map(Ye=>Ye.cat.catId===_e?{...Ye,statusCat:Ce.statusCat||Ye.statusCat,reportDate:tt,cat:at}:Ye)),!0}catch(Ge){return Zy(R,"lors de la mise  jour du chat possd",Ge),!1}},de=async _e=>{try{return await n.delete(`/cat/delete?id=${_e}`),x(Ce=>Ce.filter(je=>je.cat.catId!==_e)),R("Le chat a t supprim avec succs !","success"),!0}catch(Ce){return Zy(R,"lors de la suppression du chat possd",Ce),!1}},ue=async(_e,Ce)=>{var je,He;try{const lt=y.find(Rt=>Rt.cat.catId===_e);if(!lt)throw new Error("Chat non trouv");const Ue=p2(new Date().toISOString());if(!Ce.location||!Ce.location.latitude||!Ce.location.longitude)throw new Error("Veuillez slectionner une localisation prcise o le chat a t perdu.");const Ge={latitude:Ce.location.latitude,longitude:Ce.location.longitude,address:Ce.location.address,city:Ce.location.city,postalCode:Ce.location.postalCode},at={cat:IJ(lt.cat,Wa),comment:Ce.comment||"Chat perdu",statusCat:"LOST",reportDate:Ue,location:Ge},yt=await n.post("/cat/register",at);x(Rt=>Rt.filter(ct=>ct.cat.catId!==_e));const tt={catStatusId:yt.catStatusId,statusCat:"LOST",comment:Ce.comment||"Chat perdu",reportDate:Ue,location:Ge,cat:lt.cat};return d(Rt=>[...Rt,tt]),R("Votre chat a t dclar comme perdu avec succs !","success"),!0}catch(lt){return R("Erreur lors de la rcupration de l'adresse utilisateur : "+(((He=(je=lt==null?void 0:lt.response)==null?void 0:je.data)==null?void 0:He.message)||(lt==null?void 0:lt.message)||"Erreur inconnue"),"error"),!1}},pe=async _e=>{var Ce,je;try{return await n.get(`/cat/potentialFoundCats/${_e}`)}catch(He){return R("Erreur lors de la rcupration de l'adresse utilisateur : "+(((je=(Ce=He==null?void 0:He.response)==null?void 0:Ce.data)==null?void 0:je.message)||(He==null?void 0:He.message)||"Erreur inconnue"),"error"),[]}},he=async _e=>{try{return await n.get(`cat/${_e}/location-history`)}catch(Ce){return Zy(R,"lors de la rcupration de l'historique des localisations",Ce),[]}},xe=async _e=>{var Ce,je;try{return await n.get(`/cat/potentialLostCats/${_e}`)}catch(He){return R("Erreur lors de la rcupration de l'adresse utilisateur : "+(((je=(Ce=He==null?void 0:He.response)==null?void 0:Ce.data)==null?void 0:je.message)||(He==null?void 0:He.message)||"Erreur inconnue"),"error"),[]}},fe=async _e=>{try{const Ce=y.map(async He=>{const lt={...He.cat,location:{address:_e.address,city:_e.city,postalCode:_e.postalCode,latitude:_e.latitude,longitude:_e.longitude}};return await n.put("/cat/update",lt),{...He,location:lt.location,cat:{...He.cat,location:lt.location}}}),je=await Promise.all(Ce);return x(je),R("L'adresse de tous vos chats a t mise  jour !","success"),!0}catch{return!1}};return T.jsx(RF.Provider,{value:{reportedCats:c,ownedCats:y,loading:i,userAddress:k,handleDeleteReportedCat:Z,handleEditReportedCat:J,handleEditOwnedCat:le,handleDeleteOwnedCat:de,handleReportCatAsLost:ue,findPotentialFoundCats:pe,findPotentialLostCats:xe,fetchCats:X,fetchUserAddress:K,updateAllOwnedCatsAddress:fe,getCatLocationHistory:he},children:e})},W_=()=>{const e=V.useContext(RF);if(!e)throw new Error("useCatsContext must be used within a CatsProvider");return e},AJ=()=>{const{formatValue:e,refreshCatLists:n}=kf(),o=ml(),{fetchCats:c,userAddress:d}=W_(),{getCurrentPosition:y,isLocating:x,geoError:i,setGeoError:I}=V1(),{t:R}=Rs(),k=Cu(),N=new Date,U=N.getFullYear()+"-"+String(N.getMonth()+1).padStart(2,"0")+"-"+String(N.getDate()).padStart(2,"0")+" "+String(N.getHours()).padStart(2,"0")+":"+String(N.getMinutes()).padStart(2,"0")+":"+String(N.getSeconds()).padStart(2,"0")+"."+String(N.getMilliseconds()).padStart(3,"0"),K=N.toISOString().split("T")[0],[X,Z]=V.useState({name:R("cat.defaultName","Mittens"),breed:"SIAMESE",color:"BLANC",dateOfBirth:"",imageUrls:[],gender:"FEMALE",chipNumber:"123456789",furType:"COURTE",eyeColor:"BLEU",comment:R("cat.defaultComment","Chat trs amical et joueur."),vaccinated:!1,sterilized:!1,statusCat:"LOST",reportDate:K,location:{latitude:"",longitude:"",address:"",city:"",postalCode:""}}),[J,le]=V.useState({dateOfBirth:"",reportDate:"",dateComparison:""}),[de,ue]=V.useState(!1),[pe,he]=V.useState(!1),[xe,fe]=V.useState(Date.now());V.useEffect(()=>{d&&Z(Ue=>({...Ue,location:{latitude:d.latitude||"",longitude:d.longitude||"",address:d.address||"",city:d.city||"",postalCode:d.postalCode||""}}))},[d]);const _e=async(Ue,Ge)=>{try{const at=await U_(Ue,Ge);Z(yt=>({...yt,location:{...yt.location,longitude:Ue,latitude:Ge,address:(at==null?void 0:at.address)||"",city:(at==null?void 0:at.city)||"",postalCode:(at==null?void 0:at.postalCode)||""}}))}catch(at){console.error("Erreur lors de la gocodification inverse:",at)}};return{formData:X,validationErrors:J,showSuccessMessage:de,isUploading:pe,uploaderKey:xe,isLocating:x,geoError:i,todayForInput:K,handleChange:Ue=>{const{name:Ge,value:at}=Ue.target,yt={...J},tt={...X,[Ge]:at};if(Ge==="dateOfBirth")if(at){const Rt=new Date(at),ct=new Date;if(ct.setHours(0,0,0,0),Rt>ct?yt.dateOfBirth=R("cat.errorFutureBirthDate","La date de naissance ne peut pas tre dans le futur"):yt.dateOfBirth="",tt.reportDate){const ze=new Date(tt.reportDate);Rt>ze?yt.dateComparison=R("cat.errorDateComparison","La date de signalement ne peut pas tre antrieure  la date de naissance"):yt.dateComparison=""}}else yt.dateOfBirth="",yt.dateComparison="";if(Ge==="reportDate")if(at){const Rt=new Date(at),ct=new Date;ct.setHours(0,0,0,0),Rt>ct?yt.reportDate=R("cat.errorFutureReportDate","La date de signalement ne peut pas tre dans le futur"):yt.reportDate="",tt.dateOfBirth&&(new Date(tt.dateOfBirth)>Rt?yt.dateComparison=R("cat.errorDateComparison","La date de signalement ne peut pas tre antrieure  la date de naissance"):yt.dateComparison="")}else yt.reportDate="";le(yt),Z(Rt=>({...Rt,[Ge]:at}))},handleSelectChange:(Ue,Ge)=>{Z(at=>({...at,[Ge.name]:Ue?Ue.value:""}))},handleImageUploaded:Ue=>{Array.isArray(Ue)?Z(Ge=>({...Ge,imageUrls:Ue})):Z(Ge=>({...Ge,imageUrls:Ue?[Ue]:[]}))},handleSubmit:async Ue=>{if(Ue.preventDefault(),J.dateOfBirth||J.reportDate||J.dateComparison)return;const Ge=X.name.trim()===""?R("cat.unknown","Inconnu"):X.name;Z(ct=>({...ct,name:Ge}));const at={latitude:X.location.latitude,longitude:X.location.longitude,address:X.location.address,city:X.location.city,postalCode:X.location.postalCode},yt=X.dateOfBirth?new Date(X.dateOfBirth).toISOString().split("T")[0]:null,tt={cat:{name:Ge,breed:Wa(X.breed,"UNKNOWN"),color:Wa(X.color,"AUTRE"),dateOfBirth:yt,imageUrls:X.imageUrls,gender:X.gender,chipNumber:X.chipNumber,furType:Wa(X.furType,"COURTE"),eyeColor:Wa(X.eyeColor,"AUTRE"),vaccinated:X.vaccinated,sterilized:X.sterilized,comment:X.comment},statusCat:Wa(X.statusCat,""),reportDate:U,comment:X.comment,location:at},Rt=new FormData;Rt.append("catData",new Blob([JSON.stringify(tt)],{type:"application/json"}));try{he(!0),await o.post("/cat/register",Rt,{headers:{"Content-Type":"multipart/form-data"}})&&(ue(!0),fe(Date.now()),await c(),await n(),k("/profile"))}catch(ct){console.error("Erreur lors de l'enregistrement du chat:",ct)}finally{he(!1)}},handleRequestCurrentLocation:()=>{y().then(Ue=>{_e(Ue.longitude,Ue.latitude)}).catch(()=>{I(R("cat.geoError","Impossible d'obtenir votre position actuelle"))})},updateLocationFromCoordinates:_e,setGeoError:I,setIsUploading:he,setFormData:Z}};function RJ(){const{formatValue:e}=kf(),{enums:n,loading:o,error:c}=$_(),{t:d}=Rs(),{formData:y,validationErrors:x,showSuccessMessage:i,isUploading:I,uploaderKey:R,isLocating:k,geoError:N,todayForInput:U,handleChange:K,handleSelectChange:X,handleImageUploaded:Z,handleSubmit:J,handleRequestCurrentLocation:le,updateLocationFromCoordinates:de,setGeoError:ue,setIsUploading:pe,setFormData:he}=AJ();return T.jsx(Ro,{className:"py-4",children:T.jsx(Za.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:T.jsxs(yn,{className:"shadow-sm",children:[T.jsxs(yn.Header,{style:{backgroundColor:"var(--primary-color)"},className:"text-white text-center py-3",children:[T.jsx(hl,{className:"me-2",size:24}),T.jsx("h2",{className:"mb-0",children:d("cat.register","Signaler un chat")})]}),T.jsxs(yn.Body,{className:"p-4",children:[i&&T.jsx(mi,{variant:"success",className:"mb-4",dismissible:!0,onClose:()=>setShowSuccessMessage(!1),children:d("cat.registerSuccess","Le chat a t enregistr avec succs !")}),T.jsxs(ot,{onSubmit:J,children:[T.jsxs(vi,{children:[T.jsxs(Un,{md:6,children:[T.jsxs(yn,{className:"mb-4",children:[T.jsx(yn.Header,{className:"bg-light",children:T.jsx("h5",{className:"mb-0",children:d("cat.mainInfo","Informations principales")})}),T.jsxs(yn.Body,{children:[T.jsxs(ot.Group,{className:"mb-3",children:[T.jsxs(ot.Label,{children:[d("cat.status","Statut"),"*"]}),T.jsxs(ot.Select,{name:"statusCat",value:y.statusCat,onChange:K,required:!0,disabled:o||c,children:[T.jsx("option",{value:"",children:d("cat.selectStatus","-- Slectionnez le statut --")}),n&&n.statusCat.map(xe=>T.jsx("option",{value:xe.value,children:xe.label},xe.value))]}),c&&T.jsx("div",{className:"text-danger",children:"Erreur lors du chargement des statuts"})]}),T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:d("cat.name","Nom du chat")}),T.jsx(ot.Control,{type:"text",name:"name",value:y.name,onChange:K,placeholder:d("cat.enterName","Entrez le nom")})]}),T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:d("cat.breed","Race")}),T.jsx(A0,{name:"breed",value:y.breed?n&&n.breed.find(xe=>xe.value===y.breed):null,onChange:xe=>X(xe,{name:"breed"}),options:n?n.breed:[],placeholder:d("cat.selectBreed","Slectionnez la race"),isClearable:!0,className:"basic-select",classNamePrefix:"select",isDisabled:o||c,menuPlacement:"auto",menuPortalTarget:document.body,styles:{menuPortal:xe=>({...xe,zIndex:9999})}}),c&&T.jsx("div",{className:"text-danger",children:"Erreur lors du chargement des races"})]}),T.jsxs(ot.Group,{className:"mb-3",children:[T.jsxs(ot.Label,{children:[d("cat.gender","Genre"),"*"]}),T.jsxs(ot.Select,{name:"gender",value:y.gender,onChange:K,required:!0,disabled:o||c,children:[T.jsx("option",{value:"",children:d("cat.selectGender","-- Slectionnez le genre --")}),n&&n.catGender.map(xe=>T.jsx("option",{value:xe.value,children:xe.label},xe.value))]}),c&&T.jsx("div",{className:"text-danger",children:"Erreur lors du chargement des genres"})]})]})]}),T.jsxs(yn,{children:[T.jsx(yn.Header,{className:"bg-light",children:T.jsx("h5",{className:"mb-0",children:d("cat.dates","Dates")})}),T.jsxs(yn.Body,{children:[x.dateComparison&&T.jsx(mi,{variant:"danger",className:"mb-3",children:x.dateComparison}),T.jsxs(vi,{children:[T.jsx(Un,{sm:6,children:T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:d("cat.birthDate","Date de naissance")}),T.jsx(ot.Control,{type:"date",name:"dateOfBirth",value:y.dateOfBirth,onChange:K,max:U,isInvalid:!!x.dateOfBirth,placeholder:d("cat.selectBirthDate","Slectionnez la date de naissance")}),x.dateOfBirth&&T.jsx(ot.Control.Feedback,{type:"invalid",children:x.dateOfBirth}),T.jsx(ot.Text,{className:"text-muted",children:d("cat.birthDateHelp","Format: JJ/MM/AAAA")})]})}),T.jsx(Un,{sm:6,children:T.jsxs(ot.Group,{className:"mb-3",children:[T.jsxs(ot.Label,{children:[d("cat.reportDate","Date de signalement"),"*"]}),T.jsx(ot.Control,{type:"date",name:"reportDate",value:y.reportDate,onChange:K,max:U,isInvalid:!!x.reportDate,required:!0}),x.reportDate&&T.jsx(ot.Control.Feedback,{type:"invalid",children:x.reportDate})]})})]})]})]})]}),T.jsxs(Un,{md:6,children:[T.jsxs(yn,{className:"mb-4",children:[T.jsx(yn.Header,{className:"bg-light",children:T.jsx("h5",{className:"mb-0",children:d("cat.characteristics","Caractristiques")})}),T.jsxs(yn.Body,{children:[T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:d("cat.color","Couleur")}),T.jsxs(ot.Select,{name:"color",value:y.color,onChange:K,required:!0,disabled:o||c,children:[T.jsx("option",{value:"",children:d("cat.selectColor","-- Slectionnez la couleur --")}),n&&n.catColor.map(xe=>T.jsx("option",{value:xe.value,children:xe.label},xe.value))]}),c&&T.jsx("div",{className:"text-danger",children:"Erreur lors du chargement des couleurs"})]}),T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:d("cat.eyeColor","Couleur des yeux")}),T.jsxs(ot.Select,{name:"eyeColor",value:y.eyeColor,onChange:K,required:!0,disabled:o||c,children:[T.jsx("option",{value:"",children:d("cat.selectEyeColor","-- Slectionnez la couleur des yeux --")}),n&&n.eyeColor.map(xe=>T.jsx("option",{value:xe.value,children:xe.label},xe.value))]}),c&&T.jsx("div",{className:"text-danger",children:"Erreur lors du chargement des couleurs d'yeux"})]}),T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:d("cat.furType","Type de fourrure")}),T.jsxs(ot.Select,{name:"furType",value:y.furType,onChange:K,disabled:o||c,children:[T.jsx("option",{value:"",children:d("cat.selectFurType","-- Slectionnez le type de fourrure --")}),n&&n.furType.map(xe=>T.jsx("option",{value:xe.value,children:xe.label},xe.value))]}),c&&T.jsx("div",{className:"text-danger",children:"Erreur lors du chargement des types de fourrure"})]}),T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:d("cat.chipNumber","Numro de puce")}),T.jsx(ot.Control,{type:"text",name:"chipNumber",value:y.chipNumber,onChange:K,placeholder:d("cat.enterChipNumber","Entrez le numro de puce")})]}),T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:d("cat.vaccinated","Vaccin")}),T.jsxs(ot.Select,{name:"vaccinated",value:y.vaccinated===null?"":y.vaccinated?"true":"false",onChange:xe=>K({target:{name:"vaccinated",value:xe.target.value===""?null:xe.target.value==="true"}}),children:[T.jsx("option",{value:"",children:d("cat.notSpecified","Non spcifi")}),T.jsx("option",{value:"true",children:d("cat.yes","Oui")}),T.jsx("option",{value:"false",children:d("cat.no","Non")})]})]}),T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:d("cat.sterilized","Strilis")}),T.jsxs(ot.Select,{name:"sterilized",value:y.sterilized===null?"":y.sterilized?"true":"false",onChange:xe=>K({target:{name:"sterilized",value:xe.target.value===""?null:xe.target.value==="true"}}),children:[T.jsx("option",{value:"",children:d("cat.notSpecified","Non spcifi")}),T.jsx("option",{value:"true",children:d("cat.yes","Oui")}),T.jsx("option",{value:"false",children:d("cat.no","Non")})]})]})]})]}),T.jsxs(yn,{className:"mb-4",children:[T.jsx(yn.Header,{className:"bg-light",children:T.jsx("h5",{className:"mb-0",children:d("cat.image","Image")})}),T.jsxs(yn.Body,{children:[T.jsx("p",{className:"text-muted",children:d("cat.imageHint","Ajoutez une photo du chat pour faciliter son identification.")}),T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(dT,{onImageUploaded:Z,initialImage:y.imageUrls,onUploadStatusChange:pe},R),I&&T.jsx("div",{className:"mt-2 text-info",children:T.jsxs("small",{children:[T.jsx("i",{className:"fas fa-spinner fa-spin me-1"}),d("cat.uploadingImages","Images en cours de chargement... Veuillez patienter avant d'enregistrer.")]})})]}),T.jsxs(ot.Group,{children:[T.jsx(ot.Label,{children:d("cat.description","Commentaire")}),T.jsx(ot.Control,{as:"textarea",rows:3,name:"comment",value:y.comment,onChange:K,placeholder:d("cat.descriptionPlaceholder","Entrez une description du chat (signes distinctifs, comportement, etc.)")})]})]})]})]})]}),T.jsxs(yn,{className:"mb-4",children:[T.jsxs(yn.Header,{className:"bg-light d-flex align-items-center",children:[T.jsx(zc,{className:"me-2"}),T.jsx("h5",{className:"mb-0",children:d("cat.location","Localisation du chat")})]}),T.jsx(yn.Body,{children:y.statusCat==="OWN"?T.jsxs(T.Fragment,{children:[T.jsx("p",{className:"text-muted mb-2",children:d("cat.locationUserOnly","L'adresse de votre profil sera utilise comme localisation du chat.")}),T.jsxs("div",{className:"border rounded bg-light p-3",children:[T.jsxs("strong",{children:[d("cat.address","Adresse")," :"]})," ",y.location.address||"-",T.jsx("br",{}),T.jsxs("strong",{children:[d("cat.city","Ville")," :"]})," ",y.location.city||"-",T.jsx("br",{}),T.jsxs("strong",{children:[d("cat.postalCode","Code postal")," :"]})," ",y.location.postalCode||"-",T.jsx("br",{}),T.jsxs("strong",{children:[d("cat.latitude","Latitude")," :"]})," ",y.location.latitude||"-",T.jsx("br",{}),T.jsxs("strong",{children:[d("cat.longitude","Longitude")," :"]})," ",y.location.longitude||"-"]})]}):T.jsxs(T.Fragment,{children:[T.jsx("p",{className:"text-muted",children:d("cat.locationHint","Indiquez l'endroit o le chat a t vu pour la dernire fois.")}),T.jsx(vi,{children:T.jsxs(Un,{xs:12,children:[T.jsx(Xv,{location:y.location,onLocationChange:(xe,fe)=>de(xe,fe),onAddressChange:xe=>{he(fe=>({...fe,location:{...fe.location,...xe}}))},isLocating:k,geoError:N,onGeoErrorDismiss:()=>ue(null),onRequestCurrentLocation:le,mapHeight:"300px",disableMapClick:y.statusCat==="OWN"}),T.jsxs(Qn,{variant:"outline-secondary",onClick:le,className:"mt-3",children:[T.jsx(zc,{className:"me-2"}),d("cat.useCurrentLocation","Utiliser ma position actuelle")]})]})})]})})]}),T.jsxs("div",{className:"text-center mt-4",children:[T.jsxs("p",{className:"text-muted mb-4",children:["* ",d("common.required","Champs obligatoires")]}),T.jsx(Qn,{type:"submit",variant:"primary",size:"lg",className:"px-5",style:{...YC,minWidth:"200px"},disabled:I,title:I?d("cat.waitForImages","Veuillez attendre que les images soient charges"):"",children:I?T.jsxs(T.Fragment,{children:[T.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),d("cat.loadingImages","Chargement des images...")]}):d("cat.register","Signaler un chat")})]})]})]})]})})})}function MJ(e){return Di({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M7 11h2v2H7zm0 4h2v2H7zm4-4h2v2h-2zm0 4h2v2h-2zm4-4h2v2h-2zm0 4h2v2h-2z"},child:[]},{tag:"path",attr:{d:"M5 22h14c1.103 0 2-.897 2-2V6c0-1.103-.897-2-2-2h-2V2h-2v2H9V2H7v2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2zM19 8l.001 12H5V8h14z"},child:[]}]})(e)}function hT({selectedCatStatus:e,handleClose:n,show:o,hideContactInfo:c=!1}){const{formatValue:d,calculateAge:y}=kf(),{userAddress:x,reportedCats:i,ownedCats:I}=W_(),{t:R,i18n:k}=Rs(),{isLoggedIn:N}=Ih(),[U,K]=V.useState(e);if(V.useEffect(()=>{e&&K(e)},[e]),V.useEffect(()=>{if(!U)return;const xe=i.find(_e=>_e.catStatusId===U.catStatusId),fe=I.find(_e=>_e.cat.catId===U.cat.catId);xe?K(xe):fe&&K(fe)},[i,I,U]),!U||!U.cat)return null;const X=U.cat,Z=U.statusCat==="LOST",J=U.statusCat==="FOUND",le=U.statusCat==="OWN",ue=N?J&&U.user?{phone:U.user.phone||"+32 484 934 747",email:U.user.email||"contact@example.com"}:Z&&U.user?{phone:U.user.phone||"+32 484 934 747",email:U.user.email||"contact@example.com"}:{phone:"+32 484 934 747",email:"contact@example.com"}:null,pe=()=>{if(!N)return;const xe=J?R("cat.emailSubjectFound",{name:X.name||R("cat.noName","Sans nom")}," propos de votre chat trouv: {{name}}"):R("cat.emailSubjectLost",{name:X.name||R("cat.noName","Sans nom")}," propos de votre chat perdu: {{name}}"),fe=J?R("cat.emailBodyFound",`Bonjour,

J'ai vu votre annonce concernant un chat trouv et je pense qu'il pourrait s'agir du mien.

Cordialement,`):R("cat.emailBodyLost",`Bonjour,

J'ai vu votre annonce concernant un chat perdu et je pense avoir vu un chat qui lui ressemble.

Cordialement,`);window.location.href=`mailto:${ue.email}?subject=${encodeURIComponent(xe)}&body=${encodeURIComponent(fe)}`},he=xe=>xe?new Date(xe).toLocaleDateString(k.language,{day:"numeric",month:"long",year:"numeric"}):R("common.invalid","Inconnue");return T.jsxs(Wi,{show:o,onHide:n,size:"lg",centered:!0,children:[T.jsx(Wi.Header,{closeButton:!0,className:"bg-light",children:T.jsxs(Wi.Title,{className:"d-flex align-items-center",children:[T.jsx(hl,{className:"me-2",style:{color:"#8B4513"}}),J?R("cat.found","Chat trouv"):R("cat.lost","Chat perdu"),": ",X.name||R("cat.noName","Sans nom")]})}),T.jsxs(Wi.Body,{className:"p-0",children:[T.jsxs("div",{className:"position-relative",children:[T.jsx(ph,{interval:5e3,indicators:!0,prevIcon:T.jsx(S7,{className:"text-white fs-4"}),nextIcon:T.jsx(C7,{className:"text-white fs-4"}),children:(()=>{const xe=[];return X.imageUrl&&xe.push({url:X.imageUrl,alt:X.name||"Chat"}),X.imageUrls&&X.imageUrls.length>0&&X.imageUrls.forEach((fe,_e)=>{fe&&xe.push({url:fe,alt:`${X.name||"Chat"} #${_e+1}`})}),xe.length===0?T.jsx(ph.Item,{children:T.jsx("img",{src:"/noImageCat.png",alt:R("cat.noImage","Aucune donne"),className:"w-100",style:{height:"300px",objectFit:"cover"}})}):xe.map((fe,_e)=>T.jsx(ph.Item,{children:T.jsx("img",{src:fe.url,alt:fe.alt,className:"w-100",style:{height:"300px",objectFit:"cover"},onError:Ce=>{Ce.target.src="/noImageCat.png",Ce.target.onerror=null}})},_e))})()}),T.jsxs("div",{className:"position-absolute bottom-0 start-0 w-100 p-3",style:{background:"linear-gradient(transparent, rgba(0,0,0,0.7))",color:"white",zIndex:10},children:[T.jsx("h3",{className:"mb-0",children:X.name||R("cat.noName","Chat sans nom")}),T.jsxs("div",{className:"d-flex align-items-center mt-1",children:[T.jsx(ia,{bg:X.gender===R("cat.male",{defaultValue:"Mle"})?"primary":"danger",className:"me-2",children:d(X.gender)||R("cat.unknownGender","Genre inconnu")}),T.jsxs("small",{children:[R("cat.breed","Race"),":"," ",d(X.breed)||R("common.unknown","Inconnue")]})]})]})]}),T.jsxs("div",{className:"p-4",children:[T.jsxs(vi,{className:"mb-4",children:[T.jsx(Un,{md:6,children:T.jsx(yn,{className:"shadow-sm h-100",children:T.jsxs(yn.Body,{children:[T.jsxs("h5",{className:"mb-3",children:[T.jsx(Y2,{className:"me-2",style:{color:"#8B4513"}}),R("cat.generalInfo","Informations gnrales")]}),T.jsxs(vi,{className:"g-3",children:[T.jsx(Un,{xs:12,children:T.jsxs("div",{className:"d-flex align-items-center",children:[T.jsx(WO,{className:"me-2",style:{color:"#8B4513"}}),T.jsxs("div",{children:[T.jsx("div",{className:"text-muted small",children:R("cat.birthDate","Date de naissance")}),T.jsxs("div",{className:"fw-semibold",children:[he(X.dateOfBirth),X.dateOfBirth&&` (${R("cat.age","ge")}: ${y(X.dateOfBirth)})`]})]})]})}),T.jsx(Un,{xs:6,children:T.jsxs("div",{className:"d-flex align-items-center",children:[T.jsx("div",{className:"me-2",style:{width:"16px",height:"16px",backgroundColor:X.color||"#ccc",borderRadius:"50%"}}),T.jsxs("div",{children:[T.jsx("div",{className:"text-muted small",children:R("cat.color")}),T.jsx("div",{className:"fw-semibold",children:d(X.color)||R("common.unknown")})]})]})}),T.jsx(Un,{xs:6,children:T.jsxs("div",{className:"d-flex align-items-center",children:[T.jsx("div",{className:"me-2",style:{width:"16px",height:"16px",backgroundColor:X.eyeColor||"#ccc",borderRadius:"50%"}}),T.jsxs("div",{children:[T.jsx("div",{className:"text-muted small",children:R("cat.eyeColor")}),T.jsx("div",{className:"fw-semibold",children:d(X.eyeColor)||R("common.unknown")})]})]})}),T.jsx(Un,{xs:12,children:T.jsxs("div",{className:"d-flex align-items-center",children:[T.jsx(hl,{className:"me-2",style:{color:"#8B4513"}}),T.jsxs("div",{children:[T.jsx("div",{className:"text-muted small",children:R("cat.furType")}),T.jsx("div",{className:"fw-semibold",children:d(X.furType)||R("common.unknown")})]})]})}),T.jsx(Un,{xs:6,children:T.jsxs("div",{className:"d-flex align-items-center",children:[T.jsx(hl,{className:"me-2",style:{color:"#8B4513"}}),T.jsxs("div",{children:[T.jsx("div",{className:"text-muted small",children:"Vaccin"}),T.jsx("div",{className:"fw-semibold",children:U.cat.vaccinated===!0?"Oui":U.cat.vaccinated===!1?"Non":"Non spcifi"})]})]})}),T.jsx(Un,{xs:6,children:T.jsxs("div",{className:"d-flex align-items-center",children:[T.jsx(hl,{className:"me-2",style:{color:"#8B4513"}}),T.jsxs("div",{children:[T.jsx("div",{className:"text-muted small",children:"Strilis"}),T.jsx("div",{className:"fw-semibold",children:U.cat.sterilized===!0?"Oui":U.cat.sterilized===!1?"Non":"Non spcifi"})]})]})})]})]})})}),T.jsx(Un,{md:6,children:T.jsx(yn,{className:"shadow-sm h-100",children:T.jsxs(yn.Body,{children:[T.jsxs("h5",{className:"mb-3",children:[T.jsx(vR,{className:"me-2",style:{color:"#8B4513"}}),R("cat.status")]}),T.jsxs(vi,{className:"g-3",children:[T.jsx(Un,{xs:12,children:T.jsxs("div",{className:"d-flex align-items-center",children:[T.jsx(vR,{className:"me-2",style:{color:"#8B4513"}}),T.jsxs("div",{children:[T.jsx("div",{className:"text-muted small",children:R(J?"cat.foundOn":"cat.lostOn")}),T.jsx("div",{className:"fw-semibold",children:he(U.reportDate)})]})]})}),T.jsx(Un,{xs:12,children:T.jsxs("div",{className:"d-flex align-items-center",children:[T.jsx(zc,{className:"me-2",style:{color:"#8B4513"}}),T.jsxs("div",{children:[T.jsx("div",{className:"text-muted small",children:R("cat.location")}),T.jsx("div",{className:"fw-semibold",children:le&&x?x.address||`${x.city||""} ${x.postalCode||""}`:U.location?U.location.address||`${U.location.city||""} ${U.location.postalCode||""}`:R("cat.addressNotAvailable")})]})]})})]})]})})})]}),U.cat.comment&&T.jsx(yn,{className:"shadow-sm mb-4",children:T.jsxs(yn.Body,{children:[T.jsxs("h5",{className:"mb-3",children:[T.jsx(E7,{className:"me-2",style:{color:"#8B4513"}}),R("cat.description")]}),T.jsx("p",{className:"mb-0",children:U.cat.comment})]})}),(J||Z)&&!c&&T.jsx(yn,{className:"shadow-sm mb-4",children:T.jsxs(yn.Body,{children:[T.jsxs("h5",{className:"mb-3",children:[T.jsx(Y2,{className:"me-2",style:{color:"#8B4513"}}),R("cat.contact")]}),N?T.jsxs(T.Fragment,{children:[T.jsx("p",{className:"mb-3",children:R(J?"cat.contactFoundMessage":"cat.contactLostMessage")}),T.jsxs(vi,{className:"g-3 mb-3",children:[T.jsx(Un,{xs:12,md:6,children:T.jsxs("div",{className:"d-flex align-items-center",children:[T.jsx(O1,{className:"me-2",style:{color:"#8B4513"}}),T.jsxs("div",{children:[T.jsx("div",{className:"text-muted small",children:R("cat.phone")}),T.jsx("div",{className:"fw-semibold",children:ue.phone})]})]})}),T.jsx(Un,{xs:12,md:6,children:T.jsxs("div",{className:"d-flex align-items-center",children:[T.jsx(cg,{className:"me-2",style:{color:"#8B4513"}}),T.jsxs("div",{children:[T.jsx("div",{className:"text-muted small",children:R("cat.email")}),T.jsx("div",{className:"fw-semibold",children:ue.email})]})]})})]}),T.jsxs(Qn,{variant:"primary",className:"w-100",onClick:pe,children:[T.jsx(cg,{className:"me-2"}),R("cat.sendEmail")]})]}):T.jsxs("div",{className:"text-center",children:[T.jsx("p",{className:"mb-3",children:R("cat.loginRequired","Veuillez vous connecter pour voir les informations de contact.")}),T.jsx(Qn,{variant:"primary",onClick:()=>window.location.href="/login",children:R("common.login","Se connecter")})]})]})})]})]}),T.jsx(Wi.Footer,{className:"bg-light",children:T.jsx(Qn,{variant:"secondary",onClick:n,children:R("common.close")})})]})}/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var TS=function(e,n){return TS=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,c){o.__proto__=c}||function(o,c){for(var d in c)c.hasOwnProperty(d)&&(o[d]=c[d])},TS(e,n)};function LJ(e,n){TS(e,n);function o(){this.constructor=e}e.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}var DJ=100,kJ=100,b3=50,ES=50,IS=50;function w3(e){var n=e.className,o=e.counterClockwise,c=e.dashRatio,d=e.pathRadius,y=e.strokeWidth,x=e.style;return V.createElement("path",{className:n,style:Object.assign({},x,zJ({pathRadius:d,dashRatio:c,counterClockwise:o})),d:OJ({pathRadius:d,counterClockwise:o}),strokeWidth:y,fillOpacity:0})}function OJ(e){var n=e.pathRadius,o=e.counterClockwise,c=n,d=o?1:0;return`
      M `+ES+","+IS+`
      m 0,-`+c+`
      a `+c+","+c+" "+d+" 1 1 0,"+2*c+`
      a `+c+","+c+" "+d+" 1 1 0,-"+2*c+`
    `}function zJ(e){var n=e.counterClockwise,o=e.dashRatio,c=e.pathRadius,d=Math.PI*2*c,y=(1-o)*d;return{strokeDasharray:d+"px "+d+"px",strokeDashoffset:(n?-y:y)+"px"}}var Kg=function(e){LJ(n,e);function n(){return e!==null&&e.apply(this,arguments)||this}return n.prototype.getBackgroundPadding=function(){return this.props.background?this.props.backgroundPadding:0},n.prototype.getPathRadius=function(){return b3-this.props.strokeWidth/2-this.getBackgroundPadding()},n.prototype.getPathRatio=function(){var o=this.props,c=o.value,d=o.minValue,y=o.maxValue,x=Math.min(Math.max(c,d),y);return(x-d)/(y-d)},n.prototype.render=function(){var o=this.props,c=o.circleRatio,d=o.className,y=o.classes,x=o.counterClockwise,i=o.styles,I=o.strokeWidth,R=o.text,k=this.getPathRadius(),N=this.getPathRatio();return V.createElement("svg",{className:y.root+" "+d,style:i.root,viewBox:"0 0 "+DJ+" "+kJ,"data-test-id":"CircularProgressbar"},this.props.background?V.createElement("circle",{className:y.background,style:i.background,cx:ES,cy:IS,r:b3}):null,V.createElement(w3,{className:y.trail,counterClockwise:x,dashRatio:c,pathRadius:k,strokeWidth:I,style:i.trail}),V.createElement(w3,{className:y.path,counterClockwise:x,dashRatio:N*c,pathRadius:k,strokeWidth:I,style:i.path}),R?V.createElement("text",{className:y.text,style:i.text,x:ES,y:IS},R):null)},n.defaultProps={background:!1,backgroundPadding:0,circleRatio:1,classes:{root:"CircularProgressbar",trail:"CircularProgressbar-trail",path:"CircularProgressbar-path",text:"CircularProgressbar-text",background:"CircularProgressbar-background"},counterClockwise:!1,className:"",maxValue:100,minValue:0,strokeWidth:8,styles:{root:{},trail:{},path:{},text:{},background:{}},text:""},n}(V.Component);function Yg(e){var n=e.rotation,o=e.strokeLinecap,c=e.textColor,d=e.textSize,y=e.pathColor,x=e.pathTransition,i=e.pathTransitionDuration,I=e.trailColor,R=e.backgroundColor,k=n==null?void 0:"rotate("+n+"turn)",N=n==null?void 0:"center center";return{root:{},path:f0({stroke:y,strokeLinecap:o,transform:k,transformOrigin:N,transition:x,transitionDuration:i==null?void 0:i+"s"}),trail:f0({stroke:I,strokeLinecap:o,transform:k,transformOrigin:N}),text:f0({fill:c,fontSize:d}),background:f0({fill:R})}}function f0(e){return Object.keys(e).forEach(function(n){e[n]==null&&delete e[n]}),e}function MF({matches:e,show:n,handleClose:o,onViewDetails:c}){const{formatValue:d}=kf(),{t:y}=Rs();return T.jsxs(Wi,{show:n,onHide:o,size:"lg",centered:!0,children:[T.jsx(Wi.Header,{closeButton:!0,style:{background:"#8B4513",color:"white",borderBottom:"none"},children:T.jsxs(Wi.Title,{children:[T.jsx(hl,{className:"me-2",style:{color:"white"}}),"Correspondances potentielles"]})}),T.jsx(Wi.Body,{className:"p-4",children:e.length>0?T.jsx(vi,{xs:1,md:2,className:"g-4",children:e.map(x=>{const i=x.matchedCat.cat;return T.jsx(Un,{children:T.jsxs(yn,{className:"h-100 shadow-sm",children:[T.jsx(yn.Img,{variant:"top",src:i.imageUrls&&i.imageUrls.length>0?i.imageUrls[0]:"/noImageCat.png",alt:i.name,style:{height:"200px",objectFit:"cover"},onError:I=>{I.target.src="/noImageCat.png",I.target.onerror=null}}),T.jsxs(yn.Body,{children:[T.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[T.jsx(yn.Title,{className:"mb-0",children:i.name||"Chat sans nom"}),T.jsxs(ia,{bg:"info",className:"ms-2",children:[T.jsx(A7,{className:"me-1"}),x.matchScore,"%"]})]}),T.jsxs(vi,{className:"text-center mb-3",children:[T.jsxs(Un,{sm:6,children:[T.jsx("div",{style:{width:60,height:60,margin:"auto"},children:T.jsx(Kg,{value:x.colorMatch||0,text:`${x.colorMatch||0}%`,styles:Yg({textColor:"#8B4513",pathColor:"#8B4513",trailColor:"#ddd"})})}),T.jsx("div",{className:"text-muted small mt-2",children:y("matching.color","Couleur")})]},`color-${x.matchedCat.catStatusId}`),T.jsxs(Un,{sm:6,children:[T.jsx("div",{style:{width:60,height:60,margin:"auto"},children:T.jsx(Kg,{value:x.breedMatch||0,text:`${x.breedMatch||0}%`,styles:Yg({textColor:"#8B4513",pathColor:"#8B4513",trailColor:"#ddd"})})}),T.jsx("div",{className:"text-muted small mt-2",children:y("matching.breed","Race")})]},`breed-${x.matchedCat.catStatusId}`)]}),T.jsxs(vi,{className:"text-center mb-3",children:[T.jsxs(Un,{sm:6,children:[T.jsx("div",{style:{width:60,height:60,margin:"auto"},children:T.jsx(Kg,{value:x.furTypeMatch||0,text:`${x.furTypeMatch||0}%`,styles:Yg({textColor:"#8B4513",pathColor:"#8B4513",trailColor:"#ddd"})})}),T.jsx("div",{className:"text-muted small mt-2",children:y("matching.fur","Pelage")})]},`fur-${x.matchedCat.catStatusId}`),T.jsxs(Un,{sm:6,children:[T.jsx("div",{style:{width:60,height:60,margin:"auto"},children:T.jsx(Kg,{value:x.eyeColorMatch||0,text:`${x.eyeColorMatch||0}%`,styles:Yg({textColor:"#8B4513",pathColor:"#8B4513",trailColor:"#ddd"})})}),T.jsx("div",{className:"text-muted small mt-2",children:y("matching.eyes","Yeux")})]},`eye-${x.matchedCat.catStatusId}`)]}),T.jsxs(vi,{className:"text-center mb-3",children:[T.jsxs(Un,{sm:6,children:[T.jsx("div",{style:{width:60,height:60,margin:"auto"},children:T.jsx(Kg,{value:x.distanceScore||0,text:`${x.distanceScore||0}%`,styles:Yg({textColor:"#8B4513",pathColor:"#8B4513",trailColor:"#ddd"})})}),T.jsx("div",{className:"text-muted small mt-2",children:y("matching.distance","Distance")})]},`distance-${x.matchedCat.catStatusId}`),T.jsxs(Un,{sm:6,children:[T.jsx("div",{style:{width:60,height:60,margin:"auto"},children:T.jsx(Kg,{value:Math.round(x.imageSimilarityScore*100)||0,text:`${Math.round(x.imageSimilarityScore*100)||0}%`,styles:Yg({textColor:"#8B4513",pathColor:"#8B4513",trailColor:"#ddd"})})}),T.jsx("div",{className:"text-muted small mt-2",children:y("matching.image","Image")})]},`image-${x.matchedCat.catStatusId}`)]}),T.jsxs(yn.Text,{className:"text-muted small mb-2",children:["Race: ",d(i.breed)||"Inconnue"]}),T.jsxs(yn.Text,{className:"text-muted small mb-2",children:["Trouv le:"," ",new Date(x.matchedCat.reportDate).toLocaleDateString()]}),T.jsx("div",{className:"d-flex justify-content-end",children:T.jsx(Qn,{variant:"outline-primary",size:"sm",onClick:()=>c(x.matchedCat),className:"rounded-pill",children:"Voir les dtails"})})]})]})},x.matchedCat.catStatusId)})}):T.jsxs("div",{className:"text-center py-4",children:[T.jsx("h5",{children:"Aucune correspondance trouve"}),T.jsx("p",{className:"text-muted",children:"Nous n'avons pas trouv de chats correspondant aux critres de recherche."})]})})]})}const FJ=({type:e="lost"})=>{const{t:n}=Rs(),{enums:o}=$_(),{filters:c,handleFilterChange:d,useCurrentLocation:y,clearCurrentLocation:x,resetFilters:i,formatValue:I}=kf(),R=[{value:"",label:n("filters.allColors","Toutes les couleurs")},...((o==null?void 0:o.catColor)||[]).map(U=>({value:U.value,label:U.label}))],k=[{value:"",label:n("filters.allEyeColors","Toutes les couleurs d'yeux")},...((o==null?void 0:o.eyeColor)||[]).map(U=>({value:U.value,label:U.label}))],N=[{value:"",label:n("filters.allBreeds","Toutes les races")},...((o==null?void 0:o.breed)||[]).map(U=>({value:U.value,label:U.label}))];return T.jsx(yn,{className:"mb-4 shadow-sm",children:T.jsxs(yn.Body,{children:[T.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[T.jsx("h5",{className:"mb-0",children:n("filters.title","Filtres")}),T.jsx(Qn,{variant:"outline-secondary",size:"sm",onClick:i,children:n("filters.reset","Rinitialiser")})]}),T.jsxs(vi,{children:[T.jsx(Un,{md:4,className:"mb-3",children:T.jsxs(ot.Group,{children:[T.jsx(ot.Label,{children:n("filters.breed","Race")}),T.jsx(A0,{options:N,value:N.find(U=>U.value===c.breed)||N[0],onChange:U=>d("breed",U.value),isSearchable:!0,placeholder:n("filters.selectBreed","Toutes les races"),className:"mb-3"})]})}),T.jsx(Un,{md:4,className:"mb-3",children:T.jsxs(ot.Group,{children:[T.jsx(ot.Label,{children:n("filters.color","Couleur")}),T.jsx(A0,{options:R,value:R.find(U=>U.value===c.color)||R[0],onChange:U=>d("color",U.value),isSearchable:!0,placeholder:n("filters.selectColor","Toutes les couleurs"),className:"mb-3"})]})}),T.jsx(Un,{md:4,className:"mb-3",children:T.jsxs(ot.Group,{children:[T.jsx(ot.Label,{children:n("filters.eyeColor","Couleur des yeux")}),T.jsx(A0,{options:k,value:k.find(U=>U.value===c.eyeColor)||k[0],onChange:U=>d("eyeColor",U.value),isSearchable:!0,placeholder:n("filters.selectEyeColor","Toutes les couleurs d'yeux"),className:"mb-3"})]})})]}),T.jsxs(vi,{children:[T.jsx(Un,{md:6,className:"mb-3",children:T.jsxs(ot.Group,{children:[T.jsx(ot.Label,{children:n("filters.postalCode","Code postal")}),T.jsxs(V2,{children:[T.jsx(ot.Control,{type:"text",placeholder:n("filters.enterPostalCode","Entrez un code postal"),value:c.postalCode,onChange:U=>d("postalCode",U.target.value),disabled:c.location.latitude&&c.location.longitude}),c.postalCode&&T.jsx(Qn,{variant:"outline-secondary",onClick:()=>d("postalCode",""),children:T.jsx(U0,{})})]})]})}),T.jsx(Un,{md:6,className:"mb-3",children:T.jsxs(ot.Group,{children:[T.jsx(ot.Label,{children:n("filters.currentLocation","Position actuelle")}),T.jsxs("div",{className:"d-flex",children:[T.jsxs(Qn,{variant:c.location.latitude?"success":"outline-primary",onClick:y,disabled:c.postalCode!=="",className:"flex-grow-1 me-2",children:[T.jsx(zc,{className:"me-2"}),c.location.latitude?n("filters.locationUsed","Position utilise"):n("filters.useLocation","Utiliser ma position")]}),c.location.latitude&&T.jsx(Qn,{variant:"outline-danger",onClick:x,children:T.jsx(U0,{})})]}),c.location.address&&T.jsxs("small",{className:"text-muted d-block mt-1",children:[c.location.address,", ",c.location.postalCode," ",c.location.city]})]})})]}),(c.location.latitude||c.postalCode)&&T.jsx(vi,{children:T.jsx(Un,{md:12,children:T.jsxs(ot.Group,{children:[T.jsxs(ot.Label,{children:[n("filters.searchRadius","Rayon de recherche"),":"," ",c.location.radius," km"]}),T.jsx(ot.Range,{min:1,max:100,value:c.location.radius,onChange:U=>d("radius",parseInt(U.target.value))})]})})})]})})},LF=({type:e,title:n,loadingText:o,noResultsTitle:c,noResultsText:d,resetFiltersText:y,moreInfoText:x,searchingText:i,searchMatchesText:I,matchCountText:R})=>{const{t:k}=Rs(),{filteredFoundCats:N,filteredLostCats:U,loadingFound:K,loadingLost:X,filters:Z,matchCounts:J,loadingMatches:le,fetchFoundCats:de,fetchLostCats:ue,handleFilterChange:pe,resetFilters:he,useCurrentLocation:xe,clearCurrentLocation:fe,applyFiltersToFoundCats:_e,applyFiltersToLostCats:Ce,fetchFoundMatchCounts:je,fetchLostMatchCounts:He,calculateAge:lt,formatValue:_t,findPotentialLostCats:Ue,findPotentialFoundCats:Ge}=kf(),[at,yt]=V.useState(!1),[tt,Rt]=V.useState(null),[ct,ze]=V.useState(!1),[Ye,At]=V.useState([]),[Ct,We]=V.useState(!1),[st,Bt]=V.useState(!1),hn=e==="found"?N:U,cn=e==="found"?K:X,cr=e==="found"?de:ue,Nn=e==="found"?_e:Ce,Vn=e==="found"?je:He,An=e==="found"?Ue:Ge,Zt=()=>{yt(!1),st&&Ye.length>0&&ze(!0),Bt(!1)},mn=Yr=>{Rt(Yr),yt(!0),Bt(ct),ze(!1)},kr=async Yr=>{try{const Xn=await An(Yr.catId);At(Xn),ze(!0)}catch(Xn){console.error("Erreur lors de la rcupration des correspondances:",Xn),At([]),ze(!0)}},Gr=()=>{ze(!1)};return V.useEffect(()=>{cr()},[cr]),V.useEffect(()=>{Nn()},[Z,Nn]),V.useEffect(()=>{if(hn.length>0&&!cn){const Yr=setTimeout(()=>{Vn()},500);return()=>clearTimeout(Yr)}},[cn,hn.length,Vn]),T.jsxs(Ro,{className:"py-4",children:[T.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[T.jsx("h1",{children:n}),T.jsxs(Qn,{variant:"outline-primary",onClick:()=>We(!Ct),className:"d-flex align-items-center",children:[T.jsx(P7,{className:"me-2"}),Ct?k("foundCats.hideFilters","Masquer les filtres"):k("foundCats.showFilters","Afficher les filtres")]})]}),Ct&&T.jsx(FJ,{type:e}),cn?T.jsxs("div",{className:"text-center py-5",children:[T.jsx(xu,{animation:"border",role:"status",children:T.jsx("span",{className:"visually-hidden",children:"Chargement..."})}),T.jsx("p",{className:"mt-3",children:o})]}):hn.length>0?T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"d-flex align-items-center mb-4",children:T.jsxs(ia,{bg:"info",className:"fs-5 px-3 py-2",children:[hn.length," chat",hn.length>1?"s":""," ",e==="found"?"trouv":"perdu",hn.length>1?"s":""]})}),T.jsx(vi,{xs:1,md:2,lg:3,className:"g-4",children:hn.map(Yr=>{const Xn=Yr.cat;return T.jsx(Un,{children:T.jsx(Za.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:T.jsxs(yn,{className:"h-100 shadow-sm",children:[T.jsxs("div",{className:"position-relative",children:[T.jsx(yn.Img,{variant:"top",src:Xn.imageUrls&&Xn.imageUrls.length>0?Xn.imageUrls[0]:"/noImageCat.png",alt:Xn.name,style:{height:"200px",objectFit:"cover"},onError:Lr=>{Lr.target.src="/noImageCat.png",Lr.target.onerror=null}}),T.jsxs(ia,{bg:"dark",className:"position-absolute top-0 end-0 m-2",style:{opacity:.8},children:[Xn.imageUrls?Xn.imageUrls.length:0," photo",Xn.imageUrls&&Xn.imageUrls.length>1?"s":""]})]}),T.jsxs(yn.Body,{className:"d-flex flex-column",children:[T.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[T.jsx(yn.Title,{className:"mb-0",children:Xn.name||"Chat sans nom"}),T.jsx(ia,{bg:Xn.gender==="Femelle"?"danger":Xn.gender==="Mle"?"primary":"secondary",children:_t(Xn.gender)})]}),T.jsxs("div",{className:"mb-3",children:[T.jsxs("div",{className:"d-flex flex-wrap gap-1 mb-2",children:[T.jsx(ia,{bg:"light",text:"dark",children:_t(Xn.breed)}),T.jsx(ia,{bg:"light",text:"dark",children:_t(Xn.color)}),T.jsxs(ia,{bg:"light",text:"dark",children:["Yeux ",_t(Xn.eyeColor)]})]}),T.jsxs("div",{className:"d-flex align-items-center mb-1",children:[T.jsx(MJ,{className:"me-2 text-muted",style:{fontSize:"0.8rem"}}),T.jsxs("small",{className:"text-muted",children:[k(`${e}Cats.age`,"ge"),": ",Xn.dateOfBirth?lt(Xn.dateOfBirth):k(`${e}Cats.unknown`,"Inconnu")]})]}),T.jsxs("div",{className:"d-flex align-items-center",children:[T.jsx(zc,{className:"me-2 text-muted",style:{fontSize:"0.8rem"}}),T.jsxs("small",{className:"text-muted",children:[k(`${e}Cats.${e==="found"?"foundOn":"lostOn"}`,e==="found"?"Trouv le":"Perdu le"),": ",new Date(Yr.reportDate).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"})]})]})]}),T.jsx("div",{className:"mt-auto",children:T.jsxs("div",{className:"d-grid gap-2",children:[T.jsxs(Qn,{variant:"outline-success",size:"sm",onClick:()=>mn(Yr),className:"d-flex align-items-center justify-content-center",children:[T.jsx("i",{className:"bi bi-info-circle me-1"}),x]}),T.jsx(Qn,{variant:"outline-info",size:"sm",className:"d-flex align-items-center justify-content-center",onClick:()=>kr(Xn),disabled:le[Xn.catId],children:le[Xn.catId]?T.jsxs(T.Fragment,{children:[T.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),i]}):T.jsxs(T.Fragment,{children:[T.jsx(_C,{className:"me-1"}),J[Xn.catId]?k(R,{count:J[Xn.catId],defaultValue:"{{count}} correspondance",plural:"{{count}} correspondances"}):I]})})]})})]})]})})},Yr.catStatusId)})})]}):T.jsxs("div",{className:"text-center py-5",children:[T.jsx("h3",{children:c}),T.jsx("p",{className:"text-muted",children:d}),T.jsx(Qn,{variant:"outline-success",onClick:he,children:y})]}),T.jsx(hT,{selectedCatStatus:tt,handleClose:Zt,show:at}),T.jsx(MF,{matches:Ye,show:ct,handleClose:Gr,onViewDetails:mn})]})};function NJ(){const{t:e}=Rs();return T.jsx(LF,{type:"lost",title:e("lostCats.title","Chats perdus"),loadingText:e("lostCats.loading","Chargement des chats perdus..."),noResultsTitle:e("lostCats.noResultsTitle","Aucun chat perdu ne correspond  vos critres"),noResultsText:e("lostCats.noResultsText","Essayez de modifier vos filtres ou revenez plus tard."),resetFiltersText:e("lostCats.resetFilters","Rinitialiser les filtres"),moreInfoText:e("lostCats.moreInfo","Plus d'informations"),searchingText:e("lostCats.searching","Recherche..."),searchMatchesText:e("lostCats.searchMatches","Rechercher des correspondances"),matchCountText:"lostCats.matchCount"})}function jJ(){const{t:e}=Rs();return T.jsx(LF,{type:"found",title:e("foundCats.title","Chats trouvs"),loadingText:e("foundCats.loading","Chargement des chats trouvs..."),noResultsTitle:e("foundCats.noResultsTitle","Aucun chat trouv ne correspond  vos critres"),noResultsText:e("foundCats.noResultsText","Essayez de modifier vos filtres ou revenez plus tard."),resetFiltersText:e("foundCats.resetFilters","Rinitialiser les filtres"),moreInfoText:e("foundCats.moreInfo","Plus d'informations"),searchingText:e("foundCats.searching","Recherche..."),searchMatchesText:e("foundCats.searchMatches","Rechercher des correspondances"),matchCountText:"foundCats.matchCount"})}const BJ="/assets/1-DqXb_0g1.jpg",VJ="/assets/2-DZ7UmWPo.jpg",UJ="/assets/3-CUYc14EY.jpg",$J=({noLostCatsMessage:e})=>{const{t:n}=Rs(),{formatValue:o,calculateAge:c}=kf(),d=ml(),[y,x]=V.useState([]),[i,I]=V.useState(!0),[R,k]=V.useState(null),[N,U]=V.useState({longitude:4.3517,latitude:50.8503,address:"",city:"",postalCode:""}),[K,X]=V.useState(null),{getCurrentPosition:Z,isLocating:J,geoError:le,setGeoError:de}=V1(),ue=V.useCallback(async(fe,_e)=>{try{const Ce=await U_(fe,_e);U({longitude:fe,latitude:_e,address:(Ce==null?void 0:Ce.address)||"",city:(Ce==null?void 0:Ce.city)||"",postalCode:(Ce==null?void 0:Ce.postalCode)||""})}catch(Ce){console.error("Erreur lors de la rcupration de l'adresse:",Ce),X("Erreur lors de la rcupration de l'adresse")}},[]),pe=V.useCallback((fe,_e)=>{U(Ce=>({...Ce,longitude:fe,latitude:_e}))},[]);V.useEffect(()=>{Z().then(fe=>{ue(fe.longitude,fe.latitude)}).catch(fe=>{console.log("Utilisation de la position par dfaut:",fe.message)})},[Z,ue]),V.useEffect(()=>{(async()=>{try{const _e=await d.get("/cat/findLostCat");x(_e),I(!1)}catch(_e){console.error("Erreur lors du chargement des chats perdus:",_e),k("Erreur lors du chargement des chats perdus"),I(!1)}})()},[d]);const he=y.map(fe=>{if(!fe.location||!fe.location.longitude||!fe.location.latitude)return null;const _e=fe.reportDate?new Date(fe.reportDate).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}):"Date inconnue",Ce=fe.cat.imageUrls&&fe.cat.imageUrls.length>0?fe.cat.imageUrls[0]:"/noImageCat.png";return{longitude:fe.location.longitude,latitude:fe.location.latitude,popupContent:`
        <div class="cat-popup">
          <img src="${Ce}" alt="${fe.cat.name||"Chat sans nom"}" class="cat-popup-img" onerror="this.src='/noImageCat.png'; this.onerror=null;">
          <h5 class="cat-popup-title">${fe.cat.name||"Chat sans nom"}</h5>
          <p class="cat-popup-date">Signal perdu le: ${_e}</p>
          
          <p class="cat-popup-info"><strong>Race:</strong> ${o(fe.cat.breed)||"Non spcifie"}</p>
          <p class="cat-popup-info"><strong>Genre:</strong> ${o(fe.cat.gender)||"Non spcifi"}</p>
          <p class="cat-popup-info"><strong>Couleur:</strong> ${o(fe.cat.color)||"Non spcifie"}</p>
          <p class="cat-popup-info"><strong>Couleur des yeux:</strong> ${o(fe.cat.eyeColor)||"Non spcifie"}</p>
          ${fe.cat.dateOfBirth?`<p class="cat-popup-info"><strong>ge:</strong> ${c(fe.cat.dateOfBirth)} ans</p>`:""}
          
          <a href="/lostCats" class="cat-popup-btn">Voir plus</a>
        </div>
      `}}).filter(fe=>fe!==null),xe=V.useRef(null);return i?T.jsx(yn,{className:"shadow-sm",children:T.jsxs(yn.Body,{className:"text-center py-5",children:[T.jsx(xu,{animation:"border",role:"status",variant:"primary",children:T.jsx("span",{className:"visually-hidden",children:n("map.loadingLostCats","Chargement...")})}),T.jsx("p",{className:"mt-3",children:n("map.loadingLostCats","Chargement des chats perdus...")})]})}):R?T.jsx(yn,{className:"shadow-sm",children:T.jsx(yn.Body,{className:"text-center",children:T.jsxs(mi,{variant:"success",children:[T.jsxs(mi.Heading,{className:"d-flex align-items-center justify-content-center",children:[T.jsx(Ww,{className:"me-2"}),n("map.goodNews","Bonne nouvelle !")]}),T.jsx("p",{className:"mb-0",children:n("map.noCatsLostNow","Aucun chat n'est perdu dans votre rgion pour le moment.")})]})})}):y.length===0?T.jsx(yn,{className:"shadow-sm",children:T.jsxs(yn.Body,{children:[T.jsxs(yn.Title,{children:[T.jsx(Ww,{className:"me-2"}),n("map.lostCatsTitle","Chats perdus dans votre rgion")]}),e||T.jsx(mi,{variant:"info",children:n("map.noLostCatsRegion","Aucun chat perdu n'a t signal dans votre rgion.")})]})}):T.jsxs(yn,{className:"shadow-sm",children:[T.jsx(yn.Header,{style:{backgroundColor:"var(--primary-color)"},className:"text-white",children:T.jsxs("div",{className:"d-flex align-items-center",children:[T.jsx(zc,{className:"me-2"}),T.jsx("span",{children:n("map.lostCatsMap","Carte des chats perdus")}),T.jsx(ia,{bg:"light",text:"dark",pill:!0,className:"ms-2",children:y.length})]})}),T.jsxs(yn.Body,{children:[T.jsx("div",{className:"mb-3",children:T.jsxs(Qn,{variant:"outline-primary",className:"w-100",onClick:()=>{Z().then(fe=>{xe&&xe.current&&xe.current.flyTo({center:[fe.longitude,fe.latitude],essential:!0,zoom:13})}).catch(fe=>{de(fe.message)})},disabled:J,children:[T.jsx(zc,{className:"me-2"}),J?n("map.locating","Localisation en cours..."):n("map.centerOnMyPosition","Centrer sur ma position")]})}),T.jsx(Xv,{location:N,onLocationChange:pe,onAddressChange:fe=>{U({...N,...fe})},isLocating:J,geoError:le,onGeoErrorDismiss:()=>de(null),onRequestCurrentLocation:Z,mapHeight:"500px",markers:he,showSearch:!1,fitBoundsToMarkers:!1,disableMapClick:!0,mapRef:xe}),K&&T.jsx(mi,{variant:"danger",className:"mt-3",onClose:()=>X(null),dismissible:!0,children:K}),T.jsx(mi,{style:{backgroundColor:"var(--secondary-color)"},variant:"info",className:"text-white mt-3",children:T.jsxs("div",{className:"d-flex align-items-center",children:[T.jsx(Ww,{className:"me-2"}),T.jsx("span",{children:n("map.clickMarkerDetails","Cliquez sur les marqueurs pour voir les dtails des chats perdus")})]})})]})]})},HJ=()=>{const{t:e}=Rs();return T.jsxs("div",{children:[T.jsxs(ph,{children:[T.jsxs(ph.Item,{children:[T.jsx("img",{className:"d-block w-100",src:BJ,alt:"First slide",style:{maxHeight:"630px",objectFit:"cover"}}),T.jsx(ph.Caption,{children:T.jsx("h1",{children:"Whisker Quest"})})]}),T.jsxs(ph.Item,{children:[T.jsx("img",{className:"d-block w-100",src:VJ,alt:"Second slide",style:{maxHeight:"630px",objectFit:"cover"}}),T.jsx(ph.Caption,{children:T.jsx("h1",{children:"Whisker Quest"})})]}),T.jsxs(ph.Item,{children:[T.jsx("img",{className:"d-block w-100",src:UJ,alt:"Third slide",style:{maxHeight:"630px",objectFit:"cover"}}),T.jsx(ph.Caption,{children:T.jsx("h1",{children:"Whisker Quest"})})]})]}),T.jsx(Ro,{className:"my-5",children:T.jsx($J,{noLostCatsMessage:T.jsx(mi,{variant:"success",className:"text-center",children:e("home.noLostCats","Bonne nouvelle ! Aucun chat n'est perdu dans votre rgion.")})})}),T.jsxs(Ro,{className:"mt-5",children:[T.jsx("h2",{children:e("home.valuesTitle","Nos Valeurs")}),T.jsx("p",{children:e("home.valuesIntro","Chez Whisker Quest, nous sommes guids par un ensemble de valeurs qui nous inspirent dans tout ce que nous faisons. Voici quelques-unes de nos valeurs principales :")}),T.jsxs("ul",{children:[T.jsx("li",{children:e("home.valueIntegrity","Intgrit")}),T.jsx("li",{children:e("home.valueInnovation","Innovation")}),T.jsx("li",{children:e("home.valueCommunity","Engagement envers la communaut")}),T.jsx("li",{children:e("home.valueEnvironment","Respect de l'environnement")})]}),T.jsx(Qn,{variant:"primary",href:"/app",className:"mt-3",children:e("home.discoverApp","Dcouvrir Notre Application")})]}),T.jsxs(Ro,{className:"mt-5",children:[T.jsx("h2",{children:e("home.promoTitle","Promotion de Notre Prochaine Application")}),T.jsx("p",{children:e("home.promoText","Nous sommes ravis de vous annoncer le lancement prochain de notre toute nouvelle application mobile ! Restez  l'coute pour plus d'informations sur les fonctionnalits et la date de sortie.")}),T.jsx(Qn,{variant:"success",href:"/app",className:"mt-3",children:e("home.learnMoreApp","En savoir plus sur l'Application")})]})]})};class Jv{constructor(n=0,o="Network Error"){this.status=n,this.text=o}}const GJ=()=>{if(!(typeof localStorage>"u"))return{get:e=>Promise.resolve(localStorage.getItem(e)),set:(e,n)=>Promise.resolve(localStorage.setItem(e,n)),remove:e=>Promise.resolve(localStorage.removeItem(e))}},wa={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:GJ()},fT=e=>e?typeof e=="string"?{publicKey:e}:e.toString()==="[object Object]"?e:{}:{},WJ=(e,n="https://api.emailjs.com")=>{if(!e)return;const o=fT(e);wa.publicKey=o.publicKey,wa.blockHeadless=o.blockHeadless,wa.storageProvider=o.storageProvider,wa.blockList=o.blockList,wa.limitRate=o.limitRate,wa.origin=o.origin||n},DF=async(e,n,o={})=>{const c=await fetch(wa.origin+e,{method:"POST",headers:o,body:n}),d=await c.text(),y=new Jv(c.status,d);if(c.ok)return y;throw y},kF=(e,n,o)=>{if(!e||typeof e!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!n||typeof n!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!o||typeof o!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},qJ=e=>{if(e&&e.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"},OF=e=>e.webdriver||!e.languages||e.languages.length===0,zF=()=>new Jv(451,"Unavailable For Headless Browser"),ZJ=(e,n)=>{if(!Array.isArray(e))throw"The BlockList list has to be an array";if(typeof n!="string")throw"The BlockList watchVariable has to be a string"},XJ=e=>{var n;return!((n=e.list)!=null&&n.length)||!e.watchVariable},KJ=(e,n)=>e instanceof FormData?e.get(n):e[n],FF=(e,n)=>{if(XJ(e))return!1;ZJ(e.list,e.watchVariable);const o=KJ(n,e.watchVariable);return typeof o!="string"?!1:e.list.includes(o)},NF=()=>new Jv(403,"Forbidden"),YJ=(e,n)=>{if(typeof e!="number"||e<0)throw"The LimitRate throttle has to be a positive number";if(n&&typeof n!="string")throw"The LimitRate ID has to be a non-empty string"},JJ=async(e,n,o)=>{const c=Number(await o.get(e)||0);return n-Date.now()+c},jF=async(e,n,o)=>{if(!n.throttle||!o)return!1;YJ(n.throttle,n.id);const c=n.id||e;return await JJ(c,n.throttle,o)>0?!0:(await o.set(c,Date.now().toString()),!1)},BF=()=>new Jv(429,"Too Many Requests"),QJ=async(e,n,o,c)=>{const d=fT(c),y=d.publicKey||wa.publicKey,x=d.blockHeadless||wa.blockHeadless,i=d.storageProvider||wa.storageProvider,I={...wa.blockList,...d.blockList},R={...wa.limitRate,...d.limitRate};return x&&OF(navigator)?Promise.reject(zF()):(kF(y,e,n),qJ(o),o&&FF(I,o)?Promise.reject(NF()):await jF(location.pathname,R,i)?Promise.reject(BF()):DF("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:y,service_id:e,template_id:n,template_params:o}),{"Content-type":"application/json"}))},eQ=e=>{if(!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"},tQ=e=>typeof e=="string"?document.querySelector(e):e,nQ=async(e,n,o,c)=>{const d=fT(c),y=d.publicKey||wa.publicKey,x=d.blockHeadless||wa.blockHeadless,i=wa.storageProvider||d.storageProvider,I={...wa.blockList,...d.blockList},R={...wa.limitRate,...d.limitRate};if(x&&OF(navigator))return Promise.reject(zF());const k=tQ(o);kF(y,e,n),eQ(k);const N=new FormData(k);return FF(I,N)?Promise.reject(NF()):await jF(location.pathname,R,i)?Promise.reject(BF()):(N.append("lib_version","4.4.1"),N.append("service_id",e),N.append("template_id",n),N.append("user_id",y),DF("/api/v1.0/email/send-form",N))},rQ={init:WJ,send:QJ,sendForm:nQ,EmailJSResponseStatus:Jv},iQ=()=>{const{t:e}=Rs(),n=V.useRef(),[o,c]=V.useState(!1),d=y=>{y.preventDefault(),rQ.sendForm("service_3pki1lg","template_8r6u2xo",n.current,{publicKey:"PVmqeNzi9d6uUKAP0"}).then(()=>{console.log("SUCCESS!"),c(!0),setTimeout(()=>c(!1),5e3),n.current.reset()},x=>{console.log("FAILED...",x.text)})};return T.jsxs(Ro,{className:"mt-3",children:[o&&T.jsx("div",{className:"alert alert-success",children:e("contact.sentMessage","Message envoy!")})," "," ",T.jsxs(ot,{ref:n,onSubmit:d,children:[T.jsxs(ot.Group,{controlId:"formName",children:[T.jsx(ot.Label,{children:e("contact.name","Nom")}),T.jsx(ot.Control,{type:"text",name:"user_name",placeholder:e("contact.placeholderName","Entrez votre nom"),required:!0})," "]}),T.jsxs(ot.Group,{controlId:"formEmail",children:[T.jsx(ot.Label,{children:e("contact.email","Email")}),T.jsx(ot.Control,{type:"email",name:"user_email",placeholder:e("contact.placeholderEmail","Entrez votre email"),required:!0})," "]}),T.jsxs(ot.Group,{controlId:"formMessage",children:[T.jsx(ot.Label,{children:e("contact.message","Message")}),T.jsx(ot.Control,{as:"textarea",name:"message",placeholder:e("contact.placeholderMessage","Entrez votre message"),rows:3,required:!0})," "]}),T.jsx("div",{className:"mb-3"})," ",T.jsx(Qn,{variant:"light",type:"submit",style:YC,children:e("contact.send","Envoyer")})]})]})};function sQ(){const e=Cu(),{setIsLoggedIn:n,setUserData:o}=Ih(),c=ml(),[d,y]=V.useState(""),[x,i]=V.useState({email:"bibu@gmail.com",password:"Patamon10#"}),[I,R]=V.useState(!1),k=U=>{try{const K=U.split(".");if(K.length!==3)return console.error("Format de token JWT invalide"),null;const X=K[0],Z=atob(X.replace(/-/g,"+").replace(/_/g,"/")),J=JSON.parse(Z);console.log("JWT Header:",J);const le=K[1],de=atob(le.replace(/-/g,"+").replace(/_/g,"/")),ue=JSON.parse(de);return console.log("JWT Payload:",ue),ue}catch(K){return console.error("Erreur lors du dcodage du token JWT:",K),null}},N=async U=>{U.preventDefault();try{const K=await c.post("auth/login",x);if(console.log("Rponse de l'API login:",K),K.token){sessionStorage.setItem("token",K.token),n(!0);const X=k(K.token);if(console.log("Token dcod:",X),X){const Z={email:X.sub||X.email||x.email,firstName:X.firstName||X.given_name||X.name||x.email.split("@")[0],id:X.id||X.userId||X.user_id,role:X.role||X.roles};console.log("Donnes utilisateur extraites du token:",Z),o(Z),localStorage.setItem("userEmail",Z.email)}e("/")}}catch(K){console.error("Erreur de connexion:",K),y("Email ou mot de passe incorrect")}};return T.jsx(Ro,{className:"py-5",children:T.jsx(vi,{className:"justify-content-center",children:T.jsx(Un,{md:6,children:T.jsxs(Za.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[T.jsx(yn,{className:"shadow-sm",children:T.jsxs(yn.Body,{className:"p-4",children:[T.jsxs("div",{className:"text-center mb-4",children:[T.jsx("h2",{children:"Connexion"}),T.jsx("p",{className:"text-muted",children:"Accdez  votre compte WhiskerQuest"})]}),d&&T.jsx(mi,{variant:"danger",className:"mb-4",children:d}),T.jsxs(ot,{onSubmit:N,children:[T.jsxs(ot.Group,{className:"mb-3",children:[T.jsxs(ot.Label,{children:[T.jsx(Gp,{className:"me-2"}),"Email"]}),T.jsx(ot.Control,{type:"email",placeholder:"Entrez votre email",value:x.email,onChange:U=>i({...x,email:U.target.value}),required:!0})]}),T.jsxs(ot.Group,{className:"mb-4",children:[T.jsxs(ot.Label,{children:[T.jsx(S_,{className:"me-2"}),"Mot de passe"]}),T.jsxs("div",{className:"input-group",children:[T.jsx(ot.Control,{type:I?"text":"password",placeholder:"Entrez votre mot de passe",value:x.password,onChange:U=>i({...x,password:U.target.value}),required:!0}),T.jsx(Qn,{variant:"outline-secondary",onClick:()=>R(!I),children:I?T.jsx(Vp,{}):T.jsx(Up,{})})]}),T.jsx("div",{className:"text-end mt-2",children:T.jsx(co,{to:"/forgot-password",className:"text-decoration-none",children:"Mot de passe oubli ?"})})]}),T.jsx("div",{className:"d-grid",children:T.jsx(Qn,{variant:"primary",type:"submit",size:"lg",children:"Se connecter"})})]})]})}),T.jsx(yn,{className:"mt-4 shadow-sm",children:T.jsxs(yn.Body,{className:"p-4 text-center",children:[T.jsx(L7,{className:"text-primary mb-3",size:24}),T.jsx("h4",{children:"Pas encore de compte ?"}),T.jsx("p",{className:"text-muted mb-4",children:"Rejoignez WhiskerQuest pour profiter de toutes nos fonctionnalits"}),T.jsx(Qn,{as:co,to:"/register",variant:"outline-primary",size:"lg",className:"px-5",children:"S'inscrire"})]})})]})})})})}const oQ=()=>{const[e,n]=V.useState(""),[o,c]=V.useState(""),[d,y]=V.useState(""),[x,i]=V.useState(!1);Cu();const I=ml(),R=async k=>{var N,U;k.preventDefault(),i(!0),c(""),y("");try{const K=await I.post("auth/forgot-password",{email:e});c("Un email de rinitialisation a t envoy  votre adresse. Veuillez vrifier votre bote de rception."),n("")}catch(K){y(((U=(N=K.response)==null?void 0:N.data)==null?void 0:U.message)||"Une erreur est survenue lors de l'envoi de l'email de rinitialisation.")}finally{i(!1)}};return T.jsx(Ro,{className:"py-5",children:T.jsx(vi,{className:"justify-content-center",children:T.jsx(Un,{md:6,children:T.jsxs(Za.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[T.jsx(yn,{className:"shadow-sm",children:T.jsxs(yn.Body,{className:"p-4",children:[T.jsxs("div",{className:"text-center mb-4",children:[T.jsx("h2",{children:"Mot de passe oubli"}),T.jsx("p",{className:"text-muted",children:"Entrez votre email pour rinitialiser votre mot de passe"})]}),o&&T.jsx(mi,{variant:"success",className:"mb-4",children:o}),d&&T.jsx(mi,{variant:"danger",className:"mb-4",children:d}),T.jsxs(ot,{onSubmit:R,children:[T.jsxs(ot.Group,{className:"mb-4",children:[T.jsxs(ot.Label,{children:[T.jsx(cg,{className:"me-2"}),"Email"]}),T.jsx(ot.Control,{type:"email",placeholder:"Entrez votre email",value:e,onChange:k=>n(k.target.value),required:!0,disabled:x})]}),T.jsx("div",{className:"d-grid",children:T.jsx(Qn,{variant:"primary",type:"submit",size:"lg",disabled:x,children:x?T.jsxs(T.Fragment,{children:[T.jsx(xu,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true",className:"me-2"}),"Envoi en cours..."]}):"Envoyer le lien de rinitialisation"})})]})]})}),T.jsx(yn,{className:"mt-4 shadow-sm",children:T.jsx(yn.Body,{className:"p-4 text-center",children:T.jsxs(Qn,{as:co,to:"/login",variant:"outline-primary",size:"lg",className:"px-5",disabled:x,children:[T.jsx(K2,{className:"me-2"}),"Retour  la connexion"]})})})]})})})})},aQ=()=>{const[e]=hD(),n=e.get("token"),[o,c]=V.useState(""),[d,y]=V.useState(""),[x,i]=V.useState(""),[I,R]=V.useState(""),[k,N]=V.useState(!1),[U,K]=V.useState(!1),X=Cu(),Z=ml(),{setIsLoggedIn:J,setUserData:le}=Ih(),de=async ue=>{var pe;if(ue.preventDefault(),o!==d){R("Les mots de passe ne correspondent pas");return}try{const he=await Z.post("auth/reset-password",{token:n,newPassword:o,matchingPassword:d});i(he),R(""),J(!1),le(null),sessionStorage.removeItem("token"),localStorage.removeItem("userEmail"),setTimeout(()=>{X("/login")},3e3)}catch(he){R(((pe=he.response)==null?void 0:pe.data)||"Une erreur est survenue"),i("")}};return n?T.jsx(Ro,{className:"mt-5",children:T.jsx(vi,{className:"justify-content-center",children:T.jsx(Un,{xs:12,md:8,lg:6,children:T.jsx(Za.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:T.jsx(yn,{className:"shadow",children:T.jsxs(yn.Body,{className:"p-4",children:[T.jsxs("h2",{className:"text-center mb-4",children:[T.jsx(S_,{className:"me-2"}),"Rinitialisation du mot de passe"]}),x&&T.jsx(mi,{variant:"success",className:"mb-4",children:x}),I&&T.jsx(mi,{variant:"danger",className:"mb-4",children:I}),T.jsxs(ot,{onSubmit:de,children:[T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:"Nouveau mot de passe"}),T.jsxs("div",{className:"position-relative",children:[T.jsx(ot.Control,{type:k?"text":"password",value:o,onChange:ue=>c(ue.target.value),required:!0,minLength:6}),T.jsx(Qn,{variant:"link",className:"position-absolute end-0 top-50 translate-middle-y",onClick:()=>N(!k),children:k?T.jsx(Vp,{}):T.jsx(Up,{})})]})]}),T.jsxs(ot.Group,{className:"mb-4",children:[T.jsx(ot.Label,{children:"Confirmer le mot de passe"}),T.jsxs("div",{className:"position-relative",children:[T.jsx(ot.Control,{type:U?"text":"password",value:d,onChange:ue=>y(ue.target.value),required:!0,minLength:6}),T.jsx(Qn,{variant:"link",className:"position-absolute end-0 top-50 translate-middle-y",onClick:()=>K(!U),children:U?T.jsx(Vp,{}):T.jsx(Up,{})})]})]}),T.jsx(Qn,{variant:"primary",type:"submit",className:"w-100 mb-3",children:"Rinitialiser le mot de passe"}),T.jsx("div",{className:"text-center",children:T.jsxs(co,{to:"/login",className:"text-decoration-none",children:[T.jsx(K2,{className:"me-2"}),"Retour  la connexion"]})})]})]})})})})})}):T.jsxs(Ro,{className:"mt-5",children:[T.jsx(mi,{variant:"danger",children:"Token de rinitialisation manquant ou invalide. Veuillez demander un nouveau lien de rinitialisation."}),T.jsxs(co,{to:"/forgot-password",className:"btn btn-primary",children:[T.jsx(K2,{className:"me-2"}),"Retour  la page de mot de passe oubli"]})]})},ci=e=>typeof e=="string",Xy=()=>{let e,n;const o=new Promise((c,d)=>{e=c,n=d});return o.resolve=e,o.reject=n,o},S3=e=>e==null?"":""+e,lQ=(e,n,o)=>{e.forEach(c=>{n[c]&&(o[c]=n[c])})},cQ=/###/g,C3=e=>e&&e.indexOf("###")>-1?e.replace(cQ,"."):e,T3=e=>!e||ci(e),fv=(e,n,o)=>{const c=ci(n)?n.split("."):n;let d=0;for(;d<c.length-1;){if(T3(e))return{};const y=C3(c[d]);!e[y]&&o&&(e[y]=new o),Object.prototype.hasOwnProperty.call(e,y)?e=e[y]:e={},++d}return T3(e)?{}:{obj:e,k:C3(c[d])}},E3=(e,n,o)=>{const{obj:c,k:d}=fv(e,n,Object);if(c!==void 0||n.length===1){c[d]=o;return}let y=n[n.length-1],x=n.slice(0,n.length-1),i=fv(e,x,Object);for(;i.obj===void 0&&x.length;)y=`${x[x.length-1]}.${y}`,x=x.slice(0,x.length-1),i=fv(e,x,Object),i!=null&&i.obj&&typeof i.obj[`${i.k}.${y}`]<"u"&&(i.obj=void 0);i.obj[`${i.k}.${y}`]=o},uQ=(e,n,o,c)=>{const{obj:d,k:y}=fv(e,n,Object);d[y]=d[y]||[],d[y].push(o)},s1=(e,n)=>{const{obj:o,k:c}=fv(e,n);if(o&&Object.prototype.hasOwnProperty.call(o,c))return o[c]},dQ=(e,n,o)=>{const c=s1(e,o);return c!==void 0?c:s1(n,o)},VF=(e,n,o)=>{for(const c in n)c!=="__proto__"&&c!=="constructor"&&(c in e?ci(e[c])||e[c]instanceof String||ci(n[c])||n[c]instanceof String?o&&(e[c]=n[c]):VF(e[c],n[c],o):e[c]=n[c]);return e},Jg=e=>e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var hQ={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const fQ=e=>ci(e)?e.replace(/[&<>"'\/]/g,n=>hQ[n]):e;class pQ{constructor(n){this.capacity=n,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(n){const o=this.regExpMap.get(n);if(o!==void 0)return o;const c=new RegExp(n);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(n,c),this.regExpQueue.push(n),c}}const mQ=[" ",",","?","!",";"],gQ=new pQ(20),_Q=(e,n,o)=>{n=n||"",o=o||"";const c=mQ.filter(x=>n.indexOf(x)<0&&o.indexOf(x)<0);if(c.length===0)return!0;const d=gQ.getRegExp(`(${c.map(x=>x==="?"?"\\?":x).join("|")})`);let y=!d.test(e);if(!y){const x=e.indexOf(o);x>0&&!d.test(e.substring(0,x))&&(y=!0)}return y},PS=function(e,n){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!e)return;if(e[n])return Object.prototype.hasOwnProperty.call(e,n)?e[n]:void 0;const c=n.split(o);let d=e;for(let y=0;y<c.length;){if(!d||typeof d!="object")return;let x,i="";for(let I=y;I<c.length;++I)if(I!==y&&(i+=o),i+=c[I],x=d[i],x!==void 0){if(["string","number","boolean"].indexOf(typeof x)>-1&&I<c.length-1)continue;y+=I-y+1;break}d=x}return d},o1=e=>e==null?void 0:e.replace("_","-"),yQ={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,n){var o,c;(c=(o=console==null?void 0:console[e])==null?void 0:o.apply)==null||c.call(o,console,n)}};class a1{constructor(n){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(n,o)}init(n){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=o.prefix||"i18next:",this.logger=n||yQ,this.options=o,this.debug=o.debug}log(){for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return this.forward(o,"log","",!0)}warn(){for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return this.forward(o,"warn","",!0)}error(){for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return this.forward(o,"error","")}deprecate(){for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return this.forward(o,"warn","WARNING DEPRECATED: ",!0)}forward(n,o,c,d){return d&&!this.debug?null:(ci(n[0])&&(n[0]=`${c}${this.prefix} ${n[0]}`),this.logger[o](n))}create(n){return new a1(this.logger,{prefix:`${this.prefix}:${n}:`,...this.options})}clone(n){return n=n||this.options,n.prefix=n.prefix||this.prefix,new a1(this.logger,n)}}var xh=new a1;class Z1{constructor(){this.observers={}}on(n,o){return n.split(" ").forEach(c=>{this.observers[c]||(this.observers[c]=new Map);const d=this.observers[c].get(o)||0;this.observers[c].set(o,d+1)}),this}off(n,o){if(this.observers[n]){if(!o){delete this.observers[n];return}this.observers[n].delete(o)}}emit(n){for(var o=arguments.length,c=new Array(o>1?o-1:0),d=1;d<o;d++)c[d-1]=arguments[d];this.observers[n]&&Array.from(this.observers[n].entries()).forEach(x=>{let[i,I]=x;for(let R=0;R<I;R++)i(...c)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(x=>{let[i,I]=x;for(let R=0;R<I;R++)i.apply(i,[n,...c])})}}class I3 extends Z1{constructor(n){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=n||{},this.options=o,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(n){this.options.ns.indexOf(n)<0&&this.options.ns.push(n)}removeNamespaces(n){const o=this.options.ns.indexOf(n);o>-1&&this.options.ns.splice(o,1)}getResource(n,o,c){var R,k;let d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const y=d.keySeparator!==void 0?d.keySeparator:this.options.keySeparator,x=d.ignoreJSONStructure!==void 0?d.ignoreJSONStructure:this.options.ignoreJSONStructure;let i;n.indexOf(".")>-1?i=n.split("."):(i=[n,o],c&&(Array.isArray(c)?i.push(...c):ci(c)&&y?i.push(...c.split(y)):i.push(c)));const I=s1(this.data,i);return!I&&!o&&!c&&n.indexOf(".")>-1&&(n=i[0],o=i[1],c=i.slice(2).join(".")),I||!x||!ci(c)?I:PS((k=(R=this.data)==null?void 0:R[n])==null?void 0:k[o],c,y)}addResource(n,o,c,d){let y=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1};const x=y.keySeparator!==void 0?y.keySeparator:this.options.keySeparator;let i=[n,o];c&&(i=i.concat(x?c.split(x):c)),n.indexOf(".")>-1&&(i=n.split("."),d=o,o=i[1]),this.addNamespaces(o),E3(this.data,i,d),y.silent||this.emit("added",n,o,c,d)}addResources(n,o,c){let d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(const y in c)(ci(c[y])||Array.isArray(c[y]))&&this.addResource(n,o,y,c[y],{silent:!0});d.silent||this.emit("added",n,o,c)}addResourceBundle(n,o,c,d,y){let x=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},i=[n,o];n.indexOf(".")>-1&&(i=n.split("."),d=c,c=o,o=i[1]),this.addNamespaces(o);let I=s1(this.data,i)||{};x.skipCopy||(c=JSON.parse(JSON.stringify(c))),d?VF(I,c,y):I={...I,...c},E3(this.data,i,I),x.silent||this.emit("added",n,o,c)}removeResourceBundle(n,o){this.hasResourceBundle(n,o)&&delete this.data[n][o],this.removeNamespaces(o),this.emit("removed",n,o)}hasResourceBundle(n,o){return this.getResource(n,o)!==void 0}getResourceBundle(n,o){return o||(o=this.options.defaultNS),this.getResource(n,o)}getDataByLanguage(n){return this.data[n]}hasLanguageSomeTranslations(n){const o=this.getDataByLanguage(n);return!!(o&&Object.keys(o)||[]).find(d=>o[d]&&Object.keys(o[d]).length>0)}toJSON(){return this.data}}var UF={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,n,o,c,d){return e.forEach(y=>{var x;n=((x=this.processors[y])==null?void 0:x.process(n,o,c,d))??n}),n}};const P3={},A3=e=>!ci(e)&&typeof e!="boolean"&&typeof e!="number";class l1 extends Z1{constructor(n){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),lQ(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],n,this),this.options=o,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=xh.create("translator")}changeLanguage(n){n&&(this.language=n)}exists(n){const c={...arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}}};if(n==null)return!1;const d=this.resolve(n,c);return(d==null?void 0:d.res)!==void 0}extractFromKey(n,o){let c=o.nsSeparator!==void 0?o.nsSeparator:this.options.nsSeparator;c===void 0&&(c=":");const d=o.keySeparator!==void 0?o.keySeparator:this.options.keySeparator;let y=o.ns||this.options.defaultNS||[];const x=c&&n.indexOf(c)>-1,i=!this.options.userDefinedKeySeparator&&!o.keySeparator&&!this.options.userDefinedNsSeparator&&!o.nsSeparator&&!_Q(n,c,d);if(x&&!i){const I=n.match(this.interpolator.nestingRegexp);if(I&&I.length>0)return{key:n,namespaces:ci(y)?[y]:y};const R=n.split(c);(c!==d||c===d&&this.options.ns.indexOf(R[0])>-1)&&(y=R.shift()),n=R.join(d)}return{key:n,namespaces:ci(y)?[y]:y}}translate(n,o,c){let d=typeof o=="object"?{...o}:o;if(typeof d!="object"&&this.options.overloadTranslationOptionHandler&&(d=this.options.overloadTranslationOptionHandler(arguments)),typeof options=="object"&&(d={...d}),d||(d={}),n==null)return"";Array.isArray(n)||(n=[String(n)]);const y=d.returnDetails!==void 0?d.returnDetails:this.options.returnDetails,x=d.keySeparator!==void 0?d.keySeparator:this.options.keySeparator,{key:i,namespaces:I}=this.extractFromKey(n[n.length-1],d),R=I[I.length-1],k=d.lng||this.language,N=d.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((k==null?void 0:k.toLowerCase())==="cimode"){if(N){const lt=d.nsSeparator||this.options.nsSeparator;return y?{res:`${R}${lt}${i}`,usedKey:i,exactUsedKey:i,usedLng:k,usedNS:R,usedParams:this.getUsedParamsDetails(d)}:`${R}${lt}${i}`}return y?{res:i,usedKey:i,exactUsedKey:i,usedLng:k,usedNS:R,usedParams:this.getUsedParamsDetails(d)}:i}const U=this.resolve(n,d);let K=U==null?void 0:U.res;const X=(U==null?void 0:U.usedKey)||i,Z=(U==null?void 0:U.exactUsedKey)||i,J=["[object Number]","[object Function]","[object RegExp]"],le=d.joinArrays!==void 0?d.joinArrays:this.options.joinArrays,de=!this.i18nFormat||this.i18nFormat.handleAsObject,ue=d.count!==void 0&&!ci(d.count),pe=l1.hasDefaultValue(d),he=ue?this.pluralResolver.getSuffix(k,d.count,d):"",xe=d.ordinal&&ue?this.pluralResolver.getSuffix(k,d.count,{ordinal:!1}):"",fe=ue&&!d.ordinal&&d.count===0,_e=fe&&d[`defaultValue${this.options.pluralSeparator}zero`]||d[`defaultValue${he}`]||d[`defaultValue${xe}`]||d.defaultValue;let Ce=K;de&&!K&&pe&&(Ce=_e);const je=A3(Ce),He=Object.prototype.toString.apply(Ce);if(de&&Ce&&je&&J.indexOf(He)<0&&!(ci(le)&&Array.isArray(Ce))){if(!d.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const lt=this.options.returnedObjectHandler?this.options.returnedObjectHandler(X,Ce,{...d,ns:I}):`key '${i} (${this.language})' returned an object instead of string.`;return y?(U.res=lt,U.usedParams=this.getUsedParamsDetails(d),U):lt}if(x){const lt=Array.isArray(Ce),_t=lt?[]:{},Ue=lt?Z:X;for(const Ge in Ce)if(Object.prototype.hasOwnProperty.call(Ce,Ge)){const at=`${Ue}${x}${Ge}`;pe&&!K?_t[Ge]=this.translate(at,{...d,defaultValue:A3(_e)?_e[Ge]:void 0,joinArrays:!1,ns:I}):_t[Ge]=this.translate(at,{...d,joinArrays:!1,ns:I}),_t[Ge]===at&&(_t[Ge]=Ce[Ge])}K=_t}}else if(de&&ci(le)&&Array.isArray(K))K=K.join(le),K&&(K=this.extendTranslation(K,n,d,c));else{let lt=!1,_t=!1;!this.isValidLookup(K)&&pe&&(lt=!0,K=_e),this.isValidLookup(K)||(_t=!0,K=i);const Ge=(d.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&_t?void 0:K,at=pe&&_e!==K&&this.options.updateMissing;if(_t||lt||at){if(this.logger.log(at?"updateKey":"missingKey",k,R,i,at?_e:K),x){const ct=this.resolve(i,{...d,keySeparator:!1});ct&&ct.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let yt=[];const tt=this.languageUtils.getFallbackCodes(this.options.fallbackLng,d.lng||this.language);if(this.options.saveMissingTo==="fallback"&&tt&&tt[0])for(let ct=0;ct<tt.length;ct++)yt.push(tt[ct]);else this.options.saveMissingTo==="all"?yt=this.languageUtils.toResolveHierarchy(d.lng||this.language):yt.push(d.lng||this.language);const Rt=(ct,ze,Ye)=>{var Ct;const At=pe&&Ye!==K?Ye:Ge;this.options.missingKeyHandler?this.options.missingKeyHandler(ct,R,ze,At,at,d):(Ct=this.backendConnector)!=null&&Ct.saveMissing&&this.backendConnector.saveMissing(ct,R,ze,At,at,d),this.emit("missingKey",ct,R,ze,K)};this.options.saveMissing&&(this.options.saveMissingPlurals&&ue?yt.forEach(ct=>{const ze=this.pluralResolver.getSuffixes(ct,d);fe&&d[`defaultValue${this.options.pluralSeparator}zero`]&&ze.indexOf(`${this.options.pluralSeparator}zero`)<0&&ze.push(`${this.options.pluralSeparator}zero`),ze.forEach(Ye=>{Rt([ct],i+Ye,d[`defaultValue${Ye}`]||_e)})}):Rt(yt,i,_e))}K=this.extendTranslation(K,n,d,U,c),_t&&K===i&&this.options.appendNamespaceToMissingKey&&(K=`${R}:${i}`),(_t||lt)&&this.options.parseMissingKeyHandler&&(K=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${R}:${i}`:i,lt?K:void 0,d))}return y?(U.res=K,U.usedParams=this.getUsedParamsDetails(d),U):K}extendTranslation(n,o,c,d,y){var R,k;var x=this;if((R=this.i18nFormat)!=null&&R.parse)n=this.i18nFormat.parse(n,{...this.options.interpolation.defaultVariables,...c},c.lng||this.language||d.usedLng,d.usedNS,d.usedKey,{resolved:d});else if(!c.skipInterpolation){c.interpolation&&this.interpolator.init({...c,interpolation:{...this.options.interpolation,...c.interpolation}});const N=ci(n)&&(((k=c==null?void 0:c.interpolation)==null?void 0:k.skipOnVariables)!==void 0?c.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let U;if(N){const X=n.match(this.interpolator.nestingRegexp);U=X&&X.length}let K=c.replace&&!ci(c.replace)?c.replace:c;if(this.options.interpolation.defaultVariables&&(K={...this.options.interpolation.defaultVariables,...K}),n=this.interpolator.interpolate(n,K,c.lng||this.language||d.usedLng,c),N){const X=n.match(this.interpolator.nestingRegexp),Z=X&&X.length;U<Z&&(c.nest=!1)}!c.lng&&d&&d.res&&(c.lng=this.language||d.usedLng),c.nest!==!1&&(n=this.interpolator.nest(n,function(){for(var X=arguments.length,Z=new Array(X),J=0;J<X;J++)Z[J]=arguments[J];return(y==null?void 0:y[0])===Z[0]&&!c.context?(x.logger.warn(`It seems you are nesting recursively key: ${Z[0]} in key: ${o[0]}`),null):x.translate(...Z,o)},c)),c.interpolation&&this.interpolator.reset()}const i=c.postProcess||this.options.postProcess,I=ci(i)?[i]:i;return n!=null&&(I!=null&&I.length)&&c.applyPostProcessor!==!1&&(n=UF.handle(I,n,o,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...d,usedParams:this.getUsedParamsDetails(c)},...c}:c,this)),n}resolve(n){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c,d,y,x,i;return ci(n)&&(n=[n]),n.forEach(I=>{if(this.isValidLookup(c))return;const R=this.extractFromKey(I,o),k=R.key;d=k;let N=R.namespaces;this.options.fallbackNS&&(N=N.concat(this.options.fallbackNS));const U=o.count!==void 0&&!ci(o.count),K=U&&!o.ordinal&&o.count===0,X=o.context!==void 0&&(ci(o.context)||typeof o.context=="number")&&o.context!=="",Z=o.lngs?o.lngs:this.languageUtils.toResolveHierarchy(o.lng||this.language,o.fallbackLng);N.forEach(J=>{var le,de;this.isValidLookup(c)||(i=J,!P3[`${Z[0]}-${J}`]&&((le=this.utils)!=null&&le.hasLoadedNamespace)&&!((de=this.utils)!=null&&de.hasLoadedNamespace(i))&&(P3[`${Z[0]}-${J}`]=!0,this.logger.warn(`key "${d}" for languages "${Z.join(", ")}" won't get resolved as namespace "${i}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),Z.forEach(ue=>{var xe;if(this.isValidLookup(c))return;x=ue;const pe=[k];if((xe=this.i18nFormat)!=null&&xe.addLookupKeys)this.i18nFormat.addLookupKeys(pe,k,ue,J,o);else{let fe;U&&(fe=this.pluralResolver.getSuffix(ue,o.count,o));const _e=`${this.options.pluralSeparator}zero`,Ce=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(U&&(pe.push(k+fe),o.ordinal&&fe.indexOf(Ce)===0&&pe.push(k+fe.replace(Ce,this.options.pluralSeparator)),K&&pe.push(k+_e)),X){const je=`${k}${this.options.contextSeparator}${o.context}`;pe.push(je),U&&(pe.push(je+fe),o.ordinal&&fe.indexOf(Ce)===0&&pe.push(je+fe.replace(Ce,this.options.pluralSeparator)),K&&pe.push(je+_e))}}let he;for(;he=pe.pop();)this.isValidLookup(c)||(y=he,c=this.getResource(ue,J,he,o))}))})}),{res:c,usedKey:d,exactUsedKey:y,usedLng:x,usedNS:i}}isValidLookup(n){return n!==void 0&&!(!this.options.returnNull&&n===null)&&!(!this.options.returnEmptyString&&n==="")}getResource(n,o,c){var y;let d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return(y=this.i18nFormat)!=null&&y.getResource?this.i18nFormat.getResource(n,o,c,d):this.resourceStore.getResource(n,o,c,d)}getUsedParamsDetails(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const o=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],c=n.replace&&!ci(n.replace);let d=c?n.replace:n;if(c&&typeof n.count<"u"&&(d.count=n.count),this.options.interpolation.defaultVariables&&(d={...this.options.interpolation.defaultVariables,...d}),!c){d={...d};for(const y of o)delete d[y]}return d}static hasDefaultValue(n){const o="defaultValue";for(const c in n)if(Object.prototype.hasOwnProperty.call(n,c)&&o===c.substring(0,o.length)&&n[c]!==void 0)return!0;return!1}}class R3{constructor(n){this.options=n,this.supportedLngs=this.options.supportedLngs||!1,this.logger=xh.create("languageUtils")}getScriptPartFromCode(n){if(n=o1(n),!n||n.indexOf("-")<0)return null;const o=n.split("-");return o.length===2||(o.pop(),o[o.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(o.join("-"))}getLanguagePartFromCode(n){if(n=o1(n),!n||n.indexOf("-")<0)return n;const o=n.split("-");return this.formatLanguageCode(o[0])}formatLanguageCode(n){if(ci(n)&&n.indexOf("-")>-1){let o;try{o=Intl.getCanonicalLocales(n)[0]}catch{}return o&&this.options.lowerCaseLng&&(o=o.toLowerCase()),o||(this.options.lowerCaseLng?n.toLowerCase():n)}return this.options.cleanCode||this.options.lowerCaseLng?n.toLowerCase():n}isSupportedCode(n){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(n=this.getLanguagePartFromCode(n)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(n)>-1}getBestMatchFromCodes(n){if(!n)return null;let o;return n.forEach(c=>{if(o)return;const d=this.formatLanguageCode(c);(!this.options.supportedLngs||this.isSupportedCode(d))&&(o=d)}),!o&&this.options.supportedLngs&&n.forEach(c=>{if(o)return;const d=this.getScriptPartFromCode(c);if(this.isSupportedCode(d))return o=d;const y=this.getLanguagePartFromCode(c);if(this.isSupportedCode(y))return o=y;o=this.options.supportedLngs.find(x=>{if(x===y)return x;if(!(x.indexOf("-")<0&&y.indexOf("-")<0)&&(x.indexOf("-")>0&&y.indexOf("-")<0&&x.substring(0,x.indexOf("-"))===y||x.indexOf(y)===0&&y.length>1))return x})}),o||(o=this.getFallbackCodes(this.options.fallbackLng)[0]),o}getFallbackCodes(n,o){if(!n)return[];if(typeof n=="function"&&(n=n(o)),ci(n)&&(n=[n]),Array.isArray(n))return n;if(!o)return n.default||[];let c=n[o];return c||(c=n[this.getScriptPartFromCode(o)]),c||(c=n[this.formatLanguageCode(o)]),c||(c=n[this.getLanguagePartFromCode(o)]),c||(c=n.default),c||[]}toResolveHierarchy(n,o){const c=this.getFallbackCodes(o||this.options.fallbackLng||[],n),d=[],y=x=>{x&&(this.isSupportedCode(x)?d.push(x):this.logger.warn(`rejecting language code not found in supportedLngs: ${x}`))};return ci(n)&&(n.indexOf("-")>-1||n.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&y(this.formatLanguageCode(n)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&y(this.getScriptPartFromCode(n)),this.options.load!=="currentOnly"&&y(this.getLanguagePartFromCode(n))):ci(n)&&y(this.formatLanguageCode(n)),c.forEach(x=>{d.indexOf(x)<0&&y(this.formatLanguageCode(x))}),d}}const M3={zero:0,one:1,two:2,few:3,many:4,other:5},L3={select:e=>e===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class vQ{constructor(n){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=n,this.options=o,this.logger=xh.create("pluralResolver"),this.pluralRulesCache={}}addRule(n,o){this.rules[n]=o}clearCache(){this.pluralRulesCache={}}getRule(n){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const c=o1(n==="dev"?"en":n),d=o.ordinal?"ordinal":"cardinal",y=JSON.stringify({cleanedCode:c,type:d});if(y in this.pluralRulesCache)return this.pluralRulesCache[y];let x;try{x=new Intl.PluralRules(c,{type:d})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),L3;if(!n.match(/-|_/))return L3;const I=this.languageUtils.getLanguagePartFromCode(n);x=this.getRule(I,o)}return this.pluralRulesCache[y]=x,x}needsPlural(n){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c=this.getRule(n,o);return c||(c=this.getRule("dev",o)),(c==null?void 0:c.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(n,o){let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(n,c).map(d=>`${o}${d}`)}getSuffixes(n){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c=this.getRule(n,o);return c||(c=this.getRule("dev",o)),c?c.resolvedOptions().pluralCategories.sort((d,y)=>M3[d]-M3[y]).map(d=>`${this.options.prepend}${o.ordinal?`ordinal${this.options.prepend}`:""}${d}`):[]}getSuffix(n,o){let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const d=this.getRule(n,c);return d?`${this.options.prepend}${c.ordinal?`ordinal${this.options.prepend}`:""}${d.select(o)}`:(this.logger.warn(`no plural rule found for: ${n}`),this.getSuffix("dev",o,c))}}const D3=function(e,n,o){let c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,y=dQ(e,n,o);return!y&&d&&ci(o)&&(y=PS(e,o,c),y===void 0&&(y=PS(n,o,c))),y},m2=e=>e.replace(/\$/g,"$$$$");class xQ{constructor(){var o;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=xh.create("interpolator"),this.options=n,this.format=((o=n==null?void 0:n.interpolation)==null?void 0:o.format)||(c=>c),this.init(n)}init(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};n.interpolation||(n.interpolation={escapeValue:!0});const{escape:o,escapeValue:c,useRawValueToEscape:d,prefix:y,prefixEscaped:x,suffix:i,suffixEscaped:I,formatSeparator:R,unescapeSuffix:k,unescapePrefix:N,nestingPrefix:U,nestingPrefixEscaped:K,nestingSuffix:X,nestingSuffixEscaped:Z,nestingOptionsSeparator:J,maxReplaces:le,alwaysFormat:de}=n.interpolation;this.escape=o!==void 0?o:fQ,this.escapeValue=c!==void 0?c:!0,this.useRawValueToEscape=d!==void 0?d:!1,this.prefix=y?Jg(y):x||"{{",this.suffix=i?Jg(i):I||"}}",this.formatSeparator=R||",",this.unescapePrefix=k?"":N||"-",this.unescapeSuffix=this.unescapePrefix?"":k||"",this.nestingPrefix=U?Jg(U):K||Jg("$t("),this.nestingSuffix=X?Jg(X):Z||Jg(")"),this.nestingOptionsSeparator=J||",",this.maxReplaces=le||1e3,this.alwaysFormat=de!==void 0?de:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const n=(o,c)=>(o==null?void 0:o.source)===c?(o.lastIndex=0,o):new RegExp(c,"g");this.regexp=n(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=n(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=n(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(n,o,c,d){var K;let y,x,i;const I=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},R=X=>{if(X.indexOf(this.formatSeparator)<0){const de=D3(o,I,X,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(de,void 0,c,{...d,...o,interpolationkey:X}):de}const Z=X.split(this.formatSeparator),J=Z.shift().trim(),le=Z.join(this.formatSeparator).trim();return this.format(D3(o,I,J,this.options.keySeparator,this.options.ignoreJSONStructure),le,c,{...d,...o,interpolationkey:J})};this.resetRegExp();const k=(d==null?void 0:d.missingInterpolationHandler)||this.options.missingInterpolationHandler,N=((K=d==null?void 0:d.interpolation)==null?void 0:K.skipOnVariables)!==void 0?d.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:X=>m2(X)},{regex:this.regexp,safeValue:X=>this.escapeValue?m2(this.escape(X)):m2(X)}].forEach(X=>{for(i=0;y=X.regex.exec(n);){const Z=y[1].trim();if(x=R(Z),x===void 0)if(typeof k=="function"){const le=k(n,y,d);x=ci(le)?le:""}else if(d&&Object.prototype.hasOwnProperty.call(d,Z))x="";else if(N){x=y[0];continue}else this.logger.warn(`missed to pass in variable ${Z} for interpolating ${n}`),x="";else!ci(x)&&!this.useRawValueToEscape&&(x=S3(x));const J=X.safeValue(x);if(n=n.replace(y[0],J),N?(X.regex.lastIndex+=x.length,X.regex.lastIndex-=y[0].length):X.regex.lastIndex=0,i++,i>=this.maxReplaces)break}}),n}nest(n,o){let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},d,y,x;const i=(I,R)=>{const k=this.nestingOptionsSeparator;if(I.indexOf(k)<0)return I;const N=I.split(new RegExp(`${k}[ ]*{`));let U=`{${N[1]}`;I=N[0],U=this.interpolate(U,x);const K=U.match(/'/g),X=U.match(/"/g);(((K==null?void 0:K.length)??0)%2===0&&!X||X.length%2!==0)&&(U=U.replace(/'/g,'"'));try{x=JSON.parse(U),R&&(x={...R,...x})}catch(Z){return this.logger.warn(`failed parsing options string in nesting for key ${I}`,Z),`${I}${k}${U}`}return x.defaultValue&&x.defaultValue.indexOf(this.prefix)>-1&&delete x.defaultValue,I};for(;d=this.nestingRegexp.exec(n);){let I=[];x={...c},x=x.replace&&!ci(x.replace)?x.replace:x,x.applyPostProcessor=!1,delete x.defaultValue;let R=!1;if(d[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(d[1])){const k=d[1].split(this.formatSeparator).map(N=>N.trim());d[1]=k.shift(),I=k,R=!0}if(y=o(i.call(this,d[1].trim(),x),x),y&&d[0]===n&&!ci(y))return y;ci(y)||(y=S3(y)),y||(this.logger.warn(`missed to resolve ${d[1]} for nesting ${n}`),y=""),R&&(y=I.reduce((k,N)=>this.format(k,N,c.lng,{...c,interpolationkey:d[1].trim()}),y.trim())),n=n.replace(d[0],y),this.regexp.lastIndex=0}return n}}const bQ=e=>{let n=e.toLowerCase().trim();const o={};if(e.indexOf("(")>-1){const c=e.split("(");n=c[0].toLowerCase().trim();const d=c[1].substring(0,c[1].length-1);n==="currency"&&d.indexOf(":")<0?o.currency||(o.currency=d.trim()):n==="relativetime"&&d.indexOf(":")<0?o.range||(o.range=d.trim()):d.split(";").forEach(x=>{if(x){const[i,...I]=x.split(":"),R=I.join(":").trim().replace(/^'+|'+$/g,""),k=i.trim();o[k]||(o[k]=R),R==="false"&&(o[k]=!1),R==="true"&&(o[k]=!0),isNaN(R)||(o[k]=parseInt(R,10))}})}return{formatName:n,formatOptions:o}},Qg=e=>{const n={};return(o,c,d)=>{let y=d;d&&d.interpolationkey&&d.formatParams&&d.formatParams[d.interpolationkey]&&d[d.interpolationkey]&&(y={...y,[d.interpolationkey]:void 0});const x=c+JSON.stringify(y);let i=n[x];return i||(i=e(o1(c),d),n[x]=i),i(o)}};class wQ{constructor(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=xh.create("formatter"),this.options=n,this.formats={number:Qg((o,c)=>{const d=new Intl.NumberFormat(o,{...c});return y=>d.format(y)}),currency:Qg((o,c)=>{const d=new Intl.NumberFormat(o,{...c,style:"currency"});return y=>d.format(y)}),datetime:Qg((o,c)=>{const d=new Intl.DateTimeFormat(o,{...c});return y=>d.format(y)}),relativetime:Qg((o,c)=>{const d=new Intl.RelativeTimeFormat(o,{...c});return y=>d.format(y,c.range||"day")}),list:Qg((o,c)=>{const d=new Intl.ListFormat(o,{...c});return y=>d.format(y)})},this.init(n)}init(n){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};this.formatSeparator=o.interpolation.formatSeparator||","}add(n,o){this.formats[n.toLowerCase().trim()]=o}addCached(n,o){this.formats[n.toLowerCase().trim()]=Qg(o)}format(n,o,c){let d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const y=o.split(this.formatSeparator);if(y.length>1&&y[0].indexOf("(")>1&&y[0].indexOf(")")<0&&y.find(i=>i.indexOf(")")>-1)){const i=y.findIndex(I=>I.indexOf(")")>-1);y[0]=[y[0],...y.splice(1,i)].join(this.formatSeparator)}return y.reduce((i,I)=>{var N;const{formatName:R,formatOptions:k}=bQ(I);if(this.formats[R]){let U=i;try{const K=((N=d==null?void 0:d.formatParams)==null?void 0:N[d.interpolationkey])||{},X=K.locale||K.lng||d.locale||d.lng||c;U=this.formats[R](i,X,{...k,...d,...K})}catch(K){this.logger.warn(K)}return U}else this.logger.warn(`there was no format function for ${R}`);return i},n)}}const SQ=(e,n)=>{e.pending[n]!==void 0&&(delete e.pending[n],e.pendingCount--)};class CQ extends Z1{constructor(n,o,c){var y,x;let d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=n,this.store=o,this.services=c,this.languageUtils=c.languageUtils,this.options=d,this.logger=xh.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=d.maxParallelReads||10,this.readingCalls=0,this.maxRetries=d.maxRetries>=0?d.maxRetries:5,this.retryTimeout=d.retryTimeout>=1?d.retryTimeout:350,this.state={},this.queue=[],(x=(y=this.backend)==null?void 0:y.init)==null||x.call(y,c,d.backend,d)}queueLoad(n,o,c,d){const y={},x={},i={},I={};return n.forEach(R=>{let k=!0;o.forEach(N=>{const U=`${R}|${N}`;!c.reload&&this.store.hasResourceBundle(R,N)?this.state[U]=2:this.state[U]<0||(this.state[U]===1?x[U]===void 0&&(x[U]=!0):(this.state[U]=1,k=!1,x[U]===void 0&&(x[U]=!0),y[U]===void 0&&(y[U]=!0),I[N]===void 0&&(I[N]=!0)))}),k||(i[R]=!0)}),(Object.keys(y).length||Object.keys(x).length)&&this.queue.push({pending:x,pendingCount:Object.keys(x).length,loaded:{},errors:[],callback:d}),{toLoad:Object.keys(y),pending:Object.keys(x),toLoadLanguages:Object.keys(i),toLoadNamespaces:Object.keys(I)}}loaded(n,o,c){const d=n.split("|"),y=d[0],x=d[1];o&&this.emit("failedLoading",y,x,o),!o&&c&&this.store.addResourceBundle(y,x,c,void 0,void 0,{skipCopy:!0}),this.state[n]=o?-1:2,o&&c&&(this.state[n]=0);const i={};this.queue.forEach(I=>{uQ(I.loaded,[y],x),SQ(I,n),o&&I.errors.push(o),I.pendingCount===0&&!I.done&&(Object.keys(I.loaded).forEach(R=>{i[R]||(i[R]={});const k=I.loaded[R];k.length&&k.forEach(N=>{i[R][N]===void 0&&(i[R][N]=!0)})}),I.done=!0,I.errors.length?I.callback(I.errors):I.callback())}),this.emit("loaded",i),this.queue=this.queue.filter(I=>!I.done)}read(n,o,c){let d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,y=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,x=arguments.length>5?arguments[5]:void 0;if(!n.length)return x(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:n,ns:o,fcName:c,tried:d,wait:y,callback:x});return}this.readingCalls++;const i=(R,k)=>{if(this.readingCalls--,this.waitingReads.length>0){const N=this.waitingReads.shift();this.read(N.lng,N.ns,N.fcName,N.tried,N.wait,N.callback)}if(R&&k&&d<this.maxRetries){setTimeout(()=>{this.read.call(this,n,o,c,d+1,y*2,x)},y);return}x(R,k)},I=this.backend[c].bind(this.backend);if(I.length===2){try{const R=I(n,o);R&&typeof R.then=="function"?R.then(k=>i(null,k)).catch(i):i(null,R)}catch(R){i(R)}return}return I(n,o,i)}prepareLoading(n,o){let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},d=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),d&&d();ci(n)&&(n=this.languageUtils.toResolveHierarchy(n)),ci(o)&&(o=[o]);const y=this.queueLoad(n,o,c,d);if(!y.toLoad.length)return y.pending.length||d(),null;y.toLoad.forEach(x=>{this.loadOne(x)})}load(n,o,c){this.prepareLoading(n,o,{},c)}reload(n,o,c){this.prepareLoading(n,o,{reload:!0},c)}loadOne(n){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const c=n.split("|"),d=c[0],y=c[1];this.read(d,y,"read",void 0,void 0,(x,i)=>{x&&this.logger.warn(`${o}loading namespace ${y} for language ${d} failed`,x),!x&&i&&this.logger.log(`${o}loaded namespace ${y} for language ${d}`,i),this.loaded(n,x,i)})}saveMissing(n,o,c,d,y){var I,R,k,N,U;let x=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if((R=(I=this.services)==null?void 0:I.utils)!=null&&R.hasLoadedNamespace&&!((N=(k=this.services)==null?void 0:k.utils)!=null&&N.hasLoadedNamespace(o))){this.logger.warn(`did not save key "${c}" as the namespace "${o}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(c==null||c==="")){if((U=this.backend)!=null&&U.create){const K={...x,isUpdate:y},X=this.backend.create.bind(this.backend);if(X.length<6)try{let Z;X.length===5?Z=X(n,o,c,d,K):Z=X(n,o,c,d),Z&&typeof Z.then=="function"?Z.then(J=>i(null,J)).catch(i):i(null,Z)}catch(Z){i(Z)}else X(n,o,c,d,i,K)}!n||!n[0]||this.store.addResource(n[0],o,c,d)}}}const k3=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:e=>{let n={};if(typeof e[1]=="object"&&(n=e[1]),ci(e[1])&&(n.defaultValue=e[1]),ci(e[2])&&(n.tDescription=e[2]),typeof e[2]=="object"||typeof e[3]=="object"){const o=e[3]||e[2];Object.keys(o).forEach(c=>{n[c]=o[c]})}return n},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),O3=e=>{var n,o;return ci(e.ns)&&(e.ns=[e.ns]),ci(e.fallbackLng)&&(e.fallbackLng=[e.fallbackLng]),ci(e.fallbackNS)&&(e.fallbackNS=[e.fallbackNS]),((o=(n=e.supportedLngs)==null?void 0:n.indexOf)==null?void 0:o.call(n,"cimode"))<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),typeof e.initImmediate=="boolean"&&(e.initAsync=e.initImmediate),e},p0=()=>{},TQ=e=>{Object.getOwnPropertyNames(Object.getPrototypeOf(e)).forEach(o=>{typeof e[o]=="function"&&(e[o]=e[o].bind(e))})};class Mv extends Z1{constructor(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0;if(super(),this.options=O3(n),this.services={},this.logger=xh,this.modules={external:[]},TQ(this),o&&!this.isInitialized&&!n.isClone){if(!this.options.initAsync)return this.init(n,o),this;setTimeout(()=>{this.init(n,o)},0)}}init(){var n=this;let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,typeof o=="function"&&(c=o,o={}),o.defaultNS==null&&o.ns&&(ci(o.ns)?o.defaultNS=o.ns:o.ns.indexOf("translation")<0&&(o.defaultNS=o.ns[0]));const d=k3();this.options={...d,...this.options,...O3(o)},this.options.interpolation={...d.interpolation,...this.options.interpolation},o.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=o.keySeparator),o.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=o.nsSeparator);const y=k=>k?typeof k=="function"?new k:k:null;if(!this.options.isClone){this.modules.logger?xh.init(y(this.modules.logger),this.options):xh.init(null,this.options);let k;this.modules.formatter?k=this.modules.formatter:k=wQ;const N=new R3(this.options);this.store=new I3(this.options.resources,this.options);const U=this.services;U.logger=xh,U.resourceStore=this.store,U.languageUtils=N,U.pluralResolver=new vQ(N,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),k&&(!this.options.interpolation.format||this.options.interpolation.format===d.interpolation.format)&&(U.formatter=y(k),U.formatter.init(U,this.options),this.options.interpolation.format=U.formatter.format.bind(U.formatter)),U.interpolator=new xQ(this.options),U.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},U.backendConnector=new CQ(y(this.modules.backend),U.resourceStore,U,this.options),U.backendConnector.on("*",function(K){for(var X=arguments.length,Z=new Array(X>1?X-1:0),J=1;J<X;J++)Z[J-1]=arguments[J];n.emit(K,...Z)}),this.modules.languageDetector&&(U.languageDetector=y(this.modules.languageDetector),U.languageDetector.init&&U.languageDetector.init(U,this.options.detection,this.options)),this.modules.i18nFormat&&(U.i18nFormat=y(this.modules.i18nFormat),U.i18nFormat.init&&U.i18nFormat.init(this)),this.translator=new l1(this.services,this.options),this.translator.on("*",function(K){for(var X=arguments.length,Z=new Array(X>1?X-1:0),J=1;J<X;J++)Z[J-1]=arguments[J];n.emit(K,...Z)}),this.modules.external.forEach(K=>{K.init&&K.init(this)})}if(this.format=this.options.interpolation.format,c||(c=p0),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const k=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);k.length>0&&k[0]!=="dev"&&(this.options.lng=k[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(k=>{this[k]=function(){return n.store[k](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(k=>{this[k]=function(){return n.store[k](...arguments),n}});const I=Xy(),R=()=>{const k=(N,U)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),I.resolve(U),c(N,U)};if(this.languages&&!this.isInitialized)return k(null,this.t.bind(this));this.changeLanguage(this.options.lng,k)};return this.options.resources||!this.options.initAsync?R():setTimeout(R,0),I}loadResources(n){var y,x;let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:p0;const d=ci(n)?n:this.language;if(typeof n=="function"&&(c=n),!this.options.resources||this.options.partialBundledLanguages){if((d==null?void 0:d.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return c();const i=[],I=R=>{if(!R||R==="cimode")return;this.services.languageUtils.toResolveHierarchy(R).forEach(N=>{N!=="cimode"&&i.indexOf(N)<0&&i.push(N)})};d?I(d):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(k=>I(k)),(x=(y=this.options.preload)==null?void 0:y.forEach)==null||x.call(y,R=>I(R)),this.services.backendConnector.load(i,this.options.ns,R=>{!R&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),c(R)})}else c(null)}reloadResources(n,o,c){const d=Xy();return typeof n=="function"&&(c=n,n=void 0),typeof o=="function"&&(c=o,o=void 0),n||(n=this.languages),o||(o=this.options.ns),c||(c=p0),this.services.backendConnector.reload(n,o,y=>{d.resolve(),c(y)}),d}use(n){if(!n)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!n.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return n.type==="backend"&&(this.modules.backend=n),(n.type==="logger"||n.log&&n.warn&&n.error)&&(this.modules.logger=n),n.type==="languageDetector"&&(this.modules.languageDetector=n),n.type==="i18nFormat"&&(this.modules.i18nFormat=n),n.type==="postProcessor"&&UF.addPostProcessor(n),n.type==="formatter"&&(this.modules.formatter=n),n.type==="3rdParty"&&this.modules.external.push(n),this}setResolvedLanguage(n){if(!(!n||!this.languages)&&!(["cimode","dev"].indexOf(n)>-1)){for(let o=0;o<this.languages.length;o++){const c=this.languages[o];if(!(["cimode","dev"].indexOf(c)>-1)&&this.store.hasLanguageSomeTranslations(c)){this.resolvedLanguage=c;break}}!this.resolvedLanguage&&this.languages.indexOf(n)<0&&this.store.hasLanguageSomeTranslations(n)&&(this.resolvedLanguage=n,this.languages.unshift(n))}}changeLanguage(n,o){var c=this;this.isLanguageChangingTo=n;const d=Xy();this.emit("languageChanging",n);const y=I=>{this.language=I,this.languages=this.services.languageUtils.toResolveHierarchy(I),this.resolvedLanguage=void 0,this.setResolvedLanguage(I)},x=(I,R)=>{R?this.isLanguageChangingTo===n&&(y(R),this.translator.changeLanguage(R),this.isLanguageChangingTo=void 0,this.emit("languageChanged",R),this.logger.log("languageChanged",R)):this.isLanguageChangingTo=void 0,d.resolve(function(){return c.t(...arguments)}),o&&o(I,function(){return c.t(...arguments)})},i=I=>{var N,U;!n&&!I&&this.services.languageDetector&&(I=[]);const R=ci(I)?I:I&&I[0],k=this.store.hasLanguageSomeTranslations(R)?R:this.services.languageUtils.getBestMatchFromCodes(ci(I)?[I]:I);k&&(this.language||y(k),this.translator.language||this.translator.changeLanguage(k),(U=(N=this.services.languageDetector)==null?void 0:N.cacheUserLanguage)==null||U.call(N,k)),this.loadResources(k,K=>{x(K,k)})};return!n&&this.services.languageDetector&&!this.services.languageDetector.async?i(this.services.languageDetector.detect()):!n&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(i):this.services.languageDetector.detect(i):i(n),d}getFixedT(n,o,c){var d=this;const y=function(x,i){let I;if(typeof i!="object"){for(var R=arguments.length,k=new Array(R>2?R-2:0),N=2;N<R;N++)k[N-2]=arguments[N];I=d.options.overloadTranslationOptionHandler([x,i].concat(k))}else I={...i};I.lng=I.lng||y.lng,I.lngs=I.lngs||y.lngs,I.ns=I.ns||y.ns,I.keyPrefix!==""&&(I.keyPrefix=I.keyPrefix||c||y.keyPrefix);const U=d.options.keySeparator||".";let K;return I.keyPrefix&&Array.isArray(x)?K=x.map(X=>`${I.keyPrefix}${U}${X}`):K=I.keyPrefix?`${I.keyPrefix}${U}${x}`:x,d.t(K,I)};return ci(n)?y.lng=n:y.lngs=n,y.ns=o,y.keyPrefix=c,y}t(){var d;for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(d=this.translator)==null?void 0:d.translate(...o)}exists(){var d;for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(d=this.translator)==null?void 0:d.exists(...o)}setDefaultNamespace(n){this.options.defaultNS=n}hasLoadedNamespace(n){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const c=o.lng||this.resolvedLanguage||this.languages[0],d=this.options?this.options.fallbackLng:!1,y=this.languages[this.languages.length-1];if(c.toLowerCase()==="cimode")return!0;const x=(i,I)=>{const R=this.services.backendConnector.state[`${i}|${I}`];return R===-1||R===0||R===2};if(o.precheck){const i=o.precheck(this,x);if(i!==void 0)return i}return!!(this.hasResourceBundle(c,n)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||x(c,n)&&(!d||x(y,n)))}loadNamespaces(n,o){const c=Xy();return this.options.ns?(ci(n)&&(n=[n]),n.forEach(d=>{this.options.ns.indexOf(d)<0&&this.options.ns.push(d)}),this.loadResources(d=>{c.resolve(),o&&o(d)}),c):(o&&o(),Promise.resolve())}loadLanguages(n,o){const c=Xy();ci(n)&&(n=[n]);const d=this.options.preload||[],y=n.filter(x=>d.indexOf(x)<0&&this.services.languageUtils.isSupportedCode(x));return y.length?(this.options.preload=d.concat(y),this.loadResources(x=>{c.resolve(),o&&o(x)}),c):(o&&o(),Promise.resolve())}dir(n){var d,y;if(n||(n=this.resolvedLanguage||(((d=this.languages)==null?void 0:d.length)>0?this.languages[0]:this.language)),!n)return"rtl";const o=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],c=((y=this.services)==null?void 0:y.languageUtils)||new R3(k3());return o.indexOf(c.getLanguagePartFromCode(n))>-1||n.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0;return new Mv(n,o)}cloneInstance(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:p0;const c=n.forkResourceStore;c&&delete n.forkResourceStore;const d={...this.options,...n,isClone:!0},y=new Mv(d);if((n.debug!==void 0||n.prefix!==void 0)&&(y.logger=y.logger.clone(n)),["store","services","language"].forEach(i=>{y[i]=this[i]}),y.services={...this.services},y.services.utils={hasLoadedNamespace:y.hasLoadedNamespace.bind(y)},c){const i=Object.keys(this.store.data).reduce((I,R)=>(I[R]={...this.store.data[R]},I[R]=Object.keys(I[R]).reduce((k,N)=>(k[N]={...I[R][N]},k),I[R]),I),{});y.store=new I3(i,d),y.services.resourceStore=y.store}return y.translator=new l1(y.services,d),y.translator.on("*",function(i){for(var I=arguments.length,R=new Array(I>1?I-1:0),k=1;k<I;k++)R[k-1]=arguments[k];y.emit(i,...R)}),y.init(d,o),y.translator.options=d,y.translator.backendConnector.services.utils={hasLoadedNamespace:y.hasLoadedNamespace.bind(y)},y}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Xa=Mv.createInstance();Xa.createInstance=Mv.createInstance;Xa.createInstance;Xa.dir;Xa.init;Xa.loadResources;Xa.reloadResources;Xa.use;Xa.changeLanguage;Xa.getFixedT;Xa.t;Xa.exists;Xa.setDefaultNamespace;Xa.hasLoadedNamespace;Xa.loadNamespaces;Xa.loadLanguages;const{slice:EQ,forEach:IQ}=[];function PQ(e){return IQ.call(EQ.call(arguments,1),n=>{if(n)for(const o in n)e[o]===void 0&&(e[o]=n[o])}),e}function AQ(e){return typeof e!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(o=>o.test(e))}const z3=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,RQ=function(e,n){const c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},d=encodeURIComponent(n);let y=`${e}=${d}`;if(c.maxAge>0){const x=c.maxAge-0;if(Number.isNaN(x))throw new Error("maxAge should be a Number");y+=`; Max-Age=${Math.floor(x)}`}if(c.domain){if(!z3.test(c.domain))throw new TypeError("option domain is invalid");y+=`; Domain=${c.domain}`}if(c.path){if(!z3.test(c.path))throw new TypeError("option path is invalid");y+=`; Path=${c.path}`}if(c.expires){if(typeof c.expires.toUTCString!="function")throw new TypeError("option expires is invalid");y+=`; Expires=${c.expires.toUTCString()}`}if(c.httpOnly&&(y+="; HttpOnly"),c.secure&&(y+="; Secure"),c.sameSite)switch(typeof c.sameSite=="string"?c.sameSite.toLowerCase():c.sameSite){case!0:y+="; SameSite=Strict";break;case"lax":y+="; SameSite=Lax";break;case"strict":y+="; SameSite=Strict";break;case"none":y+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return c.partitioned&&(y+="; Partitioned"),y},F3={create(e,n,o,c){let d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};o&&(d.expires=new Date,d.expires.setTime(d.expires.getTime()+o*60*1e3)),c&&(d.domain=c),document.cookie=RQ(e,encodeURIComponent(n),d)},read(e){const n=`${e}=`,o=document.cookie.split(";");for(let c=0;c<o.length;c++){let d=o[c];for(;d.charAt(0)===" ";)d=d.substring(1,d.length);if(d.indexOf(n)===0)return d.substring(n.length,d.length)}return null},remove(e){this.create(e,"",-1)}};var MQ={name:"cookie",lookup(e){let{lookupCookie:n}=e;if(n&&typeof document<"u")return F3.read(n)||void 0},cacheUserLanguage(e,n){let{lookupCookie:o,cookieMinutes:c,cookieDomain:d,cookieOptions:y}=n;o&&typeof document<"u"&&F3.create(o,e,c,d,y)}},LQ={name:"querystring",lookup(e){var c;let{lookupQuerystring:n}=e,o;if(typeof window<"u"){let{search:d}=window.location;!window.location.search&&((c=window.location.hash)==null?void 0:c.indexOf("?"))>-1&&(d=window.location.hash.substring(window.location.hash.indexOf("?")));const x=d.substring(1).split("&");for(let i=0;i<x.length;i++){const I=x[i].indexOf("=");I>0&&x[i].substring(0,I)===n&&(o=x[i].substring(I+1))}}return o}};let e_=null;const N3=()=>{if(e_!==null)return e_;try{if(e_=typeof window<"u"&&window.localStorage!==null,!e_)return!1;const e="i18next.translate.boo";window.localStorage.setItem(e,"foo"),window.localStorage.removeItem(e)}catch{e_=!1}return e_};var DQ={name:"localStorage",lookup(e){let{lookupLocalStorage:n}=e;if(n&&N3())return window.localStorage.getItem(n)||void 0},cacheUserLanguage(e,n){let{lookupLocalStorage:o}=n;o&&N3()&&window.localStorage.setItem(o,e)}};let t_=null;const j3=()=>{if(t_!==null)return t_;try{if(t_=typeof window<"u"&&window.sessionStorage!==null,!t_)return!1;const e="i18next.translate.boo";window.sessionStorage.setItem(e,"foo"),window.sessionStorage.removeItem(e)}catch{t_=!1}return t_};var kQ={name:"sessionStorage",lookup(e){let{lookupSessionStorage:n}=e;if(n&&j3())return window.sessionStorage.getItem(n)||void 0},cacheUserLanguage(e,n){let{lookupSessionStorage:o}=n;o&&j3()&&window.sessionStorage.setItem(o,e)}},OQ={name:"navigator",lookup(e){const n=[];if(typeof navigator<"u"){const{languages:o,userLanguage:c,language:d}=navigator;if(o)for(let y=0;y<o.length;y++)n.push(o[y]);c&&n.push(c),d&&n.push(d)}return n.length>0?n:void 0}},zQ={name:"htmlTag",lookup(e){let{htmlTag:n}=e,o;const c=n||(typeof document<"u"?document.documentElement:null);return c&&typeof c.getAttribute=="function"&&(o=c.getAttribute("lang")),o}},FQ={name:"path",lookup(e){var d;let{lookupFromPathIndex:n}=e;if(typeof window>"u")return;const o=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(o)?(d=o[typeof n=="number"?n:0])==null?void 0:d.replace("/",""):void 0}},NQ={name:"subdomain",lookup(e){var d,y;let{lookupFromSubdomainIndex:n}=e;const o=typeof n=="number"?n+1:1,c=typeof window<"u"&&((y=(d=window.location)==null?void 0:d.hostname)==null?void 0:y.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i));if(c)return c[o]}};let $F=!1;try{document.cookie,$F=!0}catch{}const HF=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];$F||HF.splice(1,1);const jQ=()=>({order:HF,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:e=>e});class GF{constructor(n){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(n,o)}init(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=n,this.options=PQ(o,this.options||{},jQ()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=d=>d.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=c,this.addDetector(MQ),this.addDetector(LQ),this.addDetector(DQ),this.addDetector(kQ),this.addDetector(OQ),this.addDetector(zQ),this.addDetector(FQ),this.addDetector(NQ)}addDetector(n){return this.detectors[n.name]=n,this}detect(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,o=[];return n.forEach(c=>{if(this.detectors[c]){let d=this.detectors[c].lookup(this.options);d&&typeof d=="string"&&(d=[d]),d&&(o=o.concat(d))}}),o=o.filter(c=>c!=null&&!AQ(c)).map(c=>this.options.convertDetectedLanguage(c)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?o:o.length>0?o[0]:null}cacheUserLanguage(n){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;o&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(n)>-1||o.forEach(c=>{this.detectors[c]&&this.detectors[c].cacheUserLanguage(n,this.options)}))}}GF.type="languageDetector";function AS(e){"@babel/helpers - typeof";return AS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},AS(e)}function WF(){return typeof XMLHttpRequest=="function"||(typeof XMLHttpRequest>"u"?"undefined":AS(XMLHttpRequest))==="object"}function BQ(e){return!!e&&typeof e.then=="function"}function VQ(e){return BQ(e)?e:Promise.resolve(e)}const UQ="modulepreload",$Q=function(e){return"/"+e},B3={},HQ=function(n,o,c){let d=Promise.resolve();if(o&&o.length>0){let x=function(R){return Promise.all(R.map(k=>Promise.resolve(k).then(N=>({status:"fulfilled",value:N}),N=>({status:"rejected",reason:N}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),I=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));d=x(o.map(R=>{if(R=$Q(R),R in B3)return;B3[R]=!0;const k=R.endsWith(".css"),N=k?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${R}"]${N}`))return;const U=document.createElement("link");if(U.rel=k?"stylesheet":UQ,k||(U.as="script"),U.crossOrigin="",U.href=R,I&&U.setAttribute("nonce",I),document.head.appendChild(U),k)return new Promise((K,X)=>{U.addEventListener("load",K),U.addEventListener("error",()=>X(new Error(`Unable to preload CSS for ${R}`)))})}))}function y(x){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=x,window.dispatchEvent(i),!i.defaultPrevented)throw x}return d.then(x=>{for(const i of x||[])i.status==="rejected"&&y(i.reason);return n().catch(y)})};function V3(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);n&&(c=c.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),o.push.apply(o,c)}return o}function U3(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{};n%2?V3(Object(o),!0).forEach(function(c){GQ(e,c,o[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):V3(Object(o)).forEach(function(c){Object.defineProperty(e,c,Object.getOwnPropertyDescriptor(o,c))})}return e}function GQ(e,n,o){return(n=WQ(n))in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function WQ(e){var n=qQ(e,"string");return dg(n)=="symbol"?n:n+""}function qQ(e,n){if(dg(e)!="object"||!e)return e;var o=e[Symbol.toPrimitive];if(o!==void 0){var c=o.call(e,n);if(dg(c)!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function dg(e){"@babel/helpers - typeof";return dg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},dg(e)}var Zp=typeof fetch=="function"?fetch:void 0;typeof global<"u"&&global.fetch?Zp=global.fetch:typeof window<"u"&&window.fetch&&(Zp=window.fetch);var Lv;WF()&&(typeof global<"u"&&global.XMLHttpRequest?Lv=global.XMLHttpRequest:typeof window<"u"&&window.XMLHttpRequest&&(Lv=window.XMLHttpRequest));var c1;typeof ActiveXObject=="function"&&(typeof global<"u"&&global.ActiveXObject?c1=global.ActiveXObject:typeof window<"u"&&window.ActiveXObject&&(c1=window.ActiveXObject));typeof Zp!="function"&&(Zp=void 0);if(!Zp&&!Lv&&!c1)try{HQ(()=>import("./browser-ponyfill-CFLQqOwN.js").then(e=>e.b),[]).then(function(e){Zp=e.default}).catch(function(){})}catch{}var RS=function(n,o){if(o&&dg(o)==="object"){var c="";for(var d in o)c+="&"+encodeURIComponent(d)+"="+encodeURIComponent(o[d]);if(!c)return n;n=n+(n.indexOf("?")!==-1?"&":"?")+c.slice(1)}return n},$3=function(n,o,c,d){var y=function(I){if(!I.ok)return c(I.statusText||"Error",{status:I.status});I.text().then(function(R){c(null,{status:I.status,data:R})}).catch(c)};if(d){var x=d(n,o);if(x instanceof Promise){x.then(y).catch(c);return}}typeof fetch=="function"?fetch(n,o).then(y).catch(c):Zp(n,o).then(y).catch(c)},H3=!1,ZQ=function(n,o,c,d){n.queryStringParams&&(o=RS(o,n.queryStringParams));var y=U3({},typeof n.customHeaders=="function"?n.customHeaders():n.customHeaders);typeof window>"u"&&typeof global<"u"&&typeof global.process<"u"&&global.process.versions&&global.process.versions.node&&(y["User-Agent"]="i18next-http-backend (node/".concat(global.process.version,"; ").concat(global.process.platform," ").concat(global.process.arch,")")),c&&(y["Content-Type"]="application/json");var x=typeof n.requestOptions=="function"?n.requestOptions(c):n.requestOptions,i=U3({method:c?"POST":"GET",body:c?n.stringify(c):void 0,headers:y},H3?{}:x),I=typeof n.alternateFetch=="function"&&n.alternateFetch.length>=1?n.alternateFetch:void 0;try{$3(o,i,d,I)}catch(R){if(!x||Object.keys(x).length===0||!R.message||R.message.indexOf("not implemented")<0)return d(R);try{Object.keys(x).forEach(function(k){delete i[k]}),$3(o,i,d,I),H3=!0}catch(k){d(k)}}},XQ=function(n,o,c,d){c&&dg(c)==="object"&&(c=RS("",c).slice(1)),n.queryStringParams&&(o=RS(o,n.queryStringParams));try{var y=Lv?new Lv:new c1("MSXML2.XMLHTTP.3.0");y.open(c?"POST":"GET",o,1),n.crossDomain||y.setRequestHeader("X-Requested-With","XMLHttpRequest"),y.withCredentials=!!n.withCredentials,c&&y.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),y.overrideMimeType&&y.overrideMimeType("application/json");var x=n.customHeaders;if(x=typeof x=="function"?x():x,x)for(var i in x)y.setRequestHeader(i,x[i]);y.onreadystatechange=function(){y.readyState>3&&d(y.status>=400?y.statusText:null,{status:y.status,data:y.responseText})},y.send(c)}catch(I){console&&console.log(I)}},KQ=function(n,o,c,d){if(typeof c=="function"&&(d=c,c=void 0),d=d||function(){},Zp&&o.indexOf("file:")!==0)return ZQ(n,o,c,d);if(WF()||typeof ActiveXObject=="function")return XQ(n,o,c,d);d(new Error("No fetch and no xhr implementation found!"))};function P_(e){"@babel/helpers - typeof";return P_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},P_(e)}function G3(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);n&&(c=c.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),o.push.apply(o,c)}return o}function g2(e){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?arguments[n]:{};n%2?G3(Object(o),!0).forEach(function(c){qF(e,c,o[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):G3(Object(o)).forEach(function(c){Object.defineProperty(e,c,Object.getOwnPropertyDescriptor(o,c))})}return e}function YQ(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function JQ(e,n){for(var o=0;o<n.length;o++){var c=n[o];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(e,ZF(c.key),c)}}function QQ(e,n,o){return n&&JQ(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function qF(e,n,o){return(n=ZF(n))in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function ZF(e){var n=eee(e,"string");return P_(n)=="symbol"?n:n+""}function eee(e,n){if(P_(e)!="object"||!e)return e;var o=e[Symbol.toPrimitive];if(o!==void 0){var c=o.call(e,n);if(P_(c)!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var tee=function(){return{loadPath:"/locales/{{lng}}/{{ns}}.json",addPath:"/locales/add/{{lng}}/{{ns}}",parse:function(o){return JSON.parse(o)},stringify:JSON.stringify,parsePayload:function(o,c,d){return qF({},c,d||"")},parseLoadPayload:function(o,c){},request:KQ,reloadInterval:typeof window<"u"?!1:60*60*1e3,customHeaders:{},queryStringParams:{},crossDomain:!1,withCredentials:!1,overrideMimeType:!1,requestOptions:{mode:"cors",credentials:"same-origin",cache:"default"}}},XF=function(){function e(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};YQ(this,e),this.services=n,this.options=o,this.allOptions=c,this.type="backend",this.init(n,o,c)}return QQ(e,[{key:"init",value:function(o){var c=this,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this.services=o,this.options=g2(g2(g2({},tee()),this.options||{}),d),this.allOptions=y,this.services&&this.options.reloadInterval){var x=setInterval(function(){return c.reload()},this.options.reloadInterval);P_(x)==="object"&&typeof x.unref=="function"&&x.unref()}}},{key:"readMulti",value:function(o,c,d){this._readAny(o,o,c,c,d)}},{key:"read",value:function(o,c,d){this._readAny([o],o,[c],c,d)}},{key:"_readAny",value:function(o,c,d,y,x){var i=this,I=this.options.loadPath;typeof this.options.loadPath=="function"&&(I=this.options.loadPath(o,d)),I=VQ(I),I.then(function(R){if(!R)return x(null,{});var k=i.services.interpolator.interpolate(R,{lng:o.join("+"),ns:d.join("+")});i.loadUrl(k,x,c,y)})}},{key:"loadUrl",value:function(o,c,d,y){var x=this,i=typeof d=="string"?[d]:d,I=typeof y=="string"?[y]:y,R=this.options.parseLoadPayload(i,I);this.options.request(this.options,o,R,function(k,N){if(N&&(N.status>=500&&N.status<600||!N.status))return c("failed loading "+o+"; status code: "+N.status,!0);if(N&&N.status>=400&&N.status<500)return c("failed loading "+o+"; status code: "+N.status,!1);if(!N&&k&&k.message){var U=k.message.toLowerCase(),K=["failed","fetch","network","load"].find(function(J){return U.indexOf(J)>-1});if(K)return c("failed loading "+o+": "+k.message,!0)}if(k)return c(k,!1);var X,Z;try{typeof N.data=="string"?X=x.options.parse(N.data,d,y):X=N.data}catch{Z="failed parsing "+o+" to json"}if(Z)return c(Z,!1);c(null,X)})}},{key:"create",value:function(o,c,d,y,x){var i=this;if(this.options.addPath){typeof o=="string"&&(o=[o]);var I=this.options.parsePayload(c,d,y),R=0,k=[],N=[];o.forEach(function(U){var K=i.options.addPath;typeof i.options.addPath=="function"&&(K=i.options.addPath(U,c));var X=i.services.interpolator.interpolate(K,{lng:U,ns:c});i.options.request(i.options,X,I,function(Z,J){R+=1,k.push(Z),N.push(J),R===o.length&&typeof x=="function"&&x(k,N)})})}}},{key:"reload",value:function(){var o=this,c=this.services,d=c.backendConnector,y=c.languageUtils,x=c.logger,i=d.language;if(!(i&&i.toLowerCase()==="cimode")){var I=[],R=function(N){var U=y.toResolveHierarchy(N);U.forEach(function(K){I.indexOf(K)<0&&I.push(K)})};R(i),this.allOptions.preload&&this.allOptions.preload.forEach(function(k){return R(k)}),I.forEach(function(k){o.allOptions.ns.forEach(function(N){d.read(k,N,"read",null,null,function(U,K){U&&x.warn("loading namespace ".concat(N," for language ").concat(k," failed"),U),!U&&K&&x.log("loaded namespace ".concat(N," for language ").concat(k),K),d.loaded("".concat(k,"|").concat(N),U,K)})})})}}}])}();XF.type="backend";Xa.use(XF).use(GF).use(CZ).init({fallbackLng:"fr",debug:!1,interpolation:{escapeValue:!1},detection:{order:["localStorage","navigator"],lookupLocalStorage:"language"},backend:{loadPath:"/locales/{{lng}}/translation.json"}});const KF=V.createContext(),nee=({children:e})=>{const n=ml(),{isLoggedIn:o,userData:c,setUserData:d}=Ih(),{updateAllOwnedCatsAddress:y}=W_(),[x,i]=V.useState({firstName:"",lastName:"",address:"",city:"",postalCode:"",latitude:null,longitude:null,gender:"",birthDay:"",phone:""}),[I,R]=V.useState({currentPassword:"",newPassword:"",matchingPassword:""}),[k,N]=V.useState([]),[U,K]=V.useState(!1),[X,Z]=V.useState(!1),[J,le]=V.useState(!0),[de,ue]=V.useState(!1),[pe,he]=V.useState(""),xe=V.useCallback(async()=>{var Ue,Ge,at,yt,tt;if(!o||!sessionStorage.getItem("token")){le(!1);return}try{le(!0);const Rt=await n.get("users/me");i({firstName:Rt.firstName||"",lastName:Rt.lastName||"",address:((Ue=Rt.address)==null?void 0:Ue.address)||"",city:((Ge=Rt.address)==null?void 0:Ge.city)||"",postalCode:((at=Rt.address)==null?void 0:at.postalCode)||"",latitude:((yt=Rt.address)==null?void 0:yt.latitude)||null,longitude:((tt=Rt.address)==null?void 0:tt.longitude)||null,gender:Rt.gender||"",birthDay:Rt.birthDay||"",phone:Rt.phone||""}),d&&d(Rt)}catch{he("Erreur lors du chargement des donnes utilisateur")}finally{le(!1)}},[n,o,d]);V.useEffect(()=>{o&&xe()},[o,xe]);const fe=V.useCallback(async Ue=>{if(!o)return!1;try{he(""),ue(!1);const Ge={firstName:Ue.firstName,lastName:Ue.lastName,gender:Ue.gender,birthDay:Ue.birthDay,phone:Ue.phone,address:Ue.address,city:Ue.city,postalCode:Ue.postalCode,latitude:Ue.latitude,longitude:Ue.longitude};return await n.put("users/update",Ge),i(Ue),d&&d({...c,...Ge}),ue(!0),setTimeout(()=>{ue(!1)},3e3),!0}catch{return he("Erreur lors de la mise  jour du profil. Veuillez ressayer."),!1}},[n,o,c,d]),_e=V.useCallback(async Ue=>{if(!o)return!1;try{if(he(""),ue(!1),Ue.newPassword!==Ue.matchingPassword)return he("Les mots de passe ne correspondent pas"),!1;const Ge={currentPassword:Ue.currentPassword,newPassword:Ue.newPassword,matchingPassword:Ue.matchingPassword};return await n.put("users/update-password",Ge),R({currentPassword:"",newPassword:"",matchingPassword:""}),ue(!0),setTimeout(()=>{sessionStorage.removeItem("token"),sessionStorage.removeItem("userData"),window.location.href="/login"},2e3),!0}catch{return he("Erreur lors de la mise  jour du mot de passe. Veuillez vrifier votre mot de passe actuel."),!1}},[n,o]),Ce=V.useCallback(async()=>{if(!o)return!1;try{return await n.delete(`users/delete?id=${c.userId}`),sessionStorage.removeItem("token"),sessionStorage.removeItem("userData"),!0}catch(Ue){if(Ue.response){const{status:Ge,data:at}=Ue.response;Ge===500?(console.error("Erreur serveur lors de la suppression du compte:",Ue),he("Impossible de supprimer votre compte car vous avez des donnes associes actives. Veuillez d'abord supprimer tous vos chats et annuler toutes les demandes de liaison avant de supprimer votre compte.")):he(Ge===404?"Compte utilisateur non trouv.":at||"Erreur lors de la suppression du compte. Veuillez ressayer plus tard.")}else console.error("Erreur lors de la suppression du compte:",Ue),he("Erreur de connexion. Veuillez vrifier votre connexion internet et ressayer.");return!1}},[n,o,c]),je=V.useCallback(async(Ue=!1)=>{if(o&&!(X&&!Ue))try{K(!0);const Ge=await n.get("/ecommerce/orders"),at=c==null?void 0:c.id,yt=Array.isArray(Ge)?Ge.filter(tt=>tt.userId===at||tt.user&&tt.user.id===at):[];N(yt),Z(!0)}catch{}finally{K(!1)}},[n,o,X,c]);V.useEffect(()=>{o&&(c!=null&&c.id)&&je(!0)},[o,c==null?void 0:c.id,je]);const He=V.useCallback(async(Ue,Ge)=>{try{const at=await U_(Ue,Ge);return i(yt=>({...yt,longitude:Ue,latitude:Ge,address:(at==null?void 0:at.address)||yt.address,city:(at==null?void 0:at.city)||yt.city,postalCode:(at==null?void 0:at.postalCode)||yt.postalCode})),!0}catch{return!1}},[]),lt=V.useCallback(Ue=>{i(Ge=>({...Ge,address:Ue.address||Ge.address,city:Ue.city||Ge.city,postalCode:Ue.postalCode||Ge.postalCode,latitude:Ue.latitude||Ge.latitude,longitude:Ue.longitude||Ge.longitude}))},[]),_t={profileData:x,setProfileData:i,passwordForm:I,setPasswordForm:R,orders:k,ordersLoading:U,loading:J,updateSuccess:de,updateError:pe,fetchProfileData:xe,updateProfile:fe,updatePassword:_e,deleteAccount:Ce,fetchOrders:je,updateLocationFromCoordinates:He,updateAddressData:lt,setUpdateError:he,setUpdateSuccess:ue};return T.jsx(KF.Provider,{value:_t,children:e})},ree=()=>{const e=V.useContext(KF);if(!e)throw new Error("useUserContext must be used within a UserProvider");return e},Dv={black:"#000",white:"#fff"},n_={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},r_={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},i_={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},s_={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},o_={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"},Ky={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},iee={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"};function hg(e){let n="https://mui.com/production-error/?code="+e;for(let o=1;o<arguments.length;o+=1)n+="&args[]="+encodeURIComponent(arguments[o]);return"Minified MUI error #"+e+"; visit "+n+" for the full message."}const see=Object.freeze(Object.defineProperty({__proto__:null,default:hg},Symbol.toStringTag,{value:"Module"})),X1="$$material";var oee=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,aee=q4(function(e){return oee.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),lee=aee,cee=function(n){return n!=="theme"},W3=function(n){return typeof n=="string"&&n.charCodeAt(0)>96?lee:cee},q3=function(n,o,c){var d;if(o){var y=o.shouldForwardProp;d=n.__emotion_forwardProp&&y?function(x){return n.__emotion_forwardProp(x)&&y(x)}:y}return typeof d!="function"&&c&&(d=n.__emotion_forwardProp),d},uee=function(n){var o=n.cache,c=n.serialized,d=n.isStringTag;return nT(o,c,d),Q4(function(){return rT(o,c,d)}),null},dee=function e(n,o){var c=n.__emotion_real===n,d=c&&n.__emotion_base||n,y,x;o!==void 0&&(y=o.label,x=o.target);var i=q3(n,o,c),I=i||W3(d),R=!I("as");return function(){var k=arguments,N=c&&n.__emotion_styles!==void 0?n.__emotion_styles.slice(0):[];if(y!==void 0&&N.push("label:"+y+";"),k[0]==null||k[0].raw===void 0)N.push.apply(N,k);else{var U=k[0];N.push(U[0]);for(var K=k.length,X=1;X<K;X++)N.push(k[X],U[X])}var Z=iT(function(J,le,de){var ue=R&&J.as||d,pe="",he=[],xe=J;if(J.theme==null){xe={};for(var fe in J)xe[fe]=J[fe];xe.theme=V.useContext(Yv)}typeof J.className=="string"?pe=K4(le.registered,he,J.className):J.className!=null&&(pe=J.className+" ");var _e=G1(N.concat(he),le.registered,xe);pe+=le.key+"-"+_e.name,x!==void 0&&(pe+=" "+x);var Ce=R&&i===void 0?W3(ue):I,je={};for(var He in J)R&&He==="as"||Ce(He)&&(je[He]=J[He]);return je.className=pe,de&&(je.ref=de),V.createElement(V.Fragment,null,V.createElement(uee,{cache:le,serialized:_e,isStringTag:typeof ue=="string"}),V.createElement(ue,je))});return Z.displayName=y!==void 0?y:"Styled("+(typeof d=="string"?d:d.displayName||d.name||"Component")+")",Z.defaultProps=n.defaultProps,Z.__emotion_real=Z,Z.__emotion_base=d,Z.__emotion_styles=N,Z.__emotion_forwardProp=i,Object.defineProperty(Z,"toString",{value:function(){return"."+x}}),Z.withComponent=function(J,le){var de=e(J,nt({},o,le,{shouldForwardProp:q3(Z,le,!0)}));return de.apply(void 0,N)},Z}},hee=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],MS=dee.bind(null);hee.forEach(function(e){MS[e]=MS(e)});let LS;typeof document=="object"&&(LS=X4({key:"css",prepend:!0}));function fee(e){const{injectFirst:n,children:o}=e;return n&&LS?T.jsx($X,{value:LS,children:o}):o}function pee(e){return e==null||Object.keys(e).length===0}function YF(e){const{styles:n,defaultTheme:o={}}=e,c=typeof n=="function"?d=>n(pee(d)?o:d):n;return T.jsx(ZX,{styles:c})}function JF(e,n){return MS(e,n)}const mee=(e,n)=>{Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=n(e.__emotion_styles))},gee=Object.freeze(Object.defineProperty({__proto__:null,GlobalStyles:YF,StyledEngineProvider:fee,ThemeContext:Yv,css:G_,default:JF,internal_processStyles:mee,keyframes:vg},Symbol.toStringTag,{value:"Module"}));function Fp(e){if(typeof e!="object"||e===null)return!1;const n=Object.getPrototypeOf(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function QF(e){if(V.isValidElement(e)||!Fp(e))return e;const n={};return Object.keys(e).forEach(o=>{n[o]=QF(e[o])}),n}function Dc(e,n,o={clone:!0}){const c=o.clone?nt({},e):e;return Fp(e)&&Fp(n)&&Object.keys(n).forEach(d=>{V.isValidElement(n[d])?c[d]=n[d]:Fp(n[d])&&Object.prototype.hasOwnProperty.call(e,d)&&Fp(e[d])?c[d]=Dc(e[d],n[d],o):o.clone?c[d]=Fp(n[d])?QF(n[d]):n[d]:c[d]=n[d]}),c}const _ee=Object.freeze(Object.defineProperty({__proto__:null,default:Dc,isPlainObject:Fp},Symbol.toStringTag,{value:"Module"})),yee=["values","unit","step"],vee=e=>{const n=Object.keys(e).map(o=>({key:o,val:e[o]}))||[];return n.sort((o,c)=>o.val-c.val),n.reduce((o,c)=>nt({},o,{[c.key]:c.val}),{})};function e5(e){const{values:n={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:o="px",step:c=5}=e,d=jr(e,yee),y=vee(n),x=Object.keys(y);function i(U){return`@media (min-width:${typeof n[U]=="number"?n[U]:U}${o})`}function I(U){return`@media (max-width:${(typeof n[U]=="number"?n[U]:U)-c/100}${o})`}function R(U,K){const X=x.indexOf(K);return`@media (min-width:${typeof n[U]=="number"?n[U]:U}${o}) and (max-width:${(X!==-1&&typeof n[x[X]]=="number"?n[x[X]]:K)-c/100}${o})`}function k(U){return x.indexOf(U)+1<x.length?R(U,x[x.indexOf(U)+1]):i(U)}function N(U){const K=x.indexOf(U);return K===0?i(x[1]):K===x.length-1?I(x[K]):R(U,x[x.indexOf(U)+1]).replace("@media","@media not all and")}return nt({keys:x,values:y,up:i,down:I,between:R,only:k,not:N,unit:o},d)}const xee={borderRadius:4};function pv(e,n){return n?Dc(e,n,{clone:!1}):e}const pT={xs:0,sm:600,md:900,lg:1200,xl:1536},Z3={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${pT[e]}px)`};function Lf(e,n,o){const c=e.theme||{};if(Array.isArray(n)){const y=c.breakpoints||Z3;return n.reduce((x,i,I)=>(x[y.up(y.keys[I])]=o(n[I]),x),{})}if(typeof n=="object"){const y=c.breakpoints||Z3;return Object.keys(n).reduce((x,i)=>{if(Object.keys(y.values||pT).indexOf(i)!==-1){const I=y.up(i);x[I]=o(n[i],i)}else{const I=i;x[I]=n[I]}return x},{})}return o(n)}function bee(e={}){var n;return((n=e.keys)==null?void 0:n.reduce((c,d)=>{const y=e.up(d);return c[y]={},c},{}))||{}}function wee(e,n){return e.reduce((o,c)=>{const d=o[c];return(!d||Object.keys(d).length===0)&&delete o[c],o},n)}function qr(e){if(typeof e!="string")throw new Error(hg(7));return e.charAt(0).toUpperCase()+e.slice(1)}const See=Object.freeze(Object.defineProperty({__proto__:null,default:qr},Symbol.toStringTag,{value:"Module"}));function K1(e,n,o=!0){if(!n||typeof n!="string")return null;if(e&&e.vars&&o){const c=`vars.${n}`.split(".").reduce((d,y)=>d&&d[y]?d[y]:null,e);if(c!=null)return c}return n.split(".").reduce((c,d)=>c&&c[d]!=null?c[d]:null,e)}function u1(e,n,o,c=o){let d;return typeof e=="function"?d=e(o):Array.isArray(e)?d=e[o]||c:d=K1(e,o)||c,n&&(d=n(d,c,e)),d}function Lo(e){const{prop:n,cssProperty:o=e.prop,themeKey:c,transform:d}=e,y=x=>{if(x[n]==null)return null;const i=x[n],I=x.theme,R=K1(I,c)||{};return Lf(x,i,N=>{let U=u1(R,d,N);return N===U&&typeof N=="string"&&(U=u1(R,d,`${n}${N==="default"?"":qr(N)}`,N)),o===!1?U:{[o]:U}})};return y.propTypes={},y.filterProps=[n],y}function Cee(e){const n={};return o=>(n[o]===void 0&&(n[o]=e(o)),n[o])}const Tee={m:"margin",p:"padding"},Eee={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},X3={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},Iee=Cee(e=>{if(e.length>2)if(X3[e])e=X3[e];else return[e];const[n,o]=e.split(""),c=Tee[n],d=Eee[o]||"";return Array.isArray(d)?d.map(y=>c+y):[c+d]}),mT=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],gT=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...mT,...gT];function Qv(e,n,o,c){var d;const y=(d=K1(e,n,!1))!=null?d:o;return typeof y=="number"?x=>typeof x=="string"?x:y*x:Array.isArray(y)?x=>typeof x=="string"?x:y[x]:typeof y=="function"?y:()=>{}}function t5(e){return Qv(e,"spacing",8)}function ex(e,n){if(typeof n=="string"||n==null)return n;const o=Math.abs(n),c=e(o);return n>=0?c:typeof c=="number"?-c:`-${c}`}function Pee(e,n){return o=>e.reduce((c,d)=>(c[d]=ex(n,o),c),{})}function Aee(e,n,o,c){if(n.indexOf(o)===-1)return null;const d=Iee(o),y=Pee(d,c),x=e[o];return Lf(e,x,y)}function n5(e,n){const o=t5(e.theme);return Object.keys(e).map(c=>Aee(e,n,c,o)).reduce(pv,{})}function go(e){return n5(e,mT)}go.propTypes={};go.filterProps=mT;function _o(e){return n5(e,gT)}_o.propTypes={};_o.filterProps=gT;function Ree(e=8){if(e.mui)return e;const n=t5({spacing:e}),o=(...c)=>(c.length===0?[1]:c).map(y=>{const x=n(y);return typeof x=="number"?`${x}px`:x}).join(" ");return o.mui=!0,o}function Y1(...e){const n=e.reduce((c,d)=>(d.filterProps.forEach(y=>{c[y]=d}),c),{}),o=c=>Object.keys(c).reduce((d,y)=>n[y]?pv(d,n[y](c)):d,{});return o.propTypes={},o.filterProps=e.reduce((c,d)=>c.concat(d.filterProps),[]),o}function vu(e){return typeof e!="number"?e:`${e}px solid`}function Tu(e,n){return Lo({prop:e,themeKey:"borders",transform:n})}const Mee=Tu("border",vu),Lee=Tu("borderTop",vu),Dee=Tu("borderRight",vu),kee=Tu("borderBottom",vu),Oee=Tu("borderLeft",vu),zee=Tu("borderColor"),Fee=Tu("borderTopColor"),Nee=Tu("borderRightColor"),jee=Tu("borderBottomColor"),Bee=Tu("borderLeftColor"),Vee=Tu("outline",vu),Uee=Tu("outlineColor"),J1=e=>{if(e.borderRadius!==void 0&&e.borderRadius!==null){const n=Qv(e.theme,"shape.borderRadius",4),o=c=>({borderRadius:ex(n,c)});return Lf(e,e.borderRadius,o)}return null};J1.propTypes={};J1.filterProps=["borderRadius"];Y1(Mee,Lee,Dee,kee,Oee,zee,Fee,Nee,jee,Bee,J1,Vee,Uee);const Q1=e=>{if(e.gap!==void 0&&e.gap!==null){const n=Qv(e.theme,"spacing",8),o=c=>({gap:ex(n,c)});return Lf(e,e.gap,o)}return null};Q1.propTypes={};Q1.filterProps=["gap"];const eb=e=>{if(e.columnGap!==void 0&&e.columnGap!==null){const n=Qv(e.theme,"spacing",8),o=c=>({columnGap:ex(n,c)});return Lf(e,e.columnGap,o)}return null};eb.propTypes={};eb.filterProps=["columnGap"];const tb=e=>{if(e.rowGap!==void 0&&e.rowGap!==null){const n=Qv(e.theme,"spacing",8),o=c=>({rowGap:ex(n,c)});return Lf(e,e.rowGap,o)}return null};tb.propTypes={};tb.filterProps=["rowGap"];const $ee=Lo({prop:"gridColumn"}),Hee=Lo({prop:"gridRow"}),Gee=Lo({prop:"gridAutoFlow"}),Wee=Lo({prop:"gridAutoColumns"}),qee=Lo({prop:"gridAutoRows"}),Zee=Lo({prop:"gridTemplateColumns"}),Xee=Lo({prop:"gridTemplateRows"}),Kee=Lo({prop:"gridTemplateAreas"}),Yee=Lo({prop:"gridArea"});Y1(Q1,eb,tb,$ee,Hee,Gee,Wee,qee,Zee,Xee,Kee,Yee);function m_(e,n){return n==="grey"?n:e}const Jee=Lo({prop:"color",themeKey:"palette",transform:m_}),Qee=Lo({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:m_}),ete=Lo({prop:"backgroundColor",themeKey:"palette",transform:m_});Y1(Jee,Qee,ete);function Rc(e){return e<=1&&e!==0?`${e*100}%`:e}const tte=Lo({prop:"width",transform:Rc}),_T=e=>{if(e.maxWidth!==void 0&&e.maxWidth!==null){const n=o=>{var c,d;const y=((c=e.theme)==null||(c=c.breakpoints)==null||(c=c.values)==null?void 0:c[o])||pT[o];return y?((d=e.theme)==null||(d=d.breakpoints)==null?void 0:d.unit)!=="px"?{maxWidth:`${y}${e.theme.breakpoints.unit}`}:{maxWidth:y}:{maxWidth:Rc(o)}};return Lf(e,e.maxWidth,n)}return null};_T.filterProps=["maxWidth"];const nte=Lo({prop:"minWidth",transform:Rc}),rte=Lo({prop:"height",transform:Rc}),ite=Lo({prop:"maxHeight",transform:Rc}),ste=Lo({prop:"minHeight",transform:Rc});Lo({prop:"size",cssProperty:"width",transform:Rc});Lo({prop:"size",cssProperty:"height",transform:Rc});const ote=Lo({prop:"boxSizing"});Y1(tte,_T,nte,rte,ite,ste,ote);const tx={border:{themeKey:"borders",transform:vu},borderTop:{themeKey:"borders",transform:vu},borderRight:{themeKey:"borders",transform:vu},borderBottom:{themeKey:"borders",transform:vu},borderLeft:{themeKey:"borders",transform:vu},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:vu},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:J1},color:{themeKey:"palette",transform:m_},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:m_},backgroundColor:{themeKey:"palette",transform:m_},p:{style:_o},pt:{style:_o},pr:{style:_o},pb:{style:_o},pl:{style:_o},px:{style:_o},py:{style:_o},padding:{style:_o},paddingTop:{style:_o},paddingRight:{style:_o},paddingBottom:{style:_o},paddingLeft:{style:_o},paddingX:{style:_o},paddingY:{style:_o},paddingInline:{style:_o},paddingInlineStart:{style:_o},paddingInlineEnd:{style:_o},paddingBlock:{style:_o},paddingBlockStart:{style:_o},paddingBlockEnd:{style:_o},m:{style:go},mt:{style:go},mr:{style:go},mb:{style:go},ml:{style:go},mx:{style:go},my:{style:go},margin:{style:go},marginTop:{style:go},marginRight:{style:go},marginBottom:{style:go},marginLeft:{style:go},marginX:{style:go},marginY:{style:go},marginInline:{style:go},marginInlineStart:{style:go},marginInlineEnd:{style:go},marginBlock:{style:go},marginBlockStart:{style:go},marginBlockEnd:{style:go},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:Q1},rowGap:{style:tb},columnGap:{style:eb},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Rc},maxWidth:{style:_T},minWidth:{transform:Rc},height:{transform:Rc},maxHeight:{transform:Rc},minHeight:{transform:Rc},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function ate(...e){const n=e.reduce((c,d)=>c.concat(Object.keys(d)),[]),o=new Set(n);return e.every(c=>o.size===Object.keys(c).length)}function lte(e,n){return typeof e=="function"?e(n):e}function r5(){function e(o,c,d,y){const x={[o]:c,theme:d},i=y[o];if(!i)return{[o]:c};const{cssProperty:I=o,themeKey:R,transform:k,style:N}=i;if(c==null)return null;if(R==="typography"&&c==="inherit")return{[o]:c};const U=K1(d,R)||{};return N?N(x):Lf(x,c,X=>{let Z=u1(U,k,X);return X===Z&&typeof X=="string"&&(Z=u1(U,k,`${o}${X==="default"?"":qr(X)}`,X)),I===!1?Z:{[I]:Z}})}function n(o){var c;const{sx:d,theme:y={}}=o||{};if(!d)return null;const x=(c=y.unstable_sxConfig)!=null?c:tx;function i(I){let R=I;if(typeof I=="function")R=I(y);else if(typeof I!="object")return I;if(!R)return null;const k=bee(y.breakpoints),N=Object.keys(k);let U=k;return Object.keys(R).forEach(K=>{const X=lte(R[K],y);if(X!=null)if(typeof X=="object")if(x[K])U=pv(U,e(K,X,y,x));else{const Z=Lf({theme:y},X,J=>({[K]:J}));ate(Z,X)?U[K]=n({sx:X,theme:y}):U=pv(U,Z)}else U=pv(U,e(K,X,y,x))}),wee(N,U)}return Array.isArray(d)?d.map(i):i(d)}return n}const nx=r5();nx.filterProps=["sx"];function i5(e,n){const o=this;return o.vars&&typeof o.getColorSchemeSelector=="function"?{[o.getColorSchemeSelector(e).replace(/(\[[^\]]+\])/,"*:where($1)")]:n}:o.palette.mode===e?n:{}}const cte=["breakpoints","palette","spacing","shape"];function yT(e={},...n){const{breakpoints:o={},palette:c={},spacing:d,shape:y={}}=e,x=jr(e,cte),i=e5(o),I=Ree(d);let R=Dc({breakpoints:i,direction:"ltr",components:{},palette:nt({mode:"light"},c),spacing:I,shape:nt({},xee,y)},x);return R.applyStyles=i5,R=n.reduce((k,N)=>Dc(k,N),R),R.unstable_sxConfig=nt({},tx,x==null?void 0:x.unstable_sxConfig),R.unstable_sx=function(N){return nx({sx:N,theme:this})},R}const ute=Object.freeze(Object.defineProperty({__proto__:null,default:yT,private_createBreakpoints:e5,unstable_applyStyles:i5},Symbol.toStringTag,{value:"Module"}));function dte(e){return Object.keys(e).length===0}function hte(e=null){const n=V.useContext(Yv);return!n||dte(n)?e:n}const fte=yT();function vT(e=fte){return hte(e)}function pte({styles:e,themeId:n,defaultTheme:o={}}){const c=vT(o),d=typeof e=="function"?e(n&&c[n]||c):e;return T.jsx(YF,{styles:d})}const mte=["sx"],gte=e=>{var n,o;const c={systemProps:{},otherProps:{}},d=(n=e==null||(o=e.theme)==null?void 0:o.unstable_sxConfig)!=null?n:tx;return Object.keys(e).forEach(y=>{d[y]?c.systemProps[y]=e[y]:c.otherProps[y]=e[y]}),c};function xT(e){const{sx:n}=e,o=jr(e,mte),{systemProps:c,otherProps:d}=gte(o);let y;return Array.isArray(n)?y=[c,...n]:typeof n=="function"?y=(...x)=>{const i=n(...x);return Fp(i)?nt({},c,i):c}:y=nt({},c,n),nt({},d,{sx:y})}const _te=Object.freeze(Object.defineProperty({__proto__:null,default:nx,extendSxProp:xT,unstable_createStyleFunctionSx:r5,unstable_defaultSxConfig:tx},Symbol.toStringTag,{value:"Module"})),K3=e=>e,yte=()=>{let e=K3;return{configure(n){e=n},generate(n){return e(n)},reset(){e=K3}}},s5=yte();function o5(e){var n,o,c="";if(typeof e=="string"||typeof e=="number")c+=e;else if(typeof e=="object")if(Array.isArray(e)){var d=e.length;for(n=0;n<d;n++)e[n]&&(o=o5(e[n]))&&(c&&(c+=" "),c+=o)}else for(o in e)e[o]&&(c&&(c+=" "),c+=o);return c}function pi(){for(var e,n,o=0,c="",d=arguments.length;o<d;o++)(e=arguments[o])&&(n=o5(e))&&(c&&(c+=" "),c+=n);return c}const vte=["className","component"];function xte(e={}){const{themeId:n,defaultTheme:o,defaultClassName:c="MuiBox-root",generateClassName:d}=e,y=JF("div",{shouldForwardProp:i=>i!=="theme"&&i!=="sx"&&i!=="as"})(nx);return V.forwardRef(function(I,R){const k=vT(o),N=xT(I),{className:U,component:K="div"}=N,X=jr(N,vte);return T.jsx(y,nt({as:K,ref:R,className:pi(U,d?d(c):c),theme:n&&k[n]||k},X))})}const bte={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function Ts(e,n,o="Mui"){const c=bte[n];return c?`${o}-${c}`:`${s5.generate(e)}-${n}`}function xs(e,n,o="Mui"){const c={};return n.forEach(d=>{c[d]=Ts(e,d,o)}),c}var _2={exports:{}},As={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y3;function wte(){if(Y3)return As;Y3=1;var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),c=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),y=Symbol.for("react.consumer"),x=Symbol.for("react.context"),i=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),U=Symbol.for("react.view_transition"),K=Symbol.for("react.client.reference");function X(Z){if(typeof Z=="object"&&Z!==null){var J=Z.$$typeof;switch(J){case e:switch(Z=Z.type,Z){case o:case d:case c:case I:case R:case U:return Z;default:switch(Z=Z&&Z.$$typeof,Z){case x:case i:case N:case k:return Z;case y:return Z;default:return J}}case n:return J}}}return As.ContextConsumer=y,As.ContextProvider=x,As.Element=e,As.ForwardRef=i,As.Fragment=o,As.Lazy=N,As.Memo=k,As.Portal=n,As.Profiler=d,As.StrictMode=c,As.Suspense=I,As.SuspenseList=R,As.isContextConsumer=function(Z){return X(Z)===y},As.isContextProvider=function(Z){return X(Z)===x},As.isElement=function(Z){return typeof Z=="object"&&Z!==null&&Z.$$typeof===e},As.isForwardRef=function(Z){return X(Z)===i},As.isFragment=function(Z){return X(Z)===o},As.isLazy=function(Z){return X(Z)===N},As.isMemo=function(Z){return X(Z)===k},As.isPortal=function(Z){return X(Z)===n},As.isProfiler=function(Z){return X(Z)===d},As.isStrictMode=function(Z){return X(Z)===c},As.isSuspense=function(Z){return X(Z)===I},As.isSuspenseList=function(Z){return X(Z)===R},As.isValidElementType=function(Z){return typeof Z=="string"||typeof Z=="function"||Z===o||Z===d||Z===c||Z===I||Z===R||typeof Z=="object"&&Z!==null&&(Z.$$typeof===N||Z.$$typeof===k||Z.$$typeof===x||Z.$$typeof===y||Z.$$typeof===i||Z.$$typeof===K||Z.getModuleId!==void 0)},As.typeOf=X,As}var J3;function Ste(){return J3||(J3=1,_2.exports=wte()),_2.exports}var Q3=Ste();const Cte=/^\s*function(?:\s|\s*\/\*.*\*\/\s*)+([^(\s/]*)\s*/;function a5(e){const n=`${e}`.match(Cte);return n&&n[1]||""}function l5(e,n=""){return e.displayName||e.name||a5(e)||n}function eL(e,n,o){const c=l5(n);return e.displayName||(c!==""?`${o}(${c})`:o)}function Tte(e){if(e!=null){if(typeof e=="string")return e;if(typeof e=="function")return l5(e,"Component");if(typeof e=="object")switch(e.$$typeof){case Q3.ForwardRef:return eL(e,e.render,"ForwardRef");case Q3.Memo:return eL(e,e.type,"memo");default:return}}}const Ete=Object.freeze(Object.defineProperty({__proto__:null,default:Tte,getFunctionName:a5},Symbol.toStringTag,{value:"Module"}));function d1(e,n){const o=nt({},n);return Object.keys(e).forEach(c=>{if(c.toString().match(/^(components|slots)$/))o[c]=nt({},e[c],o[c]);else if(c.toString().match(/^(componentsProps|slotProps)$/)){const d=e[c]||{},y=n[c];o[c]={},!y||!Object.keys(y)?o[c]=d:!d||!Object.keys(d)?o[c]=y:(o[c]=nt({},y),Object.keys(d).forEach(x=>{o[c][x]=d1(d[x],y[x])}))}else o[c]===void 0&&(o[c]=e[c])}),o}const fg=typeof window<"u"?V.useLayoutEffect:V.useEffect;function Ite(e,n=Number.MIN_SAFE_INTEGER,o=Number.MAX_SAFE_INTEGER){return Math.max(n,Math.min(e,o))}const Pte=Object.freeze(Object.defineProperty({__proto__:null,default:Ite},Symbol.toStringTag,{value:"Module"}));function tL(...e){return e.reduce((n,o)=>o==null?n:function(...d){n.apply(this,d),o.apply(this,d)},()=>{})}function c5(e,n=166){let o;function c(...d){const y=()=>{e.apply(this,d)};clearTimeout(o),o=setTimeout(y,n)}return c.clear=()=>{clearTimeout(o)},c}function y2(e,n){var o,c;return V.isValidElement(e)&&n.indexOf((o=e.type.muiName)!=null?o:(c=e.type)==null||(c=c._payload)==null||(c=c.value)==null?void 0:c.muiName)!==-1}function kc(e){return e&&e.ownerDocument||document}function pg(e){return kc(e).defaultView||window}function DS(e,n){typeof e=="function"?e(n):e&&(e.current=n)}let nL=0;function Ate(e){const[n,o]=V.useState(e),c=e||n;return V.useEffect(()=>{n==null&&(nL+=1,o(`mui-${nL}`))},[n]),c}const rL=R0.useId;function bT(e){if(rL!==void 0){const n=rL();return e??n}return Ate(e)}function iL({controlled:e,default:n,name:o,state:c="value"}){const{current:d}=V.useRef(e!==void 0),[y,x]=V.useState(n),i=d?e:y,I=V.useCallback(R=>{d||x(R)},[]);return[i,I]}function tg(e){const n=V.useRef(e);return fg(()=>{n.current=e}),V.useRef((...o)=>(0,n.current)(...o)).current}function pl(...e){return V.useMemo(()=>e.every(n=>n==null)?null:n=>{e.forEach(o=>{DS(o,n)})},e)}const sL={};function Rte(e,n){const o=V.useRef(sL);return o.current===sL&&(o.current=e(n)),o}const Mte=[];function Lte(e){V.useEffect(e,Mte)}class nb{constructor(){this.currentId=null,this.clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new nb}start(n,o){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,o()},n)}}function u5(){const e=Rte(nb.create).current;return Lte(e.disposeEffect),e}let rb=!0,kS=!1;const Dte=new nb,kte={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function Ote(e){const{type:n,tagName:o}=e;return!!(o==="INPUT"&&kte[n]&&!e.readOnly||o==="TEXTAREA"&&!e.readOnly||e.isContentEditable)}function zte(e){e.metaKey||e.altKey||e.ctrlKey||(rb=!0)}function v2(){rb=!1}function Fte(){this.visibilityState==="hidden"&&kS&&(rb=!0)}function Nte(e){e.addEventListener("keydown",zte,!0),e.addEventListener("mousedown",v2,!0),e.addEventListener("pointerdown",v2,!0),e.addEventListener("touchstart",v2,!0),e.addEventListener("visibilitychange",Fte,!0)}function jte(e){const{target:n}=e;try{return n.matches(":focus-visible")}catch{}return rb||Ote(n)}function Bte(){const e=V.useCallback(d=>{d!=null&&Nte(d.ownerDocument)},[]),n=V.useRef(!1);function o(){return n.current?(kS=!0,Dte.start(100,()=>{kS=!1}),n.current=!1,!0):!1}function c(d){return jte(d)?(n.current=!0,!0):!1}return{isFocusVisibleRef:n,onFocus:c,onBlur:o,ref:e}}function d5(e){const n=e.documentElement.clientWidth;return Math.abs(window.innerWidth-n)}function Ms(e,n,o=void 0){const c={};return Object.keys(e).forEach(d=>{c[d]=e[d].reduce((y,x)=>{if(x){const i=n(x);i!==""&&y.push(i),o&&o[x]&&y.push(o[x])}return y},[]).join(" ")}),c}function h1(e){return typeof e=="string"}function h5(e,n,o){return e===void 0||h1(e)?n:nt({},n,{ownerState:nt({},n.ownerState,o)})}function f5(e,n=[]){if(e===void 0)return{};const o={};return Object.keys(e).filter(c=>c.match(/^on[A-Z]/)&&typeof e[c]=="function"&&!n.includes(c)).forEach(c=>{o[c]=e[c]}),o}function oL(e){if(e===void 0)return{};const n={};return Object.keys(e).filter(o=>!(o.match(/^on[A-Z]/)&&typeof e[o]=="function")).forEach(o=>{n[o]=e[o]}),n}function p5(e){const{getSlotProps:n,additionalProps:o,externalSlotProps:c,externalForwardedProps:d,className:y}=e;if(!n){const K=pi(o==null?void 0:o.className,y,d==null?void 0:d.className,c==null?void 0:c.className),X=nt({},o==null?void 0:o.style,d==null?void 0:d.style,c==null?void 0:c.style),Z=nt({},o,d,c);return K.length>0&&(Z.className=K),Object.keys(X).length>0&&(Z.style=X),{props:Z,internalRef:void 0}}const x=f5(nt({},d,c)),i=oL(c),I=oL(d),R=n(x),k=pi(R==null?void 0:R.className,o==null?void 0:o.className,y,d==null?void 0:d.className,c==null?void 0:c.className),N=nt({},R==null?void 0:R.style,o==null?void 0:o.style,d==null?void 0:d.style,c==null?void 0:c.style),U=nt({},R,o,I,i);return k.length>0&&(U.className=k),Object.keys(N).length>0&&(U.style=N),{props:U,internalRef:R.ref}}function m5(e,n,o){return typeof e=="function"?e(n,o):e}const Vte=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function A_(e){var n;const{elementType:o,externalSlotProps:c,ownerState:d,skipResolvingSlotProps:y=!1}=e,x=jr(e,Vte),i=y?{}:m5(c,d),{props:I,internalRef:R}=p5(nt({},x,{externalSlotProps:i})),k=pl(R,i==null?void 0:i.ref,(n=e.additionalProps)==null?void 0:n.ref);return h5(o,nt({},I,{ref:k}),d)}function rx(e){if(parseInt(V.version,10)>=19){var n;return(e==null||(n=e.props)==null?void 0:n.ref)||null}return(e==null?void 0:e.ref)||null}const Ute=V.createContext(),$te=()=>{const e=V.useContext(Ute);return e??!1},Hte=V.createContext(void 0);function Gte(e){const{theme:n,name:o,props:c}=e;if(!n||!n.components||!n.components[o])return c;const d=n.components[o];return d.defaultProps?d1(d.defaultProps,c):!d.styleOverrides&&!d.variants?d1(d,c):c}function Wte({props:e,name:n}){const o=V.useContext(Hte);return Gte({props:e,name:n,theme:{components:o}})}function qte(e,n){return nt({toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}}},n)}var lo={},x2={exports:{}},aL;function g5(){return aL||(aL=1,function(e){function n(o){return o&&o.__esModule?o:{default:o}}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports}(x2)),x2.exports}const Zte=Kp(see),Xte=Kp(Pte);var lL;function Kte(){if(lL)return lo;lL=1;var e=g5();Object.defineProperty(lo,"__esModule",{value:!0}),lo.alpha=X,lo.blend=xe,lo.colorChannel=void 0,lo.darken=J,lo.decomposeColor=x,lo.emphasize=pe,lo.getContrastRatio=K,lo.getLuminance=U,lo.hexToRgb=d,lo.hslToRgb=N,lo.lighten=de,lo.private_safeAlpha=Z,lo.private_safeColorChannel=void 0,lo.private_safeDarken=le,lo.private_safeEmphasize=he,lo.private_safeLighten=ue,lo.recomposeColor=R,lo.rgbToHex=k;var n=e(Zte),o=e(Xte);function c(fe,_e=0,Ce=1){return(0,o.default)(fe,_e,Ce)}function d(fe){fe=fe.slice(1);const _e=new RegExp(`.{1,${fe.length>=6?2:1}}`,"g");let Ce=fe.match(_e);return Ce&&Ce[0].length===1&&(Ce=Ce.map(je=>je+je)),Ce?`rgb${Ce.length===4?"a":""}(${Ce.map((je,He)=>He<3?parseInt(je,16):Math.round(parseInt(je,16)/255*1e3)/1e3).join(", ")})`:""}function y(fe){const _e=fe.toString(16);return _e.length===1?`0${_e}`:_e}function x(fe){if(fe.type)return fe;if(fe.charAt(0)==="#")return x(d(fe));const _e=fe.indexOf("("),Ce=fe.substring(0,_e);if(["rgb","rgba","hsl","hsla","color"].indexOf(Ce)===-1)throw new Error((0,n.default)(9,fe));let je=fe.substring(_e+1,fe.length-1),He;if(Ce==="color"){if(je=je.split(" "),He=je.shift(),je.length===4&&je[3].charAt(0)==="/"&&(je[3]=je[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(He)===-1)throw new Error((0,n.default)(10,He))}else je=je.split(",");return je=je.map(lt=>parseFloat(lt)),{type:Ce,values:je,colorSpace:He}}const i=fe=>{const _e=x(fe);return _e.values.slice(0,3).map((Ce,je)=>_e.type.indexOf("hsl")!==-1&&je!==0?`${Ce}%`:Ce).join(" ")};lo.colorChannel=i;const I=(fe,_e)=>{try{return i(fe)}catch{return fe}};lo.private_safeColorChannel=I;function R(fe){const{type:_e,colorSpace:Ce}=fe;let{values:je}=fe;return _e.indexOf("rgb")!==-1?je=je.map((He,lt)=>lt<3?parseInt(He,10):He):_e.indexOf("hsl")!==-1&&(je[1]=`${je[1]}%`,je[2]=`${je[2]}%`),_e.indexOf("color")!==-1?je=`${Ce} ${je.join(" ")}`:je=`${je.join(", ")}`,`${_e}(${je})`}function k(fe){if(fe.indexOf("#")===0)return fe;const{values:_e}=x(fe);return`#${_e.map((Ce,je)=>y(je===3?Math.round(255*Ce):Ce)).join("")}`}function N(fe){fe=x(fe);const{values:_e}=fe,Ce=_e[0],je=_e[1]/100,He=_e[2]/100,lt=je*Math.min(He,1-He),_t=(at,yt=(at+Ce/30)%12)=>He-lt*Math.max(Math.min(yt-3,9-yt,1),-1);let Ue="rgb";const Ge=[Math.round(_t(0)*255),Math.round(_t(8)*255),Math.round(_t(4)*255)];return fe.type==="hsla"&&(Ue+="a",Ge.push(_e[3])),R({type:Ue,values:Ge})}function U(fe){fe=x(fe);let _e=fe.type==="hsl"||fe.type==="hsla"?x(N(fe)).values:fe.values;return _e=_e.map(Ce=>(fe.type!=="color"&&(Ce/=255),Ce<=.03928?Ce/12.92:((Ce+.055)/1.055)**2.4)),Number((.2126*_e[0]+.7152*_e[1]+.0722*_e[2]).toFixed(3))}function K(fe,_e){const Ce=U(fe),je=U(_e);return(Math.max(Ce,je)+.05)/(Math.min(Ce,je)+.05)}function X(fe,_e){return fe=x(fe),_e=c(_e),(fe.type==="rgb"||fe.type==="hsl")&&(fe.type+="a"),fe.type==="color"?fe.values[3]=`/${_e}`:fe.values[3]=_e,R(fe)}function Z(fe,_e,Ce){try{return X(fe,_e)}catch{return fe}}function J(fe,_e){if(fe=x(fe),_e=c(_e),fe.type.indexOf("hsl")!==-1)fe.values[2]*=1-_e;else if(fe.type.indexOf("rgb")!==-1||fe.type.indexOf("color")!==-1)for(let Ce=0;Ce<3;Ce+=1)fe.values[Ce]*=1-_e;return R(fe)}function le(fe,_e,Ce){try{return J(fe,_e)}catch{return fe}}function de(fe,_e){if(fe=x(fe),_e=c(_e),fe.type.indexOf("hsl")!==-1)fe.values[2]+=(100-fe.values[2])*_e;else if(fe.type.indexOf("rgb")!==-1)for(let Ce=0;Ce<3;Ce+=1)fe.values[Ce]+=(255-fe.values[Ce])*_e;else if(fe.type.indexOf("color")!==-1)for(let Ce=0;Ce<3;Ce+=1)fe.values[Ce]+=(1-fe.values[Ce])*_e;return R(fe)}function ue(fe,_e,Ce){try{return de(fe,_e)}catch{return fe}}function pe(fe,_e=.15){return U(fe)>.5?J(fe,_e):de(fe,_e)}function he(fe,_e,Ce){try{return pe(fe,_e)}catch{return fe}}function xe(fe,_e,Ce,je=1){const He=(Ge,at)=>Math.round((Ge**(1/je)*(1-Ce)+at**(1/je)*Ce)**je),lt=x(fe),_t=x(_e),Ue=[He(lt.values[0],_t.values[0]),He(lt.values[1],_t.values[1]),He(lt.values[2],_t.values[2])];return R({type:"rgb",values:Ue})}return lo}var fl=Kte();const Yte=["mode","contrastThreshold","tonalOffset"],cL={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Dv.white,default:Dv.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},b2={text:{primary:Dv.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Dv.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function uL(e,n,o,c){const d=c.light||c,y=c.dark||c*1.5;e[n]||(e.hasOwnProperty(o)?e[n]=e[o]:n==="light"?e.light=fl.lighten(e.main,d):n==="dark"&&(e.dark=fl.darken(e.main,y)))}function Jte(e="light"){return e==="dark"?{main:i_[200],light:i_[50],dark:i_[400]}:{main:i_[700],light:i_[400],dark:i_[800]}}function Qte(e="light"){return e==="dark"?{main:r_[200],light:r_[50],dark:r_[400]}:{main:r_[500],light:r_[300],dark:r_[700]}}function ene(e="light"){return e==="dark"?{main:n_[500],light:n_[300],dark:n_[700]}:{main:n_[700],light:n_[400],dark:n_[800]}}function tne(e="light"){return e==="dark"?{main:s_[400],light:s_[300],dark:s_[700]}:{main:s_[700],light:s_[500],dark:s_[900]}}function nne(e="light"){return e==="dark"?{main:o_[400],light:o_[300],dark:o_[700]}:{main:o_[800],light:o_[500],dark:o_[900]}}function rne(e="light"){return e==="dark"?{main:Ky[400],light:Ky[300],dark:Ky[700]}:{main:"#ed6c02",light:Ky[500],dark:Ky[900]}}function ine(e){const{mode:n="light",contrastThreshold:o=3,tonalOffset:c=.2}=e,d=jr(e,Yte),y=e.primary||Jte(n),x=e.secondary||Qte(n),i=e.error||ene(n),I=e.info||tne(n),R=e.success||nne(n),k=e.warning||rne(n);function N(Z){return fl.getContrastRatio(Z,b2.text.primary)>=o?b2.text.primary:cL.text.primary}const U=({color:Z,name:J,mainShade:le=500,lightShade:de=300,darkShade:ue=700})=>{if(Z=nt({},Z),!Z.main&&Z[le]&&(Z.main=Z[le]),!Z.hasOwnProperty("main"))throw new Error(hg(11,J?` (${J})`:"",le));if(typeof Z.main!="string")throw new Error(hg(12,J?` (${J})`:"",JSON.stringify(Z.main)));return uL(Z,"light",de,c),uL(Z,"dark",ue,c),Z.contrastText||(Z.contrastText=N(Z.main)),Z},K={dark:b2,light:cL};return Dc(nt({common:nt({},Dv),mode:n,primary:U({color:y,name:"primary"}),secondary:U({color:x,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:U({color:i,name:"error"}),warning:U({color:k,name:"warning"}),info:U({color:I,name:"info"}),success:U({color:R,name:"success"}),grey:iee,contrastThreshold:o,getContrastText:N,augmentColor:U,tonalOffset:c},K[n]),d)}const sne=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function one(e){return Math.round(e*1e5)/1e5}const dL={textTransform:"uppercase"},hL='"Roboto", "Helvetica", "Arial", sans-serif';function ane(e,n){const o=typeof n=="function"?n(e):n,{fontFamily:c=hL,fontSize:d=14,fontWeightLight:y=300,fontWeightRegular:x=400,fontWeightMedium:i=500,fontWeightBold:I=700,htmlFontSize:R=16,allVariants:k,pxToRem:N}=o,U=jr(o,sne),K=d/14,X=N||(le=>`${le/R*K}rem`),Z=(le,de,ue,pe,he)=>nt({fontFamily:c,fontWeight:le,fontSize:X(de),lineHeight:ue},c===hL?{letterSpacing:`${one(pe/de)}em`}:{},he,k),J={h1:Z(y,96,1.167,-1.5),h2:Z(y,60,1.2,-.5),h3:Z(x,48,1.167,0),h4:Z(x,34,1.235,.25),h5:Z(x,24,1.334,0),h6:Z(i,20,1.6,.15),subtitle1:Z(x,16,1.75,.15),subtitle2:Z(i,14,1.57,.1),body1:Z(x,16,1.5,.15),body2:Z(x,14,1.43,.15),button:Z(i,14,1.75,.4,dL),caption:Z(x,12,1.66,.4),overline:Z(x,12,2.66,1,dL),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Dc(nt({htmlFontSize:R,pxToRem:X,fontFamily:c,fontSize:d,fontWeightLight:y,fontWeightRegular:x,fontWeightMedium:i,fontWeightBold:I},J),U,{clone:!1})}const lne=.2,cne=.14,une=.12;function Qs(...e){return[`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px rgba(0,0,0,${lne})`,`${e[4]}px ${e[5]}px ${e[6]}px ${e[7]}px rgba(0,0,0,${cne})`,`${e[8]}px ${e[9]}px ${e[10]}px ${e[11]}px rgba(0,0,0,${une})`].join(",")}const dne=["none",Qs(0,2,1,-1,0,1,1,0,0,1,3,0),Qs(0,3,1,-2,0,2,2,0,0,1,5,0),Qs(0,3,3,-2,0,3,4,0,0,1,8,0),Qs(0,2,4,-1,0,4,5,0,0,1,10,0),Qs(0,3,5,-1,0,5,8,0,0,1,14,0),Qs(0,3,5,-1,0,6,10,0,0,1,18,0),Qs(0,4,5,-2,0,7,10,1,0,2,16,1),Qs(0,5,5,-3,0,8,10,1,0,3,14,2),Qs(0,5,6,-3,0,9,12,1,0,3,16,2),Qs(0,6,6,-3,0,10,14,1,0,4,18,3),Qs(0,6,7,-4,0,11,15,1,0,4,20,3),Qs(0,7,8,-4,0,12,17,2,0,5,22,4),Qs(0,7,8,-4,0,13,19,2,0,5,24,4),Qs(0,7,9,-4,0,14,21,2,0,5,26,4),Qs(0,8,9,-5,0,15,22,2,0,6,28,5),Qs(0,8,10,-5,0,16,24,2,0,6,30,5),Qs(0,8,11,-5,0,17,26,2,0,6,32,5),Qs(0,9,11,-5,0,18,28,2,0,7,34,6),Qs(0,9,12,-6,0,19,29,2,0,7,36,6),Qs(0,10,13,-6,0,20,31,3,0,8,38,7),Qs(0,10,13,-6,0,21,33,3,0,8,40,7),Qs(0,10,14,-6,0,22,35,3,0,8,42,7),Qs(0,11,14,-7,0,23,36,3,0,9,44,8),Qs(0,11,15,-7,0,24,38,3,0,9,46,8)],hne=["duration","easing","delay"],fne={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},pne={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function fL(e){return`${Math.round(e)}ms`}function mne(e){if(!e)return 0;const n=e/36;return Math.round((4+15*n**.25+n/5)*10)}function gne(e){const n=nt({},fne,e.easing),o=nt({},pne,e.duration);return nt({getAutoHeightDuration:mne,create:(d=["all"],y={})=>{const{duration:x=o.standard,easing:i=n.easeInOut,delay:I=0}=y;return jr(y,hne),(Array.isArray(d)?d:[d]).map(R=>`${R} ${typeof x=="string"?x:fL(x)} ${i} ${typeof I=="string"?I:fL(I)}`).join(",")}},e,{easing:n,duration:o})}const _ne={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},yne=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function _5(e={},...n){const{mixins:o={},palette:c={},transitions:d={},typography:y={}}=e,x=jr(e,yne);if(e.vars&&e.generateCssVars===void 0)throw new Error(hg(18));const i=ine(c),I=yT(e);let R=Dc(I,{mixins:qte(I.breakpoints,o),palette:i,shadows:dne.slice(),typography:ane(i,y),transitions:gne(d),zIndex:nt({},_ne)});return R=Dc(R,x),R=n.reduce((k,N)=>Dc(k,N),R),R.unstable_sxConfig=nt({},tx,x==null?void 0:x.unstable_sxConfig),R.unstable_sx=function(N){return nx({sx:N,theme:this})},R}const wT=_5();function ST(){const e=vT(wT);return e[X1]||e}var Zm={},w2={exports:{}},pL;function vne(){return pL||(pL=1,function(e){function n(){return e.exports=n=Object.assign?Object.assign.bind():function(o){for(var c=1;c<arguments.length;c++){var d=arguments[c];for(var y in d)({}).hasOwnProperty.call(d,y)&&(o[y]=d[y])}return o},e.exports.__esModule=!0,e.exports.default=e.exports,n.apply(null,arguments)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports}(w2)),w2.exports}var S2={exports:{}},mL;function xne(){return mL||(mL=1,function(e){function n(o,c){if(o==null)return{};var d={};for(var y in o)if({}.hasOwnProperty.call(o,y)){if(c.indexOf(y)!==-1)continue;d[y]=o[y]}return d}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports}(S2)),S2.exports}const bne=Kp(gee),wne=Kp(_ee),Sne=Kp(See),Cne=Kp(Ete),Tne=Kp(ute),Ene=Kp(_te);var gL;function Ine(){if(gL)return Zm;gL=1;var e=g5();Object.defineProperty(Zm,"__esModule",{value:!0}),Zm.default=pe,Zm.shouldForwardProp=X,Zm.systemDefaultTheme=void 0;var n=e(vne()),o=e(xne()),c=N(bne),d=wne;e(Sne),e(Cne);var y=e(Tne),x=e(Ene);const i=["ownerState"],I=["variants"],R=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function k(he){if(typeof WeakMap!="function")return null;var xe=new WeakMap,fe=new WeakMap;return(k=function(_e){return _e?fe:xe})(he)}function N(he,xe){if(he&&he.__esModule)return he;if(he===null||typeof he!="object"&&typeof he!="function")return{default:he};var fe=k(xe);if(fe&&fe.has(he))return fe.get(he);var _e={__proto__:null},Ce=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var je in he)if(je!=="default"&&Object.prototype.hasOwnProperty.call(he,je)){var He=Ce?Object.getOwnPropertyDescriptor(he,je):null;He&&(He.get||He.set)?Object.defineProperty(_e,je,He):_e[je]=he[je]}return _e.default=he,fe&&fe.set(he,_e),_e}function U(he){return Object.keys(he).length===0}function K(he){return typeof he=="string"&&he.charCodeAt(0)>96}function X(he){return he!=="ownerState"&&he!=="theme"&&he!=="sx"&&he!=="as"}const Z=Zm.systemDefaultTheme=(0,y.default)(),J=he=>he&&he.charAt(0).toLowerCase()+he.slice(1);function le({defaultTheme:he,theme:xe,themeId:fe}){return U(xe)?he:xe[fe]||xe}function de(he){return he?(xe,fe)=>fe[he]:null}function ue(he,xe){let{ownerState:fe}=xe,_e=(0,o.default)(xe,i);const Ce=typeof he=="function"?he((0,n.default)({ownerState:fe},_e)):he;if(Array.isArray(Ce))return Ce.flatMap(je=>ue(je,(0,n.default)({ownerState:fe},_e)));if(Ce&&typeof Ce=="object"&&Array.isArray(Ce.variants)){const{variants:je=[]}=Ce;let lt=(0,o.default)(Ce,I);return je.forEach(_t=>{let Ue=!0;typeof _t.props=="function"?Ue=_t.props((0,n.default)({ownerState:fe},_e,fe)):Object.keys(_t.props).forEach(Ge=>{(fe==null?void 0:fe[Ge])!==_t.props[Ge]&&_e[Ge]!==_t.props[Ge]&&(Ue=!1)}),Ue&&(Array.isArray(lt)||(lt=[lt]),lt.push(typeof _t.style=="function"?_t.style((0,n.default)({ownerState:fe},_e,fe)):_t.style))}),lt}return Ce}function pe(he={}){const{themeId:xe,defaultTheme:fe=Z,rootShouldForwardProp:_e=X,slotShouldForwardProp:Ce=X}=he,je=He=>(0,x.default)((0,n.default)({},He,{theme:le((0,n.default)({},He,{defaultTheme:fe,themeId:xe}))}));return je.__mui_systemSx=!0,(He,lt={})=>{(0,c.internal_processStyles)(He,st=>st.filter(Bt=>!(Bt!=null&&Bt.__mui_systemSx)));const{name:_t,slot:Ue,skipVariantsResolver:Ge,skipSx:at,overridesResolver:yt=de(J(Ue))}=lt,tt=(0,o.default)(lt,R),Rt=Ge!==void 0?Ge:Ue&&Ue!=="Root"&&Ue!=="root"||!1,ct=at||!1;let ze,Ye=X;Ue==="Root"||Ue==="root"?Ye=_e:Ue?Ye=Ce:K(He)&&(Ye=void 0);const At=(0,c.default)(He,(0,n.default)({shouldForwardProp:Ye,label:ze},tt)),Ct=st=>typeof st=="function"&&st.__emotion_real!==st||(0,d.isPlainObject)(st)?Bt=>ue(st,(0,n.default)({},Bt,{theme:le({theme:Bt.theme,defaultTheme:fe,themeId:xe})})):st,We=(st,...Bt)=>{let hn=Ct(st);const cn=Bt?Bt.map(Ct):[];_t&&yt&&cn.push(Vn=>{const An=le((0,n.default)({},Vn,{defaultTheme:fe,themeId:xe}));if(!An.components||!An.components[_t]||!An.components[_t].styleOverrides)return null;const Zt=An.components[_t].styleOverrides,mn={};return Object.entries(Zt).forEach(([kr,Gr])=>{mn[kr]=ue(Gr,(0,n.default)({},Vn,{theme:An}))}),yt(Vn,mn)}),_t&&!Rt&&cn.push(Vn=>{var An;const Zt=le((0,n.default)({},Vn,{defaultTheme:fe,themeId:xe})),mn=Zt==null||(An=Zt.components)==null||(An=An[_t])==null?void 0:An.variants;return ue({variants:mn},(0,n.default)({},Vn,{theme:Zt}))}),ct||cn.push(je);const cr=cn.length-Bt.length;if(Array.isArray(st)&&cr>0){const Vn=new Array(cr).fill("");hn=[...st,...Vn],hn.raw=[...st.raw,...Vn]}const Nn=At(hn,...cn);return He.muiName&&(Nn.muiName=He.muiName),Nn};return At.withConfig&&(We.withConfig=At.withConfig),We}}return Zm}var Pne=Ine();const Ane=mg(Pne);function y5(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const md=e=>y5(e)&&e!=="classes",Mr=Ane({themeId:X1,defaultTheme:wT,rootShouldForwardProp:md}),_L=e=>{let n;return e<1?n=5.11916*e**2:n=4.5*Math.log(e+1)+2,(n/100).toFixed(2)};function Ls(e){return Wte(e)}function Rne(e){return Ts("MuiSvgIcon",e)}xs("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const Mne=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],Lne=e=>{const{color:n,fontSize:o,classes:c}=e,d={root:["root",n!=="inherit"&&`color${qr(n)}`,`fontSize${qr(o)}`]};return Ms(d,Rne,c)},Dne=Mr("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:o}=e;return[n.root,o.color!=="inherit"&&n[`color${qr(o.color)}`],n[`fontSize${qr(o.fontSize)}`]]}})(({theme:e,ownerState:n})=>{var o,c,d,y,x,i,I,R,k,N,U,K,X;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:n.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(o=e.transitions)==null||(c=o.create)==null?void 0:c.call(o,"fill",{duration:(d=e.transitions)==null||(d=d.duration)==null?void 0:d.shorter}),fontSize:{inherit:"inherit",small:((y=e.typography)==null||(x=y.pxToRem)==null?void 0:x.call(y,20))||"1.25rem",medium:((i=e.typography)==null||(I=i.pxToRem)==null?void 0:I.call(i,24))||"1.5rem",large:((R=e.typography)==null||(k=R.pxToRem)==null?void 0:k.call(R,35))||"2.1875rem"}[n.fontSize],color:(N=(U=(e.vars||e).palette)==null||(U=U[n.color])==null?void 0:U.main)!=null?N:{action:(K=(e.vars||e).palette)==null||(K=K.action)==null?void 0:K.active,disabled:(X=(e.vars||e).palette)==null||(X=X.action)==null?void 0:X.disabled,inherit:void 0}[n.color]}}),OS=V.forwardRef(function(n,o){const c=Ls({props:n,name:"MuiSvgIcon"}),{children:d,className:y,color:x="inherit",component:i="svg",fontSize:I="medium",htmlColor:R,inheritViewBox:k=!1,titleAccess:N,viewBox:U="0 0 24 24"}=c,K=jr(c,Mne),X=V.isValidElement(d)&&d.type==="svg",Z=nt({},c,{color:x,component:i,fontSize:I,instanceFontSize:n.fontSize,inheritViewBox:k,viewBox:U,hasSvgAsChild:X}),J={};k||(J.viewBox=U);const le=Lne(Z);return T.jsxs(Dne,nt({as:i,className:pi(le.root,y),focusable:"false",color:R,"aria-hidden":N?void 0:!0,role:N?"img":void 0,ref:o},J,K,X&&d.props,{ownerState:Z,children:[X?d.props.children:d,N?T.jsx("title",{children:N}):null]}))});OS.muiName="SvgIcon";function q_(e,n){function o(c,d){return T.jsx(OS,nt({"data-testid":`${n}Icon`,ref:d},c,{children:e}))}return o.muiName=OS.muiName,V.memo(V.forwardRef(o))}function CT(e,n){var o=function(y){return n&&V.isValidElement(y)?n(y):y},c=Object.create(null);return e&&V.Children.map(e,function(d){return d}).forEach(function(d){c[d.key]=o(d)}),c}function kne(e,n){e=e||{},n=n||{};function o(k){return k in n?n[k]:e[k]}var c=Object.create(null),d=[];for(var y in e)y in n?d.length&&(c[y]=d,d=[]):d.push(y);var x,i={};for(var I in n){if(c[I])for(x=0;x<c[I].length;x++){var R=c[I][x];i[c[I][x]]=o(R)}i[I]=o(I)}for(x=0;x<d.length;x++)i[d[x]]=o(d[x]);return i}function ng(e,n,o){return o[n]!=null?o[n]:e.props[n]}function One(e,n){return CT(e.children,function(o){return V.cloneElement(o,{onExited:n.bind(null,o),in:!0,appear:ng(o,"appear",e),enter:ng(o,"enter",e),exit:ng(o,"exit",e)})})}function zne(e,n,o){var c=CT(e.children),d=kne(n,c);return Object.keys(d).forEach(function(y){var x=d[y];if(V.isValidElement(x)){var i=y in n,I=y in c,R=n[y],k=V.isValidElement(R)&&!R.props.in;I&&(!i||k)?d[y]=V.cloneElement(x,{onExited:o.bind(null,x),in:!0,exit:ng(x,"exit",e),enter:ng(x,"enter",e)}):!I&&i&&!k?d[y]=V.cloneElement(x,{in:!1}):I&&i&&V.isValidElement(R)&&(d[y]=V.cloneElement(x,{onExited:o.bind(null,x),in:R.props.in,exit:ng(x,"exit",e),enter:ng(x,"enter",e)}))}}),d}var Fne=Object.values||function(e){return Object.keys(e).map(function(n){return e[n]})},Nne={component:"div",childFactory:function(n){return n}},TT=function(e){fD(n,e);function n(c,d){var y;y=e.call(this,c,d)||this;var x=y.handleExited.bind(B4(y));return y.state={contextValue:{isMounting:!0},handleExited:x,firstRender:!0},y}var o=n.prototype;return o.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},o.componentWillUnmount=function(){this.mounted=!1},n.getDerivedStateFromProps=function(d,y){var x=y.children,i=y.handleExited,I=y.firstRender;return{children:I?One(d,i):zne(d,x,i),firstRender:!1}},o.handleExited=function(d,y){var x=CT(this.props.children);d.key in x||(d.props.onExited&&d.props.onExited(y),this.mounted&&this.setState(function(i){var I=nt({},i.children);return delete I[d.key],{children:I}}))},o.render=function(){var d=this.props,y=d.component,x=d.childFactory,i=jr(d,["component","childFactory"]),I=this.state.contextValue,R=Fne(this.state.children).map(x);return delete i.appear,delete i.enter,delete i.exit,y===null?qi.createElement(D0.Provider,{value:I},R):qi.createElement(D0.Provider,{value:I},qi.createElement(y,i,R))},n}(qi.Component);TT.propTypes={};TT.defaultProps=Nne;const v5=e=>e.scrollTop;function f1(e,n){var o,c;const{timeout:d,easing:y,style:x={}}=e;return{duration:(o=x.transitionDuration)!=null?o:typeof d=="number"?d:d[n.mode]||0,easing:(c=x.transitionTimingFunction)!=null?c:typeof y=="object"?y[n.mode]:y,delay:x.transitionDelay}}function jne(e){return Ts("MuiPaper",e)}xs("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const Bne=["className","component","elevation","square","variant"],Vne=e=>{const{square:n,elevation:o,variant:c,classes:d}=e,y={root:["root",c,!n&&"rounded",c==="elevation"&&`elevation${o}`]};return Ms(y,jne,d)},Une=Mr("div",{name:"MuiPaper",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:o}=e;return[n.root,n[o.variant],!o.square&&n.rounded,o.variant==="elevation"&&n[`elevation${o.elevation}`]]}})(({theme:e,ownerState:n})=>{var o;return nt({backgroundColor:(e.vars||e).palette.background.paper,color:(e.vars||e).palette.text.primary,transition:e.transitions.create("box-shadow")},!n.square&&{borderRadius:e.shape.borderRadius},n.variant==="outlined"&&{border:`1px solid ${(e.vars||e).palette.divider}`},n.variant==="elevation"&&nt({boxShadow:(e.vars||e).shadows[n.elevation]},!e.vars&&e.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${fl.alpha("#fff",_L(n.elevation))}, ${fl.alpha("#fff",_L(n.elevation))})`},e.vars&&{backgroundImage:(o=e.vars.overlays)==null?void 0:o[n.elevation]}))}),ib=V.forwardRef(function(n,o){const c=Ls({props:n,name:"MuiPaper"}),{className:d,component:y="div",elevation:x=1,square:i=!1,variant:I="elevation"}=c,R=jr(c,Bne),k=nt({},c,{component:y,elevation:x,square:i,variant:I}),N=Vne(k);return T.jsx(Une,nt({as:y,ownerState:k,className:pi(N.root,d),ref:o},R))}),$ne=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],Hne=["component","slots","slotProps"],Gne=["component"];function yL(e,n){const{className:o,elementType:c,ownerState:d,externalForwardedProps:y,getSlotOwnerState:x,internalForwardedProps:i}=n,I=jr(n,$ne),{component:R,slots:k={[e]:void 0},slotProps:N={[e]:void 0}}=y,U=jr(y,Hne),K=k[e]||c,X=m5(N[e],d),Z=p5(nt({className:o},I,{externalForwardedProps:e==="root"?U:void 0,externalSlotProps:X})),{props:{component:J},internalRef:le}=Z,de=jr(Z.props,Gne),ue=pl(le,X==null?void 0:X.ref,n.ref),pe=x?x(de):{},he=nt({},d,pe),xe=e==="root"?J||R:J,fe=h5(K,nt({},e==="root"&&!R&&!k[e]&&i,e!=="root"&&!k[e]&&i,de,xe&&{as:xe},{ref:ue}),he);return Object.keys(pe).forEach(_e=>{delete fe[_e]}),[K,fe]}function Wne(e){const{className:n,classes:o,pulsate:c=!1,rippleX:d,rippleY:y,rippleSize:x,in:i,onExited:I,timeout:R}=e,[k,N]=V.useState(!1),U=pi(n,o.ripple,o.rippleVisible,c&&o.ripplePulsate),K={width:x,height:x,top:-(x/2)+y,left:-(x/2)+d},X=pi(o.child,k&&o.childLeaving,c&&o.childPulsate);return!i&&!k&&N(!0),V.useEffect(()=>{if(!i&&I!=null){const Z=setTimeout(I,R);return()=>{clearTimeout(Z)}}},[I,i,R]),T.jsx("span",{className:U,style:K,children:T.jsx("span",{className:X})})}const _u=xs("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),qne=["center","classes","className"];let sb=e=>e,vL,xL,bL,wL;const zS=550,Zne=80,Xne=vg(vL||(vL=sb`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),Kne=vg(xL||(xL=sb`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),Yne=vg(bL||(bL=sb`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),Jne=Mr("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),Qne=Mr(Wne,{name:"MuiTouchRipple",slot:"Ripple"})(wL||(wL=sb`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),_u.rippleVisible,Xne,zS,({theme:e})=>e.transitions.easing.easeInOut,_u.ripplePulsate,({theme:e})=>e.transitions.duration.shorter,_u.child,_u.childLeaving,Kne,zS,({theme:e})=>e.transitions.easing.easeInOut,_u.childPulsate,Yne,({theme:e})=>e.transitions.easing.easeInOut),ere=V.forwardRef(function(n,o){const c=Ls({props:n,name:"MuiTouchRipple"}),{center:d=!1,classes:y={},className:x}=c,i=jr(c,qne),[I,R]=V.useState([]),k=V.useRef(0),N=V.useRef(null);V.useEffect(()=>{N.current&&(N.current(),N.current=null)},[I]);const U=V.useRef(!1),K=u5(),X=V.useRef(null),Z=V.useRef(null),J=V.useCallback(pe=>{const{pulsate:he,rippleX:xe,rippleY:fe,rippleSize:_e,cb:Ce}=pe;R(je=>[...je,T.jsx(Qne,{classes:{ripple:pi(y.ripple,_u.ripple),rippleVisible:pi(y.rippleVisible,_u.rippleVisible),ripplePulsate:pi(y.ripplePulsate,_u.ripplePulsate),child:pi(y.child,_u.child),childLeaving:pi(y.childLeaving,_u.childLeaving),childPulsate:pi(y.childPulsate,_u.childPulsate)},timeout:zS,pulsate:he,rippleX:xe,rippleY:fe,rippleSize:_e},k.current)]),k.current+=1,N.current=Ce},[y]),le=V.useCallback((pe={},he={},xe=()=>{})=>{const{pulsate:fe=!1,center:_e=d||he.pulsate,fakeElement:Ce=!1}=he;if((pe==null?void 0:pe.type)==="mousedown"&&U.current){U.current=!1;return}(pe==null?void 0:pe.type)==="touchstart"&&(U.current=!0);const je=Ce?null:Z.current,He=je?je.getBoundingClientRect():{width:0,height:0,left:0,top:0};let lt,_t,Ue;if(_e||pe===void 0||pe.clientX===0&&pe.clientY===0||!pe.clientX&&!pe.touches)lt=Math.round(He.width/2),_t=Math.round(He.height/2);else{const{clientX:Ge,clientY:at}=pe.touches&&pe.touches.length>0?pe.touches[0]:pe;lt=Math.round(Ge-He.left),_t=Math.round(at-He.top)}if(_e)Ue=Math.sqrt((2*He.width**2+He.height**2)/3),Ue%2===0&&(Ue+=1);else{const Ge=Math.max(Math.abs((je?je.clientWidth:0)-lt),lt)*2+2,at=Math.max(Math.abs((je?je.clientHeight:0)-_t),_t)*2+2;Ue=Math.sqrt(Ge**2+at**2)}pe!=null&&pe.touches?X.current===null&&(X.current=()=>{J({pulsate:fe,rippleX:lt,rippleY:_t,rippleSize:Ue,cb:xe})},K.start(Zne,()=>{X.current&&(X.current(),X.current=null)})):J({pulsate:fe,rippleX:lt,rippleY:_t,rippleSize:Ue,cb:xe})},[d,J,K]),de=V.useCallback(()=>{le({},{pulsate:!0})},[le]),ue=V.useCallback((pe,he)=>{if(K.clear(),(pe==null?void 0:pe.type)==="touchend"&&X.current){X.current(),X.current=null,K.start(0,()=>{ue(pe,he)});return}X.current=null,R(xe=>xe.length>0?xe.slice(1):xe),N.current=he},[K]);return V.useImperativeHandle(o,()=>({pulsate:de,start:le,stop:ue}),[de,le,ue]),T.jsx(Jne,nt({className:pi(_u.root,y.root,x),ref:Z},i,{children:T.jsx(TT,{component:null,exit:!0,children:I})}))});function tre(e){return Ts("MuiButtonBase",e)}const nre=xs("MuiButtonBase",["root","disabled","focusVisible"]),rre=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],ire=e=>{const{disabled:n,focusVisible:o,focusVisibleClassName:c,classes:d}=e,x=Ms({root:["root",n&&"disabled",o&&"focusVisible"]},tre,d);return o&&c&&(x.root+=` ${c}`),x},sre=Mr("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(e,n)=>n.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${nre.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),x5=V.forwardRef(function(n,o){const c=Ls({props:n,name:"MuiButtonBase"}),{action:d,centerRipple:y=!1,children:x,className:i,component:I="button",disabled:R=!1,disableRipple:k=!1,disableTouchRipple:N=!1,focusRipple:U=!1,LinkComponent:K="a",onBlur:X,onClick:Z,onContextMenu:J,onDragLeave:le,onFocus:de,onFocusVisible:ue,onKeyDown:pe,onKeyUp:he,onMouseDown:xe,onMouseLeave:fe,onMouseUp:_e,onTouchEnd:Ce,onTouchMove:je,onTouchStart:He,tabIndex:lt=0,TouchRippleProps:_t,touchRippleRef:Ue,type:Ge}=c,at=jr(c,rre),yt=V.useRef(null),tt=V.useRef(null),Rt=pl(tt,Ue),{isFocusVisibleRef:ct,onFocus:ze,onBlur:Ye,ref:At}=Bte(),[Ct,We]=V.useState(!1);R&&Ct&&We(!1),V.useImperativeHandle(d,()=>({focusVisible:()=>{We(!0),yt.current.focus()}}),[]);const[st,Bt]=V.useState(!1);V.useEffect(()=>{Bt(!0)},[]);const hn=st&&!k&&!R;V.useEffect(()=>{Ct&&U&&!k&&st&&tt.current.pulsate()},[k,U,Ct,st]);function cn(ur,us,ss=N){return tg(Sr=>(us&&us(Sr),!ss&&tt.current&&tt.current[ur](Sr),!0))}const cr=cn("start",xe),Nn=cn("stop",J),Vn=cn("stop",le),An=cn("stop",_e),Zt=cn("stop",ur=>{Ct&&ur.preventDefault(),fe&&fe(ur)}),mn=cn("start",He),kr=cn("stop",Ce),Gr=cn("stop",je),Yr=cn("stop",ur=>{Ye(ur),ct.current===!1&&We(!1),X&&X(ur)},!1),Xn=tg(ur=>{yt.current||(yt.current=ur.currentTarget),ze(ur),ct.current===!0&&(We(!0),ue&&ue(ur)),de&&de(ur)}),Lr=()=>{const ur=yt.current;return I&&I!=="button"&&!(ur.tagName==="A"&&ur.href)},Or=V.useRef(!1),is=tg(ur=>{U&&!Or.current&&Ct&&tt.current&&ur.key===" "&&(Or.current=!0,tt.current.stop(ur,()=>{tt.current.start(ur)})),ur.target===ur.currentTarget&&Lr()&&ur.key===" "&&ur.preventDefault(),pe&&pe(ur),ur.target===ur.currentTarget&&Lr()&&ur.key==="Enter"&&!R&&(ur.preventDefault(),Z&&Z(ur))}),Zi=tg(ur=>{U&&ur.key===" "&&tt.current&&Ct&&!ur.defaultPrevented&&(Or.current=!1,tt.current.stop(ur,()=>{tt.current.pulsate(ur)})),he&&he(ur),Z&&ur.target===ur.currentTarget&&Lr()&&ur.key===" "&&!ur.defaultPrevented&&Z(ur)});let Dr=I;Dr==="button"&&(at.href||at.to)&&(Dr=K);const Bi={};Dr==="button"?(Bi.type=Ge===void 0?"button":Ge,Bi.disabled=R):(!at.href&&!at.to&&(Bi.role="button"),R&&(Bi["aria-disabled"]=R));const Fr=pl(o,At,yt),Xi=nt({},c,{centerRipple:y,component:I,disabled:R,disableRipple:k,disableTouchRipple:N,focusRipple:U,tabIndex:lt,focusVisible:Ct}),ei=ire(Xi);return T.jsxs(sre,nt({as:Dr,className:pi(ei.root,i),ownerState:Xi,onBlur:Yr,onClick:Z,onContextMenu:Nn,onFocus:Xn,onKeyDown:is,onKeyUp:Zi,onMouseDown:cr,onMouseLeave:Zt,onMouseUp:An,onDragLeave:Vn,onTouchEnd:kr,onTouchMove:Gr,onTouchStart:mn,ref:Fr,tabIndex:R?-1:lt,type:Ge},Bi,at,{children:[x,hn?T.jsx(ere,nt({ref:Rt,center:y},_t)):null]}))});function ore(e){return Ts("MuiAlert",e)}const SL=xs("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]);function are(e){return Ts("MuiIconButton",e)}const lre=xs("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),cre=["edge","children","className","color","disabled","disableFocusRipple","size"],ure=e=>{const{classes:n,disabled:o,color:c,edge:d,size:y}=e,x={root:["root",o&&"disabled",c!=="default"&&`color${qr(c)}`,d&&`edge${qr(d)}`,`size${qr(y)}`]};return Ms(x,are,n)},dre=Mr(x5,{name:"MuiIconButton",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:o}=e;return[n.root,o.color!=="default"&&n[`color${qr(o.color)}`],o.edge&&n[`edge${qr(o.edge)}`],n[`size${qr(o.size)}`]]}})(({theme:e,ownerState:n})=>nt({textAlign:"center",flex:"0 0 auto",fontSize:e.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:(e.vars||e).palette.action.active,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest})},!n.disableRipple&&{"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:fl.alpha(e.palette.action.active,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},n.edge==="start"&&{marginLeft:n.size==="small"?-3:-12},n.edge==="end"&&{marginRight:n.size==="small"?-3:-12}),({theme:e,ownerState:n})=>{var o;const c=(o=(e.vars||e).palette)==null?void 0:o[n.color];return nt({},n.color==="inherit"&&{color:"inherit"},n.color!=="inherit"&&n.color!=="default"&&nt({color:c==null?void 0:c.main},!n.disableRipple&&{"&:hover":nt({},c&&{backgroundColor:e.vars?`rgba(${c.mainChannel} / ${e.vars.palette.action.hoverOpacity})`:fl.alpha(c.main,e.palette.action.hoverOpacity)},{"@media (hover: none)":{backgroundColor:"transparent"}})}),n.size==="small"&&{padding:5,fontSize:e.typography.pxToRem(18)},n.size==="large"&&{padding:12,fontSize:e.typography.pxToRem(28)},{[`&.${lre.disabled}`]:{backgroundColor:"transparent",color:(e.vars||e).palette.action.disabled}})}),hre=V.forwardRef(function(n,o){const c=Ls({props:n,name:"MuiIconButton"}),{edge:d=!1,children:y,className:x,color:i="default",disabled:I=!1,disableFocusRipple:R=!1,size:k="medium"}=c,N=jr(c,cre),U=nt({},c,{edge:d,color:i,disabled:I,disableFocusRipple:R,size:k}),K=ure(U);return T.jsx(dre,nt({className:pi(K.root,x),centerRipple:!0,focusRipple:!R,disabled:I,ref:o},N,{ownerState:U,children:y}))}),fre=q_(T.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),pre=q_(T.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),mre=q_(T.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),gre=q_(T.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined"),_re=q_(T.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),yre=["action","children","className","closeText","color","components","componentsProps","icon","iconMapping","onClose","role","severity","slotProps","slots","variant"],vre=e=>{const{variant:n,color:o,severity:c,classes:d}=e,y={root:["root",`color${qr(o||c)}`,`${n}${qr(o||c)}`,`${n}`],icon:["icon"],message:["message"],action:["action"]};return Ms(y,ore,d)},xre=Mr(ib,{name:"MuiAlert",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:o}=e;return[n.root,n[o.variant],n[`${o.variant}${qr(o.color||o.severity)}`]]}})(({theme:e})=>{const n=e.palette.mode==="light"?fl.darken:fl.lighten,o=e.palette.mode==="light"?fl.lighten:fl.darken;return nt({},e.typography.body2,{backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(e.palette).filter(([,c])=>c.main&&c.light).map(([c])=>({props:{colorSeverity:c,variant:"standard"},style:{color:e.vars?e.vars.palette.Alert[`${c}Color`]:n(e.palette[c].light,.6),backgroundColor:e.vars?e.vars.palette.Alert[`${c}StandardBg`]:o(e.palette[c].light,.9),[`& .${SL.icon}`]:e.vars?{color:e.vars.palette.Alert[`${c}IconColor`]}:{color:e.palette[c].main}}})),...Object.entries(e.palette).filter(([,c])=>c.main&&c.light).map(([c])=>({props:{colorSeverity:c,variant:"outlined"},style:{color:e.vars?e.vars.palette.Alert[`${c}Color`]:n(e.palette[c].light,.6),border:`1px solid ${(e.vars||e).palette[c].light}`,[`& .${SL.icon}`]:e.vars?{color:e.vars.palette.Alert[`${c}IconColor`]}:{color:e.palette[c].main}}})),...Object.entries(e.palette).filter(([,c])=>c.main&&c.dark).map(([c])=>({props:{colorSeverity:c,variant:"filled"},style:nt({fontWeight:e.typography.fontWeightMedium},e.vars?{color:e.vars.palette.Alert[`${c}FilledColor`],backgroundColor:e.vars.palette.Alert[`${c}FilledBg`]}:{backgroundColor:e.palette.mode==="dark"?e.palette[c].dark:e.palette[c].main,color:e.palette.getContrastText(e.palette[c].main)})}))]})}),bre=Mr("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(e,n)=>n.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),wre=Mr("div",{name:"MuiAlert",slot:"Message",overridesResolver:(e,n)=>n.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),CL=Mr("div",{name:"MuiAlert",slot:"Action",overridesResolver:(e,n)=>n.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),TL={success:T.jsx(fre,{fontSize:"inherit"}),warning:T.jsx(pre,{fontSize:"inherit"}),error:T.jsx(mre,{fontSize:"inherit"}),info:T.jsx(gre,{fontSize:"inherit"})},EL=V.forwardRef(function(n,o){const c=Ls({props:n,name:"MuiAlert"}),{action:d,children:y,className:x,closeText:i="Close",color:I,components:R={},componentsProps:k={},icon:N,iconMapping:U=TL,onClose:K,role:X="alert",severity:Z="success",slotProps:J={},slots:le={},variant:de="standard"}=c,ue=jr(c,yre),pe=nt({},c,{color:I,severity:Z,variant:de,colorSeverity:I||Z}),he=vre(pe),xe={slots:nt({closeButton:R.CloseButton,closeIcon:R.CloseIcon},le),slotProps:nt({},k,J)},[fe,_e]=yL("closeButton",{elementType:hre,externalForwardedProps:xe,ownerState:pe}),[Ce,je]=yL("closeIcon",{elementType:_re,externalForwardedProps:xe,ownerState:pe});return T.jsxs(xre,nt({role:X,elevation:0,ownerState:pe,className:pi(he.root,x),ref:o},ue,{children:[N!==!1?T.jsx(bre,{ownerState:pe,className:he.icon,children:N||U[Z]||TL[Z]}):null,T.jsx(wre,{ownerState:pe,className:he.message,children:y}),d!=null?T.jsx(CL,{ownerState:pe,className:he.action,children:d}):null,d==null&&K?T.jsx(CL,{ownerState:pe,className:he.action,children:T.jsx(fe,nt({size:"small","aria-label":i,title:i,color:"inherit",onClick:K},_e,{children:T.jsx(Ce,nt({fontSize:"small"},je))}))}):null]}))});function Sre(e){return Ts("MuiTypography",e)}xs("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const Cre=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],Tre=e=>{const{align:n,gutterBottom:o,noWrap:c,paragraph:d,variant:y,classes:x}=e,i={root:["root",y,e.align!=="inherit"&&`align${qr(n)}`,o&&"gutterBottom",c&&"noWrap",d&&"paragraph"]};return Ms(i,Sre,x)},Ere=Mr("span",{name:"MuiTypography",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:o}=e;return[n.root,o.variant&&n[o.variant],o.align!=="inherit"&&n[`align${qr(o.align)}`],o.noWrap&&n.noWrap,o.gutterBottom&&n.gutterBottom,o.paragraph&&n.paragraph]}})(({theme:e,ownerState:n})=>nt({margin:0},n.variant==="inherit"&&{font:"inherit"},n.variant!=="inherit"&&e.typography[n.variant],n.align!=="inherit"&&{textAlign:n.align},n.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},n.gutterBottom&&{marginBottom:"0.35em"},n.paragraph&&{marginBottom:16})),IL={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},Ire={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},Pre=e=>Ire[e]||e,b5=V.forwardRef(function(n,o){const c=Ls({props:n,name:"MuiTypography"}),d=Pre(c.color),y=xT(nt({},c,{color:d})),{align:x="inherit",className:i,component:I,gutterBottom:R=!1,noWrap:k=!1,paragraph:N=!1,variant:U="body1",variantMapping:K=IL}=y,X=jr(y,Cre),Z=nt({},y,{align:x,color:d,className:i,component:I,gutterBottom:R,noWrap:k,paragraph:N,variant:U,variantMapping:K}),J=I||(N?"p":K[U]||IL[U])||"span",le=Tre(Z);return T.jsx(Ere,nt({as:J,ref:o,ownerState:Z,className:pi(le.root,i)},X))});function Are(e){return typeof e=="function"?e():e}const Rre=V.forwardRef(function(n,o){const{children:c,container:d,disablePortal:y=!1}=n,[x,i]=V.useState(null),I=pl(V.isValidElement(c)?rx(c):null,o);if(fg(()=>{y||i(Are(d)||document.body)},[d,y]),fg(()=>{if(x&&!y)return DS(o,x),()=>{DS(o,null)}},[o,x,y]),y){if(V.isValidElement(c)){const R={ref:I};return V.cloneElement(c,R)}return T.jsx(V.Fragment,{children:c})}return T.jsx(V.Fragment,{children:x&&BS.createPortal(c,x)})}),Mre=["onChange","maxRows","minRows","style","value"];function m0(e){return parseInt(e,10)||0}const Lre={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function Dre(e){for(const n in e)return!1;return!0}function PL(e){return Dre(e)||e.outerHeightStyle===0&&!e.overflowing}const kre=V.forwardRef(function(n,o){const{onChange:c,maxRows:d,minRows:y=1,style:x,value:i}=n,I=jr(n,Mre),{current:R}=V.useRef(i!=null),k=V.useRef(null),N=pl(o,k),U=V.useRef(null),K=V.useRef(null),X=V.useCallback(()=>{const ue=k.current,pe=K.current;if(!ue||!pe)return;const xe=pg(ue).getComputedStyle(ue);if(xe.width==="0px")return{outerHeightStyle:0,overflowing:!1};pe.style.width=xe.width,pe.value=ue.value||n.placeholder||"x",pe.value.slice(-1)===`
`&&(pe.value+=" ");const fe=xe.boxSizing,_e=m0(xe.paddingBottom)+m0(xe.paddingTop),Ce=m0(xe.borderBottomWidth)+m0(xe.borderTopWidth),je=pe.scrollHeight;pe.value="x";const He=pe.scrollHeight;let lt=je;y&&(lt=Math.max(Number(y)*He,lt)),d&&(lt=Math.min(Number(d)*He,lt)),lt=Math.max(lt,He);const _t=lt+(fe==="border-box"?_e+Ce:0),Ue=Math.abs(lt-je)<=1;return{outerHeightStyle:_t,overflowing:Ue}},[d,y,n.placeholder]),Z=tg(()=>{const ue=k.current,pe=X();if(!ue||!pe||PL(pe))return!1;const he=pe.outerHeightStyle;return U.current!=null&&U.current!==he}),J=V.useCallback(()=>{const ue=k.current,pe=X();if(!ue||!pe||PL(pe))return;const he=pe.outerHeightStyle;U.current!==he&&(U.current=he,ue.style.height=`${he}px`),ue.style.overflow=pe.overflowing?"hidden":""},[X]),le=V.useRef(-1);fg(()=>{const ue=c5(J),pe=k==null?void 0:k.current;if(!pe)return;const he=pg(pe);he.addEventListener("resize",ue);let xe;return typeof ResizeObserver<"u"&&(xe=new ResizeObserver(()=>{Z()&&(xe.unobserve(pe),cancelAnimationFrame(le.current),J(),le.current=requestAnimationFrame(()=>{xe.observe(pe)}))}),xe.observe(pe)),()=>{ue.clear(),cancelAnimationFrame(le.current),he.removeEventListener("resize",ue),xe&&xe.disconnect()}},[X,J,Z]),fg(()=>{J()});const de=ue=>{R||J(),c&&c(ue)};return T.jsxs(V.Fragment,{children:[T.jsx("textarea",nt({value:i,onChange:de,ref:N,rows:y,style:x},I)),T.jsx("textarea",{"aria-hidden":!0,className:n.className,readOnly:!0,ref:K,tabIndex:-1,style:nt({},Lre.shadow,x,{paddingTop:0,paddingBottom:0})})]})});function Z_({props:e,states:n,muiFormControl:o}){return n.reduce((c,d)=>(c[d]=e[d],o&&typeof e[d]>"u"&&(c[d]=o[d]),c),{})}const ET=V.createContext(void 0);function X_(){return V.useContext(ET)}function Ore(e){return T.jsx(pte,nt({},e,{defaultTheme:wT,themeId:X1}))}function AL(e){return e!=null&&!(Array.isArray(e)&&e.length===0)}function p1(e,n=!1){return e&&(AL(e.value)&&e.value!==""||n&&AL(e.defaultValue)&&e.defaultValue!=="")}function zre(e){return e.startAdornment}function Fre(e){return Ts("MuiInputBase",e)}const R_=xs("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),Nre=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],ob=(e,n)=>{const{ownerState:o}=e;return[n.root,o.formControl&&n.formControl,o.startAdornment&&n.adornedStart,o.endAdornment&&n.adornedEnd,o.error&&n.error,o.size==="small"&&n.sizeSmall,o.multiline&&n.multiline,o.color&&n[`color${qr(o.color)}`],o.fullWidth&&n.fullWidth,o.hiddenLabel&&n.hiddenLabel]},ab=(e,n)=>{const{ownerState:o}=e;return[n.input,o.size==="small"&&n.inputSizeSmall,o.multiline&&n.inputMultiline,o.type==="search"&&n.inputTypeSearch,o.startAdornment&&n.inputAdornedStart,o.endAdornment&&n.inputAdornedEnd,o.hiddenLabel&&n.inputHiddenLabel]},jre=e=>{const{classes:n,color:o,disabled:c,error:d,endAdornment:y,focused:x,formControl:i,fullWidth:I,hiddenLabel:R,multiline:k,readOnly:N,size:U,startAdornment:K,type:X}=e,Z={root:["root",`color${qr(o)}`,c&&"disabled",d&&"error",I&&"fullWidth",x&&"focused",i&&"formControl",U&&U!=="medium"&&`size${qr(U)}`,k&&"multiline",K&&"adornedStart",y&&"adornedEnd",R&&"hiddenLabel",N&&"readOnly"],input:["input",c&&"disabled",X==="search"&&"inputTypeSearch",k&&"inputMultiline",U==="small"&&"inputSizeSmall",R&&"inputHiddenLabel",K&&"inputAdornedStart",y&&"inputAdornedEnd",N&&"readOnly"]};return Ms(Z,Fre,n)},lb=Mr("div",{name:"MuiInputBase",slot:"Root",overridesResolver:ob})(({theme:e,ownerState:n})=>nt({},e.typography.body1,{color:(e.vars||e).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${R_.disabled}`]:{color:(e.vars||e).palette.text.disabled,cursor:"default"}},n.multiline&&nt({padding:"4px 0 5px"},n.size==="small"&&{paddingTop:1}),n.fullWidth&&{width:"100%"})),cb=Mr("input",{name:"MuiInputBase",slot:"Input",overridesResolver:ab})(({theme:e,ownerState:n})=>{const o=e.palette.mode==="light",c=nt({color:"currentColor"},e.vars?{opacity:e.vars.opacity.inputPlaceholder}:{opacity:o?.42:.5},{transition:e.transitions.create("opacity",{duration:e.transitions.duration.shorter})}),d={opacity:"0 !important"},y=e.vars?{opacity:e.vars.opacity.inputPlaceholder}:{opacity:o?.42:.5};return nt({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":c,"&::-moz-placeholder":c,"&:-ms-input-placeholder":c,"&::-ms-input-placeholder":c,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${R_.formControl} &`]:{"&::-webkit-input-placeholder":d,"&::-moz-placeholder":d,"&:-ms-input-placeholder":d,"&::-ms-input-placeholder":d,"&:focus::-webkit-input-placeholder":y,"&:focus::-moz-placeholder":y,"&:focus:-ms-input-placeholder":y,"&:focus::-ms-input-placeholder":y},[`&.${R_.disabled}`]:{opacity:1,WebkitTextFillColor:(e.vars||e).palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},n.size==="small"&&{paddingTop:1},n.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},n.type==="search"&&{MozAppearance:"textfield"})}),Bre=T.jsx(Ore,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),IT=V.forwardRef(function(n,o){var c;const d=Ls({props:n,name:"MuiInputBase"}),{"aria-describedby":y,autoComplete:x,autoFocus:i,className:I,components:R={},componentsProps:k={},defaultValue:N,disabled:U,disableInjectingGlobalStyles:K,endAdornment:X,fullWidth:Z=!1,id:J,inputComponent:le="input",inputProps:de={},inputRef:ue,maxRows:pe,minRows:he,multiline:xe=!1,name:fe,onBlur:_e,onChange:Ce,onClick:je,onFocus:He,onKeyDown:lt,onKeyUp:_t,placeholder:Ue,readOnly:Ge,renderSuffix:at,rows:yt,slotProps:tt={},slots:Rt={},startAdornment:ct,type:ze="text",value:Ye}=d,At=jr(d,Nre),Ct=de.value!=null?de.value:Ye,{current:We}=V.useRef(Ct!=null),st=V.useRef(),Bt=V.useCallback(ei=>{},[]),hn=pl(st,ue,de.ref,Bt),[cn,cr]=V.useState(!1),Nn=X_(),Vn=Z_({props:d,muiFormControl:Nn,states:["color","disabled","error","hiddenLabel","size","required","filled"]});Vn.focused=Nn?Nn.focused:cn,V.useEffect(()=>{!Nn&&U&&cn&&(cr(!1),_e&&_e())},[Nn,U,cn,_e]);const An=Nn&&Nn.onFilled,Zt=Nn&&Nn.onEmpty,mn=V.useCallback(ei=>{p1(ei)?An&&An():Zt&&Zt()},[An,Zt]);fg(()=>{We&&mn({value:Ct})},[Ct,mn,We]);const kr=ei=>{if(Vn.disabled){ei.stopPropagation();return}He&&He(ei),de.onFocus&&de.onFocus(ei),Nn&&Nn.onFocus?Nn.onFocus(ei):cr(!0)},Gr=ei=>{_e&&_e(ei),de.onBlur&&de.onBlur(ei),Nn&&Nn.onBlur?Nn.onBlur(ei):cr(!1)},Yr=(ei,...ur)=>{if(!We){const us=ei.target||st.current;if(us==null)throw new Error(hg(1));mn({value:us.value})}de.onChange&&de.onChange(ei,...ur),Ce&&Ce(ei,...ur)};V.useEffect(()=>{mn(st.current)},[]);const Xn=ei=>{st.current&&ei.currentTarget===ei.target&&st.current.focus(),je&&je(ei)};let Lr=le,Or=de;xe&&Lr==="input"&&(yt?Or=nt({type:void 0,minRows:yt,maxRows:yt},Or):Or=nt({type:void 0,maxRows:pe,minRows:he},Or),Lr=kre);const is=ei=>{mn(ei.animationName==="mui-auto-fill-cancel"?st.current:{value:"x"})};V.useEffect(()=>{Nn&&Nn.setAdornedStart(!!ct)},[Nn,ct]);const Zi=nt({},d,{color:Vn.color||"primary",disabled:Vn.disabled,endAdornment:X,error:Vn.error,focused:Vn.focused,formControl:Nn,fullWidth:Z,hiddenLabel:Vn.hiddenLabel,multiline:xe,size:Vn.size,startAdornment:ct,type:ze}),Dr=jre(Zi),Bi=Rt.root||R.Root||lb,Fr=tt.root||k.root||{},Xi=Rt.input||R.Input||cb;return Or=nt({},Or,(c=tt.input)!=null?c:k.input),T.jsxs(V.Fragment,{children:[!K&&Bre,T.jsxs(Bi,nt({},Fr,!h1(Bi)&&{ownerState:nt({},Zi,Fr.ownerState)},{ref:o,onClick:Xn},At,{className:pi(Dr.root,Fr.className,I,Ge&&"MuiInputBase-readOnly"),children:[ct,T.jsx(ET.Provider,{value:null,children:T.jsx(Xi,nt({ownerState:Zi,"aria-invalid":Vn.error,"aria-describedby":y,autoComplete:x,autoFocus:i,defaultValue:N,disabled:Vn.disabled,id:J,onAnimationStart:is,name:fe,placeholder:Ue,readOnly:Ge,required:Vn.required,rows:yt,value:Ct,onKeyDown:lt,onKeyUp:_t,type:ze},Or,!h1(Xi)&&{as:Lr,ownerState:nt({},Zi,Or.ownerState)},{ref:hn,className:pi(Dr.input,Or.className,Ge&&"MuiInputBase-readOnly"),onBlur:Gr,onChange:Yr,onFocus:kr}))}),X,at?at(nt({},Vn,{startAdornment:ct})):null]}))]})});function Vre(e){return Ts("MuiInput",e)}const Yy=nt({},R_,xs("MuiInput",["root","underline","input"]));function Ure(e){return Ts("MuiOutlinedInput",e)}const Mp=nt({},R_,xs("MuiOutlinedInput",["root","notchedOutline","input"]));function $re(e){return Ts("MuiFilledInput",e)}const Xm=nt({},R_,xs("MuiFilledInput",["root","underline","input"])),Hre=q_(T.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),Gre=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],Wre={entering:{opacity:1},entered:{opacity:1}},w5=V.forwardRef(function(n,o){const c=ST(),d={enter:c.transitions.duration.enteringScreen,exit:c.transitions.duration.leavingScreen},{addEndListener:y,appear:x=!0,children:i,easing:I,in:R,onEnter:k,onEntered:N,onEntering:U,onExit:K,onExited:X,onExiting:Z,style:J,timeout:le=d,TransitionComponent:de=fd}=n,ue=jr(n,Gre),pe=V.useRef(null),he=pl(pe,rx(i),o),xe=Ue=>Ge=>{if(Ue){const at=pe.current;Ge===void 0?Ue(at):Ue(at,Ge)}},fe=xe(U),_e=xe((Ue,Ge)=>{v5(Ue);const at=f1({style:J,timeout:le,easing:I},{mode:"enter"});Ue.style.webkitTransition=c.transitions.create("opacity",at),Ue.style.transition=c.transitions.create("opacity",at),k&&k(Ue,Ge)}),Ce=xe(N),je=xe(Z),He=xe(Ue=>{const Ge=f1({style:J,timeout:le,easing:I},{mode:"exit"});Ue.style.webkitTransition=c.transitions.create("opacity",Ge),Ue.style.transition=c.transitions.create("opacity",Ge),K&&K(Ue)}),lt=xe(X),_t=Ue=>{y&&y(pe.current,Ue)};return T.jsx(de,nt({appear:x,in:R,nodeRef:pe,onEnter:_e,onEntered:Ce,onEntering:fe,onExit:He,onExited:lt,onExiting:je,addEndListener:_t,timeout:le},ue,{children:(Ue,Ge)=>V.cloneElement(i,nt({style:nt({opacity:0,visibility:Ue==="exited"&&!R?"hidden":void 0},Wre[Ue],J,i.props.style),ref:he},Ge))}))});function qre(e){return Ts("MuiBackdrop",e)}xs("MuiBackdrop",["root","invisible"]);const Zre=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],Xre=e=>{const{classes:n,invisible:o}=e;return Ms({root:["root",o&&"invisible"]},qre,n)},Kre=Mr("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:o}=e;return[n.root,o.invisible&&n.invisible]}})(({ownerState:e})=>nt({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},e.invisible&&{backgroundColor:"transparent"})),S5=V.forwardRef(function(n,o){var c,d,y;const x=Ls({props:n,name:"MuiBackdrop"}),{children:i,className:I,component:R="div",components:k={},componentsProps:N={},invisible:U=!1,open:K,slotProps:X={},slots:Z={},TransitionComponent:J=w5,transitionDuration:le}=x,de=jr(x,Zre),ue=nt({},x,{component:R,invisible:U}),pe=Xre(ue),he=(c=X.root)!=null?c:N.root;return T.jsx(J,nt({in:K,timeout:le},de,{children:T.jsx(Kre,nt({"aria-hidden":!0},he,{as:(d=(y=Z.root)!=null?y:k.Root)!=null?d:R,className:pi(pe.root,I,he==null?void 0:he.className),ownerState:nt({},ue,he==null?void 0:he.ownerState),classes:pe,ref:o,children:i}))}))}),Yre=xs("MuiBox",["root"]),Jre=_5(),Qre=xte({themeId:X1,defaultTheme:Jre,defaultClassName:Yre.root,generateClassName:s5.generate});function eie(e){return Ts("MuiButton",e)}const g0=xs("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),tie=V.createContext({}),nie=V.createContext(void 0),rie=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],iie=e=>{const{color:n,disableElevation:o,fullWidth:c,size:d,variant:y,classes:x}=e,i={root:["root",y,`${y}${qr(n)}`,`size${qr(d)}`,`${y}Size${qr(d)}`,`color${qr(n)}`,o&&"disableElevation",c&&"fullWidth"],label:["label"],startIcon:["icon","startIcon",`iconSize${qr(d)}`],endIcon:["icon","endIcon",`iconSize${qr(d)}`]},I=Ms(i,eie,x);return nt({},x,I)},C5=e=>nt({},e.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},e.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},e.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),sie=Mr(x5,{shouldForwardProp:e=>md(e)||e==="classes",name:"MuiButton",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:o}=e;return[n.root,n[o.variant],n[`${o.variant}${qr(o.color)}`],n[`size${qr(o.size)}`],n[`${o.variant}Size${qr(o.size)}`],o.color==="inherit"&&n.colorInherit,o.disableElevation&&n.disableElevation,o.fullWidth&&n.fullWidth]}})(({theme:e,ownerState:n})=>{var o,c;const d=e.palette.mode==="light"?e.palette.grey[300]:e.palette.grey[800],y=e.palette.mode==="light"?e.palette.grey.A100:e.palette.grey[700];return nt({},e.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create(["background-color","box-shadow","border-color","color"],{duration:e.transitions.duration.short}),"&:hover":nt({textDecoration:"none",backgroundColor:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / ${e.vars.palette.action.hoverOpacity})`:fl.alpha(e.palette.text.primary,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},n.variant==="text"&&n.color!=="inherit"&&{backgroundColor:e.vars?`rgba(${e.vars.palette[n.color].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:fl.alpha(e.palette[n.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},n.variant==="outlined"&&n.color!=="inherit"&&{border:`1px solid ${(e.vars||e).palette[n.color].main}`,backgroundColor:e.vars?`rgba(${e.vars.palette[n.color].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:fl.alpha(e.palette[n.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},n.variant==="contained"&&{backgroundColor:e.vars?e.vars.palette.Button.inheritContainedHoverBg:y,boxShadow:(e.vars||e).shadows[4],"@media (hover: none)":{boxShadow:(e.vars||e).shadows[2],backgroundColor:(e.vars||e).palette.grey[300]}},n.variant==="contained"&&n.color!=="inherit"&&{backgroundColor:(e.vars||e).palette[n.color].dark,"@media (hover: none)":{backgroundColor:(e.vars||e).palette[n.color].main}}),"&:active":nt({},n.variant==="contained"&&{boxShadow:(e.vars||e).shadows[8]}),[`&.${g0.focusVisible}`]:nt({},n.variant==="contained"&&{boxShadow:(e.vars||e).shadows[6]}),[`&.${g0.disabled}`]:nt({color:(e.vars||e).palette.action.disabled},n.variant==="outlined"&&{border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`},n.variant==="contained"&&{color:(e.vars||e).palette.action.disabled,boxShadow:(e.vars||e).shadows[0],backgroundColor:(e.vars||e).palette.action.disabledBackground})},n.variant==="text"&&{padding:"6px 8px"},n.variant==="text"&&n.color!=="inherit"&&{color:(e.vars||e).palette[n.color].main},n.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},n.variant==="outlined"&&n.color!=="inherit"&&{color:(e.vars||e).palette[n.color].main,border:e.vars?`1px solid rgba(${e.vars.palette[n.color].mainChannel} / 0.5)`:`1px solid ${fl.alpha(e.palette[n.color].main,.5)}`},n.variant==="contained"&&{color:e.vars?e.vars.palette.text.primary:(o=(c=e.palette).getContrastText)==null?void 0:o.call(c,e.palette.grey[300]),backgroundColor:e.vars?e.vars.palette.Button.inheritContainedBg:d,boxShadow:(e.vars||e).shadows[2]},n.variant==="contained"&&n.color!=="inherit"&&{color:(e.vars||e).palette[n.color].contrastText,backgroundColor:(e.vars||e).palette[n.color].main},n.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},n.size==="small"&&n.variant==="text"&&{padding:"4px 5px",fontSize:e.typography.pxToRem(13)},n.size==="large"&&n.variant==="text"&&{padding:"8px 11px",fontSize:e.typography.pxToRem(15)},n.size==="small"&&n.variant==="outlined"&&{padding:"3px 9px",fontSize:e.typography.pxToRem(13)},n.size==="large"&&n.variant==="outlined"&&{padding:"7px 21px",fontSize:e.typography.pxToRem(15)},n.size==="small"&&n.variant==="contained"&&{padding:"4px 10px",fontSize:e.typography.pxToRem(13)},n.size==="large"&&n.variant==="contained"&&{padding:"8px 22px",fontSize:e.typography.pxToRem(15)},n.fullWidth&&{width:"100%"})},({ownerState:e})=>e.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${g0.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${g0.disabled}`]:{boxShadow:"none"}}),oie=Mr("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,n)=>{const{ownerState:o}=e;return[n.startIcon,n[`iconSize${qr(o.size)}`]]}})(({ownerState:e})=>nt({display:"inherit",marginRight:8,marginLeft:-4},e.size==="small"&&{marginLeft:-2},C5(e))),aie=Mr("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,n)=>{const{ownerState:o}=e;return[n.endIcon,n[`iconSize${qr(o.size)}`]]}})(({ownerState:e})=>nt({display:"inherit",marginRight:-4,marginLeft:8},e.size==="small"&&{marginRight:-2},C5(e))),FS=V.forwardRef(function(n,o){const c=V.useContext(tie),d=V.useContext(nie),y=d1(c,n),x=Ls({props:y,name:"MuiButton"}),{children:i,color:I="primary",component:R="button",className:k,disabled:N=!1,disableElevation:U=!1,disableFocusRipple:K=!1,endIcon:X,focusVisibleClassName:Z,fullWidth:J=!1,size:le="medium",startIcon:de,type:ue,variant:pe="text"}=x,he=jr(x,rie),xe=nt({},x,{color:I,component:R,disabled:N,disableElevation:U,disableFocusRipple:K,fullWidth:J,size:le,type:ue,variant:pe}),fe=iie(xe),_e=de&&T.jsx(oie,{className:fe.startIcon,ownerState:xe,children:de}),Ce=X&&T.jsx(aie,{className:fe.endIcon,ownerState:xe,children:X}),je=d||"";return T.jsxs(sie,nt({ownerState:xe,className:pi(c.className,fe.root,k,je),component:R,disabled:N,focusRipple:!K,focusVisibleClassName:pi(fe.focusVisible,Z),ref:o,type:ue},he,{classes:fe,children:[_e,i,Ce]}))});function lie(e){return Ts("MuiCircularProgress",e)}xs("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const cie=["className","color","disableShrink","size","style","thickness","value","variant"];let ub=e=>e,RL,ML,LL,DL;const Lp=44,uie=vg(RL||(RL=ub`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`)),die=vg(ML||(ML=ub`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`)),hie=e=>{const{classes:n,variant:o,color:c,disableShrink:d}=e,y={root:["root",o,`color${qr(c)}`],svg:["svg"],circle:["circle",`circle${qr(o)}`,d&&"circleDisableShrink"]};return Ms(y,lie,n)},fie=Mr("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:o}=e;return[n.root,n[o.variant],n[`color${qr(o.color)}`]]}})(({ownerState:e,theme:n})=>nt({display:"inline-block"},e.variant==="determinate"&&{transition:n.transitions.create("transform")},e.color!=="inherit"&&{color:(n.vars||n).palette[e.color].main}),({ownerState:e})=>e.variant==="indeterminate"&&G_(LL||(LL=ub`
      animation: ${0} 1.4s linear infinite;
    `),uie)),pie=Mr("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(e,n)=>n.svg})({display:"block"}),mie=Mr("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(e,n)=>{const{ownerState:o}=e;return[n.circle,n[`circle${qr(o.variant)}`],o.disableShrink&&n.circleDisableShrink]}})(({ownerState:e,theme:n})=>nt({stroke:"currentColor"},e.variant==="determinate"&&{transition:n.transitions.create("stroke-dashoffset")},e.variant==="indeterminate"&&{strokeDasharray:"80px, 200px",strokeDashoffset:0}),({ownerState:e})=>e.variant==="indeterminate"&&!e.disableShrink&&G_(DL||(DL=ub`
      animation: ${0} 1.4s ease-in-out infinite;
    `),die)),gie=V.forwardRef(function(n,o){const c=Ls({props:n,name:"MuiCircularProgress"}),{className:d,color:y="primary",disableShrink:x=!1,size:i=40,style:I,thickness:R=3.6,value:k=0,variant:N="indeterminate"}=c,U=jr(c,cie),K=nt({},c,{color:y,disableShrink:x,size:i,thickness:R,value:k,variant:N}),X=hie(K),Z={},J={},le={};if(N==="determinate"){const de=2*Math.PI*((Lp-R)/2);Z.strokeDasharray=de.toFixed(3),le["aria-valuenow"]=Math.round(k),Z.strokeDashoffset=`${((100-k)/100*de).toFixed(3)}px`,J.transform="rotate(-90deg)"}return T.jsx(fie,nt({className:pi(X.root,d),style:nt({width:i,height:i},J,I),ownerState:K,ref:o,role:"progressbar"},le,U,{children:T.jsx(pie,{className:X.svg,ownerState:K,viewBox:`${Lp/2} ${Lp/2} ${Lp} ${Lp}`,children:T.jsx(mie,{className:X.circle,style:Z,ownerState:K,cx:Lp,cy:Lp,r:(Lp-R)/2,fill:"none",strokeWidth:R})})}))});function _ie(e){const n=kc(e);return n.body===e?pg(e).innerWidth>n.documentElement.clientWidth:e.scrollHeight>e.clientHeight}function mv(e,n){n?e.setAttribute("aria-hidden","true"):e.removeAttribute("aria-hidden")}function kL(e){return parseInt(pg(e).getComputedStyle(e).paddingRight,10)||0}function yie(e){const o=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(e.tagName)!==-1,c=e.tagName==="INPUT"&&e.getAttribute("type")==="hidden";return o||c}function OL(e,n,o,c,d){const y=[n,o,...c];[].forEach.call(e.children,x=>{const i=y.indexOf(x)===-1,I=!yie(x);i&&I&&mv(x,d)})}function C2(e,n){let o=-1;return e.some((c,d)=>n(c)?(o=d,!0):!1),o}function vie(e,n){const o=[],c=e.container;if(!n.disableScrollLock){if(_ie(c)){const x=d5(kc(c));o.push({value:c.style.paddingRight,property:"padding-right",el:c}),c.style.paddingRight=`${kL(c)+x}px`;const i=kc(c).querySelectorAll(".mui-fixed");[].forEach.call(i,I=>{o.push({value:I.style.paddingRight,property:"padding-right",el:I}),I.style.paddingRight=`${kL(I)+x}px`})}let y;if(c.parentNode instanceof DocumentFragment)y=kc(c).body;else{const x=c.parentElement,i=pg(c);y=(x==null?void 0:x.nodeName)==="HTML"&&i.getComputedStyle(x).overflowY==="scroll"?x:c}o.push({value:y.style.overflow,property:"overflow",el:y},{value:y.style.overflowX,property:"overflow-x",el:y},{value:y.style.overflowY,property:"overflow-y",el:y}),y.style.overflow="hidden"}return()=>{o.forEach(({value:y,el:x,property:i})=>{y?x.style.setProperty(i,y):x.style.removeProperty(i)})}}function xie(e){const n=[];return[].forEach.call(e.children,o=>{o.getAttribute("aria-hidden")==="true"&&n.push(o)}),n}class bie{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(n,o){let c=this.modals.indexOf(n);if(c!==-1)return c;c=this.modals.length,this.modals.push(n),n.modalRef&&mv(n.modalRef,!1);const d=xie(o);OL(o,n.mount,n.modalRef,d,!0);const y=C2(this.containers,x=>x.container===o);return y!==-1?(this.containers[y].modals.push(n),c):(this.containers.push({modals:[n],container:o,restore:null,hiddenSiblings:d}),c)}mount(n,o){const c=C2(this.containers,y=>y.modals.indexOf(n)!==-1),d=this.containers[c];d.restore||(d.restore=vie(d,o))}remove(n,o=!0){const c=this.modals.indexOf(n);if(c===-1)return c;const d=C2(this.containers,x=>x.modals.indexOf(n)!==-1),y=this.containers[d];if(y.modals.splice(y.modals.indexOf(n),1),this.modals.splice(c,1),y.modals.length===0)y.restore&&y.restore(),n.modalRef&&mv(n.modalRef,o),OL(y.container,n.mount,n.modalRef,y.hiddenSiblings,!1),this.containers.splice(d,1);else{const x=y.modals[y.modals.length-1];x.modalRef&&mv(x.modalRef,!1)}return c}isTopModal(n){return this.modals.length>0&&this.modals[this.modals.length-1]===n}}const wie=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function Sie(e){const n=parseInt(e.getAttribute("tabindex")||"",10);return Number.isNaN(n)?e.contentEditable==="true"||(e.nodeName==="AUDIO"||e.nodeName==="VIDEO"||e.nodeName==="DETAILS")&&e.getAttribute("tabindex")===null?0:e.tabIndex:n}function Cie(e){if(e.tagName!=="INPUT"||e.type!=="radio"||!e.name)return!1;const n=c=>e.ownerDocument.querySelector(`input[type="radio"]${c}`);let o=n(`[name="${e.name}"]:checked`);return o||(o=n(`[name="${e.name}"]`)),o!==e}function Tie(e){return!(e.disabled||e.tagName==="INPUT"&&e.type==="hidden"||Cie(e))}function Eie(e){const n=[],o=[];return Array.from(e.querySelectorAll(wie)).forEach((c,d)=>{const y=Sie(c);y===-1||!Tie(c)||(y===0?n.push(c):o.push({documentOrder:d,tabIndex:y,node:c}))}),o.sort((c,d)=>c.tabIndex===d.tabIndex?c.documentOrder-d.documentOrder:c.tabIndex-d.tabIndex).map(c=>c.node).concat(n)}function Iie(){return!0}function Pie(e){const{children:n,disableAutoFocus:o=!1,disableEnforceFocus:c=!1,disableRestoreFocus:d=!1,getTabbable:y=Eie,isEnabled:x=Iie,open:i}=e,I=V.useRef(!1),R=V.useRef(null),k=V.useRef(null),N=V.useRef(null),U=V.useRef(null),K=V.useRef(!1),X=V.useRef(null),Z=pl(rx(n),X),J=V.useRef(null);V.useEffect(()=>{!i||!X.current||(K.current=!o)},[o,i]),V.useEffect(()=>{if(!i||!X.current)return;const ue=kc(X.current);return X.current.contains(ue.activeElement)||(X.current.hasAttribute("tabIndex")||X.current.setAttribute("tabIndex","-1"),K.current&&X.current.focus()),()=>{d||(N.current&&N.current.focus&&(I.current=!0,N.current.focus()),N.current=null)}},[i]),V.useEffect(()=>{if(!i||!X.current)return;const ue=kc(X.current),pe=fe=>{J.current=fe,!(c||!x()||fe.key!=="Tab")&&ue.activeElement===X.current&&fe.shiftKey&&(I.current=!0,k.current&&k.current.focus())},he=()=>{const fe=X.current;if(fe===null)return;if(!ue.hasFocus()||!x()||I.current){I.current=!1;return}if(fe.contains(ue.activeElement)||c&&ue.activeElement!==R.current&&ue.activeElement!==k.current)return;if(ue.activeElement!==U.current)U.current=null;else if(U.current!==null)return;if(!K.current)return;let _e=[];if((ue.activeElement===R.current||ue.activeElement===k.current)&&(_e=y(X.current)),_e.length>0){var Ce,je;const He=!!((Ce=J.current)!=null&&Ce.shiftKey&&((je=J.current)==null?void 0:je.key)==="Tab"),lt=_e[0],_t=_e[_e.length-1];typeof lt!="string"&&typeof _t!="string"&&(He?_t.focus():lt.focus())}else fe.focus()};ue.addEventListener("focusin",he),ue.addEventListener("keydown",pe,!0);const xe=setInterval(()=>{ue.activeElement&&ue.activeElement.tagName==="BODY"&&he()},50);return()=>{clearInterval(xe),ue.removeEventListener("focusin",he),ue.removeEventListener("keydown",pe,!0)}},[o,c,d,x,i,y]);const le=ue=>{N.current===null&&(N.current=ue.relatedTarget),K.current=!0,U.current=ue.target;const pe=n.props.onFocus;pe&&pe(ue)},de=ue=>{N.current===null&&(N.current=ue.relatedTarget),K.current=!0};return T.jsxs(V.Fragment,{children:[T.jsx("div",{tabIndex:i?0:-1,onFocus:de,ref:R,"data-testid":"sentinelStart"}),V.cloneElement(n,{ref:Z,onFocus:le}),T.jsx("div",{tabIndex:i?0:-1,onFocus:de,ref:k,"data-testid":"sentinelEnd"})]})}function Aie(e){return typeof e=="function"?e():e}function Rie(e){return e?e.props.hasOwnProperty("in"):!1}const Mie=new bie;function Lie(e){const{container:n,disableEscapeKeyDown:o=!1,disableScrollLock:c=!1,manager:d=Mie,closeAfterTransition:y=!1,onTransitionEnter:x,onTransitionExited:i,children:I,onClose:R,open:k,rootRef:N}=e,U=V.useRef({}),K=V.useRef(null),X=V.useRef(null),Z=pl(X,N),[J,le]=V.useState(!k),de=Rie(I);let ue=!0;(e["aria-hidden"]==="false"||e["aria-hidden"]===!1)&&(ue=!1);const pe=()=>kc(K.current),he=()=>(U.current.modalRef=X.current,U.current.mount=K.current,U.current),xe=()=>{d.mount(he(),{disableScrollLock:c}),X.current&&(X.current.scrollTop=0)},fe=tg(()=>{const at=Aie(n)||pe().body;d.add(he(),at),X.current&&xe()}),_e=V.useCallback(()=>d.isTopModal(he()),[d]),Ce=tg(at=>{K.current=at,at&&(k&&_e()?xe():X.current&&mv(X.current,ue))}),je=V.useCallback(()=>{d.remove(he(),ue)},[ue,d]);V.useEffect(()=>()=>{je()},[je]),V.useEffect(()=>{k?fe():(!de||!y)&&je()},[k,je,de,y,fe]);const He=at=>yt=>{var tt;(tt=at.onKeyDown)==null||tt.call(at,yt),!(yt.key!=="Escape"||yt.which===229||!_e())&&(o||(yt.stopPropagation(),R&&R(yt,"escapeKeyDown")))},lt=at=>yt=>{var tt;(tt=at.onClick)==null||tt.call(at,yt),yt.target===yt.currentTarget&&R&&R(yt,"backdropClick")};return{getRootProps:(at={})=>{const yt=f5(e);delete yt.onTransitionEnter,delete yt.onTransitionExited;const tt=nt({},yt,at);return nt({role:"presentation"},tt,{onKeyDown:He(tt),ref:Z})},getBackdropProps:(at={})=>{const yt=at;return nt({"aria-hidden":!0},yt,{onClick:lt(yt),open:k})},getTransitionProps:()=>{const at=()=>{le(!1),x&&x()},yt=()=>{le(!0),i&&i(),y&&je()};return{onEnter:tL(at,I==null?void 0:I.props.onEnter),onExited:tL(yt,I==null?void 0:I.props.onExited)}},rootRef:Z,portalRef:Ce,isTopModal:_e,exited:J,hasTransition:de}}function Die(e){return Ts("MuiModal",e)}xs("MuiModal",["root","hidden","backdrop"]);const kie=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","onTransitionEnter","onTransitionExited","open","slotProps","slots","theme"],Oie=e=>{const{open:n,exited:o,classes:c}=e;return Ms({root:["root",!n&&o&&"hidden"],backdrop:["backdrop"]},Die,c)},zie=Mr("div",{name:"MuiModal",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:o}=e;return[n.root,!o.open&&o.exited&&n.hidden]}})(({theme:e,ownerState:n})=>nt({position:"fixed",zIndex:(e.vars||e).zIndex.modal,right:0,bottom:0,top:0,left:0},!n.open&&n.exited&&{visibility:"hidden"})),Fie=Mr(S5,{name:"MuiModal",slot:"Backdrop",overridesResolver:(e,n)=>n.backdrop})({zIndex:-1}),T5=V.forwardRef(function(n,o){var c,d,y,x,i,I;const R=Ls({name:"MuiModal",props:n}),{BackdropComponent:k=Fie,BackdropProps:N,className:U,closeAfterTransition:K=!1,children:X,container:Z,component:J,components:le={},componentsProps:de={},disableAutoFocus:ue=!1,disableEnforceFocus:pe=!1,disableEscapeKeyDown:he=!1,disablePortal:xe=!1,disableRestoreFocus:fe=!1,disableScrollLock:_e=!1,hideBackdrop:Ce=!1,keepMounted:je=!1,onBackdropClick:He,open:lt,slotProps:_t,slots:Ue}=R,Ge=jr(R,kie),at=nt({},R,{closeAfterTransition:K,disableAutoFocus:ue,disableEnforceFocus:pe,disableEscapeKeyDown:he,disablePortal:xe,disableRestoreFocus:fe,disableScrollLock:_e,hideBackdrop:Ce,keepMounted:je}),{getRootProps:yt,getBackdropProps:tt,getTransitionProps:Rt,portalRef:ct,isTopModal:ze,exited:Ye,hasTransition:At}=Lie(nt({},at,{rootRef:o})),Ct=nt({},at,{exited:Ye}),We=Oie(Ct),st={};if(X.props.tabIndex===void 0&&(st.tabIndex="-1"),At){const{onEnter:An,onExited:Zt}=Rt();st.onEnter=An,st.onExited=Zt}const Bt=(c=(d=Ue==null?void 0:Ue.root)!=null?d:le.Root)!=null?c:zie,hn=(y=(x=Ue==null?void 0:Ue.backdrop)!=null?x:le.Backdrop)!=null?y:k,cn=(i=_t==null?void 0:_t.root)!=null?i:de.root,cr=(I=_t==null?void 0:_t.backdrop)!=null?I:de.backdrop,Nn=A_({elementType:Bt,externalSlotProps:cn,externalForwardedProps:Ge,getSlotProps:yt,additionalProps:{ref:o,as:J},ownerState:Ct,className:pi(U,cn==null?void 0:cn.className,We==null?void 0:We.root,!Ct.open&&Ct.exited&&(We==null?void 0:We.hidden))}),Vn=A_({elementType:hn,externalSlotProps:cr,additionalProps:N,getSlotProps:An=>tt(nt({},An,{onClick:Zt=>{He&&He(Zt),An!=null&&An.onClick&&An.onClick(Zt)}})),className:pi(cr==null?void 0:cr.className,N==null?void 0:N.className,We==null?void 0:We.backdrop),ownerState:Ct});return!je&&!lt&&(!At||Ye)?null:T.jsx(Rre,{ref:ct,container:Z,disablePortal:xe,children:T.jsxs(Bt,nt({},Nn,{children:[!Ce&&k?T.jsx(hn,nt({},Vn)):null,T.jsx(Pie,{disableEnforceFocus:pe,disableAutoFocus:ue,disableRestoreFocus:fe,isEnabled:ze,open:lt,children:V.cloneElement(X,st)})]}))})});function Nie(e){return Ts("MuiDialog",e)}const T2=xs("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),E5=V.createContext({}),jie=["aria-describedby","aria-labelledby","BackdropComponent","BackdropProps","children","className","disableEscapeKeyDown","fullScreen","fullWidth","maxWidth","onBackdropClick","onClick","onClose","open","PaperComponent","PaperProps","scroll","TransitionComponent","transitionDuration","TransitionProps"],Bie=Mr(S5,{name:"MuiDialog",slot:"Backdrop",overrides:(e,n)=>n.backdrop})({zIndex:-1}),Vie=e=>{const{classes:n,scroll:o,maxWidth:c,fullWidth:d,fullScreen:y}=e,x={root:["root"],container:["container",`scroll${qr(o)}`],paper:["paper",`paperScroll${qr(o)}`,`paperWidth${qr(String(c))}`,d&&"paperFullWidth",y&&"paperFullScreen"]};return Ms(x,Nie,n)},Uie=Mr(T5,{name:"MuiDialog",slot:"Root",overridesResolver:(e,n)=>n.root})({"@media print":{position:"absolute !important"}}),$ie=Mr("div",{name:"MuiDialog",slot:"Container",overridesResolver:(e,n)=>{const{ownerState:o}=e;return[n.container,n[`scroll${qr(o.scroll)}`]]}})(({ownerState:e})=>nt({height:"100%","@media print":{height:"auto"},outline:0},e.scroll==="paper"&&{display:"flex",justifyContent:"center",alignItems:"center"},e.scroll==="body"&&{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}})),Hie=Mr(ib,{name:"MuiDialog",slot:"Paper",overridesResolver:(e,n)=>{const{ownerState:o}=e;return[n.paper,n[`scrollPaper${qr(o.scroll)}`],n[`paperWidth${qr(String(o.maxWidth))}`],o.fullWidth&&n.paperFullWidth,o.fullScreen&&n.paperFullScreen]}})(({theme:e,ownerState:n})=>nt({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"}},n.scroll==="paper"&&{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"},n.scroll==="body"&&{display:"inline-block",verticalAlign:"middle",textAlign:"left"},!n.maxWidth&&{maxWidth:"calc(100% - 64px)"},n.maxWidth==="xs"&&{maxWidth:e.breakpoints.unit==="px"?Math.max(e.breakpoints.values.xs,444):`max(${e.breakpoints.values.xs}${e.breakpoints.unit}, 444px)`,[`&.${T2.paperScrollBody}`]:{[e.breakpoints.down(Math.max(e.breakpoints.values.xs,444)+32*2)]:{maxWidth:"calc(100% - 64px)"}}},n.maxWidth&&n.maxWidth!=="xs"&&{maxWidth:`${e.breakpoints.values[n.maxWidth]}${e.breakpoints.unit}`,[`&.${T2.paperScrollBody}`]:{[e.breakpoints.down(e.breakpoints.values[n.maxWidth]+32*2)]:{maxWidth:"calc(100% - 64px)"}}},n.fullWidth&&{width:"calc(100% - 64px)"},n.fullScreen&&{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${T2.paperScrollBody}`]:{margin:0,maxWidth:"100%"}})),Gie=V.forwardRef(function(n,o){const c=Ls({props:n,name:"MuiDialog"}),d=ST(),y={enter:d.transitions.duration.enteringScreen,exit:d.transitions.duration.leavingScreen},{"aria-describedby":x,"aria-labelledby":i,BackdropComponent:I,BackdropProps:R,children:k,className:N,disableEscapeKeyDown:U=!1,fullScreen:K=!1,fullWidth:X=!1,maxWidth:Z="sm",onBackdropClick:J,onClick:le,onClose:de,open:ue,PaperComponent:pe=ib,PaperProps:he={},scroll:xe="paper",TransitionComponent:fe=w5,transitionDuration:_e=y,TransitionProps:Ce}=c,je=jr(c,jie),He=nt({},c,{disableEscapeKeyDown:U,fullScreen:K,fullWidth:X,maxWidth:Z,scroll:xe}),lt=Vie(He),_t=V.useRef(),Ue=tt=>{_t.current=tt.target===tt.currentTarget},Ge=tt=>{le&&le(tt),_t.current&&(_t.current=null,J&&J(tt),de&&de(tt,"backdropClick"))},at=bT(i),yt=V.useMemo(()=>({titleId:at}),[at]);return T.jsx(Uie,nt({className:pi(lt.root,N),closeAfterTransition:!0,components:{Backdrop:Bie},componentsProps:{backdrop:nt({transitionDuration:_e,as:I},R)},disableEscapeKeyDown:U,onClose:de,open:ue,ref:o,onClick:Ge,ownerState:He},je,{children:T.jsx(fe,nt({appear:!0,in:ue,timeout:_e,role:"presentation"},Ce,{children:T.jsx($ie,{className:pi(lt.container),onMouseDown:Ue,ownerState:He,children:T.jsx(Hie,nt({as:pe,elevation:24,role:"dialog","aria-describedby":x,"aria-labelledby":at},he,{className:pi(lt.paper,he.className),ownerState:He,children:T.jsx(E5.Provider,{value:yt,children:k})}))})}))}))});function Wie(e){return Ts("MuiDialogActions",e)}xs("MuiDialogActions",["root","spacing"]);const qie=["className","disableSpacing"],Zie=e=>{const{classes:n,disableSpacing:o}=e;return Ms({root:["root",!o&&"spacing"]},Wie,n)},Xie=Mr("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:o}=e;return[n.root,!o.disableSpacing&&n.spacing]}})(({ownerState:e})=>nt({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto"},!e.disableSpacing&&{"& > :not(style) ~ :not(style)":{marginLeft:8}})),Kie=V.forwardRef(function(n,o){const c=Ls({props:n,name:"MuiDialogActions"}),{className:d,disableSpacing:y=!1}=c,x=jr(c,qie),i=nt({},c,{disableSpacing:y}),I=Zie(i);return T.jsx(Xie,nt({className:pi(I.root,d),ownerState:i,ref:o},x))});function Yie(e){return Ts("MuiDialogContent",e)}xs("MuiDialogContent",["root","dividers"]);function Jie(e){return Ts("MuiDialogTitle",e)}const Qie=xs("MuiDialogTitle",["root"]),ese=["className","dividers"],tse=e=>{const{classes:n,dividers:o}=e;return Ms({root:["root",o&&"dividers"]},Yie,n)},nse=Mr("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:o}=e;return[n.root,o.dividers&&n.dividers]}})(({theme:e,ownerState:n})=>nt({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px"},n.dividers?{padding:"16px 24px",borderTop:`1px solid ${(e.vars||e).palette.divider}`,borderBottom:`1px solid ${(e.vars||e).palette.divider}`}:{[`.${Qie.root} + &`]:{paddingTop:0}})),rse=V.forwardRef(function(n,o){const c=Ls({props:n,name:"MuiDialogContent"}),{className:d,dividers:y=!1}=c,x=jr(c,ese),i=nt({},c,{dividers:y}),I=tse(i);return T.jsx(nse,nt({className:pi(I.root,d),ownerState:i,ref:o},x))}),ise=["className","id"],sse=e=>{const{classes:n}=e;return Ms({root:["root"]},Jie,n)},ose=Mr(b5,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(e,n)=>n.root})({padding:"16px 24px",flex:"0 0 auto"}),ase=V.forwardRef(function(n,o){const c=Ls({props:n,name:"MuiDialogTitle"}),{className:d,id:y}=c,x=jr(c,ise),i=c,I=sse(i),{titleId:R=y}=V.useContext(E5);return T.jsx(ose,nt({component:"h2",className:pi(I.root,d),ownerState:i,ref:o,variant:"h6",id:y??R},x))}),lse=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],cse=e=>{const{classes:n,disableUnderline:o}=e,d=Ms({root:["root",!o&&"underline"],input:["input"]},$re,n);return nt({},n,d)},use=Mr(lb,{shouldForwardProp:e=>md(e)||e==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:o}=e;return[...ob(e,n),!o.disableUnderline&&n.underline]}})(({theme:e,ownerState:n})=>{var o;const c=e.palette.mode==="light",d=c?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",y=c?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",x=c?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",i=c?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return nt({position:"relative",backgroundColor:e.vars?e.vars.palette.FilledInput.bg:y,borderTopLeftRadius:(e.vars||e).shape.borderRadius,borderTopRightRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),"&:hover":{backgroundColor:e.vars?e.vars.palette.FilledInput.hoverBg:x,"@media (hover: none)":{backgroundColor:e.vars?e.vars.palette.FilledInput.bg:y}},[`&.${Xm.focused}`]:{backgroundColor:e.vars?e.vars.palette.FilledInput.bg:y},[`&.${Xm.disabled}`]:{backgroundColor:e.vars?e.vars.palette.FilledInput.disabledBg:i}},!n.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(o=(e.vars||e).palette[n.color||"primary"])==null?void 0:o.main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Xm.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Xm.error}`]:{"&::before, &::after":{borderBottomColor:(e.vars||e).palette.error.main}},"&::before":{borderBottom:`1px solid ${e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / ${e.vars.opacity.inputUnderline})`:d}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Xm.disabled}, .${Xm.error}):before`]:{borderBottom:`1px solid ${(e.vars||e).palette.text.primary}`},[`&.${Xm.disabled}:before`]:{borderBottomStyle:"dotted"}},n.startAdornment&&{paddingLeft:12},n.endAdornment&&{paddingRight:12},n.multiline&&nt({padding:"25px 12px 8px"},n.size==="small"&&{paddingTop:21,paddingBottom:4},n.hiddenLabel&&{paddingTop:16,paddingBottom:17},n.hiddenLabel&&n.size==="small"&&{paddingTop:8,paddingBottom:9}))}),dse=Mr(cb,{name:"MuiFilledInput",slot:"Input",overridesResolver:ab})(({theme:e,ownerState:n})=>nt({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!e.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:e.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:e.palette.mode==="light"?null:"#fff",caretColor:e.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},e.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[e.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},n.size==="small"&&{paddingTop:21,paddingBottom:4},n.hiddenLabel&&{paddingTop:16,paddingBottom:17},n.startAdornment&&{paddingLeft:0},n.endAdornment&&{paddingRight:0},n.hiddenLabel&&n.size==="small"&&{paddingTop:8,paddingBottom:9},n.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0})),PT=V.forwardRef(function(n,o){var c,d,y,x;const i=Ls({props:n,name:"MuiFilledInput"}),{components:I={},componentsProps:R,fullWidth:k=!1,inputComponent:N="input",multiline:U=!1,slotProps:K,slots:X={},type:Z="text"}=i,J=jr(i,lse),le=nt({},i,{fullWidth:k,inputComponent:N,multiline:U,type:Z}),de=cse(i),ue={root:{ownerState:le},input:{ownerState:le}},pe=K??R?Dc(ue,K??R):ue,he=(c=(d=X.root)!=null?d:I.Root)!=null?c:use,xe=(y=(x=X.input)!=null?x:I.Input)!=null?y:dse;return T.jsx(IT,nt({slots:{root:he,input:xe},componentsProps:pe,fullWidth:k,inputComponent:N,multiline:U,ref:o,type:Z},J,{classes:de}))});PT.muiName="Input";function hse(e){return Ts("MuiFormControl",e)}xs("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const fse=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],pse=e=>{const{classes:n,margin:o,fullWidth:c}=e,d={root:["root",o!=="none"&&`margin${qr(o)}`,c&&"fullWidth"]};return Ms(d,hse,n)},mse=Mr("div",{name:"MuiFormControl",slot:"Root",overridesResolver:({ownerState:e},n)=>nt({},n.root,n[`margin${qr(e.margin)}`],e.fullWidth&&n.fullWidth)})(({ownerState:e})=>nt({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},e.margin==="normal"&&{marginTop:16,marginBottom:8},e.margin==="dense"&&{marginTop:8,marginBottom:4},e.fullWidth&&{width:"100%"})),gse=V.forwardRef(function(n,o){const c=Ls({props:n,name:"MuiFormControl"}),{children:d,className:y,color:x="primary",component:i="div",disabled:I=!1,error:R=!1,focused:k,fullWidth:N=!1,hiddenLabel:U=!1,margin:K="none",required:X=!1,size:Z="medium",variant:J="outlined"}=c,le=jr(c,fse),de=nt({},c,{color:x,component:i,disabled:I,error:R,fullWidth:N,hiddenLabel:U,margin:K,required:X,size:Z,variant:J}),ue=pse(de),[pe,he]=V.useState(()=>{let _t=!1;return d&&V.Children.forEach(d,Ue=>{if(!y2(Ue,["Input","Select"]))return;const Ge=y2(Ue,["Select"])?Ue.props.input:Ue;Ge&&zre(Ge.props)&&(_t=!0)}),_t}),[xe,fe]=V.useState(()=>{let _t=!1;return d&&V.Children.forEach(d,Ue=>{y2(Ue,["Input","Select"])&&(p1(Ue.props,!0)||p1(Ue.props.inputProps,!0))&&(_t=!0)}),_t}),[_e,Ce]=V.useState(!1);I&&_e&&Ce(!1);const je=k!==void 0&&!I?k:_e;let He;const lt=V.useMemo(()=>({adornedStart:pe,setAdornedStart:he,color:x,disabled:I,error:R,filled:xe,focused:je,fullWidth:N,hiddenLabel:U,size:Z,onBlur:()=>{Ce(!1)},onEmpty:()=>{fe(!1)},onFilled:()=>{fe(!0)},onFocus:()=>{Ce(!0)},registerEffect:He,required:X,variant:J}),[pe,x,I,R,xe,je,N,U,He,X,Z,J]);return T.jsx(ET.Provider,{value:lt,children:T.jsx(mse,nt({as:i,ownerState:de,className:pi(ue.root,y),ref:o},le,{children:d}))})});function _se(e){return Ts("MuiFormHelperText",e)}const zL=xs("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var FL;const yse=["children","className","component","disabled","error","filled","focused","margin","required","variant"],vse=e=>{const{classes:n,contained:o,size:c,disabled:d,error:y,filled:x,focused:i,required:I}=e,R={root:["root",d&&"disabled",y&&"error",c&&`size${qr(c)}`,o&&"contained",i&&"focused",x&&"filled",I&&"required"]};return Ms(R,_se,n)},xse=Mr("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:o}=e;return[n.root,o.size&&n[`size${qr(o.size)}`],o.contained&&n.contained,o.filled&&n.filled]}})(({theme:e,ownerState:n})=>nt({color:(e.vars||e).palette.text.secondary},e.typography.caption,{textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${zL.disabled}`]:{color:(e.vars||e).palette.text.disabled},[`&.${zL.error}`]:{color:(e.vars||e).palette.error.main}},n.size==="small"&&{marginTop:4},n.contained&&{marginLeft:14,marginRight:14})),bse=V.forwardRef(function(n,o){const c=Ls({props:n,name:"MuiFormHelperText"}),{children:d,className:y,component:x="p"}=c,i=jr(c,yse),I=X_(),R=Z_({props:c,muiFormControl:I,states:["variant","size","disabled","error","filled","focused","required"]}),k=nt({},c,{component:x,contained:R.variant==="filled"||R.variant==="outlined",variant:R.variant,size:R.size,disabled:R.disabled,error:R.error,filled:R.filled,focused:R.focused,required:R.required}),N=vse(k);return T.jsx(xse,nt({as:x,ownerState:k,className:pi(N.root,y),ref:o},i,{children:d===" "?FL||(FL=T.jsx("span",{className:"notranslate",children:""})):d}))});function wse(e){return Ts("MuiFormLabel",e)}const gv=xs("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),Sse=["children","className","color","component","disabled","error","filled","focused","required"],Cse=e=>{const{classes:n,color:o,focused:c,disabled:d,error:y,filled:x,required:i}=e,I={root:["root",`color${qr(o)}`,d&&"disabled",y&&"error",x&&"filled",c&&"focused",i&&"required"],asterisk:["asterisk",y&&"error"]};return Ms(I,wse,n)},Tse=Mr("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:({ownerState:e},n)=>nt({},n.root,e.color==="secondary"&&n.colorSecondary,e.filled&&n.filled)})(({theme:e,ownerState:n})=>nt({color:(e.vars||e).palette.text.secondary},e.typography.body1,{lineHeight:"1.4375em",padding:0,position:"relative",[`&.${gv.focused}`]:{color:(e.vars||e).palette[n.color].main},[`&.${gv.disabled}`]:{color:(e.vars||e).palette.text.disabled},[`&.${gv.error}`]:{color:(e.vars||e).palette.error.main}})),Ese=Mr("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(e,n)=>n.asterisk})(({theme:e})=>({[`&.${gv.error}`]:{color:(e.vars||e).palette.error.main}})),Ise=V.forwardRef(function(n,o){const c=Ls({props:n,name:"MuiFormLabel"}),{children:d,className:y,component:x="label"}=c,i=jr(c,Sse),I=X_(),R=Z_({props:c,muiFormControl:I,states:["color","required","focused","disabled","error","filled"]}),k=nt({},c,{color:R.color||"primary",component:x,disabled:R.disabled,error:R.error,filled:R.filled,focused:R.focused,required:R.required}),N=Cse(k);return T.jsxs(Tse,nt({as:x,ownerState:k,className:pi(N.root,y),ref:o},i,{children:[d,R.required&&T.jsxs(Ese,{ownerState:k,"aria-hidden":!0,className:N.asterisk,children:["","*"]})]}))}),Pse=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function NS(e){return`scale(${e}, ${e**2})`}const Ase={entering:{opacity:1,transform:NS(1)},entered:{opacity:1,transform:"none"}},E2=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),I5=V.forwardRef(function(n,o){const{addEndListener:c,appear:d=!0,children:y,easing:x,in:i,onEnter:I,onEntered:R,onEntering:k,onExit:N,onExited:U,onExiting:K,style:X,timeout:Z="auto",TransitionComponent:J=fd}=n,le=jr(n,Pse),de=u5(),ue=V.useRef(),pe=ST(),he=V.useRef(null),xe=pl(he,rx(y),o),fe=Ge=>at=>{if(Ge){const yt=he.current;at===void 0?Ge(yt):Ge(yt,at)}},_e=fe(k),Ce=fe((Ge,at)=>{v5(Ge);const{duration:yt,delay:tt,easing:Rt}=f1({style:X,timeout:Z,easing:x},{mode:"enter"});let ct;Z==="auto"?(ct=pe.transitions.getAutoHeightDuration(Ge.clientHeight),ue.current=ct):ct=yt,Ge.style.transition=[pe.transitions.create("opacity",{duration:ct,delay:tt}),pe.transitions.create("transform",{duration:E2?ct:ct*.666,delay:tt,easing:Rt})].join(","),I&&I(Ge,at)}),je=fe(R),He=fe(K),lt=fe(Ge=>{const{duration:at,delay:yt,easing:tt}=f1({style:X,timeout:Z,easing:x},{mode:"exit"});let Rt;Z==="auto"?(Rt=pe.transitions.getAutoHeightDuration(Ge.clientHeight),ue.current=Rt):Rt=at,Ge.style.transition=[pe.transitions.create("opacity",{duration:Rt,delay:yt}),pe.transitions.create("transform",{duration:E2?Rt:Rt*.666,delay:E2?yt:yt||Rt*.333,easing:tt})].join(","),Ge.style.opacity=0,Ge.style.transform=NS(.75),N&&N(Ge)}),_t=fe(U),Ue=Ge=>{Z==="auto"&&de.start(ue.current||0,Ge),c&&c(he.current,Ge)};return T.jsx(J,nt({appear:d,in:i,nodeRef:he,onEnter:Ce,onEntered:je,onEntering:_e,onExit:lt,onExited:_t,onExiting:He,addEndListener:Ue,timeout:Z==="auto"?null:Z},le,{children:(Ge,at)=>V.cloneElement(y,nt({style:nt({opacity:0,transform:NS(.75),visibility:Ge==="exited"&&!i?"hidden":void 0},Ase[Ge],X,y.props.style),ref:xe},at))}))});I5.muiSupportAuto=!0;const Rse=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],Mse=e=>{const{classes:n,disableUnderline:o}=e,d=Ms({root:["root",!o&&"underline"],input:["input"]},Vre,n);return nt({},n,d)},Lse=Mr(lb,{shouldForwardProp:e=>md(e)||e==="classes",name:"MuiInput",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:o}=e;return[...ob(e,n),!o.disableUnderline&&n.underline]}})(({theme:e,ownerState:n})=>{let c=e.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return e.vars&&(c=`rgba(${e.vars.palette.common.onBackgroundChannel} / ${e.vars.opacity.inputUnderline})`),nt({position:"relative"},n.formControl&&{"label + &":{marginTop:16}},!n.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(e.vars||e).palette[n.color].main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Yy.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Yy.error}`]:{"&::before, &::after":{borderBottomColor:(e.vars||e).palette.error.main}},"&::before":{borderBottom:`1px solid ${c}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Yy.disabled}, .${Yy.error}):before`]:{borderBottom:`2px solid ${(e.vars||e).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${c}`}},[`&.${Yy.disabled}:before`]:{borderBottomStyle:"dotted"}})}),Dse=Mr(cb,{name:"MuiInput",slot:"Input",overridesResolver:ab})({}),AT=V.forwardRef(function(n,o){var c,d,y,x;const i=Ls({props:n,name:"MuiInput"}),{disableUnderline:I,components:R={},componentsProps:k,fullWidth:N=!1,inputComponent:U="input",multiline:K=!1,slotProps:X,slots:Z={},type:J="text"}=i,le=jr(i,Rse),de=Mse(i),pe={root:{ownerState:{disableUnderline:I}}},he=X??k?Dc(X??k,pe):pe,xe=(c=(d=Z.root)!=null?d:R.Root)!=null?c:Lse,fe=(y=(x=Z.input)!=null?x:R.Input)!=null?y:Dse;return T.jsx(IT,nt({slots:{root:xe,input:fe},slotProps:he,fullWidth:N,inputComponent:U,multiline:K,ref:o,type:J},le,{classes:de}))});AT.muiName="Input";function kse(e){return Ts("MuiInputLabel",e)}xs("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const Ose=["disableAnimation","margin","shrink","variant","className"],zse=e=>{const{classes:n,formControl:o,size:c,shrink:d,disableAnimation:y,variant:x,required:i}=e,I={root:["root",o&&"formControl",!y&&"animated",d&&"shrink",c&&c!=="normal"&&`size${qr(c)}`,x],asterisk:[i&&"asterisk"]},R=Ms(I,kse,n);return nt({},n,R)},Fse=Mr(Ise,{shouldForwardProp:e=>md(e)||e==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:o}=e;return[{[`& .${gv.asterisk}`]:n.asterisk},n.root,o.formControl&&n.formControl,o.size==="small"&&n.sizeSmall,o.shrink&&n.shrink,!o.disableAnimation&&n.animated,o.focused&&n.focused,n[o.variant]]}})(({theme:e,ownerState:n})=>nt({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},n.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},n.size==="small"&&{transform:"translate(0, 17px) scale(1)"},n.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!n.disableAnimation&&{transition:e.transitions.create(["color","transform","max-width"],{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut})},n.variant==="filled"&&nt({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},n.size==="small"&&{transform:"translate(12px, 13px) scale(1)"},n.shrink&&nt({userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},n.size==="small"&&{transform:"translate(12px, 4px) scale(0.75)"})),n.variant==="outlined"&&nt({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},n.size==="small"&&{transform:"translate(14px, 9px) scale(1)"},n.shrink&&{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}))),Nse=V.forwardRef(function(n,o){const c=Ls({name:"MuiInputLabel",props:n}),{disableAnimation:d=!1,shrink:y,className:x}=c,i=jr(c,Ose),I=X_();let R=y;typeof R>"u"&&I&&(R=I.filled||I.focused||I.adornedStart);const k=Z_({props:c,muiFormControl:I,states:["size","variant","required","focused"]}),N=nt({},c,{disableAnimation:d,formControl:I,shrink:R,size:k.size,variant:k.variant,required:k.required,focused:k.focused}),U=zse(N);return T.jsx(Fse,nt({"data-shrink":R,ownerState:N,ref:o,className:pi(U.root,x)},i,{classes:U}))}),jse=V.createContext({});function Bse(e){return Ts("MuiList",e)}xs("MuiList",["root","padding","dense","subheader"]);const Vse=["children","className","component","dense","disablePadding","subheader"],Use=e=>{const{classes:n,disablePadding:o,dense:c,subheader:d}=e;return Ms({root:["root",!o&&"padding",c&&"dense",d&&"subheader"]},Bse,n)},$se=Mr("ul",{name:"MuiList",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:o}=e;return[n.root,!o.disablePadding&&n.padding,o.dense&&n.dense,o.subheader&&n.subheader]}})(({ownerState:e})=>nt({listStyle:"none",margin:0,padding:0,position:"relative"},!e.disablePadding&&{paddingTop:8,paddingBottom:8},e.subheader&&{paddingTop:0})),Hse=V.forwardRef(function(n,o){const c=Ls({props:n,name:"MuiList"}),{children:d,className:y,component:x="ul",dense:i=!1,disablePadding:I=!1,subheader:R}=c,k=jr(c,Vse),N=V.useMemo(()=>({dense:i}),[i]),U=nt({},c,{component:x,dense:i,disablePadding:I}),K=Use(U);return T.jsx(jse.Provider,{value:N,children:T.jsxs($se,nt({as:x,className:pi(K.root,y),ref:o,ownerState:U},k,{children:[R,d]}))})}),Gse=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function I2(e,n,o){return e===n?e.firstChild:n&&n.nextElementSibling?n.nextElementSibling:o?null:e.firstChild}function NL(e,n,o){return e===n?o?e.firstChild:e.lastChild:n&&n.previousElementSibling?n.previousElementSibling:o?null:e.lastChild}function P5(e,n){if(n===void 0)return!0;let o=e.innerText;return o===void 0&&(o=e.textContent),o=o.trim().toLowerCase(),o.length===0?!1:n.repeating?o[0]===n.keys[0]:o.indexOf(n.keys.join(""))===0}function Jy(e,n,o,c,d,y){let x=!1,i=d(e,n,n?o:!1);for(;i;){if(i===e.firstChild){if(x)return!1;x=!0}const I=c?!1:i.disabled||i.getAttribute("aria-disabled")==="true";if(!i.hasAttribute("tabindex")||!P5(i,y)||I)i=d(e,i,o);else return i.focus(),!0}return!1}const Wse=V.forwardRef(function(n,o){const{actions:c,autoFocus:d=!1,autoFocusItem:y=!1,children:x,className:i,disabledItemsFocusable:I=!1,disableListWrap:R=!1,onKeyDown:k,variant:N="selectedMenu"}=n,U=jr(n,Gse),K=V.useRef(null),X=V.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});fg(()=>{d&&K.current.focus()},[d]),V.useImperativeHandle(c,()=>({adjustStyleForScrollbar:(ue,{direction:pe})=>{const he=!K.current.style.width;if(ue.clientHeight<K.current.clientHeight&&he){const xe=`${d5(kc(ue))}px`;K.current.style[pe==="rtl"?"paddingLeft":"paddingRight"]=xe,K.current.style.width=`calc(100% + ${xe})`}return K.current}}),[]);const Z=ue=>{const pe=K.current,he=ue.key,xe=kc(pe).activeElement;if(he==="ArrowDown")ue.preventDefault(),Jy(pe,xe,R,I,I2);else if(he==="ArrowUp")ue.preventDefault(),Jy(pe,xe,R,I,NL);else if(he==="Home")ue.preventDefault(),Jy(pe,null,R,I,I2);else if(he==="End")ue.preventDefault(),Jy(pe,null,R,I,NL);else if(he.length===1){const fe=X.current,_e=he.toLowerCase(),Ce=performance.now();fe.keys.length>0&&(Ce-fe.lastTime>500?(fe.keys=[],fe.repeating=!0,fe.previousKeyMatched=!0):fe.repeating&&_e!==fe.keys[0]&&(fe.repeating=!1)),fe.lastTime=Ce,fe.keys.push(_e);const je=xe&&!fe.repeating&&P5(xe,fe);fe.previousKeyMatched&&(je||Jy(pe,xe,!1,I,I2,fe))?ue.preventDefault():fe.previousKeyMatched=!1}k&&k(ue)},J=pl(K,o);let le=-1;V.Children.forEach(x,(ue,pe)=>{if(!V.isValidElement(ue)){le===pe&&(le+=1,le>=x.length&&(le=-1));return}ue.props.disabled||(N==="selectedMenu"&&ue.props.selected||le===-1)&&(le=pe),le===pe&&(ue.props.disabled||ue.props.muiSkipListHighlight||ue.type.muiSkipListHighlight)&&(le+=1,le>=x.length&&(le=-1))});const de=V.Children.map(x,(ue,pe)=>{if(pe===le){const he={};return y&&(he.autoFocus=!0),ue.props.tabIndex===void 0&&N==="selectedMenu"&&(he.tabIndex=0),V.cloneElement(ue,he)}return ue});return T.jsx(Hse,nt({role:"menu",ref:J,className:i,onKeyDown:Z,tabIndex:d?0:-1},U,{children:de}))});function qse(e){return Ts("MuiPopover",e)}xs("MuiPopover",["root","paper"]);const Zse=["onEntering"],Xse=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps","disableScrollLock"],Kse=["slotProps"];function jL(e,n){let o=0;return typeof n=="number"?o=n:n==="center"?o=e.height/2:n==="bottom"&&(o=e.height),o}function BL(e,n){let o=0;return typeof n=="number"?o=n:n==="center"?o=e.width/2:n==="right"&&(o=e.width),o}function VL(e){return[e.horizontal,e.vertical].map(n=>typeof n=="number"?`${n}px`:n).join(" ")}function P2(e){return typeof e=="function"?e():e}const Yse=e=>{const{classes:n}=e;return Ms({root:["root"],paper:["paper"]},qse,n)},Jse=Mr(T5,{name:"MuiPopover",slot:"Root",overridesResolver:(e,n)=>n.root})({}),A5=Mr(ib,{name:"MuiPopover",slot:"Paper",overridesResolver:(e,n)=>n.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),Qse=V.forwardRef(function(n,o){var c,d,y;const x=Ls({props:n,name:"MuiPopover"}),{action:i,anchorEl:I,anchorOrigin:R={vertical:"top",horizontal:"left"},anchorPosition:k,anchorReference:N="anchorEl",children:U,className:K,container:X,elevation:Z=8,marginThreshold:J=16,open:le,PaperProps:de={},slots:ue,slotProps:pe,transformOrigin:he={vertical:"top",horizontal:"left"},TransitionComponent:xe=I5,transitionDuration:fe="auto",TransitionProps:{onEntering:_e}={},disableScrollLock:Ce=!1}=x,je=jr(x.TransitionProps,Zse),He=jr(x,Xse),lt=(c=pe==null?void 0:pe.paper)!=null?c:de,_t=V.useRef(),Ue=pl(_t,lt.ref),Ge=nt({},x,{anchorOrigin:R,anchorReference:N,elevation:Z,marginThreshold:J,externalPaperSlotProps:lt,transformOrigin:he,TransitionComponent:xe,transitionDuration:fe,TransitionProps:je}),at=Yse(Ge),yt=V.useCallback(()=>{if(N==="anchorPosition")return k;const An=P2(I),mn=(An&&An.nodeType===1?An:kc(_t.current).body).getBoundingClientRect();return{top:mn.top+jL(mn,R.vertical),left:mn.left+BL(mn,R.horizontal)}},[I,R.horizontal,R.vertical,k,N]),tt=V.useCallback(An=>({vertical:jL(An,he.vertical),horizontal:BL(An,he.horizontal)}),[he.horizontal,he.vertical]),Rt=V.useCallback(An=>{const Zt={width:An.offsetWidth,height:An.offsetHeight},mn=tt(Zt);if(N==="none")return{top:null,left:null,transformOrigin:VL(mn)};const kr=yt();let Gr=kr.top-mn.vertical,Yr=kr.left-mn.horizontal;const Xn=Gr+Zt.height,Lr=Yr+Zt.width,Or=pg(P2(I)),is=Or.innerHeight-J,Zi=Or.innerWidth-J;if(J!==null&&Gr<J){const Dr=Gr-J;Gr-=Dr,mn.vertical+=Dr}else if(J!==null&&Xn>is){const Dr=Xn-is;Gr-=Dr,mn.vertical+=Dr}if(J!==null&&Yr<J){const Dr=Yr-J;Yr-=Dr,mn.horizontal+=Dr}else if(Lr>Zi){const Dr=Lr-Zi;Yr-=Dr,mn.horizontal+=Dr}return{top:`${Math.round(Gr)}px`,left:`${Math.round(Yr)}px`,transformOrigin:VL(mn)}},[I,N,yt,tt,J]),[ct,ze]=V.useState(le),Ye=V.useCallback(()=>{const An=_t.current;if(!An)return;const Zt=Rt(An);Zt.top!==null&&(An.style.top=Zt.top),Zt.left!==null&&(An.style.left=Zt.left),An.style.transformOrigin=Zt.transformOrigin,ze(!0)},[Rt]);V.useEffect(()=>(Ce&&window.addEventListener("scroll",Ye),()=>window.removeEventListener("scroll",Ye)),[I,Ce,Ye]);const At=(An,Zt)=>{_e&&_e(An,Zt),Ye()},Ct=()=>{ze(!1)};V.useEffect(()=>{le&&Ye()}),V.useImperativeHandle(i,()=>le?{updatePosition:()=>{Ye()}}:null,[le,Ye]),V.useEffect(()=>{if(!le)return;const An=c5(()=>{Ye()}),Zt=pg(I);return Zt.addEventListener("resize",An),()=>{An.clear(),Zt.removeEventListener("resize",An)}},[I,le,Ye]);let We=fe;fe==="auto"&&!xe.muiSupportAuto&&(We=void 0);const st=X||(I?kc(P2(I)).body:void 0),Bt=(d=ue==null?void 0:ue.root)!=null?d:Jse,hn=(y=ue==null?void 0:ue.paper)!=null?y:A5,cn=A_({elementType:hn,externalSlotProps:nt({},lt,{style:ct?lt.style:nt({},lt.style,{opacity:0})}),additionalProps:{elevation:Z,ref:Ue},ownerState:Ge,className:pi(at.paper,lt==null?void 0:lt.className)}),cr=A_({elementType:Bt,externalSlotProps:(pe==null?void 0:pe.root)||{},externalForwardedProps:He,additionalProps:{ref:o,slotProps:{backdrop:{invisible:!0}},container:st,open:le},ownerState:Ge,className:pi(at.root,K)}),{slotProps:Nn}=cr,Vn=jr(cr,Kse);return T.jsx(Bt,nt({},Vn,!h1(Bt)&&{slotProps:Nn,disableScrollLock:Ce},{children:T.jsx(xe,nt({appear:!0,in:le,onEntering:At,onExited:Ct,timeout:We},je,{children:T.jsx(hn,nt({},cn,{children:U}))}))}))});function eoe(e){return Ts("MuiMenu",e)}xs("MuiMenu",["root","paper","list"]);const toe=["onEntering"],noe=["autoFocus","children","className","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant","slots","slotProps"],roe={vertical:"top",horizontal:"right"},ioe={vertical:"top",horizontal:"left"},soe=e=>{const{classes:n}=e;return Ms({root:["root"],paper:["paper"],list:["list"]},eoe,n)},ooe=Mr(Qse,{shouldForwardProp:e=>md(e)||e==="classes",name:"MuiMenu",slot:"Root",overridesResolver:(e,n)=>n.root})({}),aoe=Mr(A5,{name:"MuiMenu",slot:"Paper",overridesResolver:(e,n)=>n.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),loe=Mr(Wse,{name:"MuiMenu",slot:"List",overridesResolver:(e,n)=>n.list})({outline:0}),coe=V.forwardRef(function(n,o){var c,d;const y=Ls({props:n,name:"MuiMenu"}),{autoFocus:x=!0,children:i,className:I,disableAutoFocusItem:R=!1,MenuListProps:k={},onClose:N,open:U,PaperProps:K={},PopoverClasses:X,transitionDuration:Z="auto",TransitionProps:{onEntering:J}={},variant:le="selectedMenu",slots:de={},slotProps:ue={}}=y,pe=jr(y.TransitionProps,toe),he=jr(y,noe),xe=$te(),fe=nt({},y,{autoFocus:x,disableAutoFocusItem:R,MenuListProps:k,onEntering:J,PaperProps:K,transitionDuration:Z,TransitionProps:pe,variant:le}),_e=soe(fe),Ce=x&&!R&&U,je=V.useRef(null),He=(tt,Rt)=>{je.current&&je.current.adjustStyleForScrollbar(tt,{direction:xe?"rtl":"ltr"}),J&&J(tt,Rt)},lt=tt=>{tt.key==="Tab"&&(tt.preventDefault(),N&&N(tt,"tabKeyDown"))};let _t=-1;V.Children.map(i,(tt,Rt)=>{V.isValidElement(tt)&&(tt.props.disabled||(le==="selectedMenu"&&tt.props.selected||_t===-1)&&(_t=Rt))});const Ue=(c=de.paper)!=null?c:aoe,Ge=(d=ue.paper)!=null?d:K,at=A_({elementType:de.root,externalSlotProps:ue.root,ownerState:fe,className:[_e.root,I]}),yt=A_({elementType:Ue,externalSlotProps:Ge,ownerState:fe,className:_e.paper});return T.jsx(ooe,nt({onClose:N,anchorOrigin:{vertical:"bottom",horizontal:xe?"right":"left"},transformOrigin:xe?roe:ioe,slots:{paper:Ue,root:de.root},slotProps:{root:at,paper:yt},open:U,ref:o,transitionDuration:Z,TransitionProps:nt({onEntering:He},pe),ownerState:fe},he,{classes:X,children:T.jsx(loe,nt({onKeyDown:lt,actions:je,autoFocus:x&&(_t===-1||R),autoFocusItem:Ce,variant:le},k,{className:pi(_e.list,k.className),children:i}))}))});function uoe(e){return Ts("MuiNativeSelect",e)}const RT=xs("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),doe=["className","disabled","error","IconComponent","inputRef","variant"],hoe=e=>{const{classes:n,variant:o,disabled:c,multiple:d,open:y,error:x}=e,i={select:["select",o,c&&"disabled",d&&"multiple",x&&"error"],icon:["icon",`icon${qr(o)}`,y&&"iconOpen",c&&"disabled"]};return Ms(i,uoe,n)},R5=({ownerState:e,theme:n})=>nt({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":nt({},n.vars?{backgroundColor:`rgba(${n.vars.palette.common.onBackgroundChannel} / 0.05)`}:{backgroundColor:n.palette.mode==="light"?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"},[`&.${RT.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(n.vars||n).palette.background.paper},"&&&":{paddingRight:24,minWidth:16}},e.variant==="filled"&&{"&&&":{paddingRight:32}},e.variant==="outlined"&&{borderRadius:(n.vars||n).shape.borderRadius,"&:focus":{borderRadius:(n.vars||n).shape.borderRadius},"&&&":{paddingRight:32}}),foe=Mr("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:md,overridesResolver:(e,n)=>{const{ownerState:o}=e;return[n.select,n[o.variant],o.error&&n.error,{[`&.${RT.multiple}`]:n.multiple}]}})(R5),M5=({ownerState:e,theme:n})=>nt({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(n.vars||n).palette.action.active,[`&.${RT.disabled}`]:{color:(n.vars||n).palette.action.disabled}},e.open&&{transform:"rotate(180deg)"},e.variant==="filled"&&{right:7},e.variant==="outlined"&&{right:7}),poe=Mr("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(e,n)=>{const{ownerState:o}=e;return[n.icon,o.variant&&n[`icon${qr(o.variant)}`],o.open&&n.iconOpen]}})(M5),moe=V.forwardRef(function(n,o){const{className:c,disabled:d,error:y,IconComponent:x,inputRef:i,variant:I="standard"}=n,R=jr(n,doe),k=nt({},n,{disabled:d,variant:I,error:y}),N=hoe(k);return T.jsxs(V.Fragment,{children:[T.jsx(foe,nt({ownerState:k,className:pi(N.select,c),disabled:d,ref:i||o},R)),n.multiple?null:T.jsx(poe,{as:x,ownerState:k,className:N.icon})]})});var UL;const goe=["children","classes","className","label","notched"],_oe=Mr("fieldset",{shouldForwardProp:md})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),yoe=Mr("legend",{shouldForwardProp:md})(({ownerState:e,theme:n})=>nt({float:"unset",width:"auto",overflow:"hidden"},!e.withLabel&&{padding:0,lineHeight:"11px",transition:n.transitions.create("width",{duration:150,easing:n.transitions.easing.easeOut})},e.withLabel&&nt({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:n.transitions.create("max-width",{duration:50,easing:n.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},e.notched&&{maxWidth:"100%",transition:n.transitions.create("max-width",{duration:100,easing:n.transitions.easing.easeOut,delay:50})})));function voe(e){const{className:n,label:o,notched:c}=e,d=jr(e,goe),y=o!=null&&o!=="",x=nt({},e,{notched:c,withLabel:y});return T.jsx(_oe,nt({"aria-hidden":!0,className:n,ownerState:x},d,{children:T.jsx(yoe,{ownerState:x,children:y?T.jsx("span",{children:o}):UL||(UL=T.jsx("span",{className:"notranslate",children:""}))})}))}const xoe=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],boe=e=>{const{classes:n}=e,c=Ms({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},Ure,n);return nt({},n,c)},woe=Mr(lb,{shouldForwardProp:e=>md(e)||e==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:ob})(({theme:e,ownerState:n})=>{const o=e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return nt({position:"relative",borderRadius:(e.vars||e).shape.borderRadius,[`&:hover .${Mp.notchedOutline}`]:{borderColor:(e.vars||e).palette.text.primary},"@media (hover: none)":{[`&:hover .${Mp.notchedOutline}`]:{borderColor:e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:o}},[`&.${Mp.focused} .${Mp.notchedOutline}`]:{borderColor:(e.vars||e).palette[n.color].main,borderWidth:2},[`&.${Mp.error} .${Mp.notchedOutline}`]:{borderColor:(e.vars||e).palette.error.main},[`&.${Mp.disabled} .${Mp.notchedOutline}`]:{borderColor:(e.vars||e).palette.action.disabled}},n.startAdornment&&{paddingLeft:14},n.endAdornment&&{paddingRight:14},n.multiline&&nt({padding:"16.5px 14px"},n.size==="small"&&{padding:"8.5px 14px"}))}),Soe=Mr(voe,{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(e,n)=>n.notchedOutline})(({theme:e})=>{const n=e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:n}}),Coe=Mr(cb,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:ab})(({theme:e,ownerState:n})=>nt({padding:"16.5px 14px"},!e.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:e.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:e.palette.mode==="light"?null:"#fff",caretColor:e.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},e.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[e.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},n.size==="small"&&{padding:"8.5px 14px"},n.multiline&&{padding:0},n.startAdornment&&{paddingLeft:0},n.endAdornment&&{paddingRight:0})),MT=V.forwardRef(function(n,o){var c,d,y,x,i;const I=Ls({props:n,name:"MuiOutlinedInput"}),{components:R={},fullWidth:k=!1,inputComponent:N="input",label:U,multiline:K=!1,notched:X,slots:Z={},type:J="text"}=I,le=jr(I,xoe),de=boe(I),ue=X_(),pe=Z_({props:I,muiFormControl:ue,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),he=nt({},I,{color:pe.color||"primary",disabled:pe.disabled,error:pe.error,focused:pe.focused,formControl:ue,fullWidth:k,hiddenLabel:pe.hiddenLabel,multiline:K,size:pe.size,type:J}),xe=(c=(d=Z.root)!=null?d:R.Root)!=null?c:woe,fe=(y=(x=Z.input)!=null?x:R.Input)!=null?y:Coe;return T.jsx(IT,nt({slots:{root:xe,input:fe},renderSuffix:_e=>T.jsx(Soe,{ownerState:he,className:de.notchedOutline,label:U!=null&&U!==""&&pe.required?i||(i=T.jsxs(V.Fragment,{children:[U,"","*"]})):U,notched:typeof X<"u"?X:!!(_e.startAdornment||_e.filled||_e.focused)}),fullWidth:k,inputComponent:N,multiline:K,ref:o,type:J},le,{classes:nt({},de,{notchedOutline:null})}))});MT.muiName="Input";function Toe(e){return Ts("MuiSelect",e)}const Qy=xs("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]);var $L;const Eoe=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","error","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],Ioe=Mr("div",{name:"MuiSelect",slot:"Select",overridesResolver:(e,n)=>{const{ownerState:o}=e;return[{[`&.${Qy.select}`]:n.select},{[`&.${Qy.select}`]:n[o.variant]},{[`&.${Qy.error}`]:n.error},{[`&.${Qy.multiple}`]:n.multiple}]}})(R5,{[`&.${Qy.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),Poe=Mr("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:(e,n)=>{const{ownerState:o}=e;return[n.icon,o.variant&&n[`icon${qr(o.variant)}`],o.open&&n.iconOpen]}})(M5),Aoe=Mr("input",{shouldForwardProp:e=>y5(e)&&e!=="classes",name:"MuiSelect",slot:"NativeInput",overridesResolver:(e,n)=>n.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function HL(e,n){return typeof n=="object"&&n!==null?e===n:String(e)===String(n)}function Roe(e){return e==null||typeof e=="string"&&!e.trim()}const Moe=e=>{const{classes:n,variant:o,disabled:c,multiple:d,open:y,error:x}=e,i={select:["select",o,c&&"disabled",d&&"multiple",x&&"error"],icon:["icon",`icon${qr(o)}`,y&&"iconOpen",c&&"disabled"],nativeInput:["nativeInput"]};return Ms(i,Toe,n)},Loe=V.forwardRef(function(n,o){var c;const{"aria-describedby":d,"aria-label":y,autoFocus:x,autoWidth:i,children:I,className:R,defaultOpen:k,defaultValue:N,disabled:U,displayEmpty:K,error:X=!1,IconComponent:Z,inputRef:J,labelId:le,MenuProps:de={},multiple:ue,name:pe,onBlur:he,onChange:xe,onClose:fe,onFocus:_e,onOpen:Ce,open:je,readOnly:He,renderValue:lt,SelectDisplayProps:_t={},tabIndex:Ue,value:Ge,variant:at="standard"}=n,yt=jr(n,Eoe),[tt,Rt]=iL({controlled:Ge,default:N,name:"Select"}),[ct,ze]=iL({controlled:je,default:k,name:"Select"}),Ye=V.useRef(null),At=V.useRef(null),[Ct,We]=V.useState(null),{current:st}=V.useRef(je!=null),[Bt,hn]=V.useState(),cn=pl(o,J),cr=V.useCallback(On=>{At.current=On,On&&We(On)},[]),Nn=Ct==null?void 0:Ct.parentNode;V.useImperativeHandle(cn,()=>({focus:()=>{At.current.focus()},node:Ye.current,value:tt}),[tt]),V.useEffect(()=>{k&&ct&&Ct&&!st&&(hn(i?null:Nn.clientWidth),At.current.focus())},[Ct,i]),V.useEffect(()=>{x&&At.current.focus()},[x]),V.useEffect(()=>{if(!le)return;const On=kc(At.current).getElementById(le);if(On){const Zr=()=>{getSelection().isCollapsed&&At.current.focus()};return On.addEventListener("click",Zr),()=>{On.removeEventListener("click",Zr)}}},[le]);const Vn=(On,Zr)=>{On?Ce&&Ce(Zr):fe&&fe(Zr),st||(hn(i?null:Nn.clientWidth),ze(On))},An=On=>{On.button===0&&(On.preventDefault(),At.current.focus(),Vn(!0,On))},Zt=On=>{Vn(!1,On)},mn=V.Children.toArray(I),kr=On=>{const Zr=mn.find(Ki=>Ki.props.value===On.target.value);Zr!==void 0&&(Rt(Zr.props.value),xe&&xe(On,Zr))},Gr=On=>Zr=>{let Ki;if(Zr.currentTarget.hasAttribute("tabindex")){if(ue){Ki=Array.isArray(tt)?tt.slice():[];const ho=tt.indexOf(On.props.value);ho===-1?Ki.push(On.props.value):Ki.splice(ho,1)}else Ki=On.props.value;if(On.props.onClick&&On.props.onClick(Zr),tt!==Ki&&(Rt(Ki),xe)){const ho=Zr.nativeEvent||Zr,gl=new ho.constructor(ho.type,ho);Object.defineProperty(gl,"target",{writable:!0,value:{value:Ki,name:pe}}),xe(gl,On)}ue||Vn(!1,Zr)}},Yr=On=>{He||[" ","ArrowUp","ArrowDown","Enter"].indexOf(On.key)!==-1&&(On.preventDefault(),Vn(!0,On))},Xn=Ct!==null&&ct,Lr=On=>{!Xn&&he&&(Object.defineProperty(On,"target",{writable:!0,value:{value:tt,name:pe}}),he(On))};delete yt["aria-invalid"];let Or,is;const Zi=[];let Dr=!1;(p1({value:tt})||K)&&(lt?Or=lt(tt):Dr=!0);const Bi=mn.map(On=>{if(!V.isValidElement(On))return null;let Zr;if(ue){if(!Array.isArray(tt))throw new Error(hg(2));Zr=tt.some(Ki=>HL(Ki,On.props.value)),Zr&&Dr&&Zi.push(On.props.children)}else Zr=HL(tt,On.props.value),Zr&&Dr&&(is=On.props.children);return V.cloneElement(On,{"aria-selected":Zr?"true":"false",onClick:Gr(On),onKeyUp:Ki=>{Ki.key===" "&&Ki.preventDefault(),On.props.onKeyUp&&On.props.onKeyUp(Ki)},role:"option",selected:Zr,value:void 0,"data-value":On.props.value})});Dr&&(ue?Zi.length===0?Or=null:Or=Zi.reduce((On,Zr,Ki)=>(On.push(Zr),Ki<Zi.length-1&&On.push(", "),On),[]):Or=is);let Fr=Bt;!i&&st&&Ct&&(Fr=Nn.clientWidth);let Xi;typeof Ue<"u"?Xi=Ue:Xi=U?null:0;const ei=_t.id||(pe?`mui-component-select-${pe}`:void 0),ur=nt({},n,{variant:at,value:tt,open:Xn,error:X}),us=Moe(ur),ss=nt({},de.PaperProps,(c=de.slotProps)==null?void 0:c.paper),Sr=bT();return T.jsxs(V.Fragment,{children:[T.jsx(Ioe,nt({ref:cr,tabIndex:Xi,role:"combobox","aria-controls":Sr,"aria-disabled":U?"true":void 0,"aria-expanded":Xn?"true":"false","aria-haspopup":"listbox","aria-label":y,"aria-labelledby":[le,ei].filter(Boolean).join(" ")||void 0,"aria-describedby":d,onKeyDown:Yr,onMouseDown:U||He?null:An,onBlur:Lr,onFocus:_e},_t,{ownerState:ur,className:pi(_t.className,us.select,R),id:ei,children:Roe(Or)?$L||($L=T.jsx("span",{className:"notranslate",children:""})):Or})),T.jsx(Aoe,nt({"aria-invalid":X,value:Array.isArray(tt)?tt.join(","):tt,name:pe,ref:Ye,"aria-hidden":!0,onChange:kr,tabIndex:-1,disabled:U,className:us.nativeInput,autoFocus:x,ownerState:ur},yt)),T.jsx(Poe,{as:Z,className:us.icon,ownerState:ur}),T.jsx(coe,nt({id:`menu-${pe||""}`,anchorEl:Nn,open:Xn,onClose:Zt,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},de,{MenuListProps:nt({"aria-labelledby":le,role:"listbox","aria-multiselectable":ue?"true":void 0,disableListWrap:!0,id:Sr},de.MenuListProps),slotProps:nt({},de.slotProps,{paper:nt({},ss,{style:nt({minWidth:Fr},ss!=null?ss.style:null)})}),children:Bi}))]})}),Doe=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],koe=["root"],Ooe=e=>{const{classes:n}=e;return n},LT={name:"MuiSelect",overridesResolver:(e,n)=>n.root,shouldForwardProp:e=>md(e)&&e!=="variant",slot:"Root"},zoe=Mr(AT,LT)(""),Foe=Mr(MT,LT)(""),Noe=Mr(PT,LT)(""),L5=V.forwardRef(function(n,o){const c=Ls({name:"MuiSelect",props:n}),{autoWidth:d=!1,children:y,classes:x={},className:i,defaultOpen:I=!1,displayEmpty:R=!1,IconComponent:k=Hre,id:N,input:U,inputProps:K,label:X,labelId:Z,MenuProps:J,multiple:le=!1,native:de=!1,onClose:ue,onOpen:pe,open:he,renderValue:xe,SelectDisplayProps:fe,variant:_e="outlined"}=c,Ce=jr(c,Doe),je=de?moe:Loe,He=X_(),lt=Z_({props:c,muiFormControl:He,states:["variant","error"]}),_t=lt.variant||_e,Ue=nt({},c,{variant:_t,classes:x}),Ge=Ooe(Ue),at=jr(Ge,koe),yt=U||{standard:T.jsx(zoe,{ownerState:Ue}),outlined:T.jsx(Foe,{label:X,ownerState:Ue}),filled:T.jsx(Noe,{ownerState:Ue})}[_t],tt=pl(o,rx(yt));return T.jsx(V.Fragment,{children:V.cloneElement(yt,nt({inputComponent:je,inputProps:nt({children:y,error:lt.error,IconComponent:k,variant:_t,type:void 0,multiple:le},de?{id:N}:{autoWidth:d,defaultOpen:I,displayEmpty:R,labelId:Z,MenuProps:J,onClose:ue,onOpen:pe,open:he,renderValue:xe,SelectDisplayProps:nt({id:N},fe)},K,{classes:K?Dc(at,K.classes):at},U?U.props.inputProps:{})},(le&&de||R)&&_t==="outlined"?{notched:!0}:{},{ref:tt,className:pi(yt.props.className,i,Ge.root)},!U&&{variant:_t},Ce))})});L5.muiName="Select";function joe(e){return Ts("MuiTextField",e)}xs("MuiTextField",["root"]);const Boe=["autoComplete","autoFocus","children","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","maxRows","minRows","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","select","SelectProps","type","value","variant"],Voe={standard:AT,filled:PT,outlined:MT},Uoe=e=>{const{classes:n}=e;return Ms({root:["root"]},joe,n)},$oe=Mr(gse,{name:"MuiTextField",slot:"Root",overridesResolver:(e,n)=>n.root})({}),GL=V.forwardRef(function(n,o){const c=Ls({props:n,name:"MuiTextField"}),{autoComplete:d,autoFocus:y=!1,children:x,className:i,color:I="primary",defaultValue:R,disabled:k=!1,error:N=!1,FormHelperTextProps:U,fullWidth:K=!1,helperText:X,id:Z,InputLabelProps:J,inputProps:le,InputProps:de,inputRef:ue,label:pe,maxRows:he,minRows:xe,multiline:fe=!1,name:_e,onBlur:Ce,onChange:je,onFocus:He,placeholder:lt,required:_t=!1,rows:Ue,select:Ge=!1,SelectProps:at,type:yt,value:tt,variant:Rt="outlined"}=c,ct=jr(c,Boe),ze=nt({},c,{autoFocus:y,color:I,disabled:k,error:N,fullWidth:K,multiline:fe,required:_t,select:Ge,variant:Rt}),Ye=Uoe(ze),At={};Rt==="outlined"&&(J&&typeof J.shrink<"u"&&(At.notched=J.shrink),At.label=pe),Ge&&((!at||!at.native)&&(At.id=void 0),At["aria-describedby"]=void 0);const Ct=bT(Z),We=X&&Ct?`${Ct}-helper-text`:void 0,st=pe&&Ct?`${Ct}-label`:void 0,Bt=Voe[Rt],hn=T.jsx(Bt,nt({"aria-describedby":We,autoComplete:d,autoFocus:y,defaultValue:R,fullWidth:K,multiline:fe,name:_e,rows:Ue,maxRows:he,minRows:xe,type:yt,value:tt,id:Ct,inputRef:ue,onBlur:Ce,onChange:je,onFocus:He,placeholder:lt,inputProps:le},At,de));return T.jsxs($oe,nt({className:pi(Ye.root,i),disabled:k,error:N,fullWidth:K,ref:o,required:_t,color:I,variant:Rt,ownerState:ze},ct,{children:[pe!=null&&pe!==""&&T.jsx(Nse,nt({htmlFor:Ct,id:st},J,{children:pe})),Ge?T.jsx(L5,nt({"aria-describedby":We,id:Ct,labelId:st,value:tt,input:hn},at,{children:x})):hn,X&&T.jsx(bse,nt({id:We},U,{children:X}))]}))}),D5=()=>{const e=ml(),[n,o]=V.useState(!1),[c,d]=V.useState(null),[y,x]=V.useState(""),[i,I]=V.useState([]),[R,k]=V.useState([]),N=V.useRef(null),U=V.useCallback(async(J,le,de)=>{var ue;o(!0),d(null);try{return await e.post("/cat-link/request",{lostCatStatusId:J,foundCatStatusId:le,comment:de}),x("Demande de liaison envoye avec succs !"),setTimeout(()=>x(""),3e3),o(!1),!0}catch(pe){return console.error("Erreur lors de la cration de la demande de liaison:",pe),d(((ue=pe.response)==null?void 0:ue.data)||"Une erreur est survenue lors de la cration de la demande"),o(!1),!1}},[e]),K=V.useCallback(async(J,le,de)=>{var ue;o(!0),d(null);try{return await e.post("/cat-link/respond",{requestId:J,status:le,comment:de}),I(he=>he.filter(xe=>xe.requestId!==J)),x(`Demande de liaison ${le==="ACCEPTED"?"accepte":"refuse"} avec succs !`),setTimeout(()=>x(""),3e3),o(!1),!0}catch(pe){return console.error("Erreur lors de la rponse  la demande de liaison:",pe),d(((ue=pe.response)==null?void 0:ue.data)||"Une erreur est survenue lors de la rponse  la demande"),o(!1),!1}},[e]),X=V.useCallback(async()=>{N.current&&clearTimeout(N.current),N.current=setTimeout(async()=>{var J;if(!n){o(!0),d(null);try{const le=await e.get("/cat-link/responder/pending");I(le||[])}catch(le){console.error("Erreur lors de la rcupration des demandes en attente:",le),d(((J=le.response)==null?void 0:J.data)||"Une erreur est survenue lors de la rcupration des demandes"),I([])}finally{o(!1)}}},300)},[e,n]),Z=V.useCallback(async()=>{var J;o(!0),d(null);try{const le=await e.get("/cat-link/requester");return k(le||[]),o(!1),le}catch(le){return console.error("Erreur lors de la rcupration des demandes envoyes:",le),d(((J=le.response)==null?void 0:J.data)||"Une erreur est survenue lors de la rcupration des demandes"),k([]),o(!1),[]}},[e]);return{loading:n,error:c,successMessage:y,pendingRequests:i,sentRequests:R,createLinkRequest:U,respondToLinkRequest:K,fetchPendingRequests:X,fetchSentRequests:Z}},Hoe=({lostCatStatusId:e,onSuccess:n,onCancel:o})=>{const[c,d]=V.useState(""),[y,x]=V.useState(""),[i,I]=V.useState(!0),{createLinkRequest:R,loading:k,error:N,successMessage:U}=D5(),{t:K}=Rs(),X=async J=>{if(J.preventDefault(),!c.trim())return;const le=c.startsWith("#")?c.substring(1):c,de=parseInt(le,10);if(isNaN(de))return;await R(e,de,y)&&n&&setTimeout(()=>{n(),Z()},1500)},Z=()=>{I(!1),o&&o()};return T.jsxs(Gie,{open:i,onClose:Z,maxWidth:"sm",fullWidth:!0,children:[T.jsx(ase,{children:K("catLinkRequest.title","Lier votre chat perdu  un chat trouv")}),T.jsx(rse,{children:T.jsxs(Qre,{component:"form",onSubmit:X,sx:{mt:2},children:[N&&T.jsx(EL,{severity:"error",sx:{mb:2},children:N}),U&&T.jsx(EL,{severity:"success",sx:{mb:2},children:U}),T.jsx(b5,{variant:"body1",sx:{mb:2},children:K("catLinkRequest.instruction","Entrez l'ID du chat trouv qui vous a t communiqu par la personne qui l'a trouv.")}),T.jsx(GL,{label:K("catLinkRequest.foundIdLabel","ID du chat trouv"),placeholder:K("catLinkRequest.foundIdPlaceholder","Par exemple: #12345"),fullWidth:!0,value:c,onChange:J=>d(J.target.value),required:!0,sx:{mb:2}}),T.jsx(GL,{label:K("catLinkRequest.commentLabel","Commentaire (optionnel)"),placeholder:K("catLinkRequest.commentPlaceholder","Ajoutez des informations supplmentaires ici"),fullWidth:!0,multiline:!0,rows:3,value:y,onChange:J=>x(J.target.value),sx:{mb:2}})]})}),T.jsxs(Kie,{children:[T.jsx(FS,{onClick:Z,disabled:k,children:K("catLinkRequest.cancel","Annuler")}),T.jsx(FS,{onClick:X,variant:"contained",color:"primary",disabled:k||!c.trim(),children:k?T.jsx(gie,{size:24}):K("catLinkRequest.send","Envoyer la demande")})]})]})},Goe=({lostCatStatusId:e,onSuccess:n})=>{const[o,c]=V.useState(!1);return T.jsxs(T.Fragment,{children:[T.jsx(FS,{variant:"contained",color:"primary",onClick:()=>c(!0),sx:{mt:1},children:"Lier  un chat trouv"}),o&&T.jsx(Hoe,{lostCatStatusId:e,onSuccess:n,onCancel:()=>c(!1)})]})},Woe=({reportedCats:e,onDelete:n,onEdit:o,successMessage:c})=>{const{t:d}=Rs(),{enums:y,loading:x,error:i,getEnumLabel:I}=$_(),{formatValue:R,calculateAge:k,findPotentialFoundCats:N,findPotentialLostCats:U}=kf(),{fetchCats:K}=W_(),[X,Z]=V.useState(!1),[J,le]=V.useState(!1),[de,ue]=V.useState(null),[pe,he]=V.useState(!1),[xe,fe]=V.useState([]),[_e,Ce]=V.useState({}),[je,He]=V.useState({}),[lt,_t]=V.useState(!1),[Ue,Ge]=V.useState({name:"",statusCat:"",comment:"",breed:"",color:"",dateOfBirth:"",gender:"",chipNumber:"",furType:"",eyeColor:"",images:[],vaccinated:null,sterilized:null}),[at,yt]=V.useState(!1),[tt,Rt]=V.useState(""),[ct,ze]=V.useState("desc");V.useEffect(()=>{(async()=>{if(e.length===0||Object.values(je).some(Xn=>Xn)||e.every(Xn=>typeof _e[Xn.cat.catId]<"u"))return;const kr=e.filter(Xn=>typeof _e[Xn.cat.catId]>"u");if(kr.length===0)return;const Gr={..._e},Yr={...je};kr.forEach(Xn=>{Yr[Xn.cat.catId]=!0}),He(Yr);for(const Xn of kr){const Lr=Xn.cat.catId;try{if(Xn.statusCat==="LOST"){const Or=await N(Lr);Gr[Lr]=Or.length}else if(Xn.statusCat==="FOUND"){const Or=await U(Lr);Gr[Lr]=Or.length}else Gr[Lr]=0;Yr[Lr]=!1,Ce({...Gr}),He({...Yr})}catch(Or){console.error(`Error fetching matches for cat ${Lr}:`,Or),Gr[Lr]=0,Yr[Lr]=!1}}})()},[e,_e,je,N,U]);const Ye=async Zt=>{window.confirm("tes-vous sr de vouloir supprimer ce chat ?")&&await n(Zt)&&await K()},At=Zt=>{ue(Zt),Ge({name:Zt.cat.name||"",statusCat:Zt.statusCat||"",comment:Zt.cat.comment||"",breed:Wa(Zt.cat.breed,"")||"",color:Wa(Zt.cat.color,"")||"",dateOfBirth:Zt.cat.dateOfBirth||"",gender:Zt.cat.gender||"",chipNumber:Zt.cat.chipNumber||"",furType:Wa(Zt.cat.furType,"")||"",eyeColor:Wa(Zt.cat.eyeColor,"")||"",images:Zt.cat.imageUrls||[],vaccinated:Zt.cat.vaccinated??null,sterilized:Zt.cat.sterilized??null}),Z(!0)},Ct=Zt=>{ue(Zt),le(!0),_t(pe),he(!1)},We=()=>{le(!1),lt&&xe.length>0&&he(!0),_t(!1)},st=async Zt=>{Zt.preventDefault();const mn={...Ue,imageUrls:Ue.images,imageUrl:Ue.images.length>0?Ue.images[0]:null,vaccinated:Ue.vaccinated,sterilized:Ue.sterilized},kr=await o(de.catStatusId,mn);Z(!1),kr&&await Vn()},Bt=Zt=>{Ge({...Ue,[Zt.target.name]:Zt.target.value})},hn=Zt=>{Array.isArray(Zt)?Ge(mn=>({...mn,images:Zt})):Ge(mn=>({...mn,images:Zt?[Zt]:[]}))},cn=async Zt=>{const mn=await N(Zt.catId);fe(mn),he(!0)},cr=async Zt=>{const mn=await U(Zt.catId);fe(mn),he(!0)},Nn=()=>{he(!1)},Vn=async()=>{await K()};if(e.length===0)return T.jsx(mi,{variant:"info",children:d("reportedCats.none","Vous n'avez pas de chats signals.")});const An=e.filter(Zt=>!tt||Zt.statusCat===tt).sort((Zt,mn)=>{const kr=new Date(Zt.reportDate),Gr=new Date(mn.reportDate);return ct==="desc"?Gr-kr:kr-Gr});return T.jsxs(T.Fragment,{children:[c&&T.jsx(mi,{variant:"success",className:"mb-3",children:c}),T.jsxs("div",{className:"d-flex flex-wrap gap-3 align-items-center justify-content-center mb-4",children:[T.jsxs("div",{children:[T.jsx(ot.Label,{className:"me-2 mb-0",children:"Filtrer par statut :"}),T.jsxs(ot.Select,{size:"sm",style:{width:160,display:"inline-block"},value:tt,onChange:Zt=>Rt(Zt.target.value),children:[T.jsx("option",{value:"",children:"Tous"}),T.jsx("option",{value:"LOST",children:"Perdu"}),T.jsx("option",{value:"FOUND",children:"Trouv"})]})]}),T.jsxs("div",{children:[T.jsx(ot.Label,{className:"me-2 mb-0",children:"Trier :"}),T.jsx(ot.Check,{inline:!0,label:"Plus rcent",type:"radio",id:"sort-desc",name:"sortOrder",checked:ct==="desc",onChange:()=>ze("desc")}),T.jsx(ot.Check,{inline:!0,label:"Plus ancien",type:"radio",id:"sort-asc",name:"sortOrder",checked:ct==="asc",onChange:()=>ze("asc")})]}),T.jsx(ia,{bg:"primary",className:"px-3 py-2",children:d("reportedCats.count",{count:An.length,defaultValue:`${An.length} chats signals`})})]}),T.jsx(vi,{xs:1,md:2,lg:3,className:"g-4",children:An.map(Zt=>{const mn=Zt.cat;return T.jsx(Un,{children:T.jsx(Za.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:T.jsxs(yn,{className:"cat-card shadow-sm h-100",children:[T.jsx(yn.Img,{variant:"top",src:mn.imageUrls&&Array.isArray(mn.imageUrls)&&mn.imageUrls.length>0?mn.imageUrls[0]:"/noImageCat.png",alt:mn.name,onError:kr=>{kr.target.src="/noImageCat.png",kr.target.onerror=null},style:{height:"200px",objectFit:"cover"}}),T.jsxs(yn.Body,{children:[T.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[T.jsx(yn.Title,{className:"mb-0",children:mn.name||d("reportedCats.noName","Chat sans nom")}),T.jsx(ia,{bg:mn.gender===d("reportedCats.male",{defaultValue:"Mle"})?"primary":"danger",className:"ms-2",children:R(mn.gender)||d("reportedCats.unknownGender","Genre inconnu")})]}),T.jsxs(yn.Text,{className:"text-muted small",children:[d("reportedCats.breed","Race"),":"," ",R(mn.breed)||d("reportedCats.unknownBreed","Inconnue"),mn.dateOfBirth&&T.jsxs("span",{className:"ms-2",children:[d("reportedCats.age","ge"),":"," ",k(mn.dateOfBirth)]})]}),T.jsxs(yn.Text,{className:"text-muted small",children:[d("reportedCats.status","Statut"),":"," ",I(y==null?void 0:y.statusCat,Zt.statusCat)||d("reportedCats.notSpecified","Non spcifi")," "]}),T.jsxs(yn.Text,{className:"text-muted small",children:[d("reportedCats.reportedOn","Signal le"),":"," ",new Date(Zt.reportDate).toLocaleDateString()]}),Zt.comment&&T.jsxs(yn.Text,{className:"text-muted small",children:[d("reportedCats.comment","Commentaire"),":"," ",Zt.comment]}),T.jsx("div",{className:"d-grid mb-2",children:T.jsx(Qn,{variant:"outline-secondary",size:"sm",className:"w-100 cat-details-btn",onClick:()=>Ct(Zt),children:d("reportedCats.details","Voir dtails")})}),T.jsxs("div",{className:"d-flex justify-content-center gap-2 cat-actions-row",children:[T.jsx(Qn,{variant:"outline-primary",size:"sm",onClick:()=>At(Zt),className:"cat-action-btn",title:d("reportedCats.edit","Modifier"),children:T.jsx("i",{className:"fa fa-edit"})}),T.jsx(Qn,{variant:"outline-danger",size:"sm",onClick:()=>Ye(Zt.catStatusId),className:"cat-action-btn",title:d("reportedCats.delete","Supprimer"),children:T.jsx(U0,{})})]}),Zt.statusCat==="LOST"&&T.jsx("div",{className:"mt-2",children:T.jsx(Goe,{lostCatStatusId:Zt.catStatusId,onSuccess:Vn})},`link-request-${Zt.catStatusId}`),Zt.statusCat==="FOUND"&&T.jsxs("div",{className:"mt-2 text-center",children:[T.jsxs(ia,{bg:"info",className:"px-3 py-2",children:[d("reportedCats.id","ID"),": #",Zt.catStatusId]}),T.jsx("div",{className:"small text-muted mt-1",children:d("reportedCats.idHelp","Communiquez cet ID au propritaire")})]},`found-id-${Zt.catStatusId}`),Zt.statusCat==="LOST"&&T.jsxs(Qn,{variant:"outline-info",size:"sm",className:"w-100 mt-2",onClick:()=>cn(mn),disabled:je[mn.catId],children:[T.jsx(hl,{className:"me-2"}),je[mn.catId]?d("reportedCats.loadingMatches","Chargement des correspondances..."):_e[mn.catId]?d("reportedCats.matchCount",{count:_e[mn.catId],defaultValue:`${_e[mn.catId]} correspondance(s)`}):d("reportedCats.noMatches","Aucune correspondance")]},`lost-match-button-${Zt.catStatusId}`),Zt.statusCat==="FOUND"&&T.jsxs(Qn,{variant:"outline-info",size:"sm",className:"w-100 mt-2",onClick:()=>cr(mn),disabled:je[mn.catId],children:[T.jsx(hl,{className:"me-2"}),je[mn.catId]?d("reportedCats.loadingMatches","Chargement des correspondances..."):_e[mn.catId]?d("reportedCats.matchCount",{count:_e[mn.catId],defaultValue:`${_e[mn.catId]} correspondance(s)`}):d("reportedCats.noMatches","Aucune correspondance")]},`found-match-button-${Zt.catStatusId}`)]})]})})},Zt.catStatusId)})}),T.jsxs(Wi,{show:X,onHide:()=>Z(!1),size:"lg",children:[T.jsx(Wi.Header,{closeButton:!0,children:T.jsx(Wi.Title,{children:d("reportedCats.editTitle","Modifier les informations du chat")})}),T.jsx(Wi.Body,{children:T.jsxs(ot,{onSubmit:st,children:[T.jsxs(vi,{children:[T.jsx(Un,{md:6,children:T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:d("reportedCats.name","Nom du chat")}),T.jsx(ot.Control,{type:"text",name:"name",value:Ue.name,onChange:Bt})]})}),T.jsx(Un,{md:6,children:T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:d("reportedCats.status","Statut")}),T.jsxs(ot.Select,{name:"statusCat",value:Ue.statusCat,onChange:Bt,disabled:x||i,children:[T.jsx("option",{value:"",children:d("reportedCats.selectStatus","Slectionner un statut")},"empty"),y&&y.statusCat.map(Zt=>T.jsx("option",{value:Zt.value,children:Zt.label},Zt.value))]}),i&&T.jsx("div",{className:"text-danger",children:"Erreur lors du chargement des statuts"})]})})]}),T.jsxs(vi,{children:[T.jsx(Un,{md:6,children:T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:d("reportedCats.breed","Race")}),T.jsxs(ot.Select,{name:"breed",value:Ue.breed,onChange:Bt,disabled:x||i,children:[T.jsx("option",{value:"",children:"Slectionner une race"}),y&&y.breed.map(Zt=>T.jsx("option",{value:Zt.value,children:Zt.label},Zt.value))]}),i&&T.jsx("div",{className:"text-danger",children:"Erreur lors du chargement des races"})]})}),T.jsx(Un,{md:6,children:T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:d("reportedCats.color","Couleur")}),T.jsxs(ot.Select,{name:"color",value:Ue.color,onChange:Bt,disabled:x||i,children:[T.jsx("option",{value:"",children:"Slectionner une couleur"}),y&&y.catColor.map(Zt=>T.jsx("option",{value:Zt.value,children:Zt.label},Zt.value))]}),i&&T.jsx("div",{className:"text-danger",children:"Erreur lors du chargement des couleurs"})]})})]}),T.jsxs(vi,{children:[T.jsx(Un,{md:6,children:T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:"Date de naissance"}),T.jsx(ot.Control,{type:"date",name:"dateOfBirth",value:Ue.dateOfBirth,onChange:Bt,max:new Date().toISOString().split("T")[0]})]})}),T.jsx(Un,{md:6,children:T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:"Genre"}),T.jsxs(ot.Select,{name:"gender",value:Ue.gender,onChange:Bt,disabled:x||i,children:[T.jsx("option",{value:"",children:"Slectionner un genre"}),y&&y.catGender.map(Zt=>T.jsx("option",{value:Zt.value,children:Zt.label},Zt.value))]}),i&&T.jsx("div",{className:"text-danger",children:"Erreur lors du chargement des genres"})]})}),T.jsx(Un,{md:6,children:T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:"Vaccin"}),T.jsxs(ot.Select,{name:"vaccinated",value:Ue.vaccinated===null?"":Ue.vaccinated?"true":"false",onChange:Zt=>Ge({...Ue,vaccinated:Zt.target.value===""?null:Zt.target.value==="true"}),children:[T.jsx("option",{value:"",children:"Non spcifi"}),T.jsx("option",{value:"true",children:"Oui"}),T.jsx("option",{value:"false",children:"Non"})]})]})}),T.jsx(Un,{md:6,children:T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:"Strilis"}),T.jsxs(ot.Select,{name:"sterilized",value:Ue.sterilized===null?"":Ue.sterilized?"true":"false",onChange:Zt=>Ge({...Ue,sterilized:Zt.target.value===""?null:Zt.target.value==="true"}),children:[T.jsx("option",{value:"",children:"Non spcifi"}),T.jsx("option",{value:"true",children:"Oui"}),T.jsx("option",{value:"false",children:"Non"})]})]})})]}),T.jsxs(vi,{children:[T.jsx(Un,{md:6,children:T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:"Numro de puce"}),T.jsx(ot.Control,{type:"text",name:"chipNumber",value:Ue.chipNumber,onChange:Bt,placeholder:"Optionnel"})]})}),T.jsx(Un,{md:6,children:T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:"Type de pelage"}),T.jsxs(ot.Select,{name:"furType",value:Ue.furType,onChange:Bt,disabled:x||i,children:[T.jsx("option",{value:"",children:"Slectionner un type de pelage"}),y&&y.furType.map(Zt=>T.jsx("option",{value:Zt.value,children:Zt.label},Zt.value))]}),i&&T.jsx("div",{className:"text-danger",children:"Erreur lors du chargement des types de pelage"})]})})]}),T.jsxs(vi,{children:[T.jsx(Un,{md:6,children:T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:"Couleur des yeux"}),T.jsxs(ot.Select,{name:"eyeColor",value:Ue.eyeColor,onChange:Bt,disabled:x||i,children:[T.jsx("option",{value:"",children:"Slectionner une couleur d'yeux"}),y&&y.eyeColor.map(Zt=>T.jsx("option",{value:Zt.value,children:Zt.label},Zt.value))]}),i&&T.jsx("div",{className:"text-danger",children:"Erreur lors du chargement des couleurs d'yeux"})]})}),T.jsx(Un,{md:6,children:T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:"Commentaire"}),T.jsx(ot.Control,{as:"textarea",name:"comment",value:Ue.comment,onChange:Bt,style:{height:"100px"}})]})})]}),T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:"Photos"}),T.jsx(dT,{onImageUploaded:hn,initialImage:Ue.images,multiple:!0,maxImages:5,maxSize:5,allowedTypes:["image/jpeg","image/png","image/gif","image/webp"],onUploadStatusChange:yt})]}),T.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-3",children:[T.jsx(Qn,{variant:"secondary",onClick:()=>Z(!1),children:"Annuler"}),T.jsxs(Qn,{variant:"primary",type:"submit",disabled:at,children:[at&&T.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),at?"Traitement des images...":"Enregistrer"]})]})]})})]}),T.jsx(hT,{selectedCatStatus:de,show:J,handleClose:We,hideContactInfo:!0}),T.jsx(MF,{matches:xe,show:pe,handleClose:Nn,onViewDetails:Zt=>{Nn(),Ct(Zt)}})]})},k5=6048e5,qoe=864e5,WL=Symbol.for("constructDateFrom");function Xp(e,n){return typeof e=="function"?e(n):e&&typeof e=="object"&&WL in e?e[WL](n):e instanceof Date?new e.constructor(n):new Date(n)}function gd(e,n){return Xp(n||e,e)}let Zoe={};function db(){return Zoe}function kv(e,n){var i,I,R,k;const o=db(),c=(n==null?void 0:n.weekStartsOn)??((I=(i=n==null?void 0:n.locale)==null?void 0:i.options)==null?void 0:I.weekStartsOn)??o.weekStartsOn??((k=(R=o.locale)==null?void 0:R.options)==null?void 0:k.weekStartsOn)??0,d=gd(e,n==null?void 0:n.in),y=d.getDay(),x=(y<c?7:0)+y-c;return d.setDate(d.getDate()-x),d.setHours(0,0,0,0),d}function m1(e,n){return kv(e,{...n,weekStartsOn:1})}function O5(e,n){const o=gd(e,n==null?void 0:n.in),c=o.getFullYear(),d=Xp(o,0);d.setFullYear(c+1,0,4),d.setHours(0,0,0,0);const y=m1(d),x=Xp(o,0);x.setFullYear(c,0,4),x.setHours(0,0,0,0);const i=m1(x);return o.getTime()>=y.getTime()?c+1:o.getTime()>=i.getTime()?c:c-1}function qL(e){const n=gd(e),o=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return o.setUTCFullYear(n.getFullYear()),+e-+o}function Xoe(e,...n){const o=Xp.bind(null,n.find(c=>typeof c=="object"));return n.map(o)}function ZL(e,n){const o=gd(e,n==null?void 0:n.in);return o.setHours(0,0,0,0),o}function Koe(e,n,o){const[c,d]=Xoe(o==null?void 0:o.in,e,n),y=ZL(c),x=ZL(d),i=+y-qL(y),I=+x-qL(x);return Math.round((i-I)/qoe)}function Yoe(e,n){const o=O5(e,n),c=Xp(e,0);return c.setFullYear(o,0,4),c.setHours(0,0,0,0),m1(c)}function Joe(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Qoe(e){return!(!Joe(e)&&typeof e!="number"||isNaN(+gd(e)))}function eae(e,n){const o=gd(e,n==null?void 0:n.in);return o.setFullYear(o.getFullYear(),0,1),o.setHours(0,0,0,0),o}const tae={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},nae=(e,n,o)=>{let c;const d=tae[e];return typeof d=="string"?c=d:n===1?c=d.one:c=d.other.replace("{{count}}",n.toString()),o!=null&&o.addSuffix?o.comparison&&o.comparison>0?"in "+c:c+" ago":c};function g_(e){return(n={})=>{const o=n.width?String(n.width):e.defaultWidth;return e.formats[o]||e.formats[e.defaultWidth]}}const rae={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},iae={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},sae={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},oae={date:g_({formats:rae,defaultWidth:"full"}),time:g_({formats:iae,defaultWidth:"full"}),dateTime:g_({formats:sae,defaultWidth:"full"})},aae={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},lae=(e,n,o,c)=>aae[e];function yh(e){return(n,o)=>{const c=o!=null&&o.context?String(o.context):"standalone";let d;if(c==="formatting"&&e.formattingValues){const x=e.defaultFormattingWidth||e.defaultWidth,i=o!=null&&o.width?String(o.width):x;d=e.formattingValues[i]||e.formattingValues[x]}else{const x=e.defaultWidth,i=o!=null&&o.width?String(o.width):e.defaultWidth;d=e.values[i]||e.values[x]}const y=e.argumentCallback?e.argumentCallback(n):n;return d[y]}}const cae={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},uae={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},dae={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},hae={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},fae={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},pae={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},mae=(e,n)=>{const o=Number(e),c=o%100;if(c>20||c<10)switch(c%10){case 1:return o+"st";case 2:return o+"nd";case 3:return o+"rd"}return o+"th"},gae={ordinalNumber:mae,era:yh({values:cae,defaultWidth:"wide"}),quarter:yh({values:uae,defaultWidth:"wide",argumentCallback:e=>e-1}),month:yh({values:dae,defaultWidth:"wide"}),day:yh({values:hae,defaultWidth:"wide"}),dayPeriod:yh({values:fae,defaultWidth:"wide",formattingValues:pae,defaultFormattingWidth:"wide"})};function vh(e){return(n,o={})=>{const c=o.width,d=c&&e.matchPatterns[c]||e.matchPatterns[e.defaultMatchWidth],y=n.match(d);if(!y)return null;const x=y[0],i=c&&e.parsePatterns[c]||e.parsePatterns[e.defaultParseWidth],I=Array.isArray(i)?yae(i,N=>N.test(x)):_ae(i,N=>N.test(x));let R;R=e.valueCallback?e.valueCallback(I):I,R=o.valueCallback?o.valueCallback(R):R;const k=n.slice(x.length);return{value:R,rest:k}}}function _ae(e,n){for(const o in e)if(Object.prototype.hasOwnProperty.call(e,o)&&n(e[o]))return o}function yae(e,n){for(let o=0;o<e.length;o++)if(n(e[o]))return o}function z5(e){return(n,o={})=>{const c=n.match(e.matchPattern);if(!c)return null;const d=c[0],y=n.match(e.parsePattern);if(!y)return null;let x=e.valueCallback?e.valueCallback(y[0]):y[0];x=o.valueCallback?o.valueCallback(x):x;const i=n.slice(d.length);return{value:x,rest:i}}}const vae=/^(\d+)(th|st|nd|rd)?/i,xae=/\d+/i,bae={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},wae={any:[/^b/i,/^(a|c)/i]},Sae={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Cae={any:[/1/i,/2/i,/3/i,/4/i]},Tae={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Eae={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Iae={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Pae={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Aae={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Rae={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Mae={ordinalNumber:z5({matchPattern:vae,parsePattern:xae,valueCallback:e=>parseInt(e,10)}),era:vh({matchPatterns:bae,defaultMatchWidth:"wide",parsePatterns:wae,defaultParseWidth:"any"}),quarter:vh({matchPatterns:Sae,defaultMatchWidth:"wide",parsePatterns:Cae,defaultParseWidth:"any",valueCallback:e=>e+1}),month:vh({matchPatterns:Tae,defaultMatchWidth:"wide",parsePatterns:Eae,defaultParseWidth:"any"}),day:vh({matchPatterns:Iae,defaultMatchWidth:"wide",parsePatterns:Pae,defaultParseWidth:"any"}),dayPeriod:vh({matchPatterns:Aae,defaultMatchWidth:"any",parsePatterns:Rae,defaultParseWidth:"any"})},Lae={code:"en-US",formatDistance:nae,formatLong:oae,formatRelative:lae,localize:gae,match:Mae,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Dae(e,n){const o=gd(e,n==null?void 0:n.in);return Koe(o,eae(o))+1}function kae(e,n){const o=gd(e,n==null?void 0:n.in),c=+m1(o)-+Yoe(o);return Math.round(c/k5)+1}function F5(e,n){var k,N,U,K;const o=gd(e,n==null?void 0:n.in),c=o.getFullYear(),d=db(),y=(n==null?void 0:n.firstWeekContainsDate)??((N=(k=n==null?void 0:n.locale)==null?void 0:k.options)==null?void 0:N.firstWeekContainsDate)??d.firstWeekContainsDate??((K=(U=d.locale)==null?void 0:U.options)==null?void 0:K.firstWeekContainsDate)??1,x=Xp((n==null?void 0:n.in)||e,0);x.setFullYear(c+1,0,y),x.setHours(0,0,0,0);const i=kv(x,n),I=Xp((n==null?void 0:n.in)||e,0);I.setFullYear(c,0,y),I.setHours(0,0,0,0);const R=kv(I,n);return+o>=+i?c+1:+o>=+R?c:c-1}function Oae(e,n){var i,I,R,k;const o=db(),c=(n==null?void 0:n.firstWeekContainsDate)??((I=(i=n==null?void 0:n.locale)==null?void 0:i.options)==null?void 0:I.firstWeekContainsDate)??o.firstWeekContainsDate??((k=(R=o.locale)==null?void 0:R.options)==null?void 0:k.firstWeekContainsDate)??1,d=F5(e,n),y=Xp((n==null?void 0:n.in)||e,0);return y.setFullYear(d,0,c),y.setHours(0,0,0,0),kv(y,n)}function zae(e,n){const o=gd(e,n==null?void 0:n.in),c=+kv(o,n)-+Oae(o,n);return Math.round(c/k5)+1}function Cs(e,n){const o=e<0?"-":"",c=Math.abs(e).toString().padStart(n,"0");return o+c}const Dp={y(e,n){const o=e.getFullYear(),c=o>0?o:1-o;return Cs(n==="yy"?c%100:c,n.length)},M(e,n){const o=e.getMonth();return n==="M"?String(o+1):Cs(o+1,2)},d(e,n){return Cs(e.getDate(),n.length)},a(e,n){const o=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return o.toUpperCase();case"aaa":return o;case"aaaaa":return o[0];case"aaaa":default:return o==="am"?"a.m.":"p.m."}},h(e,n){return Cs(e.getHours()%12||12,n.length)},H(e,n){return Cs(e.getHours(),n.length)},m(e,n){return Cs(e.getMinutes(),n.length)},s(e,n){return Cs(e.getSeconds(),n.length)},S(e,n){const o=n.length,c=e.getMilliseconds(),d=Math.trunc(c*Math.pow(10,o-3));return Cs(d,n.length)}},a_={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},XL={G:function(e,n,o){const c=e.getFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return o.era(c,{width:"abbreviated"});case"GGGGG":return o.era(c,{width:"narrow"});case"GGGG":default:return o.era(c,{width:"wide"})}},y:function(e,n,o){if(n==="yo"){const c=e.getFullYear(),d=c>0?c:1-c;return o.ordinalNumber(d,{unit:"year"})}return Dp.y(e,n)},Y:function(e,n,o,c){const d=F5(e,c),y=d>0?d:1-d;if(n==="YY"){const x=y%100;return Cs(x,2)}return n==="Yo"?o.ordinalNumber(y,{unit:"year"}):Cs(y,n.length)},R:function(e,n){const o=O5(e);return Cs(o,n.length)},u:function(e,n){const o=e.getFullYear();return Cs(o,n.length)},Q:function(e,n,o){const c=Math.ceil((e.getMonth()+1)/3);switch(n){case"Q":return String(c);case"QQ":return Cs(c,2);case"Qo":return o.ordinalNumber(c,{unit:"quarter"});case"QQQ":return o.quarter(c,{width:"abbreviated",context:"formatting"});case"QQQQQ":return o.quarter(c,{width:"narrow",context:"formatting"});case"QQQQ":default:return o.quarter(c,{width:"wide",context:"formatting"})}},q:function(e,n,o){const c=Math.ceil((e.getMonth()+1)/3);switch(n){case"q":return String(c);case"qq":return Cs(c,2);case"qo":return o.ordinalNumber(c,{unit:"quarter"});case"qqq":return o.quarter(c,{width:"abbreviated",context:"standalone"});case"qqqqq":return o.quarter(c,{width:"narrow",context:"standalone"});case"qqqq":default:return o.quarter(c,{width:"wide",context:"standalone"})}},M:function(e,n,o){const c=e.getMonth();switch(n){case"M":case"MM":return Dp.M(e,n);case"Mo":return o.ordinalNumber(c+1,{unit:"month"});case"MMM":return o.month(c,{width:"abbreviated",context:"formatting"});case"MMMMM":return o.month(c,{width:"narrow",context:"formatting"});case"MMMM":default:return o.month(c,{width:"wide",context:"formatting"})}},L:function(e,n,o){const c=e.getMonth();switch(n){case"L":return String(c+1);case"LL":return Cs(c+1,2);case"Lo":return o.ordinalNumber(c+1,{unit:"month"});case"LLL":return o.month(c,{width:"abbreviated",context:"standalone"});case"LLLLL":return o.month(c,{width:"narrow",context:"standalone"});case"LLLL":default:return o.month(c,{width:"wide",context:"standalone"})}},w:function(e,n,o,c){const d=zae(e,c);return n==="wo"?o.ordinalNumber(d,{unit:"week"}):Cs(d,n.length)},I:function(e,n,o){const c=kae(e);return n==="Io"?o.ordinalNumber(c,{unit:"week"}):Cs(c,n.length)},d:function(e,n,o){return n==="do"?o.ordinalNumber(e.getDate(),{unit:"date"}):Dp.d(e,n)},D:function(e,n,o){const c=Dae(e);return n==="Do"?o.ordinalNumber(c,{unit:"dayOfYear"}):Cs(c,n.length)},E:function(e,n,o){const c=e.getDay();switch(n){case"E":case"EE":case"EEE":return o.day(c,{width:"abbreviated",context:"formatting"});case"EEEEE":return o.day(c,{width:"narrow",context:"formatting"});case"EEEEEE":return o.day(c,{width:"short",context:"formatting"});case"EEEE":default:return o.day(c,{width:"wide",context:"formatting"})}},e:function(e,n,o,c){const d=e.getDay(),y=(d-c.weekStartsOn+8)%7||7;switch(n){case"e":return String(y);case"ee":return Cs(y,2);case"eo":return o.ordinalNumber(y,{unit:"day"});case"eee":return o.day(d,{width:"abbreviated",context:"formatting"});case"eeeee":return o.day(d,{width:"narrow",context:"formatting"});case"eeeeee":return o.day(d,{width:"short",context:"formatting"});case"eeee":default:return o.day(d,{width:"wide",context:"formatting"})}},c:function(e,n,o,c){const d=e.getDay(),y=(d-c.weekStartsOn+8)%7||7;switch(n){case"c":return String(y);case"cc":return Cs(y,n.length);case"co":return o.ordinalNumber(y,{unit:"day"});case"ccc":return o.day(d,{width:"abbreviated",context:"standalone"});case"ccccc":return o.day(d,{width:"narrow",context:"standalone"});case"cccccc":return o.day(d,{width:"short",context:"standalone"});case"cccc":default:return o.day(d,{width:"wide",context:"standalone"})}},i:function(e,n,o){const c=e.getDay(),d=c===0?7:c;switch(n){case"i":return String(d);case"ii":return Cs(d,n.length);case"io":return o.ordinalNumber(d,{unit:"day"});case"iii":return o.day(c,{width:"abbreviated",context:"formatting"});case"iiiii":return o.day(c,{width:"narrow",context:"formatting"});case"iiiiii":return o.day(c,{width:"short",context:"formatting"});case"iiii":default:return o.day(c,{width:"wide",context:"formatting"})}},a:function(e,n,o){const d=e.getHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return o.dayPeriod(d,{width:"abbreviated",context:"formatting"});case"aaa":return o.dayPeriod(d,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return o.dayPeriod(d,{width:"narrow",context:"formatting"});case"aaaa":default:return o.dayPeriod(d,{width:"wide",context:"formatting"})}},b:function(e,n,o){const c=e.getHours();let d;switch(c===12?d=a_.noon:c===0?d=a_.midnight:d=c/12>=1?"pm":"am",n){case"b":case"bb":return o.dayPeriod(d,{width:"abbreviated",context:"formatting"});case"bbb":return o.dayPeriod(d,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return o.dayPeriod(d,{width:"narrow",context:"formatting"});case"bbbb":default:return o.dayPeriod(d,{width:"wide",context:"formatting"})}},B:function(e,n,o){const c=e.getHours();let d;switch(c>=17?d=a_.evening:c>=12?d=a_.afternoon:c>=4?d=a_.morning:d=a_.night,n){case"B":case"BB":case"BBB":return o.dayPeriod(d,{width:"abbreviated",context:"formatting"});case"BBBBB":return o.dayPeriod(d,{width:"narrow",context:"formatting"});case"BBBB":default:return o.dayPeriod(d,{width:"wide",context:"formatting"})}},h:function(e,n,o){if(n==="ho"){let c=e.getHours()%12;return c===0&&(c=12),o.ordinalNumber(c,{unit:"hour"})}return Dp.h(e,n)},H:function(e,n,o){return n==="Ho"?o.ordinalNumber(e.getHours(),{unit:"hour"}):Dp.H(e,n)},K:function(e,n,o){const c=e.getHours()%12;return n==="Ko"?o.ordinalNumber(c,{unit:"hour"}):Cs(c,n.length)},k:function(e,n,o){let c=e.getHours();return c===0&&(c=24),n==="ko"?o.ordinalNumber(c,{unit:"hour"}):Cs(c,n.length)},m:function(e,n,o){return n==="mo"?o.ordinalNumber(e.getMinutes(),{unit:"minute"}):Dp.m(e,n)},s:function(e,n,o){return n==="so"?o.ordinalNumber(e.getSeconds(),{unit:"second"}):Dp.s(e,n)},S:function(e,n){return Dp.S(e,n)},X:function(e,n,o){const c=e.getTimezoneOffset();if(c===0)return"Z";switch(n){case"X":return YL(c);case"XXXX":case"XX":return Jm(c);case"XXXXX":case"XXX":default:return Jm(c,":")}},x:function(e,n,o){const c=e.getTimezoneOffset();switch(n){case"x":return YL(c);case"xxxx":case"xx":return Jm(c);case"xxxxx":case"xxx":default:return Jm(c,":")}},O:function(e,n,o){const c=e.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+KL(c,":");case"OOOO":default:return"GMT"+Jm(c,":")}},z:function(e,n,o){const c=e.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+KL(c,":");case"zzzz":default:return"GMT"+Jm(c,":")}},t:function(e,n,o){const c=Math.trunc(+e/1e3);return Cs(c,n.length)},T:function(e,n,o){return Cs(+e,n.length)}};function KL(e,n=""){const o=e>0?"-":"+",c=Math.abs(e),d=Math.trunc(c/60),y=c%60;return y===0?o+String(d):o+String(d)+n+Cs(y,2)}function YL(e,n){return e%60===0?(e>0?"-":"+")+Cs(Math.abs(e)/60,2):Jm(e,n)}function Jm(e,n=""){const o=e>0?"-":"+",c=Math.abs(e),d=Cs(Math.trunc(c/60),2),y=Cs(c%60,2);return o+d+n+y}const JL=(e,n)=>{switch(e){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},N5=(e,n)=>{switch(e){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},Fae=(e,n)=>{const o=e.match(/(P+)(p+)?/)||[],c=o[1],d=o[2];if(!d)return JL(e,n);let y;switch(c){case"P":y=n.dateTime({width:"short"});break;case"PP":y=n.dateTime({width:"medium"});break;case"PPP":y=n.dateTime({width:"long"});break;case"PPPP":default:y=n.dateTime({width:"full"});break}return y.replace("{{date}}",JL(c,n)).replace("{{time}}",N5(d,n))},Nae={p:N5,P:Fae},jae=/^D+$/,Bae=/^Y+$/,Vae=["D","DD","YY","YYYY"];function Uae(e){return jae.test(e)}function $ae(e){return Bae.test(e)}function Hae(e,n,o){const c=Gae(e,n,o);if(console.warn(c),Vae.includes(e))throw new RangeError(c)}function Gae(e,n,o){const c=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${n}\`) for formatting ${c} to the input \`${o}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Wae=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,qae=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Zae=/^'([^]*?)'?$/,Xae=/''/g,Kae=/[a-zA-Z]/;function Yae(e,n,o){var k,N,U,K,X,Z,J,le;const c=db(),d=(o==null?void 0:o.locale)??c.locale??Lae,y=(o==null?void 0:o.firstWeekContainsDate)??((N=(k=o==null?void 0:o.locale)==null?void 0:k.options)==null?void 0:N.firstWeekContainsDate)??c.firstWeekContainsDate??((K=(U=c.locale)==null?void 0:U.options)==null?void 0:K.firstWeekContainsDate)??1,x=(o==null?void 0:o.weekStartsOn)??((Z=(X=o==null?void 0:o.locale)==null?void 0:X.options)==null?void 0:Z.weekStartsOn)??c.weekStartsOn??((le=(J=c.locale)==null?void 0:J.options)==null?void 0:le.weekStartsOn)??0,i=gd(e,o==null?void 0:o.in);if(!Qoe(i))throw new RangeError("Invalid time value");let I=n.match(qae).map(de=>{const ue=de[0];if(ue==="p"||ue==="P"){const pe=Nae[ue];return pe(de,d.formatLong)}return de}).join("").match(Wae).map(de=>{if(de==="''")return{isToken:!1,value:"'"};const ue=de[0];if(ue==="'")return{isToken:!1,value:Jae(de)};if(XL[ue])return{isToken:!0,value:de};if(ue.match(Kae))throw new RangeError("Format string contains an unescaped latin alphabet character `"+ue+"`");return{isToken:!1,value:de}});d.localize.preprocessor&&(I=d.localize.preprocessor(i,I));const R={firstWeekContainsDate:y,weekStartsOn:x,locale:d};return I.map(de=>{if(!de.isToken)return de.value;const ue=de.value;(!(o!=null&&o.useAdditionalWeekYearTokens)&&$ae(ue)||!(o!=null&&o.useAdditionalDayOfYearTokens)&&Uae(ue))&&Hae(ue,n,String(e));const pe=XL[ue[0]];return pe(i,ue,d.localize,R)}).join("")}function Jae(e){const n=e.match(Zae);return n?n[1].replace(Xae,"'"):e}const Qae={lessThanXSeconds:{one:"moins dune seconde",other:"moins de {{count}} secondes"},xSeconds:{one:"1 seconde",other:"{{count}} secondes"},halfAMinute:"30 secondes",lessThanXMinutes:{one:"moins dune minute",other:"moins de {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"environ 1 heure",other:"environ {{count}} heures"},xHours:{one:"1 heure",other:"{{count}} heures"},xDays:{one:"1 jour",other:"{{count}} jours"},aboutXWeeks:{one:"environ 1 semaine",other:"environ {{count}} semaines"},xWeeks:{one:"1 semaine",other:"{{count}} semaines"},aboutXMonths:{one:"environ 1 mois",other:"environ {{count}} mois"},xMonths:{one:"1 mois",other:"{{count}} mois"},aboutXYears:{one:"environ 1 an",other:"environ {{count}} ans"},xYears:{one:"1 an",other:"{{count}} ans"},overXYears:{one:"plus dun an",other:"plus de {{count}} ans"},almostXYears:{one:"presquun an",other:"presque {{count}} ans"}},ele=(e,n,o)=>{let c;const d=Qae[e];return typeof d=="string"?c=d:n===1?c=d.one:c=d.other.replace("{{count}}",String(n)),o!=null&&o.addSuffix?o.comparison&&o.comparison>0?"dans "+c:"il y a "+c:c},tle={full:"EEEE d MMMM y",long:"d MMMM y",medium:"d MMM y",short:"dd/MM/y"},nle={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},rle={full:"{{date}} '' {{time}}",long:"{{date}} '' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},ile={date:g_({formats:tle,defaultWidth:"full"}),time:g_({formats:nle,defaultWidth:"full"}),dateTime:g_({formats:rle,defaultWidth:"full"})},sle={lastWeek:"eeee 'dernier ' p",yesterday:"'hier ' p",today:"'aujourdhui ' p",tomorrow:"'demain ' p'",nextWeek:"eeee 'prochain ' p",other:"P"},ole=(e,n,o,c)=>sle[e],ale={narrow:["av. J.-C","ap. J.-C"],abbreviated:["av. J.-C","ap. J.-C"],wide:["avant Jsus-Christ","aprs Jsus-Christ"]},lle={narrow:["T1","T2","T3","T4"],abbreviated:["1er trim.","2me trim.","3me trim.","4me trim."],wide:["1er trimestre","2me trimestre","3me trimestre","4me trimestre"]},cle={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["janv.","fvr.","mars","avr.","mai","juin","juil.","aot","sept.","oct.","nov.","dc."],wide:["janvier","fvrier","mars","avril","mai","juin","juillet","aot","septembre","octobre","novembre","dcembre"]},ule={narrow:["D","L","M","M","J","V","S"],short:["di","lu","ma","me","je","ve","sa"],abbreviated:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],wide:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},dle={narrow:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"mat.",afternoon:"ap.m.",evening:"soir",night:"mat."},abbreviated:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"matin",afternoon:"aprs-midi",evening:"soir",night:"matin"},wide:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"du matin",afternoon:"de laprs-midi",evening:"du soir",night:"du matin"}},hle=(e,n)=>{const o=Number(e),c=n==null?void 0:n.unit;if(o===0)return"0";const d=["year","week","hour","minute","second"];let y;return o===1?y=c&&d.includes(c)?"re":"er":y="me",o+y},fle=["MMM","MMMM"],ple={preprocessor:(e,n)=>e.getDate()===1||!n.some(c=>c.isToken&&fle.includes(c.value))?n:n.map(c=>c.isToken&&c.value==="do"?{isToken:!0,value:"d"}:c),ordinalNumber:hle,era:yh({values:ale,defaultWidth:"wide"}),quarter:yh({values:lle,defaultWidth:"wide",argumentCallback:e=>e-1}),month:yh({values:cle,defaultWidth:"wide"}),day:yh({values:ule,defaultWidth:"wide"}),dayPeriod:yh({values:dle,defaultWidth:"wide"})},mle=/^(\d+)(ime|re|me|er|e)?/i,gle=/\d+/i,_le={narrow:/^(av\.J\.C|ap\.J\.C|ap\.J\.-C)/i,abbreviated:/^(av\.J\.-C|av\.J-C|apr\.J\.-C|apr\.J-C|ap\.J-C)/i,wide:/^(avant Jsus-Christ|aprs Jsus-Christ)/i},yle={any:[/^av/i,/^ap/i]},vle={narrow:/^T?[1234]/i,abbreviated:/^[1234](er|me|e)? trim\.?/i,wide:/^[1234](er|me|e)? trimestre/i},xle={any:[/1/i,/2/i,/3/i,/4/i]},ble={narrow:/^[jfmasond]/i,abbreviated:/^(janv|fvr|mars|avr|mai|juin|juill|juil|aot|sept|oct|nov|dc)\.?/i,wide:/^(janvier|fvrier|mars|avril|mai|juin|juillet|aot|septembre|octobre|novembre|dcembre)/i},wle={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^av/i,/^ma/i,/^juin/i,/^juil/i,/^ao/i,/^s/i,/^o/i,/^n/i,/^d/i]},Sle={narrow:/^[lmjvsd]/i,short:/^(di|lu|ma|me|je|ve|sa)/i,abbreviated:/^(dim|lun|mar|mer|jeu|ven|sam)\.?/i,wide:/^(dimanche|lundi|mardi|mercredi|jeudi|vendredi|samedi)/i},Cle={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^di/i,/^lu/i,/^ma/i,/^me/i,/^je/i,/^ve/i,/^sa/i]},Tle={narrow:/^(a|p|minuit|midi|mat\.?|ap\.?m\.?|soir|nuit)/i,any:/^([ap]\.?\s?m\.?|du matin|de l'aprs[-\s]midi|du soir|de la nuit)/i},Ele={any:{am:/^a/i,pm:/^p/i,midnight:/^min/i,noon:/^mid/i,morning:/mat/i,afternoon:/ap/i,evening:/soir/i,night:/nuit/i}},Ile={ordinalNumber:z5({matchPattern:mle,parsePattern:gle,valueCallback:e=>parseInt(e)}),era:vh({matchPatterns:_le,defaultMatchWidth:"wide",parsePatterns:yle,defaultParseWidth:"any"}),quarter:vh({matchPatterns:vle,defaultMatchWidth:"wide",parsePatterns:xle,defaultParseWidth:"any",valueCallback:e=>e+1}),month:vh({matchPatterns:ble,defaultMatchWidth:"wide",parsePatterns:wle,defaultParseWidth:"any"}),day:vh({matchPatterns:Sle,defaultMatchWidth:"wide",parsePatterns:Cle,defaultParseWidth:"any"}),dayPeriod:vh({matchPatterns:Tle,defaultMatchWidth:"any",parsePatterns:Ele,defaultParseWidth:"any"})},Ple={code:"fr",formatDistance:ele,formatLong:ile,formatRelative:ole,localize:ple,match:Ile,options:{weekStartsOn:1,firstWeekContainsDate:4}},Ale=({ownedCats:e,onShowCatDetails:n,onDeleteCat:o,onEditCat:c,onReportAsLost:d,successMessage:y})=>{const{t:x}=Rs(),{enums:i,loading:I,error:R,getEnumLabel:k}=$_(),{formatValue:N,calculateAge:U}=kf(),{fetchCats:K,getCatLocationHistory:X}=W_(),[Z,J]=V.useState(!1),[le,de]=V.useState([]),[ue,pe]=V.useState(!1),[he,xe]=V.useState(!1),[fe,_e]=V.useState(!1),[Ce,je]=V.useState(null),{getCurrentPosition:He,isLocating:lt,geoError:_t,setGeoError:Ue}=V1(),[Ge,at]=V.useState({name:"",breed:"",color:"",eyeColor:"",gender:"",dateOfBirth:"",chipNumber:"",furType:"",comment:"",images:[],vaccinated:null,sterilized:null}),[yt,tt]=V.useState({comment:"",location:{latitude:null,longitude:null,address:"",city:"",postalCode:""}}),Rt=We=>{je(We);let st="";We.cat.dateOfBirth&&(st=new Date(We.cat.dateOfBirth).toISOString().split("T")[0]);const Bt=We.cat.imageUrls||[],hn={name:We.cat.name||"",breed:Wa(We.cat.breed,"UNKNOWN"),color:Wa(We.cat.color,"AUTRE"),eyeColor:Wa(We.cat.eyeColor,"AUTRE"),gender:We.cat.gender||"Inconnu",dateOfBirth:st,chipNumber:We.cat.chipNumber||"",furType:Wa(We.cat.furType,"COURTE"),comment:We.cat.comment||"",images:Array.isArray(Bt)?Bt:[],vaccinated:We.cat.vaccinated??null,sterilized:We.cat.sterilized??null};at(hn),xe(!0)};V.useEffect(()=>{if(Ce&&Ce.cat){let We="";Ce.cat.dateOfBirth&&(We=new Date(Ce.cat.dateOfBirth).toISOString().split("T")[0]);const st=Ce.cat.imageUrls||[],Bt={name:Ce.cat.name||"",breed:Ce.cat.breed||"UNKNOWN",color:Ce.cat.color||"AUTRE",eyeColor:Ce.cat.eyeColor||"AUTRE",gender:Ce.cat.gender||"Inconnu",dateOfBirth:We,chipNumber:Ce.cat.chipNumber||"",furType:Ce.cat.furType||"Courte",comment:Ce.cat.comment||"",images:Array.isArray(st)?st:[],vaccinated:Ce.cat.vaccinated??null,sterilized:Ce.cat.sterilized??null};at(Bt)}},[Ce]),V.useEffect(()=>{var We,st,Bt,hn,cn;Ce&&(at(cr=>({name:Ce.cat.name||"",breed:Ce.cat.breed||"",color:Ce.cat.color||"",eyeColor:Ce.cat.eyeColor||"",gender:Ce.cat.gender||"",dateOfBirth:Ce.cat.dateOfBirth?Ce.cat.dateOfBirth.substring(0,10):"",chipNumber:Ce.cat.chipNumber||"",furType:Ce.cat.furType||"",comment:Ce.cat.comment||"",images:Ce.cat.imageUrls||[],vaccinated:Ce.cat.vaccinated??null,sterilized:Ce.cat.sterilized??null})),fe&&tt({comment:"",location:{latitude:((We=Ce.location)==null?void 0:We.latitude)||null,longitude:((st=Ce.location)==null?void 0:st.longitude)||null,address:((Bt=Ce.location)==null?void 0:Bt.address)||"",city:((hn=Ce.location)==null?void 0:hn.city)||"",postalCode:((cn=Ce.location)==null?void 0:cn.postalCode)||""}}))},[Ce,fe]);const ct=async We=>{We.preventDefault(),console.log("editForm",Ge),console.log("selectedCat",Ce);const{images:st,...Bt}=Ge,hn={...Bt,imageUrls:st,imageUrl:st.length>0?st[0]:null};console.log("payload",hn);const cn=await c(Ce.cat.catId,hn);console.log("edit success",cn),xe(!1),cn&&(await K(),console.log("Cats fetched"))},ze=We=>{const{name:st,value:Bt}=We.target;at(hn=>({...hn,[st]:Bt}))},Ye=V.useCallback(async(We,st)=>{try{const Bt=await U_(We,st);tt(hn=>({...hn,location:{latitude:st,longitude:We,address:(Bt==null?void 0:Bt.address)||"",city:(Bt==null?void 0:Bt.city)||"",postalCode:(Bt==null?void 0:Bt.postalCode)||""}}))}catch(Bt){console.error("Erreur lors de la golocalisation inverse:",Bt)}},[]),At=V.useCallback(async()=>{Ue(null);try{const We=await He();We&&We.longitude&&We.latitude&&await Ye(We.longitude,We.latitude)}catch(We){Ue(We.message)}},[He,Ye,Ue]),Ct=async We=>{try{const st=await X(We);de(st),pe(!0)}catch(st){console.error("Erreur lors de la rcupration de l'historique:",st)}};return e.length===0?T.jsx(mi,{variant:"info",children:"Vous n'avez pas encore de chats."}):T.jsxs(T.Fragment,{children:[T.jsxs(yn.Title,{className:"mb-4",children:[T.jsx(hl,{className:"me-2"}),x("ownedCats.title","Mes chats")]}),y&&T.jsx(mi,{variant:"success",className:"mb-3",children:x("ownedCats.success",y)}),T.jsx("div",{className:"text-center mb-4",children:T.jsx(ia,{bg:"primary",className:"px-3 py-2",children:x("ownedCats.count",{count:e.length,defaultValue:"{{count}} chats"})})}),T.jsx(vi,{xs:1,md:2,lg:3,className:"g-4",children:e.map(We=>{const st=We.cat;return T.jsx(Un,{children:T.jsx(Za.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:T.jsxs(yn,{className:"cat-card shadow-sm h-100",children:[T.jsx(yn.Img,{variant:"top",src:st.imageUrls&&Array.isArray(st.imageUrls)&&st.imageUrls.length>0?st.imageUrls[0]:"/noImageCat.png",alt:st.name,onError:Bt=>{Bt.target.src="/noImageCat.png",Bt.target.onerror=null},style:{height:"200px",objectFit:"cover",cursor:"pointer"},onClick:()=>n(We)}),T.jsxs(yn.Body,{children:[T.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[T.jsx(yn.Title,{className:"mb-0",children:st.name||x("ownedCats.noName","Chat sans nom")}),T.jsx(ia,{bg:k(i==null?void 0:i.catGender,st.gender)==="Mle"?"primary":"danger",className:"ms-2",children:k(i==null?void 0:i.catGender,st.gender)||x("ownedCats.unknownGender","Inconnu")})]}),T.jsxs(yn.Text,{className:"text-muted small",children:[x("ownedCats.breed","Race"),":"," ",k(i==null?void 0:i.breed,st.breed)||x("ownedCats.unknownBreed","Inconnue")]}),T.jsx("div",{className:"d-grid mb-2",children:T.jsx(Qn,{variant:"outline-primary",size:"sm",onClick:()=>n(We),className:"w-100 cat-details-btn",children:x("ownedCats.details","Voir les dtails")})}),T.jsxs("div",{className:"d-flex justify-content-center gap-2 cat-actions-row",children:[T.jsx(Qn,{variant:"outline-success",size:"sm",onClick:()=>Rt(We),title:x("ownedCats.edit","Modifier"),className:"cat-action-btn",children:T.jsx(I7,{})}),T.jsx(Qn,{variant:"outline-danger",size:"sm",onClick:Bt=>{Bt.stopPropagation(),o(st.catId)},title:x("ownedCats.delete","Supprimer"),className:"cat-action-btn",children:T.jsx(KO,{})}),T.jsx(Qn,{variant:"outline-warning",size:"sm",onClick:Bt=>{Bt.stopPropagation(),_e(!0),je(We)},title:x("ownedCats.reportLost","Signaler perdu"),className:"cat-action-btn",children:T.jsx(_C,{})}),T.jsx(Qn,{variant:"outline-info",size:"sm",onClick:()=>Ct(st.catId),title:x("ownedCats.history","Historique"),className:"cat-action-btn",children:T.jsx(lv,{})})]})]})]})})},st.catId)})}),T.jsxs(Wi,{show:he,onHide:()=>xe(!1),onShow:()=>{},children:[T.jsx(Wi.Header,{closeButton:!0,children:T.jsx(Wi.Title,{children:x("ownedCats.editTitle","Modifier les informations du chat")})}),T.jsx(Wi.Body,{children:T.jsxs(ot,{onSubmit:ct,children:[T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:x("ownedCats.name","Nom du chat")}),T.jsx(ot.Control,{type:"text",name:"name",value:Ge.name,onChange:ze,placeholder:x("ownedCats.namePlaceholder","Nom du chat")})]}),T.jsxs(vi,{className:"mb-3",children:[T.jsx(Un,{md:6,children:T.jsxs(ot.Group,{children:[T.jsx(ot.Label,{children:x("ownedCats.breed","Race")}),T.jsxs(ot.Select,{name:"breed",value:Ge.breed,onChange:ze,disabled:I||R,children:[T.jsx("option",{value:"",children:x("ownedCats.selectBreed","Slectionner une race")}),i&&i.breed.map(We=>T.jsx("option",{value:We.value,children:We.label},We.value))]})]})}),T.jsx(Un,{md:6,children:T.jsxs(ot.Group,{children:[T.jsx(ot.Label,{children:x("ownedCats.gender","Genre")}),T.jsxs(ot.Select,{name:"gender",value:Ge.gender,onChange:ze,disabled:I||R,children:[T.jsx("option",{value:"",children:x("ownedCats.selectGender","Slectionner un genre")}),i&&i.catGender.map(We=>T.jsx("option",{value:We.value,children:We.label},We.value))]})]})})]}),T.jsxs(vi,{className:"mb-3",children:[T.jsx(Un,{md:6,children:T.jsxs(ot.Group,{children:[T.jsx(ot.Label,{children:x("ownedCats.color","Couleur")}),T.jsxs(ot.Select,{name:"color",value:Ge.color,onChange:ze,disabled:I||R,children:[T.jsx("option",{value:"",children:x("ownedCats.selectColor","Slectionner une couleur")}),i&&i.catColor.map(We=>T.jsx("option",{value:We.value,children:We.label},We.value))]})]})}),T.jsx(Un,{md:6,children:T.jsxs(ot.Group,{children:[T.jsx(ot.Label,{children:x("ownedCats.eyeColor","Couleur des yeux")}),T.jsxs(ot.Select,{name:"eyeColor",value:Ge.eyeColor,onChange:ze,disabled:I||R,children:[T.jsx("option",{value:"",children:x("ownedCats.selectEyeColor","Slectionner une couleur")}),i&&i.eyeColor.map(We=>T.jsx("option",{value:We.value,children:We.label},We.value))]})]})})]}),T.jsxs(vi,{className:"mb-3",children:[T.jsx(Un,{md:6,children:T.jsxs(ot.Group,{children:[T.jsx(ot.Label,{children:x("ownedCats.furType","Type de fourrure")}),T.jsxs(ot.Select,{name:"furType",value:Ge.furType,onChange:ze,disabled:I||R,children:[T.jsx("option",{value:"",children:x("ownedCats.selectFurType","Slectionner un type")}),i&&i.furType.map(We=>T.jsx("option",{value:We.value,children:We.label},We.value))]})]})}),T.jsx(Un,{md:6,children:T.jsxs(ot.Group,{children:[T.jsx(ot.Label,{children:x("ownedCats.dateOfBirth","Date de naissance")}),T.jsx(ot.Control,{type:"date",name:"dateOfBirth",value:Ge.dateOfBirth,onChange:ze})]})})]}),T.jsxs(vi,{className:"mb-3",children:[T.jsx(Un,{md:6,children:T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:x("ownedCats.vaccinated","Vaccin")}),T.jsxs(ot.Select,{name:"vaccinated",value:Ge.vaccinated===null?"":Ge.vaccinated?"true":"false",onChange:We=>at(st=>({...st,vaccinated:We.target.value===""?null:We.target.value==="true"})),children:[T.jsx("option",{value:"",children:x("ownedCats.notSpecified","Non spcifi")}),T.jsx("option",{value:"true",children:x("ownedCats.yes","Oui")}),T.jsx("option",{value:"false",children:x("ownedCats.no","Non")})]})]})}),T.jsx(Un,{md:6,children:T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:x("ownedCats.sterilized","Strilis")}),T.jsxs(ot.Select,{name:"sterilized",value:Ge.sterilized===null?"":Ge.sterilized?"true":"false",onChange:We=>at(st=>({...st,sterilized:We.target.value===""?null:We.target.value==="true"})),children:[T.jsx("option",{value:"",children:x("ownedCats.notSpecified","Non spcifi")}),T.jsx("option",{value:"true",children:x("ownedCats.yes","Oui")}),T.jsx("option",{value:"false",children:x("ownedCats.no","Non")})]})]})})]}),T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:x("ownedCats.chipNumber","Numro de puce")}),T.jsx(ot.Control,{type:"text",name:"chipNumber",value:Ge.chipNumber,onChange:ze,placeholder:x("ownedCats.chipNumberPlaceholder","Numro de puce (si disponible)")})]}),T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:x("ownedCats.comment","Commentaire")}),T.jsx(ot.Control,{as:"textarea",name:"comment",value:Ge.comment,onChange:ze,placeholder:x("ownedCats.commentPlaceholder","Informations supplmentaires sur votre chat")})]}),T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:"Photos"}),T.jsx(dT,{onImageUploaded:We=>at(st=>({...st,images:We})),initialImage:Ge.images,multiple:!0,maxImages:5,maxSize:5,allowedTypes:["image/jpeg","image/png","image/gif","image/webp"],onUploadStatusChange:J})]}),T.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[T.jsx(Qn,{variant:"secondary",onClick:()=>xe(!1),children:x("ownedCats.cancel","Annuler")}),T.jsxs(Qn,{variant:"primary",type:"submit",disabled:Z,children:[Z&&T.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),Z?x("ownedCats.savingImages","Traitement des images..."):x("ownedCats.save","Enregistrer")]})]})]})})]}),T.jsxs(Wi,{show:fe,onHide:()=>_e(!1),onShow:()=>{var We,st,Bt,hn,cn;Ce&&tt({comment:"",location:{latitude:((We=Ce.location)==null?void 0:We.latitude)||null,longitude:((st=Ce.location)==null?void 0:st.longitude)||null,address:((Bt=Ce.location)==null?void 0:Bt.address)||"",city:((hn=Ce.location)==null?void 0:hn.city)||"",postalCode:((cn=Ce.location)==null?void 0:cn.postalCode)||""}})},children:[T.jsx(Wi.Header,{closeButton:!0,children:T.jsx(Wi.Title,{children:x("ownedCats.reportLostTitle","Signaler un chat perdu")})}),T.jsx(Wi.Body,{children:T.jsxs(ot,{onSubmit:We=>{We.preventDefault(),d(Ce.cat.catId,yt),_e(!1)},children:[T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:x("ownedCats.comment","Commentaire")}),T.jsx(ot.Control,{as:"textarea",name:"comment",value:yt.comment,onChange:We=>tt(st=>({...st,comment:We.target.value})),placeholder:x("ownedCats.lostCommentPlaceholder","Informations supplmentaires sur la disparition de votre chat")})]}),T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:x("ownedCats.location","Localisation")}),T.jsx(Xv,{location:yt.location,onLocationChange:(We,st)=>Ye(We,st),onAddressChange:We=>{tt(st=>({...st,location:{...st.location,...We}}))},isLocating:lt,geoError:_t,onGeoErrorDismiss:()=>Ue(null),onRequestCurrentLocation:At,mapHeight:"300px"})]}),T.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[T.jsx(Qn,{variant:"secondary",onClick:()=>_e(!1),children:x("ownedCats.cancel","Annuler")}),T.jsx(Qn,{variant:"primary",type:"submit",children:x("ownedCats.report","Signaler")})]})]})})]}),T.jsxs(Wi,{show:ue,onHide:()=>pe(!1),size:"lg",children:[T.jsx(Wi.Header,{closeButton:!0,className:"bg-light",children:T.jsxs(Wi.Title,{children:[T.jsx(lv,{className:"me-2"}),x("ownedCats.historyTitle","Historique des localisations")]})}),T.jsx(Wi.Body,{children:le.length===0?T.jsxs(mi,{variant:"info",children:[T.jsx(Y2,{className:"me-2"}),x("ownedCats.noHistory","Aucun historique disponible")]}):T.jsx("div",{className:"location-history",children:le.map((We,st)=>T.jsxs("div",{className:"mb-4 position-relative",children:[st<le.length-1&&T.jsx("div",{className:"position-absolute",style:{left:"20px",top:"40px",bottom:"-20px",width:"2px",backgroundColor:"#dee2e6",zIndex:0}}),T.jsxs("div",{className:"d-flex",children:[T.jsx("div",{className:"rounded-circle bg-primary",style:{width:"40px",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1,marginRight:"20px"},children:T.jsx(lv,{className:"text-white"})}),T.jsxs("div",{className:"flex-grow-1 bg-light rounded p-3 shadow-sm",children:[T.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[T.jsx("h6",{className:"mb-0 text-primary",children:We.reportDate?Yae(new Date(We.reportDate.replace(" ","T")),"dd MMMM yyyy HH:mm",{locale:Ple}):x("ownedCats.noDate","Date non disponible")}),T.jsx(ia,{bg:We.statusCat==="LOST"?"danger":We.statusCat==="FOUND"?"success":"primary",className:"ms-2",children:We.statusCat==="LOST"?x("cat.lost","Perdu"):We.statusCat==="FOUND"?x("cat.found","Trouv"):We.statusCat==="OWN"?x("ownedCats.owned","Possd"):We.statusCat})]}),We.location&&T.jsxs("div",{className:"mb-2",children:[T.jsxs("div",{className:"d-flex align-items-center mb-1",children:[T.jsx(zc,{className:"text-muted me-2"}),T.jsxs("strong",{children:[x("ownedCats.location","Localisation"),":"]})]}),T.jsxs("div",{className:"ms-4",children:[We.location.address&&T.jsxs("p",{className:"mb-1",children:[T.jsxs("strong",{children:[x("ownedCats.address","Adresse"),":"]})," ",We.location.address]}),We.location.city&&T.jsxs("p",{className:"mb-1",children:[T.jsxs("strong",{children:[x("ownedCats.city","Ville"),":"]})," ",We.location.city]}),We.location.postalCode&&T.jsxs("p",{className:"mb-1",children:[T.jsxs("strong",{children:[x("ownedCats.postalCode","Code postal"),":"]})," ",We.location.postalCode]})]})]}),We.comment&&T.jsxs("div",{className:"mt-2",children:[T.jsxs("div",{className:"d-flex align-items-center mb-1",children:[T.jsx(T7,{className:"text-muted me-2"}),T.jsxs("strong",{children:[x("ownedCats.comment","Commentaire"),":"]})]}),T.jsx("p",{className:"mb-0 ms-4",children:We.comment})]})]})]})]},st))})}),T.jsx(Wi.Footer,{className:"bg-light",children:T.jsx(Qn,{variant:"secondary",onClick:()=>pe(!1),children:x("common.close","Fermer")})})]})]})},Rle=({formData:e,setFormData:n,handleSubmit:o,updateSuccess:c,updateError:d})=>{const{t:y}=Rs(),[x,i]=V.useState(""),[I,R]=V.useState(""),{enums:k,loading:N,error:U}=$_(),K=new Date().toISOString().split("T")[0],X=de=>{const{name:ue,value:pe}=de.target;if(ue==="phone"){const he=z4(pe);n(_e=>({..._e,[ue]:he}));const{isValid:xe,errorMessage:fe}=_S(he);R(fe)}else if(ue==="birthDay"){if(pe){if(!/^\d{4}-\d{2}-\d{2}$/.test(pe)){i("Format de date invalide");return}const xe=new Date(pe),fe=new Date;fe.setHours(0,0,0,0),xe>fe?i("La date de naissance ne peut pas tre dans le futur"):i("")}else i("");n(he=>({...he,[ue]:pe}))}else n(he=>({...he,[ue]:pe}))},Z=V.useCallback(async(de,ue)=>{try{const pe=await U_(de,ue);n(he=>({...he,longitude:de,latitude:ue,address:(pe==null?void 0:pe.address)||he.address,city:(pe==null?void 0:pe.city)||he.city,postalCode:(pe==null?void 0:pe.postalCode)||he.postalCode}))}catch(pe){console.error("Erreur lors de la rcupration de l'adresse:",pe)}},[n]),J=(de,ue)=>{Z(de,ue)},le=de=>{n(ue=>({...ue,address:de.address||ue.address,city:de.city||ue.city,postalCode:de.postalCode||ue.postalCode}))};return T.jsxs(ot,{onSubmit:o,className:"mt-4",children:[c&&T.jsx(mi,{variant:"success",className:"mb-3",children:y("personalInfo.success","Vos informations ont t mises  jour avec succs !")}),d&&T.jsx(mi,{variant:"danger",className:"mb-3",children:d}),T.jsxs(vi,{children:[T.jsx(Un,{md:6,children:T.jsxs(ot.Group,{className:"mb-3",children:[T.jsxs(ot.Label,{children:[T.jsx(Gp,{className:"me-2"}),y("personalInfo.firstName","Prnom")]}),T.jsx(ot.Control,{type:"text",name:"firstName",value:e.firstName,onChange:X,placeholder:y("personalInfo.firstNamePlaceholder","Votre prnom")})]})}),T.jsx(Un,{md:6,children:T.jsxs(ot.Group,{className:"mb-3",children:[T.jsxs(ot.Label,{children:[T.jsx(Gp,{className:"me-2"}),y("personalInfo.lastName","Nom")]}),T.jsx(ot.Control,{type:"text",name:"lastName",value:e.lastName,onChange:X,placeholder:y("personalInfo.lastNamePlaceholder","Votre nom")})]})})]}),T.jsxs(ot.Group,{className:"mb-4",children:[T.jsxs(ot.Label,{children:[T.jsx(zc,{className:"me-2"}),y("personalInfo.address","Adresse")]}),T.jsx(Xv,{location:{address:e.address,city:e.city,postalCode:e.postalCode,latitude:e.latitude,longitude:e.longitude},onLocationChange:J,onAddressChange:le,mapHeight:"300px"})]}),T.jsxs(vi,{children:[T.jsx(Un,{md:4,children:T.jsxs(ot.Group,{className:"mb-3",children:[T.jsxs(ot.Label,{children:[T.jsx(YO,{className:"me-2"}),y("personalInfo.gender","Genre")]}),T.jsxs(ot.Select,{name:"gender",value:e.gender,onChange:X,disabled:N||U,children:[T.jsx("option",{value:"",children:y("personalInfo.genderSelect","Slectionnez votre genre")}),k&&k.gender.map(de=>T.jsx("option",{value:de.value,children:de.label},de.value))]}),U&&T.jsx("div",{className:"text-danger",children:"Erreur lors du chargement des genres"})]})}),T.jsx(Un,{md:4,children:T.jsxs(ot.Group,{className:"mb-3",children:[T.jsxs(ot.Label,{children:[T.jsx(WO,{className:"me-2"}),y("personalInfo.birthDay","Date de naissance")]}),T.jsx(ot.Control,{type:"date",name:"birthDay",value:e.birthDay,onChange:X,max:K}),x&&T.jsx("div",{className:"text-danger",children:x})]})}),T.jsx(Un,{md:4,children:T.jsxs(ot.Group,{className:"mb-3",children:[T.jsxs(ot.Label,{children:[T.jsx(O1,{className:"me-2"}),y("personalInfo.phone","Tlphone")]}),T.jsx(ot.Control,{type:"tel",name:"phone",value:e.phone,onChange:X,placeholder:y("personalInfo.phonePlaceholder","Votre numro de tlphone")}),I&&T.jsx("div",{className:"text-danger",children:I})]})})]}),T.jsx(Qn,{variant:"primary",type:"submit",className:"mt-3",children:y("personalInfo.save","Enregistrer les modifications")})]})},Mle=({passwordForm:e,setPasswordForm:n,handleSubmit:o,updateSuccess:c,updateError:d})=>{const[y,x]=qi.useState(!1),[i,I]=qi.useState(!1),[R,k]=qi.useState(!1),N=U=>{const{id:K,value:X}=U.target;n(Z=>({...Z,[K]:X}))};return T.jsxs(ot,{onSubmit:o,className:"mt-4",children:[c&&T.jsx(mi,{variant:"success",className:"mb-3",children:"Votre mot de passe a t mis  jour avec succs !"}),d&&T.jsx(mi,{variant:"danger",className:"mb-3",children:d}),T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:"Mot de passe actuel"}),T.jsxs("div",{className:"input-group",children:[T.jsx(ot.Control,{type:y?"text":"password",id:"currentPassword",value:e.currentPassword,onChange:N,required:!0}),T.jsx(Qn,{variant:"outline-secondary",onClick:()=>x(!y),children:y?T.jsx(Vp,{}):T.jsx(Up,{})})]})]}),T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:"Nouveau mot de passe"}),T.jsxs("div",{className:"input-group",children:[T.jsx(ot.Control,{type:i?"text":"password",id:"newPassword",value:e.newPassword,onChange:N,required:!0}),T.jsx(Qn,{variant:"outline-secondary",onClick:()=>I(!i),children:i?T.jsx(Vp,{}):T.jsx(Up,{})})]})]}),T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:"Confirmer le nouveau mot de passe"}),T.jsxs("div",{className:"input-group",children:[T.jsx(ot.Control,{type:R?"text":"password",id:"matchingPassword",value:e.matchingPassword,onChange:N,required:!0}),T.jsx(Qn,{variant:"outline-secondary",onClick:()=>k(!R),children:R?T.jsx(Vp,{}):T.jsx(Up,{})})]})]}),T.jsx("div",{className:"d-grid",children:T.jsx(Qn,{variant:"outline-primary",type:"submit",size:"lg",className:"rounded-pill",children:"Mettre  jour le mot de passe"})})]})},Lle=e=>{switch(e){case"PENDING":return"warning";case"PAID":return"info";case"SHIPPED":return"primary";case"DELIVERED":return"success";case"CANCELLED":return"danger";default:return"secondary"}},Dle=(e,n)=>{switch(e){case"PENDING":return n("orderHistory.status.pending","En attente");case"PAID":return n("orderHistory.status.paid","Paye");case"SHIPPED":return n("orderHistory.status.shipped","Expdie");case"DELIVERED":return n("orderHistory.status.delivered","Livre");case"CANCELLED":return n("orderHistory.status.cancelled","Annule");default:return e}},kle=({orders:e,ordersLoading:n})=>{const{t:o}=Rs(),[c,d]=V.useState("desc"),[y,x]=V.useState("ALL"),i=V.useMemo(()=>{if(!e)return[];let I=[...e];return y!=="ALL"&&(I=I.filter(R=>R.status===y)),I.sort((R,k)=>{const N=new Date(R.orderDate),U=new Date(k.orderDate);return c==="desc"?U-N:N-U}),I},[e,c,y]);return n?T.jsx("div",{className:"text-center",children:T.jsx(xu,{animation:"border"})}):!e||e.length===0?T.jsx(mi,{variant:"info",children:o("orderHistory.noOrders","Vous n'avez pas encore pass de commande.")}):T.jsxs("div",{className:"orders-list",children:[T.jsx(yn,{className:"mb-3",children:T.jsx(yn.Body,{children:T.jsxs(vi,{className:"g-3",children:[T.jsx(Un,{xs:12,md:6,children:T.jsxs(ot.Group,{children:[T.jsx(ot.Label,{children:o("orderHistory.sortByDate","Trier par date")}),T.jsxs(ot.Select,{value:c,onChange:I=>d(I.target.value),children:[T.jsx("option",{value:"desc",children:o("orderHistory.mostRecentFirst","Plus rcent d'abord")}),T.jsx("option",{value:"asc",children:o("orderHistory.oldestFirst","Plus ancien d'abord")})]})]})}),T.jsx(Un,{xs:12,md:6,children:T.jsxs(ot.Group,{children:[T.jsx(ot.Label,{children:o("orderHistory.filterByStatus","Filtrer par statut")}),T.jsxs(ot.Select,{value:y,onChange:I=>x(I.target.value),children:[T.jsx("option",{value:"ALL",children:o("orderHistory.allStatuses","Tous les statuts")}),T.jsx("option",{value:"PENDING",children:o("orderHistory.status.pending","En attente")}),T.jsx("option",{value:"PAID",children:o("orderHistory.status.paid","Paye")}),T.jsx("option",{value:"SHIPPED",children:o("orderHistory.status.shipped","Expdie")}),T.jsx("option",{value:"DELIVERED",children:o("orderHistory.status.delivered","Livre")}),T.jsx("option",{value:"CANCELLED",children:o("orderHistory.status.cancelled","Annule")})]})]})})]})})}),i.length===0?T.jsx(mi,{variant:"info",children:o("orderHistory.noMatchingOrders","Aucune commande ne correspond  vos critres de recherche.")}):i.map(I=>T.jsxs(yn,{className:"mb-3",children:[T.jsxs(yn.Header,{className:"d-flex justify-content-between align-items-center",children:[T.jsxs("strong",{children:[o("orderHistory.order","Commande")," #",I.id]}),T.jsx("span",{children:new Date(I.orderDate).toLocaleDateString("fr-BE",{year:"numeric",month:"long",day:"numeric"})})]}),T.jsxs(yn.Body,{children:[T.jsx("div",{className:"order-items",children:I.orderItems.map((R,k)=>T.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[T.jsxs("div",{children:[T.jsx("span",{className:"fw-bold",children:R.product.name}),T.jsxs("span",{className:"text-muted ms-2",children:["x",R.quantity]})]}),T.jsxs("span",{children:[(R.product.price*R.quantity).toFixed(2)," "]})]},k))}),T.jsx("hr",{}),T.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[T.jsxs("div",{children:[T.jsx("strong",{children:o("orderHistory.total","Total:")}),T.jsxs("span",{className:"ms-2",children:[I.orderItems.reduce((R,k)=>R+k.product.price*k.quantity,0).toFixed(2)," "]})]}),T.jsx("span",{className:`badge bg-${Lle(I.status)}`,children:Dle(I.status,o)})]})]})]},I.id))]})},Ole=({connectedUser:e,activeTab:n,setActiveTab:o,handleDeleteAccount:c})=>{var y,x;const{t:d}=Rs();return T.jsx(yn,{className:"shadow-sm sticky-top",style:{top:"2rem"},children:T.jsxs(yn.Body,{className:"text-center",children:[T.jsxs("div",{className:"profile-avatar mb-4",style:{width:"120px",height:"120px",borderRadius:"50%",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",display:"flex",justifyContent:"center",alignItems:"center",fontSize:"40px",margin:"0 auto",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",transition:"transform 0.3s ease",cursor:"pointer"},onMouseOver:i=>i.currentTarget.style.transform="scale(1.05)",onMouseOut:i=>i.currentTarget.style.transform="scale(1)",children:[((y=e==null?void 0:e.firstName)==null?void 0:y.charAt(0))||"",((x=e==null?void 0:e.lastName)==null?void 0:x.charAt(0))||""]}),T.jsxs(yn.Title,{className:"mb-3",children:[(e==null?void 0:e.firstName)||""," ",(e==null?void 0:e.lastName)||""]}),T.jsx(yn.Text,{className:"text-muted mb-4",children:d("profileSidebar.role","Particulier")}),T.jsxs(hd,{variant:"flush",children:[T.jsxs(hd.Item,{action:!0,active:n==="profile",onClick:()=>o("profile"),className:"d-flex align-items-center",children:[T.jsx(Gp,{className:"me-3"}),T.jsx("span",{children:d("profileSidebar.profile","Profil")})]}),T.jsxs(hd.Item,{action:!0,active:n==="security",onClick:()=>o("security"),className:"d-flex align-items-center",children:[T.jsx(S_,{className:"me-3"}),T.jsx("span",{children:d("profileSidebar.security","Scurit")})]}),T.jsxs(hd.Item,{action:!0,active:n==="orders",onClick:()=>o("orders"),className:"d-flex align-items-center",children:[T.jsx(lv,{className:"me-3"}),T.jsx("span",{children:d("profileSidebar.orders","Historique des commandes")})]}),T.jsxs(hd.Item,{action:!0,active:n==="reported",onClick:()=>o("reported"),className:"d-flex align-items-center",children:[T.jsx(hl,{className:"me-3"}),T.jsx("span",{children:d("profileSidebar.reported","Chats Signals")})]}),T.jsxs(hd.Item,{action:!0,active:n==="ownedCats",onClick:()=>o("ownedCats"),className:"d-flex align-items-center",children:[T.jsx(hl,{className:"me-3"}),T.jsx("span",{children:d("profileSidebar.ownedCats","Mes chats")})]}),T.jsxs(hd.Item,{action:!0,active:n==="pendingLinks",onClick:()=>o("pendingLinks"),className:"d-flex align-items-center",children:[T.jsx(XO,{className:"me-3"}),T.jsx("span",{children:d("profileSidebar.pendingLinks","Demandes de liaison")})]})]}),T.jsx(Qn,{variant:"outline-danger",size:"sm",className:"w-100 mt-3",onClick:c,style:{color:"#dc3545",borderColor:"#dc3545",backgroundColor:"transparent",transition:"all 0.3s ease"},onMouseEnter:i=>{i.target.style.backgroundColor="#dc3545",i.target.style.color="white"},onMouseLeave:i=>{i.target.style.backgroundColor="transparent",i.target.style.color="#dc3545"},children:d("profileSidebar.deleteAccount","Supprimer mon compte")})]})})},zle=()=>{const{t:e}=Rs(),{pendingRequests:n,loading:o,error:c,successMessage:d,fetchPendingRequests:y,respondToLinkRequest:x}=D5(),[i,I]=V.useState(!1),[R,k]=V.useState(null),[N,U]=V.useState(""),[K,X]=V.useState(""),[Z,J]=V.useState(!1),[le,de]=V.useState(""),[ue,pe]=V.useState(""),[he,xe]=V.useState(!0);V.useEffect(()=>{he&&(y(),xe(!1))},[y,he]);const fe=(He,lt)=>{k(He),X(lt),U(""),I(!0)},_e=()=>{I(!1),k(null),X(""),U("")},Ce=async()=>{if(!(!R||!K)){J(!0),de("");try{await x(R.requestId,K,N)&&(pe(K==="ACCEPTED"?e("pendingLinkRequests.acceptedSuccess","Demande accepte avec succs ! Le chat a t marqu comme appartenant  son propritaire."):e("pendingLinkRequests.rejectedSuccess","Demande refuse avec succs.")),setTimeout(()=>{y(),_e(),K==="ACCEPTED"&&window.location.reload()},1500))}catch(He){de(e("pendingLinkRequests.error","Une erreur est survenue lors du traitement de la demande.")),console.error("Error responding to request:",He)}finally{J(!1)}}},je=()=>{y()};return o?T.jsxs("div",{className:"text-center my-4",children:[T.jsx(xu,{animation:"border",variant:"primary"}),T.jsx("p",{className:"mt-2",children:e("pendingLinkRequests.loading","Chargement des demandes en attente...")})]}):T.jsxs("div",{children:[d&&T.jsx(mi,{variant:"success",className:"mb-3",children:d}),ue&&T.jsx(mi,{variant:"success",className:"mb-3",children:ue}),c&&T.jsx(mi,{variant:"danger",children:c}),T.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[T.jsxs("h5",{className:"mb-0",children:[e("pendingLinkRequests.title","Demandes de liaison en attente")," (",n.length,")"]}),T.jsx(Qn,{variant:"outline-primary",size:"sm",onClick:je,disabled:o,children:o?T.jsx(xu,{animation:"border",size:"sm"}):e("pendingLinkRequests.refresh","Rafrachir")})]}),n.length===0?T.jsx(mi,{variant:"info",children:e("pendingLinkRequests.none","Aucune demande de liaison en attente.")}):n.map(He=>T.jsx(yn,{className:"mb-3 shadow-sm",children:T.jsxs(yn.Body,{children:[T.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-3",children:[T.jsxs("div",{children:[T.jsxs("h6",{className:"mb-1",children:[e("pendingLinkRequests.requestNumber","Demande #")," ",He.requestId]}),T.jsxs("p",{className:"text-muted small mb-1",children:[e("pendingLinkRequests.requestDate","Date"),": ",new Date(He.requestDate).toLocaleDateString()," ",new Date(He.requestDate).toLocaleTimeString()]}),T.jsxs("p",{className:"text-muted small mb-0",children:[e("pendingLinkRequests.requestFrom","De"),": ",He.requester.userName||He.requester.email]})]}),T.jsx(ia,{bg:"warning",className:"px-2 py-1",children:e("pendingLinkRequests.pending","En attente")})]}),T.jsxs("div",{className:"row mb-3",children:[T.jsx("div",{className:"col-md-6",children:T.jsx(yn,{className:"h-100",children:T.jsxs(yn.Body,{className:"p-2",children:[T.jsx("h6",{className:"mb-1",children:e("pendingLinkRequests.lostCat","Chat perdu")}),T.jsxs("p",{className:"mb-0 small",children:[T.jsxs("strong",{children:[e("pendingLinkRequests.name","Nom"),": "]})," ",He.lostCatStatus.cat.name]}),T.jsxs("p",{className:"mb-0 small",children:[T.jsxs("strong",{children:[e("pendingLinkRequests.id","ID"),": "]})," ",He.lostCatStatus.catStatusId]})]})})}),T.jsx("div",{className:"col-md-6",children:T.jsx(yn,{className:"h-100",children:T.jsxs(yn.Body,{className:"p-2",children:[T.jsx("h6",{className:"mb-1",children:e("pendingLinkRequests.foundCat","Chat trouv")}),T.jsxs("p",{className:"mb-0 small",children:[T.jsxs("strong",{children:[e("pendingLinkRequests.name","Nom"),": "]})," ",He.foundCatStatus.cat.name]}),T.jsxs("p",{className:"mb-0 small",children:[T.jsxs("strong",{children:[e("pendingLinkRequests.id","ID"),": "]})," ",He.foundCatStatus.catStatusId]})]})})})]}),He.comment&&T.jsxs("div",{className:"mb-3",children:[T.jsxs("h6",{className:"mb-1",children:[e("pendingLinkRequests.comment","Commentaire"),":"]}),T.jsx("p",{className:"small mb-0",children:He.comment})]}),T.jsxs("div",{className:"d-flex gap-2 justify-content-end",children:[T.jsxs(Qn,{variant:"success",size:"sm",onClick:()=>fe(He,"ACCEPTED"),children:[T.jsx(w7,{})," ",e("pendingLinkRequests.accept","Accepter")]}),T.jsxs(Qn,{variant:"danger",size:"sm",onClick:()=>fe(He,"REJECTED"),children:[T.jsx(U0,{})," ",e("pendingLinkRequests.reject","Refuser")]})]})]})},He.requestId)),T.jsxs(Wi,{show:i,onHide:_e,children:[T.jsx(Wi.Header,{closeButton:!0,children:T.jsx(Wi.Title,{children:e("pendingLinkRequests.modalTitle","Rpondre  la demande")})}),T.jsxs(Wi.Body,{children:[le&&T.jsx(mi,{variant:"danger",className:"mb-3",children:le}),T.jsxs("p",{children:[e("pendingLinkRequests.modalText","Vous tes sur le point de")," ",K==="ACCEPTED"?e("pendingLinkRequests.accept","accepter"):e("pendingLinkRequests.reject","refuser")," ",e("pendingLinkRequests.modalText2","la demande de liaison pour le chat")," ",T.jsx("strong",{children:R==null?void 0:R.foundCatStatus.cat.name}),"."]}),K==="ACCEPTED"&&T.jsx(mi,{variant:"info",children:e("pendingLinkRequests.acceptWarning","En acceptant cette demande, le chat sera marqu comme appartenant  son propritaire et ne sera plus list comme trouv.")}),T.jsxs(ot.Group,{className:"mb-3",children:[T.jsx(ot.Label,{children:e("pendingLinkRequests.commentLabel","Commentaire (optionnel)")}),T.jsx(ot.Control,{as:"textarea",rows:3,value:N,onChange:He=>U(He.target.value),placeholder:e("pendingLinkRequests.commentPlaceholder","Ajoutez un commentaire...")})]})]}),T.jsxs(Wi.Footer,{children:[T.jsx(Qn,{variant:"secondary",onClick:_e,disabled:Z,children:e("pendingLinkRequests.cancel","Annuler")}),T.jsx(Qn,{variant:K==="ACCEPTED"?"success":"danger",onClick:Ce,disabled:Z,children:Z?T.jsxs(T.Fragment,{children:[T.jsx(xu,{size:"sm",animation:"border",className:"me-1"}),e("pendingLinkRequests.processing","Traitement...")]}):K==="ACCEPTED"?e("pendingLinkRequests.confirmAccept","Confirmer l'acceptation"):e("pendingLinkRequests.confirmReject","Confirmer le refus")})]})]})]})},Fle=()=>{const{loading:e,userData:n}=Ih(),{reportedCats:o,ownedCats:c,loading:d,handleDeleteReportedCat:y,handleEditReportedCat:x,handleEditOwnedCat:i,handleDeleteOwnedCat:I,handleReportCatAsLost:R,successMessage:k,fetchCats:N}=W_(),{profileData:U,setProfileData:K,passwordForm:X,setPasswordForm:Z,orders:J,ordersLoading:le,loading:de,updateSuccess:ue,updateError:pe,updateProfile:he,updatePassword:xe,deleteAccount:fe,fetchOrders:_e}=ree(),[Ce,je]=V.useState("profile"),[He,lt]=V.useState(!1),[_t,Ue]=V.useState(null);V.useEffect(()=>{N()},[N]),V.useEffect(()=>{Ce==="orders"?_e():(Ce==="reported"||Ce==="ownedCats")&&N()},[Ce,_e,N]);const Ge=async ct=>{ct.preventDefault(),await he(U),window.scrollTo({top:0,behavior:"smooth"})},at=async ct=>{ct.preventDefault(),await xe(X),window.scrollTo({top:0,behavior:"smooth"})},yt=async()=>{window.confirm("tes-vous sr de vouloir supprimer votre compte ? Cette action est irrversible.")&&await fe()&&(window.location.href="/login")},tt=()=>lt(!1),Rt=ct=>{Ue(ct),lt(!0)};return e||de||d?T.jsx(Ro,{className:"d-flex justify-content-center align-items-center",style:{minHeight:"50vh"},children:T.jsx(xu,{animation:"border",role:"status",variant:"primary",children:T.jsx("span",{className:"visually-hidden",children:"Chargement..."})})}):n?T.jsx(Ro,{className:"mt-4",children:de?T.jsx("div",{className:"text-center",children:T.jsx(xu,{animation:"border"})}):n?T.jsxs(T.Fragment,{children:[pe&&T.jsx(mi,{variant:ue?"success":"danger",children:pe}),T.jsx(Rp.Container,{id:"profile-tabs",activeKey:Ce,onSelect:ct=>je(ct),children:T.jsxs(vi,{className:"justify-content-center",children:[T.jsx(Un,{md:4,lg:3,className:"mb-4",children:T.jsx(Ole,{connectedUser:n,activeTab:Ce,setActiveTab:je,handleDeleteAccount:yt})}),T.jsx(Un,{md:8,lg:7,children:T.jsxs(Rp.Content,{children:[T.jsx(Rp.Pane,{active:Ce==="profile",children:T.jsx(yn,{className:"shadow-sm mb-4",children:T.jsxs(yn.Body,{children:[T.jsxs(yn.Title,{className:"mb-4",children:[T.jsx(Gp,{className:"me-2"}),"Informations personnelles"]}),T.jsx(Rle,{formData:U,setFormData:K,handleSubmit:Ge,updateSuccess:ue,updateError:pe})]})})}),T.jsx(Rp.Pane,{active:Ce==="security",children:T.jsx(yn,{className:"shadow-sm",children:T.jsxs(yn.Body,{children:[T.jsxs(yn.Title,{className:"mb-4",children:[T.jsx(S_,{className:"me-2"}),"Modifier le mot de passe"]}),T.jsx(Mle,{passwordForm:X,setPasswordForm:Z,handleSubmit:at,updateSuccess:ue,updateError:pe})]})})}),T.jsx(Rp.Pane,{active:Ce==="orders",children:T.jsx(yn,{className:"shadow-sm mb-4",children:T.jsxs(yn.Body,{children:[T.jsxs(yn.Title,{className:"mb-4",children:[T.jsx(lv,{className:"me-2"}),"Historique des commandes"]}),T.jsx(kle,{orders:J,ordersLoading:le})]})})}),T.jsx(Rp.Pane,{active:Ce==="reported",children:T.jsx(yn,{className:"shadow-sm mb-4",children:T.jsxs(yn.Body,{children:[T.jsxs(yn.Title,{className:"mb-4",children:[T.jsx(hl,{className:"me-2"}),"Chats Signals"]}),T.jsx(Woe,{reportedCats:o,onCatClick:ct=>{Ue(ct),lt(!0)},onDelete:y,onEdit:x,successMessage:k})]})})}),T.jsx(Rp.Pane,{active:Ce==="ownedCats",children:T.jsx(yn,{className:"shadow-sm mb-4",children:T.jsx(yn.Body,{children:T.jsx(Ale,{ownedCats:c,onShowCatDetails:Rt,onDeleteCat:I,onEditCat:i,onReportAsLost:R,successMessage:k})})})}),T.jsx(Rp.Pane,{active:Ce==="pendingLinks",children:T.jsx(yn,{className:"shadow-sm mb-4",children:T.jsxs(yn.Body,{children:[T.jsxs(yn.Title,{className:"mb-4",children:[T.jsx(XO,{className:"me-2"}),"Demandes de liaison en attente"]}),T.jsx(zle,{})]})})})]})})]})}),T.jsx(hT,{selectedCatStatus:_t,handleClose:tt,show:He})]}):T.jsx(mi,{variant:"warning",children:"Veuillez vous connecter pour accder  votre profil."})}):T.jsx(Ro,{className:"mt-5",children:T.jsx(mi,{variant:"warning",children:"Vous devez tre connect pour accder  cette page"})})},j5=V.createContext(),Nle=({children:e})=>{const[n,o]=V.useState([]),[c,d]=V.useState(!0),[y,x]=V.useState(null),i=ml(),I=V.useCallback(async()=>{try{d(!0),x(null);const N=await i.get("/ecommerce/products");o((N==null?void 0:N.data)||N||[])}catch{x("Erreur lors de la rcupration des produits")}finally{d(!1)}},[i]);V.useEffect(()=>{I()},[I]);const R=V.useCallback(N=>n.find(U=>U.id===N)||null,[n]),k={products:n,loading:c,error:y,fetchProducts:I,getProductById:R};return T.jsx(j5.Provider,{value:k,children:e})},jle=()=>{const e=V.useContext(j5);if(!e)throw new Error("useProductContext must be used within a ProductProvider");return e},Ble="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2VlZSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTYiIGZpbGw9IiM5OTkiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5JbWFnZSBub24gZGlzcG9uaWJsZTwvdGV4dD48L3N2Zz4=";function Vle(){const{t:e}=Rs(),{addToCart:n}=KC(),{products:o,loading:c,error:d}=jle(),{isLoggedIn:y}=Ih(),x=i=>{y&&n(i)};return c?T.jsx(Ro,{className:"py-5 text-center",children:T.jsx("h2",{children:e("gpsCollars.loading","Chargement des produits...")})}):d?T.jsx(Ro,{className:"py-5 text-center",children:T.jsxs(mi,{variant:"danger",children:[T.jsx(mi.Heading,{children:e("gpsCollars.error","Erreur")}),T.jsx("p",{children:d})]})}):T.jsx(Ro,{className:"py-5",children:T.jsxs(Za.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[T.jsxs("div",{className:"text-center mb-5",children:[T.jsx("h1",{className:"display-4 mb-3",children:e("gpsCollars.title","Colliers GPS pour Chats")}),T.jsx("p",{className:"lead text-muted",children:e("gpsCollars.subtitle","Gardez un il sur votre compagnon flin avec nos colliers GPS de haute qualit")})]}),!y&&T.jsxs(mi,{variant:"info",className:"mb-4",children:[T.jsx(mi.Heading,{children:e("gpsCollars.loginRequired","Connexion requise")}),T.jsxs("p",{children:[e("gpsCollars.loginToBuy","Pour acheter nos colliers GPS, veuillez vous")," ",T.jsx(co,{to:"/login",className:"alert-link",children:e("gpsCollars.login","connecter")})," ",e("gpsCollars.or","ou")," ",T.jsx(co,{to:"/register",className:"alert-link",children:e("gpsCollars.createAccount","crer un compte")}),"."]})]}),T.jsx(vi,{xs:1,md:2,lg:3,className:"g-4",children:o.map(i=>T.jsx(Un,{children:T.jsx(Za.div,{whileHover:{y:-5},transition:{duration:.2},children:T.jsxs(yn,{className:"h-100 shadow-sm",children:[T.jsx("div",{className:"position-relative",children:T.jsx(yn.Img,{variant:"top",src:i.imageUrl,alt:i.name,style:{height:"200px",objectFit:"cover"},onError:I=>{I.target.src=Ble}})}),T.jsxs(yn.Body,{className:"d-flex flex-column",children:[T.jsx(yn.Title,{className:"mb-3",children:i.name}),T.jsx(yn.Text,{className:"text-muted mb-3",children:i.description}),T.jsxs("div",{className:"mt-auto",children:[T.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[T.jsxs("span",{className:"h4 mb-0",children:[i.price.toFixed(2)," "]}),y?T.jsx(Qn,{variant:"primary",className:"px-4",onClick:()=>x(i),disabled:i.stockQuantity===0,children:i.stockQuantity>0?e("gpsCollars.addToCart","Ajouter au panier"):e("gpsCollars.outOfStock","Rupture de stock")}):T.jsx(Qn,{variant:"outline-primary",className:"px-4",as:co,to:"/login",children:e("gpsCollars.loginToBuyButton","Se connecter pour acheter")})]}),i.stockQuantity>0&&T.jsxs("small",{className:"text-muted mt-2 d-block",children:[e("gpsCollars.stock","Stock disponible"),":"," ",i.stockQuantity]})]})]})]})})},i.id))}),T.jsxs("div",{className:"text-center mt-5 py-4 bg-light rounded",children:[T.jsx("h2",{className:"h4 mb-4",children:e("gpsCollars.whyTitle","Pourquoi choisir nos colliers GPS ?")}),T.jsxs(vi,{className:"g-4",children:[T.jsx(Un,{md:4,children:T.jsxs("div",{className:"px-3",children:[T.jsx("h3",{className:"h5 mb-3",children:e("gpsCollars.why1Title","Scurit Maximale")}),T.jsx("p",{className:"text-muted",children:e("gpsCollars.why1Text","Localisez votre chat en temps rel et recevez des alertes instantanes")})]})}),T.jsx(Un,{md:4,children:T.jsxs("div",{className:"px-3",children:[T.jsx("h3",{className:"h5 mb-3",children:e("gpsCollars.why2Title","Confort Optimal")}),T.jsx("p",{className:"text-muted",children:e("gpsCollars.why2Text","Conus spcialement pour les chats, lgers et confortables")})]})}),T.jsx(Un,{md:4,children:T.jsxs("div",{className:"px-3",children:[T.jsx("h3",{className:"h5 mb-3",children:e("gpsCollars.why3Title","Application Simple")}),T.jsx("p",{className:"text-muted",children:e("gpsCollars.why3Text","Interface intuitive pour suivre facilement les dplacements")})]})})]})]})]})})}var A2,QL;function Ule(){if(QL)return A2;QL=1;var e={linear:function(n,o,c,d){var y=c-o;return y*n/d+o},easeInQuad:function(n,o,c,d){var y=c-o;return y*(n/=d)*n+o},easeOutQuad:function(n,o,c,d){var y=c-o;return-y*(n/=d)*(n-2)+o},easeInOutQuad:function(n,o,c,d){var y=c-o;return(n/=d/2)<1?y/2*n*n+o:-y/2*(--n*(n-2)-1)+o},easeInCubic:function(n,o,c,d){var y=c-o;return y*(n/=d)*n*n+o},easeOutCubic:function(n,o,c,d){var y=c-o;return y*((n=n/d-1)*n*n+1)+o},easeInOutCubic:function(n,o,c,d){var y=c-o;return(n/=d/2)<1?y/2*n*n*n+o:y/2*((n-=2)*n*n+2)+o},easeInQuart:function(n,o,c,d){var y=c-o;return y*(n/=d)*n*n*n+o},easeOutQuart:function(n,o,c,d){var y=c-o;return-y*((n=n/d-1)*n*n*n-1)+o},easeInOutQuart:function(n,o,c,d){var y=c-o;return(n/=d/2)<1?y/2*n*n*n*n+o:-y/2*((n-=2)*n*n*n-2)+o},easeInQuint:function(n,o,c,d){var y=c-o;return y*(n/=d)*n*n*n*n+o},easeOutQuint:function(n,o,c,d){var y=c-o;return y*((n=n/d-1)*n*n*n*n+1)+o},easeInOutQuint:function(n,o,c,d){var y=c-o;return(n/=d/2)<1?y/2*n*n*n*n*n+o:y/2*((n-=2)*n*n*n*n+2)+o},easeInSine:function(n,o,c,d){var y=c-o;return-y*Math.cos(n/d*(Math.PI/2))+y+o},easeOutSine:function(n,o,c,d){var y=c-o;return y*Math.sin(n/d*(Math.PI/2))+o},easeInOutSine:function(n,o,c,d){var y=c-o;return-y/2*(Math.cos(Math.PI*n/d)-1)+o},easeInExpo:function(n,o,c,d){var y=c-o;return n==0?o:y*Math.pow(2,10*(n/d-1))+o},easeOutExpo:function(n,o,c,d){var y=c-o;return n==d?o+y:y*(-Math.pow(2,-10*n/d)+1)+o},easeInOutExpo:function(n,o,c,d){var y=c-o;return n===0?o:n===d?o+y:(n/=d/2)<1?y/2*Math.pow(2,10*(n-1))+o:y/2*(-Math.pow(2,-10*--n)+2)+o},easeInCirc:function(n,o,c,d){var y=c-o;return-y*(Math.sqrt(1-(n/=d)*n)-1)+o},easeOutCirc:function(n,o,c,d){var y=c-o;return y*Math.sqrt(1-(n=n/d-1)*n)+o},easeInOutCirc:function(n,o,c,d){var y=c-o;return(n/=d/2)<1?-y/2*(Math.sqrt(1-n*n)-1)+o:y/2*(Math.sqrt(1-(n-=2)*n)+1)+o},easeInElastic:function(n,o,c,d){var y=c-o,x,i,I;return I=1.70158,i=0,x=y,n===0?o:(n/=d)===1?o+y:(i||(i=d*.3),x<Math.abs(y)?(x=y,I=i/4):I=i/(2*Math.PI)*Math.asin(y/x),-(x*Math.pow(2,10*(n-=1))*Math.sin((n*d-I)*(2*Math.PI)/i))+o)},easeOutElastic:function(n,o,c,d){var y=c-o,x,i,I;return I=1.70158,i=0,x=y,n===0?o:(n/=d)===1?o+y:(i||(i=d*.3),x<Math.abs(y)?(x=y,I=i/4):I=i/(2*Math.PI)*Math.asin(y/x),x*Math.pow(2,-10*n)*Math.sin((n*d-I)*(2*Math.PI)/i)+y+o)},easeInOutElastic:function(n,o,c,d){var y=c-o,x,i,I;return I=1.70158,i=0,x=y,n===0?o:(n/=d/2)===2?o+y:(i||(i=d*(.3*1.5)),x<Math.abs(y)?(x=y,I=i/4):I=i/(2*Math.PI)*Math.asin(y/x),n<1?-.5*(x*Math.pow(2,10*(n-=1))*Math.sin((n*d-I)*(2*Math.PI)/i))+o:x*Math.pow(2,-10*(n-=1))*Math.sin((n*d-I)*(2*Math.PI)/i)*.5+y+o)},easeInBack:function(n,o,c,d,y){var x=c-o;return y===void 0&&(y=1.70158),x*(n/=d)*n*((y+1)*n-y)+o},easeOutBack:function(n,o,c,d,y){var x=c-o;return y===void 0&&(y=1.70158),x*((n=n/d-1)*n*((y+1)*n+y)+1)+o},easeInOutBack:function(n,o,c,d,y){var x=c-o;return y===void 0&&(y=1.70158),(n/=d/2)<1?x/2*(n*n*(((y*=1.525)+1)*n-y))+o:x/2*((n-=2)*n*(((y*=1.525)+1)*n+y)+2)+o},easeInBounce:function(n,o,c,d){var y=c-o,x;return x=e.easeOutBounce(d-n,0,y,d),y-x+o},easeOutBounce:function(n,o,c,d){var y=c-o;return(n/=d)<1/2.75?y*(7.5625*n*n)+o:n<2/2.75?y*(7.5625*(n-=1.5/2.75)*n+.75)+o:n<2.5/2.75?y*(7.5625*(n-=2.25/2.75)*n+.9375)+o:y*(7.5625*(n-=2.625/2.75)*n+.984375)+o},easeInOutBounce:function(n,o,c,d){var y=c-o,x;return n<d/2?(x=e.easeInBounce(n*2,0,y,d),x*.5+o):(x=e.easeOutBounce(n*2-d,0,y,d),x*.5+y*.5+o)}};return A2=e,A2}var $le=Ule();function Hle(e){return e*Math.PI/180}function Ac(e,n){return e+Math.random()*(n-e)}function Gle(e,n){return Math.floor(e+Math.random()*(n-e+1))}var _v;(function(e){e[e.Circle=0]="Circle",e[e.Square=1]="Square",e[e.Strip=2]="Strip"})(_v||(_v={}));var zp;(function(e){e[e.Positive=1]="Positive",e[e.Negative=-1]="Negative"})(zp||(zp={}));const Wle=1e3/60;class qle{constructor(n,o,c,d){this.getOptions=o;const{colors:y,initialVelocityX:x,initialVelocityY:i}=this.getOptions();this.context=n,this.x=c,this.y=d,this.w=Ac(5,20),this.h=Ac(5,20),this.radius=Ac(5,10),this.vx=typeof x=="number"?Ac(-x,x):Ac(x.min,x.max),this.vy=typeof i=="number"?Ac(-i,0):Ac(i.min,i.max),this.shape=Gle(0,2),this.angle=Hle(Ac(0,360)),this.angularSpin=Ac(-.2,.2),this.color=y[Math.floor(Math.random()*y.length)],this.rotateY=Ac(0,1),this.rotationDirection=Ac(0,1)?zp.Positive:zp.Negative}update(n){const{gravity:o,wind:c,friction:d,opacity:y,drawShape:x}=this.getOptions(),i=n/Wle;this.x+=this.vx*i,this.y+=this.vy*i,this.vy+=o*i,this.vx+=c*i,this.vx*=d**i,this.vy*=d**i,this.rotateY>=1&&this.rotationDirection===zp.Positive?this.rotationDirection=zp.Negative:this.rotateY<=-1&&this.rotationDirection===zp.Negative&&(this.rotationDirection=zp.Positive);const I=.1*this.rotationDirection*i;if(this.rotateY+=I,this.angle+=this.angularSpin,this.context.save(),this.context.translate(this.x,this.y),this.context.rotate(this.angle),this.context.scale(1,this.rotateY),this.context.rotate(this.angle),this.context.beginPath(),this.context.fillStyle=this.color,this.context.strokeStyle=this.color,this.context.globalAlpha=y,this.context.lineCap="round",this.context.lineWidth=2,x&&typeof x=="function")x.call(this,this.context);else switch(this.shape){case _v.Circle:{this.context.beginPath(),this.context.arc(0,0,this.radius,0,2*Math.PI),this.context.fill();break}case _v.Square:{this.context.fillRect(-this.w/2,-this.h/2,this.w,this.h);break}case _v.Strip:{this.context.fillRect(-this.w/6,-this.h/2,this.w/3,this.h);break}}this.context.closePath(),this.context.restore()}}class Zle{constructor(n,o){this.x=0,this.y=0,this.w=0,this.h=0,this.lastNumberOfPieces=0,this.tweenProgress=0,this.tweenFrom=0,this.particles=[],this.particlesGenerated=0,this.removeParticleAt=d=>{this.particles.splice(d,1)},this.getParticle=()=>{const d=Ac(this.x,this.w+this.x),y=Ac(this.y,this.h+this.y);return new qle(this.context,this.getOptions,d,y)},this.animate=d=>{const{canvas:y,context:x,particlesGenerated:i,lastNumberOfPieces:I}=this,{run:R,recycle:k,numberOfPieces:N,debug:U,tweenFunction:K,tweenDuration:X}=this.getOptions();if(!R)return!1;const Z=this.particles.length,J=k?Z:i;if(J<N){I!==N&&(this.tweenProgress=0,this.tweenFrom=J,this.lastNumberOfPieces=N),this.tweenProgress=Math.min(X,Math.max(0,this.tweenProgress+d));const le=K(this.tweenProgress,this.tweenFrom,N,X),de=Math.round(le-J);for(let ue=0;ue<de;ue++)this.particles.push(this.getParticle());this.particlesGenerated+=de}U&&(x.font="12px sans-serif",x.fillStyle="#333",x.textAlign="right",x.fillText(`Particles: ${Z}`,y.width-10,y.height-20));for(let le=this.particles.length-1;le>=0;le--){const de=this.particles[le];de.update(d),(de.y>y.height||de.y<-100||de.x>y.width+100||de.x<-100)&&(k&&J<=N?this.particles[le]=this.getParticle():this.removeParticleAt(le))}return Z>0||J<N},this.canvas=n;const c=this.canvas.getContext("2d");if(!c)throw new Error("Could not get canvas context");this.context=c,this.getOptions=o}}const DT={width:typeof window<"u"?window.innerWidth:300,height:typeof window<"u"?window.innerHeight:200,numberOfPieces:200,friction:.99,wind:0,gravity:.1,initialVelocityX:4,initialVelocityY:10,colors:["#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4CAF50","#8BC34A","#CDDC39","#FFEB3B","#FFC107","#FF9800","#FF5722","#795548"],opacity:1,debug:!1,tweenFunction:$le.easeInOutQuad,tweenDuration:5e3,recycle:!0,run:!0};class Xle{constructor(n,o){this.lastFrameTime=0,this.setOptionsWithDefaults=d=>{const y={confettiSource:{x:0,y:0,w:this.canvas.width,h:0}};this._options={...y,...DT,...d},Object.assign(this,d.confettiSource)},this.update=(d=0)=>{const{options:{run:y,onConfettiComplete:x,frameRate:i},canvas:I,context:R}=this,k=Math.min(d-this.lastFrameTime,50);if(i&&k<1e3/i){this.rafId=requestAnimationFrame(this.update);return}this.lastFrameTime=d-(i?k%i:0),y&&(R.fillStyle="white",R.clearRect(0,0,I.width,I.height)),this.generator.animate(k)?this.rafId=requestAnimationFrame(this.update):(x&&typeof x=="function"&&this.generator.particlesGenerated>0&&x.call(this,this),this._options.run=!1)},this.reset=()=>{this.generator&&this.generator.particlesGenerated>0&&(this.generator.particlesGenerated=0,this.generator.particles=[],this.generator.lastNumberOfPieces=0)},this.stop=()=>{this.options={run:!1},this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=void 0)},this.canvas=n;const c=this.canvas.getContext("2d");if(!c)throw new Error("Could not get canvas context");this.context=c,this.generator=new Zle(this.canvas,()=>this.options),this.options=o,this.update()}get options(){return this._options}set options(n){var d,y;const o=(d=this._options)==null?void 0:d.run,c=(y=this._options)==null?void 0:y.recycle;this.setOptionsWithDefaults(n),this.generator&&(Object.assign(this.generator,this.options.confettiSource),typeof n.recycle=="boolean"&&n.recycle&&c===!1&&(this.generator.lastNumberOfPieces=this.generator.particles.length)),typeof n.run=="boolean"&&n.run&&o===!1&&this.update()}}const Kle=qi.createRef();class kT extends qi.Component{constructor(n){super(n),this.canvas=qi.createRef(),this.canvas=n.canvasRef||Kle}componentDidMount(){if(this.canvas.current){const n=R2(this.props)[0];this.confetti=new Xle(this.canvas.current,n)}}componentDidUpdate(){const n=R2(this.props)[0];this.confetti&&(this.confetti.options=n)}componentWillUnmount(){this.confetti&&this.confetti.stop(),this.confetti=void 0}render(){const[n,o]=R2(this.props),c={zIndex:2,position:"absolute",pointerEvents:"none",top:0,left:0,bottom:0,right:0,...o.style};return T.jsx("canvas",{width:n.width,height:n.height,ref:this.canvas,...o,style:c})}}kT.defaultProps={...DT};kT.displayName="ReactConfetti";function R2(e){const n={},o={},c={},d=[...Object.keys(DT),"confettiSource","drawShape","onConfettiComplete","frameRate"],y=["canvasRef"];for(const x in e){const i=e[x];d.includes(x)?n[x]=i:y.includes(x)?y[x]=i:c[x]=i}return[n,c,o]}const Yle=qi.forwardRef((e,n)=>T.jsx(kT,{canvasRef:n,...e})),Jle=()=>{const{t:e}=Rs(),n=Cu(),[o]=hD(),{clearCart:c}=KC(),[d,y]=V.useState(!1),[x,i]=V.useState({width:window.innerWidth,height:window.innerHeight}),I=o.get("session_id");return V.useEffect(()=>{const R=()=>{i({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",R),()=>window.removeEventListener("resize",R)},[]),V.useEffect(()=>{I&&!d&&(c(),y(!0))},[I,c,d]),T.jsxs(T.Fragment,{children:[T.jsx(Yle,{width:x.width,height:x.height,numberOfPieces:200,recycle:!1,colors:["#ff6b6b","#4ecdc4","#45b7af","#96ceb4","#ffeead"]}),T.jsx(Ro,{className:"py-5",children:T.jsxs(mi,{variant:"success",className:"text-center",children:[T.jsx(mi.Heading,{className:"display-4",children:e("paymentSuccess.title"," Paiement russi ! ")}),T.jsx("p",{className:"lead mb-4",children:e("paymentSuccess.thankYou","Merci pour votre commande. Votre paiement a t trait avec succs. Vous recevrez bientt un email de confirmation.")}),T.jsx("hr",{}),T.jsx("p",{className:"mb-4",children:e("paymentSuccess.processing","Votre commande est en cours de traitement et sera bientt expdie.")}),T.jsx(Qn,{variant:"primary",size:"lg",onClick:()=>n("/"),className:"px-5",children:e("paymentSuccess.backHome","Retour  l'accueil")})]})})]})},Qle=({children:e})=>{const n=qi.useRef(null);return T.jsx(a7,{children:T.jsx(zZ,{children:T.jsx(s7,{onLogout:()=>{var o;return(o=n.current)==null?void 0:o.call(n)},children:T.jsx(c7,{onLogoutRef:n,children:T.jsx(PJ,{children:T.jsx(nee,{children:T.jsx(EJ,{children:T.jsx(Nle,{children:e})})})})})})})})};function ece(){const{notification:e,clearNotification:n}=gC();return e?T.jsxs("div",{style:{position:"fixed",top:20,right:20,zIndex:9999,minWidth:250,background:e.type==="error"?"#f44336":e.type==="success"?"#4caf50":"#2196f3",color:"white",padding:"16px 24px",borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.15)",fontSize:16,display:"flex",alignItems:"center",gap:12,cursor:"pointer"},onClick:n,children:[T.jsx("span",{children:e.message}),T.jsx("span",{style:{marginLeft:"auto",fontWeight:"bold"},children:""})]}):null}const tce=document.getElementById("root"),nce=ZB.createRoot(tce),eD=({children:e})=>{const{isLoggedIn:n}=Ih();return n?e:T.jsx(N6,{to:"/login"})};function rce(){return T.jsx(iZ,{children:T.jsxs("div",{style:{display:"flex",flexDirection:"column",minHeight:"100vh"},children:[T.jsxs("div",{style:{flex:1},children:[T.jsx(FZ,{}),T.jsxs(B6,{children:[T.jsx(Pc,{exact:!0,path:"/",element:T.jsx(HJ,{})}),T.jsx(Pc,{path:"/register",element:T.jsx(HZ,{})}),T.jsx(Pc,{path:"/contact",element:T.jsx(iQ,{})}),T.jsx(Pc,{path:"/login",element:T.jsx(sQ,{})}),T.jsx(Pc,{path:"/forgot-password",element:T.jsx(oQ,{})}),T.jsx(Pc,{path:"/reset-password",element:T.jsx(aQ,{})}),T.jsx(Pc,{path:"/registerCat",element:T.jsx(eD,{children:T.jsx(RJ,{})})}),T.jsx(Pc,{path:"/foundCats",element:T.jsx(jJ,{})}),T.jsx(Pc,{path:"/lostCats",element:T.jsx(NJ,{})}),T.jsx(Pc,{path:"/gps-collars",element:T.jsx(Vle,{})}),T.jsx(Pc,{path:"/success",element:T.jsx(Jle,{})}),T.jsx(Pc,{path:"/profile",element:T.jsx(eD,{children:T.jsx(Fle,{})})})]})]}),T.jsx(NZ,{})]})})}nce.render(T.jsx(Z6,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:T.jsx(Qle,{children:T.jsxs(T.Fragment,{children:[T.jsx(ece,{}),T.jsx(rce,{})]})})}));export{sce as c,mg as g};
